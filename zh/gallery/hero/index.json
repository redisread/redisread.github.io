[{"content":"ç®€ä»‹ ä»€ä¹ˆæ˜¯ESï¼Ÿ ESçš„å…¨ç§°æ˜¯ElasticSearchï¼ˆä¸‹é¢ç®€ç§°ESï¼‰ï¼Œæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€é«˜æ‰©å±•ã€è¿‘å®æ—¶çš„æœç´¢ä¸æ•°æ®åˆ†æå¼•æ“ï¼ˆåº•å±‚åŸºäºApache Luceneï¼‰ã€‚Elasticsearch ä¸ºå„ç§æ•°æ®ç±»å‹æä¾›æ¥è¿‘å®æ—¶çš„æœç´¢å’Œåˆ†æï¼Œä¸è®ºä½ æœ‰ç»“æ„åŒ–æˆ–éç»“æ„åŒ–çš„æ–‡æœ¬ã€æ•°å­—æ•°æ®ï¼Œè¿˜æ˜¯åœ°ç†ç©ºé—´æ•°æ®ï¼ŒElasticsearch èƒ½ä»¥æ”¯æŒå¿«é€Ÿæœç´¢çš„æ–¹å¼é«˜æ•ˆåœ°å­˜å‚¨å’Œç´¢å¼•å®ƒã€‚ä½ å¯ä»¥è¿œè¶…ç®€å•æ•°æ®æ£€ç´¢å’Œèšåˆä¿¡æ¯çš„æ–¹å¼å»å‘ç°ä½ æ•°æ®ä¸­çš„è¶‹åŠ¿å’Œæ¨¡å¼ã€‚è€Œä¸”ï¼Œéšç€ä½ æ•°æ®å’ŒæŸ¥è¯¢é‡çš„å¢é•¿ï¼ŒElasticsearch åˆ†å¸ƒå¼çš„ç‰¹æ€§å…è®¸ä½ çš„éƒ¨ç½²èƒ½éšç€å®ƒæ— ç¼åœ°å¢é•¿ã€‚ï¼ˆå‚è€ƒï¼šESå®˜æ–¹æ–‡æ¡£-ESä»‹ç»ï¼‰\nESä½œä¸ºä¸€ç§éå…³ç³»å‹æ•°æ®åº“ï¼Œä»–å’Œä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ(å‚è€ƒï¼šhttps://www.trustradius.com/compare-products/elasticsearch-vs-mysql)\n åº•å±‚çš„æ•°æ®ç»“æ„ä¸åŒï¼ŒESä½¿ç”¨å€’æ’ç´¢å¼•ï¼Œè€ŒMySQLä½¿ç”¨B+æ ‘ã€‚ MySQLæ”¯æŒäº‹åŠ¡ï¼ŒESä¸æ”¯æŒäº‹åŠ¡ï¼Œå¯ä»¥è¿™ä¹ˆè®¤ä¸ºï¼ŒMySQLæ›´åŠ é€‚åˆOLTPï¼ŒESæ›´é€‚åˆOLAPã€‚ MYSQLæ˜¯å•æœºçš„ï¼ŒESæ˜¯åˆ†å¸ƒå¼çš„ï¼Œæ”¯æŒæ°´å¹³æ‹“å±•ä»¥åŠé«˜å¯ç”¨çš„ç‰¹æ€§ã€‚ ESæ‹¥æœ‰çµæ´»çš„æ•°æ®ç±»å‹ï¼Œåˆ›å»ºæ›´å¤šçš„ç´¢å¼•ï¼ˆé»˜è®¤éƒ½æ˜¯ç´¢å¼•ï¼‰ã€‚  ESçš„ä½¿ç”¨åœºæ™¯ ESçš„ä½¿ç”¨åœºæ™¯éƒ½æœ‰å“ªäº›å‘¢ï¼Ÿï¼ˆå‚è€ƒï¼šuse-cases-of-elasticsearchï¼‰\n 111  dasd   ","description":"ESæ˜¯åŸºäºLuceneçš„å­˜å‚¨åº”ç”¨ï¼Œæ ¸å¿ƒæ˜¯å€’æ’ç´¢å¼•ã€‚","id":0,"section":"posts","tags":["ES","ESç´¢å¼•","Lucene"],"title":"ESç´¢å¼•åŸç†","uri":"https://hugo.jiahongw.com/zh/posts/es/es_index_inside/"},{"content":"HED 1  ğŸ’¡   test\n     11111111111111\nHED2 2222222222222\n3222222\n I am a man\n classDiagram Strategy \u0026lt;|-- StrategyA : implements Strategy \u0026lt;|-- StrategyB : implements Strategy : algorithmInterface() StrategyA : algorithmInterface() StrategyB : algorithmInterface()  https://zenn.dev/eetann/articles/2022-08-15-notion-api-with-github-actions  1  sdasdjasdasda   ","description":"æè¿°ä¸€ä¸‹","id":1,"section":"posts","tags":["test","gg"],"title":"Test","uri":"https://hugo.jiahongw.com/zh/posts/efficient/test/"},{"content":" åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹æ³•ï¼š\n1 2 3 4  ExecutorService executorService = Executors.newCachedThreadPool(); ExecutorService executorService = Executors.newFixedThreadPool(3); ScheduledExecutorService executorService = Executors.newScheduledThreadPool(3); ExecutorService executorService = Executors.newSingleThreadExecutor();   https://www.cnblogs.com/pcheng/p/13540619.html\n å¤šçº¿ç¨‹çš„é—®é¢˜ çº¿ç¨‹ä»»åŠ¡æ˜¯å®ç°äº†Runnableæ¥å£ï¼Œæˆ–è€…ç›´æ¥å†™ä¸ªç±»ç»§æ‰¿Thread,ä½†æ˜¯è¿™ä¸¤ç§æ–¹æ³•åªèƒ½é€šè¿‡å…±äº«å¯¹è±¡æˆ–è€…æ–‡ä»¶æ¥å¾—åˆ°è¿”å›çš„ç»“æœï¼Œæ— æ³•ç›´æ¥è¿”å›ã€‚å¹¶ä¸”Runnableæ¥å£ä¸­çš„runæ–¹æ³•æ— æ³•æŠ›å‡ºå¼‚å¸¸ã€‚\n å›è°ƒåœ°ç‹±ï¼ˆCallback hellï¼‰é—®é¢˜\n Java 5 æä¾›äº†æ‰§è¡Œå™¨æ¡†æ¶ï¼Œå…¶æ€æƒ³ç±»ä¼¼äºä¸€ä¸ªé«˜å±‚çš„çº¿ç¨‹æ± ï¼Œå¯ä»¥å……åˆ†å‘ô´çº¿ç¨‹çš„èƒ½åŠ›ã€‚æ‰§è¡Œå™¨ä½¿å¾—ç¨‹åºå‘˜æœ‰æœºä¼šè§£ô³½ä»»åŠ¡çš„æäº¤ä¸ä»»åŠ¡çš„æ‰§è¡Œã€‚\næ— è®ºä»€ä¹ˆæ—¶å€™ï¼Œä»»ä½•ä»»åŠ¡(æˆ–è€…çº¿ç¨‹)åœ¨æ–¹æ³• è°ƒç”¨ä¸­å¯åŠ¨æ—¶ï¼Œéƒ½ä¼šåœ¨å…¶è¿”å›ä¹‹å‰è°ƒç”¨åŒä¸€ä¸ªæ–¹æ³•ã€‚æ¢å¥è¯è¯´ï¼Œçº¿ç¨‹åˆ›å»ºä»¥åŠä¸å…¶åŒ¹é…çš„ join() åœ¨è°ƒç”¨è¿”å›çš„åµŒå¥—æ–¹æ³•è°ƒç”¨ä¸­éƒ½ä»¥åµŒå¥—çš„æ–¹å¼æˆå¯¹å‡ºç°ã€‚è¿™ç§æ€æƒ³è¢«ç§°ä¸ºô¶–ô¶— fork/joinã€‚\n Javaä¸­çš„Futureä»£è¡¨äº†ä»€ä¹ˆï¼Ÿ\nFutureæ˜¯Javaçš„æ¥å£ï¼Œç±»ä¼¼äºå®¹å™¨ä¿å­˜äº†Callableçš„è¿”å›ç»“æœã€‚æˆ‘ä»¬æŠŠå­ä»»åŠ¡æ”¾å…¥çº¿ç¨‹æ± ä¹‹åï¼Œç›´æ¥è¿”å›ï¼Œè¿›è¡Œå…¶ä»–å¤„ç†ï¼Œç„¶åå†è°ƒç”¨Futureçš„getæ–¹æ³•æ¥è·å–ç»“æœï¼ŒFutureè¿˜å¯ä»¥æ§åˆ¶å­ä»»åŠ¡çš„æ‰§è¡Œã€‚\n Future  æˆ‘ä»¬ä½¿ç”¨Runnableå¯¹è±¡æ¥å®šä¹‰åœ¨çº¿ç¨‹å†…æ‰§è¡Œçš„ä»»åŠ¡ã€‚è™½ç„¶å®šä¹‰ä»»åŠ¡ä½¿ç”¨Runnableå¾ˆæ–¹ä¾¿ï¼Œä½†å—é™äºä»»åŠ¡ä¸èƒ½è¿”å›ç»“æœã€‚\n Java æä¾›äº†ä¸€ä¸ªCallableæ¥å£æ¥å®šä¹‰è¿”å›ç»“æœçš„ä»»åŠ¡ã€‚Callableç±»ä¼¼äºRunnableå¹¶ä¸”å®ƒå¯ä»¥è¿”å›ç»“æœå¹¶æŠ›å‡ºå¼‚å¸¸ã€‚\nCallable æ¥å£æœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•call() ç”¨äºåŒ…å«ç”±çº¿ç¨‹æ‰§è¡Œçš„ä»£ç ã€‚ç®€å•çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8  Callable\u0026lt;String\u0026gt; callable = new Callable\u0026lt;String\u0026gt;() { @Override public String call() throws Exception { // Perform some computation  Thread.sleep(2000); return \u0026#34;Return some result\u0026#34;; } };    è¯·æ³¨æ„ï¼Œä½¿ç”¨Callableï¼Œæ‚¨ä¸éœ€è¦Thread.sleep()è¢« try/catch å—åŒ…å›´ï¼Œå› ä¸ºä¸ Runnable ä¸åŒï¼ŒCallable å¯ä»¥æŠ›å‡ºcheckedå¼‚å¸¸ã€‚\n æ›´æ–¹ä¾¿çš„å®šä¹‰ä¸€ä¸ªCallableï¼Œä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼š\n1 2 3 4 5  Callable\u0026lt;String\u0026gt; callable = () -\u0026gt; { // Perform some computation  Thread.sleep(2000); return \u0026#34;Return some result\u0026#34;; };   Callableçš„å®šä¹‰å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10  @FunctionalInterface public interface Callable\u0026lt;V\u0026gt; { /** * Computes a result, or throws an exception if unable to do so. * * @return computed result * @throws Exception if unable to compute a result */ V call() throws Exception; }   å¯ä»¥å‘ç°å®ƒæ˜¯å¯ä»¥å¸¦è¿”å›å€¼çš„ï¼Œå¹¶ä¸”èƒ½å¤ŸæŠ›å‡ºå¼‚å¸¸ã€‚\nRunnableæ¥å£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  @FunctionalInterface public interface Runnable { /** * When an object implementing interface \u0026lt;code\u0026gt;Runnable\u0026lt;/code\u0026gt; is used * to create a thread, starting the thread causes the object\u0026#39;s * \u0026lt;code\u0026gt;run\u0026lt;/code\u0026gt; method to be called in that separately executing * thread. * \u0026lt;p\u0026gt; * The general contract of the method \u0026lt;code\u0026gt;run\u0026lt;/code\u0026gt; is that it may * take any action whatsoever. * * @see java.lang.Thread#run() */ public abstract void run(); }    Runnableæ¥å£æ˜¯æ²¡æœ‰è¿”å›å€¼ï¼Œä¹Ÿä¸èƒ½æŠ›å‡ºå¼‚å¸¸çš„ã€‚å› ä¸ºrun()æ–¹æ³•æ˜¯Runnableæ¥å£é‡Œé¢çš„æ–¹æ³•,è€ŒRunnableæ¥å£åœ¨å®šä¹‰run()æ–¹æ³•çš„æ—¶å€™æ²¡æœ‰æŠ›å‡ºä»»ä½•å¼‚å¸¸,æ‰€ä»¥å­ç±»åœ¨é‡å†™run()æ–¹æ³•çš„æ—¶å€™è¦å°äºæˆ–ç­‰äºçˆ¶ç±»(Runnable)çš„run()æ–¹æ³•çš„å¼‚å¸¸,æ‰€ä»¥çˆ¶ç±»æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸,å­ç±»ä¸èƒ½æŠ›å‡ºå¼‚å¸¸ã€‚\n Threadç±»ä¸­çš„runæ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š\n1 2 3 4 5 6  @Override public void run() { if (target != null) { target.run(); } }   åŒç†ï¼Œç»§æ‰¿Threadçš„çº¿ç¨‹å­ç±»ä¹Ÿä¸èƒ½å¤ŸæŠ›å‡ºå¼‚å¸¸ï¼Œå› ä¸ºå¦‚æœçˆ¶ç±»æˆ–è€…æ¥å£çš„æ–¹æ³•ä¸­ï¼Œæ²¡æœ‰å¼‚å¸¸æŠ›å‡ºï¼Œé‚£ä¹ˆå­ç±»åœ¨è¦†ç›–æ–¹æ³•æ—¶ï¼Œä¹Ÿä¸å¯ä»¥æŠ›å‡ºå¼‚å¸¸ã€‚å‘ç”Ÿå¼‚å¸¸å¿…é¡»è¿›è¡Œtryå¤„ç†ã€‚\nä½¿ç”¨ï¼ˆCallableç»“åˆFutureï¼‰ åƒRunnableä¸€æ ·ï¼Œä½ å¯ä»¥submitä¸€ä¸ªCallableç»™executor serviceå»æ‰§è¡Œã€‚executor serviceçš„ submit() æ–¹æ³• ä¼šå°†ä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ‰§è¡Œã€‚ä½†æ˜¯ï¼Œå®ƒä¸çŸ¥é“æäº¤çš„ä»»åŠ¡ä»€ä¹ˆæ—¶å€™ç»“æŸã€‚å› æ­¤ï¼Œå®ƒè¿”å›ä¸€ç§ç§°ä¸º Future çš„ç‰¹æ®Šç±»å‹çš„å€¼ï¼Œå¯ç”¨äºåœ¨å¯ç”¨æ—¶è·å–ä»»åŠ¡çš„ç»“æœã€‚\nFuture çš„æ¦‚å¿µç±»ä¼¼äº Javascript ç­‰å…¶ä»–è¯­è¨€ä¸­çš„ Promiseã€‚å®ƒè¡¨ç¤ºå°†åœ¨ä»¥åçš„æŸä¸ªæ—¶é—´ç‚¹å®Œæˆçš„è®¡ç®—ç»“æœã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  import java.util.concurrent.*; public class FutureAndCallableExample { public static void main(String[] args) throws InterruptedException, ExecutionException { ExecutorService executorService = Executors.newSingleThreadExecutor(); Callable\u0026lt;String\u0026gt; callable = () -\u0026gt; { // Perform some computation  System.out.println(\u0026#34;Entered Callable\u0026#34;); Thread.sleep(2000); return \u0026#34;Hello from Callable\u0026#34;; }; System.out.println(\u0026#34;Submitting Callable\u0026#34;); Future\u0026lt;String\u0026gt; future = executorService.submit(callable); // This line executes immediately  System.out.println(\u0026#34;Do something else while callable is getting executed\u0026#34;); System.out.println(\u0026#34;Retrieve the result of the future\u0026#34;); // Future.get() ä¼šé˜»å¡çŸ¥é“Futureä¸­å¾—åˆ°äº†è¿”å›çš„ç»“æœ  String result = future.get(); System.out.println(result); executorService.shutdown(); } }   æˆ–è€…å¯ä»¥ä½¿ç”¨è¿™ä¸ªä¾‹å­è¿›è¡Œæµ‹è¯•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  mport java.util.concurrent.*; public class FutureIsDoneExample { public static void main(String[] args) throws InterruptedException, ExecutionException { ExecutorService executorService = Executors.newSingleThreadExecutor(); Future\u0026lt;String\u0026gt; future = executorService.submit(() -\u0026gt; { Thread.sleep(2000); return \u0026#34;Hello from Callable\u0026#34;; }); while(!future.isDone()) { System.out.println(\u0026#34;Task is still not done...\u0026#34;); Thread.sleep(200); } System.out.println(\u0026#34;Task completed! Retrieving the result\u0026#34;); String result = future.get(); System.out.println(result); executorService.shutdown(); } }   è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š\n# Output Task is still not done... Task is still not done... Task is still not done... Task is still not done... Task is still not done... Task is still not done... Task is still not done... Task is still not done... Task is still not done... Task is still not done... Task completed! Retrieving the result Hello from Callable åœ¨æ²¡æœ‰å¾—åˆ°ç»“æœçš„æ—¶å€™ï¼ŒisDone()çš„è¿”å›å€¼éƒ½æ˜¯falseï¼Œè¿™å°†å¯¼è‡´é˜»å¡ã€‚\nå–æ¶ˆFuture ä½ å¯ä»¥ä½¿ç”¨Future.cancel()æ–¹æ³•å–æ¶ˆä¸€ä¸ªFutureã€‚å®ƒè¯•å›¾å–æ¶ˆä»»åŠ¡çš„æ‰§è¡Œï¼Œå¦‚æœæˆåŠŸå–æ¶ˆåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚\næ‚¨å¯ä»¥ä½¿ç”¨isCancelled()æ–¹æ³•æ¥æ£€æŸ¥ä»»åŠ¡æ˜¯å¦è¢«å–æ¶ˆã€‚æ­¤å¤–ï¼Œå–æ¶ˆä»»åŠ¡åï¼ŒisDone() å°†å§‹ç»ˆä¸ºçœŸã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  import java.util.concurrent.*; public class FutureCancelExample { public static void main(String[] args) throws InterruptedException, ExecutionException { ExecutorService executorService = Executors.newSingleThreadExecutor(); long startTime = System.nanoTime(); Future\u0026lt;String\u0026gt; future = executorService.submit(() -\u0026gt; { Thread.sleep(2000); return \u0026#34;Hello from Callable\u0026#34;; }); while(!future.isDone()) { System.out.println(\u0026#34;Task is still not done...\u0026#34;); Thread.sleep(200); double elapsedTimeInSec = (System.nanoTime() - startTime)/1000000000.0; if(elapsedTimeInSec \u0026gt; 1) { future.cancel(true); } } System.out.println(\u0026#34;Task completed! Retrieving the result\u0026#34;); String result = future.get(); System.out.println(result); executorService.shutdown(); } }   è·‘ä¸Šé¢çš„ä»£ç å°†ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå› ä¸ºå·²ç»å–æ¶ˆäº†Futureï¼Œç„¶ååˆå®ç”¨get()æ–¹æ³•è·å–Futureçš„å€¼ã€‚\nTask is still not done... Task is still not done... Task is still not done... Task is still not done... Task is still not done... Task completed! Retrieving the result Exception in thread \u0026quot;main\u0026quot; java.util.concurrent.CancellationException at java.util.concurrent.FutureTask.report(FutureTask.java:121) at java.util.concurrent.FutureTask.get(FutureTask.java:192) at com.sankuai.stafftraining.wujiahong.demo.springdemo.concurrency.MainApp.test3(MainApp.java:79) at com.sankuai.stafftraining.wujiahong.demo.springdemo.concurrency.MainApp.main(MainApp.java:12) æœ€å¥½æ˜¯é€šè¿‡ä¸‹é¢è¿™ç§æ–¹æ³•è¿›è¡Œåˆ¤æ–­ï¼š\n1 2 3 4 5 6 7  if(!future.isCancelled()) { System.out.println(\u0026#34;Task completed! Retrieving the result\u0026#34;); String result = future.get(); System.out.println(result); } else { System.out.println(\u0026#34;Task was cancelled\u0026#34;); }   invokeAllæ–¹æ³• æäº¤å¤šä¸ªä»»åŠ¡å¹¶ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆã€‚\nä½ å¯ä»¥é€šè¿‡å‘invokeAll()æ–¹æ³•ä¼ é€’ä¸€ä¸ªCallablesçš„é›†åˆæ¥æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚invokeAll()è¿”å›ä¸€ä¸ªFuturesçš„åˆ—è¡¨ã€‚ä»»ä½•å¯¹future.get()çš„è°ƒç”¨éƒ½ä¼šè¢«é˜»æ­¢ï¼Œç›´åˆ°æ‰€æœ‰çš„Futureséƒ½å®Œæˆã€‚\nä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  import java.util.Arrays; import java.util.List; import java.util.concurrent.*; public class InvokeAllExample { public static void main(String[] args) throws InterruptedException, ExecutionException { ExecutorService executorService = Executors.newFixedThreadPool(5); Callable\u0026lt;String\u0026gt; task1 = () -\u0026gt; { Thread.sleep(2000); return \u0026#34;Result of Task1\u0026#34;; }; Callable\u0026lt;String\u0026gt; task2 = () -\u0026gt; { Thread.sleep(1000); return \u0026#34;Result of Task2\u0026#34;; }; Callable\u0026lt;String\u0026gt; task3 = () -\u0026gt; { Thread.sleep(5000); return \u0026#34;Result of Task3\u0026#34;; }; List\u0026lt;Callable\u0026lt;String\u0026gt;\u0026gt; taskList = Arrays.asList(task1, task2, task3); List\u0026lt;Future\u0026lt;String\u0026gt;\u0026gt; futures = executorService.invokeAll(taskList); for(Future\u0026lt;String\u0026gt; future: futures) { // The result is printed only after all the futures are complete. (i.e. after 5 seconds)  System.out.println(future.get()); } executorService.shutdown(); } }   åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨ future.get() è¯­å¥ä¼šé˜»å¡ï¼Œç›´åˆ°æ‰€æœ‰çš„æœŸè´§éƒ½å®Œæˆã€‚å³ç»“æœå°†åœ¨ 5 ç§’åæ‰“å°ã€‚\nè¾“å‡ºçš„ç»“æœä¸ºï¼š\nResult of Task1 Result of Task2 Result of Task3 invokeAnyæ–¹æ³• æäº¤å¤šä¸ªä»»åŠ¡å¹¶ç­‰å¾…å…¶ä¸­ä»»ä½•ä¸€ä¸ªå®Œæˆ.\ninvokeAny() æ–¹æ³•æ¥å—ä¸€ä¸ª Callables é›†åˆå¹¶è¿”å›æœ€å¿«çš„ Callable çš„ç»“æœã€‚è¯·æ³¨æ„ï¼Œå®ƒä¸ä¼šè¿”å› Futureã€‚\nä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  import java.util.Arrays; import java.util.List; import java.util.concurrent.*; public class InvokeAnyExample { public static void main(String[] args) throws InterruptedException, ExecutionException { ExecutorService executorService = Executors.newFixedThreadPool(5); Callable\u0026lt;String\u0026gt; task1 = () -\u0026gt; { Thread.sleep(2000); return \u0026#34;Result of Task1\u0026#34;; }; Callable\u0026lt;String\u0026gt; task2 = () -\u0026gt; { Thread.sleep(1000); return \u0026#34;Result of Task2\u0026#34;; }; Callable\u0026lt;String\u0026gt; task3 = () -\u0026gt; { Thread.sleep(5000); return \u0026#34;Result of Task3\u0026#34;; }; // Returns the result of the fastest callable. (task2 in this case)  String result = executorService.invokeAny(Arrays.asList(task1, task2, task3)); System.out.println(result); executorService.shutdown(); } }   è¾“å‡ºå¦‚ä¸‹ï¼š\nResult of Task2 Future çš„å±€é™  ä¸èƒ½æ‰‹åŠ¨å®Œæˆã€‚ï¼ˆFutureè°ƒç”¨çš„ä»»åŠ¡å¤±è´¥äº†ä¸èƒ½æ‰‹åŠ¨è¿›è¡Œå®Œæˆï¼‰ Future çš„ç»“æœåœ¨éé˜»å¡çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½æ‰§è¡Œæ›´è¿›ä¸€æ­¥çš„æ“ä½œã€‚ï¼ˆæ— æ³•ç»™ Future æ¤å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼‰ å¤šä¸ª Future ä¸èƒ½ä¸²è”åœ¨ä¸€èµ·ç»„æˆé“¾å¼è°ƒç”¨ã€‚ ä¸èƒ½ç»„åˆå¤šä¸ª Future çš„ç»“æœã€‚ æ²¡æœ‰å¼‚å¸¸å¤„ç†ã€‚  CompletableFutureç®€ä»‹ å¹¶å‘ä¸å¹¶è¡Œçš„åŒºåˆ«ï¼š\né¿å…é˜»å¡ï¼Œåº”ç”¨é€šè¿‡ ä¸å„ç§ç½‘ç»œæœåŠ¡é€šä¿¡ï¼Œæ›¿ç”¨æˆ·å®æ—¶æ•´åˆéœ€è¦çš„ä¿¡æ¯ï¼Œæˆ–è€…å°†æ•´åˆçš„ä¿¡æ¯ä½œä¸ºè¿›ä¸€æ­¥çš„ç½‘ç»œæœåŠ¡ æä¾›å‡ºå»ã€‚è¿™ç§å·¥ä½œæ–¹å¼è¢«ç§°ä¸ºååº”å¼ç¼–ç¨‹ã€‚\nCompletableFutureèƒ½å¤Ÿè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ CompletableFutureæ˜¯Java8å¼•å…¥çš„ï¼Œåœ¨Java8ä¹‹å‰ä¸€èˆ¬é€šè¿‡Futureå®ç°å¼‚æ­¥ã€‚(ä½†æ˜¯æ˜¯é˜»å¡çš„)\n Futureæ¨¡å¼å¯ä»¥ç†è§£æˆï¼šæˆ‘æœ‰ä¸€ä¸ªä»»åŠ¡ï¼Œæäº¤ç»™äº†Futureï¼ŒFutureæ›¿æˆ‘å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚æœŸé—´æˆ‘è‡ªå·±å¯ä»¥å»åšä»»ä½•æƒ³åšçš„äº‹æƒ…ã€‚ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæˆ‘å°±ä¾¿å¯ä»¥ä»Futureé‚£å„¿å–å‡ºç»“æœã€‚\n CompletableFutureå…·å¤‡ä»€ä¹ˆåŠŸèƒ½ï¼Ÿ  å¯ç»„åˆã€‚ï¼ˆæä¾›thenComposeã€thenCombineç­‰å„ç§thenå¼€å¤´çš„æ–¹æ³•ï¼‰ å¼‚æ­¥ã€‚  æ¯”è¾ƒ CompletableFutureæ˜¯Java8å¼•å…¥çš„ï¼Œåœ¨Java8ä¹‹å‰ä¸€èˆ¬é€šè¿‡Futureå®ç°å¼‚æ­¥ã€‚\n  Futureç”¨äºè¡¨ç¤ºå¼‚æ­¥è®¡ç®—çš„ç»“æœï¼Œåªèƒ½é€šè¿‡é˜»å¡æˆ–è€…è½®è¯¢çš„æ–¹å¼è·å–ç»“æœï¼Œè€Œä¸”ä¸æ”¯æŒè®¾ç½®å›è°ƒæ–¹æ³•ï¼ŒJava8ä¹‹å‰è‹¥è¦è®¾ç½®å›è°ƒä¸€èˆ¬ä¼šä½¿ç”¨guavaçš„ListenableFutureï¼Œå›è°ƒçš„å¼•å…¥åˆä¼šå¯¼è‡´è‡­åæ˜­è‘—çš„â€œå›è°ƒåœ°ç‹±â€ã€‚\n  CompletableFutureå¯¹Futureè¿›è¡Œäº†æ‰©å±•ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®å›è°ƒçš„æ–¹å¼å¤„ç†è®¡ç®—ç»“æœï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒç»„åˆæ“ä½œï¼Œæ”¯æŒè¿›ä¸€æ­¥çš„ç¼–æ’ï¼ŒåŒæ—¶ä¸€å®šç¨‹åº¦è§£å†³äº†å›è°ƒåœ°ç‹±çš„é—®é¢˜ã€‚\n  å‡è®¾æœ‰ä¸‰ä¸ªæ“ä½œå­˜åœ¨ä¾èµ–å…³ç³»ï¼Œstep1 -\u0026gt; step2 -\u0026gt; step3éœ€è¦å‰é¢æ­¥éª¤æ‰§è¡ŒæˆåŠŸå†æ‰§è¡Œåé¢æ­¥éª¤ã€‚\nFuture(ListenableFuture)çš„å®ç°ï¼ˆå›è°ƒåœ°ç‹±ï¼‰å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46  ExecutorService executor = Executors.newFixedThreadPool(5); ListeningExecutorService guavaExecutor = MoreExecutors.listeningDecorator(executor); ListenableFuture\u0026lt;Object\u0026gt; future1 = guavaExecutor.submit(() -\u0026gt; { //step 1  System.out.println(\u0026#34;æ‰§è¡Œstep1\u0026#34;); return true; }); Futures.addCallback(future1, new FutureCallback\u0026lt;Object\u0026gt;() { @Override public void onSuccess(Object step1Result) { ListenableFuture\u0026lt;Object\u0026gt; future2 = guavaExecutor.submit(() -\u0026gt; { System.out.println(\u0026#34;æ‰§è¡Œstep 2\u0026#34;); return true; }); Futures.addCallback(future2, new FutureCallback\u0026lt;Object\u0026gt;() { @Override public void onSuccess(Object result) { ListenableFuture\u0026lt;Object\u0026gt; future3 = guavaExecutor.submit(() -\u0026gt; { System.out.println(\u0026#34;æ‰§è¡Œstep 3\u0026#34;); return true; }); Futures.addCallback(future3, new FutureCallback\u0026lt;Object\u0026gt;() { @Override public void onSuccess(Object result) { System.out.println(\u0026#34;è¿™æ˜¯step 3æ‰§è¡Œç»“æœ\u0026#34;); } @Override public void onFailure(Throwable t) { } }, guavaExecutor); } @Override public void onFailure(Throwable t) { } }, guavaExecutor); System.out.println(\u0026#34;æ‰§è¡Œstep2\u0026#34;); } @Override public void onFailure(Throwable throwable) { } }, guavaExecutor);   CompletableFutureçš„å®ç°å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  ExecutorService executor = Executors.newFixedThreadPool(5); CompletableFuture .supplyAsync(() -\u0026gt; { System.out.println(\u0026#34;æ‰§è¡Œstep 1\u0026#34;); return new Object(); }, executor) .thenApply(result1 -\u0026gt; { System.out.println(\u0026#34;æ‰§è¡Œstep 2\u0026#34;); return new Object(); }) .thenApply(result1 -\u0026gt; { System.out.println(\u0026#34;æ‰§è¡Œstep 3\u0026#34;); return new Object(); });   æ˜¾ç„¶ï¼ŒCompletableFutureçš„å®ç°è¦æ›´ä¸ºç®€æ´ï¼Œå¯è¯»æ€§æ›´å¥½ã€‚\nä½¿ç”¨ ç®€å•ä½¿ç”¨ åˆ›å»ºCompletableFutureï¼š\n1  CompletableFuture\u0026lt;String\u0026gt; completableFuture = new CompletableFuture\u0026lt;String\u0026gt;();   è¡¨ç¤ºåˆ›å»ºäº†ä¸€ä¸ªè¿”å›å€¼ä¸ºStringçš„CompletableFutureçš„å¯¹è±¡ã€‚\nåŒæ ·ï¼Œç±»ä¼¼Futureï¼ŒCompletableFutureä¹Ÿä½¿ç”¨getæ–¹æ³•è·å–è¿”å›ç»“æœï¼Œè¿™ä¹Ÿæ˜¯é˜»å¡çš„ï¼Œå½“æˆ‘ä»¬ç›´æ¥è¿è¡Œä¸‹é¢çš„è¯­å¥ï¼š\n1  String result = completableFuture.get()   å®ƒå°†ä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ã€‚\nå¯ä»¥ä½¿ç”¨CompletableFuture.complete()æ‰‹å·¥çš„å®Œæˆä¸€ä¸ª Future:\n1  completableFuture.complete(\u0026#34;Future\u0026#39;s Result\u0026#34;);   æ‰€æœ‰ç­‰å¾…è¿™ä¸ª Future çš„å®¢æˆ·ç«¯éƒ½å°†å¾—åˆ°ä¸€ä¸ªæŒ‡å®šçš„ç»“æœï¼Œå¹¶ä¸” completableFuture.complete() ä¹‹åçš„è°ƒç”¨å°†è¢«å¿½ç•¥ã€‚\nrunAsync() è¿™ä¸ªé€‚ç”¨äºæ— è¿”å›å€¼çš„å¼‚æ­¥æ‰§è¡Œã€‚\nCompletableFuture.runAsync()æ–¹æ³•ï¼Œå®ƒæŒæœ‰ä¸€ä¸ªRunnable å¯¹è±¡ï¼Œå¹¶è¿”å› CompletableFuture\u0026lt;Void\u0026gt;ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  // Run a task specified by a Runnable Object asynchronously. CompletableFuture\u0026lt;Void\u0026gt; future = CompletableFuture.runAsync(new Runnable() { @Override public void run() { // Simulate a long-running Job  try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { throw new IllegalStateException(e); } System.out.println(\u0026#34;I\u0026#39;ll run in a separate thread than the main thread.\u0026#34;); } }); // Block and wait for the future to complete future.get()   æˆ–è€…ï¼š\n1 2 3 4 5 6 7 8 9 10  // Using Lambda Expression CompletableFuture\u0026lt;Void\u0026gt; future = CompletableFuture.runAsync(() -\u0026gt; { // Simulate a long-running Job  try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { throw new IllegalStateException(e); } System.out.println(\u0026#34;I\u0026#39;ll run in a separate thread than the main thread.\u0026#34;); });   supplyAsync() é€‚ç”¨äºæœ‰è¿”å›å€¼çš„å¼‚æ­¥è®¡ç®—ã€‚\nCompletableFuture.supplyAsync() æŒæœ‰supplier\u0026lt;T\u0026gt; å¹¶ä¸”è¿”å›CompletableFuture\u0026lt;T\u0026gt;ï¼ŒT æ˜¯é€šè¿‡è°ƒç”¨ ä¼ å…¥çš„supplierå–å¾—çš„å€¼çš„ç±»å‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  // Run a task specified by a Supplier object asynchronously CompletableFuture\u0026lt;String\u0026gt; future = CompletableFuture.supplyAsync(new Supplier\u0026lt;String\u0026gt;() { @Override public String get() { try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { throw new IllegalStateException(e); } return \u0026#34;Result of the asynchronous computation\u0026#34;; } }); // Block and get the result of the Future String result = future.get(); System.out.println(result);   æˆ–è€…ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  // Run a task specified by a Supplier object asynchronously CompletableFuture\u0026lt;String\u0026gt; future = CompletableFuture.supplyAsync(new Supplier\u0026lt;String\u0026gt;() { @Override public String get() { try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { throw new IllegalStateException(e); } return \u0026#34;Result of the asynchronous computation\u0026#34;; } }); // Block and get the result of the Future String result = future.get(); System.out.println(result);    æœ€å¥½åŠ ä¸Šä¸€ä¸ªçº¿ç¨‹æ± çš„å‚æ•°ï¼Œä¸ç„¶é»˜è®¤ä»å…¨å±€çš„ ForkJoinPool.commonPool()è·å¾—ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œè¿™äº›ä»»åŠ¡ã€‚\n// Variations of runAsync() and supplyAsync() methods static CompletableFuture\u0026lt;Void\u0026gt; runAsync(Runnable runnable) static CompletableFuture\u0026lt;Void\u0026gt; runAsync(Runnable runnable, Executor executor) static \u0026lt;U\u0026gt; CompletableFuture\u0026lt;U\u0026gt; supplyAsync(Supplier\u0026lt;U\u0026gt; supplier) static \u0026lt;U\u0026gt; CompletableFuture\u0026lt;U\u0026gt; supplyAsync(Supplier\u0026lt;U\u0026gt; supplier, Executor executor)  ä¸Šé¢çš„å‡ ä¸ªæ–¹æ³•å…¶å®è¿˜æ˜¯é˜»å¡çš„ã€‚å®ƒä¼šä¸€ç›´ç­‰åˆ°Futureå®Œæˆå¹¶ä¸”åœ¨å®Œæˆåè¿”å›ç»“æœã€‚è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæˆ‘ä»¬æƒ³è¦çš„æ˜¯åœ¨å®ƒæ‰§è¡Œå®Œæˆä¹‹åè°ƒç”¨æˆ‘ä»¬è‡ªå·±çš„é€»è¾‘ã€‚å¯¹äºæ„å»ºå¼‚æ­¥ç³»ç»Ÿï¼Œæˆ‘ä»¬åº”è¯¥é™„ä¸Šä¸€ä¸ªå›è°ƒç»™CompletableFutureï¼Œå½“Futureå®Œæˆçš„æ—¶å€™ï¼Œè‡ªåŠ¨çš„è·å–ç»“æœã€‚\nå¯ä»¥ä½¿ç”¨ thenApply(), thenAccept() å’ŒthenRun()æ–¹æ³•é™„ä¸Šä¸€ä¸ªå›è°ƒç»™CompletableFutureã€‚\nthenApply() å®ç°è°ƒç”¨é“¾ã€‚\nä½¿ç”¨ thenApply() å¤„ç†å’Œæ”¹å˜CompletableFutureçš„ç»“æœã€‚æŒæœ‰ä¸€ä¸ªFunction\u0026lt;R,T\u0026gt;ä½œä¸ºå‚æ•°ã€‚Function\u0026lt;R,T\u0026gt;æ˜¯ä¸€ä¸ªç®€å•çš„å‡½æ•°å¼æ¥å£ï¼Œæ¥å—ä¸€ä¸ªTç±»å‹çš„å‚æ•°ï¼Œäº§å‡ºä¸€ä¸ªRç±»å‹çš„ç»“æœã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  // Create a CompletableFuture CompletableFuture\u0026lt;String\u0026gt; whatsYourNameFuture = CompletableFuture.supplyAsync(() -\u0026gt; { try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { throw new IllegalStateException(e); } return \u0026#34;Rajeev\u0026#34;; }); // Attach a callback to the Future using thenApply() CompletableFuture\u0026lt;String\u0026gt; greetingFuture = whatsYourNameFuture.thenApply(name -\u0026gt; { return \u0026#34;Hello \u0026#34; + name; }); // Block and get the result of the future. System.out.println(greetingFuture.get()); // Hello Rajeev   thenAccept() å’Œ thenRun() å¦‚æœä½ ä¸æƒ³ä»ä½ çš„å›è°ƒå‡½æ•°ä¸­è¿”å›ä»»ä½•ä¸œè¥¿ï¼Œä»…ä»…æƒ³åœ¨Futureå®Œæˆåè¿è¡Œä¸€äº›ä»£ç ç‰‡æ®µï¼Œä½ å¯ä»¥ä½¿ç”¨thenAccept() å’Œ thenRun()æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ç»å¸¸åœ¨è°ƒç”¨é“¾çš„æœ€æœ«ç«¯çš„æœ€åä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­ä½¿ç”¨ã€‚\nCompletableFuture.thenAccept() æŒæœ‰ä¸€ä¸ªConsumer\u0026lt;T\u0026gt; ï¼Œè¿”å›ä¸€ä¸ªCompletableFuture\u0026lt;Void\u0026gt;ã€‚å®ƒå¯ä»¥è®¿é—®CompletableFutureçš„ç»“æœï¼š\n1 2 3 4 5 6  // thenAccept() example CompletableFuture.supplyAsync(() -\u0026gt; { return ProductService.getProductDetail(productId); }).thenAccept(product -\u0026gt; { System.out.println(\u0026#34;Got product detail from remote service \u0026#34; + product.getName()) });   è™½ç„¶thenAccept()å¯ä»¥è®¿é—®CompletableFutureçš„ç»“æœï¼Œä½†thenRun()ä¸èƒ½è®¿Futureçš„ç»“æœï¼Œå®ƒæŒæœ‰ä¸€ä¸ªRunnableè¿”å›CompletableFutureï¼š\n1 2 3 4 5 6  // thenRun() example CompletableFuture.supplyAsync(() -\u0026gt; { // Run some computation }).thenRun(() -\u0026gt; { // Computation Finished. });   thenCompose()-ç»„åˆ ç»„åˆä¸¤ä¸ªç‹¬ç«‹çš„futureã€‚\nåŸæ¥å‡è®¾æƒ³ä»ä¸€ä¸ªè¿œç¨‹APIä¸­è·å–ä¸€ä¸ªç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¸€æ—¦ç”¨æˆ·ä¿¡æ¯å¯ç”¨ï¼Œä½ æƒ³ä»å¦å¤–ä¸€ä¸ªæœåŠ¡ä¸­è·å–ä»–çš„è´·æ–¹ã€‚ä»£ç æ˜¯è¿™æ ·çš„ï¼š\n1 2 3 4 5 6 7 8 9 10 11  CompletableFuture\u0026lt;User\u0026gt; getUsersDetail(String userId) { return CompletableFuture.supplyAsync(() -\u0026gt; { UserService.getUserDetails(userId); }); } CompletableFuture\u0026lt;Double\u0026gt; getCreditRating(User user) { return CompletableFuture.supplyAsync(() -\u0026gt; { CreditRatingService.getCreditRating(user); }); }   ä½¿ç”¨äº†thenApply()å¯ä»¥è¿›è¡Œå¼‚æ­¥è°ƒç”¨ï¼Œå¹¶ä¸”ä»£ç éå¸¸ç®€æ´ï¼š\n1 2  CompletableFuture\u0026lt;CompletableFuture\u0026lt;Double\u0026gt;\u0026gt; result = getUserDetail(userId) .thenApply(user -\u0026gt; getCreditRating(user));    åœ¨æ›´æ—©çš„ç¤ºä¾‹ä¸­ï¼ŒSupplierå‡½æ•°ä¼ å…¥thenApplyå°†è¿”å›ä¸€ä¸ªç®€å•çš„å€¼ï¼Œä½†æ˜¯åœ¨æœ¬ä¾‹ä¸­ï¼Œå°†è¿”å›ä¸€ä¸ªCompletableFutureã€‚ä»¥ä¸Šç¤ºä¾‹çš„æœ€ç»ˆç»“æœæ˜¯ä¸€ä¸ªåµŒå¥—çš„CompletableFutureã€‚\nå¦‚æœä½ æƒ³è·å–æœ€ç»ˆçš„ç»“æœç»™æœ€é¡¶å±‚futureï¼Œä½¿ç”¨ thenCompose()æ–¹æ³•ä»£æ›¿\n1 2  CompletableFuture\u0026lt;Double\u0026gt; result = getUserDetail(userId) .thenCompose(user -\u0026gt; getCreditRating(user));    thenCombine()-ç»„åˆæ“ä½œ è™½ç„¶thenCompose()è¢«ç”¨äºå½“ä¸€ä¸ªfutureä¾èµ–å¦å¤–ä¸€ä¸ªfutureçš„æ—¶å€™ç”¨æ¥ç»„åˆä¸¤ä¸ªfutureã€‚thenCombine()è¢«ç”¨æ¥å½“ä¸¤ä¸ªç‹¬ç«‹çš„Futureéƒ½å®Œæˆçš„æ—¶å€™ï¼Œç”¨æ¥åšä¸€äº›äº‹æƒ…ã€‚\nä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  System.out.println(\u0026#34;Retrieving weight.\u0026#34;); CompletableFuture\u0026lt;Double\u0026gt; weightInKgFuture = CompletableFuture.supplyAsync(() -\u0026gt; { try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { throw new IllegalStateException(e); } return 65.0; }); System.out.println(\u0026#34;Retrieving height.\u0026#34;); CompletableFuture\u0026lt;Double\u0026gt; heightInCmFuture = CompletableFuture.supplyAsync(() -\u0026gt; { try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { throw new IllegalStateException(e); } return 177.8; }); System.out.println(\u0026#34;Calculating BMI.\u0026#34;); CompletableFuture\u0026lt;Double\u0026gt; combinedFuture = weightInKgFuture .thenCombine(heightInCmFuture, (weightInKg, heightInCm) -\u0026gt; { Double heightInMeter = heightInCm/100; return weightInKg/(heightInMeter*heightInMeter); }); System.out.println(\u0026#34;Your BMI is - \u0026#34; + combinedFuture.get());   å½“ä¸¤ä¸ªFutureéƒ½å®Œæˆçš„æ—¶å€™ï¼Œä¼ ç»™thenCombine()çš„å›è°ƒå‡½æ•°å°†è¢«è°ƒç”¨ã€‚\nå‰é¢éƒ½æ˜¯ç»„åˆä¸¤ä¸ªçš„CompletableFutureæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ç»„åˆä»»æ„æ•°é‡çš„CompletableFutureã€‚\n1 2  static CompletableFuture\u0026lt;Void\u0026gt; allOf(CompletableFuture\u0026lt;?\u0026gt;... cfs) static CompletableFuture\u0026lt;Object\u0026gt; anyOf(CompletableFuture\u0026lt;?\u0026gt;... cfs)   CompletableFuture.allOf()-ç»„åˆå¤šä¸ªï¼ˆå…¨éƒ¨ï¼‰ CompletableFuture.allOfçš„ä½¿ç”¨åœºæ™¯æ˜¯å½“ä½ ä¸€ä¸ªåˆ—è¡¨çš„ç‹¬ç«‹futureï¼Œå¹¶ä¸”ä½ æƒ³åœ¨å®ƒä»¬éƒ½å®Œæˆåå¹¶è¡Œçš„åšä¸€äº›äº‹æƒ…ã€‚\nä¸€èˆ¬æ˜¯ä¸€æ¬¡æ•°æ®çš„è¯·æ±‚éœ€è¦è°ƒç”¨å¤šä¸ªæœåŠ¡è¿›è¡ŒæŸ¥è¯¢ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•åŠ å¿«æ“ä½œçš„é€Ÿåº¦ã€‚ä½†æ˜¯ï¼Œå¯¹äºåŒä¸€ä¸ªæœåŠ¡çš„å¾ªç¯å·®å…¶å®æ²¡æœ‰å®è´¨æ€§çš„æé«˜ã€‚\nå®šä¹‰ä¸€ä¸ªä¸‹è½½é¡µé¢çš„æ–¹æ³•:\n1 2 3 4 5  CompletableFuture\u0026lt;String\u0026gt; downloadWebPage(String pageLink) { return CompletableFuture.supplyAsync(() -\u0026gt; { // Code to download and return the web page\u0026#39;s content  }); }   ä¸‹è½½ä¸€ä¸ªç½‘ç«™çš„100ä¸ªä¸åŒçš„é¡µé¢ï¼Œä½¿ç”¨allofæ–¹æ³•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12  List\u0026lt;String\u0026gt; webPageLinks = Arrays.asList(...) // A list of 100 web page links  // Download contents of all the web pages asynchronously List\u0026lt;CompletableFuture\u0026lt;String\u0026gt;\u0026gt; pageContentFutures = webPageLinks.stream() .map(webPageLink -\u0026gt; downloadWebPage(webPageLink)) .collect(Collectors.toList()); // Create a combined Future using allOf() CompletableFuture\u0026lt;Void\u0026gt; allFutures = CompletableFuture.allOf( pageContentFutures.toArray(new CompletableFuture[pageContentFutures.size()]) );   ä½¿ç”¨CompletableFuture.allOf()çš„é—®é¢˜æ˜¯å®ƒè¿”å›CompletableFutureã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å†™ä¸€äº›é¢å¤–çš„ä»£ç æ¥è·å–æ‰€æœ‰å°è£…çš„CompletableFutureç»“æœã€‚\n1 2 3 4 5 6  // When all the Futures are completed, call `future.join()` to get their results and collect the results in a list - CompletableFuture\u0026lt;List\u0026lt;String\u0026gt;\u0026gt; allPageContentsFuture = allFutures.thenApply(v -\u0026gt; { return pageContentFutures.stream() .map(pageContentFuture -\u0026gt; pageContentFuture.join()) .collect(Collectors.toList()); });    å½“æ‰€æœ‰futureå®Œæˆçš„æ—¶å€™ï¼Œæˆ‘ä»¬è°ƒç”¨äº†future.join()ï¼Œå› æ­¤æˆ‘ä»¬ä¸ä¼šåœ¨ä»»ä½•åœ°æ–¹é˜»å¡ã€‚\n join()æ–¹æ³•å’Œget()æ–¹æ³•éå¸¸ç±»ä¼¼ï¼Œè¿™å”¯ä¸€ä¸åŒçš„åœ°æ–¹æ˜¯å¦‚æœæœ€é¡¶å±‚çš„CompletableFutureå®Œæˆçš„æ—¶å€™å‘ç”Ÿäº†å¼‚å¸¸ï¼Œå®ƒä¼šæŠ›å‡ºä¸€ä¸ªæœªç»æ£€æŸ¥çš„å¼‚å¸¸ã€‚\nç°åœ¨è®©æˆ‘ä»¬è®¡ç®—åŒ…å«å…³é”®å­—é¡µé¢çš„æ•°é‡ã€‚\n1 2 3 4 5 6 7 8 9  // Count the number of web pages having the \u0026#34;CompletableFuture\u0026#34; keyword. CompletableFuture\u0026lt;Long\u0026gt; countFuture = allPageContentsFuture.thenApply(pageContents -\u0026gt; { return pageContents.stream() .filter(pageContent -\u0026gt; pageContent.contains(\u0026#34;CompletableFuture\u0026#34;)) .count(); }); System.out.println(\u0026#34;Number of Web Pages having CompletableFuture keyword - \u0026#34; + countFuture.get());   CompletableFuture.anyOf()-ç»„åˆå¤šä¸ªï¼ˆä»»æ„ï¼‰ CompletableFuture.anyOf()å’Œå…¶åå­—ä»‹ç»çš„ä¸€æ ·ï¼Œå½“ä»»ä½•ä¸€ä¸ªCompletableFutureå®Œæˆçš„æ—¶å€™ã€ç›¸åŒçš„ç»“æœç±»å‹ã€‘ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„CompletableFutureã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  CompletableFuture\u0026lt;String\u0026gt; future1 = CompletableFuture.supplyAsync(() -\u0026gt; { try { TimeUnit.SECONDS.sleep(2); } catch (InterruptedException e) { throw new IllegalStateException(e); } return \u0026#34;Result of Future 1\u0026#34;; }); CompletableFuture\u0026lt;String\u0026gt; future2 = CompletableFuture.supplyAsync(() -\u0026gt; { try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { throw new IllegalStateException(e); } return \u0026#34;Result of Future 2\u0026#34;; }); CompletableFuture\u0026lt;String\u0026gt; future3 = CompletableFuture.supplyAsync(() -\u0026gt; { try { TimeUnit.SECONDS.sleep(3); } catch (InterruptedException e) { throw new IllegalStateException(e); } return \u0026#34;Result of Future 3\u0026#34;; }); CompletableFuture\u0026lt;Object\u0026gt; anyOfFuture = CompletableFuture.anyOf(future1, future2, future3); System.out.println(anyOfFuture.get()); // Result of Future 2   å½“ä¸‰ä¸ªä¸­çš„ä»»ä½•ä¸€ä¸ªCompletableFutureå®Œæˆï¼Œ anyOfFutureå°±ä¼šå®Œæˆã€‚å› ä¸ºfuture2çš„ä¼‘çœ æ—¶é—´æœ€å°‘ï¼Œå› æ­¤å¥¹æœ€å…ˆå®Œæˆï¼Œæœ€ç»ˆçš„ç»“æœå°†æ˜¯future2çš„ç»“æœã€‚\n CompletableFuture.anyOf()ä¼ å…¥ä¸€ä¸ªFutureå¯å˜å‚æ•°ï¼Œè¿”å›CompletableFutureã€‚CompletableFuture.anyOf()çš„é—®é¢˜æ˜¯å¦‚æœä½ çš„CompletableFutureè¿”å›çš„ç»“æœæ˜¯ä¸åŒç±»å‹çš„ï¼Œè¿™æ—¶å€™ä½ è®²ä¼šä¸çŸ¥é“ä½ æœ€ç»ˆCompletableFutureæ˜¯ä»€ä¹ˆç±»å‹ã€‚\n å¼‚å¸¸å¤„ç† 1. ä½¿ç”¨ exceptionally() å›è°ƒå¤„ç†å¼‚å¸¸\nexceptionally()å›è°ƒç»™ä½ ä¸€ä¸ªä»åŸå§‹Futureä¸­ç”Ÿæˆçš„é”™è¯¯æ¢å¤çš„æœºä¼šã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œè®°å½•è¿™ä¸ªå¼‚å¸¸å¹¶è¿”å›ä¸€ä¸ªé»˜è®¤å€¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  Integer age = -1; CompletableFuture\u0026lt;String\u0026gt; maturityFuture = CompletableFuture.supplyAsync(() -\u0026gt; { if(age \u0026lt; 0) { throw new IllegalArgumentException(\u0026#34;Age can not be negative\u0026#34;); } if(age \u0026gt; 18) { return \u0026#34;Adult\u0026#34;; } else { return \u0026#34;Child\u0026#34;; } }).exceptionally(ex -\u0026gt; { // åœ¨æ­¤å¤„æ‰“å°ç›¸å…³çš„æ—¥å¿—ï¼Œè¿”å›å€¼éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªæŒ‡å®šçš„å€¼ï¼Œç„¶ååœ¨åé¢è¿›è¡Œè¿‡æ»¤  System.out.println(\u0026#34;Oops! We have an exception - \u0026#34; + ex.getMessage()); return \u0026#34;Unknown!\u0026#34;; }); System.out.println(\u0026#34;Maturity : \u0026#34; + maturityFuture.get());   2. ä½¿ç”¨ handle() æ–¹æ³•å¤„ç†å¼‚å¸¸\nAPIæä¾›äº†ä¸€ä¸ªæ›´é€šç”¨çš„æ–¹æ³• - handle()ä»å¼‚å¸¸æ¢å¤ï¼Œæ— è®ºä¸€ä¸ªå¼‚å¸¸æ˜¯å¦å‘ç”Ÿå®ƒéƒ½ä¼šè¢«è°ƒç”¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  Integer age = -1; CompletableFuture\u0026lt;String\u0026gt; maturityFuture = CompletableFuture.supplyAsync(() -\u0026gt; { if(age \u0026lt; 0) { throw new IllegalArgumentException(\u0026#34;Age can not be negative\u0026#34;); } if(age \u0026gt; 18) { return \u0026#34;Adult\u0026#34;; } else { return \u0026#34;Child\u0026#34;; } }).handle((res, ex) -\u0026gt; { if(ex != null) { System.out.println(\u0026#34;Oops! We have an exception - \u0026#34; + ex.getMessage()); return \u0026#34;Unknown!\u0026#34;; } return res; }); System.out.println(\u0026#34;Maturity : \u0026#34; + maturityFuture.get());   å¦‚æœå¼‚å¸¸å‘ç”Ÿï¼Œreså‚æ•°å°†æ˜¯ nullï¼Œå¦åˆ™ï¼Œexå°†æ˜¯ nullã€‚\nåŒºåˆ« supplyAsyncï¼š\n å½“åªæ˜¯æŒ‡å®šç¬¬ä¸€ä¸ªå‚æ•°ï¼Œé»˜è®¤ä½¿ç”¨çš„çº¿ç¨‹æ± æ˜¯ ForkJoinPool.commonPool() å½“æŒ‡å®šç¬¬äºŒä¸ªçº¿ç¨‹æ± çš„å‚æ•°ï¼Œä½¿ç”¨çš„æ˜¯è‡ªå®šä¹‰çš„çº¿ç¨‹  supplyAsyncè¡¨ç¤ºå¼€å¯ä¸€ä¸ªæœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡ã€‚\nå¯ä»¥ä½¿ç”¨ thenAccept å’Œ thenApply ç»™å®ƒå¢åŠ å›è°ƒå‡½æ•°ã€‚åŒæ ·ï¼ŒthenAccept å’Œ thenApply ä¹Ÿæœ‰åŒæ ·çš„å¼‚æ­¥å‡½æ•°thenAcceptAsync å’Œ thenApplyAsync ï¼Œå¯ä»¥è®©é€»è¾‘æ‰§è¡Œåœ¨è®¾å®šçš„çº¿ç¨‹æ± ä¸Šã€‚\nåŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«ï¼š\nå‡è®¾æˆ‘ä»¬æƒ³ä¸€æ¬¡å‘åŒä¸€ä¸ªæ¥æ”¶è€…å‘é€ä¸¤æ¡æ¶ˆæ¯ã€‚\n1 2 3 4  CompletableFuture\u0026lt;String\u0026gt; receiver = CompletableFuture.supplyAsync(this::findReceiver); receiver.thenApply(this::sendMsg); receiver.thenApply(this::sendOtherMsg);   åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¸€åˆ‡éƒ½å°†åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸Šæ‰§è¡Œã€‚è¿™å¯¼è‡´æœ€åä¸€æ¡æ¶ˆæ¯ç­‰å¾…ç¬¬ä¸€æ¡æ¶ˆæ¯å®Œæˆã€‚\nè€ƒè™‘è¿™ä¸ªä»£ç :\n1 2 3 4 5  CompletableFuture\u0026lt;String\u0026gt; receiver = CompletableFuture.supplyAsync(this::findReceiver); receiver.thenApplyAsync(this::sendMsg); receiver.thenApplyAsync(this::sendMsg);   é€šè¿‡ä½¿ç”¨asyncåç¼€ï¼Œæ¯ä¸ªæ¶ˆæ¯è¢«ä½œä¸ºå•ç‹¬çš„ä»»åŠ¡æäº¤ç»™ForkJoinPool.commonPool()ã€‚è¿™å¯¼è‡´åœ¨å®Œæˆå‰é¢çš„è®¡ç®—æ—¶ï¼ŒsendMsgçš„å›è°ƒéƒ½è¢«æ‰§è¡Œã€‚\nä¸€ä¸ªæµ‹è¯•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  //thenApplyå’ŒthenApplyAsyncçš„åŒºåˆ« System.out.println(\u0026#34;-------------\u0026#34;); CompletableFuture\u0026lt;String\u0026gt; supplyAsyncWithSleep = CompletableFuture.supplyAsync(()-\u0026gt;{ try { Thread.sleep(10000); } catch (InterruptedException e) { e.printStackTrace(); } return \u0026#34;supplyAsyncWithSleep Thread Id : \u0026#34; + Thread.currentThread(); }); CompletableFuture\u0026lt;String\u0026gt; thenApply = supplyAsyncWithSleep .thenApply(name -\u0026gt; name + \u0026#34;------thenApply Thread Id : \u0026#34; + Thread.currentThread()); CompletableFuture\u0026lt;String\u0026gt; thenApplyAsync = supplyAsyncWithSleep .thenApplyAsync(name -\u0026gt; name + \u0026#34;------thenApplyAsync Thread Id : \u0026#34; + Thread.currentThread()); System.out.println(\u0026#34;Main Thread Id: \u0026#34;+ Thread.currentThread()); System.out.println(thenApply.get()); System.out.println(thenApplyAsync.get()); System.out.println(\u0026#34;-------------No Sleep\u0026#34;); CompletableFuture\u0026lt;String\u0026gt; supplyAsyncNoSleep = CompletableFuture.supplyAsync(()-\u0026gt;{ return \u0026#34;supplyAsyncNoSleep Thread Id : \u0026#34; + Thread.currentThread(); }); CompletableFuture\u0026lt;String\u0026gt; thenApplyNoSleep = supplyAsyncNoSleep .thenApply(name -\u0026gt; name + \u0026#34;------thenApply Thread Id : \u0026#34; + Thread.currentThread()); CompletableFuture\u0026lt;String\u0026gt; thenApplyAsyncNoSleep = supplyAsyncNoSleep .thenApplyAsync(name -\u0026gt; name + \u0026#34;------thenApplyAsync Thread Id : \u0026#34; + Thread.currentThread()); System.out.println(\u0026#34;Main Thread Id: \u0026#34;+ Thread.currentThread()); System.out.println(thenApplyNoSleep.get()); System.out.println(thenApplyAsyncNoSleep.get());   åˆ†åˆ«æµ‹è¯•æ‰§è¡Œä¸åŒå¤„ç†é€Ÿåº¦çš„ä»£ç ï¼ŒthenApply å’Œ thenApplyAsync ä½¿ç”¨çš„æ˜¯å“ªä¸ªçº¿ç¨‹ï¼š\n------------- Main Thread Id: Thread[main,5,main] supplyAsyncWithSleep Thread Id : Thread[ForkJoinPool.commonPool-worker-9,5,main]------thenApply Thread Id : Thread[ForkJoinPool.commonPool-worker-9,5,main] supplyAsyncWithSleep Thread Id : Thread[ForkJoinPool.commonPool-worker-9,5,main]------thenApplyAsync Thread Id : Thread[ForkJoinPool.commonPool-worker-9,5,main] -------------No Sleep Main Thread Id: Thread[main,5,main] supplyAsyncNoSleep Thread Id : Thread[ForkJoinPool.commonPool-worker-2,5,main]------thenApply Thread Id : Thread[main,5,main] supplyAsyncNoSleep Thread Id : Thread[ForkJoinPool.commonPool-worker-2,5,main]------thenApplyAsync Thread Id : Thread[ForkJoinPool.commonPool-worker-2,5,main] å¯ä»¥çœ‹åˆ°\n supplyAsyncæ–¹æ³•æ‰§è¡Œé€Ÿåº¦æ…¢çš„è¯thenApplyæ–¹æ³•æ‰§è¡Œçº¿ç¨‹å’ŒsupplyAsync æ‰§è¡Œçº¿ç¨‹ç›¸åŒ supplyAsync æ–¹æ³•æ‰§è¡Œé€Ÿåº¦å¿«çš„è¯ï¼Œé‚£ä¹ˆthenApplyæ–¹æ³•æ‰§è¡Œçº¿ç¨‹å’ŒMainæ–¹æ³•æ‰§è¡Œçº¿ç¨‹ç›¸åŒ  è¿”å›å€¼    æ–¹æ³•å æ˜¯å¦å¯è·å¾—å‰ä¸€ä¸ªä»»åŠ¡çš„è¿”å›å€¼ æ˜¯å¦æœ‰è¿”å›å€¼     thenApply èƒ½è·å¾— æœ‰   thenAccept èƒ½è·å¾— æ—    thenRun ä¸å¯è·å¾— æ—     æ‰€ä»¥ä¸€èˆ¬æ¥è¯´thenAccept ã€thenRun è¿™ä¸¤ä¸ªæ–¹æ³•åœ¨è°ƒç”¨é“¾çš„æœ€æœ«ç«¯ä½¿ç”¨ã€‚\näºŒå…ƒä¾èµ–  thenCombine:ä¸¤ä¸ªå¼‚æ­¥æ–¹æ³•å¾—å‡ºæ¥å€¼çš„æƒ…å†µä¸‹æ‰èƒ½è¿›è¡Œè®¡ç®— thenCompose:äºŒä¸ªå®šæ—¶ä»»åŠ¡éœ€è¦ç”¨åˆ°ç¬¬ä¸€ä¸ªå®šæ—¶ä»»åŠ¡çš„è¿”å›å€¼ runAfterBoth  äºŒé€‰ä¸€ï¼šacceptEither\nfirstSource.acceptEither(secondSource, this::sendMsg);\næ€»ç»“  CompletableFutureä½¿ç”¨getæ–¹æ³•å’Œjoinæ–¹æ³•ä¼šé˜»å¡åç»­çš„æ“ä½œã€‚ ä¸é˜»å¡çš„è¯å¹¶ä¸”ä¸éœ€è¦è¿”å›å€¼å¯ä»¥ç›´æ¥ä¸æ˜¾ç¤ºçš„ä½¿ç”¨getæ–¹æ³•å’Œjoinæ–¹æ³•ã€‚  ä½¿ç”¨åœºæ™¯  ä½ ä»¥å‰å¯èƒ½æ¥è§¦è¿‡ CompletableFuture å¯¹è±¡èƒŒåçš„æ¦‚å¿µï¼Œåœ¨å…¶ä»–è¯­è¨€ä¸­è¿™è¢« å«ä½œå»¶è¿Ÿå¯¹è±¡æˆ–çº¦å®šã€‚åœ¨Google Guavaç±»åº“å’ŒSpringæ¡†æ¶ä¸­ï¼Œè¿™è¢«å«ä½œ ListenableFuturesã€‚\n å¤šæœåŠ¡è°ƒç”¨ å®é™…çš„æƒ…å†µå¯èƒ½æ˜¯è¿™æ ·å­\nå¤šçº¿ç¨‹ç»„è£…æ•°æ®ã€‚ æ¯ä¸€ä¸ªåˆ†ç‰‡æ•°æ®éƒ½ç”¨ä¸€ä¸ªCompletableFutureæ‰§è¡Œã€‚\nJoinï¼Œå®ƒçš„ä½œç”¨å’Œ get æ–¹æ³• æ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”å®ƒæ²¡æœ‰ä½¿ç”¨ get æ–¹æ³•æ—¶ä»¤äººå€’èƒƒå£çš„æ£€æŸ¥å¼‚å¸¸ã€‚\njoinæŠ›å‡ºuncheckerå¼‚å¸¸ï¼Œè€ŒgetæŠ›å‡ºcheckedå¼‚å¸¸\næ··åˆä½¿Streamå’ŒCompletableFutureçš„æ—¶å€™éœ€è¦æ³¨æ„âš ï¸ï¼š\nè€ƒè™‘æ“ä½œä¹‹é—´çš„å»¶è¿Ÿç‰¹æ€§ï¼Œå¦‚ä½•ä½ åœ¨å•ä¸€æµæ°´çº¿ä¸­å¤„ç†æµï¼Œæ¯ä¸ªåˆ›å»ºCompletableFuture å¯¹è±¡åªèƒ½åœ¨å‰ä¸€ä¸ªæ“ä½œç»“æŸä¹‹åæ‰èƒ½åˆ›å»ºã€‚\næœ€å¥½æ˜¯å°†CompletableFutureå…ˆèšé›†åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚ç„¶åå†å±Œç”¨joinã€‚\nåŸç† é€šå¸¸ï¼Œè®¾è®¡å’Œç†è§£å¹¶å‘ç³»ç»Ÿæœ€å¥½çš„æ–¹å¼æ˜¯ä½¿ç”¨å›¾å½¢:\nä¸Šé¢çš„å›¾å½¢å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥å®ç°ï¼š\n1 2  int t = p(x); System.out.println( r(q1(t), q2(t)) );   ä½¿ç”¨Futureæ–¹æ³•ï¼š\n1 2 3 4  int t = p(x); Future\u0026lt;Integer\u0026gt; a1 = executorService.submit(() -\u0026gt; q1(t)); Future\u0026lt;Integer\u0026gt; a2 = executorService.submit(() -\u0026gt; q2(t)); System.out.println( r(a1.get(),a2.get()));   CompletableFutureä½¿ç”¨çš„æ˜¯ä¸€ç§è§‚å¯Ÿè€…æ¨¡å¼è¿›è¡Œå®ç°çš„ã€‚\nä½¿ç”¨CompletableFutureä¹Ÿæ˜¯æ„å»ºä¾èµ–æ ‘çš„è¿‡ç¨‹ï¼Œä¸€ä¸ªCompletableFutureçš„å®Œæˆä¼šè§¦å‘å¦å¤–ä¸€ç³»åˆ—ä¾èµ–å®ƒçš„CompletableFutureçš„æ‰§è¡Œï¼š\nJavaå®æˆ˜ æˆ‘ä»¬å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ€»æ˜¯éœ€è¦è°ƒç”¨å¤šä¸ªæœåŠ¡ï¼Œå‡å¦‚æ²¡æœ‰ä½¿ç”¨å¹¶å‘è¿›è¡Œç¼–ç¨‹ï¼Œé‚£ä¹ˆï¼Œåœ¨ä¸€ä¸ªæœåŠ¡è¿”å›ç»“æœä¹‹å‰ï¼Œè¿™éƒ½æ˜¯é˜»å¡çš„ï¼Œä¸èƒ½æ‰§è¡Œå…¶ä»–çš„ä»»åŠ¡ã€‚ç„¶è€Œï¼Œä½ å¹¶ä¸å¸Œæœ›ç”±äºè¦ç­‰å¾…è¿œç¨‹æœåŠ¡çš„å“åº”ï¼Œé˜»å¡ç°æœ‰çš„è®¡ç®—ä»»åŠ¡å¹¶ç™½ç™½æµªè´¹ CPU ä¸­æ•°åäº¿ä¸ªå®è´µçš„æ—¶ô²ôµ‘æœŸã€‚è­¬ å¦‚ï¼Œä½ ä¸åº”è¯¥ç”±äºè¦ç­‰å¾… Facebook æ•°æ®çš„è¿”å›è€Œôµ’æ­¢å¯¹ Twitter æ•°æ®çš„å¤„ç†ã€‚\nJavaçš„å¹¶å‘ä¹‹è·¯  ä¸€å¼€å§‹å°±æä¾›äº†é”(é€šè¿‡ synchronized ç±»å’Œæ–¹æ³•)ã€Runnable ä»¥åŠçº¿ç¨‹ã€‚ 2004 å¹´ï¼Œ Java 5 åˆå¼•å…¥äº† java.util.concurrent åŒ…ã€‚ï¼ˆå¼•å…¥ExecutorServiceã€Callableä»¥åŠ Futureï¼‰ Java 7 ä¸ºäº†ä½¿ç”¨ fork/join å®ç°åˆ†è€Œôµ¬ä¹‹ç®—æ³•ï¼Œæ–° å¢äº†java.util.concurrent.RecursiveTask Java 8åˆ™å¢åŠ äº†å¯¹æµå’Œæµçš„å¹¶è¡Œå¤„ç†(ä¾èµ–äºæ–°å¢çš„ Lambda è¡¨è¾¾å¼)çš„æ”¯æŒ Java 8è¿˜æ”¯æŒç»„åˆå¼çš„Future(åŸºäºJava 8CompleteFutureå®ç°çš„Futureï¼‰ Java 9 æä¾›äº†å¯¹åˆ†å¸ƒå¼å¼‚æ­¥ç¼–ç¨‹çš„æ˜¾å¼æ”¯æŒã€‚ï¼ˆé€šè¿‡ java.util.concurrent.Flow æ¥å£ï¼‰   CompletableFuture åŠ java.util.concurrent.Flow çš„å…³é”®ç†å¿µæ˜¯æä¾›ä¸€ç§ç¨‹åºç»“æ„ï¼Œè®©ç›¸äº’ç‹¬ç«‹çš„ä»»åŠ¡å°½å¯èƒ½åœ°å¹¶å‘æ‰§è¡Œï¼Œé€šè¿‡è¿™ç§æ–¹å¼æœ€å¤§åŒ–åœ°åˆ©ç”¨å¤šæ ¸æˆ–è€…å¤šå°æœºå™¨æä¾›çš„å¹¶å‘èƒ½åŠ›ã€‚\n å¤šçº¿ç¨‹å¹¶å‘å†…å¹• åœ¨ä¸€ä¸ªå¤šæ ¸çš„ç¯å¢ƒä¸­ï¼Œå•ç”¨æˆ·ç™»å½•çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šå¯èƒ½åªå¯åŠ¨äº†ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹ï¼Œè¿™ç§ç¨‹åºæ°¸è¿œä¸èƒ½å……åˆ†å‘æŒ¥è®¡ç®—æœºçš„å¤„ç†èƒ½åŠ›ï¼Œé™¤éä½¿ç”¨å¤šçº¿ç¨‹ã€‚è™½ç„¶æ¯ä¸ªæ ¸å¯ä»¥æœåŠ¡ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œä½†æ˜¯å¦‚æœä½ çš„ç¨‹åºå¹¶æœªä½¿ç”¨å¤šçº¿ç¨‹ï¼Œé‚£å®ƒåŒä¸€æ—¶åˆ»èƒ½æœ‰æ•ˆä½¿ç”¨çš„åªæœ‰å¤„ç†å™¨ä¼—å¤šæ ¸ä¸­çš„ä¸€ä¸ªã€‚\nè¿™éœ€è¦æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™æ³¨æ„ä½¿ç”¨å¤šçº¿ç¨‹å¹¶å‘ç¼–ç¨‹ï¼Œä»¥å……åˆ†å‘æŒ¥è®¡ç®—æœºçš„å¤„ç†èƒ½åŠ›ã€‚\n  çº¿ç¨‹çš„é—®é¢˜\nJava çº¿ç¨‹ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ã€‚è¿™é‡Œä¸»è¦çš„é—®é¢˜åœ¨äºåˆ›å»ºå’Œô³’é™¤æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„ä»£ä»·å¾ˆ å¤§(æ¶‰åŠé¡µè¡¨æ“ä½œ)ï¼Œå¹¶ä¸”ä¸€ä¸ªç³»ç»Ÿä¸­èƒ½åˆ›å»ºçš„çº¿ç¨‹æ•°ç›®æ˜¯æœ‰é™çš„ã€‚å¦‚æœåˆ›å»ºçš„çº¿ç¨‹æ•°è¶…è¿‡æ“ä½œç³»ç»Ÿçš„é™åˆ¶ï¼Œå¾ˆå¯èƒ½å¯¼è‡´ Java åº”ç”¨è«åå…¶å¦™åœ°å´©æºƒï¼Œå› æ­¤ä½ éœ€è¦ç‰¹åˆ«ç•™æ„ï¼Œä¸è¦åœ¨çº¿ç¨‹è¿è¡Œæ—¶ æŒç»­ä¸æ–­åœ°åˆ›å»ºæ–°çº¿ç¨‹ã€‚å¹¶ä¸”æ“ä½œç³»ç»Ÿ(ä»¥åŠ Java)çš„çº¿ç¨‹æ•°éƒ½è¿œè¿œå¤§äºç¡¬ä»¶çº¿ç¨‹æ•°ï¼Œå› æ­¤å³ä¾¿ä¸€äº›æ“ä½œç³»ç»Ÿçº¿ç¨‹è¢«é˜»å¡äº†ï¼Œæˆ–è€…å¤„äºç¡çœ çŠ¶æ€ã€‚\n  çº¿ç¨‹æ± çš„ä¼˜åŠ¿\nJava çš„ ExecutorService æä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œç”¨æˆ·å¯ä»¥æäº¤ä»»åŠ¡å¹¶è·å–å®ƒä»¬çš„æ‰§è¡Œç»“æœã€‚æ–°åˆ›å»º çš„çº¿ç¨‹ä¼šè¢«æ”¾å…¥ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæ¯æ¬¡æœ‰æ–°ä»»åŠ¡è¯·æ±‚æ—¶ï¼Œä»¥å…ˆæ¥å…ˆåˆ°çš„ôµ¼ç•¥ä»çº¿ç¨‹æ± ä¸­é€‰å–æœªè¢«ä½¿ç”¨ çš„çº¿ç¨‹æ‰§è¡Œæäº¤çš„ä»»åŠ¡è¯·æ±‚ã€‚ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œè¿™äº›çº¿ç¨‹åˆä¼šè¢«å½’è¿˜ç»™çº¿ç¨‹æ± ã€‚è¿™ç§æ–¹å¼çš„æœ€å¤§ä¼˜åŠ¿åœ¨äºèƒ½ä»¥å¾ˆä½çš„æˆæœ¬å‘çº¿ç¨‹æ± æäº¤ä¸Šåƒä¸ªä»»åŠ¡ï¼ŒåŒæ—¶ä¿è¯ç¡¬ä»¶åŒ¹é…çš„ä»»åŠ¡æ‰§è¡Œã€‚\n  çº¿ç¨‹æ± çš„ä¸è¶³\n  ä½¿ç”¨ k ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± åªèƒ½å¹¶å‘åœ°æ‰§è¡Œ k ä¸ªä»»åŠ¡\næäº¤çš„ä»»åŠ¡å¦‚æœè¶…è¿‡è¿™ä¸ªé™åˆ¶ï¼Œçº¿ç¨‹æ± ä¸ä¼šåˆ›å»ºæ–°çº¿ç¨‹å»æ‰§è¡Œè¯¥ä»»åŠ¡ï¼Œè¿™äº›è¶…é™çš„ä»»åŠ¡ä¼šè¢«åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œç›´åˆ°ç°æœ‰ä»»åŠ¡æ‰§è¡Œ å®Œæ¯•æ‰ä¼šé‡æ–°è°ƒåº¦ç©ºé—²çº¿ç¨‹å»æ‰§è¡Œæ–°ä»»åŠ¡ã€‚\n é‡‡ç”¨è¿™ç§æ–¹å¼æ—¶ä½  éœ€è¦ç‰¹åˆ«ç•™æ„ä»»åŠ¡æ˜¯å¦å­˜åœ¨ä¼šè¿›å…¥ç¡çœ ã€ç­‰å¾… I/O ç»“ô°…æˆ–è€…ç­‰å¾…ç½‘ç»œè¿æ¥çš„æƒ…å†µã€‚ä¸€æ—¦å‘ ç”Ÿé˜»å¡å¼ I/Oï¼Œè¿™äº›ä»»åŠ¡å ç”¨äº†çº¿ç¨‹ï¼Œå´ä¼šç”±äºç­‰å¾…æ— æ³•æ‰§è¡Œæœ‰ä»·å€¼çš„å·¥ä½œã€‚\nä¾‹å¦‚ï¼Œå‡å¦‚CPUæœ‰4ä¸ªç¡¬ä»¶çº¿ç¨‹ï¼Œä½ åˆ›å»ºäº†ä¸€ä¸ªå¤§å°ä¸º5çš„çº¿ç¨‹æ± ï¼Œä½ ä¸€æ¬¡æ€§æäº¤äº† 20 ä¸ªæ‰§è¡Œä»»åŠ¡ï¼Œå¸Œæœ›è¿™20ä¸ªä»»åŠ¡å¹¶å‘çš„æ‰§è¡Œï¼Œç›´åˆ°æ‰€æœ‰ 20 ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ã€‚å‡è®¾é¦–æ‰¹æäº¤çš„ çº¿ç¨‹ä¸­æœ‰ 3 ä¸ªçº¿ç¨‹è¿›å…¥äº†é˜»å¡çŠ¶æ€æˆ–è€…åœ¨ç­‰å¾… I/Oï¼Œé‚£å°±åªå‰©2 ä¸ªçº¿ç¨‹å¯ä»¥æœåŠ¡å‰©ä¸‹çš„ 15 ä¸ªä»»åŠ¡äº†ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œä½ åªèƒ½å–å¾—ä½ ä¹‹å‰é¢„æœŸååé‡çš„ä¸€åŠ(å¦‚æœä½ åˆ›å»ºçš„çº¿ç¨‹æ± ä¸­å·¥ ä½œçº¿ç¨‹æ•°ä¸º 8ï¼Œé‚£ä¹ˆè¿˜æ˜¯èƒ½å–å¾—åŒæ ·é¢„æœŸååé‡çš„)ã€‚\n   é€šå¸¸æƒ…å†µä¸‹ï¼ŒJava ä» main è¿”å›ä¹‹å‰ï¼Œéƒ½ä¼šç­‰å¾…æ‰€æœ‰çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œä»è€Œé¿å…è¯¯æ€æ­£åœ¨æ‰§è¡Œå…³é”®ä»£ç çš„çº¿ç¨‹ã€‚\nå®é™…æ“ä½œæ—¶çš„ä¸€ä¸ªå¥½ä¹ æƒ¯æ˜¯åœ¨é€€å‡ºç¨‹åºæ‰§è¡Œä¹‹å‰ï¼Œç¡®ä¿å…³é—­æ¯ä¸€ä¸ªçº¿ç¨‹æ± ã€‚\n    ä½ å¸Œæœ›é‡‡ç”¨çº¿ç¨‹æŠ€æœ¯ç†ç¨‹åºçš„ç»“æ„ï¼Œä»¥ä¾¿åœ¨éœ€è¦çš„æ—¶å€™äº«å—ç¨‹åºå¹¶è¡Œå¸¦æ¥çš„å¥½å¤„ï¼Œç”Ÿæˆè¶³å¤Ÿå¤šçš„ä»»åŠ¡ä»¥å……åˆ†åˆ©ç”¨æ‰€æœ‰ç¡¬ä»¶çº¿ç¨‹ã€‚è¿™æ„å‘³ç€ä½ éœ€è¦å¯¹ç¨‹åºè¿›è¡Œåˆ‡åˆ†ã€‚\nä½¿å¤šçº¿ç¨‹çš„æ¼”è¿›è¿‡ç¨‹ å¤šäºå‡½æ•° f(x) å’Œ g(x)ï¼Œåˆ†åˆ«ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹å»å¹¶å‘æ‰§è¡Œã€‚\nä½¿ç”¨Runnableï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  class ThreadExample { public static void main(String[] args) throws InterruptedException { int x = 1337; Result result = new Result(); Thread t1 = new Thread(() -\u0026gt; { result.left = f(x); } ); Thread t2 = new Thread(() -\u0026gt; { result.right = g(x); }); t1.start(); t2.start(); t1.join(); t2.join(); System.out.println(result.left + result.right); } private static class Result { private int left; private int right; } }   ä½¿ç”¨çº¿ç¨‹æ± å’ŒFutureï¼š\n1 2 3 4 5 6 7 8 9 10  public class ExecutorServiceExample { public static void main(String[] args) throws ExecutionException, InterruptedException { int x = 1337; ExecutorService executorService = Executors.newFixedThreadPool(2); Future\u0026lt;Integer\u0026gt; y = executorService.submit(() -\u0026gt; f(x)); Future\u0026lt;Integer\u0026gt; z = executorService.submit(() -\u0026gt; g(x)); System.out.println(y.get() + z.get()); executorService.shutdown(); } }   ç„¶è€Œï¼Œè¿™æ®µä»£ç ä¾ç„¶å—åˆ°äº†æ˜¾å¼è°ƒç”¨ submit æ—¶ä½¿ç”¨çš„æ¨¡æ¿ä»£ç çš„æ±¡æŸ“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶å®è¿™ä¸ªæ¯ç‡¥çš„æ“ä½œå…¶å®ä¹Ÿæ˜¯å¯ä»¥çœç•¥çš„ã€‚\nè§£å†³è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ˜¯å°† API ç”±åŒæ­¥ API å˜ä¸ºæ­¥ APIï¼Œä¹Ÿå°±æ˜¯å¢åŠ å¼‚æ­¥çš„APIå‡½æ•°ã€‚\nä½¿ç”¨çº¿ç¨‹æ± å’ŒCompletableFutureï¼š\n1 2 3 4 5 6 7 8 9 10 11  public class ExecutorServiceExample { public static void main(String[] args) throws ExecutionException, InterruptedException { int x = 1337; ExecutorService executorService = Executors.newFixedThreadPool(2); CompletableFuture\u0026lt;Integer\u0026gt; y = CompletableFuture.supplyAsync(() -\u0026gt; f(x),executorService); CompletableFuture\u0026lt;Integer\u0026gt; z = CompletableFuture.supplyAsync(() -\u0026gt; g(x),executorService); CompletableFuture\u0026lt;Integer\u0026gt; result = y.thenCombine(z,(y_val,z_val) -\u0026gt; {return y_val + z_val;} ) System.out.println(result.get()); executorService.shutdown(); } }   ä½¿ç”¨ååº”å¼çš„APIï¼š(åŸºäºå›è°ƒå‡½æ•°)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  public class CallbackStyleExample { public static void main(String[] args) { System.out.println((result.left + result.right)); int x = 1337; Result result = new Result(); f(x, (int y) -\u0026gt; { result.left = y; }); g(x, (int z) -\u0026gt; { result.right = z; System.out.println((result.left + result.right)); 7 }); } }    æ³¨æ„ï¼Œååº”å¼ç¼–ç¨‹å…è®¸æ–¹æ³• f å’Œ g å¤šæ¬¡è°ƒç”¨å®ƒä»¬çš„å›è°ƒå‡½æ•° dealWithResultã€‚è€ŒåŸå§‹ç‰ˆ\næœ¬çš„ f å’Œ g ä½¿ç”¨ return è¿”å›ç»“æœï¼Œreturn åªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡ã€‚Future ä¸æ­¤ç±»ä¼¼ï¼Œå®ƒä¹Ÿåªèƒ½å®Œ æˆä¸€æ¬¡ï¼Œæ‰§è¡Œ Future çš„è®¡ç®—ç»“æœå¯ä»¥é€šè¿‡ get()æ–¹æ³•è·å–ã€‚\n å¯èƒ½é˜»å¡çº¿ç¨‹çš„å› ç´  é˜»å¡å¼æ“ä½œå¯ä»¥åˆ†ä¸ºä¸¤ç±»:\n ä¸€ç±»æ˜¯ç­‰å¾…å¦ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œï¼Œè­¬å¦‚è°ƒç”¨ Future çš„ get()æ–¹æ³•; å¦ä¸€ç±»æ˜¯ç­‰å¾…ä¸å¤–éƒ¨äº¤äº’çš„è¿”å›ï¼Œè­¬å¦‚ä»ç½‘ç»œã€æ•°æ®åº“æœåŠ¡å™¨æˆ–è€…é”®ç›˜è¿™æ ·çš„äººæœºæ¥å£è¯»å–æ•°æ®ã€‚   ç¡çœ ä¹Ÿä¼šé˜»å¡ã€‚\n å­¦ä¹ å¹¶å‘çš„æ¨¡å¼ é€šå¸¸ï¼Œè®¾è®¡å’Œç†è§£å¹¶å‘ç³»ç»Ÿæœ€å¥½çš„æ–¹å¼æ˜¯ä½¿ç”¨å›¾å½¢ã€‚æˆ‘ä»¬å°†è¿™ç§æŠ€æœ¯ç§°çº¿ç¨‹-ç®¡é“ (box-and-channel)æ¨¡å‹ã€‚\nè¿™å…¶å®æ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„ä¸€ç§å®ç°ã€‚\nä½¿ç”¨CompletableFuture CompletableFutureå’Œå¹¶è¡Œæµçš„å®ç°æ–¹å¼ç±»ä¼¼çš„ï¼Œå®ƒä»¬å†…éƒ¨éƒ½æ˜¯è°ƒç”¨å¤šçº¿ç¨‹è¿›è¡Œæ‰§è¡Œï¼Œç„¶è€ŒCompletableFutureå¯ä»¥å…è®¸è®¾ç½®çº¿ç¨‹æ± ï¼ŒæŒ‡å®šçº¿ç¨‹çš„æ•°é‡ï¼ˆçº¿ç¨‹æ± çš„å¤§å°ï¼‰ï¼Œå¹¶ä¸”æ”¯æŒç»„åˆæ¨¡å¼ã€‚\n å¹¶è¡Œæµæ˜¯æŠŠå†…å®¹æ‹†åˆ†æˆå¤šä¸ªæ•°æ®å—ï¼Œç”¨ä¸åŒçº¿ç¨‹å¤„ç†æ¯ä¸ªæ•°æ®å—çš„æ•°æ®ã€‚è¿™æ ·ä»¥æ¥ï¼Œå°±å¯ä»¥è‡ªåŠ¨çš„æŠŠå·¥ä½œçš„è´Ÿè·åˆ†é…åˆ°å¤šæ ¸å¤„ç†å™¨çš„æ‰€æœ‰æ ¸ï¼Œè®©ä»–ä»¬éƒ½å¿™èµ·æ¥ã€‚\n ä½¿ç”¨Asyncè¿˜æ˜¯åŒæ­¥APIçš„åˆ¤æ–­æ ‡å‡†ï¼š\n ä¸€èˆ¬æƒ…å†µä¸‹æ“ä½œä¸æ¶‰åŠè¿œç¨‹æœåŠ¡å’ŒI/Oæ“ä½œï¼Œå¯ä»¥é‡‡ç”¨åŒæ­¥API å…¶ä»–è€—æ—¶çš„æ“ä½œå¯ä»¥ä½¿ç”¨å¼‚æ­¥APIã€‚   é€šå¸¸è€Œè¨€ï¼Œåç§°ä¸­ä¸å¸¦Asyncçš„æ–¹æ³•å’Œå®ƒçš„å‰ä¸€ä¸ªä»»åŠ¡ä¸€æ ·ï¼Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­è¿è¡Œï¼Œè€Œåç§°ä»¥Asyncç»“å°¾çš„æ–¹æ³•ä¼šå°†åç»­çš„ä»»åŠ¡æäº¤åˆ°ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæ‰€ä»¥æ¯ä¸ªä»»åŠ¡æ˜¯ç”±ä¸åŒçš„çº¿ç¨‹å¤„ç†çš„ã€‚å¯¹äºä¸å¤æ‚çš„å»¶è¿Ÿä½çš„æ“ä½œï¼Œå°½é‡å¤ç”¨åŒä¸€ä¸ªè¿›ç¨‹ï¼Œå‡å°‘è¿›ç¨‹é—´åˆ‡æ¢çš„å¼€é”€ã€‚\n Javaä¸­çš„çº¿ç¨‹æ±  å‚è€ƒï¼šã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹\nçº¿ç¨‹æ± çš„å¥½å¤„  é™ä½èµ„æºæŸè€—ã€‚ æé«˜å“åº”é€Ÿåº¦ã€‚ æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚  Reference:\n å½»åº•ç†è§£Javaçš„Futureæ¨¡å¼ - å¤§è¯šæŒš - åšå®¢å›­ CompletableFutureçš„åŸç†ä¸å®è·µ-è®°å¤–å–å•†å®¶ç«¯APIçš„å¼‚æ­¥åŒ– Java 8 CompletableFuture æ•™ç¨‹ - SegmentFault æ€å¦ å…³äºå®ç°Runnableæ¥å£ä¸èƒ½æŠ›å¼‚å¸¸åªèƒ½æ•è·å¼‚å¸¸åŸå› _å°æ—å­çš„åšå®¢-CSDNåšå®¢ Java Callable and Future Tutorial | CalliCoder ~ Javaå¯è°ƒç”¨å’Œæœªæ¥æ•™ç¨‹ | CalliCoder ä½¿ç”¨CompletableFutureå¼‚æ­¥ç»„è£…æ•°æ® Java: Writing asynchronous code with CompletableFuture Java8â€”â€”å¼‚æ­¥ç¼–ç¨‹ - Mr.å¢¨æ–—çš„åšå®¢ | MoDou Blog  ","description":"","id":2,"section":"posts","tags":["Java","CompletableFuture"],"title":"CompletableFutureç¬”è®°","uri":"https://hugo.jiahongw.com/zh/posts/java/completablefuture/"},{"content":"è®¾è®¡åŸåˆ™ 1.å•ä¸€èŒè´£åŸåˆ™\n2.å¼€é—­åŸåˆ™\n3.é‡Œæ°æ›¿æ¢åŸåˆ™\n4.ä¾èµ–æ³¨å…¥åŸåˆ™\n5.æ¥å£åˆ†ç¦»åŸåˆ™\n6.è¿ªç±³ç‰¹åŸåˆ™\n å°†å˜åŒ–çš„ä¸œè¥¿æŠ½ç¦»å‡ºæ¥å¹¶ä¸”å°è£…ï¼Œä¸€æ–¹é¢å’ŒåŸæ¥çš„é€»è¾‘è§£è€¦ï¼Œå¦ä¸€æ–¹é¢ï¼Œä¾¿äºåé¢è¿›è¡Œä¿®æ”¹ã€‚\n å¦‚ä½•åˆ¤æ–­å•ä¸€èŒè´£ï¼Ÿ\n ä»£ç çš„å‡½æ•°å¤ªå¤šï¼Œå‡½æ•°æˆ–è€…å±æ€§è¿‡å¤š ä¾èµ–å…¶ä»–ç±»è¿‡å¤š ç§æœ‰æ–¹æ³•è¿‡å¤š æ¯”è¾ƒéš¾ç»™ç±»èµ·ä¸€ä¸ªåˆé€‚åå­—ï¼Œå¾ˆéš¾ç”¨ä¸€ä¸ªä¸šåŠ¡åè¯æ¦‚æ‹¬ï¼Œæˆ–è€…åªèƒ½ç”¨ä¸€äº›ç¬¼ç»Ÿçš„ Managerã€Context ä¹‹ç±»çš„è¯è¯­æ¥å‘½å ç±»ä¸­å¤§é‡çš„æ–¹æ³•éƒ½æ˜¯é›†ä¸­æ“ä½œç±»ä¸­çš„æŸå‡ ä¸ªå±æ€§  å¦‚ä½•ç†è§£å¼€é—­åŸåˆ™ï¼Ÿ\nåªè¦å¯¹åŸæ¥çš„ä»£ç ä¾µå…¥æ€§ä¸å¤§ï¼Œä¸å½±å“ä¸»è¦æµæ°´ï¼Œéƒ½æ˜¯ä¸€ä¸ªåˆæ ¼çš„æ‹“å±•ä»£ç \nè®¾è®¡æ¨¡å¼ ç®€å•å·¥å‚æ¨¡å¼ Simple Factory Pattern\nä¸­æ–‡\tè‹±æ–‡\nåˆ›å»ºå‹æ¨¡å¼ï¼š\n1.å·¥å‚æ–¹æ³•æ¨¡å¼\tFactory Method Pattern\n2.æŠ½è±¡å·¥å‚æ¨¡å¼\tAbstract Factory Pattern\n3.å»ºé€ è€…æ¨¡å¼\tBuilder Pattern\n4.åŸå‹æ¨¡å¼\tPrototype Pattern\n5.å•ä¾‹æ¨¡å¼\tSingleton Pattern\nç»“æ„å‹æ¨¡å¼ï¼š\n6.é€‚é…å™¨æ¨¡å¼\tAdapter Pattern\n7.æ¡¥æ¢æ¨¡å¼/æ¡¥æ¥æ¨¡å¼\tBridge Pattern\n8.ç»„åˆæ¨¡å¼\tComposite Pattern\n9.è£…é¥°æ¨¡å¼\tDecorator Pattern\n10.é—¨é¢æ¨¡å¼/å¤–è§‚æ¨¡å¼\tFacade Pattern\n11.äº«å…ƒæ¨¡å¼\tFlyweight Pattern\n12.ä»£ç†æ¨¡å¼\tProxy pattern\nè¡Œä¸ºæ¨¡å¼ï¼š\n13.è´£ä»»é“¾æ¨¡å¼\tChain of Responsibility Pattern\n14.å‘½ä»¤æ¨¡å¼\tCommand Pattern\n15.è§£é‡Šå™¨æ¨¡å¼\tInterpreter Pattern\n16.è¿­ä»£å™¨æ¨¡å¼\tIterator Pattern\n17.ä¸­ä»‹è€…æ¨¡å¼\tMediator Pattern\n18.å¤‡å¿˜å½•æ¨¡å¼\tMemento Pattern\n19.è§‚å¯Ÿè€…æ¨¡å¼\tObserver Pattern\n20çŠ¶æ€æ¨¡å¼\tState Pattern\n21.ç­–ç•¥æ¨¡å¼\tStrategy Pattern\n22.æ¨¡æ¿æ–¹æ³•æ¨¡å¼\tTemplate Method Pattern\n23.è®¿é—®è€…æ¨¡å¼\tVisitor Pattern\nç†è®º æ˜¯å¦å› è¯¥ä¸ºæ¯ä¸€ä¸ªç±»éƒ½å®šä¹‰æ¥å£  ä¸åº”è¯¥ï¼Œåº”è¯¥æ ¹æ®å®é™…çš„éœ€è¦ã€‚\n â€œåŸºäºæ¥å£ç¼–ç¨‹è€Œä¸æ˜¯åŸºäºå®ç°ç¼–ç¨‹â€æ›´è¯¦ç»†çš„è¯´æ³•åº”è¯¥æ˜¯â€œåŸºäºæŠ½è±¡ç¼–ç¨‹è€Œä¸æ˜¯åŸºäºå®ç°ç¼–ç¨‹â€ã€‚å› ä¸ºè€ƒè™‘åˆ°æœ‰ä¸€äº›è¯­è¨€ç±»æˆCå’ŒC++éƒ½æ²¡æœ‰æ¥å£interfaceè¿™ç§ç»“æ„ã€‚ï¼ˆè®¾è®¡çš„æ—¶å€™ä¸è¦ä¸€å¼€å§‹å°±å’Œå…·ä½“çš„ç¼–ç¨‹è¯­è¨€è¿›è¡ŒæŒ‚é’©ï¼‰\nåšä»»ä½•äº‹æƒ…éƒ½ä¸è¦ä¸€æ¿å­æ‹æ­»ï¼Œä¸è¦è¿‡åº¦ä½¿ç”¨åŸåˆ™ï¼Œæ¯ä¸ªç±»éƒ½å®šä¹‰æ¥å£ï¼Œæ¥å£å¿…å®šæ»¡å¤©é£ï¼ŒåæœŸç®¡ç†ä¹Ÿå›°éš¾ã€‚\nä»è®¾è®¡åˆè¡·æ¥çœ‹ï¼Œå¦‚æœåœ¨æˆ‘ä»¬çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼ŒæŸä¸ªåŠŸèƒ½åªæœ‰ä¸€ç§å®ç°æ–¹å¼ï¼Œæœªæ¥ä¹Ÿä¸å¯èƒ½è¢«å…¶ä»–å®ç°æ–¹å¼æ›¿æ¢ï¼Œé‚£æˆ‘ä»¬å°±æ²¡æœ‰å¿…è¦ä¸ºå®ƒè®¾è®¡æ¥å£ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦åŸºäºæ¥å£ç¼–ç¨‹ï¼Œç›´æ¥ä½¿ç”¨å®ç°ç±»å°±è¡Œã€‚ï¼ˆä¸»è¦çœ‹æœ‰ä¹ˆæœ‰å¿…è¦è¿›è¡Œæ‹“å±•ï¼Œè¦æ‹“å±•çš„è¯ä½¿ç”¨æ¥å£ç¼–ç¨‹ä¼šæ›´å¥½ï¼‰\nå®æˆ˜ åŸºäºè´«è¡€æ¨¡å‹çš„MVC ä¸šåŠ¡å¼€å‘å¸¸ç”¨çš„åŸºäºè´«è¡€æ¨¡å‹çš„MVCæ¡†æ¶è¿èƒŒäº†OOPã€‚\nä»€ä¹ˆæ˜¯åŸºäºè´«è¡€çš„ä¼ ç»Ÿå¼€å‘æ¨¡å¼ï¼Ÿ\nå¹³æ—¶å¼€å‘Webåç«¯é¡¹ç›®çš„æ—¶å€™ï¼ŒåŸºæœ¬ä¸Šæ˜¯è¿™ä¹ˆç»„ç»‡ä»£ç çš„ï¼šå…¶ä¸­Entityå’ŒRepositoryç»„æˆäº†æ•°æ®è®¿é—®å±‚ï¼ŒBoå’ŒServiceç»„æˆäº†ä¸šåŠ¡é€»è¾‘å±‚ï¼ŒVoå’ŒControllerå±äºæ¥å£å±‚ã€‚\nBoæ˜¯ä¸€ä¸ªçº¯ç²¹çš„æ•°æ®ç»“æ„ï¼ŒåªåŒ…å«æ•°æ®ï¼Œä¸åŒ…å«ä»»ä½•ä¸šåŠ¡é€»è¾‘ã€‚ä¸šåŠ¡é€»è¾‘é›†ä¸­åœ¨Serviceä¸­ã€‚é€šè¿‡Serviceæ¥æ“ä½œBoã€‚åƒBoè¿™æ ·ï¼ŒåªåŒ…å«æ•°æ®ï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘çš„ç±»ï¼Œå°±å«åšè´«è¡€æ¨¡å‹ã€‚åŒç†ï¼ŒEntityå’ŒVoä¹Ÿéƒ½æ˜¯åŸºäºè´«è¡€æ¨¡å‹è®¾è®¡çš„ã€‚è´«è¡€æ¨¡å‹å°†æ•°æ®ä¸æ“ä½œåˆ†ç¦»ï¼Œç ´åäº†é¢å‘å¯¹è±¡çš„å°è£…æ€§ï¼Œæ˜¯ä¸€ç§å…¸å‹çš„é¢ç›¸è¿‡ç¨‹çš„ç¼–ç¨‹é£æ ¼ã€‚\nä»€ä¹ˆæ˜¯åŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å¼ï¼Ÿ\nåœ¨è´«è¡€æ¨¡å‹ä¸­ï¼Œæ•°æ®å’Œæ“ä½œé€»è¾‘è¢«åˆ†ç¦»åˆ°ä¸¤ä¸ªç±»ä¸­ï¼›å……è¡€æ¨¡å‹æ­£å¥½ç›¸åï¼Œæ•°æ®å’Œå¯¹åº”çš„ä¸šåŠ¡é€»è¾‘è¢«å°è£…åˆ°åŒä¸€ä¸ªç±»ä¸­ã€‚å› æ­¤ï¼Œå……è¡€æ¨¡å‹æ»¡è¶³é¢å‘å¯¹è±¡çš„å°è£…ç‰¹æ€§ï¼Œæ˜¯å…¸å‹çš„é¢å‘å¯¹è±¡ç¼–ç¨‹é£æ ¼ã€‚\n ä»€ä¹ˆæ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼Ÿ\né¢†åŸŸé©±åŠ¨è®¾è®¡å³DDDï¼Œä¸»è¦æ˜¯ç”¨æ¥æŒ‡å¯¼å¦‚ä½•è§£è€¦ä¸šåŠ¡ç³»ç»Ÿï¼Œåˆ’åˆ†ä¸šåŠ¡æ¨¡å—ï¼Œå®šä¹‰ä¸šåŠ¡é¢†åŸŸæ¨¡å‹åŠå…¶äº¤äº’ã€‚\n å®é™…ä¸Šï¼ŒåŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å¼å®ç°çš„ä»£ç ï¼Œä¹Ÿæ˜¯æŒ‰ç…§MVCä¸‰å±‚æ¶æ„åˆ†å±‚çš„ã€‚Controllerè¿˜æ˜¯è´Ÿè´£æš´éœ²æ¥å£ï¼ŒRepositoryè¿˜æ˜¯è´Ÿè´£æ•°æ®å­˜å–ï¼ŒServiceå±‚è´Ÿè´£æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€‚å®ƒå’ŒåŸºäºè´«è¡€æ¨¡å‹çš„å¼€å‘æ¨¡å¼çš„åŒºåˆ«ä¸»è¦åœ¨Serviceå±‚ã€‚\nåœ¨åŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å¼ä¸­ï¼ŒServiceå±‚åŒ…å«Serviceç±»å’ŒDomainç±»ä¸¤éƒ¨åˆ†ã€‚Domainç±»ç›¸å½“äºè´«è¡€æ¨¡å‹ä¸­çš„Boã€‚ä½†æ˜¯ï¼ŒDomainå’ŒBoçš„åŒºåˆ«åœ¨äºDomainæ˜¯åŸºäºå……è¡€æ¨¡å‹å¼€å‘çš„ï¼Œå³åŒ…å«æ•°æ®ï¼Œä¹ŸåŒ…å«ä¸šåŠ¡é€»è¾‘ã€‚è€ŒServiceç±»å˜å¾—éå¸¸å•è–„ã€‚æ€»ç»“ä¸€ä¸‹ï¼šåŸºäºè´«è¡€çš„ä¼ ç»Ÿå¼€å‘æ¨¡å¼ï¼Œé‡Serviceè½»Boï¼›åŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å¼ï¼Œè½»Serviceé‡Domainã€‚\nåŒºåˆ«äºDomainçš„èŒè´£ï¼ŒServiceç±»ä¸»è¦æœ‰ä¸‹é¢çš„å‡ ä¸ªèŒè´£ï¼ˆä¸ºä»€ä¹ˆæ²¡æœ‰å°†Serviceç±»å»æ‰ï¼‰ï¼š\n Serviceè´Ÿè´£å’ŒRepositoryäº¤æµã€‚è·å–æ•°æ®ä¹‹åï¼Œæ‰è½¬æ¢æˆé¢†åŸŸæ¨¡å‹è¿›è¡Œæ“ä½œã€‚æˆ–è€…é¢†åŸŸæ¨¡å‹è®¡ç®—å®Œæˆä¹‹åï¼Œå†é€šè¿‡Serviceè°ƒç”¨Repositoryè¿›è¡Œå­˜å‚¨ã€‚ï¼ˆä¿è¯é¢†åŸŸæ¨¡å‹çš„ç‹¬ç«‹æ€§ï¼‰ Serviceç±»è´Ÿè´£è·¨é¢†åŸŸæ¨¡å‹çš„èšåˆåŠŸèƒ½ã€‚ Serviceç±»è´Ÿè´£ä¸€äº›éåŠŸèƒ½æ€§åŠç¬¬ä¸‰æ–¹ç³»ç»Ÿäº¤äº’çš„å·¥ä½œã€‚æ¯”å¦‚å¹‚ç­‰ã€äº‹åŠ¡ã€å‘é‚®ä»¶ã€å‘æ¶ˆæ¯ã€è®°å½•æ—¥å¿—ã€è°ƒç”¨ç³»ç»ŸæœåŠ¡çš„RPCæ¥å£ç­‰ã€‚   Controllerå±‚å’ŒRepositoryå±‚è¿˜æ˜¯åŸºäºè´«è¡€æ¨¡å‹ï¼Œä½†æ˜¯æ²¡æœ‰å¿…è¦ä¿®æ”¹æˆDDDæ¨¡å¼ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªå±‚çš„é€»è¾‘æœ¬æ¥å°±æ¯”è¾ƒå•ä¸€ï¼Œæ²¡å¿…è¦ä½¿ç”¨å……è¡€æ¨¡å‹ã€‚\n ä¸ºä»€ä¹ˆè´«è¡€æ¨¡å‹é‚£ä¹ˆå—æ¬¢è¿\n è´«è¡€æ¨¡å‹ç®€å•ï¼Œä¸šåŠ¡ç®€å•ã€‚å……è¡€æ¨¡å‹éš¾ï¼Œè€ƒè™‘çš„åœ°æ–¹å¤šã€‚ æ€ç»´å›ºåŒ–ï¼Œè½¬å‹æœ‰æˆæœ¬ã€‚  ä»€ä¹ˆé¡¹ç›®åº”è¯¥è€ƒè™‘ä½¿ç”¨åŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å¼ï¼Ÿ\nåŸºäºè´«è¡€æ¨¡å‹çš„ä¼ ç»Ÿå¼€å‘æ¨¡å¼é€‚åˆä¸šåŠ¡é€»è¾‘æ¯”è¾ƒç®€å•çš„é¡¹ç›®ï¼Œè€ŒåŸºäºå……è¡€æ¨¡å‹çš„DDDå¼€å‘æ¨¡å¼é€‚åˆä¸šåŠ¡å¤æ‚çš„ç³»ç»Ÿé¡¹ç›®ã€‚æ¯”å¦‚ï¼ŒåŒ…å«å„ç§åˆ©æ¯è®¡ç®—æ¨¡å‹ã€è¿˜æ¬¾æ¨¡å‹ç­‰å¤æ‚ä¸šåŠ¡çš„é‡‘èç³»ç»Ÿã€‚\n DDDå¼€å‘æ¨¡å¼éœ€è¦æˆ‘ä»¬å‰æœŸåšå¤§é‡çš„ä¸šåŠ¡è°ƒç ”ã€é¢†åŸŸæ¨¡å‹è®¾è®¡ï¼Œæ‰€ä»¥å®ƒæ›´é€‚åˆå¤æ‚ç³»ç»Ÿçš„å¼€å‘ã€‚\n æ¥å£é‰´æƒåŠŸèƒ½é¢å‘å¯¹è±¡åˆ†æ  OOAï¼šé¢å‘å¯¹è±¡åˆ†æ\nOODï¼šé¢å‘å¯¹è±¡è®¾è®¡\nOOPï¼šé¢å‘å¯¹è±¡ç¼–ç¨‹\n é¢å‘å¯¹è±¡åˆ†ææ­¥éª¤ï¼š\n åŸºç¡€åˆ†æ åˆ†æä¼˜åŒ– ç»§ç»­åˆ†æä¼˜åŒ–  é¢å‘å¯¹è±¡è®¾è®¡æ­¥éª¤ï¼š\n åˆ’åˆ†èŒè´£è¿›è€Œè¯†åˆ«å‡ºæœ‰å“ªäº›ç±» å®šä¹‰ç±»åŠå…¶å±æ€§å’Œæ–¹æ³• å®šä¹‰ç±»ä¸ç±»ä¹‹é—´çš„äº¤äº’å…³ç³» å°†ç±»ç»„è£…èµ·æ¥å¹¶æä¾›æ‰§è¡Œå…¥å£  Referenceï¼š\n åˆ›å»ºå‹æ¨¡å¼ â€” Graphic Design Patterns  ","description":"è®¾è®¡æ¨¡å¼åŸºäºè®¾è®¡åŸåˆ™ã€‚","id":3,"section":"posts","tags":["è®¾è®¡æ¨¡å¼","è®¾è®¡åŸåˆ™"],"title":"è®¾è®¡æ¨¡å¼å°è®°","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/design-pattern-note/"},{"content":"ç´¢å¼•åŸç† Lucene å€’æ’ç´¢å¼•ï¼Œå…·ä½“çš„ç´¢å¼•å±‚çº§ï¼š\n Luceneçš„ç´¢å¼•ç»†èŠ‚ï¼š\nTerm Indexæ˜¯ä¸€ä¸ªå­—å…¸æ ‘ï¼Œä¿å­˜äº†å•è¯çš„å‰ç¼€å’Œå…¶åœ¨Term Dictionaryä¸­ä½ç½®çš„æ˜ å°„ï¼Œæ²¡æœ‰ä¿å­˜æ‰€æœ‰çš„å•è¯åˆ°å­—å…¸æ ‘ä¸­æ˜¯å› ä¸ºå•è¯çš„æ•°é‡å¤ªå¤šã€‚\nTerm Dictionaryä¿å­˜äº†æ‰€æœ‰çš„å•è¯å’Œå€’æ’åˆ—è¡¨çš„æ˜ å°„ï¼Œå½“åœ¨term indexå­—å…¸æ ‘ä¸­æ‰¾åˆ°äº†å‰ç¼€çš„åœ¨Term Dictionaryä¸­çš„ä¸‹æ ‡åï¼Œåœ¨Term Dictionaryè¿›è¡Œé¡ºåºæŸ¥æ‰¾å¾—åˆ°å•è¯å’Œå…¶å¯¹åº”çš„å€’æ’åˆ—è¡¨ã€‚\nå†åŠ ä¸Šä¸€äº›å‹ç¼©æŠ€æœ¯ï¼ˆæœç´¢ Lucene Finite State Transducersï¼‰ term index çš„å°ºå¯¸å¯ä»¥åªæœ‰æ‰€æœ‰ term çš„å°ºå¯¸çš„å‡ ååˆ†ä¹‹ä¸€ï¼Œä½¿å¾—ç”¨å†…å­˜ç¼“å­˜æ•´ä¸ª term index å˜æˆå¯èƒ½ã€‚\nå…³äº Luceneï¼Œé¢å¤–å€¼å¾—ä¸€æçš„ä¸¤ç‚¹æ˜¯ï¼š\n Term indexï¼šåœ¨å†…å­˜ä¸­æ˜¯ä»¥ FSTï¼ˆfinite state transducersï¼‰çš„å½¢å¼ä¿å­˜çš„ï¼Œå…¶ç‰¹ç‚¹æ˜¯éå¸¸èŠ‚çœå†…å­˜ã€‚å…·ä½“å‚è€ƒï¼šåœ°å€ Term dictionaryï¼šåœ¨ç£ç›˜ä¸Šæ˜¯ä»¥åˆ† block çš„æ–¹å¼ä¿å­˜çš„ï¼Œä¸€ä¸ª block å†…éƒ¨åˆ©ç”¨å…¬å…±å‰ç¼€å‹ç¼©ï¼Œæ¯”å¦‚éƒ½æ˜¯ Ab å¼€å¤´çš„å•è¯å°±å¯ä»¥æŠŠ Ab çœå»ã€‚è¿™æ · term dictionary å¯ä»¥æ¯” b-tree æ›´èŠ‚çº¦ç£ç›˜ç©ºé—´ã€‚  ç´¢å¼•å†™å…¥ åœ¨è¿›è¡Œå†™æ“ä½œæ—¶ï¼ŒESä¼šæ ¹æ®ä¼ å…¥çš„_routingå‚æ•°ï¼ˆæˆ–mappingä¸­è®¾ç½®çš„_routing, å¦‚æœå‚æ•°å’Œè®¾ç½®ä¸­éƒ½æ²¡æœ‰åˆ™é»˜è®¤ä½¿ç”¨_id), æŒ‰ç…§å…¬å¼ shard_num=hash(\\routing)%num_primary_shards,è®¡ç®—å‡ºæ–‡æ¡£è¦åˆ†é…åˆ°çš„åˆ†ç‰‡ï¼Œåœ¨ä»é›†ç¾¤å…ƒæ•°æ®ä¸­æ‰¾å‡ºå¯¹åº”ä¸»åˆ†ç‰‡çš„ä½ç½®ï¼Œå°†è¯·æ±‚è·¯ç”±åˆ°è¯¥åˆ†ç‰‡è¿›è¡Œæ–‡æ¡£å†™æ“ä½œã€‚\næ–°å»ºã€ç´¢å¼•å’Œåˆ é™¤è¯·æ±‚éƒ½æ˜¯writeæ“ä½œï¼Œå¿…é¡»åœ¨ä¸»åˆ†ç‰‡ä¸Šå®Œæˆæ‰èƒ½å¤åˆ¶åˆ°ç›¸å…³çš„å¤åˆ¶åˆ†ç‰‡ä¸Šã€‚\næ¯ä¸€ä¸ª shard å°±æ˜¯ä¸€ä¸ª Lucene Indexï¼ŒåŒ…å«å¤šä¸ª segment æ–‡ä»¶ï¼Œå’Œä¸€ä¸ª commit point æ–‡ä»¶ã€‚segment æ–‡ä»¶å­˜å‚¨çš„å°±æ˜¯ä¸€ä¸ªä¸ªçš„ Documentï¼Œcommit point è®°å½•ç€éƒ½æœ‰å“ªäº› segment æ–‡ä»¶ã€‚\nå¢åŠ Buffer å¦‚æœæ¯æ¬¡å†™æ“ä½œéƒ½æ˜¯ç›´æ¥è½ç›˜çš„è¯ï¼ŒI/O æ•ˆç‡ä¼šæ¯”è¾ƒä½ã€‚è¿™é‡ŒESæ¨¡ä»¿å…¶ä»–æ•°æ®åº“çš„æ–¹æ³•ï¼Œå¢åŠ äº†ç¼“å­˜å’Œæ—¥å¿—çš„åŠŸèƒ½ã€‚\næ·»åŠ å†…å­˜ç¼“å†²åŒºBufferï¼Œå¹¶ä¸”æ·»åŠ äº†å†™æ“ä½œæ—¥å¿—Translogï¼Œæ•°æ®å…ˆåˆ°ä¸»åˆ†ç‰‡ï¼Œç„¶åè¿›å…¥bufferä¸­ï¼Œå†å†™å…¥Translogï¼Œå¦‚æœ ES å‡ºç°æ•…éšœï¼Œé‡å¯ä¹‹åå¯ä»¥ä» Translog ä¸­æ¢å¤æ•°æ®ã€‚\n å› ä¸ºæ—¥å¿—æ–‡ä»¶åªæ˜¯å•çº¯çš„åšå†…å®¹è¿½åŠ ï¼Œæ²¡æœ‰å…¶ä»–é€»è¾‘æ“ä½œï¼Œæ‰€ä»¥å†™å…¥é€Ÿåº¦å¾ˆå¿«ã€‚å†…å­˜ç¼“å†²åŒºæ¯éš”ä¸€æ®µæ—¶é—´å†™å…¥ç£ç›˜ã€‚æ‰€ä»¥ï¼Œæç«¯æƒ…å†µä¸‹ä¼šæœ‰5ç§’æ•°æ®çš„ä¸¢å¤±ï¼Œå¦‚æœè¦ä¸¥æ ¼ä¿è¯æ•°æ®å®‰å…¨ï¼Œå¯ä»¥è°ƒæ•´è¿™ä¸ªæ—¶é—´ã€‚\n ES æ¯éš”ä¸€ç§’æ‰§è¡Œä¸€æ¬¡ refresh æ“ä½œï¼Œä¼šåˆ›å»ºä¸€ä¸ª Segment æ–‡ä»¶ï¼Œå°† buffer ä¸­çš„æ•°æ®å†™å…¥è¿™ä¸ª segmentï¼Œå¹¶æ¸…ç©º bufferã€‚\nå®šæ—¶æ¸…ç†Translog æ—¥å¿— å†™å…¥æ•°æ®ä¸æ–­çš„å¢åŠ ï¼Œæ—¥å¿—æ–‡ä»¶Translogæ¯”é¡¿é¥­ä¹Ÿè¶Šæ¥è¶Šå¤§ï¼Œéœ€è¦åŠæ—¶è¿›è¡Œæ¸…ç†ã€‚\nè§¦å‘æ¸…ç†æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼š\n å¤§å°è§¦å‘è®¾å®šçš„é˜ˆå€¼ 30åˆ†é’Ÿ  ä»»æ„æ¡ä»¶æ»¡è¶³å³è§¦å‘ä¸€æ¬¡ commit æäº¤æ“ä½œã€‚\nå…·ä½“çš„æ“ä½œæµç¨‹ï¼š\n æ‰§è¡Œ refresh æ“ä½œã€‚ æŠŠè¿™æ¬¡æäº¤åŠ¨ä½œä¹‹å‰æ‰€æœ‰æ²¡æœ‰è½ç›˜çš„ segment å¼ºåˆ¶åˆ·ç›˜ï¼Œç¡®ä¿å†™å…¥ç‰©ç†æ–‡ä»¶ã€‚ åˆ›å»ºä¸€ä¸ªæäº¤ç‚¹ï¼Œè®°å½•è¿™æ¬¡æäº¤å¯¹åº”çš„æ‰€æœ‰ segmentï¼Œå†™å…¥ commit point æ–‡ä»¶ã€‚ æ¸…ç©º Translogï¼Œå› ä¸º Segment éƒ½å·²ç»è¸å®è½åœ°äº†ï¼Œä¹‹å‰çš„ Translog å°±ä¸éœ€è¦äº†ã€‚  å®šæ—¶åˆå¹¶Segment segment æ–‡ä»¶å¤ªå¤šäº†ï¼Œä¸€ç§’å°±äº§ç”Ÿä¸€ä¸ªï¼Œè¿™ä¼šä¸¥é‡å½±å“æœç´¢æ€§èƒ½ã€‚\nes æœ‰ä¸€ä¸ªåå°ç¨‹åºï¼Œç”¨äº merge åˆå¹¶è¿™äº› segment æ–‡ä»¶ï¼ŒæŠŠå° segment æ•´åˆåˆ°ä¸€ä¸ªå¤§çš„ segment ä¸­ï¼Œå¹¶ä¿®æ”¹ commit point çš„ segment è®°å½•ã€‚merge è¿‡ç¨‹è¿˜ä¼šæ¸…ç†è¢«åˆ é™¤çš„æ•°æ®ã€‚\nes æ¥æ”¶åˆ°åˆ æ•°æ®è¯·æ±‚æ—¶ï¼Œä¸ä¼šçœŸçš„åˆ° segment ä¸­æŠŠæ•°æ®åˆ äº†ï¼Œè€Œæ˜¯æŠŠè¦åˆ é™¤çš„æ•°æ®å†™åˆ° \u0026lsquo;.del\u0026rsquo; æ–‡ä»¶ä¸­ï¼Œåœ¨è¯»æ“ä½œæ—¶ï¼Œä¼šæ ¹æ®è¿™ä¸ªæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ã€‚\nmerge åˆå¹¶æ—¶æ‰çœŸæ­£åˆ é™¤ï¼Œåˆå¹¶åçš„ segment ä¸­å°±æ²¡æœ‰å·²ç»åˆ é™¤çš„æ•°æ®äº†ã€‚\nå…·ä½“çš„æµç¨‹ï¼š\nå› ä¸ºä¸Šé¢è¿™äº›æ“ä½œéƒ½ä¸æ˜¯éå¸¸å¿«çš„ï¼Œæ‰€ä»¥ESç§°ä¸ºè¿‘å®æ—¶çš„æŸ¥æ‰¾ã€‚\nç´¢å¼•æ–‡ä»¶åˆ†æ®µå­˜å‚¨å¹¶ä¸”ä¸å¯ä¿®æ”¹ï¼Œé‚£ä¹ˆæ–°å¢ã€æ›´æ–°å’Œåˆ é™¤å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ\n æ–°å¢ï¼Œæ–°å¢å¾ˆå¥½å¤„ç†ï¼Œç”±äºæ•°æ®æ˜¯æ–°çš„ï¼Œæ‰€ä»¥åªéœ€è¦å¯¹å½“å‰æ–‡æ¡£æ–°å¢ä¸€ä¸ªæ®µå°±å¯ä»¥äº†ã€‚ åˆ é™¤ï¼Œç”±äºä¸å¯ä¿®æ”¹ï¼Œæ‰€ä»¥å¯¹äºåˆ é™¤æ“ä½œï¼Œä¸ä¼šæŠŠæ–‡æ¡£ä»æ—§çš„æ®µä¸­ç§»é™¤è€Œæ˜¯é€šè¿‡æ–°å¢ä¸€ä¸ª.delæ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­ä¼šåˆ—å‡ºè¿™äº›è¢«åˆ é™¤æ–‡æ¡£çš„æ®µä¿¡æ¯ã€‚è¿™ä¸ªè¢«æ ‡è®°åˆ é™¤çš„æ–‡æ¡£ä»ç„¶å¯ä»¥è¢«æŸ¥è¯¢åŒ¹é…åˆ°ï¼Œ ä½†å®ƒä¼šåœ¨æœ€ç»ˆç»“æœè¢«è¿”å›å‰ä»ç»“æœé›†ä¸­ç§»é™¤ã€‚ æ›´æ–°ï¼Œä¸èƒ½ä¿®æ”¹æ—§çš„æ®µæ¥è¿›è¡Œåæ˜ æ–‡æ¡£çš„æ›´æ–°ï¼Œå…¶å®æ›´æ–°ç›¸å½“äºæ˜¯åˆ é™¤å’Œæ–°å¢è¿™ä¸¤ä¸ªåŠ¨ä½œç»„æˆã€‚ä¼šå°†æ—§çš„æ–‡æ¡£åœ¨.delæ–‡ä»¶ä¸­æ ‡è®°åˆ é™¤ï¼Œç„¶åæ–‡æ¡£çš„æ–°ç‰ˆæœ¬è¢«ç´¢å¼•åˆ°ä¸€ä¸ªæ–°çš„æ®µä¸­ã€‚å¯èƒ½ä¸¤ä¸ªç‰ˆæœ¬çš„æ–‡æ¡£éƒ½ä¼šè¢«ä¸€ä¸ªæŸ¥è¯¢åŒ¹é…åˆ°ï¼Œä½†è¢«åˆ é™¤çš„é‚£ä¸ªæ—§ç‰ˆæœ¬æ–‡æ¡£åœ¨ç»“æœé›†è¿”å›å‰å°±ä¼šè¢«ç§»é™¤ã€‚  æ®µè¢«è®¾å®šä¸ºä¸å¯ä¿®æ”¹å…·æœ‰ä¸€å®šçš„ä¼˜åŠ¿ä¹Ÿæœ‰ä¸€å®šçš„ç¼ºç‚¹ï¼Œä¼˜åŠ¿ä¸»è¦è¡¨ç°åœ¨ï¼š\n ä¸éœ€è¦é”ã€‚å¦‚æœä½ ä»æ¥ä¸æ›´æ–°ç´¢å¼•ï¼Œä½ å°±ä¸éœ€è¦æ‹…å¿ƒå¤šè¿›ç¨‹åŒæ—¶ä¿®æ”¹æ•°æ®çš„é—®é¢˜ã€‚ ä¸€æ—¦ç´¢å¼•è¢«è¯»å…¥å†…æ ¸çš„æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ï¼Œä¾¿ä¼šç•™åœ¨å“ªé‡Œï¼Œç”±äºå…¶ä¸å˜æ€§ã€‚åªè¦æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ä¸­è¿˜æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œé‚£ä¹ˆå¤§éƒ¨åˆ†è¯»è¯·æ±‚ä¼šç›´æ¥è¯·æ±‚å†…å­˜ï¼Œè€Œä¸ä¼šå‘½ä¸­ç£ç›˜ã€‚è¿™æä¾›äº†å¾ˆå¤§çš„æ€§èƒ½æå‡ã€‚ å…¶å®ƒç¼“å­˜(åƒfilterç¼“å­˜)ï¼Œåœ¨ç´¢å¼•çš„ç”Ÿå‘½å‘¨æœŸå†…å§‹ç»ˆæœ‰æ•ˆã€‚å®ƒä»¬ä¸éœ€è¦åœ¨æ¯æ¬¡æ•°æ®æ”¹å˜æ—¶è¢«é‡å»ºï¼Œå› ä¸ºæ•°æ®ä¸ä¼šå˜åŒ–ã€‚ å†™å…¥å•ä¸ªå¤§çš„å€’æ’ç´¢å¼•å…è®¸æ•°æ®è¢«å‹ç¼©ï¼Œå‡å°‘ç£ç›˜ I/O å’Œ éœ€è¦è¢«ç¼“å­˜åˆ°å†…å­˜çš„ç´¢å¼•çš„ä½¿ç”¨é‡ã€‚  æ®µçš„ä¸å˜æ€§çš„ç¼ºç‚¹å¦‚ä¸‹ï¼š\n å½“å¯¹æ—§æ•°æ®è¿›è¡Œåˆ é™¤æ—¶ï¼Œæ—§æ•°æ®ä¸ä¼šé©¬ä¸Šè¢«åˆ é™¤ï¼Œè€Œæ˜¯åœ¨.delæ–‡ä»¶ä¸­è¢«æ ‡è®°ä¸ºåˆ é™¤ã€‚è€Œæ—§æ•°æ®åªèƒ½ç­‰åˆ°æ®µæ›´æ–°æ—¶æ‰èƒ½è¢«ç§»é™¤ï¼Œè¿™æ ·ä¼šé€ æˆå¤§é‡çš„ç©ºé—´æµªè´¹ã€‚ è‹¥æœ‰ä¸€æ¡æ•°æ®é¢‘ç¹çš„æ›´æ–°ï¼Œæ¯æ¬¡æ›´æ–°éƒ½æ˜¯æ–°å¢æ–°çš„æ ‡è®°æ—§çš„ï¼Œåˆ™ä¼šæœ‰å¤§é‡çš„ç©ºé—´æµªè´¹ã€‚ æ¯æ¬¡æ–°å¢æ•°æ®æ—¶éƒ½éœ€è¦æ–°å¢ä¸€ä¸ªæ®µæ¥å­˜å‚¨æ•°æ®ã€‚å½“æ®µçš„æ•°é‡å¤ªå¤šæ—¶ï¼Œå¯¹æœåŠ¡å™¨çš„èµ„æºä¾‹å¦‚æ–‡ä»¶å¥æŸ„çš„æ¶ˆè€—ä¼šéå¸¸å¤§ã€‚ åœ¨æŸ¥è¯¢çš„ç»“æœä¸­åŒ…å«æ‰€æœ‰çš„ç»“æœé›†ï¼Œéœ€è¦æ’é™¤è¢«æ ‡è®°åˆ é™¤çš„æ—§æ•°æ®ï¼Œè¿™å¢åŠ äº†æŸ¥è¯¢çš„è´Ÿæ‹…ã€‚  é«˜å¯ç”¨ é«˜å¯ç”¨æ¶‰åŠåˆ°ESçš„é›†ç¾¤ã€èŠ‚ç‚¹å’Œåˆ†ç‰‡åŠŸèƒ½ã€‚\né›†ç¾¤ï¼šESé›†ç¾¤ç”±è‹¥å¹²èŠ‚ç‚¹ç»„æˆï¼Œcluster-nameç›¸åŒã€‚\nèŠ‚ç‚¹ï¼šä¸€ä¸ªESå®ä¾‹ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªJavaè¿›ç¨‹ã€‚ä¸€èˆ¬ä¸€å°æœºå™¨è¿è¡Œä¸€ä¸ªESå®ä¾‹ã€‚\nèŠ‚ç‚¹æœ‰ï¼š\n masterèŠ‚ç‚¹ï¼šè´Ÿè´£ç®¡ç†é›†ç¾¤èŒƒç•´çš„å˜æ›´ï¼Œä¾‹å¦‚åˆ›å»ºæˆ–è€…åˆ é™¤ç´¢å¼•ï¼Œæ·»åŠ èŠ‚ç‚¹åˆ°é›†ç¾¤æˆ–ä»é›†ç¾¤åˆ é™¤èŠ‚ç‚¹ã€‚ dataèŠ‚ç‚¹ï¼šä¿å­˜æ•°æ®å’Œå€’æ’ç´¢å¼•ã€‚ clientèŠ‚ç‚¹ï¼šæ‰®æ¼”è´Ÿè½½å‡è¡¡çš„è§’è‰²ï¼Œå°†åˆ°æ¥çš„è¯·æ±‚è·¯ç”±åˆ°é›†ç¾¤ä¸­çš„å„ä¸ªèŠ‚ç‚¹ã€‚  åˆ†ç‰‡ï¼šåŒä¸€ä¸ªç´¢å¼•å¯ä»¥å­˜å‚¨åœ¨ä¸åŒçš„åˆ†ç‰‡ä¸­ï¼Œåˆ†ç‰‡åˆå¯ä»¥å­˜å‚¨åœ¨é›†ç¾¤çš„ä¸åŒèŠ‚ç‚¹ä¸­ã€‚è¿™ç±»ä¼¼äºMySqlçš„åˆ†åº“åˆ†è¡¨ï¼Œåªä¸è¿‡Mysqlåˆ†åº“åˆ†è¡¨éœ€è¦å€ŸåŠ©ç¬¬ä¸‰æ–¹ç»„ä»¶è€ŒESå†…éƒ¨è‡ªèº«å®ç°äº†æ­¤åŠŸèƒ½ã€‚\nåˆ†ç‰‡åˆ†ä¸»åˆ†ç‰‡å’Œä»åˆ†ç‰‡ï¼Œåˆ†åˆ«å«primary shardå’Œreplica shardã€‚\n1ã€ä¸»åˆ†ç‰‡ä¸ä»åˆ†ç‰‡å…³ç³»ï¼šä»åˆ†ç‰‡åªæ˜¯ä¸»åˆ†ç‰‡çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œå®ƒç”¨äºæä¾›æ•°æ®çš„å†—ä½™å‰¯æœ¬\n2ã€ä»åˆ†ç‰‡åº”ç”¨ï¼šåœ¨ç¡¬ä»¶æ•…éšœæ—¶æä¾›æ•°æ®ä¿æŠ¤ï¼ŒåŒæ—¶æœåŠ¡äºæœç´¢å’Œæ£€ç´¢è¿™ç§åªè¯»è¯·æ±‚\n3ã€æ˜¯å¦å¯å˜ï¼šç´¢å¼•ä¸­çš„ä¸»åˆ†ç‰‡çš„æ•°é‡åœ¨ç´¢å¼•åˆ›å»ºåå°±å›ºå®šä¸‹æ¥äº†ï¼Œä½†æ˜¯ä»åˆ†ç‰‡çš„æ•°é‡å¯ä»¥éšæ—¶æ”¹å˜\nå‰¯æœ¬åˆ†ç‰‡replica shard  Tipsï¼šåˆ†ç‰‡æ•°é‡è®¾ç½®ä¸º3ï¼Œå¤‡ä»½è®¾ç½®ä¸º2ï¼Œé‚£ä¹ˆè¯¥ç´¢å¼•åˆ†ç‰‡æ€»æ•°ä¸º3çš„å¹³æ–¹(9)ã€‚\n å‰¯æœ¬åˆ†ç‰‡å¯ä»¥å®ç°é«˜å¯ç”¨ï¼Œä»åˆ†ç‰‡ç»™æ•°æ®æä¾›å¤‡ä»½ï¼ˆreplicsï¼‰ï¼Œå¤‡ä»½è´Ÿè´£å®¹é”™ã€ä»¥åŠè¯·æ±‚çš„è´Ÿè½½å‡è¡¡ã€‚\n æ¯ä¸€ä¸ªåˆ†ç‰‡ä¸ºäº†å®ç°é«˜å¯ç”¨ï¼Œéƒ½ä¼šæœ‰è‡ªå·±å¯¹åº”çš„å¤‡ä»½ï¼Œåˆ†ç‰‡å¯¹åº”çš„å¤‡ä»½ä¸èƒ½å­˜æ”¾åŒä¸€å°æœåŠ¡å™¨ä¸Šã€‚åˆ†ç‰‡shardså¯ä»¥å’Œå…¶ä»–å¤‡ä»½ï¼ˆreplicsï¼‰å­˜æ”¾åœ¨åŒä¸€ä¸ªnodeèŠ‚ç‚¹ä¸Š å¦‚æœæŸä¸ªé master èŠ‚ç‚¹å®•æœºäº†ã€‚é‚£ä¹ˆæ­¤èŠ‚ç‚¹ä¸Šçš„ primary shard æ²¡äº†ã€‚é‚£å¥½ï¼Œmaster ä¼šè®© primary shard å¯¹åº”çš„ replica shardï¼ˆåœ¨å…¶ä»–æœºå™¨ä¸Šï¼‰åˆ‡æ¢ä¸º primary shardã€‚ï¼ˆå¦‚æœå®•æœºçš„æœºå™¨ä¿®å¤äº†ï¼Œä¿®å¤åçš„èŠ‚ç‚¹ä¹Ÿä¸å†æ˜¯ primary shardï¼Œè€Œæ˜¯ replica shardï¼‰  ä¸ºäº†è¾¾åˆ°é«˜å¯ç”¨ï¼ŒMasterèŠ‚ç‚¹ä¼šé¿å…å°†ä¸»åˆ†ç‰‡å’Œå‰¯æœ¬åˆ†ç‰‡æ”¾åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚\né€‰æ‹©masterèŠ‚ç‚¹  es é›†ç¾¤å¤šä¸ªèŠ‚ç‚¹ï¼Œä¼šè‡ªåŠ¨é€‰ä¸¾ä¸€ä¸ªèŠ‚ç‚¹ä¸º master èŠ‚ç‚¹ï¼Œè¿™ä¸ª master èŠ‚ç‚¹å…¶å®å°±æ˜¯å¹²ä¸€äº›ç®¡ç†çš„å·¥ä½œçš„ï¼Œæ¯”å¦‚ç»´æŠ¤ç´¢å¼•å…ƒæ•°æ®ã€è´Ÿè´£åˆ‡æ¢ primary shard å’Œ replica shard èº«ä»½ç­‰ã€‚è¦æ˜¯ master èŠ‚ç‚¹å®•æœºäº†ï¼Œé‚£ä¹ˆä¼šé‡æ–°é€‰ä¸¾ä¸€ä¸ªèŠ‚ç‚¹ä¸º master èŠ‚ç‚¹ã€‚\n é€‰ä¸»æµç¨‹ï¼š\n pingæ‰€æœ‰èŠ‚ç‚¹ï¼Œå¹¶è·å–PingResponseè¿”å›ç»“æœï¼ˆfindMasterï¼‰ è¿‡æ»¤å‡ºå…·æœ‰Masterèµ„æ ¼çš„èŠ‚ç‚¹ï¼ˆfilterPingResponsesï¼‰ é€‰å‡ºä¸´æ—¶Masterã€‚æ ¹æ®PingResponseç»“æœæ„å»ºä¸¤ä¸ªåˆ—è¡¨ï¼šactiveMasterså’ŒmasterCandidatesã€‚   å¦‚æœactiveMasterséç©ºï¼Œåˆ™ä»activeMastersä¸­é€‰æ‹©æœ€åˆé€‚çš„ä½œä¸ºMasterï¼› å¦‚æœactiveMastersä¸ºç©ºï¼Œåˆ™ä»masterCandidatesä¸­é€‰ä¸¾ï¼Œç»“æœå¯èƒ½é€‰ä¸¾æˆåŠŸï¼Œä¹Ÿå¯èƒ½é€‰ä¸¾å¤±è´¥ã€‚  https://www.jianshu.com/p/4e1154cbf86f\n  è¯»é«˜å¯ç”¨æŒ‡çš„æ˜¯å¤šä¸ªå‰¯æœ¬æƒ…å†µä¸‹ï¼ŒæŸä¸ªå‰¯æœ¬å‡ºé—®é¢˜æ—¶ä¸å½±å“æ•´ä¸ªç³»ç»Ÿçš„è¯»ã€‚\n  å†™é«˜å¯ç”¨æŒ‡çš„æ˜¯å¤šä¸ªå‰¯æœ¬æƒ…å†µä¸‹ï¼ŒæŸä¸ªå‰¯æœ¬å‡ºé—®é¢˜æ—¶ä¸å½±å“æ•´ä¸ªç³»ç»Ÿçš„å†™ï¼Œé€šè¿‡translogæ¥ç¡®ä¿æ•°æ®ä¸ä¼šä¸¢å¤±ã€‚\n  é›†ç¾¤çŠ¶æ€çš„æ”¹å˜çš„é«˜å¯ç”¨åŒ…å«è‡ªåŠ¨å¤„ç†èŠ‚ç‚¹çš„åŠ å…¥å’Œç¦»å¼€ï¼Œè‡ªåŠ¨åŒæ­¥æ”¹å˜çš„é›†ç¾¤çŠ¶æ€ï¼Œå½“é›†ç¾¤å‘ç”Ÿæ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢ä¸»å‰¯shardç­‰ç­‰æ¥ä¿æŒé›†ç¾¤çš„é«˜å¯ç”¨ã€‚\n  æ—¥å¿— ä¸ºäº†é¿å…ä¸¢å¤±æ•°æ®ï¼ŒElasticsearchæ·»åŠ äº†äº‹åŠ¡æ—¥å¿—ï¼ˆTranslogï¼‰ï¼Œäº‹åŠ¡æ—¥å¿—è®°å½•äº†æ‰€æœ‰è¿˜æ²¡æœ‰æŒä¹…åŒ–åˆ°ç£ç›˜çš„æ•°æ®ã€‚å¯ä»¥åœ¨ä¹‹åå¯¹æ•°æ®æ“ä½œè¿›è¡Œé‡è¯•ã€‚ä¿è¯äº†æ•°æ®å¯é æ€§ã€‚\né«˜æ€§èƒ½ å†™å…¥é«˜æ€§èƒ½ å¯¹æ–‡æ¡£çš„æ–°å»ºã€ç´¢å¼•å’Œåˆ é™¤è¯·æ±‚éƒ½æ˜¯å†™æ“ä½œï¼Œå¿…é¡»åœ¨ä¸»åˆ†ç‰‡ä¸Šé¢å®Œæˆä¹‹åæ‰èƒ½è¢«å¤åˆ¶åˆ°ç›¸å…³çš„å‰¯æœ¬åˆ†ç‰‡ï¼ŒESä¸ºäº†æé«˜å†™å…¥çš„èƒ½åŠ›è¿™ä¸ªè¿‡ç¨‹æ˜¯å¹¶å‘å†™çš„ï¼ŒåŒæ—¶ä¸ºäº†è§£å†³å¹¶å‘å†™çš„è¿‡ç¨‹ä¸­æ•°æ®å†²çªçš„é—®é¢˜ï¼ŒESé€šè¿‡ä¹è§‚é”çš„æ–¹å¼æ§åˆ¶ï¼Œæ¯ä¸ªæ–‡æ¡£éƒ½æœ‰ä¸€ä¸ª _version ï¼ˆç‰ˆæœ¬ï¼‰å·ï¼Œå½“æ–‡æ¡£è¢«ä¿®æ”¹æ—¶ç‰ˆæœ¬å·é€’å¢ã€‚ä¸€æ—¦æ‰€æœ‰çš„å‰¯æœ¬åˆ†ç‰‡éƒ½æŠ¥å‘Šå†™æˆåŠŸæ‰ä¼šå‘åè°ƒèŠ‚ç‚¹æŠ¥å‘ŠæˆåŠŸï¼Œåè°ƒèŠ‚ç‚¹å‘å®¢æˆ·ç«¯æŠ¥å‘ŠæˆåŠŸã€‚\nåˆ†æ®µå­˜å‚¨ ç´¢å¼•æ–‡æ¡£ä»¥æ®µçš„å½¢å¼å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œç´¢å¼•æ–‡ä»¶è¢«æ‹†åˆ†ä¸ºå¤šä¸ªå­æ–‡ä»¶ï¼Œæ¯ä¸ªå­æ–‡ä»¶å«åšæ®µï¼Œæ¯ä¸ªæ®µæœ¬èº«å°±æ˜¯ä¸€ä¸ªå€’æ’ç´¢å¼•ï¼Œå¹¶ä¸”æ®µå…·æœ‰ä¸å¯å˜æ€§ï¼Œä¸€æ—¦ç´¢å¼•çš„æ•°æ®è¢«å†™å…¥ç£ç›˜ï¼Œå°±ä¸å¯ä»¥å†æ”¹å˜ã€‚åœ¨åº•å±‚é‡‡ç”¨äº†åˆ†æ®µçš„å­˜å‚¨æ¨¡å¼ï¼Œä½¿å®ƒåœ¨è¯»å†™æ—¶å‡ ä¹å®Œå…¨é¿å…äº†é”çš„å‡ºç°ï¼Œå¤§å¤§æå‡äº†è¯»å†™æ€§èƒ½ã€‚\næ®µè¢«å†™å…¥åˆ°ç£ç›˜åä¼šç”Ÿæˆä¸€ä¸ªæäº¤ç‚¹ï¼Œæäº¤ç‚¹æ˜¯ä¸€ä¸ªç”¨æ¥è®°å½•æ‰€æœ‰æäº¤åæ®µä¿¡æ¯çš„æ–‡ä»¶ã€‚ä¸€ä¸ªæ®µä¸€æ—¦æ‹¥æœ‰äº†æäº¤ç‚¹ï¼Œå°±è¯´æ˜è¿™ä¸ªæ®µåªæœ‰è¯»çš„æƒé™ï¼Œå¤±å»äº†å†™çš„æƒé™ã€‚ç›¸åï¼Œå½“æ®µåœ¨å†…å­˜ä¸­æ—¶ï¼Œå°±åªæœ‰å†™çš„æƒé™ï¼Œè€Œä¸å…·å¤‡è¯»æ•°æ®çš„æƒé™ï¼Œæ„å‘³ç€ä¸èƒ½è¢«æ£€ç´¢ã€‚\nå»¶è¿Ÿå†™ç­–ç•¥ å†™å…¥ESçš„æ•°æ®è¯·æ±‚ä¸ä¼šé©¬ä¸Šå†™å…¥åˆ°ç£ç›˜ä¸­ï¼Œè€Œæ˜¯å…ˆå†™å…¥ä¸€ä¸ªç¼“å­˜åŒºä¸­ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´å†™å…¥ç£ç›˜ã€‚\nè¿™é‡Œçš„å†…å­˜ä½¿ç”¨çš„æ˜¯ESçš„JVMå†…å­˜ï¼Œè€Œæ–‡ä»¶ç¼“å­˜ç³»ç»Ÿä½¿ç”¨çš„æ˜¯æ“ä½œç³»ç»Ÿçš„å†…å­˜ã€‚æ–°çš„æ•°æ®ä¼šç»§ç»­çš„è¢«å†™å…¥å†…å­˜ï¼Œä½†å†…å­˜ä¸­çš„æ•°æ®å¹¶ä¸æ˜¯ä»¥æ®µçš„å½¢å¼å­˜å‚¨çš„ï¼Œå› æ­¤ä¸èƒ½æä¾›æ£€ç´¢åŠŸèƒ½ã€‚ç”±å†…å­˜åˆ·æ–°åˆ°æ–‡ä»¶ç¼“å­˜ç³»ç»Ÿçš„æ—¶å€™ä¼šç”Ÿæˆäº†æ–°çš„æ®µï¼Œå¹¶å°†æ®µæ‰“å¼€ä»¥ä¾›æœç´¢ä½¿ç”¨ï¼Œè€Œä¸éœ€è¦ç­‰åˆ°è¢«åˆ·æ–°åˆ°ç£ç›˜ã€‚\næ®µåˆå¹¶ ç”±äºè‡ªåŠ¨åˆ·æ–°æµç¨‹æ¯ç§’ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ®µ ï¼Œè¿™æ ·ä¼šå¯¼è‡´çŸ­æ—¶é—´å†…çš„æ®µæ•°é‡æš´å¢ã€‚è€Œæ®µæ•°ç›®å¤ªå¤šä¼šå¸¦æ¥è¾ƒå¤§çš„éº»çƒ¦ã€‚ æ¯ä¸€ä¸ªæ®µéƒ½ä¼šæ¶ˆè€—æ–‡ä»¶å¥æŸ„ã€å†…å­˜å’Œcpuè¿è¡Œå‘¨æœŸã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæ¯ä¸ªæœç´¢è¯·æ±‚éƒ½å¿…é¡»è½®æµæ£€æŸ¥æ¯ä¸ªæ®µç„¶ååˆå¹¶æŸ¥è¯¢ç»“æœï¼Œæ‰€ä»¥æ®µè¶Šå¤šï¼Œæœç´¢ä¹Ÿå°±è¶Šæ…¢ã€‚\nElasticsearché€šè¿‡åœ¨åå°å®šæœŸè¿›è¡Œæ®µåˆå¹¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å°çš„æ®µè¢«åˆå¹¶åˆ°å¤§çš„æ®µï¼Œç„¶åè¿™äº›å¤§çš„æ®µå†è¢«åˆå¹¶åˆ°æ›´å¤§çš„æ®µã€‚æ®µåˆå¹¶çš„æ—¶å€™ä¼šå°†é‚£äº›æ—§çš„å·²åˆ é™¤æ–‡æ¡£ä»æ–‡ä»¶ç³»ç»Ÿä¸­æ¸…é™¤ã€‚è¢«åˆ é™¤çš„æ–‡æ¡£ä¸ä¼šè¢«æ‹·è´åˆ°æ–°çš„å¤§æ®µä¸­ã€‚åˆå¹¶çš„è¿‡ç¨‹ä¸­ä¸ä¼šä¸­æ–­ç´¢å¼•å’Œæœç´¢ã€‚\næ®µåˆå¹¶åœ¨è¿›è¡Œç´¢å¼•å’Œæœç´¢æ—¶ä¼šè‡ªåŠ¨è¿›è¡Œï¼Œåˆå¹¶è¿›ç¨‹é€‰æ‹©ä¸€å°éƒ¨åˆ†å¤§å°ç›¸ä¼¼çš„æ®µï¼Œå¹¶ä¸”åœ¨åå°å°†å®ƒä»¬åˆå¹¶åˆ°æ›´å¤§çš„æ®µä¸­ï¼Œè¿™äº›æ®µæ—¢å¯ä»¥æ˜¯æœªæäº¤çš„ä¹Ÿå¯ä»¥æ˜¯å·²æäº¤çš„ã€‚åˆå¹¶ç»“æŸåè€çš„æ®µä¼šè¢«åˆ é™¤ï¼Œæ–°çš„æ®µè¢« flush åˆ°ç£ç›˜ï¼ŒåŒæ—¶å†™å…¥ä¸€ä¸ªåŒ…å«æ–°æ®µï¼ˆå·²æ’é™¤æ—§çš„è¢«åˆå¹¶çš„æ®µï¼‰çš„æ–°æäº¤ç‚¹ï¼Œæ–°çš„æ®µè¢«æ‰“å¼€å¯ä»¥ç”¨æ¥æœç´¢ã€‚\nå­˜å‚¨é«˜æ€§èƒ½ åœ¨å†…å­˜ä¸­ç”¨FSTæ–¹å¼å‹ç¼©term indexï¼ŒFSTä»¥å­—èŠ‚çš„æ–¹å¼å­˜å‚¨æ‰€æœ‰çš„termï¼Œè¿™ç§å‹ç¼©æ–¹å¼å¯ä»¥æœ‰æ•ˆçš„ç¼©å‡å­˜å‚¨ç©ºé—´ï¼Œä½¿å¾—term indexè¶³ä»¥æ”¾è¿›å†…å­˜ï¼Œä½†è¿™ç§æ–¹å¼ä¹Ÿä¼šå¯¼è‡´æŸ¥æ‰¾æ—¶éœ€è¦æ›´å¤šçš„CPUèµ„æºã€‚æ¼”ç¤ºåœ°å€ï¼šBuild your own FST\né«˜å¯æ‹“å±• æ‹†åˆ†å¤šä¸ª shard æ˜¯æœ‰å¥½å¤„çš„ï¼Œä¸€æ˜¯æ”¯æŒæ¨ªå‘æ‰©å±•ï¼Œæ¯”å¦‚ä½ æ•°æ®é‡æ˜¯ 3Tï¼Œ3 ä¸ª shardï¼Œæ¯ä¸ª shard å°± 1T çš„æ•°æ®ï¼Œè‹¥ç°åœ¨æ•°æ®é‡å¢åŠ åˆ° 4Tï¼Œæ€ä¹ˆæ‰©å±•ï¼Œå¾ˆç®€å•ï¼Œé‡æ–°å»ºä¸€ä¸ªæœ‰ 4 ä¸ª shard çš„ç´¢å¼•ï¼Œå°†æ•°æ®å¯¼è¿›å»ï¼›äºŒæ˜¯æé«˜æ€§èƒ½ï¼Œæ•°æ®åˆ†å¸ƒåœ¨å¤šä¸ª shardï¼Œå³å¤šå°æœåŠ¡å™¨ä¸Šï¼Œæ‰€æœ‰çš„æ“ä½œï¼Œéƒ½ä¼šåœ¨å¤šå°æœºå™¨ä¸Šå¹¶è¡Œåˆ†å¸ƒå¼æ‰§è¡Œï¼Œæé«˜äº†ååé‡å’Œæ€§èƒ½ã€‚\nç»éªŒ  åˆ†åŒºå¤§å°ä¸èƒ½è¶…è¿‡50G æŒ‰ç…§æ•°æ®é‡è¿›è¡Œè§„åˆ’ï¼Œé»˜è®¤æ˜¯5åˆ†å»1å‰¯æœ¬ æ¯ä¸ªç´¢å¼•æ•°æ®é‡å°çš„è¯æ²¡å¿…è¦è®¾ç½®å¾ˆå¤šçš„åˆ†åŒºï¼Œä¸€èˆ¬å•åˆ†åŒºå¤§å°20Gä¸ºå®œã€‚ åä¸‡çº§1åˆ†åŒºï¼Œåƒä¸‡çº§3åˆ†åŒºï¼Œäº¿ä¸‡çº§5åˆ†åŒº å‰¯æœ¬æœ€å¥½è®¾ç½®ï¼Œä¸€èˆ¬ä¸º1  è„‘è£‚é—®é¢˜  ä»€ä¹ˆæ˜¯è„‘è£‚å‘¢ï¼Ÿå¦‚æœé›†ç¾¤ä¸­é€‰ä¸¾å‡ºå¤šä¸ªMasterèŠ‚ç‚¹ï¼Œä½¿å¾—æ•°æ®æ›´æ–°æ—¶å‡ºç°ä¸ä¸€è‡´ï¼Œè¿™ç§ç°è±¡ç§°ä¹‹ä¸ºè„‘è£‚ã€‚\n è„‘è£‚é€ æˆåŸå› ï¼š\n ç½‘ç»œé—®é¢˜ï¼šé›†ç¾¤é—´çš„ç½‘ç»œå»¶è¿Ÿå¯¼è‡´ä¸€äº›èŠ‚ç‚¹è®¿é—®ä¸åˆ°Masterï¼Œè¯¯è®¤ä¸ºMasterèŠ‚ç‚¹æŒ‚äº†ï¼Œä»è€Œé€‰ä¸¾å‡ºæ–°çš„MasterèŠ‚ç‚¹ã€‚ èŠ‚ç‚¹è´Ÿè½½ï¼šä¸»èŠ‚ç‚¹çš„è§’è‰²æ—¢ä¸ºMasteråˆæ˜¯Dataï¼Œè®¿é—®é‡è¾ƒå¤§ä¼šå¯¼è‡´ESåœæ­¢å“åº”ï¼ˆç§°ä¸ºå‡æ­»çŠ¶æ€ï¼‰é€ æˆå¤§é¢ç§¯å»¶è¿Ÿï¼Œæ­¤æ—¶å…¶ä»–èŠ‚ç‚¹è®¿é—®ä¸äº†MasterèŠ‚ç‚¹ï¼Œè¯¯è®¤ä¸ºMasterèŠ‚ç‚¹å·²ç»æŒ‚äº†ã€‚ å†…å­˜å›æ”¶ï¼šä¸»èŠ‚ç‚¹çš„è§’è‰²æ—¢ä¸ºMasteråˆæ˜¯Dataï¼Œå½“DataèŠ‚ç‚¹ä¸Šçš„ESè¿›ç¨‹å ç”¨çš„å†…å­˜è¾ƒå¤§ï¼Œä¼šå¼•å‘JVMçš„å¤§è§„æ¨¡å†…å­˜å›æ”¶ï¼Œé€ æˆESè¿›ç¨‹æ— æ³•å“åº”ã€‚  é¿å…è„‘è£‚é—®é¢˜ï¼š\n å¢å¤§å“åº”æ—¶é—´ è§’è‰²åˆ†ç¦»ã€‚ï¼ˆå°†Masterå’ŒDataèŠ‚ç‚¹åˆ†ç¦»ï¼‰ è®¾ç½®å‚ä¸é€‰ä¸¾çš„å€™é€‰ä¸»èŠ‚ç‚¹çš„èŠ‚ç‚¹æ•°ï¼Œå®˜æ–¹å»ºè®®(master_eligibel_nodes/2)+1ï¼Œå…¶ä¸­ master_eligibel_nodes ä¸ºå€™é€‰ä¸»èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚è¿™æ ·åšæ—¢èƒ½é˜²æ­¢è„‘è£‚ç°è±¡çš„å‘ç”Ÿï¼Œä¹Ÿèƒ½æœ€å¤§é™åº¦åœ°æå‡é›†ç¾¤çš„é«˜å¯ç”¨æ€§ã€‚  å†™å…¥ç“¶é¢ˆåˆ†æ https://segmentfault.com/a/1190000023638634\nå‚è€ƒï¼š\n https://liqitian.com/articles/2020/03/18/1584525092399.html https://segmentfault.com/a/1190000040017672 https://www.cnblogs.com/jajian/p/11223992.html  ","description":"ESåŸºäºLucene å€’æ’ç´¢å¼•è¿›è¡Œæ„å»ºçš„ç»“æ„ã€‚","id":4,"section":"posts","tags":["ES"],"title":"ESç´¢å¼•åŸç†","uri":"https://hugo.jiahongw.com/zh/posts/es/es-index/"},{"content":"ES Mappings ESçš„Mappingsçš„ä½œç”¨ç±»ä¼¼mysqlä¸­å®šä¹‰è¡¨ç»“æ„çš„schemaï¼Œç”¨æ¥å®šä¹‰ä¸€ä¸ªæ–‡æ¡£æ ¼å¼ï¼Œä¾‹å¦‚åŒ…å«çš„å­—æ®µï¼Œæ˜¯å¦å€’æ’ï¼Œæ˜¯å¦å­˜å‚¨ç­‰ç­‰ã€‚ä¸»è¦åŠŸèƒ½ï¼š\n å®šä¹‰ç´¢å¼•ä¸­å­—æ®µçš„åå­—ã€‚ å®šä¹‰å­—æ®µçš„æ•°æ®ç±»å‹ã€‚ å­—æ®µä»¥åŠå€’æ’ç´¢å¼•çš„ç›¸å…³é…ç½®ã€‚   åœ¨ESæ—©æœŸç‰ˆæœ¬ï¼Œä¸€ä¸ªç´¢å¼•æ˜¯å¯ä»¥æœ‰å¤šä¸ªTypeçš„ï¼Œä»7.0å¼€å§‹ï¼Œä¸€ä¸ªç´¢å¼•åªæœ‰ä¸€ä¸ªTypeï¼ˆåå­—å”¯ä¸€å®šä¹‰ä¸º_doc)ã€‚\n ä¸€ä¸ªMappingsçš„ç»„æˆéƒ¨åˆ†ï¼š\n åŠ¨æ€æ˜ å°„ï¼šè®¾ç½®åŠ¨æ€æ˜ å°„çš„è¡Œä¸ºã€‚ å…ƒæ•°æ®åŸŸï¼šå®šä¹‰æ–‡æ¡£çš„å…ƒæ•°æ®ä¿¡æ¯å¦‚ä½•ç»„ç»‡ï¼Œå…ƒæ•°æ®ä¿¡æ¯åŒ…æ‹¬_indexï¼Œ_id,_sourceä¸‰ä¸ªéƒ¨åˆ†ã€‚ å±æ€§   æ— æ³•æ›´æ–°ç°æœ‰å­—æ®µçš„æ˜ å°„ã€‚\n æ¯ä¸ªæ–‡æ¡£å°±æ˜¯ä¸€ä¸ªå±æ€§çš„é›†åˆï¼Œè€Œæ¯ä¸ªå±æ€§æœ‰æ¯ä¸ªå±æ€§çš„ç±»å‹ã€‚\n1. åŠ¨æ€æ˜ å°„-Dynamic mapping é€šè¿‡ç”¨æˆ·è¾“å…¥çš„æ•°æ®ï¼Œè‡ªåŠ¨æ¨æ–­å‡ºç”¨æˆ·è‡ªå®šä¹‰çš„å­—æ®µä»¥åŠå­—æ®µç›¸åº”çš„å„ç§å±æ€§ï¼Œç§°ä¸ºåŠ¨æ€æ˜ å°„ã€‚\ndynamicæ¨¡å¼ï¼š\n trueï¼šåŠ¨æ€æ·»åŠ æ–°å­—æ®µ falseï¼šç¦ç”¨ï¼Œå¿½ç•¥æ–°çš„å­—æ®µ strictï¼šä¸¥æ ¼æ¨¡å¼ï¼Œé‡åˆ°æ–°çš„å­—æ®µæŠ›å‡ºå¼‚å¸¸  è®¾ç½®è¯­å¥ï¼š\n1 2 3 4 5 6  put /indexName { \u0026#34;mappings\u0026#34;:{ \u0026#34;dynamic\u0026#34;:true|false|strict } }   ESå¯ä»¥è¿›è¡ŒåŠ¨æ€ç±»å‹æ¨æ–­ã€‚\n   JSONæ ¼å¼çš„æ•°æ® è‡ªåŠ¨æ¨æµ‹çš„å­—æ®µç±»å‹     null æ²¡æœ‰å­—æ®µè¢«æ·»åŠ    æ•°ç»„ ç”±æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªéç©ºå€¼å†³å®š   string æœ‰å¯èƒ½æ˜¯dateç±»å‹ï¼ˆå¼€å¯æ—¥æœŸæ£€æµ‹)ã€doubleæˆ–longç±»å‹ã€textç±»å‹ã€keywordç±»å‹   true or false booleanç±»å‹   floatingç±»å‹æ•°å­— floatingç±»å‹   integer longç±»å‹   JSONå¯¹è±¡ objectç±»å‹    åŠ¨æ€æ˜ å°„ä¸€æ—¦å¼€å¯ï¼Œå¾ˆå®¹æ˜“è¢«ç”¨æˆ·è¯¯ç”¨ï¼Œé€ æˆç´¢å¼•å­—æ®µçš„è†¨èƒ€/çˆ†ç‚¸ï¼Œæœ€ç»ˆå°±æ˜¯é€ æˆOOM(out of memory)ä»¥åŠå„ç§å¾ˆéš¾æ¢å¤çš„é—®é¢˜ï¼ŒESå†…éƒ¨æœ‰åšäº†ä¸€å®šé˜²èŒƒæ€§çš„é…ç½®ã€‚\n å¯¹å­—æ®µç±»å‹æ ¹æ®æ•°æ®æ ¼å¼è‡ªåŠ¨è¯†åˆ«çš„æ˜ å°„ç§°ä¹‹ä¸ºåŠ¨æ€æ˜ å°„ï¼ˆDynamic mappingï¼‰ï¼Œæˆ‘ä»¬åˆ›å»ºç´¢å¼•æ—¶å…·ä½“å®šä¹‰å­—æ®µç±»å‹çš„æ˜ å°„ç§°ä¹‹ä¸ºé™æ€æ˜ å°„æˆ–æ˜¾ç¤ºæ˜ å°„ï¼ˆExplicit mappingï¼‰\n 2. å…ƒæ•°æ®-Meta Data ESä¸‹ä¸€ä¸ªæ–‡æ¡£é™¤äº†æœ‰æ•°æ®ä¹‹å¤–ï¼Œè¿˜åŒ…å«äº†å…ƒæ•°æ®ã€‚æ¯åˆ›å»ºä¸€æ¡æ•°æ®æ—¶ï¼Œéƒ½ä¼šå¯¹å…ƒæ•°æ®è¿›è¡Œå†™å…¥ç­‰æ“ä½œã€‚\nå…³é—­æ‰€æœ‰æ•°æ®çš„ç´¢å¼•ï¼š\n1 2 3  \u0026#34;_all\u0026#34;: { \u0026#34;enabled\u0026#34;: false },   ESä¸­å…ƒæ•°æ®ç±»å‹ï¼š\n  èº«ä»½å…ƒæ•°æ®\n _index: æ–‡æ¡£æ‰€å±çš„ç´¢å¼•ï¼Œå¯ä»¥ç”¨æ¥æŒ‡å®šç´¢å¼•æŸ¥è¯¢ã€‚ _id: æ–‡æ¡£çš„å”¯ä¸€æ ‡è¯†ã€‚ _type: å·²ç§»é™¤    ç´¢å¼•å…ƒæ•°æ®\n _field_names: ç´¢å¼•äº†æ¯ä¸ªå­—æ®µçš„åå­—ï¼Œå¯ä»¥åŒ…å«nullå€¼ï¼ŒexistsæŸ¥è¯¢æˆ–missingæŸ¥è¯¢æ–¹æ³•é€šè¿‡è¯¥å±æ€§æ¥æ ¡éªŒç‰¹å®šçš„å­—æ®µï¼Œæœªæ¥åºŸå¼ƒâš ï¸ _ignore: å­˜å‚¨æ‰€æœ‰çš„é‚£äº›æ ¼å¼ä¸æ­£ç¡®çš„ä»¥åŠå­—æ®µå±æ€§ignore_malformedå¼€å¯çš„å­—æ®µï¼Œä¸€èˆ¬ä¸éœ€è¦ç‰¹æ®Šå®šä¹‰    æ–‡æ¡£å…ƒæ•°æ®\n  _source: ä¸€ä¸ªdocçš„åŸç”Ÿçš„jsonæ•°æ®ï¼Œä¸ä¼šè¢«ç´¢å¼•ï¼Œä½†æ˜¯ä¼šå­˜å‚¨ï¼Œç”¨æˆ·è·å–æå–å­—æ®µå€¼ ï¼Œå¦‚æœå¯åŠ¨æ­¤å­—æ®µï¼Œç´¢å¼•ä½“ç§¯ä¼šå˜å¤§,å¦‚æœæƒ³å…³é—­ï¼Œå¯ä»¥å¦‚ä¸‹è®¾ç½®ï¼š\nPUT shop { \u0026quot;mappings\u0026quot;: { \u0026quot;_source\u0026quot;: { \u0026quot;enabled\u0026quot;: false } } }   _sizeï¼š æ•´ä¸ª_sourceå­—æ®µçš„å­—èŠ‚æ•°å¤§å°ï¼Œéœ€è¦å•ç‹¬å®‰è£…ä¸€ä¸ªæ’ä»¶(mapper-size)æ‰èƒ½å±•ç¤ºï¼Œä¸€èˆ¬ä¸ä½¿ç”¨\n    è·¯ç”±å…ƒæ•°æ®\n  _routing: ä¸€ä¸ªdocå¯ä»¥è¢«è·¯ç”±åˆ°æŒ‡å®šçš„shardä¸Šï¼Œé€šè¿‡ä¸‹é¢çš„è§„åˆ™ï¼š shard_num = hash(_routing) % num_primary_shards ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨_idå­—æ®µæ¥å‚ä¸è·¯ç”±è§„åˆ™ï¼Œå¦‚æœæ­¤docæœ‰çˆ¶å­å…³ç³»ï¼Œåˆ™ä¼šä»¥çˆ¶äº²çš„_idä½œä¸ºè·¯ç”±è§„åˆ™ï¼Œä»¥ç¡®ä¿çˆ¶å­æ•°æ® å¿…é¡»å¤„äºåŒä¸€ä¸ªshardä¸Šï¼Œä»¥æé«˜joinæ•ˆç‡ã€‚\nGET shop/_doc/1?routing=user1  åœ¨ä½¿ç”¨è‡ªå·±çš„è·¯ç”±è§„åˆ™æ—¶æ³¨æ„_idå‚æ•°çš„å”¯ä¸€æ€§\n     å…¶ä»–ç±»å‹å…ƒæ•°æ®\n  _metaï¼šç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰æ•°æ®åˆ°å…ƒæ•°æ®ä¸­ï¼Œæ­¤å­—æ®µæ”¯æŒæŸ¥è¯¢å’Œæ›´æ–°ï¼Œå…¶ç”¨æ³•å¦‚ä¸‹:\nPUT shop { \u0026quot;mappings\u0026quot;: { \u0026quot;_meta\u0026quot;: { \u0026quot;class\u0026quot;: \u0026quot;MyApp::User\u0026quot;, \u0026quot;version\u0026quot;: { \u0026quot;min\u0026quot;: \u0026quot;1.0\u0026quot;, \u0026quot;max\u0026quot;: \u0026quot;1.3\u0026quot; } } } }     3. å±æ€§ propertiesæ˜¯ç”±ä¼—å¤šçš„å­—æ®µç»„æˆï¼Œå­—æ®µç”±å­—æ®µåã€å­—æ®µç±»å‹ã€å­—æ®µå±æ€§ç­‰ç»„æˆã€‚\nå­—æ®µç±»å‹\nå­—æ®µæ•°æ®ç±»å‹ï¼š\nå­—æ®µå±æ€§\n analyzerï¼šæŒ‡å®šåˆ†è¯å™¨(åˆ†æå™¨æ›´åˆç†)ï¼Œå¯¹ç´¢å¼•å’ŒæŸ¥è¯¢éƒ½æœ‰æ•ˆã€‚ normalizerï¼šnormalizerç”¨äºè§£æå‰çš„æ ‡å‡†åŒ–é…ç½®ï¼Œæ¯”å¦‚æŠŠæ‰€æœ‰çš„å­—ç¬¦è½¬åŒ–ä¸ºå°å†™ç­‰ã€‚ boostï¼šboostå­—æ®µç”¨äºè®¾ç½®å­—æ®µçš„æƒé‡ï¼Œæ¯”å¦‚ï¼Œå…³é”®å­—å‡ºç°åœ¨titleå­—æ®µçš„æƒé‡æ˜¯å‡ºç°åœ¨contentå­—æ®µä¸­æƒé‡çš„2å€ï¼Œè®¾ç½®mappingå¦‚ä¸‹ï¼Œå…¶ä¸­contentå­—æ®µçš„é»˜è®¤æƒé‡æ˜¯1. coerceï¼šcoerceå±æ€§ç”¨äºæ¸…é™¤è„æ•°æ®ï¼Œcoerceçš„é»˜è®¤å€¼æ˜¯trueã€‚æ•´å‹æ•°å­—5æœ‰å¯èƒ½ä¼šè¢«å†™æˆå­—ç¬¦ä¸²â€œ5â€æˆ–è€…æµ®ç‚¹æ•°5.0.coerceå±æ€§å¯ä»¥ç”¨æ¥æ¸…é™¤è„æ•°æ®ï¼š copy_toï¼šcopy_toå±æ€§ç”¨äºé…ç½®è‡ªå®šä¹‰çš„_allå­—æ®µã€‚ doc_valuesï¼šdoc_valuesæ˜¯ä¸ºäº†åŠ å¿«æ’åºã€èšåˆæ“ä½œï¼Œåœ¨å»ºç«‹å€’æ’ç´¢å¼•çš„æ—¶å€™ï¼Œé¢å¤–å¢åŠ ä¸€ä¸ªåˆ—å¼å­˜å‚¨æ˜ å°„ï¼Œæ˜¯ä¸€ä¸ªç©ºé—´æ¢æ—¶é—´çš„åšæ³•ã€‚ dynamicï¼šdynamicå±æ€§ç”¨äºæ£€æµ‹æ–°å‘ç°çš„å­—æ®µï¼Œæœ‰ä¸‰ä¸ªå–å€¼ï¼štrueã€flaseã€strict enabledï¼šElasticseaeché»˜è®¤ä¼šç´¢å¼•æ‰€æœ‰çš„å­—æ®µï¼Œenabledè®¾ä¸ºfalseçš„å­—æ®µï¼Œesä¼šè·³è¿‡å­—æ®µå†…å®¹ï¼Œè¯¥å­—æ®µåªèƒ½ä»_sourceä¸­è·å–ï¼Œä½†æ˜¯ä¸å¯æœã€‚è€Œä¸”å­—æ®µå¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚ fielddataï¼šæœç´¢è¦è§£å†³çš„é—®é¢˜æ˜¯â€œåŒ…å«æŸ¥è¯¢å…³é”®è¯çš„æ–‡æ¡£æœ‰å“ªäº›ï¼Ÿâ€ï¼Œèšåˆæ°æ°ç›¸åï¼Œèšåˆè¦è§£å†³çš„é—®é¢˜æ˜¯â€œæ–‡æ¡£åŒ…å«å“ªäº›è¯é¡¹â€ï¼Œå¤§å¤šæ•°å­—æ®µå†ç´¢å¼•æ—¶ç”Ÿæˆdoc_valuesï¼Œä½†æ˜¯textå­—æ®µä¸æ”¯æŒdoc_valuesã€‚ formatï¼šformatå±æ€§ä¸»è¦ç”¨äºæ ¼å¼åŒ–æ—¥æœŸ  ","description":"","id":5,"section":"posts","tags":["ES"],"title":"ES-mappings","uri":"https://hugo.jiahongw.com/zh/posts/es/es-mappings/"},{"content":"ES HTTP API ä½¿ç”¨æ¨¡æ¿ï¼š\nåˆ›å»ºç´¢å¼• åˆ›å»ºä¸€ä¸ªç´¢å¼•çš„æ–¹æ³•å¾ˆç®€å•ï¼Œåœ¨Kibanaä¸­è¿è¡Œä¸‹è¡Œè¯·æ±‚å³å¯åˆ›å»ºä¸€ä¸ªåä¸ºâ€œindex1â€çš„ç´¢å¼•\n1  PUT /index1   å¯ä»¥å¢åŠ ç›¸å…³è®¾ç½®å’Œæ˜ å°„ï¼š\n1 2 3 4 5 6 7 8 9 10 11  PUT /test { \u0026#34;settings\u0026#34;: { \u0026#34;number_of_shards\u0026#34;: 1 }, \u0026#34;mappings\u0026#34;: { \u0026#34;properties\u0026#34;: { \u0026#34;field1\u0026#34;: { \u0026#34;type\u0026#34;: \u0026#34;text\u0026#34; } } } }   åˆ›å»ºç´¢å¼•å¹¶ä¸”æ·»åŠ åˆ«å\næ·»åŠ aliasesï¼š\n1 2 3 4 5 6 7 8 9 10 11 12  PUT /test { \u0026#34;aliases\u0026#34;: { \u0026#34;alias_1\u0026#34;: {}, \u0026#34;alias_2\u0026#34;: { \u0026#34;filter\u0026#34;: { \u0026#34;term\u0026#34;: { \u0026#34;user.id\u0026#34;: \u0026#34;kimchy\u0026#34; } }, \u0026#34;routing\u0026#34;: \u0026#34;shard-1\u0026#34; } } }   ESä¸­ç´¢å¼•æ”¯æŒå…³é—­å’Œæ‰“å¼€æ“ä½œï¼Œä¸€ä¸ªå…³é—­çš„ç´¢å¼•é™¤äº†ç»´æŠ¤å…ƒæ•°æ®çš„åŸºæœ¬æ¶ˆè€—å¤–ï¼Œå‡ ä¹æ²¡æœ‰ä»»ä½•å…¶ä»–å¼€é”€ï¼Œåœ¨å…³é—­çŠ¶æ€ä¸‹çš„ç´¢å¼•ç¦æ­¢è¿›è¡ŒIOæ“ä½œï¼Œå†æ¬¡æ‰“å¼€åå¯æ¢å¤æ­£å¸¸çŠ¶æ€ã€‚\næ·»åŠ åˆ«åï¼š\n1 2 3 4 5 6 7 8 9 10 11  {\u0026#34;actions\u0026#34;:[{\u0026#34;add\u0026#34;:{\u0026#34;index\u0026#34;:\u0026#34;grocery_inventory_poi_stock_trans_143239919098404_202202\u0026#34;,\u0026#34;alias\u0026#34;:\u0026#34;grocery_inventory_poi_stock_trans_143239919098404\u0026#34;}},{\u0026#34;add\u0026#34;:{\u0026#34;index\u0026#34;:\u0026#34;grocery_inventory_shelf_stock_trans_143239919098404_202202\u0026#34;,\u0026#34;alias\u0026#34;:\u0026#34;grocery_inventory_shelf_stock_trans_143239919098404\u0026#34;}}]}  åˆ é™¤åˆ«åï¼š\n1 2 3 4 5 6 7 8 9 10 11  {\u0026#34;actions\u0026#34;:[{\u0026#34;remove\u0026#34;:{\u0026#34;index\u0026#34;:\u0026#34;grocery_inventory_poi_stock_trans_143239919098404_202202\u0026#34;,\u0026#34;alias\u0026#34;:\u0026#34;grocery_inventory_poi_stock_trans_143239919098404\u0026#34;}},{\u0026#34;remove\u0026#34;:{\u0026#34;index\u0026#34;:\u0026#34;grocery_inventory_shelf_stock_trans_143239919098404_202202\u0026#34;,\u0026#34;alias\u0026#34;:\u0026#34;grocery_inventory_shelf_stock_trans_143239919098404\u0026#34;}}]}  å…³é—­ç´¢å¼• è¯­æ³•ï¼šPOST /\u0026lt;index\u0026gt;/_close\n1  POST /index1/_close   è¿”å›ç»“æœï¼š\n1 2 3 4 5 6 7 8 9  { \u0026#34;acknowledged\u0026#34;: true, \u0026#34;shards_acknowledged\u0026#34;: true, \u0026#34;indices\u0026#34;: { \u0026#34;my-index-000001\u0026#34;: { \u0026#34;closed\u0026#34;: true } } }   æ”¯æŒä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå…³é—­ï¼š\n1  POST /index*/_close   æˆ–è€…ç›´æ¥æŒ‡å®šå…³é—­å¤šä¸ªç´¢å¼•(ç´¢å¼•ä¹‹é—´ä½¿ç”¨ , åˆ†éš”)ï¼š\n1  POST /index1,index2/_close    ESç´¢å¼•å¤„äºopençŠ¶æ€ï¼Œå°±ä¼šå ç”¨å†…å­˜+ç£ç›˜ï¼›\nå¦‚æœå°†ç´¢å¼•closeï¼Œåªä¼šå ç”¨ç£ç›˜ï¼Œå½“ç´¢å¼•æ¯”è¾ƒå¤šçš„æ—¶å€™å½±å“æŸ¥è¯¢é€Ÿåº¦ã€‚\n ä¿®æ”¹ç´¢å¼•ï¼š\nPUT localhost:9200/teacher/_settings { \u0026quot;number_of_replicas\u0026quot;: 3 } æ‰“å¼€ç´¢å¼• è¯­æ³•ï¼šPOST /\u0026lt;target\u0026gt;/_open\n1  POST /index1/_open   è¿”å›ç»“æœï¼š\n1 2 3 4  { \u0026#34;acknowledged\u0026#34; : true, \u0026#34;shards_acknowledged\u0026#34; : true }   æ”¯æŒä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæ‰¹é‡çš„æ‰“å¼€ç´¢å¼•ï¼š\n1  POST /index*/_open   æˆ–è€…ç›´æ¥æŒ‡å®šå…³é—­å¤šä¸ªç´¢å¼•(ç´¢å¼•ä¹‹é—´ä½¿ç”¨ , åˆ†éš”)ï¼š\n1  POST /index1,index2/_open    // å¯ä»¥ä½¿ç”¨_allæ‰“å¼€æˆ–å…³é—­å…¨éƒ¨ç´¢å¼•, ä¹Ÿå¯ä½¿ç”¨é€šé…ç¬¦(*)é…åˆæ“ä½œ\n1 2  POST _all/_close POST _all/_open    Postè¯·æ±‚å¯ä»¥æ·»åŠ ç›¸å…³çš„è¯·æ±‚å‚æ•°ï¼š\n1 2 3 4 5 6  { //æ˜¯å¦åœ¨ä»»ä½•æŒ‡å®šçš„ç´¢å¼•ä¸å¯ç”¨æ—¶å¿½ç•¥ï¼Œè¿™åŒ…æ‹¬ä¸å­˜åœ¨çš„ç´¢å¼•æˆ–å…³é—­çš„ç´¢å¼•ã€‚ \u0026#34;ignore_unavailable\u0026#34;: true, // å¦‚æœé€šé…ç¬¦ç´¢å¼•è¡¨è¾¾å¼å¯¼è‡´æ²¡æœ‰å…·ä½“ç´¢å¼•ï¼Œåˆ™æ§åˆ¶æ˜¯å¦å¤±è´¥. \u0026#34;allow_no_indices\u0026#34;: true, }   åˆ é™¤ç´¢å¼• åˆ é™¤ç´¢å¼•ï¼šé€šè¿‡ä¸‹æ–¹æ¥å£å¯ä»¥åˆ é™¤ä¸€ä¸ªç´¢å¼•ï¼Œå¦‚æœåˆ é™¤æˆåŠŸï¼Œå°†è¿”å›acknowledge:true\nè¯­æ³•ï¼šDELETE /\u0026lt;index\u0026gt;\n1  DELETE /index3?pretty   å±•ç¤ºç´¢å¼• åˆ—å‡ºæ‰€æœ‰çš„ç´¢å¼•ï¼š\n1 2  GET_cat/indices?vGETlocalhost:9200/_cat/indices?v  æ¨¡ç³ŠæŸ¥è¯¢ç´¢å¼•åï¼ŒæŸ¥æ‰¾åŒ…å«å•è¯dataçš„ç´¢å¼•åï¼š\n1  GET_cat/indices/*data*?v   ä½¿ç”¨prettyå…³é”®å­—è®©è¿”å›çš„ç»“æœæ ¼å¼åŒ–ï¼ˆæ›´åŠ ç¾è§‚ï¼‰ï¼š\n1  GET_cat/indices/*data*?v\u0026amp;pretty  ä½†æ˜¯æœ€å¥½ä»…ç”¨äºè°ƒè¯•\n æŸ¥è¯¢ç´¢å¼•é…ç½®ï¼š\n1  GET/{index}/_settings  è¯»å†™ç´¢å¼• åˆ›å»ºæ–‡æ¡£ ä½¿ç”¨è¯­æ³•ï¼š PUT /{index}/_doc/{id}\nä¾‹å­ï¼š\n1 2 3 4  PUTlocalhost:9200/student/_doc/1{\u0026#34;name\u0026#34;:\u0026#34;victor\u0026#34;}  è¿”å›ç»“æœï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  { \u0026#34;_index\u0026#34;: \u0026#34;student\u0026#34;, \u0026#34;_type\u0026#34;: \u0026#34;_doc\u0026#34;, \u0026#34;_id\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;_version\u0026#34;: 1, \u0026#34;result\u0026#34;: \u0026#34;created\u0026#34;, \u0026#34;_shards\u0026#34;: { \u0026#34;total\u0026#34;: 2, \u0026#34;successful\u0026#34;: 1, \u0026#34;failed\u0026#34;: 0 }, \u0026#34;_seq_no\u0026#34;: 0, \u0026#34;_primary_term\u0026#34;: 1 }    å‡å¦‚ç´¢å¼•studentä¹‹å‰æ²¡æœ‰åˆ›å»ºè¿‡ï¼Œæ‰§è¡Œè¿™æ¡è¯­å¥ä¹‹åä¹Ÿä¼šè‡ªåŠ¨åˆ›å»ºè¿™ä¸ªç´¢å¼•ï¼Œç›¸å…³çš„å‚æ•°éƒ½æ˜¯é»˜è®¤çš„å‚æ•°ã€‚å¦‚æœè¿˜æ²¡æœ‰åˆ›å»ºä¸€ä¸ªåŠ¨æ€ç±»å‹æ˜ å°„ï¼Œä¹Ÿä¼šè‡ªåŠ¨ä¸ºç‰¹å®šç±»å‹åˆ›å»ºä¸€ä¸ªåŠ¨æ€ç±»å‹æ˜ å°„ã€‚ï¼ˆä½¿ç”¨åŠ¨æ€æ˜ å°„å¾ˆæ¶ˆè€—æ€§èƒ½ï¼‰\né€šè¿‡è®¾ç½®é…ç½®æ–‡ä»¶ä¸­çš„action.auto_create_index ä¸º false æˆ–è€…é€šè¿‡è®¾ç½® setting çš„ index.mapper.dynamic ä¸º falseã€‚\n è‡ªåŠ¨å¡«å……idï¼š\n1 2 3 4  POSTlocalhost:9200/student/_doc{\u0026#34;name\u0026#34;:\u0026#34;hong\u0026#34;}  ç»“æœè‡ªåŠ¨ç”Ÿæˆéšæœºçš„IDï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  { \u0026#34;_index\u0026#34;: \u0026#34;student\u0026#34;, \u0026#34;_type\u0026#34;: \u0026#34;_doc\u0026#34;, \u0026#34;_id\u0026#34;: \u0026#34;obtj3nwBLeSa-n0f2397\u0026#34;, \u0026#34;_version\u0026#34;: 1, \u0026#34;result\u0026#34;: \u0026#34;created\u0026#34;, \u0026#34;_shards\u0026#34;: { \u0026#34;total\u0026#34;: 2, \u0026#34;successful\u0026#34;: 1, \u0026#34;failed\u0026#34;: 0 }, \u0026#34;_seq_no\u0026#34;: 0, \u0026#34;_primary_term\u0026#34;: 2 }   æ›´æ–°æ–‡æ¡£ ä½¿ç”¨è¯­æ³•ï¼šPUT /{index}/{type}/{id}\nsourceé‡Œé¢çš„å­—æ®µæ˜ å°„ æŸ¥è¯¢å¹¶æ›´æ–°æ–‡æ¡£ POST index/type/_update_by_query { \u0026quot;script\u0026quot;: { \u0026quot;source\u0026quot;: \u0026quot;ctx._source['type']='å…”å­'\u0026quot; }, \u0026quot;query\u0026quot;: { \u0026quot;term\u0026quot;: { \u0026quot;petRaceId\u0026quot;: { \u0026quot;value\u0026quot;: \u0026quot;3\u0026quot; } } } } ä¸Šé¢çš„ä¾‹å­è¡¨ç¤ºå°†å­—æ®µpetRaceIdçš„value=3çš„æ–‡æ¡£çš„typeå€¼æ”¹ä¸ºï¼šå…”å­ã€‚\nJava APIçš„ä½¿ç”¨ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  public void updateByQuery(Long routeId, String index, String type, QueryBuilder query, String strScript) { PorosRestHighLevelClient client = getEagleClient(routeId); String endpoint = \u0026#34;/\u0026#34; + index + \u0026#34;/\u0026#34; + type + \u0026#34;/_update_by_query?conflicts=proceed\u0026#34;; if (query == null) { return; } String queryString = \u0026#34;{\u0026#34; + \u0026#34; \\\u0026#34;script\\\u0026#34;: { \u0026#34; + \u0026#34; \\\u0026#34;source\\\u0026#34;: \u0026#34; + \u0026#34;\\\u0026#34;\u0026#34; + strScript + \u0026#34;\\\u0026#34;\u0026#34; + \u0026#34;},\u0026#34; + \u0026#34; \\\u0026#34;query\\\u0026#34;: \u0026#34; + query.toString() + \u0026#34;}\u0026#34;; try { lowLevelPerformRequest(client, queryString, endpoint, HttpPost.METHOD_NAME); } catch (Exception e) { LOGGER.error(\u0026#34;updateByQuery è¯·æ±‚å¤±è´¥\u0026#34;, e); } }   UpdateByQueryRequest APIåœ¨ES6ä»¥ä¸Šçš„ç‰ˆæœ¬é€‚ç”¨ã€‚\n scriptç¼–å†™æŒ‡å—ï¼š\n  ä¿®æ”¹å¤šå€¼ï¼š\n1 2 3 4  { \u0026#34;script\u0026#34;: {\u0026#34;source\u0026#34;:\u0026#34;ctx._source[\u0026#39;user_name\u0026#39;]=\u0026#39;LsiuLi\u0026#39;;ctx._source[\u0026#39;assignedto_id\u0026#39;]=\u0026#39;123\u0026#39;;\u0026#34;}, \u0026#34;query\u0026#34;: {\u0026#34;term\u0026#34;: {\u0026#34;user_id\u0026#34;: 60}} }     å¢åŠ æ•°ç»„å…ƒç´ \nhttp://localhost:9200/1909_user/user/15670260/_update\n1 2 3 4 5 6 7 8 9  { \u0026#34;script\u0026#34;: { \u0026#34;lang\u0026#34;: \u0026#34;painless\u0026#34;, \u0026#34;source\u0026#34;:\u0026#34;ctx._source[\u0026#39;field_mult_value_7917\u0026#39;].add(params.hobby)\u0026#34;, \u0026#34;params\u0026#34; : { \u0026#34;hobby\u0026#34; : \u0026#34;c\u0026#34; } } }     åˆ é™¤indexä¸­çš„field\nhttp://localhost:9200/1542_case/case/_update_by_query?wait_for_completion=false\u0026amp;conflicts=proceed\n1 2 3  { \u0026#34;script\u0026#34;: {\u0026#34;source\u0026#34;:\u0026#34;ctx._source.remove(\u0026#39;user_field_email_5613\u0026#39;)\u0026#34;} }      ?conflicts=proceed è¡¨ç¤ºä»€ä¹ˆæ„æ€ï¼Ÿ\næŸ¥è¯¢ç´¢å¼• ä½¿ç”¨è¯­æ³•ï¼šGET {index}/_search\nè¿”å›ç´¢å¼•çš„æ‰€æœ‰ä¿¡æ¯ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48  { \u0026#34;took\u0026#34;: 49, \u0026#34;timed_out\u0026#34;: false, \u0026#34;_shards\u0026#34;: { \u0026#34;total\u0026#34;: 3, \u0026#34;successful\u0026#34;: 3, \u0026#34;skipped\u0026#34;: 0, \u0026#34;failed\u0026#34;: 0 }, \u0026#34;hits\u0026#34;: { \u0026#34;total\u0026#34;: { \u0026#34;value\u0026#34;: 3, \u0026#34;relation\u0026#34;: \u0026#34;eq\u0026#34; }, \u0026#34;max_score\u0026#34;: 1.0, \u0026#34;hits\u0026#34;: [ { \u0026#34;_index\u0026#34;: \u0026#34;student\u0026#34;, \u0026#34;_type\u0026#34;: \u0026#34;_doc\u0026#34;, \u0026#34;_id\u0026#34;: \u0026#34;obtj3nwBLeSa-n0f2397\u0026#34;, \u0026#34;_score\u0026#34;: 1.0, \u0026#34;_source\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;hong\u0026#34; } }, { \u0026#34;_index\u0026#34;: \u0026#34;student\u0026#34;, \u0026#34;_type\u0026#34;: \u0026#34;_doc\u0026#34;, \u0026#34;_id\u0026#34;: \u0026#34;ort13nwBLeSa-n0fTn_g\u0026#34;, \u0026#34;_score\u0026#34;: 1.0, \u0026#34;_routing\u0026#34;: \u0026#34;hong\u0026#34;, \u0026#34;_source\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;hong\u0026#34;, \u0026#34;age\u0026#34;: 22 } }, { \u0026#34;_index\u0026#34;: \u0026#34;student\u0026#34;, \u0026#34;_type\u0026#34;: \u0026#34;_doc\u0026#34;, \u0026#34;_id\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;_score\u0026#34;: 1.0, \u0026#34;_source\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;victor\u0026#34; } } ] } }   æŸ¥è¯¢æ–‡æ¡£ æ¯ä¸ªæ–‡æ¡£éƒ½æœ‰ä¸€ä¸ª _id å”¯ä¸€æ ‡è¯†ï¼Œè¿™ä¸ªidå¯ä»¥åœ¨åˆ›å»ºæ–‡æ¡£çš„æ—¶å€™æ‰‹åŠ¨ä¼ å…¥æˆ–è€…ç”±esè‡ªå·±ç”Ÿæˆã€‚\n _id å­—æ®µåœ¨åšèšåˆã€æ’åºã€è„šæœ¬æ—¶åŠŸèƒ½å—é™ï¼Œå¦‚æœè¯´ä¸Šè¿°æ“ä½œéœ€è¦ç”¨åˆ° _id å­—æ®µï¼Œéœ€è¦æŠŠ _id çš„å€¼åœ¨ doc_values é‡Œä¹Ÿä¿å­˜ä¸€ä»½\n 1 æ ¹æ® get api æŸ¥è¯¢ GET {my_index}/_doc/{myid} 2 æ ¹æ® ids query æŸ¥è¯¢ GET {my_index}/_search { \u0026quot;query\u0026quot;: { \u0026quot;ids\u0026quot;: { \u0026quot;values\u0026quot;:[1,2,3] } } } 3 æ ¹æ® term , terms , match æŸ¥è¯¢ # term GET {my_index}/_search { \u0026quot;query\u0026quot;: { \u0026quot;term\u0026quot;: { \u0026quot;_id\u0026quot;: { \u0026quot;value\u0026quot;: \u0026quot;1\u0026quot; } } } } } # terms GET {my_index}/_search { \u0026quot;query\u0026quot;: { \u0026quot;terms\u0026quot;: { \u0026quot;_id\u0026quot;: [ \u0026quot;1\u0026quot;,\u0026quot;2\u0026quot; ] } } } } # match GET {my_index}/_search { \u0026quot;query\u0026quot;: { \u0026quot;match\u0026quot;: { \u0026quot;_id\u0026quot;: 1 } } } } ç»„åˆæŸ¥è¯¢ï¼š\n{ \u0026quot;query\u0026quot;: { \u0026quot;bool\u0026quot;: { \u0026quot;must\u0026quot;: [ { \u0026quot;term\u0026quot;: { \u0026quot;poiId\u0026quot;: \u0026quot;142958687180976\u0026quot; } }, { \u0026quot;term\u0026quot;: { \u0026quot;skuId\u0026quot;: \u0026quot;100176717278999\u0026quot; } } ], \u0026quot;must_not\u0026quot;: [], \u0026quot;should\u0026quot;: [ { \u0026quot;term\u0026quot;: { \u0026quot;shelfCode\u0026quot;: \u0026quot;CW-01-01-01-01\u0026quot; } }, { \u0026quot;term\u0026quot;: { \u0026quot;newShelfCode\u0026quot;: \u0026quot;CW-01-01-01-01\u0026quot; } } ], \u0026quot;filter\u0026quot;: [] } }, \u0026quot;from\u0026quot;: 0, \u0026quot;size\u0026quot;: 10, \u0026quot;sort\u0026quot;: [], \u0026quot;profile\u0026quot;: false } æŸ¥è¯¢è¿”å›æŒ‡å®šçš„å­—æ®µ ä¸è¿”å›æ–‡æ¡£ï¼š\n1 2 3 4 5 6 7  GET /_search { \u0026#34;_source\u0026#34;: false, \u0026#34;query\u0026#34; : { \u0026#34;term\u0026#34; : { \u0026#34;user\u0026#34; : \u0026#34;kimchy\u0026#34; } } }   è¿”å›æŒ‡å®šçš„å­—æ®µï¼š\n1 2 3 4 5 6 7 8 9 10  GET /_search { \u0026#34;_source\u0026#34;: { \u0026#34;includes\u0026#34;: [ \u0026#34;obj1.*\u0026#34;, \u0026#34;obj2.*\u0026#34; ], \u0026#34;excludes\u0026#34;: [ \u0026#34;*.description\u0026#34; ] }, \u0026#34;query\u0026#34; : { \u0026#34;term\u0026#34; : { \u0026#34;user\u0026#34; : \u0026#34;kimchy\u0026#34; } } }   æˆ–è€…\n1 2 3 4 5 6 7  GET /_search { \u0026#34;_source\u0026#34;: [\u0026#34;shelfId\u0026#34;], \u0026#34;query\u0026#34; : { \u0026#34;term\u0026#34; : { \u0026#34;user\u0026#34; : \u0026#34;kimchy\u0026#34; } } }   Java:\n1 2 3 4  # source è¿‡æ»¤ String[] includeFields = new String[] {\u0026#34;test1\u0026#34;, \u0026#34;test2\u0026#34;}; String[] excludeFields = new String[] {\u0026#34;test1\u0026#34;, \u0026#34;test2\u0026#34;}; sourceBuilder.fetchSource(includeFields, excludeFields);   å»é‡ ä½¿ç”¨collapseæŠ˜å å­—æ®µ\n1 2 3 4 5 6 7 8 9 10 11  POST /user_onoffline_log/ { \u0026#34;query\u0026#34;:{ \u0026#34;match_all\u0026#34;:{ } }, \u0026#34;collapse\u0026#34;:{ \u0026#34;field\u0026#34;:\u0026#34;uid\u0026#34; } }   Java\n1  searchRequest.source().collapse(new CollapseBuilder(\u0026#34;field\u0026#34;));   å…¬å…±å‚æ•°è®¾ç½® ç»“æœè¿‡æ»¤å‚æ•°filter_path ä½¿ç”¨ä¾‹å­ï¼š\n1  GET/_search?q=elasticsearch\u0026amp;filter_path=took,hits.hits._id,hits.hits._score  è¾“å‡ºç»“æœæ ·ä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11  { \u0026#34;took\u0026#34; : 3, \u0026#34;hits\u0026#34; : { \u0026#34;hits\u0026#34; : [ { \u0026#34;_id\u0026#34; : \u0026#34;0\u0026#34;, \u0026#34;_score\u0026#34; : 1.6375021 } ] } }   ä¹Ÿæ”¯æŒä½¿ç”¨é€šé…ç¬¦ * è¿›è¡ŒåŒ¹é…ï¼š\n1  GET/_cluster/state?filter_path=metadata.indices.*.stat*  ç»“æœï¼š\n1 2 3 4 5 6 7  { \u0026#34;metadata\u0026#34; : { \u0026#34;indices\u0026#34; : { \u0026#34;twitter\u0026#34;: {\u0026#34;state\u0026#34;: \u0026#34;open\u0026#34;} } } }   ** å¯ç”¨äºåœ¨ä¸çŸ¥é“å­—æ®µçš„ç¡®åˆ‡è·¯å¾„çš„æƒ…å†µä¸‹åŒ…å«å­—æ®µã€‚\n1  GET/_cluster/state?filter_path=metadata.**.stat*  é“ºå¹³å‚æ•°flat_settings ä½¿ç”¨ flat_settings å‚æ•°ï¼Œå¹¶ä¸”è®¾ç½®ä¸º true å¯ä»¥è®©è¿”å›çš„çš„Jsonæ•°æ®å±•å¼€ï¼Œå‡å°‘èŠ±æ‹¬å·ã€‚\nä½¿ç”¨æ–¹å¼ï¼šGetæ–¹æ³•åé¢æ·»åŠ  ?flat_settings=true\nåŸæ¥ï¼š /indexName/_settings\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  { \u0026#34;grocery_inventory_inventory_transaction_143179120435102_202108\u0026#34;: { \u0026#34;settings\u0026#34;: { \u0026#34;index\u0026#34;: { \u0026#34;refresh_interval\u0026#34;: \u0026#34;1s\u0026#34;, \u0026#34;number_of_shards\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;provided_name\u0026#34;: \u0026#34;grocery_inventory_inventory_transaction_143179120435102_202108\u0026#34;, \u0026#34;creation_date\u0026#34;: \u0026#34;1628582799738\u0026#34;, \u0026#34;number_of_replicas\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;uuid\u0026#34;: \u0026#34;lm22sPdbSrmGuaqIg03QOg\u0026#34;, \u0026#34;version\u0026#34;: { \u0026#34;created\u0026#34;: \u0026#34;5060399\u0026#34; } } } } }   ä½¿ç”¨åï¼š /indexName/_settings?flat_settings=true\n1 2 3 4 5 6 7 8 9 10 11 12 13  { \u0026#34;grocery_inventory_inventory_transaction_143179120435102_202108\u0026#34;: { \u0026#34;settings\u0026#34;: { \u0026#34;index.creation_date\u0026#34;: \u0026#34;1628582799738\u0026#34;, \u0026#34;index.refresh_interval\u0026#34;: \u0026#34;1s\u0026#34;, \u0026#34;index.uuid\u0026#34;: \u0026#34;lm22sPdbSrmGuaqIg03QOg\u0026#34;, \u0026#34;index.version.created\u0026#34;: \u0026#34;5060399\u0026#34;, \u0026#34;index.provided_name\u0026#34;: \u0026#34;grocery_inventory_inventory_transaction_143179120435102_202108\u0026#34;, \u0026#34;index.number_of_replicas\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;index.number_of_shards\u0026#34;: \u0026#34;1\u0026#34; } } }   è¯·æ±‚å‚æ•°æŸ¥è¯¢ æ ¹æ®æ¡ä»¶æŸ¥è¯¢ç´¢å¼•ä¿¡æ¯ï¼š\n1 2 3 4 5 6  GET/twitter/_doc/_search{\u0026#34;query\u0026#34;:{\u0026#34;term\u0026#34;:{\u0026#34;user\u0026#34;:\u0026#34;kimchy\u0026#34;}}}  ReIndex Reindexçš„ç›®æ ‡æ˜¯æŠŠç´¢å¼•æ•°æ®ä»ä¸€ä¸ªç´¢å¼•è¿ç§»è‡³å¦ä¸€ä¸ªç´¢å¼•ï¼Œä¸»è¦é’ˆå¯¹äºç´¢å¼•å˜æ›´ï¼Œæ¯”å¦‚éœ€è¦ä¿®æ”¹å­—æ®µç±»å‹ï¼Œæ–°å¢å­—æ®µç­‰éœ€æ±‚ã€‚\nåŸºæœ¬å‘½ä»¤ï¼š\n1 2 3 4 5 6 7 8 9  POST/_reindex{\u0026#34;source\u0026#34;:{\u0026#34;index\u0026#34;:\u0026#34;old_index\u0026#34;},\u0026#34;dest\u0026#34;:{\u0026#34;index\u0026#34;:\u0026#34;new_index\u0026#34;}}  å¤æ‚å‘½ä»¤ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  POST/_reindex{\u0026#34;source\u0026#34;:{\u0026#34;remote\u0026#34;:{\u0026#34;host\u0026#34;:\u0026#34;http://$HOST:8080\u0026#34;,\u0026#34;username\u0026#34;:\u0026#34;$APP\u0026#34;,\u0026#34;password\u0026#34;:\u0026#34;$ACCESSKEY\u0026#34;},\u0026#34;index\u0026#34;:\u0026#34;old_index\u0026#34;,\u0026#34;query\u0026#34;:{\u0026#34;bool\u0026#34;:{\u0026#34;must\u0026#34;:[{\u0026#34;match_all\u0026#34;:{}}],\u0026#34;must_not\u0026#34;:[],\u0026#34;should\u0026#34;:[],\u0026#34;filter\u0026#34;:[]}}},\u0026#34;dest\u0026#34;:{\u0026#34;index\u0026#34;:\u0026#34;new_index\u0026#34;}}  åŒæ­¥å¢é‡æ•°æ®å‘½ä»¤:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  POST/_reindex{\u0026#34;conflicts\u0026#34;:\u0026#34;proceed\u0026#34;,\u0026#34;source\u0026#34;:{\u0026#34;index\u0026#34;:\u0026#34;inventory_cost_record\u0026#34;,\u0026#34;query\u0026#34;:{\u0026#34;bool\u0026#34;:{\u0026#34;must\u0026#34;:[{\u0026#34;range\u0026#34;:{\u0026#34;bizTime\u0026#34;:{\u0026#34;gt\u0026#34;:\u0026#34;2022-01-1700:00:00\u0026#34;,\u0026#34;lt\u0026#34;:\u0026#34;2022-01-1900:00:00\u0026#34;}}}]}},\u0026#34;size\u0026#34;:500},\u0026#34;dest\u0026#34;:{\u0026#34;index\u0026#34;:\u0026#34;cost_accounting_record\u0026#34;,\u0026#34;version_type\u0026#34;:\u0026#34;external\u0026#34;,\u0026#34;op_type\u0026#34;:\u0026#34;create\u0026#34;}}   version_typeå­—æ®µè¯´æ˜:\n ã€é»˜è®¤è¦†ç›–ã€‘å¿½ç•¥version_typeå­—æ®µï¼Œæˆ–é…ç½®ä¸ºâ€œinternalâ€ï¼ˆé»˜è®¤é…ç½®ï¼‰ï¼šå°†æ–‡æ¡£å®Œå…¨dumpåˆ°ç›®çš„ç´¢å¼•ï¼Œè¦†ç›–å…·æœ‰ç›¸åŒç±»å‹å’Œidçš„ä»»ä½•æ–‡æ¡£å†…å®¹ï¼Œä¸ä¼šäº§ç”Ÿå†²çªé—®é¢˜ï¼› ã€ä¿ç•™æœ€æ–°ã€‘é…ç½®ä¸ºâ€œexternalâ€ï¼šesä»æºæ–‡ä»¶ä¸­è¯»å–versionå­—æ®µï¼Œå½“é‡åˆ°ç›¸åŒç±»å‹å’Œidçš„æ–‡æ¡£æ—¶ï¼Œåªä¿ç•™newer versionï¼Œå³æœ€æ–°çš„versionå¯¹åº”çš„æ•°æ®ã€‚åˆ›å»ºç›®æ ‡ç´¢å¼•ä¸­ç¼ºå¤±çš„æ‰€æœ‰æ–‡æ¡£ï¼Œå¹¶æ›´æ–°åœ¨ç›®æ ‡ç´¢å¼•ä¸­æ¯”åŸç´¢å¼•ä¸­ç‰ˆæœ¬æ›´è€çš„æ‰€æœ‰æ–‡æ¡£ï¼› ã€å†²çªæ•°æ®æ— æ³•å†™å…¥ã€‘op_typeé…ä¸ºâ€œcreateâ€ï¼šä»…åœ¨ç›®æ ‡ç´¢å¼•ä¸­åˆ›å»ºç¼ºå°‘çš„æ–‡æ¡£ã€‚æ‰€æœ‰å­˜åœ¨çš„æ–‡æ¡£å°†å¯¼è‡´ç‰ˆæœ¬å†²çªã€‚(åœ¨ä½¿ç”¨äº†op_typeä¸ºcreateçš„æƒ…å†µä¸‹ï¼Œé»˜è®¤ç‰ˆæœ¬å†²çªå°†ä¸­æ­¢â€œ_reindexâ€è¿›ç¨‹ï¼Œä½†å¯ä»¥é€šè¿‡è®¾ç½®â€œconflict:proceedâ€æ¥åœ¨å†²çªæ—¶è¿›è¡Œè®¡æ•°ã€‚å³ä½¿å†²çªï¼Œä»èƒ½å¤Ÿæ­£å¸¸è¿›è¡Œreindexï¼Œä½†ä¼šé—æ¼æœ‰å†²çªçš„æ•°æ®ã€‚)   Mapping mappingåˆ›å»ºä¹‹åï¼Œè¿˜èƒ½è¿›è¡Œæ›´æ–°å—ï¼Ÿ\nå·²ç»å®šä¹‰çš„å­—æ®µå¤§å¤šæ•°æƒ…å†µä¸èƒ½è¢«æ›´æ–°ï¼Œé™¤é reindex æ›´æ–° mappingï¼Œä¸‹é¢çš„æƒ…å†µæ˜¯ä¾‹å¤–ï¼š\n Object å¯¹è±¡å¯ä»¥æ·»åŠ æ–°çš„å±æ€§ å·²ç»å­˜åœ¨çš„fieldsé‡Œé¢å¯ä»¥æ·»åŠ fieldsï¼Œä»¥æ„æˆä¸€ä¸ªå­—æ®µå¤šç§ç±»å‹ ignore_above æ˜¯å¯ä»¥æ›´æ–°çš„  ES Java API æ·»åŠ ä¾èµ–åŒ… å¯¹äºåŸç”Ÿçš„springå·¥ç¨‹ï¼Œåˆ™å¼•å…¥ä»¥ä¸‹å¯¹åº”çš„åŒ…:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.sankuai.meituan\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;eagle-restclient\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.24\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.sankuai.octo\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;idl-common\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.9.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.elasticsearch\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;elasticsearch\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5.6.3\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.elasticsearch.client\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;transport\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5.6.3\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.netty\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;netty-all\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.1.13.Final\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.netty\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;netty\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.10.6.Final\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt;   Rest Client Java RESTå®¢æˆ·ç«¯æœ‰ä¸¤ç§é£æ ¼ï¼š\n Javaä½çº§åˆ«RESTå®¢æˆ·ç«¯ï¼ˆJava Low Level REST Clientï¼Œä»¥åéƒ½ç®€ç§°ä½çº§å®¢æˆ·ç«¯ç®—äº†ï¼Œéš¾å¾—ç å­—ï¼‰ï¼šElasticsearchçš„å®˜æ–¹low-levelå®¢æˆ·ç«¯ã€‚ å®ƒå…è®¸é€šè¿‡httpä¸Elasticsearché›†ç¾¤è¿›è¡Œé€šä¿¡ã€‚ ä¸ä¼šå¯¹è¯·æ±‚è¿›è¡Œç¼–ç å’Œå“åº”è§£ç ã€‚ å®ƒä¸æ‰€æœ‰Elasticsearchç‰ˆæœ¬å…¼å®¹ã€‚ Javaé«˜çº§RESTå®¢æˆ·ç«¯ï¼ˆJava High Level REST Clientï¼Œä»¥åéƒ½ç®€ç§°é«˜çº§å®¢æˆ·ç«¯ï¼‰ï¼šElasticsearchçš„å®˜æ–¹high-levelå®¢æˆ·ç«¯ã€‚ åŸºäºlow-levelå®¢æˆ·ç«¯ï¼Œå®ƒå…¬å¼€äº†APIç‰¹å®šçš„æ–¹æ³•,å¹¶è´Ÿè´£å¤„ç†ã€‚  Java Low Level REST Client æ–°å»ºä¸€ä¸ªJava Low Level REST Clientåªéœ€å‡ ä¸ªå‚æ•°\nåˆå§‹åŒ–ï¼š\n1 2 3  RestClient restClient = RestClient.builder( new HttpHost(\u0026#34;localhost\u0026#34;, 9200, \u0026#34;http\u0026#34;), new HttpHost(\u0026#34;localhost\u0026#34;, 9201, \u0026#34;http\u0026#34;)).build();   ä¹Ÿå¯è®¾ç½®ç›¸å…³å‚æ•°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13  RestClientBuilder builder = RestClient.builder(new HttpHost(\u0026#34;localhost\u0026#34;, 9200, \u0026#34;http\u0026#34;)); // è®¾ç½®HTTPè¯·æ±‚å¤´çš„é”®å€¼å¯¹ Header[] defaultHeaders = new Header[]{new BasicHeader(\u0026#34;header\u0026#34;, \u0026#34;value\u0026#34;)}; builder.setDefaultHeaders(defaultHeaders); // è®¾ç½®è¶…æ—¶æ—¶é—´ builder.setMaxRetryTimeoutMillis(10000); // è®¾ç½®å¤±è´¥å›è°ƒå‡½æ•° builder.setFailureListener(new RestClient.FailureListener() { @Override public void onFailure(HttpHost host) { } });   å…³é—­ RestClientï¼š\n1  restClient.close();   æœ€å¥½ä½¿ç”¨é«˜çº§åˆ«APIï¼Œå³Java High Level REST Clientã€‚\nJava High Level REST Client åˆå§‹åŒ– RestHighLevelClientï¼š\n1 2 3  RestClient lowLevelRestClient = RestClient.builder( new HttpHost(\u0026#34;localhost\u0026#34;, 9200, \u0026#34;http\u0026#34;), new HttpHost(\u0026#34;localhost\u0026#34;, 9201, \u0026#34;http\u0026#34;)).build();   1 2  RestHighLevelClient client = new RestHighLevelClient(lowLevelRestClient);   åˆ›å»ºè¯·æ±‚\næ‰§è¡Œè¯·æ±‚\næ–‡æ¡£æ›´æ–° æ„é€ æ–‡æ¡£æ›´æ–°å†…å®¹ï¼š\n jsonString Map XContentBuilder  ScrollæŸ¥è¯¢ ES ScrollåŠŸèƒ½åˆå«åšæ¸¸æ ‡æŸ¥è¯¢ï¼Œè¯¥åŠŸèƒ½èƒ½å¤Ÿé«˜æ•ˆçš„éå†ESæŸ¥è¯¢çš„ç»“æœé›†ï¼Œä¸»è¦ç”¨äºè§£å†³ESæ™®é€šæŸ¥è¯¢æ·±åº¦ç¿»é¡µæ—¶çš„æ€§èƒ½é—®é¢˜ã€‚å› æ­¤ï¼ŒScrollåŠŸèƒ½å¸¸å¸¸ç”¨åœ¨éå®æ—¶åœºæ™¯ä¸‹æ£€ç´¢å¤§é‡ç»“æœï¼Œè¯¥åŠŸèƒ½æœ‰ä»¥ä¸‹ä¼˜ç¼ºç‚¹ï¼š\n ä¼˜ç‚¹ï¼šé’ˆå¯¹æ·±åº¦ç¿»é¡µåœºæ™¯ä¼˜åŒ–ï¼Œè·å–æ•°æ®çš„æ€§èƒ½æ¶ˆè€—æ—¶å›ºå®šçš„ï¼ŒæŸ¥è¯¢æ€§èƒ½ä¸ä¼šéšç€é¡µæ•°å¢å¤šè€Œæ€¥å‰§ä¸‹é™ï¼› ç¼ºç‚¹ï¼šScrollåŠŸèƒ½æ˜¯æœ‰çŠ¶æ€çš„ï¼ŒESæœåŠ¡ç«¯ä¼šæ ¹æ®Scroll IDç»´æŒç¿»é¡µçŠ¶æ€ï¼Œéœ€è¦æ ¹æ®Scroll IDé¡ºåºç¿»é¡µï¼ˆç±»ä¼¼æ•°æ®åº“æ¸¸æ ‡ï¼‰ï¼ŒScrollç¿»é¡µè¿‡ç¨‹ä¸­ï¼Œæ–°çš„æ•°æ®å˜æ›´ä¸ä¼šä½“ç°åˆ°è¿”å›çš„ç»“æœé›†ä¸­ï¼Œä¸é€‚åˆå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ï¼›  çŸ¥é“äº†Scrollçš„åº”ç”¨åœºæ™¯åŠä¼˜ç¼ºç‚¹ï¼Œæˆ‘ä»¬å…ˆæ¥åˆ†æä¸‹å¸¸è§„ESæŸ¥è¯¢æ·±åº¦ç¿»é¡µä¸ºä»€ä¹ˆä¼šå‡ºç°æ€§èƒ½é—®é¢˜ã€‚\nåŸç†\næ·±åº¦ç¿»é¡µæœ€ä¸»è¦çš„ç“¶é¢ˆåœ¨äºQueryé˜¶æ®µï¼ŒQueryé˜¶æ®µæ€»å…±éœ€è¦ä»NodeèŠ‚ç‚¹è·å–nodeNum *ï¼ˆfrom + sizeï¼‰æ¡æ•°æ®çš„doc_idå’Œè¯„åˆ†ï¼Œè¿™äº›è®°å½•åœ¨Coordinate Nodeæ’åºåï¼Œç»å¤§éƒ¨åˆ†æ•°æ®ä¼šè¢«ä¸¢å¼ƒï¼Œåªä½¿ç”¨æœ€åæ»¡è¶³æ¡ä»¶çš„sizeä¸ªdoc_idã€‚æ‰€ä»¥ï¼Œéšç€é¡µå·çš„å¢å¤§ï¼Œæ€§èƒ½ä¸»è¦æ¶ˆè€—åœ¨ä¸éœ€è¦çš„æ•°æ®ä¸Šï¼ŒES Scrollå°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„æŠ˜ä¸­æ–¹æ¡ˆï¼Œåœ¨ä½¿ç”¨Scroll APIæ—¶ï¼ŒESä¼šåœ¨æœåŠ¡ç«¯è®°å½•ä¸€ä¸ªæ¸¸æ ‡ï¼Œæ¯æ¬¡æŸ¥è¯¢æ—¶åªè·å–æ¸¸æ ‡ä¹‹åçš„sizeæ¡æ•°æ®ï¼Œè¿™æ ·å°±é¿å…äº†Queryé˜¶æ®µçš„æ—¶é—´æµªè´¹åœ¨ä¸éœ€è¦çš„æ•°æ®ä¸Šã€‚\næœ¬åœ°å®è·µ å®‰è£…ESï¼š\n1 2 3 4 5  # å®‰è£…es brew install elasticsearch # å®‰è£…æˆåŠŸåï¼ŒæŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ elasticsearch --version   å¯åŠ¨ESï¼š\n1  elasticsearch   æµè§ˆå™¨è¾“å…¥http://localhost:9200/ å³å¯è¿›å…¥æœ¬åœ°ES\nå®‰è£…Kibana\n1  brew install kibana   å¯åŠ¨kibana\n1  kibana   æ·»åŠ æµ‹è¯•æ•°æ®è¿›è¡Œå®è·µï¼š\né—®é¢˜  ElasticSearch termæŸ¥è¯¢æœç´¢ä¸åˆ°æŒ‡å®šçš„æ•°æ® https://blog.csdn.net/qq_26531719/article/details/107029198  matchè¡¨ç¤ºå…¨æ–‡æœç´¢ï¼Œé€šå¸¸ç”¨äºå¯¹textç±»å‹å­—æ®µçš„æŸ¥è¯¢,ä¼šå¯¹è¿›è¡ŒæŸ¥è¯¢çš„æ–‡æœ¬å…ˆè¿›è¡Œåˆ†è¯æ“ä½œ termè¡¨ç¤ºç²¾ç¡®æœç´¢ï¼Œé€šå¸¸ç”¨äºå¯¹keywordå’Œæœ‰ç²¾ç¡®å€¼çš„å­—æ®µè¿›è¡ŒæŸ¥è¯¢,ä¸ä¼šå¯¹è¿›è¡ŒæŸ¥è¯¢çš„æ–‡æœ¬è¿›è¡Œåˆ†è¯æ“ä½œ     Referenceï¼š\n ES5.6å®˜æ–¹æ–‡æ¡£-æ”¯æŒå¤šä¸ªç´¢å¼•å‚æ•° ES5.6å®˜æ–¹æ–‡æ¡£å…¬å…±å‚æ•°è®¾ç½® RestHighLevelClient-JavaDoc ES5.6-æ–‡æ¡£è¯»å†™åŸç† ElasticSearchæ ¹æ®åŒ¹é…æŸä¸ªæ¡ä»¶ï¼Œå±€éƒ¨æ›´æ–°æ–‡æ¡£_wessiyearçš„åšå®¢-CSDNåšå®¢_elasticsearchæ ¹æ®æ¡ä»¶æ›´æ–° Elasticsearchæ•™ç¨‹(29) update by queryçš„Scriptè„šæ­¥æ›´æ–° Java API æ”¯æŒes5.6 es6.8 es7.8_å†ä¹Ÿä¸ä¼šç©äºšç‘Ÿï¼Œå†ä¹Ÿä¸ä¼šèµ°åœ¨é‚£å¯¹æŠ—è·¯ä¸Š-CSDNåšå®¢ ã€ESã€‘ã€Java High Level REST Clientã€‘å®˜æ–¹ç´¢å¼•å’Œæ–‡æ¡£æ“ä½œæŒ‡å¯¼ - é£åŠ¨é™æ³‰ - åšå®¢å›­ å…³äº ElasticSearchçš„Update By Query - akamiiyaçš„ç¨‹åºå‘˜ä¹‹è·¯ Elasticsearchå»é‡æŸ¥è¯¢_jacklifeçš„åšå®¢-CSDNåšå®¢_eså»é‡æŸ¥è¯¢ ES 15 - Elasticsearchçš„æ•°æ®ç±»å‹ (textã€keywordã€dateã€objectã€geoç­‰) - ç˜¦é£ - åšå®¢å›­  ","description":"ä½¿ç”¨ESçš„API","id":6,"section":"posts","tags":["ES"],"title":"ES APIå‚è€ƒ","uri":"https://hugo.jiahongw.com/zh/posts/es/es-api/"},{"content":"ESé›†ç¾¤æ•…éšœï¼šè­¦æƒ•é€šé…ç¬¦æŸ¥è¯¢\nhttps://elasticsearch.cn/article/171\nESæŸ¥è¯¢ç´¢å¼•æœªæ‰¾åˆ°è§£å†³åŠæ³•ï¼š\nhttps://www.codeleading.com/article/59664719033/\nhttps://www.cnblogs.com/lmsthoughts/articles/7609802.html\nAPI:https://www.tabnine.com/code/java/methods/org.elasticsearch.search.builder.SearchSourceBuilder/sort\nES mapping æ’åºæœªåˆå§‹åŒ–é—®é¢˜\nhttps://blog.csdn.net/xaio7biancheng/article/details/82657175\n1 2  FieldSortBuilder timeSort = SortBuilders.fieldSort(tuple.getField()).order(SortOrder.ASC).unmappedType(\u0026#34;long\u0026#34;); searchSourceBuilder.sort(tuple.getField(), SortOrder.ASC).sort(timeSort);   ESçš„ID æ–‡æ¡£å”¯ä¸€æ ‡è¯†ç”±å››ä¸ªå…ƒæ•°æ®å­—æ®µç»„æˆï¼š\n_idï¼šæ–‡æ¡£çš„å­—ç¬¦ä¸² ID\n_typeï¼šæ–‡æ¡£çš„ç±»å‹å\n_indexï¼šæ–‡æ¡£æ‰€åœ¨çš„ç´¢å¼•\n_uidï¼š_type å’Œ _id è¿æ¥æˆçš„ type#id\né»˜è®¤æƒ…å†µä¸‹ï¼Œ_uid æ˜¯è¢«ä¿å­˜ï¼ˆå¯å–å›ï¼‰å’Œç´¢å¼•ï¼ˆå¯æœç´¢ï¼‰çš„ã€‚_type å­—æ®µè¢«ç´¢å¼•ä½†æ˜¯æ²¡æœ‰ä¿å­˜ï¼Œ_idå’Œ _index å­—æ®µåˆ™æ—¢æ²¡æœ‰ç´¢å¼•ä¹Ÿæ²¡æœ‰å‚¨å­˜ï¼Œå®ƒä»¬å¹¶ä¸æ˜¯çœŸå®å­˜åœ¨çš„ã€‚Elasticsearch ä½¿ç”¨ _uid å­—æ®µæ¥è¿½æº¯ _idã€‚\n æ¯ä¸ªè¢«ç´¢å¼•çš„æ–‡æ¡£éƒ½ä¸ä¸€ä¸ª_typeï¼ˆè§æ˜ å°„ç±»å‹ï¼‰å’Œä¸€ä¸ª_idç›¸å…³ã€‚_idå­—æ®µæ²¡æœ‰è¢«ç´¢å¼•ï¼Œå› ä¸ºå®ƒçš„å€¼å¯ä»¥ä»_uidå­—æ®µä¸­è‡ªåŠ¨å¾—å‡ºã€‚ç»“æ„æ˜¯â€œ_type#_idâ€\n 1 2 3 4 5 6 7 8 9 10 11 12 13  GET test_log/course/_search { \u0026#34;query\u0026#34;: { \u0026#34;match_all\u0026#34;: {} }, \u0026#34;sort\u0026#34;: [ { \u0026#34;_uid\u0026#34;: { \u0026#34;order\u0026#34;: \u0026#34;asc\u0026#34; } } ] }   _idå­—æ®µçš„å€¼åœ¨æŸäº›æŸ¥è¯¢ä¸­å¯ä»¥è®¿é—®ï¼ˆterm, terms, match, query_string, simple_query_stringï¼‰ï¼Œä½†åœ¨èšåˆã€è„šæœ¬æˆ–æ’åºæ—¶ä¸èƒ½è®¿é—®ï¼Œè¿™æ—¶åº”è¯¥ä½¿ç”¨_uidå­—æ®µæ¥ä»£æ›¿ã€‚\nä½¿ç”¨ESè‡ªåŠ¨ç”ŸæˆIDï¼Œä¹Ÿä¼šæœ‰ä¸€äº›ç¼ºé™·\n æ–‡æ¡£IDæ— æ„ä¹‰ï¼Œä¸”è‡ªåŠ¨ç”Ÿæˆçš„IDæ›´å®¹æ˜“æ··æ·† å¿…é¡»å…ˆæ‰§è¡Œå†™å…¥æ“ä½œï¼Œå†™å…¥æˆåŠŸåæ‰èƒ½æ‹¿åˆ°ID   TBçº§åˆ«Elasticsearchçš„å­˜å‚¨ä¼˜åŒ–ç»éªŒï¼ˆäºŒï¼‰å¦‚ä½•é€‰æ‹©ID | Welcome to SPHIA _id field | Elasticsearch Reference [5.6] | Elastic è¯·é—®es æœ‰æŒ‰ _id æ’åºè¿™ä¸ªè¯´æ³•ä¹ˆ - Elastic ä¸­æ–‡ç¤¾åŒº Mysqlï¼Œelasticsearch ç­‰ æŒ‰æ—¶é—´æ’åºä¸­çš„å‘ - æ˜Ÿé€æµçš„ä¸ªäººé¡µé¢ - OSCHINA - ä¸­æ–‡å¼€æºæŠ€æœ¯äº¤æµç¤¾åŒº ESç³»åˆ—-Mapping-Meta_Fields-_idä¸_uidå­—æ®µï¼ˆç´¢å¼•ã€æ˜ å°„ã€å­—æ®µï¼‰_Vancl_Wang Blog-ç¨‹åºå‘˜å®…åŸºåœ° - ç¨‹åºå‘˜å®…åŸºåœ° (5æ¡æ¶ˆæ¯) Elasticsearchèšåˆå­¦ä¹ ä¹‹äº”ï¼šæ’åºç»“æœä¸å‡†çš„é—®é¢˜åˆ†æ_ç¨‹åºå‘˜æ¬£å®¸çš„åšå®¢-CSDNåšå®¢  ","description":"ESç›¸å…³é—®é¢˜æ•…éšœå’Œè§£å†³","id":7,"section":"posts","tags":["ES"],"title":"ESç›¸å…³é—®é¢˜","uri":"https://hugo.jiahongw.com/zh/posts/es/es-problems/"},{"content":"å®šä¹‰ ä»£ç†æ¨¡å¼ä¸ºå¦ä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªæ›¿èº«æˆ–è€…å ä½ç¬¦ä»¥æ§åˆ¶è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚\næ¡†æ¶ @startuml ' ä»£ç†æ¨¡å¼ interface Subject { request() } class RealSubject implements Subject { + request() } class Proxy implements Subject { + request() } Proxy -\u0026gt; RealSubject : subject @enduml ä½¿ç”¨åœºæ™¯ ä»£ç†çš„å‡ ç§æ¨¡å¼ï¼š\n è¿œç¨‹ä»£ç†ï¼šè¿œç¨‹ä»£ç†å¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªJVMä¸Šå¯¹è±¡çš„æœ¬åœ°ä»£è¡¨ã€‚å¸¸è§çš„æ˜¯RPCæ¡†æ¶ã€‚ è™šæ‹Ÿä»£ç†ï¼šè™šæ‹Ÿä»£ç†ä½œä¸ºåˆ›å»ºå¼€é”€å¤§çš„å¯¹è±¡çš„ä»£è¡¨ã€‚å½“å¯¹è±¡æ²¡æœ‰å¾—åˆ°çš„æƒ…å†µä¸‹æ‰§è¡Œä¸€äº›æ“ä½œã€‚å¸¸è§çš„æ˜¯å›¾ç‰‡çš„åŠ è½½ã€‚ ç¼“å­˜ä»£ç†ï¼šç¼“å­˜ä»£ç†ä¼šç»´æŠ¤ä¹‹å‰çš„å¯¹è±¡ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä¼šè¿”å›ç¼“å­˜å¯¹è±¡ã€‚ ä¿æŠ¤ä»£ç†ï¼šå¯ä»¥æ ¹æ®å®¢æˆ·çš„è§’è‰²æ¥å†³å®šæ˜¯å¦å…è®¸å®¢æˆ·è®¿é—®ç‰¹å®šçš„æ–¹æ³•ã€‚ï¼ˆJavaåŠ¨æ€ä»£ç†ï¼‰  å…¶ä»–ä»£ç†ï¼š\n é˜²ç«å¢™ä»£ç†ï¼šæ§åˆ¶ç½‘ç»œèµ„æºçš„è®¿é—®ï¼Œä¿æŠ¤è®¿é—®åç½‘ç»œã€‚ æ™ºèƒ½å¼•ç”¨ä»£ç†ï¼šä¾‹å¦‚è®¡ç®—ä¸€ä¸ªå¯¹è±¡è¢«å¼•ç”¨çš„æ¬¡æ•°ã€‚ åŒæ­¥ä»£ç†ï¼šåœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ä¸ºä¸»é¢˜æä¾›å®‰å…¨çš„è®¿é—®ã€‚ å†™å…¥æ—¶å¤åˆ¶ä»£ç†ï¼šç”¨äºæ§åˆ¶å¯¹è±¡çš„å¤åˆ¶ï¼Œæ–¹æ³•æ˜¯å»¶è¿Ÿå¯¹è±¡çš„å¤åˆ¶ï¼Œå‘é‚£ä¸ªå®¢æˆ·çœŸçš„éœ€è¦ï¼ˆä¹Ÿå°±æ˜¯éœ€è¦å†™å…¥æ—¶ï¼‰æ‰è¿›è¡Œå¤åˆ¶ã€‚æ˜¯è™šæ‹Ÿä»£ç†çš„å˜ä½“ã€‚ï¼ˆJava5çš„CopyOnWriteArrayListï¼‰  åŒºåˆ«  è£…é¥°å™¨æ¨¡å¼æ˜¯ä¸ºå¯¹è±¡å¢åŠ è¡Œä¸ºï¼Œè€Œä»£ç†æ¨¡å¼æ˜¯æ§åˆ¶å¯¹è±¡çš„è®¿é—®ã€‚ é€‚é…å™¨ä¼šæ”¹å˜å¯¹è±¡é€‚é…çš„æ¥å£ï¼Œè€Œä»£ç†åˆ™å®ç°ç›¸åŒçš„æ¥å£ã€‚  Reference:\n","description":"ä»£ç†æ¨¡å¼ä¸ºå¦ä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªæ›¿èº«æˆ–è€…å ä½ç¬¦ä»¥æ§åˆ¶è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚","id":8,"section":"posts","tags":["è®¾è®¡æ¨¡å¼","ä»£ç†æ¨¡å¼"],"title":"ä»£ç†æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/proxypattern/"},{"content":" ç»„åˆæ¨¡å¼è·Ÿæˆ‘ä»¬ä¹‹å‰è®²çš„é¢å‘å¯¹è±¡è®¾è®¡ä¸­çš„â€œç»„åˆå…³ç³»(é€šè¿‡ç»„åˆæ¥ç»„è£…ä¸¤ä¸ªç±»)â€ï¼Œå®Œå…¨æ˜¯ä¸¤ç äº‹ã€‚è¿™é‡Œè®²çš„â€œç»„åˆæ¨¡å¼â€ï¼Œä¸»è¦æ˜¯ç”¨æ¥å¤„ç†æ ‘å½¢ç»“æ„æ•°æ®ã€‚\nå®šä¹‰ ç»„åˆæ¨¡å¼å…è®¸ä½ å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„æ¥è¡¨ç¤ºâ€œæ•´ä½“/éƒ¨åˆ†â€çš„å±‚æ¬¡ç»“æ„ã€‚ç»„åˆèƒ½å¤Ÿè®©å®¢æˆ·ä»¥ä¸€è‡´çš„æ–¹å¼å¤„ç†ä¸ªåˆ«å¯¹è±¡ä»¥åŠå¯¹è±¡ç»„åˆã€‚\næ¶æ„ @startuml 'https://plantuml.com/class-diagram class Client class Component { + operation() + add(Component) + remove(Component) + getChild(int) } class Leaf extends Component { + operation() } note bottom of Leaf : å¶å­èŠ‚ç‚¹æ²¡æœ‰å­©å­ class Composite extends Component { + operation() + add(Component) + remove(Component) + getChild(int) } note bottom of Composite : ç»„åˆèŠ‚ç‚¹å…·æœ‰å¶å­èŠ‚ç‚¹ï¼Œä¹Ÿä¾èµ–Componentæ¥å£ Client -\u0026gt; Component @enduml ä½¿ç”¨åœºæ™¯ ä½¿ç”¨ç»„åˆæ¨¡å¼çš„å‰æåœ¨äºï¼Œä½ çš„ä¸šåŠ¡åœºæ™¯å¿…é¡»èƒ½å¤Ÿè¡¨ç¤ºæˆæ ‘å½¢ç»“æ„ã€‚æ‰€ä»¥ï¼Œç»„åˆæ¨¡å¼çš„åº”ç”¨åœºæ™¯ä¹Ÿæ¯”è¾ƒå±€é™ï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€ç§å¾ˆå¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ã€‚\n ç†è§£â€œæ•´ä½“å’Œéƒ¨åˆ†â€çš„å…³ç³»ã€‚\n Reference:\n","description":"","id":9,"section":"posts","tags":[""],"title":"ç»„åˆæ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/compositepattern/"},{"content":" è¿­ä»£å™¨æ¨¡å¼ä¹Ÿå«æ¸¸æ ‡æ¨¡å¼ã€‚\n  å®šä¹‰ è¿­ä»£å™¨æ¨¡å¼æä¾›äº†ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œä¸æš´éœ²å…¶å†…éƒ¨çš„è¡¨ç¤ºã€‚\n è¿­ä»£å™¨æ¨¡å¼å°è£…äº†éå†ã€‚å¹¶ä¸”è¿­ä»£å™¨æ¨¡å¼è¿˜å°†åœ¨å…ƒç´ ä¹‹é—´è¿›è¡Œæ¸¸èµ°çš„è´£ä»»äº¤ç»™è¿­ä»£å™¨ï¼Œä½¿å¾—èŒè´£æ›´åŠ å•ä¸€ã€‚\n æ¶æ„ @startuml class Client interface Collection { + createIterator() } class ConcreteCollection implements Collection { + createIterator() } interface Iterator { + hasNext() + next() + remove() } class ConcreteIterator implements Iterator{ + hasNext() + next() + remove() } Client -left-\u0026gt; Collection Client -right-\u0026gt; Iterator ConcreteCollection -right-\u0026gt; ConcreteIterator @enduml ä½¿ç”¨åœºæ™¯  Java Iterator è§£è€¦å®¹å™¨ä»£ç å’Œéå†ä»£ç ï¼Œä½¿å¾—èŒè´£æ›´åŠ å•ä¸€  é—®é¢˜   Javaä¸­å¦‚æœä½¿ç”¨è¿­ä»£å™¨çš„åŒæ—¶åˆ é™¤å®¹å™¨ä¸­çš„å…ƒç´ ï¼Œä¼šå¯¼è‡´è¿­ä»£å™¨çš„é”™è¯¯ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³å‘¢ï¼Ÿ\nä¸åªæ˜¯åˆ é™¤å®¹å™¨ï¼Œå¢åŠ å…ƒç´ ä¹Ÿå¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚\nåœ¨ä½¿ç”¨è¿­ä»£å™¨éå†åˆ°åé¢çš„å…ƒç´ æ—¶ï¼Œåˆ é™¤äº†å‰é¢çš„å…ƒç´ ï¼Œä¼šå¯¼è‡´éå†å…ƒç´ å°‘äº†ä¸€ä¸ªã€‚(2è¢«è·³è¿‡äº†)\nåœ¨ä½¿ç”¨è¿­ä»£å™¨éå†åˆ°åé¢çš„å…ƒç´ æ—¶ï¼Œåœ¨å‰é¢å¢åŠ äº†å…ƒç´ ï¼Œä¼šå¯¼è‡´å‰é¢éå†çš„ä¸€ä¸ªå…ƒç´ åˆéå†äº†ä¸€æ¬¡ã€‚ï¼ˆ1é‡å¤éå†äº†ï¼‰\nå¦‚ä½•è§£å†³ï¼Ÿ\nJavaè¯­è¨€ä¸­çš„è§£å†³æ–¹æ³•æ˜¯å¢åˆ å…ƒç´ ä¹‹åï¼Œè®©éå†æŠ¥é”™ã€‚\n åœ¨ ArrayList ä¸­å®šä¹‰ä¸€ä¸ªæˆå‘˜å˜é‡ modCountï¼Œè®°å½•é›†åˆè¢«ä¿®æ”¹çš„æ¬¡æ•°ï¼Œé›†åˆæ¯è°ƒç”¨ä¸€æ¬¡å¢åŠ æˆ–åˆ é™¤å…ƒç´ çš„å‡½æ•°ï¼Œå°±ä¼šç»™ modCount åŠ  1ã€‚å½“é€šè¿‡è°ƒç”¨é›†åˆä¸Šçš„ iterator() å‡½æ•°æ¥åˆ›å»ºè¿­ä»£å™¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠ modCount å€¼ä¼ é€’ç»™è¿­ä»£å™¨çš„ expectedModCount æˆå‘˜å˜é‡ï¼Œä¹‹åæ¯æ¬¡è°ƒç”¨è¿­ä»£å™¨ä¸Šçš„ hasNext()ã€next()ã€currentItem() å‡½æ•°ï¼Œæˆ‘ä»¬éƒ½ä¼šæ£€æŸ¥é›†åˆä¸Šçš„ modCount æ˜¯å¦ç­‰äº expectedModCountï¼Œä¹Ÿå°±æ˜¯çœ‹ï¼Œåœ¨åˆ›å»ºå®Œè¿­ä»£å™¨ä¹‹åï¼ŒmodCount æ˜¯å¦æ”¹å˜è¿‡ã€‚\n å¦‚æœä¸¤ä¸ªå€¼ä¸ç›¸åŒï¼Œé‚£å°±è¯´æ˜é›†åˆå­˜å‚¨çš„å…ƒç´ å·²ç»æ”¹å˜äº†ï¼Œè¦ä¹ˆå¢åŠ äº†å…ƒç´ ï¼Œè¦ä¹ˆåˆ é™¤äº†å…ƒ ç´ ï¼Œä¹‹å‰åˆ›å»ºçš„è¿­ä»£å™¨å·²ç»ä¸èƒ½æ­£ç¡®è¿è¡Œäº†ï¼Œç›´æ¥æŠ›å‡ºé”™è¯¯è®©ç¨‹åºå‘˜è§£å†³ã€‚\nè¿­ä»£å™¨å†…éƒ¨ä¹Ÿå®ç°äº†ä¸€ä¸ªremove() æ–¹æ³•ï¼Œèƒ½å¤Ÿåœ¨éå†é›†åˆçš„åŒæ—¶ï¼Œå®‰å…¨åœ°åˆ é™¤é›†åˆä¸­çš„å…ƒç´ ã€‚å®ƒä½œç”¨æœ‰é™ï¼Œåªèƒ½åˆ é™¤æ¸¸æ ‡æŒ‡å‘çš„å‰ä¸€ä¸ªå…ƒç´ ï¼Œè€Œä¸”ä¸€ä¸ª next() å‡½æ•°ä¹‹åï¼Œåªèƒ½è·Ÿç€æœ€å¤šä¸€ä¸ª remove() æ“ ä½œï¼Œå¤šæ¬¡è°ƒç”¨ remove() æ“ä½œä¼šæŠ¥é”™ã€‚\n  åŒºåˆ«å’Œå…³ç³»  ä½ å¯ä»¥ä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼æ¥éå†ç»„åˆæ¨¡å¼æ ‘ã€‚  Reference:\n","description":"è¿­ä»£å™¨æ¨¡å¼æä¾›äº†ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œä¸æš´éœ²å…¶å†…éƒ¨çš„è¡¨ç¤ºã€‚","id":10,"section":"posts","tags":["è®¾è®¡æ¨¡å¼","è¿­ä»£å™¨æ¨¡å¼"],"title":"è¿­ä»£å™¨æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/iteratorpattern/"},{"content":" å®šä¹‰ æ¨¡æ¿æ–¹æ³•æ¨¡å¼åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å®šä¹‰ä¸€ä¸ªç®—æ³•çš„æ¶æ„ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚æ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥åœ¨ä¸æ”¹å˜ç®—æ³•ç»“æ„çš„æƒ…å†µä¸‹ï¼Œé‡æ–°å®šä¹‰ç®—æ³•ä¸­çš„æŸäº›æ­¥éª¤ã€‚\n æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä½“ç°äº†å¥½è±ååŸåˆ™ï¼šåˆ«è°ƒç”¨æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ä½ ã€‚ç®€å•çš„è¯´ï¼Œæ¨¡æ¿æ–¹æ³•çš„æŠ½è±¡ç±»ä¼šå‘Šè¯‰å­ç±»ï¼Œä½ ä¸è¦è°ƒç”¨æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ä½ ã€‚\n ä½¿ç”¨åœºæ™¯ æ¨¡æ¿æ–¹æ³•æ¨¡å¼è¿˜å¯ä»¥åœ¨æŠ½è±¡ç±»ä¸­å®šä¹‰ä¸€ä¸ªä»€ä¹ˆéƒ½ä¸åšçš„å‡½æ•°æ­¥éª¤ï¼Œå­ç±»æ ¹æ®æƒ…å†µè€ƒè™‘æ˜¯å¦å®ç°è¿™ä¸ªæ¥å£ï¼Œè€Œè¿™ä¸ªæ¥å£å°±æ˜¯ä¸€ä¸ªé’©å­ï¼Œå¯ä»¥åœ¨æ¨¡æ¿æ­¥éª¤çš„æŒ‡å®šä½ç½®åšä¸€äº›äº‹ã€‚\nJavaä¸­çš„æ’åºç®—æ³•ä¹Ÿæ˜¯ä¸€ç§æ¨¡æ¿æ–¹æ³•ï¼Œæ’åºçš„åˆ—è¡¨å…ƒç´ ç±»å‹éœ€è¦å®ç°compareToæ–¹æ³•ï¼Œè¿™å°±ç±»ä¼¼æ¨¡æ¿æ–¹æ³•é‡Œé¢çš„ä¸€ä¸ªæ­¥éª¤ã€‚å®ç°äº†ä¹‹åï¼Œæ‰èƒ½å®Œæˆæ’åºçš„è¿‡ç¨‹ã€‚\n1 å¤ç”¨\nå› ä¸ºæ¨¡æ¿æ–¹æ³•æ˜¯åŸºäºç»§æ‰¿å®ç°ï¼Œå¯ä»¥å°†å›ºå®šçš„ç®—æ³•æ­¥éª¤å°è£…åœ¨æŠ½è±¡ç±»ï¼ŒæŠ½è±¡ç±»å¯ä»¥å®ç°ä¸€äº›å›ºå®šçš„æ­¥éª¤ï¼Œå­ç±»ç›´æ¥è¿›è¡Œå¤ç”¨å°±å¯ä»¥äº†ã€‚\nä¾‹å­ï¼šJavaä¸­çš„InputStreamçš„read()å‡½æ•°(å­ç±»å®ç°å‚æ•°ä¸åŒçš„readå‡½æ•°)å’ŒAbstractListçš„addAll()å‡½æ•°(å­ç±»å®ç°addå‡½æ•°)ã€‚\n2 æ¡†æ¶æ‹“å±•æ€§\n HttpServletçš„service()æ–¹æ³•å°±æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ï¼Œå®ƒå®ç°äº†æ•´ä¸ªhttpè¯·æ±‚çš„æ‰§è¡Œæµç¨‹ï¼Œè€ŒdoGet()å’ŒdoPost()æ˜¯æ¨¡æ¿ä¸­å¯ä»¥ç”±å­ç±»è‡ªå®šä¹‰çš„éƒ¨åˆ†ã€‚ç›¸å½“äºæ¡†æ¶ä¸ºç”¨æˆ·æä¾›äº†æ‹“å±•ç‚¹ï¼Œä½¿å¾—ä¸éœ€è¦ä¿®æ”¹æ¡†æ¶æºç å°±èƒ½å°†æ‹“å±•ç‚¹æ·»åŠ åˆ°æ¡†æ¶ä¸­ã€‚ Junitæ¡†æ¶ä¹Ÿæä¾›äº†ä¸€äº›åŠŸèƒ½æ‹“å±•ç‚¹setUp()å’ŒsetDown()ï¼Œå¯ä»¥åœ¨å¼€å§‹å’Œç»“æŸçš„æ—¶å€™åšä¸€äº›äº‹æƒ…ï¼Œè€ŒrunBase()å‡½æ•°æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ï¼Œå®šä¹‰äº†æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹çš„æ•´ä½“æµç¨‹ã€‚  æ¶æ„ @startuml 'https://plantuml.com/class-diagram abstract class AbstractClass { + templateMethod() + stepOperation1() + {abstract} stepOperation2() + stepOperation3() } note right of AbstractClass::templateMethod æ¨¡æ¿æ–¹æ³•å®šä¹‰ç®—æ³•æ­¥éª¤ï¼š stepOperation1(); stepOperation2(); stepOperation3(); end note class ConcreteClassB extends AbstractClass { + stepOperation2() } class ConcreteClassA extends AbstractClass { + stepOperation2() } note right of ConcreteClassB::stepOperation2 å­ç±»å®ç°ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…·ä½“çš„æ­¥éª¤ end note @enduml æ¨¡æ¿æ–¹æ³•å¯ä»¥é…åˆèŒƒå‹è¿›è¡Œä½¿ç”¨ï¼š\n1 2 3 4 5 6 7 8 9  public class AbstractService\u0026lt;T, L\u0026gt; { protected abstract T getData(int x); public void calAndSaveTransaction(T t,L l); } public ConcreteService implements AbstractService\u0026lt;String, Integer\u0026gt; { ... }   åŒºåˆ«  ç­–ç•¥æ¨¡å¼å’Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼éƒ½å°è£…ç®—æ³•ï¼Œä½†æ˜¯ä¸€ä¸ªç»„åˆï¼Œä¸€ä¸ªç»§æ‰¿ã€‚ å·¥å‚æ–¹æ³•æ˜¯æ¨¡æ¿æ–¹æ³•çš„ä¸€ä¸ªç‰¹æ®Šç‰ˆæœ¬ã€‚  Reference:\n","description":"æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯å¯¹æŠ½è±¡çš„æœ‰ä¸€ç§ä½“ç°ï¼Œè¿™æ¬¡ï¼ŒæŠ½è±¡çš„æ˜¯ç®—æ³•æµç¨‹ã€‚æ¨¡æ¿æ–¹æ³•å®šä¹‰äº†ä¸€ä¸ªç®—æ³•çš„æ­¥éª¤ï¼Œå°†å…è®¸å­ç±»ä¸ºä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­¥éª¤æä¾›å®ç°ã€‚","id":11,"section":"posts","tags":["è®¾è®¡æ¨¡å¼","æ¨¡æ¿æ–¹æ³•æ¨¡å¼"],"title":"æ¨¡æ¿æ–¹æ³•æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/templatemethodpattern/"},{"content":"å®šä¹‰ å¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æ¥å£ã€‚å¤–è§‚å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè®©å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚\n å¤–è§‚æ¨¡å¼å¯ä»¥è§£å†³æ¥å£çš„å¤ç”¨æ€§å’Œæ˜“ç”¨æ€§çš„é—®é¢˜ï¼Œå¹¶ä¸”ï¼Œå¤–è§‚æ¨¡å¼å¯ä»¥è®©å±‚çº§æ›´åŠ æ¸…æ™°ï¼Œæ»¡è¶³æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼Œè®©æš´éœ²çš„æ¥å£æˆ–è€…å‡½æ•°æ›´åŠ å°‘ã€‚\n ä½¿ç”¨åœºæ™¯ 1 è§£å†³æ˜“ç”¨æ€§\nå½“æ¥å£è¶Šæ¥è¶Šå¤šï¼Œè¶Šæ¥è¶Šå¤æ‚çš„æ—¶å€™ï¼Œæä¾›ä¸€å±‚æ›´åŠ ç®€å•æ˜“ç”¨ï¼Œæ›´åŠ é«˜å±‚çš„æ¥å£ã€‚ä¾‹å­ï¼šLinuxç³»ç»Ÿè°ƒç”¨å‡½æ•°å°è£…äº†Linuxå†…æ ¸è°ƒç”¨ã€Linuxçš„Shellå‘½ä»¤å°è£…äº†å¤æ‚çš„ç³»ç»Ÿè°ƒç”¨ã€‚\n å•ç‹¬èµ·èµ·ä¸€ä¸ªAPIç½‘å…³å±‚æœåŠ¡åšè½¬å‘å’Œèšåˆä¹Ÿå¾ˆç±»ä¼¼é—¨é¢è®¾è®¡æ¨¡å¼ã€‚\n 2 è§£å†³æ€§èƒ½é—®é¢˜\nå°†å¤šä¸ªæ¥å£è°ƒç”¨å°è£…æˆä¸€ä¸ªç®€å•çš„é—¨é¢æ¥å£ï¼Œåœ¨ä¸€äº›éœ€è¦å¤šæ¬¡è¯·æ±‚çš„ç½‘ç»œé€šä¿¡ä¸­å¯ä»¥å‡å°‘é€šä¿¡çš„æ¬¡æ•°ï¼Œé™ä½ç½‘ç»œé€šä¿¡çš„æˆæœ¬ï¼Œæé«˜APPå“åº”çš„é€Ÿåº¦ã€‚\n ç»éªŒï¼š\nå¦‚æœé—¨é¢æ¥å£ä¸å¤šï¼Œæ­¤æ—¶å¯ä»¥å°†é—¨é¢æ¥å£å’ŒåŸæ¥çš„æ¥å£æ”¾åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œä¸éœ€è¦ç‰¹æ®Šçš„æ ‡è®°ï¼›å¦‚æœé—¨é¢æ¥å£å¾ˆå¤šï¼Œå¯ä»¥åœ¨å·²æœ‰çš„æ¥å£ä¹‹ä¸Šï¼Œå†é‡æ–°æŠ½è±¡å‡ºä¸€å±‚ï¼Œè½¬é—¨æ”¾ç½®é—¨é¢æ¥å£ï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªç±»æˆ–è€…åŒ…ï¼›å¦‚æœé—¨é¢æ¥å£ç‰¹åˆ«å¤šäº†ï¼Œå¹¶ä¸”å¾ˆå¤šéƒ½æ˜¯è·¨å¤šä¸ªå­ç³»ç»Ÿçš„ï¼Œå¯ä»¥å°†é—¨é¢ç³»ç»Ÿæ¥å£æ”¾åˆ°ä¸€ä¸ªæ–°çš„å­ç³»ç»Ÿä¸­ã€‚\n 3 è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜\né—¨é¢æ¥å£å¯ä»¥å°†ä¸€ä¸ªäº‹åŠ¡çš„å¤šä¸ªæ¥å£å°è£…åœ¨ä¸€ä¸ªæ¥å£ä¸­ï¼Œæ–¹é¢è¿›è¡Œäº‹åŠ¡çš„å›æ»šæˆ–è€…é‡è¯•ã€‚\næ¶æ„ @startuml 'https://plantuml.com/class-diagram class Client class Facade Client -\u0026gt; Facade package \u0026quot;å­ç³»ç»Ÿ\u0026quot; \u0026lt;\u0026lt;cloud\u0026gt;\u0026gt; #DDDDDD{ class A class B class C class D class E } Facade -- A Facade -- C A - C A -- B A -- E C - E B - D @enduml æ¯”è¾ƒ  é€‚é…å™¨æ˜¯åšæ¥å£è½¬æ¢ï¼Œè§£å†³çš„æ˜¯åŸæ¥å£å’Œç›®æ ‡æ¥å£ä¸åŒ¹é…çš„é—®é¢˜ã€‚é—¨é¢æ¨¡å¼åšæ¥å£æ•´åˆï¼Œè§£å†³çš„æ˜¯å¤šæ¥å£è°ƒç”¨å¸¦æ¥çš„é—®é¢˜ã€‚ é€‚é…å™¨æ¨¡å¼æ³¨é‡çš„æ˜¯å…¼å®¹æ€§ï¼Œè€Œé—¨é¢æ¨¡å¼æ³¨é‡çš„æ˜¯æ˜“ç”¨æ€§ã€‚  Reference:\n","description":"å¤–è§‚æ¨¡å¼ä¹Ÿå«åšé—¨é¢æ¨¡å¼ï¼Œå¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æ¥å£ã€‚å¤–è§‚å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè®©å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚","id":12,"section":"posts","tags":["è®¾è®¡æ¨¡å¼","å¤–è§‚æ¨¡å¼","é—¨é¢æ¨¡å¼"],"title":"å¤–è§‚æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/facadepattern/"},{"content":"å®šä¹‰ é€‚é…å™¨å°†ä¸€ä¸ªç±»çš„æ¥å£ï¼Œè½¬æ¢æˆå®¢æˆ·ç«¯æœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£ã€‚é€‚é…å™¨è®©åŸæœ¬ä¸å…¼å®¹çš„ç±»è¾¾åˆ°å…¼å®¹ã€‚\nï¼ˆå¯ä»¥è®©å®¢æˆ·ä»å®ç°çš„æ¥å£è§£è€¦ï¼‰\n é€‚é…å™¨æ¨¡å¼ä¸‹å¿…é¡»æœ‰ä¸€ä¸ªæ¥å£çš„â€è½¬æ¢â€œè¿‡ç¨‹ã€‚\n  å½¢è±¡çš„æ¯”å–»ï¼šUSBè½¬æ¥å¤´å°±æ˜¯ä¸€ä¸ªé€‚é…å™¨ï¼\n æ¶æ„ @startuml ' é€‚é…å™¨æ¨¡å¼ class client interface Targert { + request() } note top of Targert : ç›®æ ‡æ¥å£ class Adaptor implements Targert { + request() } note bottom of Adaptor : é€‚é…å™¨å®ç°ç›®æ ‡æ¥å£ class Adaptee { + specificRequest() } Adaptor -\u0026gt; Adaptee : å¹¶ä¸”åŒ…å«è¢«é€‚é…çš„æ¥å£å¯¹è±¡ client -\u0026gt; Targert @enduml  ä¸Šé¢çš„æ˜¯å¯¹è±¡é€‚é…å™¨çš„æ¶æ„ï¼Œåœ¨æ”¯æŒå¤šé‡ç»§æ‰¿çš„è¯­è¨€ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ç±»é€‚é…å™¨ï¼š\n@startuml ' é€‚é…å™¨æ¨¡å¼ class client interface Targert { + request() } note top of Targert : ç›®æ ‡æ¥å£ class Adaptor implements Targert,Adaptee { + request() } class Adaptee { + specificRequest() } client -\u0026gt; Targert @enduml  ä½¿ç”¨åœºæ™¯ ä¸€èˆ¬æ¥è¯´ï¼Œé€‚é…å™¨æ¨¡å¼å¯ä»¥çœ‹ä½œæ˜¯ä¸€å®—â€œè¡¥å¿æ¨¡å¼â€ï¼Œç”¨æ¥è¡¥æ•‘è®¾è®¡ä¸Šçš„ç¼ºé™·ï¼Œä¹Ÿæ˜¯ä¸€ç§æ— å¥ˆä¹‹ä¸¾ã€‚ä¸€èˆ¬ä¹Ÿä¸ä¼šä¼˜å…ˆæ¨èä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚\nä¸»è¦åœºæ™¯ 1 å°è£…æœ‰ç¼ºé™·çš„æ¥å£è®¾è®¡\nä¾‹å¦‚å¤–éƒ¨å¼•å…¥çš„æ¥å£éƒ½æ˜¯é™æ€æ–¹æ³•ï¼Œä¼šå½±å“ä»£ç çš„å¯æµ‹è¯•æ€§ã€‚æ­¤æ—¶ä½¿ç”¨é€‚é…å™¨è¿›è¡Œé€‚é…æ¥å£ï¼Œå°†é™æ€æ–¹æ³•éƒ½â€œå°è£…â€œèµ·æ¥ï¼Œè¿™æ ·å°±å¯ä»¥è¿›è¡Œæµ‹è¯•äº†ã€‚\n2 æ›¿æ¢ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿ\nå½“éœ€è¦å°†å¤–éƒ¨ä¾èµ–çš„ä¸€ä¸ªç³»ç»Ÿæ›¿æ¢æˆå¦ä¸€ä¸ªç³»ç»Ÿçš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ä¸€äº›ç³»ç»Ÿè¿ç§»æˆ–è€…æ¥å£åˆ‡æ¢çš„åœºæ™¯ï¼Œä½¿ç”¨é€‚é…å™¨æ¨¡å¼å¯ä»¥å‡å°‘å¯¹ä»£ç çš„æ”¹åŠ¨ã€‚\n@startuml ' é€‚é…å™¨æ¨¡å¼ interface IA { + fa() } note top of IA : ç³»ç»ŸA interface IB { + fb() } note top of IB : ç³»ç»ŸB class Client class BAdaptor implements IA { IB b + fa() } note left of BAdaptor : å®é™…faå‡½æ•°è°ƒç”¨fbå‡½æ•° BAdaptor -\u0026gt; IB Client -\u0026gt; IA @enduml 3 å…¼å®¹è€ç‰ˆæœ¬çš„æ¥å£\nåœ¨è¿›è¡Œä¸€äº›ç‰ˆæœ¬å‡çº§çš„æ—¶å€™ï¼Œå¯¹äºä¸€äº›åºŸå¼ƒçš„æ¥å£ï¼Œæˆ‘ä»¬ä¸ä¼šç›´æ¥åˆ é™¤ï¼Œè€Œæ˜¯æš‚æ—¶ä¿ç•™ï¼Œå¹¶ä¸”æ ‡æ³¨ä¸ºdeprecateï¼Œå¹¶ä¸”å°†å†…éƒ¨å®ç°é€»è¾‘å§”æ‰˜ä¸ºæ–°çš„å®ç°é€»è¾‘ã€‚\nä¾‹å¦‚JDKä¸­åŒ…å«ä¸€ä¸ªéå†é›†åˆå®¹å™¨çš„ç±»Enumerationï¼ŒJDK2.0å¯¹è¿™ä¸ªç±»è¿›è¡Œäº†é‡æ„ï¼Œå°†å®ƒæ”¹åä¸ºIteratorç±»ï¼Œå¹¶ä¸”å¯¹å®ƒçš„ä»£ç å®ç°åšäº†ä¼˜åŒ–ã€‚ä½†æ˜¯å¦‚æœå°†Enumerationç›´æ¥ä»JDK2.0åˆ é™¤ï¼Œé‚£ä¹ˆé‚£äº›ä»JDK1.0å‡çº§åˆ°JDK2.0çš„é¡¹ç›®ï¼Œå°±ä¼šç¼–è¯‘æŠ¥é”™ã€‚ä½†æ˜¯ä¿®æ”¹æ•£è½åœ¨å„å¤„çš„Enumerationè°ƒç”¨åˆå¤šåˆæ‚ï¼Œå¯¼è‡´å‡çº§å›°éš¾ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œå¯ä»¥æš‚æ—¶ä¿ç•™Enumerationç±»ï¼Œå¹¶ä¸”å°†å…¶å†…éƒ¨å®ç°æ›¿æ¢ä¸ºIteratorçš„å®ç°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  public class Collections { public static Emueration emumeration(final Collection c) { return new Enumeration() { Iterator i = c.iterator(); public boolean hasMoreElments() { return i.hashNext(); } public Object nextElement() { return i.next(): } } } }   é€‚é…å™¨æ¨¡å¼åœ¨Javaæ—¥å¿—ä¸­çš„åº”ç”¨ Slf4jè¿™ä¸ªæ—¥å¿—æ¡†æ¶ç›¸å½“äºJDBCè§„èŒƒï¼Œæä¾›äº†ä¸€å¥—æ‰“å°æ—¥å¿—çš„ç»Ÿä¸€æ¥å£è§„èŒƒã€‚ä½†æ˜¯ï¼Œå®ƒåªå®šä¹‰äº†æ¥å£ï¼Œæ²¡æœ‰å…·ä½“çš„å®ç°ï¼Œéœ€è¦é…åˆå…¶ä»–æ—¥å¿—æ¡†æ¶(log4jã€logbackã€JUL)æ¥ä½¿ç”¨ã€‚Slf4jçš„å‡ºç°ç¨æ™šäºè¿™äº›æ¡†æ¶ï¼Œä¸ºäº†é€‚é…åŸæ¥çš„æ—¥å¿—æ¡†æ¶ï¼ŒSlf4jæ¡†æ¶ä¸ä»…æä¾›å¯ç»Ÿä¸€çš„æ¥å£å®šä¹‰ï¼Œè¿˜æä¾›äº†é’ˆå¯¹ä¸åŒæ—¥å¿—æ¡†æ¶çš„é€‚é…å™¨ã€‚å¯¹ä¸åŒçš„æ—¥å¿—æ¡†æ¶æ¥å£è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œé€‚é…æˆç»Ÿä¸€çš„Slf4jæ¥å£å®šä¹‰ã€‚\næ¯”è¾ƒ è£…é¥°å™¨å’Œé€‚é…å™¨çš„åŒºåˆ«ï¼š\nè£…é¥°å™¨åŒ…è£…ä¸€ä¸ªå®ç°åŒä¸€ä¸ªæ¥å£çš„ç±»å¯¹è±¡ï¼Œæ·»åŠ ä¸€äº›è´£ä»»ï¼Œå¹¶ä¸”æ¥å£ä¸å˜ï¼›é€‚é…å™¨åˆ™åŒ…è£…å®ç°ä¸åŒæ¥å£çš„è¢«é€‚é…çš„å¯¹è±¡ï¼Œè¿›è¡Œæ¥å£çš„è½¬æ¢å’Œé€‚é…ï¼Œä»¥è¾¾åˆ°å…¼å®¹çš„æ•ˆæœã€‚\n å®ç°éƒ½å·®ä¸å¤šï¼Œä¸»è¦è¿˜æ˜¯è®¾è®¡çš„æ€æƒ³å¤§ä¸åŒã€‚\n Reference:\n ã€ŠHead First è®¾è®¡æ¨¡å¼ã€‹  ","description":"é€‚é…å™¨ä½¿å¾—æ–°çš„è°ƒç”¨å¯ä»¥é€‚é…è€çš„æ¥å£è€Œä¸éœ€è¦ä¿®æ”¹æ—§çš„ä»£ç ã€‚è¾¾åˆ°äº†å¯¹æ‹“å±•å¼€å‘ï¼Œå¯¹ä¿®æ”¹å…³é—­çš„è®¾è®¡åŸåˆ™ã€‚","id":13,"section":"posts","tags":["è®¾è®¡æ¨¡å¼","é€‚é…å™¨æ¨¡å¼"],"title":"é€‚é…å™¨æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/adaptorpattern/"},{"content":" å®šä¹‰ å‘½ä»¤æ¨¡å¼å°†â€œè¯·æ±‚â€å°è£…æˆå¯¹è±¡ï¼Œä»¥ä¾¿ä½¿ç”¨ä¸åŒçš„è¯·æ±‚ã€é˜Ÿåˆ—æˆ–è€…æ—¥å¿—æ¥å‚æ•°åŒ–å…¶ä»–å¯¹è±¡ã€‚å‘½ä»¤æ¨¡å¼ä¹Ÿå¯ä»¥æ”¯æŒæ’¤é”€çš„æ“ä½œã€‚\n å‘½ä»¤æ¨¡å¼ä¸»è¦æ˜¯å°†â€œå‘½ä»¤çš„è¯·æ±‚è€…â€ä»â€œå‘½ä»¤çš„æ‰§è¡Œè€…â€å¯¹è±¡ä¸­è§£è€¦ã€‚\n åº”ç”¨åœºæ™¯  å¼‚æ­¥ã€å»¶è¿Ÿã€æ’é˜Ÿæ‰§è¡Œå‘½ä»¤ã€æ’¤é”€é‡åšå‘½ä»¤ã€å­˜å‚¨å‘½ä»¤ã€å‘½ä»¤è®°å½•æ—¥å¿— Hystixç†”æ–­æ¡†æ¶å°±ç”¨åˆ°äº†å‘½ä»¤æ¨¡å¼ redisä½¿ç”¨å‘½ä»¤æ¨¡å¼å¤„ç†æŒ‡ä»¤  æ¶æ„ @startuml class client class Invoker { + setCommand() } interface Command { + execute() + undo() } class ConcreteCommand implements Command{ + execute() + undo() } class Receiver { + action() } Invoker -\u0026gt; Command Receiver \u0026lt;- ConcreteCommand client -\u0026gt; Receiver client -\u0026gt; ConcreteCommand @enduml å‘½ä»¤æ¨¡å¼å¯¹è±¡å¯ä»¥åŒ…å«æ¥å—è€…çš„å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥ä¸åŒ…å«ï¼Œå› ä¸ºåœ¨è¿œç¨‹è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½è·å–å¼•ç”¨ã€‚\nReference:\n","description":"å‘½ä»¤æ¨¡å¼å°†â€œè¯·æ±‚â€å°è£…æˆå¯¹è±¡ï¼Œä»¥ä¾¿ä½¿ç”¨ä¸åŒçš„è¯·æ±‚ã€é˜Ÿåˆ—æˆ–è€…æ—¥å¿—æ¥å‚æ•°åŒ–å…¶ä»–å¯¹è±¡ã€‚å‘½ä»¤æ¨¡å¼ä¹Ÿå¯ä»¥æ”¯æŒæ’¤é”€çš„æ“ä½œã€‚","id":14,"section":"posts","tags":["è®¾è®¡æ¨¡å¼","å‘½ä»¤æ¨¡å¼"],"title":"å‘½ä»¤æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/commandpattern/"},{"content":"ç±»å›¾ç»˜åˆ¶  å‚è€ƒï¼šã€ç¨‹åºå‘˜å°çŸ¥è¯†ã€‘ä½¿ç”¨ PlantUML ç”» UMLï¼ˆä¸Šï¼‰ç±»å›¾ - æ˜é‡‘\n ä¸€è§ˆï¼š\n éœ€è¦æ³¨æ„ï¼Œä¸€ç»„@startuml/@enduml å¯¹åº”ä¸€å¼  pngï¼Œå¦‚æœä¸€ä¸ªæ–‡ä»¶ä¸­æœ‰å¤šç»„ï¼Œåˆ™ç”Ÿæˆçš„ png æ–‡ä»¶åä¼šæ·»åŠ è‡ªå¢æ•°å­—åç¼€ã€‚ æ­¤å¤–ä¹Ÿå¯ä»¥ç´§è·Ÿåœ¨ @startuml ä¹‹åæŒ‡å®šæ–‡ä»¶åï¼š\n@startuml foo class Foo @enduml @startuml bar class Bar @enduml @startuml baz class Baz @enduml  æ³¨é‡Š ' è¿™æ˜¯æ³¨é‡Š å¯ä»¥ä½¿ç”¨ note left of , note right of , note top of , note bottom of ç­‰å…³é”®å­—å®šä¹‰ç›¸å¯¹äºå¯¹è±¡ä½ç½®çš„æ³¨é‡Šã€‚\næ ‡é¢˜ ' æ ‡é¢˜ä¸ºHello Title title Hello Title å›¾æ³¨ caption å›¾ï¼‘ è„šæ³¨ footer World æ”¾å¤§ç‡ @startuml scale-1.5 scale 1.5 Hello \u0026lt;|-- World @enduml å®šä¹‰å¸¸è§ç»“æ„ ' å®šä¹‰ç±»hello class Hello ' å®šä¹‰æ¥å£hello interface Hello ' å®šä¹‰æŠ½è±¡ç±»hello abstract Hello ' å®šä¹‰æšä¸¾ enum HelloWorld { ONE TWO THREE } @startuml ' å®šä¹‰ç±»hello class Hello ' å®šä¹‰æ¥å£hello interface Hello ' å®šä¹‰æŠ½è±¡ç±»hello abstract Hello ' å®šä¹‰æšä¸¾ enum HelloWorld { ONE TWO THREE } @enduml UMLä¸­ç±»å‹ä¹‹é—´æœ‰å…­å¤§å…³ç³»ï¼š\n æ³›åŒ–ï¼ˆGeneralizationï¼‰ å®ç°ï¼ˆRealizationï¼‰ å…³è”ï¼ˆAssociation) èšåˆï¼ˆAggregationï¼‰ ç»„åˆ(Composition) ä¾èµ–(Dependency)  æ³›åŒ–ï¼ˆç»§æ‰¿ï¼‰  \u0026lt;|-- --|\u0026gt; æŒ‡å®šç»§æ‰¿å…³ç³»\n @startuml Child --|\u0026gt; Parent Parent2 \u0026lt;|-- Child2 @enduml @startuml Child --|\u0026gt; Parent Parent2 \u0026lt;|-- Child2 @enduml ä½¿ç”¨extends å…³é”®å­—ä¹Ÿå¯ä»¥\nå®ç°  ..|\u0026gt;, \u0026lt;|.. ï¼Œ åœ†ç‚¹è¡¨ç¤ºè™šçº¿\n @startuml Plane ..|\u0026gt; Flyable Flyable \u0026lt;|.. Plane @enduml @startuml Plane ..|\u0026gt; Flyable Flyable \u0026lt;|.. Plane @enduml ä½¿ç”¨implements å…³é”®å­—ä¹Ÿå¯ä»¥ã€‚\nä¾èµ– @startuml Chef ..\u0026gt; Recipe @enduml @startuml Chef ..\u0026gt; Recipe @enduml  ä¾èµ–è¡¨ç¤ºä½¿ç”¨å…³ç³»ï¼Œjavaä¸­, è¢«ä¾èµ–çš„å¯¹è±¡/ç±», ä»¥æ–¹æ³•å‚æ•°, å±€éƒ¨å˜é‡å’Œé™æ€æ–¹æ³•è°ƒç”¨çš„å½¢å¼å‡ºç°ã€‚æ¯”å¦‚, å¨å¸ˆåœ¨çƒ¹é¥ªçš„æ—¶å€™çœ‹äº†ä¸€çœ¼èœè°±, å¨å¸ˆ\u0026quot;ä½¿ç”¨\u0026quot;äº†èœè°±, ç…§ç€å®ƒç‚’å®Œèœåï¼Œè¿™ç§ä½¿ç”¨å…³ç³»å°±ç»“æŸäº†(ä¸´æ—¶æ€§).\n å…³è”  å…³è”å…³ç³»ï¼Œè¡¨ç¤º\u0026quot;æ‹¥æœ‰\u0026rdquo;ã€‚ ç›¸æ¯”ä¾èµ–å…³ç³»çš„ä¸´æ—¶æ€§å’Œå•å‘æ€§ï¼Œå…³è”å…³ç³»å…·æœ‰é•¿æœŸæ€§ã€å¹³ç­‰æ€§(å¯åŒå‘)ï¼Œæ‰€ä»¥å…³è”è¡¨ç¤ºçš„å…³ç³»æ¯”ä¾èµ–æ›´å¼ºã€‚æ¯”å¦‚ç°å®ç”Ÿæ´»ä¸­çš„å¤«å¦», å¸ˆç”Ÿç­‰å…³ç³»ã€‚é•¿æœŸå­˜åœ¨å¹¶ä¸”æ˜¯ç›¸äº’çš„å…³ç³»ã€‚ æ­¤å¤–å…³è”å¯ä»¥è¡¨ç¤ºä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€ï¼Œå¤šå¯¹å¤šç­‰å„ç§å…³ç³»ã€‚\n @startuml Address \u0026lt;-- Husband Husband \u0026lt;--\u0026gt; Wife Husband2 -- Wife2 @enduml @startuml Address \u0026lt;-- Husband Husband \u0026lt;--\u0026gt; Wife Husband2 -- Wife2 @enduml èšåˆ  èšåˆå…³ç³»ç›¸å¯¹äºç»„åˆå¼±ä¸€äº›ï¼Œæ•´ä½“ä¸éƒ¨åˆ†æ˜¯å¯åˆ†ç¦»çš„ã€‚ æ¯”å¦‚éƒ¨é—¨ä¸å‘˜å·¥ï¼Œéƒ¨é—¨æœ‰è®¸å¤šå‘˜å·¥ï¼Œå‘˜å·¥ç¦»èŒäº†éƒ¨é—¨ä»ç„¶å­˜åœ¨ï¼Œä¸å—å½±å“ã€‚åä¹‹éƒ¨é—¨è§£æ•£äº†ï¼Œå‘˜å·¥å¯ä»¥å»å…¶ä»–éƒ¨é—¨(æ•´ä½“ä¸éƒ¨åˆ†å¯åˆ†ç¦»)\n @startuml Department o-- Employee @enduml o è¡¨ç¤ºç©ºå¿ƒè±å½¢\n@startuml Department o-- Employee @enduml ç»„åˆ  ç»„åˆå…³ç³»ä¸­ï¼Œæ•´ä½“ä¸éƒ¨åˆ†æ˜¯ä¸å¯åˆ†ç¦»çš„ï¼Œæ•´ä½“ä¸éƒ¨åˆ†çš„ç”Ÿå‘½å‘¨æœŸä¿æŒä¸€è‡´ï¼Œå°‘äº†å¯¹æ–¹è‡ªå·±çš„å­˜åœ¨æ— æ„ä¹‰ã€‚ä¾‹å¦‚äººä½“æ˜¯æœ‰å››è‚¢ç»„æˆçš„ï¼Œå››è‚¢ä¸èƒ½è„±ç¦»äººä½“å­˜åœ¨ï¼Œäººä½“å°‘äº†å››è‚¢ä¹Ÿéš¾è¨€å®Œæ•´ã€‚\n @startuml Body \u0026quot;1\u0026quot; *-- \u0026quot;2\u0026quot; Arm Body \u0026quot;1\u0026quot; *-- \u0026quot;2\u0026quot; Leg @enduml * è¡¨ç¤ºå®å¿ƒè±å½¢\n@startuml Body \u0026quot;1\u0026quot; *-- \u0026quot;2\u0026quot; Arm Body \u0026quot;1\u0026quot; *-- \u0026quot;2\u0026quot; Leg @enduml æŠ½è±¡æ–¹æ³•å’Œé™æ€æ–¹æ³• @startuml class Hello { {abstract} one: int {abstract} two(): int } @enduml @startuml class Hello { {static} ONE: int {static} two(): int } @enduml @startuml class Hello { {abstract} one: int {abstract} two(): int } @enduml @startuml class Hello { {static} ONE: int {static} two(): int } @enduml æ³›å‹ @startuml class Hello\u0026lt;H\u0026gt; class World\u0026lt;W\u0026gt; @enduml @startuml class Hello\u0026lt;H\u0026gt; class World\u0026lt;W\u0026gt; @enduml åŒ…å›¾ @startuml package one.two { class Hello } package three.four { World -- Hello } @enduml @startuml package one.two { class Hello } package three.four { World -- Hello } @enduml åŒ…å¯ä»¥ä½¿ç”¨é¢œè‰²å’Œæ›¿æ¢æ ·å¼ï¼š\n@startuml 'https://plantuml.com/class-diagram class Client class Facade Client -\u0026gt; Facade package \u0026quot;å­ç³»ç»Ÿ\u0026quot; \u0026lt;\u0026lt;cloud\u0026gt;\u0026gt; #DDDDDD{ class A class B class C class D class E } Facade -- A Facade -- C A - C A -- B A -- E C - E B - D @enduml @startuml 'https://plantuml.com/class-diagram class Client class Facade Client -\u0026gt; Facade package \u0026quot;å­ç³»ç»Ÿ\u0026quot; \u0026lt;\u0026lt;cloud\u0026gt;\u0026gt; #DDDDDD{ class A class B class C class D class E } Facade -- A Facade -- C A - C A -- B A -- E C - E B - D @enduml æ ·å¼åˆ—è¡¨ï¼š\n@startuml scale 750 width package foo1 \u0026lt;\u0026lt;Node\u0026gt;\u0026gt; { class Class1 } package foo2 \u0026lt;\u0026lt;Rectangle\u0026gt;\u0026gt; { class Class2 } package foo3 \u0026lt;\u0026lt;Folder\u0026gt;\u0026gt; { class Class3 } package foo4 \u0026lt;\u0026lt;Frame\u0026gt;\u0026gt; { class Class4 } package foo5 \u0026lt;\u0026lt;Cloud\u0026gt;\u0026gt; { class Class5 } package foo6 \u0026lt;\u0026lt;Database\u0026gt;\u0026gt; { class Class6 } @enduml @startuml scale 750 width package foo1 \u0026lt;\u0026lt;Node\u0026gt;\u0026gt; { class Class1 } package foo2 \u0026lt;\u0026lt;Rectangle\u0026gt;\u0026gt; { class Class2 } package foo3 \u0026lt;\u0026lt;Folder\u0026gt;\u0026gt; { class Class3 } package foo4 \u0026lt;\u0026lt;Frame\u0026gt;\u0026gt; { class Class4 } package foo5 \u0026lt;\u0026lt;Cloud\u0026gt;\u0026gt; { class Class5 } package foo6 \u0026lt;\u0026lt;Database\u0026gt;\u0026gt; { class Class6 } @enduml noteç¬”è®° ä¸€èˆ¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¯­å¥è¿›è¡Œåœ¨ç»„ä»¶çš„ä¸Šä¸‹å·¦å³æ·»åŠ ç¬”è®°ï¼š\n@startuml class A class B class C class D â€˜ åœ¨ç»„ä»¶Aå·¦è¾¹æ·»åŠ ç¬”è®° note left of A : ç¬”è®°A â€˜ åœ¨ç»„ä»¶Bå³è¾¹æ·»åŠ ç¬”è®° note right of B : ç¬”è®°B â€˜ åœ¨ç»„ä»¶Cä¸Šè¾¹æ·»åŠ ç¬”è®° note top of C : ç¬”è®°C â€˜ åœ¨ç»„ä»¶Dä¸‹è¾¹æ·»åŠ ç¬”è®° note bottom of D : ç¬”è®°D @enduml @startuml class A class B class C class D â€˜ åœ¨ç»„ä»¶Aå·¦è¾¹æ·»åŠ ç¬”è®° note left of A : ç¬”è®°A â€˜ åœ¨ç»„ä»¶Bå³è¾¹æ·»åŠ ç¬”è®° note right of B : ç¬”è®°B â€˜ åœ¨ç»„ä»¶Cä¸Šè¾¹æ·»åŠ ç¬”è®° note top of C : ç¬”è®°C â€˜ åœ¨ç»„ä»¶Dä¸‹è¾¹æ·»åŠ ç¬”è®° note bottom of D : ç¬”è®°D @enduml å¯ä»¥åœ¨å­—æ®µï¼ˆfieldã€attributeã€memberï¼‰æˆ–æ–¹æ³•ä¸Šæ·»åŠ æ³¨é‡Šã€‚ è¿™ä¸èƒ½ä¸å‘½åç©ºé—´åˆ†éš”ç¬¦(namespaceSeparator) :: ä¸€èµ·ä½¿ç”¨\næ³¨é‡Šå±æ€§å’Œæ–¹æ³•ï¼š\n@startuml class A { {static} int counter +void {abstract} start(int timeout) } note left of A::counter è¯¥æˆå‘˜å·²æ³¨é‡Š end note note right of A::start åœ¨ UML æ³¨é‡Šäº†æ­¤æ–¹æ³• end note @enduml @startuml class A { {static} int counter +void {abstract} start(int timeout) } note left of A::counter è¯¥æˆå‘˜å·²æ³¨é‡Š end note note right of A::start åœ¨ UML æ³¨é‡Šäº†æ­¤æ–¹æ³• end note @enduml æ³¨é‡ŠåŒåæ–¹æ³•ï¼š\n@startuml class A { {static} int counter +void {abstract} start(int timeoutms) +void {abstract} start(Duration timeout) } note left of A::counter è¯¥æˆå‘˜å·²æ³¨é‡Š end note note right of A::\u0026quot;start(int timeoutms)\u0026quot; è¿™ä¸ªstartæ–¹æ³•çš„å‚æ•°æ˜¯intç±»å‹ end note note right of A::\u0026quot;start(Duration timeout)\u0026quot; è¿™ä¸ªstartæ–¹æ³•çš„å‚æ•°æ˜¯Durationç±»å‹ end note @enduml @startuml class A { {static} int counter +void {abstract} start(int timeoutms) +void {abstract} start(Duration timeout) } note left of A::counter è¯¥æˆå‘˜å·²æ³¨é‡Š end note note right of A::\u0026quot;start(int timeoutms)\u0026quot; è¿™ä¸ªstartæ–¹æ³•çš„å‚æ•°æ˜¯intç±»å‹ end note note right of A::\u0026quot;start(Duration timeout)\u0026quot; è¿™ä¸ªstartæ–¹æ³•çš„å‚æ•°æ˜¯Durationç±»å‹ end note @enduml æ—¶åºå›¾  åºåˆ—å›¾æ˜¯ä»…æ¬¡äºç±»å›¾çš„æœ€å¸¸ç”¨ UML å›¾ã€‚ åºåˆ—å›¾å°†äº¤äº’å…³ç³»è¡¨ç¤ºä¸ºä¸€ä¸ªäºŒç»´å›¾ï¼Œçºµå‘æ˜¯æ—¶é—´è½´ï¼Œæ—¶é—´æ²¿ç«–çº¿å‘ä¸‹å»¶ä¼¸ï¼›æ¨ªå‘è½´ä»£è¡¨äº†åœ¨åä½œä¸­å„ä¸ªè§’è‰²ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ª Class çš„å¯¹è±¡ï¼Œç”¨ä¸€æ¡è™šçº¿ä»£è¡¨å„è§’è‰²çš„ç”Ÿå‘½çº¿ï¼Œç”Ÿå‘½çº¿ä¸Šç”¨çŸ©å½¢ç«–æ¡è¡¨ç¤ºæ˜¯å¦å¤„äºæ´»è·ƒçŠ¶æ€ã€‚å¯¹è±¡ä¹‹é—´å¯ä»¥å‘é€åŒæ­¥æˆ–å¼‚æ­¥æ¶ˆæ¯ã€‚\n åºåˆ—å›¾çš„åŸºæœ¬å†…å®¹æ„æˆï¼š\n\u0026lt;è§’è‰²\u0026gt; \u0026lt;æ¶ˆæ¯ç±»å‹\u0026gt; \u0026lt;è§’è‰²\u0026gt; : \u0026lt;æ¶ˆæ¯å†…å®¹\u0026gt;\n æ¶ˆæ¯ç±»å‹ä¸­ -\u0026gt; è¡¨ç¤ºåŒæ­¥æ¶ˆæ¯ --\u0026gt; è™šçº¿è¡¨ç¤ºè¿”å›æ¶ˆæ¯  åŒæ­¥æ¶ˆæ¯ @startuml Alice -\u0026gt; Bob: Hi Bob --\u0026gt; Alice: Hi Alice -\u0026gt; Bob: Is this a pen? Bob --\u0026gt; Alice: No! This is an apple!! @enduml @startuml Alice -\u0026gt; Bob: Hi Bob --\u0026gt; Alice: Hi Alice -\u0026gt; Bob: Is this a pen? Bob --\u0026gt; Alice: No! This is an apple!! @enduml å¼‚æ­¥æ¶ˆæ¯ @startuml Alice -\u0026gt;\u0026gt; Bob: Hi Alice -\u0026gt;\u0026gt; Bob: Is this a pen? Alice -\u0026gt;\u0026gt; Bob: Is this a pen?? Alice -\u0026gt;\u0026gt; Bob: Is this a pen??? Alice -\u0026gt;\u0026gt; Bob: Is this a pen???? Bob -\u0026gt; Alice: This is an apple!!! @enduml è§’è‰²ç”Ÿå‘½çº¿  å¤šä¸ªparticipant ä¼šæŒ‰ç…§ä»å·¦å¾€å³çš„é¡ºåºæ˜¾ç¤ºå„è§’è‰²ç”Ÿå‘½çº¿ å¦‚æœæ²¡æœ‰ä»»ä½• participant, åˆ™ä¼šè§’è‰²å‡ºç°çš„é¡ºåºæ˜¾ç¤ºä»å·¦å¾€å³æ˜¾ç¤ºå…¶ç”Ÿå‘½çº¿  è§’è‰²å›¾ä¾‹ @startuml actor Actor boundary Boundary control Control entity Entity database Database collections Collections @enduml @startuml actor Actor boundary Boundary control Control entity Entity database Database collections Collections @enduml ç®­å¤´æ ·å¼ @startuml Bob -\u0026gt;x Alice Bob -\u0026gt; Alice Bob -\u0026gt;\u0026gt; Alice Bob -\\ Alice Bob \\\\- Alice Bob //-- Alice Bob -\u0026gt;o Alice Bob o\\\\-- Alice Bob \u0026lt;-\u0026gt; Alice Bob \u0026lt;-\u0026gt;o Alice @enduml @startuml Bob -\u0026gt;x Alice Bob -\u0026gt; Alice Bob -\u0026gt;\u0026gt; Alice Bob -\\ Alice Bob \\\\- Alice Bob //-- Alice Bob -\u0026gt;o Alice Bob o\\\\-- Alice Bob \u0026lt;-\u0026gt; Alice Bob \u0026lt;-\u0026gt;o Alice @enduml å‘ç»™è‡ªå·±çš„æ¶ˆæ¯ @startuml Aclie -\u0026gt; Aclie: do something by yourself Aclie -\u0026gt; Aclie: do something by yourself Aclie -\u0026gt; Aclie: do something by yourself Aclie -\u0026gt; Aclie: do something by yourself @enduml @startuml Aclie -\u0026gt; Aclie: do something by yourself Aclie -\u0026gt; Aclie: do something by yourself Aclie -\u0026gt; Aclie: do something by yourself Aclie -\u0026gt; Aclie: do something by yourself @enduml æ¶ˆæ¯åºå· æ·»åŠ å…³é”®å­—autonumber\n@startuml Alice -\u0026gt; Bob: Hi autonumber Bob -\u0026gt; Carol: Hi Carol -\u0026gt; Dave: Hi Bob -\u0026gt; Dave: Hi @enduml  autonumber stop: è‡ªåŠ¨åºå·æš‚åœ autonumber resume: è‡ªåŠ¨åºå·ç»§ç»­  @startuml Alice -\u0026gt; Bob: Hi autonumber Bob -\u0026gt; Carol: Hi Carol -\u0026gt; Dave: Hi Bob -\u0026gt; Dave: Hi @enduml æ¶ˆæ¯ç»„  @startuml Alice -\u0026gt; Bob: Is this a pen? alt yes Alice \u0026lt;-- Bob: Yes! This is a pen!! else no Alice \u0026lt;-- Bob: No! This is an apple!!!!! end @enduml @startuml Alice -\u0026gt; Bob: Is this a pen? alt yes Alice \u0026lt;-- Bob: Yes! This is a pen!! else no Alice \u0026lt;-- Bob: No! This is an apple!!!!! end @enduml æœ‰æ—¶å€™éœ€è¦å¤šä¸ªæ¶ˆæ¯è¡¨ç¤ºä¸€ç»„ç›¸å…³çš„é€»è¾‘ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨é¢„ç½®çš„å…³é”®å­—æ¥è¡¨ç¤ºå„ç§é€»è¾‘ï¼Œä¾‹å¦‚\n alt/else opt loop par break critical  å…³é”®è¯ä¹‹åæ·»åŠ è¡¨ç¤ºé€»è¾‘çš„æ–‡å­—ï¼Œä¾‹å¦‚ yesï¼Œ noç­‰\næ¶ˆæ¯ä¿¡æ¯çš„ç¼©è¿›ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯åŠ ä¸Šå¯è¯»æ€§æ›´å¥½\næ¶ˆæ¯ç»„åµŒå¥—\n@startuml Alice -\u0026gt; Bob: Is this a pen? alt yes Alice \u0026lt;-- Bob: Yes! This is a pen!! else no Alice \u0026lt;-- Bob: Noooooooo! This is an apple!!!!! loop âˆ Alice -\u0026gt; Bob: Oh sorry! By the way, is this a pen? Alice \u0026lt;-- Bob: No!!!! end end @enduml @startuml Alice -\u0026gt; Bob: Is this a pen? alt yes Alice \u0026lt;-- Bob: Yes! This is a pen!! else no Alice \u0026lt;-- Bob: Noooooooo! This is an apple!!!!! loop âˆ Alice -\u0026gt; Bob: Oh sorry! By the way, is this a pen? Alice \u0026lt;-- Bob: No!!!! end end @enduml è‡ªå®šä¹‰æ¶ˆæ¯ç»„\n@startuml group copy Alice -\u0026gt; Bob: Is this a pen? Alice \u0026lt;-- Bob: No! This is an apple!! end @enduml @startuml group copy Alice -\u0026gt; Bob: Is this a pen? Alice \u0026lt;-- Bob: No! This is an apple!! end @enduml group ä¹‹åæ·»åŠ æ¶ˆæ¯ç»„çš„åå­—\nç”Ÿå‘½çº¿æ´»è·ƒçŠ¶æ€  activate \u0026lt;name\u0026gt; æŒ‡å®šnameçš„ç”Ÿå‘½çº¿è¿›å…¥æ´»è·ƒçŠ¶æ€ deactive \u0026lt;name\u0026gt; æŒ‡å®šnameçš„ç”Ÿå‘½çº¿é€€å‡ºæ´»è·ƒçŠ¶æ€  @startuml activate Alice Alice -\u0026gt; Bob activate Bob Bob -\u0026gt; Carol activate Carol Bob \u0026lt;-- Carol deactivate Carol Alice \u0026lt;-- Bob deactivate Bob @enduml @startuml activate Alice Alice -\u0026gt; Bob activate Bob Bob -\u0026gt; Carol activate Carol Bob \u0026lt;-- Carol deactivate Carol Alice \u0026lt;-- Bob deactivate Bob @enduml åµŒå¥—æ´»è·ƒçŠ¶æ€ @startuml activate Alice Alice -\u0026gt; Bob activate Bob Bob -\u0026gt; Bob activate Bob Bob -\u0026gt; Carol activate Carol Bob \u0026lt;-- Carol deactivate Carol Alice \u0026lt;-- Bob deactivate Bob @enduml @startuml activate Alice Alice -\u0026gt; Bob activate Bob Bob -\u0026gt; Bob activate Bob Bob -\u0026gt; Carol activate Carol Bob \u0026lt;-- Carol deactivate Carol Alice \u0026lt;-- Bob deactivate Bob @enduml â€‹ activate ä¸­ç»§ç»­ activate å¯ä»¥åµŒå¥—æ´»è·ƒçŠ¶æ€\nåˆ›å»ºè§’è‰²å’Œç”Ÿå‘½çº¿ @startuml Alice -\u0026gt; Bob create Carol Bob -\u0026gt; Carol: new Bob -\u0026gt; Carol Bob \u0026lt;-- Carol Alice \u0026lt;-- Bob @enduml @startuml Alice -\u0026gt; Bob create Carol Bob -\u0026gt; Carol: new Bob -\u0026gt; Carol Bob \u0026lt;-- Carol Alice \u0026lt;-- Bob @enduml create \u0026lt;name\u0026gt; ç”¨æ¥åˆ›å»ºä¸€ä¸ªè§’è‰²å’Œå…¶ç”Ÿå‘½çº¿ï¼Œæ­¤æ—¶æ¶ˆæ¯ç®­å¤´ä¼šæ‰§è¡Œè§’è‰²å›¾ä¾‹\nå‚è€ƒã€å¼•ç”¨ @startuml Alice -\u0026gt; Bob ref over Bob, Carol: ... Alice \u0026lt;-- Bob ref over Alice ... ... end ref @enduml  ref over \u0026lt;ç”Ÿå‘½çº¿åç§°\u0026gt; : \u0026lt;å†…å®¹\u0026gt; : reference çš„èŒƒå›´å’Œå‚è€ƒå†…å®¹ ref over ... end ref: å¯ä»¥æ¢è¡Œå†™å‚è€ƒå†…å®¹  @startuml Alice -\u0026gt; Bob ref over Bob, Carol: ... Alice \u0026lt;-- Bob ref over Alice ... ... end ref @enduml è¾¹ç•Œçº¿ @startuml == Foo == Alice -\u0026gt; Bob Alice \u0026lt;-- Bob == Bar == Bob -\u0026gt; Carol Bob \u0026lt;-- Carol @enduml == \u0026lt;name\u0026gt; == æ·»åŠ è¾¹ç•Œçº¿ï¼Œè·¨è¶Šæ‰€æœ‰è§’è‰²çš„ç”Ÿå‘½çº¿\n@startuml == Foo == Alice -\u0026gt; Bob Alice \u0026lt;-- Bob == Bar == Bob -\u0026gt; Carol Bob \u0026lt;-- Carol @enduml å¤–éƒ¨æ¶ˆæ¯ @startuml [-\u0026gt; Alice: Hello Alice -\u0026gt;]: Hello @enduml æ¶ˆæ¯ç®­å¤´çš„å‰åä½¿ç”¨ [ ï¼Œ ] ï¼Œè¡¨ç¤ºä¸€ä¸ªæ¥è‡ªå¤–éƒ¨æˆ–è€…æŒ‡å‘å¤–éƒ¨çš„æ¶ˆæ¯\n@startuml [-\u0026gt; Alice: Hello Alice -\u0026gt;]: Hello @enduml æ¶ˆæ¯é—´éš” @startuml Alice -\u0026gt; Bob Alice \u0026lt;-- Bob Alice -\u0026gt; Bob Alice \u0026lt;-- Bob ||| Alice -\u0026gt; Bob Alice \u0026lt;-- Bob ||80|| Alice -\u0026gt; Bob Alice \u0026lt;-- Bob @enduml  æ¶ˆæ¯ä¹‹é—´åŠ  ||| , ä¼šé€‚å½“æ‹‰å¼€æ¶ˆæ¯é—´éš” ||\u0026lt;pixel\u0026gt;||ï¼špixelå¯ä»¥æŒ‡å®šå…·ä½“é—´éš”çš„åƒç´ æ•°  @startuml Alice -\u0026gt; Bob Alice \u0026lt;-- Bob Alice -\u0026gt; Bob Alice \u0026lt;-- Bob ||| Alice -\u0026gt; Bob Alice \u0026lt;-- Bob ||80|| Alice -\u0026gt; Bob Alice \u0026lt;-- Bob @enduml å¤‡æ³¨ @startuml Alice -\u0026gt; Bob note left: Hello Alice \u0026lt;-- Bob note right: World Alice -\u0026gt; Alice note left Hello World end note @enduml @startuml Alice -\u0026gt; Bob note left: Hello Alice \u0026lt;-- Bob note right: World Alice -\u0026gt; Alice note left Hello World end note @enduml ç»„ä»¶\u0026amp;éƒ¨ç½²å›¾ ç®­å¤´æ–¹å‘ -\u0026gt;è¡¨ç¤ºå‘å³ï¼Œ --\u0026gt;è¡¨ç¤ºå‘ä¸‹ã€‚è¿˜å¯ä»¥ä½¿ç”¨å…³é”®å­—left, right, up or downæ”¹å˜ç®­å¤´æ–¹å‘ã€‚-left-\u0026gt;æˆ–-l-\u0026gt;è¡¨ç¤ºå‘å·¦ã€‚\n@startuml component componentA as A component componentB as B component componentC as C component componentD as D ' è¡¨ç¤ºç®­å¤´å‘å³ A -\u0026gt; B ' è¡¨ç¤ºç®­å¤´å‘ä¸‹ C --\u0026gt; D @enduml @startuml component componentA as A component componentB as B component componentC as C component componentD as D ' è¡¨ç¤ºç®­å¤´å‘å³ A -\u0026gt; B ' è¡¨ç¤ºç®­å¤´å‘ä¸‹ C --\u0026gt; D @enduml è¿˜æœ‰è™šçº¿(..)ã€ç›´çº¿(--)\nç»„ä»¶ å…³é”®å­—componentå®šä¹‰ä¸€ä¸ªç»„ä»¶ã€‚\n@startuml component componentA as A component componentB as B component componentGroup as group { component componentC as C component componentD as D } @enduml @startuml component componentA as A component componentB as B component componentGroup as group { component componentC as C component componentD as D } @enduml æ¥å£ æ¥å£å¯ä»¥ä½¿ç”¨()æ¥å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…³é”®å­—interfaceæ¥å®šä¹‰æ¥å£ã€‚\n@startuml () \u0026quot;interfaceA\u0026quot; as iA interface interfaceB as iB @enduml @startuml () \u0026quot;interfaceA\u0026quot; as iA interface interfaceB as iB @enduml ç»„åˆç»„ä»¶ å¯ä»¥ä½¿ç”¨å¤šä¸ªå…³é”®å­—å°†ç»„ä»¶å’Œæ¥å£ç»„åˆåœ¨ä¸€èµ·ã€‚\n package node folder frame cloud database  @startuml package \u0026quot;Some Group\u0026quot; { HTTP - [First Component] [Another Component] } node \u0026quot;Other Groups\u0026quot; { FTP - [Second Component] [First Component] --\u0026gt; FTP } cloud { [Example 1] } database \u0026quot;MySql\u0026quot; { folder \u0026quot;This is my folder\u0026quot; { [Folder 3] } frame \u0026quot;Foo\u0026quot; { [Frame 4] } } [Another Component] --\u0026gt; [Example 1] [Example 1] --\u0026gt; [Folder 3] [Folder 3] --\u0026gt; [Frame 4] @enduml @startuml package \u0026quot;Some Group\u0026quot; { HTTP - [First Component] [Another Component] } node \u0026quot;Other Groups\u0026quot; { FTP - [Second Component] [First Component] --\u0026gt; FTP } cloud { [Example 1] } database \u0026quot;MySql\u0026quot; { folder \u0026quot;This is my folder\u0026quot; { [Folder 3] } frame \u0026quot;Foo\u0026quot; { [Frame 4] } } [Another Component] --\u0026gt; [Example 1] [Example 1] --\u0026gt; [Folder 3] [Folder 3] --\u0026gt; [Frame 4] @enduml é•¿æè¿° å¯ä»¥ç”¨æ–¹æ‹¬å·\u0026rdquo;[ ]\u0026ldquo;åœ¨è¿çº¿ä¸Šæ·»åŠ æè¿°ã€‚\n@startuml component comp1 [ This component has a long comment on several lines ] @enduml @startuml component comp1 [ This component has a long comment on several lines ] @enduml é¢œè‰² åœ¨å£°æ˜ä¸€ä¸ªç»„ä»¶æ—¶åŠ ä¸Šé¢œè‰²çš„å£°æ˜ï¼Œåœ¨åé¢åŠ ä¸Š#é¢œè‰²åå¯ä»¥æ”¹å˜é¢œè‰²/\n@startuml component [Web Server] #yellow @enduml @startuml component [Web Server] #yellow @enduml å£°æ˜å…ƒç´  @startuml actor actor actor/ \u0026quot;actor/\u0026quot; agent agent artifact artifact boundary boundary card card circle circle cloud cloud collections collections component component control control database database entity entity file file folder folder frame frame interface interface label label node node package package queue queue rectangle rectangle stack stack storage storage usecase usecase usecase/ \u0026quot;usecase/\u0026quot; @enduml @startuml actor actor actor/ \u0026quot;actor/\u0026quot; agent agent artifact artifact boundary boundary card card circle circle cloud cloud collections collections component component control control database database entity entity file file folder folder frame frame interface interface label label node node package package queue queue rectangle rectangle stack stack storage storage usecase usecase usecase/ \u0026quot;usecase/\u0026quot; @enduml åˆ†éš”ç¬¦ @startuml folder folder [ è¿™æ˜¯ä¸ª \u0026lt;b\u0026gt;æ–‡ä»¶å¤¹ ---- æ‚¨å¯ä»¥ä½¿ç”¨ ==== ä¸åŒç±»å‹ .... çš„åˆ†éš”ç¬¦ ] node node [ è¿™æ˜¯ä¸ª \u0026lt;b\u0026gt;ç»“ç‚¹ ---- æ‚¨å¯ä»¥ä½¿ç”¨ ==== ä¸åŒç±»å‹ .... çš„åˆ†éš”ç¬¦ ] database database [ è¿™æ˜¯ä¸ª \u0026lt;b\u0026gt;æ•°æ®åº“ ---- æ‚¨å¯ä»¥ä½¿ç”¨ ==== ä¸åŒç±»å‹ .... çš„åˆ†éš”ç¬¦ ] usecase usecase [ è¿™æ˜¯ä¸ª \u0026lt;b\u0026gt;ç”¨ä¾‹ ---- æ‚¨å¯ä»¥ä½¿ç”¨ ==== ä¸åŒç±»å‹ .... çš„åˆ†éš”ç¬¦ ] @enduml @startuml folder folder [ è¿™æ˜¯ä¸ª \u0026lt;b\u0026gt;æ–‡ä»¶å¤¹ ---- æ‚¨å¯ä»¥ä½¿ç”¨ ==== ä¸åŒç±»å‹ .... çš„åˆ†éš”ç¬¦ ] node node [ è¿™æ˜¯ä¸ª \u0026lt;b\u0026gt;ç»“ç‚¹ ---- æ‚¨å¯ä»¥ä½¿ç”¨ ==== ä¸åŒç±»å‹ .... çš„åˆ†éš”ç¬¦ ] database database [ è¿™æ˜¯ä¸ª \u0026lt;b\u0026gt;æ•°æ®åº“ ---- æ‚¨å¯ä»¥ä½¿ç”¨ ==== ä¸åŒç±»å‹ .... çš„åˆ†éš”ç¬¦ ] usecase usecase [ è¿™æ˜¯ä¸ª \u0026lt;b\u0026gt;ç”¨ä¾‹ ---- æ‚¨å¯ä»¥ä½¿ç”¨ ==== ä¸åŒç±»å‹ .... çš„åˆ†éš”ç¬¦ ] @enduml éšè—çº¿ -[hidden]-å¯ä»¥ç”»ä¸€æ¡éšè—çš„çº¿æ¡ï¼Œå¸¸å¸¸ç”¨äºå¸ƒå±€ã€‚\næ’åˆ— å¯ä»¥æ·»åŠ ä¸‹é¢çš„ä¸€è¡Œè¿›è¡Œç«–æ’åˆ—ï¼š\nleft to right direction ç›¸å…³é…ç½® å®‰è£…graphviz Macæ‰§è¡Œï¼š\nbrew install graphviz ç„¶ååœ¨IDEAè¿›è¡Œè®¾ç½®ã€‚\nReference:\n å¼€æºå·¥å…·ï¼Œä½¿ç”¨ç®€å•çš„æ–‡å­—æè¿°ç”»UMLå›¾ã€‚ ç¨‹åºå‘˜å¿…å¤‡ç”»å›¾æŠ€èƒ½ä¹‹â€”â€”æ—¶åºå›¾ - ç¨‹åºå‘˜è‡ªç”±ä¹‹è·¯ - åšå®¢å›­ ã€ç¨‹åºå‘˜å°çŸ¥è¯†ã€‘ä½¿ç”¨ PlantUML ç”» UMLï¼ˆä¸Šï¼‰ç±»å›¾ - æ˜é‡‘ åœ¨ Hugo åšå®¢ä¸Šä½¿ç”¨ PlantUML â€“ Mogeko\u0026rsquo;s Blog https://crashedmind.github.io/PlantUMLHitchhikersGuide/layout/layout.html  ","description":"ä½¿ç”¨plantUMLè¡¨ç¤ºä¸€äº›å…³ç³»å’ŒçŠ¶æ€å›¾æ›´åŠ æ¸…æ™°ã€‚","id":15,"section":"posts","tags":["å·¥å…·","plantUML"],"title":"plantUMLä½¿ç”¨ç¬”è®°","uri":"https://hugo.jiahongw.com/zh/posts/efficient/plantuml-note/"},{"content":" å®šä¹‰ è£…é¥°å™¨æ¨¡å¼åŠ¨æ€çš„å°†è´£ä»»é™„åŠ åˆ°å¯¹è±¡ä¸Šï¼Œè‹¥è¦æ‹“å±•åŠŸèƒ½ï¼Œè£…é¥°è€…æä¾›äº†æ¯”ç»§æ‰¿æ›´æœ‰å¼¹æ€§çš„æ›¿ä»£æ–¹æ¡ˆã€‚\næ¶æ„ï¼ˆç±»å›¾ï¼‰ classDiagram class Component { \u0026lt;\u0026lt;abstract\u0026gt;\u0026gt; + methodA() + methodB() } class ConcreateComponent { + methodA() + methodB() } class Decrator { \u0026lt;\u0026lt;abstract\u0026gt;\u0026gt; + methodA() + methodB() } class ConcreateDecratorA { + methodA() + methodB() + newMethod() } class ConcreateDecratorB { + methodA() + methodB() } ConcreateComponent --|\u0026gt; Component : ç»§æ‰¿ Decrator --|\u0026gt; Component : ç»§æ‰¿ ConcreateDecratorA --|\u0026gt; Decrator : ç»§æ‰¿ ConcreateDecratorB --|\u0026gt; Decrator : ç»§æ‰¿ è£…é¥°çš„æŠ€å·§å¯ä»¥åœ¨ä¸ä¿®æ”¹ä»»ä½•åº•å±‚ä»£ç çš„æƒ…å†µä¸‹å¢å¼ºåŠŸèƒ½ã€‚\nKeyï¼š\n è£…é¥°è€…å’Œè¢«è£…é¥°è€…æœ‰ç›¸åŒçš„è¶…ç±»å‹  ä½¿ç”¨åœºæ™¯   Java IOç±»åº“ï¼ˆInputStreamã€OutputStreamï¼‰\n è£…é¥°å™¨æ¨¡å¼å¯ä»¥å¾ˆå¥½çš„ä½¿ç”¨éŸ¦æ©å›¾è¿›è¡Œè§£é‡Šï¼Œè£…é¥°å™¨çš„åŒ…è£…å¯¹è±¡ç±»ä¼¼äºé€’å½’è°ƒç”¨çš„å½¢å¼ï¼Œä¸€å±‚å¥—ä¸€å±‚å»è°ƒç”¨è¢«åŒ…è£…å¯¹è±¡çš„æ“ä½œã€‚\n   åœ¨ä¸å½±å“å…¶ä»–å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œä»¥åŠ¨æ€ã€é€æ˜çš„æ–¹å¼ç»™å•ä¸ªå¯¹è±¡æ·»åŠ èŒè´£ã€‚\n  ä½¿ç”¨ç¼ºç‚¹  ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼ï¼Œå¸¸å¸¸é€ æˆè®¾è®¡ä¸­æœ‰å¤§é‡çš„ç±»ã€‚  Reference:\n ã€ŠHead First è®¾è®¡æ¨¡å¼ã€‹ è£…é¥°è®¾è®¡ï¼ˆè£…é¥°è€…æ¨¡å¼ / è£…é¥°å™¨æ¨¡å¼ï¼‰  ","description":"è£…é¥°å™¨æ¨¡å¼åŠ¨æ€çš„å°†è´£ä»»é™„åŠ åˆ°å¯¹è±¡ä¸Šï¼Œè‹¥è¦æ‹“å±•åŠŸèƒ½ï¼Œè£…é¥°è€…æä¾›äº†æ¯”ç»§æ‰¿æ›´æœ‰å¼¹æ€§çš„æ›¿ä»£æ–¹æ¡ˆã€‚","id":16,"section":"posts","tags":["è£…é¥°å™¨æ¨¡å¼","è®¾è®¡æ¨¡å¼"],"title":"è®¾è®¡æ¨¡å¼-è£…é¥°å™¨æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/decoratorpattern/"},{"content":" å®šä¹‰ è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šä¾èµ–ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€æ—¶ï¼Œå®ƒçš„æ‰€æœ‰ä¾èµ–è€…éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶ä¸”è‡ªåŠ¨æ›´æ–°ã€‚\n ä¸€ä¸ªæ¯”å–»ï¼šæŠ¥çº¸è®¢é˜…ï¼ˆå‡ºç‰ˆè€…å’Œè®¢é˜…è€…ï¼‰\n æ¶æ„ classDiagram class Subject { \u0026lt;\u0026lt;interface\u0026gt;\u0026gt; + registerObserver() + removeObserver() + notifyObserver() } class ConcreteSubject { - List\u0026lt;Observer\u0026gt; observers + registerObserver() + removeObserver() + notifyObserver() } class Observer { \u0026lt;\u0026lt;interface\u0026gt;\u0026gt; + update() } class ConcreteObeserver { - Subject subject + update() } Subject --\u0026gt; Observer : å¤šä¸ªè§‚å¯Ÿè€… ConcreteSubject ..|\u0026gt; Subject : å®ç° ConcreteObeserver ..|\u0026gt; Observer : å®ç° ConcreteObeserver --\u0026gt; ConcreteSubject : è®¢é˜…ä¸»é¢˜ è§‚å¯Ÿè€…ä¾èµ–ä¸»é¢˜ã€‚è§‚å¯Ÿè€…æ¨¡å¼æä¾›äº†ä¸€ç§å¯¹è±¡è®¾è®¡ï¼Œè®©ä¸»é¢˜å’Œè§‚å¯Ÿè€…ä¹‹é—´æ¾è€¦åˆã€‚ä»–ä»¬ä¾ç„¶å¯ä»¥äº¤äº’ï¼Œä½†æ˜¯ä¸å¿…æ¸…æ¥šå½¼æ­¤çš„ç»†èŠ‚ã€‚\nä¸»é¢˜ä¸»åŠ¨æ¨æ•°æ®å’Œè§‚å¯Ÿè€…è‡ªå·±æ‹‰æ•°æ®éƒ½å¯ä»¥ï¼Œä½†æ˜¯å…³é”®åœ¨äºä¸»é¢˜å¿…é¡»å¾—é€šçŸ¥è§‚å¯Ÿè€…ã€‚\nQ \u0026amp; Aï¼š\n  ä¸ºä»€ä¹ˆè§‚å¯Ÿè€…è¦åŒ…å«ä¸€ä¸ªä¸»é¢˜ï¼ˆsubjectï¼‰çš„å¼•ç”¨ï¼Ÿ\nä»¥åå¯èƒ½éœ€è¦å–æ¶ˆæ³¨å†Œï¼Œä¿å­˜ä¸€ä¸ªå¼•ç”¨ä¼šæ›´åŠ æ–¹ä¾¿ã€‚\n  â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å‹å’Œè§‚å¯Ÿè€…æ¨¡å¼çš„åŒºåˆ«å’Œè”ç³»ï¼Ÿ\nç”Ÿäº§-æ¶ˆè´¹æ¨¡å‹ï¼Œæ˜¯å¤šå¯¹å¤šçš„å…³ç³»ï¼Œä¸€èˆ¬ä»¥å¼‚æ­¥çš„æ–¹å¼å®ç°ï¼›è€Œè§‚å¯Ÿè€…æ¨¡å¼ï¼ˆå‘å¸ƒ-è®¢é˜…æ¨¡å‹ï¼‰ï¼Œæ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œå¯ä»¥ä»¥åŒæ­¥çš„æ–¹å¼å®ç°ï¼Œä¹Ÿå¯ä»¥ä»¥å¼‚æ­¥çš„æ–¹å¼å®ç°ã€‚\n å‘å¸ƒè®¢é˜…å’Œç”Ÿäº§æ¶ˆè´¹æ¨¡å‹æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼šå‘å¸ƒè€…ï¼ˆå¯è§‚æµ‹å¯¹è±¡ï¼‰æ˜¯çŸ¥é“è®¢é˜…è€…ï¼ˆè§‚å¯Ÿå¯¹è±¡ï¼‰çš„å­˜åœ¨ï¼Œå› ä¸ºå®ƒéœ€è¦éå†è®¢é˜…åˆ—è¡¨å»å‘å¸ƒäº‹ä»¶ï¼›è€Œç”Ÿäº§æ¶ˆè´¹æ¨¡å‹å› ä¸ºæœ‰ä¸­é—´æ¶ˆæ¯ä»£ç†çš„å­˜åœ¨ï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å®Œå…¨ä¸çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼Œå®Œå…¨è§£è€¦ï¼\n   Javaå†…ç½®çš„è§‚å¯Ÿè€…æ¨¡å¼ java.utilåŒ…ä¸‹çš„Observableå’ŒObserverã€‚\nGoogle EventBus å¼‚æ­¥éé˜»å¡è§‚å¯Ÿè€…æ¨¡å¼çš„å®ç°ã€‚\nç®€å•çš„å®ç°æ–¹æ³•ï¼š\n åœ¨å¯è§‚å¯Ÿå¯¹è±¡äº†é‡Œé¢å¯¹å„ä¸ªè§‚å¯Ÿè€…çš„é€šçŸ¥æ”¹æˆå¼‚æ­¥æ“ä½œã€‚ï¼ˆå¯ç”¨çº¿ç¨‹æ± ï¼‰ åœ¨è§‚å¯Ÿè€…å†…éƒ¨çš„å¤„ç†æ¶ˆæ¯æ”¹ä¸ºå¼‚æ­¥æ“ä½œã€‚ï¼ˆä¸å¯ç”¨çº¿ç¨‹æ± ï¼‰   ä¸¤è€…éƒ½èƒ½å¤Ÿå¼€å¯çº¿ç¨‹å»è·‘ï¼Œå¾ˆå¿«å°±è¿”å›ï¼Œä¸é˜»å¡ã€‚\n é’ˆå¯¹å¼‚æ­¥éé˜»å¡è§‚å¯Ÿè€…æ¨¡å¼çš„å®ç°ï¼ŒæŠ½è±¡çš„EventBusæ¡†æ¶å¯ä»¥è®©æˆ‘ä»¬èšç„¦äºä¸šåŠ¡ã€‚\nä½¿ç”¨åœºæ™¯  æ¶ˆæ¯é˜Ÿåˆ— å›è°ƒå°±æ˜¯ä¸€ç§è§‚å¯Ÿè€…æ¨¡å¼ Google EventBus é‚®ä»¶è®¢é˜… RSS ååº”å¼RxJava JDK(CompletableFuture)  Reference:\n æå®¢æ—¶é—´-è§‚å¯Ÿè€…æ¨¡å¼ è§‚å¯Ÿè€…è®¾è®¡æ¨¡å¼  ","description":"ä¸€ä¸ªæ¯”å–»ï¼šæŠ¥çº¸è®¢é˜…ï¼ˆå‡ºç‰ˆè€…å’Œè®¢é˜…è€…ï¼‰ã€‚","id":17,"section":"posts","tags":["è§‚å¯Ÿè€…æ¨¡å¼","è¡Œä¸ºæ¨¡å¼"],"title":"è§‚å¯Ÿè€…æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/observerpattern/"},{"content":"1 SequenceDiagram åºåˆ—åŒ–å›¾\n2 JRebel ç®€ä»‹ï¼š\nçƒ­éƒ¨ç½²å·¥å…·ã€‚åœ¨æˆ‘ä»¬æ¯æ¬¡ä¿®æ”¹ä»£ç åï¼Œä¸ç”¨é‡å¯ç¨‹åºï¼ŒJRebel ä¼šè‡ªåŠ¨å°†æ‰€æœ‰çš„ä»£ç å˜æ›´ç”Ÿæ•ˆã€‚è¿™æ ·ï¼Œç›¸å½“äºâ€œè·³è¿‡â€é¢‘ç¹çš„ Java ä»£ç çš„ç¼–è¯‘ã€å¯åŠ¨çš„è¿‡ç¨‹ï¼Œå¤§å¤§çš„æå‡äº†æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ã€‚\nå‚è€ƒé“¾æ¥ï¼š\n https://www.iocoder.cn/Fight/IDEA-JRebel-plug-in-hot-deployment/?self https://www.jianshu.com/p/882872a7339d  é…ç½®ï¼š\n æ¿€æ´»JRebel é…ç½®ä¿¡æ¯ å¿«æ·é”®ï¼šCommond + shift + F9  3 Maven Helper ç®€ä»‹ï¼šå¯ä»¥æŸ¥çœ‹ Maven çš„ä¾èµ–æ ‘å’Œåˆ—è¡¨\nä½¿ç”¨å‚è€ƒï¼š\n è¦æƒ³æŸ¥çœ‹mavençš„ä¾èµ–æ ‘å°±è¦ä½¿ç”¨Mavenå‘½ä»¤maven dependency:treeæ¥æŸ¥çœ‹ä¾èµ–\n å½“Maven Helper æ’ä»¶å®‰è£…æˆåŠŸåï¼Œæ‰“å¼€é¡¹ç›®ä¸­çš„pomæ–‡ä»¶ï¼Œä¸‹é¢å°±ä¼šå¤šå‡ºä¸€ä¸ªè¯•å›¾\n4 LeetCode Editor èƒ–å‹å¯ä»¥åç»­çœ‹çœ‹ LeetCode Editor æ’ä»¶çš„ä½œè€…å†™çš„ https://git.io/JLMce æŒ‡å—ã€‚\n5 Alibaba Java Coding Guidelines Alibaba Java Coding Guidelines æ’ä»¶ï¼ŒåŸºäº ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ çš„ä»£ç è§„èŒƒçš„æ£€æµ‹å·¥å…·ã€‚\n6 Translation ç®€ä»‹ï¼šTranslation æ’ä»¶ï¼Œç¿»è¯‘ç¥å™¨ï¼Œæ”¯æŒæœ‰é“ã€ç™¾åº¦ã€è°·æ­Œä¸‰ç§ç¿»è¯‘å¼•æ“ã€‚\nåŠŸèƒ½ï¼š\n  é€‰ä¸­ä¸€ä¸ªå•è¯ï¼Œè¿›è¡Œç¿»è¯‘\n  è¾“å…¥ä¸€ä¸ªå•è¯ï¼Œè¿›è¡Œç¿»è¯‘\n ç¿»è¯‘æ¡†çš„å‘¼å‡ºï¼ŒWindows ä½¿ç”¨ ctrl + shift + o å¿«æ·é”®ï¼ŒMacOS ä½¿ç”¨ control + command + i å¿«æ·é”®ã€‚\n   7 GenerateAllSetter ç®€ä»‹ï¼šGenerateAllSetter æ’ä»¶ï¼Œä¸€é”®è°ƒç”¨ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰çš„ setter æ–¹æ³•ã€‚\nåŠŸèƒ½ï¼š\n ç”Ÿæˆå¯¹è±¡ï¼Œå¹¶è®¾ç½®é»˜è®¤å€¼ ç”Ÿæˆå¯¹è±¡ï¼Œå¹¶è®¾ç½®ä¼ å…¥å‚æ•°ä½œä¸ºå€¼ ç”Ÿæˆ List / Set / Map è¿”å›ç»“æœ  å¿«æ·é”®ï¼šMacï¼šalt + Enter\nMore IDEAå¤šçº¿ç¨‹è°ƒè¯•ï¼Œå‚è€ƒï¼š\n Idea debugè°ƒè¯•æ—¶è·å–å¼‚æ­¥è°ƒç”¨æ ˆ - ç®€ä¹¦ (1æ¡æ¶ˆæ¯) javaé«˜å¹¶å‘å®æˆ˜ï¼ˆåï¼‰â€”â€”å¹¶å‘è°ƒè¯•å’ŒJDK8æ–°ç‰¹æ€§_å¹³å‡¡ä¹‹è·¯æ— å°½è·¯çš„åšå®¢-CSDNåšå®¢_jdk8å¹¶å‘æ–°ç‰¹æ€§   (!(Thread.currentThread().getName().equals(\u0026quot;main\u0026quot;)))  åªèƒ½ä½¿ç”¨IDEAè‡ªå¸¦çš„Debugger\nReference:\n","description":"IDEAå®ç”¨çš„æ’ä»¶åˆ—è¡¨","id":18,"section":"talks","tags":["IDEA"],"title":"IDEAå®ç”¨çš„æ’ä»¶åˆ—è¡¨","uri":"https://hugo.jiahongw.com/zh/talks/idea-plugins/"},{"content":"å®‰è£…æ›´æ–°å¸è½½ å‚è€ƒï¼šhttps://nvchad.github.io/getting-started/setup\nå‚è€ƒæŒ‡ä»¤ å‚è€ƒï¼šhttps://neovim.io/doc/user/quickref.html\nè‡ªå®šä¹‰ è‡ªå®šä¹‰éœ€è¦åœ¨ç›®å½•lua/custom/,é˜²æ­¢åœ¨æ›´æ–°çš„æ—¶å€™è¦†ç›–äº†ã€‚\nä¸€å¼€å§‹è¯¥ç›®å½•åªæœ‰ä¸‹é¢ä¸¤ä¸ªæ–‡ä»¶ï¼š\nè¦æ ¹æ®æ‚¨çš„éœ€è¦å¼€å§‹è®¾ç½® NvChadï¼Œè¯·å¤åˆ¶è¿™äº›æ¨¡æ¿æ–‡ä»¶ï¼š\n1 2  cp example_init.lua init.lua cp example_chadrc.lua chadrc.lua    custom/init.lua åœ¨ NeoVim è®¾ç½®æœŸé—´è¿è¡Œï¼Œè¿™æ˜¯ä¸€ç§è¿è¡Œé€šç”¨ä»£ç å¹¶è¿è¡Œå¤§é‡ NvChad ä¿®æ”¹çš„æ–¹æ³• custom/chadrc.luaç”¨äºè¦†ç›–core/default_config.luaï¼Œæ‚¨åªéœ€è¦åŒ…å«æ‚¨å¸Œæœ›ä»é»˜è®¤æ–‡ä»¶æ›´æ”¹çš„å€¼  åˆ‡æ¢ä¸»é¢˜ \u0026lt;leader\u0026gt; + th\nLuaç¬”è®° ç¼–è¯‘å™¨ä½¿ç”¨IDEA + EmmyLuaæ’ä»¶\nè¾“å‡ºå’Œè¯„è®º 1 2  -- a comment print(\u0026#34;hi\u0026#34;) -- another comment   å˜é‡çš„å®šä¹‰ 1 2 3 4 5  -- Different types local x = 10 -- number local name = \u0026#34;Sid\u0026#34; -- string local isAlive = true -- boolean local a = nil --no value or invalid value   localçš„ä½œç”¨åŸŸåªåœ¨å½“å‰çš„å‡½æ•°å†…ï¼Œåœ¨å¤–éƒ¨çš„è¯å°±æ˜¯æ–‡ä»¶å†…ã€‚\nå­—ç¬¦ä¸²æ“ä½œ 1 2 3 4 5 6 7 8  -- å­—ç¬¦ä¸²æ‹¼æ¥ local name_first = \u0026#34;Victor\u0026#34; local name_Second = \u0026#34;Hong\u0026#34; print(name_first .. name_Second) -- å¤šä¸ªå­—ç¬¦ä¸²æ‹¼æ¥ print(name_first .. \u0026#34;and\u0026#34; .. name_Second)   è¾“å‡ºä¸ºï¼š\nVictorHong VictorandHong æ¯”è¾ƒåˆ¤æ–­ å¤šäº†ä¸€ä¸ªä¸ç­‰çš„ç¬¦å·~= ,å…¶ä»–çš„å’Œå…¶ä»–è¯­è¨€ä¸€æ ·ã€‚\n å¦å¤–ï¼Œä½¿ç”¨notè¡¨ç¤º!ï¼Œå¸¸åœ¨æ¡ä»¶åˆ¤æ–­è¯­å¥ä½¿ç”¨ã€‚\n æ¡ä»¶åˆ¤æ–­è¯­æ³• ç±»ä¼¼shellè¯­è¨€ï¼Œæ¡ä»¶åˆ¤æ–­è¯­å¥ä¸éœ€è¦èŠ±æ‹¬å·ï¼Œä½†æ˜¯å¢åŠ äº†ä¸¤ä¸ªå…³é”®å­—thenå’Œend\nä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  -- number comparisions local age = 10 if age \u0026gt; 18 then print(\u0026#34;over 18\u0026#34;) -- this will not be executed end -- elseif and else age = 20 if age \u0026gt; 18 then print(\u0026#34;over 18\u0026#34;) elseif age == 18 then print(\u0026#34;18 huh\u0026#34;) else print(\u0026#34;kiddo\u0026#34;) end   å¤åˆåˆ¤æ–­è¯­å¥ï¼š\n1 2 3 4 5 6 7 8 9  local age = 22 if age == 10 and x \u0026gt; 0 then -- both should be true print(\u0026#34;kiddo!\u0026#34;) elseif x == 18 or x \u0026gt; 18 then -- 1 or more are true print(\u0026#34;over 18\u0026#34;) end --result: over 18   å‡½æ•° å‡½æ•°å®šä¹‰ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  function num(a) print(a) end -- or local num = function(a) print(a) end -- å¤šå‚æ•°å‡½æ•°å®šä¹‰ function sum(a,b) local result = a + b print(result) end   å‡½æ•°è°ƒç”¨ï¼š\n1 2  num(5) sum(2,3)   å¾ªç¯ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  -- while loop local i = 0 while i \u0026lt;= 3 do print(\u0026#34;hi\u0026#34;) i = i + 1 end OR --for loop for i = 0, 3 do print(\u0026#34;hi\u0026#34;) i = i + 1 end -- result hi hi hi   tablesï¼ˆæ•°ç»„ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  -- basic table local colors = { \u0026#34;red\u0026#34;, \u0026#34;green\u0026#34;, \u0026#34;blue\u0026#34; } print(colors[1]) --red print(colors[2]) --green print(colors[3]) --blue -- use a loop to iterate though the table for i=1, #colors do print(colors[i]) end --tables within tables local data = { { \u0026#34;billy\u0026#34;, 12 }, { \u0026#34;john\u0026#34;, 20 }, } for i = 1, #data do print(data[i][1] .. \u0026#34;is \u0026#34; .. data[i][2] .. \u0026#34;years old\u0026#34;) end   æ¨¡å— ä½¿ç”¨æ¨¡å—\n1 2  require(\u0026#34;otherfile\u0026#34;)   è‡ªå®šé…ç½® ç›®å½•æ ‘ï¼š\nNvchadçš„é…ç½®ç›®å½•ä¸‹æœ‰ä¸€ä¸ª lua æ–‡ä»¶å¤¹å’Œä¸€ä¸ª init.lua æ–‡ä»¶ï¼Œ è€Œ init.lua ä¸»è¦åŠ è½½æ ¸å¿ƒçš„é…ç½®ã€‚\nå‡å¦‚ä½ åœ¨ chadir ç›®å½•ä¸‹æœ‰ä¸€ä¸ªè‡ªå®šä¹‰æ–‡ä»¶ test.lua ,ä½ å¯ä»¥åœ¨ init.lua æ–‡ä»¶ä¸­åŠ è½½ä½¿ç”¨å®ƒï¼š\n1  require(\u0026#34;chadir.test\u0026#34;) or require \u0026#34;chadir.test\u0026#34;.   ä½ ä¹Ÿå¯ä»¥å°† test.lua é‡å‘½åä¸º init.lua ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ç›´æ¥ï¼š\n1 2  require \u0026#34;chadir\u0026#34;. -- which calls the init.lua present in the chadir   é¢œè‰² é¢œè‰²é…ç½®ç›®å½• lua/colors/ ,è¯¥ç›®å½•æœ‰ä¸¤ä¸ªæ–‡ä»¶ init.lua å’Œ highlight.lua ,ä¸»é¢˜æ˜¯ç”¨nvim-base16.lua æ’ä»¶å®Œæˆçš„.\nä½¿ç”¨ ç©ºæ ¼ + thæ›´æ¢ä¸»é¢˜ã€‚\ncustomé…ç½® æ·»åŠ æ’ä»¶ï¼Œåœ¨ custom/init.lua å–æ¶ˆæ³¨é‡ŠåŒ…å«â€œinstall_pluginsâ€å†…å®¹çš„ hooks.add è¡Œ,æ·»åŠ ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12  hooks.add(\u0026#34;install_plugins\u0026#34;, function(use) use { \u0026#34;folke/which-key.nvim\u0026#34; event = \u0026#34;something\u0026#34;, config = function() require(\u0026#34;custom.plugin_confs.whichkey\u0026#34;) end } end) -- so the path of the config here basically is in the custom/plugin_confs/whichkey.lua   ç„¶åä½¿ç”¨ :PackSync è¿›è¡ŒåŒæ­¥\næ·»åŠ Markdowné¢„è§ˆæ’ä»¶ï¼š\n1 2 3 4 5  hooks.add(\u0026#34;install_plugins\u0026#34;, function(use) use { \u0026#34;davidgranstrom/nvim-markdown-preview\u0026#34;, }   ç›¸å…³æ’ä»¶çš„ä½¿ç”¨ æ–‡ä»¶æµè§ˆå™¨ï¼š kyazdani42/nvim-tree.lua: A file explorer tree for neovim written in lua\nè§¦å‘æ¡ä»¶ï¼š:NvimTreeToggle æˆ–è€… Ctrl + n\nåˆ·æ–°æ–‡ä»¶æ ‘ï¼š:NvimTreeRefresh æˆ–è€… \u0026lt;leader\u0026gt;r\nå¯»æ‰¾æ–‡ä»¶ï¼š:NvimTreeFindFile æˆ–è€… \u0026lt;leader\u0026gt;n\né”®å…¥så°†ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„è½¯ä»¶æ‰“å¼€æ–‡ä»¶ï¼ŒCtrl+tå°†åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€\nReference:\n NvChad  ","description":"","id":19,"section":"posts","tags":["Nvchad","nvim","vim"],"title":"Nvchadä½¿ç”¨","uri":"https://hugo.jiahongw.com/zh/posts/efficient/nvchad%E4%BD%BF%E7%94%A8/"},{"content":" å½“æˆ‘ä»¬ä½¿ç”¨newåˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªå…·ä½“ç±»ï¼Œè¿™å°±æ˜¯é’ˆå¯¹å®ç°è¿›è¡Œç¼–ç¨‹ã€‚å½“æˆ‘ä»¬å°†åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹å°è£…æˆä¸€ä¸ªæ–¹æ³•æˆ–è€…æ¥å£çš„æ—¶å€™ï¼Œå°±å¯ä»¥é¿å…é’ˆå¯¹å®ç°ç¼–ç¨‹ï¼Œå˜æˆé’ˆå¯¹æ¥å£ç¼–ç¨‹ã€‚\n é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œå¯ä»¥éš”ç¦»æ‰ä»¥åç³»ç»Ÿå¯èƒ½å‘ç”Ÿçš„ä¸€å¤§å †æ”¹å˜ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\n é€šè¿‡å¤šæ€ï¼Œå¯ä»¥è®©ä»»ä½•å®ç°ç±»å®ç°æ”¹æ¥å£ã€‚ ç„¶åæ›¿æ¢æ‰ä½ åŸæ¥çš„å®ç°ã€‚   å¯¹æ‹“å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚\n å®šä¹‰ å·¥å‚æ–¹æ³•æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œä½†ç”±å­ç±»å†³å®šè¦å®ä¾‹åŒ–çš„ç±»æ˜¯å“ªä¸€ä¸ªã€‚å·¥å‚æ–¹æ³•å°†å®ä¾‹åŒ–æ¨è¿Ÿåˆ°å­ç±»ã€‚\n æ ¸å¿ƒåœ¨å°†åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹è§£è€¦å‡ºæ¥ã€‚\n æ¶æ„ @startuml interface Product class ConcreteProduct implements Product abstract class Creator { * factoryMethod() + anyOperation() } class ConcreteCreator extends Creator { * factoryMethod() + anyOperation() } note top of Creator: Creatoræ˜¯ä¸€ä¸ªç±»ï¼Œå®ç°æ‰€æœ‰æ“ä½œäº§å“çš„æ–¹æ³•ï¼Œä½†æ˜¯ä¸å®ç°å·¥å‚æ–¹æ³• note bottom of ConcreteProduct: æ‰€æœ‰äº§å“å¿…é¡»å®ç°å…±åŒæ¥å£ note bottom of ConcreteCreator: å®ç°å·¥å‚æ–¹æ³•ï¼Œä»¥å®é™…åˆ¶é€ å‡ºäº§å“ ConcreteProduct \u0026lt;-r- ConcreteCreator @enduml å·¥å‚æ¨¡å¼ä½“ç°äº†ä¸€ä¸ªåŸåˆ™ï¼šä¾èµ–å€’ç½®åŸåˆ™ã€‚ï¼ˆSpringå«ä¾èµ–åè½¬ï¼‰\n åŸæ¥ä¾èµ–å…·ä½“ç±»ï¼Œç°åœ¨ä¾èµ–ä¸€ä¸ªæŠ½è±¡çš„æ¥å£ã€‚\n @startuml abstract class \u0026quot;æŠ½è±¡æ¥å£ç±»\u0026quot; as abstractClass { } class \u0026quot;å®ç°ç±»A\u0026quot; extends abstractClass class \u0026quot;å®ç°ç±»B\u0026quot; extends abstractClass class \u0026quot;å®ç°ç±»C\u0026quot; extends abstractClass class \u0026quot;Factory\u0026quot; as factory factory --\u0026gt; abstractClass @enduml Key:\n å·¥å‚åªæœ‰ä¸€ä¸ªåŠŸèƒ½â€”â€”åˆ›å»ºæŒ‡å®šçš„ç±»ã€‚ï¼ˆå•ä¸€èŒè´£ï¼‰ å°†åŸæ¥çš„if-elseåˆ¤æ–­ï¼Œè½¬æ¢æˆå¯¹è±¡è¿›è¡Œå¤„ç†ã€‚ æŠ½è±¡æˆä¸€ä¸ªæ–¹æ³• -ã€‹ æŠ½è±¡æˆä¸€ä¸ªç±» -ã€‰ æŠ½è±¡æˆä¸€ä¸ªæ¥å£  æŠ½è±¡å·¥å‚æ¨¡å¼ å®šä¹‰ï¼šæŠ½è±¡å·¥å‚æ¨¡å¼æä¾›ä¸€ä¸ªæ¥å£ï¼Œç”¨äºåˆ›å»ºç›¸å…³æˆ–è€…ä¾èµ–å¯¹è±¡çš„å®¶æ—ï¼Œè€Œä¸éœ€è¦æ˜ç¡®æŒ‡å®šå…·ä½“ç±»ã€‚\næ¶æ„ï¼š\nclassDiagram class AbstractFactory { \u0026lt;\u0026lt;interface\u0026gt;\u0026gt; + createProductA() + createProductB() } class ConcreteFactoory1 { + createProductA() + createProductB() } class ConcreteFactoory2 { + createProductA() + createProductB() } class AbstractProductA { \u0026lt;\u0026lt;interface\u0026gt;\u0026gt; } class ProducttA1 class ProducttA2 ProducttA1 ..|\u0026gt; AbstractProductA : å®ç° ProducttA2 ..|\u0026gt; AbstractProductA : å®ç° class AbstractProductB { \u0026lt;\u0026lt;interface\u0026gt;\u0026gt; } class ProducttB1 class ProducttB2 ProducttB1 ..|\u0026gt; AbstractProductB : å®ç° ProducttB2 ..|\u0026gt; AbstractProductB : å®ç° AbstractFactory \u0026lt;|.. ConcreteFactoory1 : å®ç° AbstractFactory \u0026lt;|.. ConcreteFactoory2 : å®ç° ConcreteFactoory1 --\u0026gt;ProducttA1 : åˆ›å»º ConcreteFactoory1 --\u0026gt;ProducttB1 : åˆ›å»º ConcreteFactoory2 --\u0026gt;ProducttA2 : åˆ›å»º ConcreteFactoory2 --\u0026gt;ProducttB2 : åˆ›å»º æŠ½è±¡å·¥å‚æ¨¡å¼ç±»ä¼¼äºä¸€ä¸ªäºŒç»´çš„åˆ†ç±»ï¼Œå°†æ›´åŠ å¤æ‚çš„ç³»ç»Ÿè¿›è¡Œæ•´ç†å¹¶ä¸”åˆ’åˆ†ã€‚ä»¥è¾¾åˆ°è§£è€¦çš„æ•ˆæœã€‚\nä¸€ä¸ªæŠ«è¨å•†åº—çš„ä¾‹å­ï¼Œå¯ä»¥å¾ˆæ¸…æ™°çš„è§£é‡Šè¿™ç§æ¶æ„ï¼š\nclassDiagram class PizzaIngredientFactory { \u0026lt;\u0026lt;interface\u0026gt;\u0026gt; + createDough() + createSauce() + createCheese() + createVeggies() + createPepperoni() + createCalm() } class NYPizzaIngredientFactory { + createDough() + createSauce() + createCheese() + createVeggies() + createPepperoni() + createCalm() } class ChicagoPizzaIngredientFactory { + createDough() + createSauce() + createCheese() + createVeggies() + createPepperoni() + createCalm() } PizzaIngredientFactory \u0026lt;|.. NYPizzaIngredientFactory PizzaIngredientFactory \u0026lt;|.. ChicagoPizzaIngredientFactory class Dough { \u0026lt;\u0026lt;interface\u0026gt;\u0026gt; } class ThickCrustDough class ThinCrustDough ThickCrustDough ..|\u0026gt; Dough ThinCrustDough ..|\u0026gt; Dough class Sauce { \u0026lt;\u0026lt;interface\u0026gt;\u0026gt; } class PlumTomatoSauce class MarinaraSauce PlumTomatoSauce ..|\u0026gt; Sauce MarinaraSauce ..|\u0026gt; Sauce class Cheese { \u0026lt;\u0026lt;interface\u0026gt;\u0026gt; } class MozzarellaCheese class ReggianoCheese MozzarellaCheese ..|\u0026gt; Cheese ReggianoCheese ..|\u0026gt; Cheese class Clams { \u0026lt;\u0026lt;interface\u0026gt;\u0026gt; } class FrozenClams class FreshClams FrozenClams ..|\u0026gt; Clams FreshClams ..|\u0026gt; Clams ChicagoPizzaIngredientFactory --\u0026gt; ThickCrustDough ChicagoPizzaIngredientFactory --\u0026gt; PlumTomatoSauce ChicagoPizzaIngredientFactory --\u0026gt; MozzarellaCheese ChicagoPizzaIngredientFactory --\u0026gt; FrozenClams NYPizzaIngredientFactory --\u0026gt; ThinCrustDough NYPizzaIngredientFactory --\u0026gt; MarinaraSauce NYPizzaIngredientFactory --\u0026gt; ReggianoCheese NYPizzaIngredientFactory --\u0026gt; FreshClams å·¥å‚æ–¹æ³•å°±éšå«åœ¨æŠ½è±¡å·¥å‚é‡Œé¢ã€‚\né—®é¢˜   ä»€ä¹ˆæ˜¯é™æ€å·¥å‚æ–¹æ³•ï¼Œå’Œé™æ€å·¥å‚æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\né™æ€å·¥å‚æ–¹æ³•æœ‰ä¸éœ€è¦åˆ›å»ºå¯¹è±¡å°±èƒ½å¤Ÿè°ƒç”¨é™æ€æ–¹æ³•çš„ä¼˜åŠ¿ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¯ä¸èƒ½é€šè¿‡ç»§æ‰¿æ¥æ”¹å˜åˆ›å»ºçš„æ–¹æ³•ã€‚\n  Reference:\n Factory Design Pattern in Java - JournalDev  ","description":"ç›¸å¯¹äºç›´æ¥newæ¥åˆ›å»ºå¯¹è±¡ï¼Œç”¨å·¥å‚æ¨¡å¼æ¥åˆ›å»ºç©¶ç«Ÿæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ","id":20,"section":"posts","tags":["è®¾è®¡æ¨¡å¼","å·¥å‚æ–¹æ³•","æŠ½è±¡å·¥å‚","ç®€å•å·¥å‚"],"title":"å·¥å‚æ–¹æ³•æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/factorymethodpattern/"},{"content":"ä»€ä¹ˆæ˜¯å•ä¾‹ å•ä¾‹è®¾è®¡æ¨¡å¼ï¼ˆSingleton Design Patternï¼‰ç†è§£èµ·æ¥éå¸¸ç®€å•ã€‚ä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ˆæˆ–è€…å®ä¾‹ï¼‰ï¼Œé‚£è¿™ä¸ªç±»å°±æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œè¿™ç§è®¾è®¡æ¨¡å¼å°±å«ä½œå•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œç®€ç§°å•ä¾‹æ¨¡å¼ã€‚\nä¸ºä»€ä¹ˆä½¿ç”¨å•ä¾‹ åŒä¸€ä¸ªç±»åˆ›å»ºäº†å¤šä¸ªå¯¹è±¡ï¼Œç„¶åå¹²çš„äº‹æƒ…æ˜¯ä¸€æ ·çš„ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è¿˜éœ€è¦è€ƒè™‘çº¿ç¨‹åŒæ­¥ã€‚è€Œå•ä¾‹æ¨¡å¼ï¼š\n ä¸ç”¨åˆ›å»ºé‚£ä¹ˆå¤šLoggerå¯¹è±¡ï¼Œä¸€æ–¹é¢èŠ‚çœå†…å­˜ç©ºé—´ã€‚ å¦ä¸€æ–¹é¢èŠ‚çœç³»ç»Ÿæ–‡ä»¶å¥æŸ„ã€‚  å•ä¾‹åŠ é”çš„æ—¶å€™åªéœ€è¦æ·»åŠ å¯¹è±¡é”å³å¯ï¼Œä¸ç”¨åƒä¹‹å‰ä½¿ç”¨ç±»é”ã€‚\n ä»ä¸šåŠ¡æ¦‚å¿µä¸Šï¼Œå¦‚æœæœ‰äº›æ•°æ®åœ¨ç³»ç»Ÿä¸­åªåº”ä¿å­˜ä¸€ä»½ï¼Œé‚£å°±æ¯”è¾ƒé€‚åˆè®¾è®¡ä¸ºå•ä¾‹ç±»ã€‚\n å¦å¤–ä¸€ç§ä½¿ç”¨åœºæ™¯æ˜¯éœ€è¦ä¸€ä¸ªå…¨å±€å”¯ä¸€ç±»ï¼Œæ¯”å¦‚é…ç½®ä¿¡æ¯ç±»ï¼Œå”¯ä¸€é€’å¢IDå·ç ç”Ÿæˆå™¨ã€‚\nå•ä¾‹çš„å®ç° å„ç§å•ä¾‹æ¨¡å¼çš„å®ç°å¦‚ä¸‹ï¼š\n  é¥¿æ±‰å•ä¾‹\ninstanceçš„åˆ›å»ºè¿‡ç¨‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†æ˜¯ä¸æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œå› ä¸ºåœ¨ç±»åˆ›å»ºçš„æ—¶å€™å°±å°†å•ä¾‹åˆ›å»ºäº†ã€‚\n  æ‡’æ±‰å•ä¾‹ï¼ˆæ”¯æŒå»¶è¿ŸåŠ è½½ï¼‰\n  é™æ€é˜»å¡åˆå§‹åŒ–å•ä¾‹\n  çº¿ç¨‹å®‰å…¨å•ä¾‹ï¼ˆå¹¶å‘åº¦ä½ï¼‰\n  åŒé‡æ£€æµ‹å•ä¾‹ï¼ˆæ”¯æŒé«˜å¹¶å‘å’Œå»¶è¿ŸåŠ è½½ï¼‰\n  å†…éƒ¨é™æ€ç±»å•ä¾‹ï¼ˆæ—¢ä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼Œåˆèƒ½åšåˆ°å»¶è¿ŸåŠ è½½ï¼‰\n  Enum å•ä¾‹\n  åºåˆ—åŒ–å•ä¾‹\n  Codeï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178  package com.sankuai.stafftraining.wujiahong.demo.springdemo.designpattern.creational; import java.io.Serializable; /** * å•ä¾‹æ¨¡å¼ */ public class SingletonPattern { public static void main(String[] args) { // Enum å•ä¾‹æ¨¡å¼ä½¿ç”¨  String myField = \u0026#34;Singleton\u0026#34;; EnumSingleton.INSTANCE.setField(myField); System.out.println(EnumSingleton.INSTANCE.getField()); } /** * 1.é¥¿æ±‰å•ä¾‹æ¨¡å¼ è¿™æ ·çš„å®ç°æ–¹å¼ä¸æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ˆåœ¨çœŸæ­£ç”¨åˆ°IdGeneratorçš„æ—¶å€™ï¼Œå†åˆ›å»ºå®ä¾‹ï¼‰ */ static class SingletonV1 { private static SingletonV1 instance = new SingletonV1(); private SingletonV1() { } public static SingletonV1 getInstance() { return instance; } } /** * 2.æ‡’æ±‰å•ä¾‹æ¨¡å¼ */ static class SingletonV2 { private static SingletonV2 instance; private SingletonV2() { } public static SingletonV2 getInstance() { if (instance == null) { instance = new SingletonV2(); } return instance; } } /** * 3.é™æ€é˜»å¡åˆå§‹åŒ– */ static class SingletonV3 { private static SingletonV3 instance; private SingletonV3() { } static { try { instance = new SingletonV3(); } catch (Exception e) { throw new RuntimeException(\u0026#34;Exception occured in creating singleton instance\u0026#34;); } } public static SingletonV3 getInstance() { return instance; } } /** * çº¿ç¨‹å®‰å…¨å•ä¾‹ */ static class SingletonV4 { private static SingletonV4 instance; private SingletonV4() { } public static synchronized SingletonV4 getInstance() { if (instance == null) { instance = new SingletonV4(); } return instance; } } /** * åŒé‡æ£€æŸ¥å¹¶ä¸”åŠ é”é¿å…é¢å¤–çš„å¼€é”€ */ static class SingletonV5 { private static SingletonV5 instance; private SingletonV5() { } public static SingletonV5 getInstance() { if (instance == null) { // åªæœ‰åœ¨ç¬¬ä¸€æ¬¡åˆ›å»ºå¯¹è±¡çš„æ—¶å€™æ‰ä¼šè¿›è¡ŒåŒæ­¥é”å®šï¼Œå…¶ä»–æƒ…å†µä¸éœ€è¦ï¼Œæé«˜äº†æ€§èƒ½  synchronized (SingletonV5.class) { if (instance == null) { instance = new SingletonV5(); } } } return instance; } } /** * å†…éƒ¨é™æ€ç±»å•ä¾‹æ¨¡å¼,ä¸éœ€è¦åŒæ­¥ */ static class SingletonV6 { private SingletonV6() { } private static class SingletonHelper { private static final SingletonV6 INSTANCE = new SingletonV6(); } public SingletonV6 getInstance() { return SingletonHelper.INSTANCE; } } /** * Enum å•ä¾‹æ¨¡å¼ */ public enum EnumSingleton { INSTANCE; private String field; public String getField() { return field; } public void setField(String field) { this.field = field; } } /** * åºåˆ—åŒ–å•ä¾‹æ¨¡å¼ */ static class SerializedSingleton implements Serializable { private static final long serialVersionUID = -7604766932017737115L; private SerializedSingleton() { } private static class SingletonHelper { private static final SerializedSingleton instance = new SerializedSingleton(); } public static SerializedSingleton getInstance() { return SingletonHelper.instance; } protected Object readResolve() { return getInstance(); } } }    question â“\n  ä¸ºä»€ä¹ˆä½¿ç”¨åŒæ£€é”ï¼Ÿ\né¿å…é¢å¤–çš„å¼€é”€ã€‚åœ¨ä¸¤æ¬¡åˆ¤æ–­instanceæ˜¯å¦ä¸ºnullçš„ä¸­é—´åŠ å…¥synchronizedå…³é”®å­—ï¼Œå°†synchronizeçš„è¿”å›ä»æ•´ä¸ªæ–¹æ³•é™åˆ°åˆ¤æ–­é‡Œé¢ã€‚\n    å•ä¾‹çš„é—®é¢˜   å¯¹OOPå¯¹è±¡ä¸å‹å¥½\nå°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€æŠ½è±¡è¿™äº›é¢å‘å¯¹è±¡çš„çš„ç‰¹æ€§ï¼Œå•ä¾‹è¿™ç§è®¾è®¡æ¨¡å¼å¯¹äºå…¶ä¸­çš„æŠ½è±¡ã€ç»§æ‰¿ã€å¤šæ€éƒ½æ”¯æŒå¾—ä¸å¥½ã€‚\n  éšè—å­ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»\næ„é€ å‡½æ•°æ˜¯privateçš„ï¼Œå› ä¸ºä¸èƒ½å¤Ÿæ˜¾ç¤ºçš„åœ¨å¤–éƒ¨è°ƒç”¨æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸çŸ¥é“å•ä¾‹é“åˆ°åº•éœ€è¦ä¾èµ–é‚£äº›ä¸œè¥¿ã€‚å¦‚æœä»£ç æ¯”è¾ƒå¤æ‚ï¼Œè¿™ç§è°ƒç”¨å…³ç³»å°±ä¼šéå¸¸éšè”½ã€‚\n  å¯¹æ‹“å±•ä¸å¥½\nå•ä¾‹åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœåé¢éœ€è¦åˆ›å»ºå¤šä¸ªå®ä¾‹ï¼Œå°±éœ€è¦å¯¹ä»£ç æœ‰è¾ƒå¤§çš„æ”¹åŠ¨ã€‚ï¼ˆå¸¸å¸¸åœ¨å¤šçº¿ç¨‹å¹¶å‘çš„æƒ…å†µä¸‹æœ‰è¿™ç§éœ€æ±‚ï¼‰\n  å¯æµ‹è¯•æ€§ä¸å¥½\n  ä¸æ”¯æŒå¸¦å‚æ•°çš„æ„é€ å‡½æ•°\n ä½¿ç”¨è¾…åŠ©å‡½æ•°è¿›è¡Œset å°†å‚æ•°ä¸Šæ”¾è‡³getInstance ä½¿ç”¨å…¨å±€å˜é‡Config    å•ä¾‹çš„æ›¿ä»£æ–¹æ³•  é™æ€æ–¹æ³•ã€‚ å·¥å‚æ¨¡å¼ã€IOCå®¹å™¨ï¼ˆæ¯”å¦‚Spring IOCå®¹å™¨ï¼‰æ¥ä¿è¯ ç¨‹åºå‘˜è‡ªå·±ä¿è¯  ç†è§£å•ä¾‹çš„å”¯ä¸€æ€§ å”¯ä¸€çš„ç»´åº¦ï¼š\n  åŒä¸€çº¿ç¨‹å”¯ä¸€\n  åŒä¸€è¿›ç¨‹å”¯ä¸€\n  åˆ†å¸ƒå¼ç³»ç»Ÿå”¯ä¸€\nè¿›ç¨‹å†…å”¯ä¸€ï¼Œè¿›ç¨‹é—´ä¹Ÿå”¯ä¸€ã€‚\nå…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªå•ä¾‹å¯¹è±¡åºåˆ—åŒ–å¹¶å­˜å‚¨åˆ°å¤–éƒ¨å…±äº«å­˜å‚¨åŒºï¼ˆæ¯”å¦‚æ–‡ä»¶ï¼‰ã€‚è¿›ç¨‹åœ¨ä½¿ç”¨è¿™ä¸ªå•ä¾‹å¯¹è±¡çš„æ—¶å€™ï¼Œéœ€è¦å…ˆä»å¤–éƒ¨å…±äº«å­˜å‚¨åŒºä¸­å°†å®ƒè¯»å–åˆ°å†…å­˜ï¼Œå¹¶ååºåˆ—åŒ–æˆå¯¹è±¡ï¼Œç„¶åå†ä½¿ç”¨ï¼Œä½¿ç”¨å®Œæˆä¹‹åè¿˜éœ€è¦å†å­˜å‚¨å›å¤–éƒ¨å…±äº«å­˜å‚¨åŒºã€‚\nä¸ºäº†ä¿è¯ä»»ä½•æ—¶åˆ»ï¼Œåœ¨è¿›ç¨‹é—´éƒ½åªæœ‰ä¸€ä»½å¯¹è±¡å­˜åœ¨ï¼Œä¸€ä¸ªè¿›ç¨‹åœ¨è·å–åˆ°å¯¹è±¡ä¹‹åï¼Œéœ€è¦å¯¹å¯¹è±¡åŠ é”ï¼Œé¿å…å…¶ä»–è¿›ç¨‹å†å°†å…¶è·å–ã€‚åœ¨è¿›ç¨‹ä½¿ç”¨å®Œè¿™ä¸ªå¯¹è±¡ä¹‹åï¼Œè¿˜éœ€è¦æ˜¾å¼åœ°å°†å¯¹è±¡ä»å†…å­˜ä¸­åˆ é™¤ï¼Œå¹¶ä¸”é‡Šæ”¾å¯¹å¯¹è±¡çš„åŠ é”ã€‚\n  ä½¿ç”¨åœºæ™¯  çº¿ç¨‹æ±  ç¼“å­˜ å¯¹è¯æ¡† æ³¨å†Œè¡¨å¯¹è±¡ æ—¥å¿—å¯¹è±¡  Reference:\n å•ä¾‹è®¾è®¡æ¨¡å¼ 43 42 | å•ä¾‹æ¨¡å¼ï¼ˆä¸­ï¼‰ï¼šæˆ‘ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Ÿåˆæœ‰ä½•æ›¿ä»£æ–¹æ¡ˆï¼Ÿ Java Singleton Design Pattern Example Best Practices - JournalDev Design Patterns for Humans  ","description":"å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œ è®©ä½ èƒ½å¤Ÿä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œ å¹¶æä¾›ä¸€ä¸ªè®¿é—®è¯¥å®ä¾‹çš„å…¨å±€èŠ‚ç‚¹ã€‚","id":21,"section":"posts","tags":["è®¾è®¡æ¨¡å¼","å•ä¾‹æ¨¡å¼"],"title":"å•ä¾‹æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/singletonpattern/"},{"content":" å»ºé€ è€…æ¨¡å¼ä¹Ÿç§°ä¸ºç”Ÿæˆå™¨æ¨¡å¼æˆ–è€…Builderæ¨¡å¼ã€‚\n å»ºé€ è€…æ¨¡å¼ä¸»è¦æ˜¯ä¸ºäº†è§£å†³è°ƒç”¨æ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œå‚æ•°å¤ªå¤šï¼Œå¹¶ä¸”æœ‰ä¸€äº›æ˜¯å¯é€‰å‚æ•°ä¸å¡«çš„æƒ…å†µã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨å»ºé€ è€…æ¨¡å¼ä¼šæ›´åŠ çµæ´»ã€‚\næœ€ç®€å•çš„ä¸€ä¸ªæ¯”å–»å°±æ˜¯å»ºæˆ¿å­ï¼Œä¸€ä¸ªæˆ¿å­ç”±å¤šä¸ªç»„ä»¶ç»„æˆï¼Œå¯ä»¥æœ‰å¢™ã€é—¨ã€çª—æˆ·ã€å±‹é¡¶ã€åƒåœ¾æ¡¶ç­‰ç­‰ï¼Œä½†æ˜¯çª—å’Œåƒåœ¾æ¡¶éƒ½æ˜¯å¯é€‰çš„ï¼Œå»ºä¸€ä¸ªæˆ¿å­ä¸ä¸€å®šéœ€è¦ã€‚æ­¤æ—¶å‡å¦‚æˆ‘ä»¬è¦å°†æˆ¿å­è¿›è¡Œåˆ†ç±»æŠ½è±¡ï¼Œå­ç±»å°†ä¼šæ´¾ç”Ÿå‡ºå¤šç§ï¼Œéå¸¸å¤æ‚ã€‚è€Œå»ºé€ è€…æ¨¡å¼å°†å¯¹è±¡çš„å‚æ•°æ„é€ ä»ç±»ä¸­æŠ½ç¦»ï¼Œæ”¾åœ¨ä¸€ä¸ªç‹¬ç«‹çš„æ„å»ºå™¨é‡Œé¢ï¼Œå¯ä»¥è®©æˆ‘ä»¬æŒ‰éœ€æ„å»ºï¼Œæœ€åå†è¿”å›æˆ¿å­çš„å¯¹è±¡ã€‚\nä¸åŒç”Ÿæˆå™¨ä»¥ä¸åŒæ–¹å¼æ‰§è¡Œç›¸åŒçš„ä»»åŠ¡ã€‚\nä½¿ç”¨å»ºé€ è€…æ¨¡å¼çš„æ­¥éª¤ï¼š\n åœ¨ç±»çš„å†…éƒ¨æ–°å»ºä¸€ä¸ªé™æ€å…¬æœ‰ç±»Builderã€‚ Builderç±»ä¸­ä¿å­˜äº†å’ŒåŸæ¥çš„ç±»ä¸€æ ·çš„æˆå‘˜å˜é‡ï¼Œå¹¶ä¸”å®ä¹ çˆ±ä½ setteræ–¹æ³•ï¼Œè¿”å›å€¼æ˜¯Builderæœ¬èº«ã€‚ ç±»ä»…è®¾ç½®ä¸€ä¸ªç§æœ‰çš„æ„é€ å‡½æ•°ï¼Œå‚æ•°æ˜¯Builderç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚ æ–°å»ºä¸€ä¸ªBuilderï¼Œä½¿ç”¨Builderç±»ä¸­çš„ build å‡½æ•°è°ƒç”¨ç±»çš„æ„é€ å‡½æ•°ï¼Œè¿”å›å®ä¾‹ã€‚   ç”Ÿæˆå™¨æ¨¡å¼å»ºè®®å°†å¯¹è±¡æ„é€ ä»£ç ä»äº§å“ç±»ä¸­æŠ½å–å‡ºæ¥ï¼Œ å¹¶å°†å…¶æ”¾åœ¨ä¸€ä¸ªåä¸ºç”Ÿæˆå™¨çš„ç‹¬ç«‹å¯¹è±¡ä¸­ã€‚\n è¯¦ç»†çš„ä»£ç æ ·å­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79  package com.sankuai.stafftraining.wujiahong.demo.springdemo.designpattern.creational; import java.util.Optional; /** * å»ºé€ è€…æ¨¡å¼ï¼ˆç”Ÿæˆå™¨æ¨¡å¼ï½œBuilderæ¨¡å¼ï¼‰ */ public class BuilderPattern { /** * å¿…è¦å‚æ•° */ private Integer number; private String name; /** * å¯é€‰å‚æ•° ä½¿ç”¨Optionalä¿®é¥°å¯é€‰å‚æ•°ï¼Œä½†æ˜¯ä¸€å®šè¦è®¾ç½®åˆå§‹å€¼ */ private Optional\u0026lt;Integer\u0026gt; weight; private Optional\u0026lt;Integer\u0026gt; height; private BuilderPattern(Builder builder) { // å¤–éƒ¨ç±»å¯ä»¥ç›´æ¥è®¿é—®å†…éƒ¨ç±»çš„æ•°æ®  this.number = builder.number; this.name = builder.name; this.weight = builder.weight; this.height = builder.height; } @Override public String toString() { return \u0026#34;number = \u0026#34; + this.number + \u0026#34;\\nname = \u0026#34; + this.name + \u0026#34;\\nweight = \u0026#34; + ( this.weight.isPresent() ? weight.get() : \u0026#34;empty\u0026#34;) + \u0026#34;\\nheight = \u0026#34; + (this.height.isPresent() ? height.get() : \u0026#34;empty\u0026#34;); } public static class Builder { /** * å¿…è¦å‚æ•° */ private Integer number; private String name; /** * å¯é€‰å‚æ•° */ private Optional\u0026lt;Integer\u0026gt; weight; private Optional\u0026lt;Integer\u0026gt; height; public Builder(Integer number, String name) { this.number = number; this.name = name; this.weight = Optional.empty(); this.height = Optional.empty(); } public Builder weight(Integer weight) { this.weight = Optional.of(weight); return this; } public Builder height(Integer height) { this.height = Optional.of(height); return this; } public BuilderPattern build() { return new BuilderPattern(this); } } public static void main(String[] args) { Integer number = 101; String name = \u0026#34;Victor\u0026#34;; Integer height = 160; BuilderPattern builderPattern = new Builder(number,name).height(height).build(); System.out.println(builderPattern); } }   ä¼˜ç‚¹ï¼š\n ä½ å¯ä»¥åˆ†æ­¥åˆ›å»ºå¯¹è±¡ï¼Œ æš‚ç¼“åˆ›å»ºæ­¥éª¤æˆ–é€’å½’è¿è¡Œåˆ›å»ºæ­¥éª¤ã€‚ ç”Ÿæˆä¸åŒå½¢å¼çš„äº§å“æ—¶ï¼Œ ä½ å¯ä»¥å¤ç”¨ç›¸åŒçš„åˆ¶é€ ä»£ç ã€‚ å•ä¸€èŒè´£åŸåˆ™ã€‚ ä½ å¯ä»¥å°†å¤æ‚æ„é€ ä»£ç ä»äº§å“çš„ä¸šåŠ¡é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ã€‚ï¼ˆé¿å… â€œé‡å æ„é€ å‡½æ•° ï¼ˆtelescopic constructorï¼‰â€ çš„å‡ºç°ï¼‰  ç¼ºç‚¹ï¼š\n ç”±äºè¯¥æ¨¡å¼éœ€è¦æ–°å¢å¤šä¸ªç±»ï¼Œ å› æ­¤ä»£ç æ•´ä½“å¤æ‚ç¨‹åº¦ä¼šæœ‰æ‰€å¢åŠ ã€‚  å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«ï¼š\né¡¾å®¢èµ°è¿›ä¸€å®¶é¤é¦†ç‚¹é¤ï¼Œæˆ‘ä»¬åˆ©ç”¨å·¥å‚æ¨¡å¼ï¼Œæ ¹æ®ç”¨æˆ·ä¸åŒçš„é€‰æ‹©ï¼Œæ¥åˆ¶ä½œä¸åŒçš„é£Ÿç‰©ï¼Œæ¯”å¦‚æŠ«è¨ã€æ±‰å ¡ã€æ²™æ‹‰ã€‚å¯¹äºæŠ«è¨æ¥è¯´ï¼Œç”¨æˆ·åˆæœ‰å„ç§é…æ–™å¯ä»¥å®šåˆ¶ï¼Œæ¯”å¦‚å¥¶é…ªã€è¥¿çº¢æŸ¿ã€èµ·å¸ï¼Œæˆ‘ä»¬é€šè¿‡å»ºé€ è€…æ¨¡å¼æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„ä¸åŒé…æ–™æ¥åˆ¶ä½œæŠ«è¨ã€‚\n å»ºé€ è€…æ¨¡å¼å¯ä»¥è¿›è¡Œä¸€äº›ç‰¹æ®Šçš„ç»„åˆæ“ä½œï¼Œå…¶ä¸­ä¸€äº›å†…éƒ¨å¯¹è±¡å¯æœ‰ä¹Ÿå¯æ— ã€‚\n Reference:\n Effective-Java-3rd-edition-Chinese-English-bilingual/Chapter-2-Item-2-Consider-a-builder-when-faced-with-many-constructor-parameters.md at dev Â· clxering/Effective-Java-3rd-edition-Chinese-English-bilingual å»ºé€ è€…è®¾è®¡æ¨¡å¼ï¼ˆç”Ÿæˆå™¨æ¨¡å¼ï¼‰  ","description":"å»ºé€ è€…æ¨¡å¼ä¸»è¦æ˜¯ä¸ºäº†è§£å†³è°ƒç”¨æ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œå‚æ•°å¤ªå¤šï¼Œå¹¶ä¸”æœ‰ä¸€äº›æ˜¯å¯é€‰å‚æ•°ä¸å¡«çš„æƒ…å†µã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨å»ºé€ è€…æ¨¡å¼ä¼šæ›´åŠ çµæ´».","id":22,"section":"posts","tags":["è®¾è®¡æ¨¡å¼","å»ºé€ è€…æ¨¡å¼"],"title":"å»ºé€ è€…æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/builderpattern/"},{"content":" ä»€ä¹ˆæ˜¯è½¯ä»¶æ¶æ„ è½¯ä»¶æ¶æ„çš„ä¸‰ç§å®šä¹‰ï¼š\n ç»´åŸºç™¾ç§‘ï¼šè½¯ä»¶æ¶æ„å¯ä»¥å’Œå»ºç­‘ç‰©çš„æ¶æ„ç›¸æ¯”æ‹Ÿã€‚è½¯ä»¶æ¶æ„æ˜¯æ„å»ºè®¡ç®—æœºï¼Œå¼€å‘ç³»ç»Ÿä»¥åŠè®¡åˆ’è¿›è¡Œçš„åŸºç¡€ï¼Œå¯ä»¥åˆ—å‡ºå¼€å‘å›¢é˜Ÿçš„éœ€è¦å®Œæˆçš„ä»»åŠ¡ã€‚ IEEEï¼šæ¶æ„æ˜¯ç¯å¢ƒä¸­è¯¥ç³»ç»Ÿä¸€ç»„åŸºç¡€æ¦‚å¿µå’Œå±æ€§ï¼Œå…·ä½“è¡¨ç°æ˜¯å®ƒçš„å…ƒç´ ã€å…³ç³»ï¼Œä»¥åŠè®¾è®¡æ¼”è¿›çš„åŸºæœ¬åŸåˆ™ã€‚ ã€Šclean architectureã€‹ï¼šæ¶æ„æ˜¯åˆ›å»ºè€…ç»™äºˆè¯¥ç³»ç»Ÿçš„å½¢æ€ï¼ˆshapeï¼‰ã€‚è¿™ä¸ªå½¢æ€çš„å…·ä½“å½¢å¼æ¥æºäºå¯¹ç³»ç»Ÿç»„ä»¶ï¼ˆcomponentsï¼‰çš„åˆ’åˆ†å’Œæ’åˆ—ï¼Œä»¥åŠè¿™äº›ç»„ä»¶ä¹‹é—´äº’ç›¸é€šè®¯çš„æ–¹å¼ã€‚   æ¶æ„ä½“ç°çš„æ˜¯ä¸€ä¸ªæ•´ä½“çš„ç»“æ„ï¼Œä»¥åŠç»„ä»¶ï¼ˆå…ƒç´ ï¼‰ä¹‹é—´çš„å…³ç³»ã€‚\n è½¯ä»¶æ¶æ„çš„è¦ç´   å…ƒç´ ï¼šå°†ç³»ç»Ÿæ‹†åˆ†ä¸ºä¸€ç»„å…ƒç´ ï¼ˆæ¨¡å—ã€ç»„ä»¶ã€ç»“æ„ä½“ã€å­ç³»ç»Ÿï¼‰ å±æ€§ï¼šæ¯ä¸ªå…ƒç´ å…·å¤‡çš„å±æ€§ï¼ˆåç§°ã€èŒè´£ã€æ¥å£ã€å®ç°é™åˆ¶ç­‰ï¼‰ å…³ç³»ï¼šä¸åŒå…ƒç´ ä¹‹é—´çš„å…³ç³»ï¼ˆäº¤äº’ã€ä¾èµ–ã€ç»§æ‰¿ã€ç»„åˆã€èšåˆï¼‰ åŸç†ï¼šä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡ï¼ˆæ‹†åˆ†ä¾æ®ã€è®¾è®¡åŸåˆ™ã€å†³ç­–åŸå› ç­‰ï¼‰  æ¶æ„åŸŸåˆ†ç±»ï¼ˆTOGAFï¼‰ 4Aæ¶æ„\nä¸šåŠ¡æ¶æ„å›¾ï¼š\n å•†ä¸šæ¨¡å¼ç”»å¸ƒ ä¸šåŠ¡èƒ½åŠ›å›¾ ä»·å€¼æµ + ä¸šåŠ¡èƒ½åŠ› + çƒ­ç‚¹å›¾ ç”¨ä¾‹å›¾ ä»·å€¼é“¾å›¾ æµç¨‹å›¾  æ•°æ®æ¶æ„å›¾ï¼š\næ•°æ®åº“ï¼šESã€Redisã€MySQLã€Tail\nå…¶ä¸­ï¼š\n  ä¸šåŠ¡æ¶æ„æ˜¯è½¯ä»¶æ¶æ„çš„çµé­‚ã€‚æœ‰ä¸šåŠ¡æ¶æ„æ‰æœ‰æŠ€æœ¯æ¶æ„ã€‚\nä¸šåŠ¡æ¶æ„æ˜¯ä¸€ç§å¯¹ç»„ç»‡å¦‚ä½•åˆ©ç”¨å…¶åŸºæœ¬èƒ½åŠ›å®ç°å…¶æˆ˜ç•¥æ„å›¾å’Œç›®æ ‡çš„æ­£å¼æè¿°ã€‚\n  åº”ç”¨æ¶æ„æ˜¯ç³»ç»Ÿè®¾è®¡çš„é¡¶å±‚ã€‚\nåº”ç”¨æ¶æ„æ˜¯ä¸€ç»„åº”ç”¨ç³»ç»ŸåŠå…¶äº¤äº’å…³ç³»çš„æè¿°ï¼Œå…¶ä¸­çš„æ¯ä¸ªåº”ç”¨ç³»ç»Ÿéƒ½æ˜¯ä¸€ä¸ªé€»è¾‘åŠŸèƒ½ç»„ï¼Œç”¨äºæ”¯æ’‘ä¸šåŠ¡åŠŸèƒ½ã€ç®¡ç†æ•°æ®èµ„äº§ã€‚åªå…³æ³¨æ”¯æŒä¸šåŠ¡å’Œå¤„ç†æ•°æ®éœ€è¦é‚£äº›åº”ç”¨ç³»ç»Ÿï¼Œä¸å…³æ³¨åº”ç”¨æœ¬èº«çš„æ¶æ„å’Œå®ç°çš„æŠ€æœ¯ã€‚\n  æ•°æ®æ¶æ„æ˜¯æ•°æ®èµ„äº§ç®¡ç†è“å›¾ã€‚\næ•°æ®æ¶æ„å®šä¹‰äº†ç”¨æ¥æ”¯æŒä¸šåŠ¡çš„å„ç§æ•°æ®ï¼Œä»¥åŠä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå…³æ³¨ç‚¹æ˜¯æŒä¹…åŒ–æ•°æ®çš„ç»„ç»‡ã€‚å…³æ³¨ç‚¹åœ¨ï¼šç³»ç»Ÿéœ€è¦ä»€ä¹ˆæ•°æ®ã€æ•°æ®é—´æœ‰ä»€ä¹ˆå…³ç³»ã€å¦‚ä½•å­˜å‚¨è¿™äº›æ•°æ®\n  æŠ€æœ¯æ¶æ„æ˜¯æ¯”ç‰¹ä¸–ç•Œçš„å¸ƒå±€ã€‚\næŠ€æœ¯æ¶æ„æ˜¯å°†äº§å“éœ€æ±‚è½¬å˜ä¸ºæŠ€æœ¯å®ç°çš„è¿‡ç¨‹ã€‚å…³æ³¨ç‚¹åœ¨äºè¯†åˆ«æŠ€æœ¯éœ€æ±‚ã€æŠ€æœ¯é€‰å‹ã€éåŠŸèƒ½æ€§éœ€æ±‚è®¾è®¡ã€‚\n  æ¶æ„å¸ˆä¹Ÿåˆ†ä¸ºå¤šç§ï¼Œæœ‰ä¸šåŠ¡æ¶æ„å¸ˆå’ŒæŠ€æœ¯æ¶æ„å¸ˆã€‚åœ¨å¼€å‘ä¸€å¥—ç³»ç»Ÿçš„æ—¶å€™ï¼Œé¦–å…ˆæ˜¯ç”±å…¬å¸ç®¡ç†å±‚å®šä¸‹ä¸€ä¸ªæˆ˜ç•¥ï¼Œç„¶åä¸šåŠ¡æ¶æ„å¸ˆæ ¹æ®æˆ˜ç•¥ç»˜åˆ¶ä¸šåŠ¡æ¶æ„å›¾ï¼Œç„¶åæŠ€æœ¯æ¶æ„å¸ˆæ‹¿åˆ°ä¸šåŠ¡æ¶æ„å›¾ï¼Œè¿›è¡Œè¯†åˆ«æŠ€æœ¯éœ€æ±‚å’ŒæŠ€æœ¯é€‰å‹ï¼Œç¼–å†™å‡ºæŠ€æœ¯æ¶æ„å›¾ï¼Œè‹¥è¿˜æœ‰æ•°æ®æ¶æ„å¸ˆå’Œåº”ç”¨æ¶æ„å¸ˆï¼Œé‚£ä¹ˆä¹Ÿæ˜¯åœ¨æŠ€æœ¯æ¶æ„ç”Ÿæˆä¹‹å‰è¦è®¾è®¡ç›¸å…³çš„æ•°æ®æ¶æ„å’Œåº”ç”¨æ¶æ„ï¼Œæ€»ä¹‹ï¼ŒæŠ€æœ¯æ¶æ„æ€»æ˜¯åœ¨æœ€åä¸€æ­¥è¿›è¡Œè®¾è®¡ï¼Œè€Œä¸šåŠ¡æ¶æ„æ€»æ˜¯åœ¨å‰é¢è®¾è®¡ã€‚\nä¸ºä»€ä¹ˆéœ€è¦è½¯ä»¶æ¶æ„å›¾  ä¸¤ç§å¼€å‘æµç¨‹ï¼š\n ç€‘å¸ƒæµç¨‹ã€‚ è¿­ä»£æµç¨‹     æ¶æ„æ˜¯ç³»ç»Ÿå®ç°çš„è“å›¾ã€‚\n  æ¶æ„æ˜¯æ²Ÿé€šåä½œçš„æ¡¥æ¢ã€‚\n  æ¶æ„æ˜¯äº§å“è´¨é‡çš„åŸºç¡€ã€‚\n  é‡è¦åœ¨å“ªï¼š\n ä¿ƒè¿›åä½œ å¢å¼ºæ²Ÿé€š æç»˜æ„¿æ™¯ æä¾›æŒ‡å¯¼  æè¿°æ¶æ„çš„æ–¹å¼  æ–‡å­—ï¼ˆæ ‡å‡†ã€è¯¦å°½ã€æ˜“äºç‰ˆæœ¬ç®¡ç†ï¼‰ å›¾ï¼ˆç›´è§‚ã€å½¢è±¡ã€è¡¨è¾¾èƒ½åŠ›å¼ºï¼‰  å°½ç®¡äººä»¬æ—¥å¸¸çš„å·¥ä½œåœºæ‰€å¤§å¤šæ˜¯è¯­è¨€æ€§æˆ–éå›¾ç¤ºåŒ–çš„ï¼ˆå£è¯­ã€æ–‡å­—å’Œæ•°å­—ç­‰ï¼‰ï¼Œä½†äº‹å®ä¸Šäººè„‘çš„80%åŠŸèƒ½éƒ½æ˜¯ç”¨äºå¤„ç†è§†è§‰ä¿¡æ¯çš„ï¼Œäººä»¬å¯¹æ¥å—è§†è§‰ä¿¡æ¯å…·æœ‰å¤©ç”Ÿçš„æ•æ„Ÿåº¦ã€‚â€”â€”ç½—ä¼¯ç‰¹-è±ªæ©ã€ŠVisualLanguageã€‹\næœ€å¥½ä½¿ç”¨å›¾æ¥æè¿°æ¶æ„ã€‚\nå¦‚ä½•ç”»è½¯ä»¶æ¶æ„å›¾  â€œæ³•â€ï¼šæ¶æ„è®¾è®¡åŸåˆ™\u0026amp;æ¨¡å¼ â€œæœ¯â€ï¼šå¸¸ç”¨åˆ¶å›¾æ–¹æ³• â€œå™¨â€ï¼šå¸¸ç”¨åˆ¶å›¾å·¥å…· â€œé“â€ï¼šæ¶æ„åˆ¶å›¾æ–¹æ³•è®º  â€œæ³•â€ï¼šæ¶æ„è®¾è®¡åŸåˆ™\u0026amp;æ¨¡å¼  SOLIDåŸåˆ™ è®¾è®¡æ¨¡å¼åŸåˆ™ æ¶æ„æ¨¡å¼ï¼ˆC/Sæ¨¡å¼ã€ä¸»ä»æ¨¡å¼ã€ç®¡é“æ¨¡å¼ã€å¾®æœåŠ¡æ¨¡å¼ã€äº‘åŸç”Ÿæ¨¡å¼ï¼‰ è®¾è®¡æ¨¡å¼ï¼ˆè§‚å¯Ÿè€…æ¨¡å¼\u0026hellip;ï¼‰  å¸¸è§çš„æ¶æ„æ¨¡å¼è®¾è®¡å›¾ï¼š\nMVCæ¶æ„ï¼š\nåˆ†å±‚æ¶æ„ï¼š\nå¾®æœåŠ¡æ¶æ„ï¼š\næ´‹è‘±æ¶æ„ï¼š\nå¾®å†…æ ¸æ¶æ„ï¼š\nè¿˜æœ‰äº‹åŠ¡é©±åŠ¨æ¶æ„ã€äº‘åŒ–æ¶æ„ã€å…­è¾¹å½¢æ¶æ„ã€‚\nâ€œæœ¯â€ï¼šå¸¸ç”¨åˆ¶å›¾æ–¹æ³• UML ç»Ÿä¸€å»ºæ¨¡è¯­è¨€ï¼ˆUnified Modeling Languageï¼Œç¼©å†™UMLï¼‰æ˜¯ä¸€ç§ç”¨äºè¯´æ˜ã€å¯è§†åŒ–ã€æ„å»ºå’Œç¼–å†™ä¸€ä¸ªæ­£åœ¨å¼€å‘çš„ã€é¢å‘å¯¹è±¡çš„ã€è½¯ä»¶å¯†é›†ç³»ç»Ÿçš„åˆ¶å“çš„å¼€æ”¾æ–¹æ³•ã€‚UMLåœ¨å¯¹å¤§è§„æ¨¡ï¼Œå¤æ‚ç³»ç»Ÿè¿›è¡Œå»ºæ¨¡æ–¹é¢ï¼Œç‰¹åˆ«æ˜¯åœ¨è½¯ä»¶æ¶æ„å±‚æ¬¡å·²ç»è¢«éªŒè¯æœ‰æ•ˆã€‚\nä¸»è¦æ¨¡å‹ï¼š\n åŠŸèƒ½æ¨¡å‹ï¼šç”¨ä¾‹å›¾ å¯¹è±¡æ¨¡å‹ï¼šç±»å›¾ åŠ¨æ€æ¨¡å‹ï¼šæ—¶åºå›¾ã€æ´»åŠ¨å›¾ã€çŠ¶æ€å›¾   UMLçš„å­¦ä¹ æˆæœ¬æœ‰ç‚¹é«˜ã€‚\n 4+1ViewModel å“ªå››ä¸ªè§†å›¾ï¼Ÿ\n é€»è¾‘è§†å›¾ï¼šå…³æ³¨ç³»ç»Ÿæä¾›ç»™ç»ˆç«¯ç”¨æˆ·çš„åŠŸèƒ½ï¼Œä¸€èˆ¬ä¼šé€šè¿‡UMLä¸­çš„ç±»å›¾å’ŒçŠ¶æ€å›¾æ¥è¡¨ç¤º æµç¨‹è§†å›¾ï¼šå…³æ³¨ç³»ç»Ÿçš„åŠ¨æ€éƒ¨åˆ†ã€è¿è¡Œæ—¶è¡Œä¸ºï¼ŒåŒ…æ‹¬ç³»ç»Ÿçš„æ‰§è¡Œæµç¨‹å’Œäº¤äº’æ–¹å¼ï¼Œä¸€èˆ¬ä¼šé€šè¿‡UMLä¸­çš„æ—¶åºå›¾ã€æ´»åŠ¨å›¾å’Œé€šè®¯å›¾æ¥è¡¨ç¤ºã€‚ å¼€å‘è§†å›¾ï¼šä¹Ÿç§°ä¸ºå®ç°è§†å›¾ï¼Œä»¥ç¨‹åºå‘˜è§†è§’é˜è¿°ç³»ç»Ÿçš„ç»„ä»¶ç­‰ï¼Œä¸€èˆ¬ä¼šé€šè¿‡UMLä¸­çš„ç»„ä»¶å›¾å’ŒåŒ…å›¾æ¥è¡¨ç¤ºã€‚ ç‰©ç†è§†å›¾ï¼šä¹Ÿç§°ä¸ºéƒ¨ç½²è§†å›¾ï¼Œä»¥ç³»ç»Ÿå·¥ç¨‹å¸ˆè§’åº¦æè¿°ç³»ç»Ÿå„ç»„ä»¶åœ¨ç‰©ç†å±‚çš„æ‹“æ‰‘ï¼Œä¸€èˆ¬ä¼šé€šè¿‡UMLä¸­çš„éƒ¨ç½²å›¾æ¥è¡¨ç¤ºã€‚  å“ªä¸€ä¸ªåœºæ™¯ï¼Ÿ\nåœºæ™¯ï¼šä¹Ÿç§°ä¸ºç”¨ä¾‹è§†å›¾ï¼Œé€šè¿‡ä¸€ç»„ç”¨ä¾‹ï¼ˆåœºæ™¯ï¼‰æè¿°ç³»ç»Ÿä¸­å¯¹è±¡å’Œæµç¨‹ä¹‹é—´çš„äº¤äº’ä¸æ—¶åºã€‚\n å®é™…æ˜¯ä¸€ç§æ¨¡å‹ï¼Œä¸é™åˆ¶ä½¿ç”¨å“ªç§æ–¹æ³•å®ç°ã€‚\n C4Model   ç¬¬ 1 å±‚ï¼šç³»ç»Ÿä¸Šä¸‹æ–‡å›¾ï¼ˆSystem Context diagramï¼‰\nåœ¨è¿™ä¸€å±‚çº§ä¸­ç»†èŠ‚å¹¶ä¸é‡è¦ï¼Œåªéœ€è¦æ˜¾ç¤ºç³»ç»Ÿæ¦‚å†µã€‚ é‡ç‚¹åº”è¯¥æ”¾åœ¨äººå‘˜ï¼ˆè§’è‰²ï¼‰å’Œè½¯ä»¶ç³»ç»Ÿä¸Šï¼Œè€Œä¸æ˜¯æŠ€æœ¯ï¼Œåè®®å’Œå…¶ä»–ä½å±‚çº§ç»†èŠ‚ä¸Šï¼Œä»è€Œä½¿éæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½å¤Ÿçœ‹å¾—æ‡‚ã€‚è¿™ä¸ªå›¾ä¹Ÿæ˜¯æ˜ç¡®éœ€æ±‚çš„é‡è¦å›¾ç¤ºã€‚\n  ç¬¬ 2 å±‚ï¼šå®¹å™¨å›¾ï¼ˆContainer diagramï¼‰\nâ€œå®¹å™¨â€ç±»ä¼¼äºæœåŠ¡å™¨ç«¯Webåº”ç”¨ç¨‹åºï¼Œå•é¡µåº”ç”¨ç¨‹åºï¼Œæ¡Œé¢åº”ç”¨ç¨‹åºï¼Œç§»åŠ¨åº”ç”¨ç¨‹åºï¼Œæ•°æ®åº“æ¶æ„ï¼Œæ–‡ä»¶ç³»ç»Ÿç­‰ã€‚æœ¬è´¨ä¸Šï¼Œå®¹å™¨æ˜¯å¯å•ç‹¬è¿è¡Œ/å¯éƒ¨ç½²çš„å•å…ƒï¼ˆä¾‹å¦‚ï¼Œå•ç‹¬çš„è¿›ç¨‹ç©ºé—´ï¼‰ ï¼‰æ‰§è¡Œä»£ç æˆ–å­˜å‚¨æ•°æ®ã€‚å®¹å™¨å›¾æ˜¾ç¤ºäº†è½¯ä»¶ä½“ç³»ç»“æ„çš„é«˜å±‚ç»“æ„ä»¥åŠå¦‚ä½•åœ¨å…¶é—´åˆ†é…èŒè´£ã€‚ å®ƒè¿˜æ˜¾ç¤ºäº†ä¸»è¦çš„æŠ€æœ¯é€‰æ‹©ä»¥åŠå®¹å™¨ä¹‹é—´çš„é€šä¿¡æ–¹å¼ã€‚\n  ç¬¬ 3 å±‚ï¼šç»„ä»¶å›¾ï¼ˆComponent diagramï¼‰\nç»„ä»¶å›¾æ˜¾ç¤ºäº†å®¹å™¨å¦‚ä½•ç”±å¤šä¸ªâ€œç»„ä»¶â€ç»„æˆï¼Œæ¯ä¸ªç»„ä»¶æ˜¯ä»€ä¹ˆï¼Œå®ƒä»¬çš„èŒè´£ä»¥åŠæŠ€æœ¯/å®ç°æ¥å£ï¼ˆAPIï¼‰æˆ–è€…ç»†èŠ‚ã€‚\n  ç¬¬ 4å±‚ï¼šï¼ˆCodeï¼‰\nè¿™ä¸€å±‚æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥ä½¿ç”¨UMLç±»å›¾ï¼Œå®ä½“å…³ç³»å›¾æˆ–ç±»ä¼¼çš„å›¾ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œè¯¥å›¾å¯ä»¥ä½¿ç”¨å·¥å…·ï¼ˆä¾‹å¦‚IDEæˆ–UMLå»ºæ¨¡å·¥å…·ï¼‰è‡ªåŠ¨ç”Ÿæˆã€‚\n  å…³é”®æ€æƒ³ï¼š\n è‡ªé¡¶å‘ä¸‹å¯¹ç³»ç»Ÿçš„é™æ€ç»“æ„è¿›è¡Œé€çº§æ‹†åˆ†ï¼Œæè¿°å„å±‚æ¬¡å¯¹è±¡çš„èŒè´£ã€å…³ç³»å’Œå¤–éƒ¨ä¾èµ–ã€‚ å¯¹äºå…³é”®é“¾è·¯ï¼Œä½¿ç”¨åŠ¨æ€è§†å›¾æè¿°è¿è¡Œæ—¶çš„äº¤äº’è¡Œä¸ºå’Œæ—¶åºå…³ç³»ã€‚ é¢å‘éƒ¨ç½²å®æ–½ï¼Œä½¿ç”¨éƒ¨ç½²è§†å›¾æè¿°ç³»ç»Ÿé€»è¾‘èŠ‚ç‚¹ä¸ç‰©ç†èµ„æºä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚  â€œå™¨â€ï¼šå¸¸ç”¨åˆ¶å›¾å·¥å…· å¯è§†åŒ–åˆ¶å›¾å·¥å…·æœ‰è¿™äº›ï¼š\n draw.io ProcessOn Visio  ä»£ç åŒ–åˆ¶å›¾ï¼š\n PlantUML Structurizr Graphviz  â€œé“â€ï¼šæ¶æ„åˆ¶å›¾æ–¹æ³•è®º ä»€ä¹ˆæ˜¯ä¸€å¼ å¥½çš„æ¶æ„å›¾ï¼Ÿ\n å‡†ç¡®ï¼šé”™çš„å›¾æ¯”æ²¡æœ‰å›¾è¿˜ç³Ÿç³• å®Œæ•´ï¼šè¦†ç›–æ¶æ„çš„æ ¸å¿ƒè¦ç´ å’Œå…³é”®ä¿¡æ¯ æ¸…æ™°ï¼šæ¸…æ™°çš„å›¾ä¾‹ï¼ˆå½¢çŠ¶ã€é¢œè‰²ã€ç®­å¤´ï¼‰ã€æ ‡æ³¨ï¼ˆå†…éƒ¨ç³»ç»Ÿorå¤–éƒ¨ä¾èµ–ï¼‰ ä¸€è‡´ï¼šåŒä¸€ç±»å‹çš„å›¾ï¼Œä½¿ç”¨ç›¸åŒçš„è®°å·é£æ ¼ ç®€æ´ï¼šä¸è¦ä¼å›¾ç”¨ä¸€å¼ å›¾è®²æ¸…æ¥šæ‰€æœ‰ï¼ŒåŒ–ç¹ä¸ºç®€ï¼Œæ›´å®¹æ˜“è¢«ç†è§£  ","description":"å¦‚ä½•åšå¥½ç³»ç»Ÿè®¾è®¡ï¼Œæ¶æ„åˆ¶å›¾æ˜¯é‡è¦çš„ä¸€ç¯ã€‚","id":23,"section":"posts","tags":["æ¶æ„"],"title":"æ¶æ„åˆ¶å›¾","uri":"https://hugo.jiahongw.com/zh/posts/systemarchitecture/architecture-drawing/"},{"content":" å¤šå‚æ•°æ„é€ å‡½æ•°çš„é—®é¢˜ é™æ€å·¥å‚å’Œæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ªå±€é™ï¼šå®ƒä»¬ä¸èƒ½å¯¹å¤§é‡å¯é€‰å‚æ•°åšå¾ˆå¥½çš„æ‰©å±•ã€‚ä»¥ä¸€ä¸ªç±»ä¸ºä¾‹ï¼Œå®ƒè¡¨ç¤ºåŒ…è£…é£Ÿå“ä¸Šçš„è¥å…»æ ‡ç­¾ã€‚è¿™äº›æ ‡ç­¾ä¸Šæœ‰ä¸€äº›å­—æ®µæ˜¯å¿…éœ€çš„ï¼Œå¦‚ï¼šå‡€å«é‡ã€æ¯›é‡å’Œæ¯å•ä½ä»½é‡çš„å¡è·¯é‡Œï¼Œå¦æœ‰è¶…è¿‡ 20 ä¸ªå¯é€‰çš„å­—æ®µï¼Œå¦‚ï¼šæ€»è„‚è‚ªã€é¥±å’Œè„‚è‚ªã€åå¼è„‚è‚ªã€èƒ†å›ºé†‡ã€é’ ç­‰ç­‰ã€‚å¤§å¤šæ•°äº§å“åªæœ‰è¿™äº›å¯é€‰å­—æ®µä¸­çš„å°‘æ•°ï¼Œä¸”å…·æœ‰éé›¶å€¼ã€‚\nåº”è¯¥ä¸ºè¿™æ ·çš„ç±»ç¼–å†™ä»€ä¹ˆç§ç±»çš„æ„é€ å‡½æ•°æˆ–é™æ€å·¥å‚å‘¢ï¼Ÿä¼ ç»Ÿçš„æ–¹å¼æ˜¯ä½¿ç”¨å¯ä¼¸ç¼©æ„é€ å‡½æ•°ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œåªå‘æ„é€ å‡½æ•°æä¾›å¿…éœ€çš„å‚æ•°ã€‚å³ï¼Œå‘ç¬¬ä¸€ä¸ªæ„é€ å‡½æ•°æä¾›å•ä¸ªå¯é€‰å‚æ•°ï¼Œå‘ç¬¬äºŒä¸ªæ„é€ å‡½æ•°æä¾›ä¸¤ä¸ªå¯é€‰å‚æ•°ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæœ€åä¸€ä¸ªæ„é€ å‡½æ•°æ˜¯å…·æœ‰æ‰€æœ‰å¯é€‰å‚æ•°çš„ã€‚è¿™æ˜¯å®ƒåœ¨å®é™…åº”ç”¨ä¸­çš„æ ·å­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  // Telescoping constructor pattern - does not scale well! public class NutritionFacts { private final int servingSize; // (mL) required  private final int servings; // (per container) required  private final int calories; // (per serving) optional  private final int fat; // (g/serving) optional  private final int sodium; // (mg/serving) optional  private final int carbohydrate; // (g/serving) optional  public NutritionFacts(int servingSize, int servings) { this(servingSize, servings, 0); } public NutritionFacts(int servingSize, int servings, int calories) { this(servingSize, servings, calories, 0); } public NutritionFacts(int servingSize, int servings, int calories, int fat) { this(servingSize, servings, calories, fat, 0); } public NutritionFacts(int servingSize, int servings, int calories, int fat, int sodium) { this(servingSize, servings, calories, fat, sodium, 0); } public NutritionFacts(int servingSize, int servings, int calories, int fat, int sodium, int carbohydrate) { this.servingSize = servingSize; this.servings = servings; this.calories = calories; this.fat = fat; this.sodium = sodium; this.carbohydrate = carbohydrate; } }    æ‹“å±•ï¼Œåœ¨Java8ä¹‹åï¼Œå¯¹äºé‚£äº›å¯æœ‰å¯æ— çš„æˆå‘˜å˜é‡æœ€å¥½ä½¿ç”¨Optionalè¿›è¡Œé™åˆ¶ã€‚\n å½“ä½ æƒ³è¦åˆ›å»ºä¸€ä¸ªå®ä¾‹çš„æ—¶å€™ï¼Œè¿™æ ·è¿›è¡Œè°ƒç”¨ï¼š\n1  NutritionFacts cocaCola =new NutritionFacts(240, 8, 100, 0, 35, 27);   é€šå¸¸ï¼Œè¿™ä¸ªæ„é€ å‡½æ•°åŒ…å«è®¸å¤šé¢å¤–çš„å‚æ•°ï¼Œä½†æ˜¯ä½ å¿…é¡»ä¸ºå®ƒä»¬ä¼ é€’ä¸€ä¸ªå€¼ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸º fat ä¼ é€’äº†ä¸€ä¸ªå€¼ 0ï¼ˆå› ä¸ºæˆ‘ä»¬å¿…é¡»å¡«å…¥ä¸€ä¸ªæ•°ï¼Œè¿™æ ·æ‰èƒ½åŒ¹é…å‡½æ•°ï¼‰ã€‚åªæœ‰å…­ä¸ªå‚æ•°æ—¶ï¼Œè¿™å¯èƒ½çœ‹èµ·æ¥ä¸é‚£ä¹ˆç³Ÿï¼Œä½†éšç€å‚æ•°çš„å¢åŠ ï¼Œå®ƒå¾ˆå¿«å°±ä¼šå¤±æ§ã€‚\n ç®€å•åœ°è¯´ï¼Œå¯ä¼¸ç¼©æ„é€ å‡½æ•°æ¨¡å¼å¯ä»¥å·¥ä½œï¼Œä½†æ˜¯å½“æœ‰å¾ˆå¤šå‚æ•°æ—¶ï¼Œç¼–å†™å®¢æˆ·ç«¯ä»£ç æ˜¯å¾ˆå›°éš¾çš„ï¼Œè€Œä¸”è¯»èµ·æ¥æ›´å›°éš¾ã€‚ è¯»è€…æƒ³çŸ¥é“æ‰€æœ‰è¿™äº›å€¼æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå¿…é¡»ä»”ç»†æ¸…ç‚¹å‚æ•°ã€‚ç›¸åŒç±»å‹å‚æ•°çš„é•¿åºåˆ—ä¼šå¯¼è‡´ç»†å¾®çš„é”™è¯¯ã€‚å¦‚æœå®¢æˆ·ç«¯ä¸å°å¿ƒå€’è½¬äº†ä¸¤ä¸ªè¿™æ ·çš„å‚æ•°ï¼Œç¼–è¯‘å™¨ä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ç¨‹åºä¼šåœ¨è¿è¡Œæ—¶å‡ºé”™\n è§£å†³åŠæ³•1-ä½¿ç”¨JavaBeanæ¨¡å¼ è¿™ç§æ¨¡å¼æ˜¯è¿™æ ·è¿ä½œçš„ï¼šå…ˆé€šè¿‡ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡ï¼Œç„¶åè°ƒç”¨å¯¹è±¡çš„setteræ–¹æ³•è®¾ç½®éœ€è¦è®¾ç½®çš„å€¼ã€‚\n JavaBeanæ˜¯ä¸€ç§ç¬¦åˆå‘½åè§„èŒƒçš„classï¼Œå®ƒé€šè¿‡getterå’Œsetteræ¥å®šä¹‰å±æ€§\n ä¾‹å¦‚å®šä¹‰ä¸€ä¸ªJavaBeanæ¨¡å¼çš„ç±»ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  // JavaBeans Pattern - allows inconsistency, mandates mutability public class NutritionFacts { // Parameters initialized to default values (if any)  private int servingSize = -1; // Required; no default value  private int servings = -1; // Required; no default value  private int calories = 0; private int fat = 0; private int sodium = 0; private int carbohydrate = 0; public NutritionFacts() { } // Setters  public void setServingSize(int val) { servingSize = val; } public void setServings(int val) { servings = val; } public void setCalories(int val) { calories = val; } public void setFat(int val) { fat = val; } public void setSodium(int val) { sodium = val; } public void setCarbohydrate(int val) { carbohydrate = val; } }   åœ¨å®é™…çš„ä½¿ç”¨æ˜¯è¿™æ ·çš„ï¼š\n1 2 3 4 5 6  NutritionFacts cocaCola = new NutritionFacts(); cocaCola.setServingSize(240); cocaCola.setServings(8); cocaCola.setCalories(100); cocaCola.setSodium(35); cocaCola.setCarbohydrate(27);   è™½ç„¶JavaBeanæ¨¡å¼å¯ä»¥å¾ˆæ–¹ä¾¿çš„è®©æˆ‘ä»¬è‡ªç”±çš„è®¾ç½®æˆ‘ä»¬éœ€è¦è®¾ç½®çš„å€¼ï¼Œä½†æ˜¯å› ä¸ºæ„å»ºæ˜¯åœ¨å¤šä¸ªè°ƒç”¨ä¹‹é—´è¿›è¡Œçš„ï¼Œæ‰€ä»¥ JavaBean å¯èƒ½åœ¨æ„å»ºçš„è¿‡ç¨‹ä¸­å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚ï¼ˆå¹¶å‘æƒ…å†µï¼‰\nè¯¥ç±»ä¸èƒ½ä»…é€šè¿‡æ£€æŸ¥æ„é€ å‡½æ•°å‚æ•°çš„æœ‰æ•ˆæ€§æ¥å¼ºåˆ¶ä¸€è‡´æ€§ã€‚åœ¨ä¸ä¸€è‡´çš„çŠ¶æ€ä¸‹å°è¯•ä½¿ç”¨å¯¹è±¡å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯çš„å‘ç”Ÿï¼Œè€ŒåŒ…å«è¿™äº›é”™è¯¯çš„ä»£ç å¾ˆéš¾è°ƒè¯•ã€‚\nå¦å¤–ä¸€ä¸ªç›¸å…³çš„ç¼ºç‚¹æ˜¯ï¼ŒJavaBean æ¨¡å¼æ’é™¤äº†ä½¿ç±»ä¸å¯å˜çš„å¯èƒ½æ€§ï¼Œå› ä¸ºSetteræ–¹æ³•å·²ç»æš´éœ²å†…éƒ¨æ•°æ®ä¿®æ”¹çš„æ–¹æ³•ã€‚é™¤éç¨‹åºå‘˜è‡ªå·±æ¥ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚\nè§£å†³åŠæ³•2-ä½¿ç”¨å»ºé€ è€…æ¨¡å¼  å»ºé€ è€…æ¨¡å¼ç»“åˆäº†å¯ä¼¸ç¼©æ„é€ å‡½æ•°æ¨¡å¼çš„å®‰å…¨æ€§å’Œ JavaBean æ¨¡å¼çš„å¯è¯»æ€§ã€‚\n å®¢æˆ·ç«¯ä¸ç›´æ¥ç”Ÿæˆæ‰€éœ€çš„å¯¹è±¡ï¼Œè€Œæ˜¯ä½¿ç”¨æ‰€æœ‰å¿…éœ€çš„å‚æ•°è°ƒç”¨æ„é€ å‡½æ•°ï¼ˆæˆ–é™æ€å·¥å‚ï¼‰ï¼Œå¹¶è·å¾—ä¸€ä¸ª builder å¯¹è±¡ã€‚ç„¶åï¼Œå®¢æˆ·ç«¯åœ¨æ„å»ºå™¨å¯¹è±¡ä¸Šè°ƒç”¨åƒ setter è¿™æ ·çš„æ–¹æ³•æ¥è®¾ç½®æ¯ä¸ªæ„Ÿå…´è¶£çš„å¯é€‰å‚æ•°ã€‚æœ€åï¼Œå®¢æˆ·ç«¯è°ƒç”¨ä¸€ä¸ªæ— å‚æ•°çš„æ„å»ºæ–¹æ³•æ¥ç”Ÿæˆå¯¹è±¡ï¼Œè¿™é€šå¸¸æ˜¯ä¸å¯å˜çš„ã€‚æ„å»ºå™¨é€šå¸¸æ˜¯å®ƒæ„å»ºçš„ç±»çš„é™æ€æˆå‘˜ç±»ã€‚ä¸‹é¢æ˜¯å®ƒåœ¨å®é™…åº”ç”¨ä¸­çš„æ ·å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58  // Builder Pattern public class NutritionFacts { private final int servingSize; private final int servings; private final int calories; private final int fat; private final int sodium; private final int carbohydrate; public static class Builder { // Required parameters  private final int servingSize; private final int servings; // Optional parameters - initialized to default values  private int calories = 0; private int fat = 0; private int sodium = 0; private int carbohydrate = 0; public Builder(int servingSize, int servings) { this.servingSize = servingSize; this.servings = servings; } public Builder calories(int val) { calories = val; return this; } public Builder fat(int val) { fat = val; return this; } public Builder sodium(int val) { sodium = val; return this; } public Builder carbohydrate(int val) { carbohydrate = val; return this; } public NutritionFacts build() { return new NutritionFacts(this); } } private NutritionFacts(Builder builder) { servingSize = builder.servingSize; servings = builder.servings; calories = builder.calories; fat = builder.fat; sodium = builder.sodium; carbohydrate = builder.carbohydrate; } }    è¿™é‡Œä¸ºäº†ç®€æ´ï¼Œçœç•¥äº†æœ‰æ•ˆæ€§æ£€æŸ¥ã€‚\n ä½¿ç”¨ï¼š\n1 2  NutritionFacts cocaCola = new NutritionFacts.Builder(240, 8) .calories(100).sodium(35).carbohydrate(27).build();    NutritionFacts ç±»æ˜¯ä¸å¯å˜çš„ï¼Œå› ä¸ºæ„é€ å¯¹è±¡å¹¶æ²¡æœ‰è°ƒç”¨setteræ–¹æ³•ï¼Œæ‰€æœ‰å‚æ•°é»˜è®¤å€¼éƒ½åœ¨ä¸€ä¸ªä½ç½®ã€‚æ„å»ºå™¨çš„ setter æ–¹æ³•è¿”å›æ„å»ºå™¨æœ¬èº«ï¼Œè¿™æ ·å°±å¯ä»¥é“¾å¼è°ƒç”¨ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªæµç•…çš„ APIã€‚\n å»ºé€ è€…æ¨¡å¼éå¸¸é€‚åˆäºç±»å±‚æ¬¡ç»“æ„ã€‚ä½¿ç”¨æ„å»ºå™¨çš„å¹¶è¡Œå±‚æ¬¡ç»“æ„ï¼Œæ¯ä¸ªæ„å»ºå™¨éƒ½åµŒå¥—åœ¨ç›¸åº”çš„ç±»ä¸­ã€‚æŠ½è±¡ç±»æœ‰æŠ½è±¡ç±»æ„å»ºå™¨ï¼›å…·ä½“ç±»æœ‰å…·ä½“ç±»æ„å»ºå™¨ã€‚\nç»§æ‰¿çš„è¯éœ€è¦åŒç»§æ‰¿ï¼Œå­ç±»å’Œå­ç±»æ„é€ å™¨å¯¹åº”ç»§æ‰¿çˆ¶ç±»çš„ã€‚\nå»ºé€ è€…æ¨¡å¼çš„ç¼ºç‚¹  ä¸ºäº†åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä½ å¿…é¡»é¦–å…ˆåˆ›å»ºå®ƒçš„æ„å»ºå™¨ã€‚ è™½ç„¶åœ¨å®é™…åº”ç”¨ä¸­åˆ›å»ºè¿™ä¸ªæ„å»ºå™¨çš„æˆæœ¬å¯èƒ½å¹¶ä¸æ˜¾è‘—ï¼Œä½†åœ¨ä»¥æ€§èƒ½ä¸ºå…³é”®çš„åœºæ™¯ä¸‹ï¼Œè¿™å¯èƒ½ä¼šæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ å»ºé€ è€…æ¨¡å¼æ¯”å¯ä¼¸ç¼©æ„é€ å‡½æ•°æ¨¡å¼æ›´å†—é•¿ã€‚å› æ­¤åªæœ‰åœ¨æœ‰è¶³å¤Ÿå¤šçš„å‚æ•°æ—¶æ‰å€¼å¾—ä½¿ç”¨ï¼Œæ¯”å¦‚æœ‰ 4 ä¸ªæˆ–æ›´å¤šå‚æ•°æ—¶ï¼Œæ‰åº”è¯¥ä½¿ç”¨å®ƒã€‚   å¦‚æœä½ ä»¥æ„é€ å‡½æ•°æˆ–é™æ€å·¥å‚å¼€å§‹ï¼Œç›´è‡³ç±»æ‰©å±•åˆ°å‚æ•°æ•°é‡æ— æ³•æ§åˆ¶çš„ç¨‹åº¦æ—¶ï¼Œä¹Ÿä¼šåˆ‡æ¢åˆ°æ„å»ºå™¨ï¼Œä½†æ˜¯è¿‡æ—¶çš„æ„é€ å‡½æ•°æˆ–é™æ€å·¥å‚å°†å¾ˆéš¾å¤„ç†ã€‚å› æ­¤ï¼Œæœ€å¥½ä¸€å¼€å§‹å°±ä»æ„å»ºå™¨å¼€å§‹ã€‚\n æ€»ç»“ æ€»ä¹‹ï¼Œåœ¨è®¾è®¡æ„é€ å‡½æ•°æˆ–é™æ€å·¥å‚çš„ç±»æ—¶ï¼Œå»ºé€ è€…æ¨¡å¼æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œç‰¹åˆ«æ˜¯å½“è®¸å¤šå‚æ•°æ˜¯å¯é€‰çš„æˆ–å…·æœ‰ç›¸åŒç±»å‹æ—¶ã€‚ä¸å¯ä¼¸ç¼©æ„é€ å‡½æ•°ç›¸æ¯”ï¼Œä½¿ç”¨æ„å»ºå™¨å®¢æˆ·ç«¯ä»£ç æ›´å®¹æ˜“è¯»å†™ï¼Œè€Œä¸”æ„å»ºå™¨æ¯” JavaBean æ›´å®‰å…¨ã€‚\nReferenceï¼š\n ç§’æ‡‚è®¾è®¡æ¨¡å¼ä¹‹å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder patternï¼‰ - çŸ¥ä¹ Effective-Java-3rd-edition-Chinese-English-bilingual/Chapter-2-Item-2-Consider-a-builder-when-faced-with-many-constructor-parameters.md at dev Â· clxering/Effective-Java-3rd-edition-Chinese-English-bilingual  ","description":"Consider a builder when faced with many constructor parametersã€‚ä½¿ç”¨å»ºé€ è€…æ¨¡å¼åˆ›å»ºå…è®¸éƒ¨åˆ†å‚æ•°æ²¡æœ‰çš„ç±»ã€‚","id":24,"section":"posts","tags":["EffectiveJava"],"title":"2-å½“æ„é€ å‡½æ•°æœ‰å¤šä¸ªå‚æ•°æ—¶ï¼Œè€ƒè™‘æ”¹ç”¨æ„å»ºå™¨","uri":"https://hugo.jiahongw.com/zh/posts/bookeffectivejava/2%E5%9C%A8%E9%9D%A2%E5%AF%B9%E5%A4%9A%E4%B8%AA%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E6%97%B6%E8%AF%B7%E8%80%83%E8%99%91%E6%9E%84%E5%BB%BA%E5%99%A8/"},{"content":" ä»€ä¹ˆæ˜¯é™æ€å·¥å‚æ–¹æ³•ï¼Ÿ ä¸€ä¸ªç±»å¯ä»¥æä¾›å…¬å…±é™æ€å·¥å‚æ–¹æ³•ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªè¿”å›ç±»å®ä¾‹çš„é™æ€æ–¹æ³•ã€‚\nä¾‹å¦‚Boolean ï¼ˆboolean çš„åŒ…è£…ç±»ï¼‰çš„ç®€å•ç¤ºä¾‹ã€‚è¯¥æ–¹æ³•å°† boolean åŸºæœ¬ç±»å‹è½¬æ¢ä¸º Boolean å¯¹è±¡çš„å¼•ç”¨ï¼š\n1 2 3  public static Boolean valueOf(boolean b) { return b ? Boolean.TRUE : Boolean.FALSE; }    è¦æ³¨æ„çš„æ˜¯é™æ€å·¥å‚æ–¹æ³•ä¸æ¥è‡ªè®¾è®¡æ¨¡å¼çš„å·¥å‚æ–¹æ³•æ¨¡å¼ä¸åŒ [Gamma95]ã€‚æœ¬æ¡ç›®ä¸­æè¿°çš„é™æ€å·¥å‚æ–¹æ³•åœ¨è®¾è®¡æ¨¡å¼ä¸­æ²¡æœ‰ç›´æ¥ç­‰ä»·çš„æ–¹æ³•ã€‚\n é™æ€å·¥å‚æ–¹æ³•çš„ä¼˜ç‚¹ 1 é™æ€å·¥å‚æ–¹æ³•æœ‰ç¡®åˆ‡åç§°ï¼ˆæ›´åŠ æ¸…æ™°ï¼‰ å¦‚æœæ„é€ å‡½æ•°çš„å‚æ•°æœ¬èº«å¹¶ä¸èƒ½æè¿°è¿”å›çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå…·æœ‰ç¡®åˆ‡åç§°çš„é™æ€å·¥å‚åˆ™æ›´å®¹æ˜“ä½¿ç”¨ï¼Œç”Ÿæˆçš„å®¢æˆ·ç«¯ä»£ç ä¹Ÿæ›´å®¹æ˜“é˜…è¯»ã€‚æœ€ç®€å•çš„ä¾‹å­ï¼Œè¿”å›å¯èƒ½ä¸ºç´ æ•°çš„ BigInteger ç±»çš„æ„é€ å‡½æ•° BigInteger(int, int, Random) æœ€å¥½è¡¨ç¤ºä¸ºåä¸º BigInteger.probablePrime çš„é™æ€å·¥å‚æ–¹æ³•ã€‚\n ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå…·æœ‰ç»™å®šç­¾åçš„æ„é€ å‡½æ•°ã€‚ä½†æ˜¯ç¨‹åºå‘˜å¯ä»¥é€šè¿‡æä¾›å¤šä¸ªæ„é€ å‡½æ•°æ¥ç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼Œè¿™äº›æ„é€ å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä»…åœ¨å‚æ•°ç±»å‹ã€ä¸ªæ•°æˆ–é¡ºåºä¸Šæœ‰æ‰€ä¸åŒã€‚é¢å¯¹è¿™æ ·ä¸€ä¸ª APIï¼Œç”¨æˆ·å°†æ°¸è¿œæ— æ³•è®°ä½è¯¥ç”¨å“ªä¸ªæ„é€ å‡½æ•°ï¼Œå¹¶ä¸”æœ€ç»ˆä¼šé”™è¯¯åœ°è°ƒç”¨ä¸é€‚åˆçš„æ„é€ å‡½æ•°ã€‚å¦‚æœä¸å‚è€ƒç±»æ–‡æ¡£ï¼Œé˜…è¯»ä½¿ç”¨è¿™äº›æ„é€ å‡½æ•°ä»£ç çš„äººå°±ä¸ä¼šçŸ¥é“ä»£ç çš„ä½œç”¨ã€‚\n 2 é™æ€å·¥å‚æ–¹æ³•ä¸éœ€è¦åœ¨æ¯æ¬¡è°ƒç”¨æ—¶åˆ›å»ºæ–°å¯¹è±¡ï¼ˆèŠ‚çœå†…å­˜ï¼‰ Boolean.valueOf(boolean) æ–¹æ³•è¯´æ˜äº†è¿™ç§æŠ€æœ¯ï¼šå®ƒä»ä¸åˆ›å»ºå¯¹è±¡ã€‚è¿™ç§æŠ€æœ¯ç±»ä¼¼äºäº«å…ƒæ¨¡å¼ [Gamma95]ã€‚å¦‚æœç»å¸¸è¯·æ±‚ç›¸åŒçš„å¯¹è±¡ï¼Œç‰¹åˆ«æ˜¯åœ¨åˆ›å»ºå¯¹è±¡çš„ä»£ä»·å¾ˆé«˜æ—¶ï¼Œå®ƒå¯ä»¥æå¤§åœ°æé«˜æ€§èƒ½ã€‚\n ä»€ä¹ˆæ˜¯äº«å…ƒæ¨¡å¼ï¼ˆFlyweight Design Patternï¼‰ï¼Ÿ\næ‰€è°“â€œäº«å…ƒâ€ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯è¢«å…±äº«çš„å•å…ƒã€‚äº«å…ƒæ¨¡å¼çš„æ„å›¾æ˜¯å¤ç”¨å¯¹è±¡ï¼ŒèŠ‚çœå†…å­˜ï¼Œå‰ææ˜¯äº«å…ƒå¯¹è±¡æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚\n æšä¸¾ç±»å‹ä¹Ÿæä¾›äº†è¿™ç§ä¿è¯ã€‚\n3 å¯ä»¥é€šè¿‡é™æ€å·¥å‚æ–¹æ³•è·å–åŸè¿”å›ç±»å‹çš„ä»»ä½•å­ç±»çš„å¯¹è±¡ï¼ˆéšè—å®ç°ç±»ï¼‰ è¿™ç§çµæ´»æ€§çš„ä¸€ä¸ªåº”ç”¨æ˜¯ APIå¯ä»¥è¿”å›å¯¹è±¡ï¼Œä½†åˆä¸ä¼šä½¿å¯¹è±¡çš„ç±»å˜æˆå…±æœ‰çš„ã€‚ï¼ˆç±»å¯ä»¥æ˜¯ç§æœ‰çš„ï¼Œé€šè¿‡å…±æœ‰çš„é™æ€å·¥å‚æ–¹æ³•è¿›è¡Œè¿”å›ï¼‰ä»¥è¿™ç§æ–¹å¼éšè—å®ç°ç±»ä¼šå½¢æˆä¸€ä¸ªéå¸¸ç´§å‡‘çš„ APIã€‚è¿™ç§æŠ€æœ¯é€‚ç”¨äºåŸºäºæ¥å£çš„æ¡†æ¶ï¼Œå…¶ä¸­æ¥å£ä¸ºé™æ€å·¥å‚æ–¹æ³•æä¾›äº†è‡ªç„¶çš„è¿”å›ç±»å‹ã€‚\n Collections æ¡†æ¶ API æ¯”å®ƒå¯¼å‡º 45 ä¸ªç‹¬ç«‹çš„å…¬å…±ç±»è¦å°å¾—å¤šï¼Œæ¯ä¸ªå…¬å…±ç±»å¯¹åº”ä¸€ä¸ªæ–¹ä¾¿çš„å®ç°ã€‚å‡å°‘çš„ä¸ä»…ä»…æ˜¯ API çš„æ•°é‡ï¼Œè¿˜æœ‰æ¦‚å¿µä¸Šçš„å‡å°‘ï¼šç¨‹åºå‘˜ä¸ºäº†ä½¿ç”¨ API å¿…é¡»æŒæ¡çš„æ¦‚å¿µçš„æ•°é‡å’Œéš¾åº¦ã€‚ç¨‹åºå‘˜çŸ¥é“è¿”å›çš„å¯¹è±¡æ˜¯ç”±ç›¸å…³çš„æ¥å£ç²¾ç¡®åœ°æŒ‡å®šçš„ï¼Œå› æ­¤ä¸éœ€è¦ä¸ºå®ç°ç±»é˜…è¯»é¢å¤–çš„ç±»æ–‡æ¡£ã€‚æ­¤å¤–ï¼Œä½¿ç”¨è¿™ç§é™æ€å·¥å‚æ–¹æ³•éœ€è¦å®¢æˆ·ç«¯é€šè¿‡æ¥å£è€Œä¸æ˜¯å®ç°ç±»å¼•ç”¨è¿”å›çš„å¯¹è±¡ï¼Œè¿™é€šå¸¸æ˜¯å¾ˆå¥½çš„åšæ³•ã€‚\n 4 è¿”å›å¯¹è±¡çš„ç±»å¯ä»¥éšè°ƒç”¨çš„ä¸åŒè€Œå˜åŒ–ï¼Œä½œä¸ºè¾“å…¥å‚æ•°çš„å‡½æ•° ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ„é€ å‡½æ•°(æˆ–è€…æ˜¯æˆ‘ä»¬éœ€è¦æ„é€ çš„å¯¹è±¡)å’Œå¤–ç•Œä¹‹é—´å¢åŠ äº†ä¸€ä¸ªé™æ€å·¥å‚çš„æ–¹æ³•ä½œä¸ºä¸­é—´å±‚ï¼Œè¿™ä¸ªä¸­é—´å±‚åšä¸€ä¸ªå°è§£è€¦ï¼Œå¯ä»¥åœ¨ä¸­é—´å±‚ä¹Ÿå°±æ˜¯é™æ€å·¥å‚æ–¹æ³•ä¸Šæ‰§è¡Œè‡ªå·±çš„é€»è¾‘ã€‚ä¾‹å¦‚ï¼š\nâ€‹ EnumSet ç±»æ²¡æœ‰å…¬å…±æ„é€ å‡½æ•°ï¼Œåªæœ‰é™æ€å·¥å‚ã€‚åœ¨ OpenJDK å®ç°ä¸­ï¼Œå®ƒä»¬è¿”å›ä¸¤ä¸ªå­ç±»ä¸­çš„ä¸€ä¸ªå®ä¾‹ï¼Œè¿™å–å†³äºåº•å±‚ enum ç±»å‹çš„å¤§å°ï¼šå¦‚æœå®ƒæœ‰ 64 ä¸ªæˆ–æ›´å°‘çš„å…ƒç´ ï¼Œå°±åƒå¤§å¤šæ•° enum ç±»å‹ä¸€æ ·ï¼Œé™æ€å·¥å‚è¿”å›ä¸€ä¸ª long ç±»å‹çš„ RegularEnumSet å®ä¾‹ï¼›å¦‚æœ enum ç±»å‹æœ‰ 65 ä¸ªæˆ–æ›´å¤šçš„å…ƒç´ ï¼Œå·¥å‚å°†è¿”å›ä¸€ä¸ªç”± long[] ç±»å‹çš„ JumboEnumSet å®ä¾‹ã€‚\n å®¢æˆ·ç«¯çœ‹ä¸åˆ°è¿™ä¸¤ä¸ªå®ç°ç±»çš„å­˜åœ¨ã€‚å¦‚æœ RegularEnumSet ä¸å†ä¸ºå°å‹ enum ç±»å‹æä¾›æ€§èƒ½ä¼˜åŠ¿ï¼Œå®ƒå¯èƒ½ä¼šåœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­è¢«æ¶ˆé™¤ï¼Œè€Œä¸ä¼šäº§ç”Ÿä¸è‰¯å½±å“ã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœäº‹å®è¯æ˜ EnumSet æœ‰ç›Šäºæ€§èƒ½ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯ä»¥æ·»åŠ ç¬¬ä¸‰æˆ–ç¬¬å››ä¸ª EnumSet å®ç°ã€‚å®¢æˆ·ç«¯æ—¢ä¸çŸ¥é“ä¹Ÿä¸å…³å¿ƒä»å·¥å‚è¿”å›çš„å¯¹è±¡çš„ç±»ï¼›å®ƒä»¬åªå…³å¿ƒå®ƒæ˜¯ EnumSet çš„æŸä¸ªå­ç±»ã€‚\n 5 å½“ç¼–å†™åŒ…å«æ–¹æ³•çš„ç±»æ—¶ï¼Œè¿”å›å¯¹è±¡çš„ç±»ä¸éœ€è¦å­˜åœ¨ï¼ˆè§£è€¦ï¼Œéš”ç¦»ï¼‰ è¿™ç§çµæ´»çš„é™æ€å·¥å‚æ–¹æ³•æ„æˆäº†æœåŠ¡æä¾›è€…æ¡†æ¶çš„åŸºç¡€ï¼Œæ¯”å¦‚ Java æ•°æ®åº“è¿æ¥ APIï¼ˆJDBCï¼‰ã€‚æœåŠ¡æä¾›è€…æ¡†æ¶æ˜¯ä¸€ä¸ªç³»ç»Ÿï¼Œå…¶ä¸­æä¾›è€…å®ç°ä¸€ä¸ªæœåŠ¡ï¼Œç³»ç»Ÿä½¿å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¿™äº›å®ç°ï¼Œä»è€Œå°†å®¢æˆ·ç«¯ä¸å®ç°åˆ†ç¦»ã€‚\n ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“éœ€è¦ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•è¿›è¡Œè¿”å›å°±å¯ä»¥äº†ï¼Œä¸å¿…çœŸæ­£çš„å»åˆ›å»ºè¿™ä¸ªç±»ã€‚\n é™æ€å·¥å‚æ–¹æ³•çš„å±€é™ 1 æ²¡æœ‰å…¬å…±æˆ–å—ä¿æŠ¤æ„é€ å‡½æ•°çš„ç±»ä¸èƒ½è¢«å­ç±»åŒ– ä¾‹å¦‚ï¼Œä¸å¯èƒ½åœ¨é›†åˆæ¡†æ¶ä¸­å­ç±»åŒ–ä»»ä½•æ–¹ä¾¿çš„å®ç°ç±»ã€‚è¿™å¯èƒ½æ˜¯ä¸€ç§å› ç¥¸å¾—ç¦çš„åšæ³•ï¼Œå› ä¸ºå®ƒé¼“åŠ±ç¨‹åºå‘˜ä½¿ç”¨ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿ï¼Œå¹¶ä¸”å¯¹äºä¸å¯å˜çš„ç±»å‹æ˜¯å¿…éœ€çš„ã€‚\n å› ä¸ºæ„é€ å‡½æ•°ä¸æ˜¯å…±æœ‰çš„æˆ–è€…æ˜¯å—ä¿æŠ¤çš„ï¼Œå­ç±»å°±ä¸èƒ½å¤Ÿè®¿é—®çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œä»è€Œä¸èƒ½å¤Ÿåˆ›å»ºå­ç±»ã€‚ï¼ˆå­ç±»åˆ›å»ºéœ€è¦è°ƒç”¨å¼—çˆ¶ç±»çš„æ„é€ å‡½æ•°åœ¨è°ƒç”¨è‡ªå·±çš„æ„é€ å‡½æ•°ï¼‰\n 2 ç¨‹åºå‘˜å¾ˆéš¾æ‰¾åˆ°è¿™äº›é™æ€å·¥å‚æ–¹æ³• å®ƒä»¬åœ¨ API æ–‡æ¡£ä¸­ä¸åƒæ„é€ å‡½æ•°é‚£æ ·å¼•äººæ³¨ç›®ï¼Œå› æ­¤å¾ˆéš¾å¼„æ¸…æ¥šå¦‚ä½•å®ä¾‹åŒ–ä¸€ä¸ªåªæä¾›é™æ€å·¥å‚æ–¹æ³•è€Œæ²¡æœ‰æ„é€ å‡½æ•°çš„ç±»ã€‚ä¸æ­¤åŒæ—¶ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨ç±»æˆ–æ¥å£æ–‡æ¡£ä¸­å¯¹é™æ€å·¥å‚æ–¹æ³•å¤šåŠ ç•™æ„ï¼Œä»¥åŠéµå®ˆé€šç”¨å‘½åçº¦å®šçš„æ–¹å¼æ¥å‡å°‘è¿™ä¸ªå›°æ‰°ã€‚ä¸‹é¢æ˜¯ä¸€äº›é™æ€å·¥å‚æ–¹æ³•çš„å¸¸ç”¨åç§°ã€‚è¿™ä¸ªåˆ—è¡¨è¿˜è¿œä¸å¤Ÿè¯¦å°½ï¼š\n   å…³é”®å­— æè¿° ä½¿ç”¨     from ä¸€ç§å‹è½¬æ¢æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥å—å•ä¸ªå‚æ•°å¹¶è¿”å›è¯¥ç±»å‹çš„ç›¸åº”å®ä¾‹ Date d = Date.from(instant);   of ä¸€ä¸ªèšåˆæ–¹æ³•ï¼Œå®ƒæ¥å—å¤šä¸ªå‚æ•°å¹¶è¿”å›ä¸€ä¸ªåŒ…å«è¿™äº›å‚æ•°çš„å®ä¾‹ Set\u0026lt;Rank\u0026gt; faceCards = EnumSet.of(JACK, QUEEN, KING);   valueOf ä¸€ç§æ›¿ä»£ from å’Œ of ä½†æ›´å†—é•¿çš„æ–¹æ³• BigInteger prime = BigInteger.valueOf(Integer.MAX_VALUE);   instance /getInstance è¿”å›ä¸€ä¸ªå®ä¾‹ï¼Œè¯¥å®ä¾‹ç”±å…¶å‚æ•°ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰æè¿°ï¼Œä½†ä¸å…·æœ‰ç›¸åŒçš„å€¼ StackWalker luke = StackWalker.getInstance(options);   create /newInstance ä¸ instance æˆ– getInstance ç±»ä¼¼ï¼Œåªæ˜¯è¯¥æ–¹æ³•ä¿è¯æ¯ä¸ªè°ƒç”¨éƒ½è¿”å›ä¸€ä¸ªæ–°å®ä¾‹ Object newArray = Array.newInstance(classObject, arrayLen);   getType ç±»ä¼¼äº getInstanceï¼Œä½†å¦‚æœå·¥å‚æ–¹æ³•ä½äºä¸åŒçš„ç±»ä¸­ï¼Œåˆ™ä½¿ç”¨æ­¤æ–¹æ³•ã€‚å…¶ç±»å‹æ˜¯å·¥å‚æ–¹æ³•è¿”å›çš„å¯¹è±¡ç±»å‹ FileStore fs = Files.getFileStore(path);   newType ä¸ newInstance ç±»ä¼¼ï¼Œä½†æ˜¯å¦‚æœå·¥å‚æ–¹æ³•åœ¨ä¸åŒçš„ç±»ä¸­ä½¿ç”¨ã€‚ç±»å‹æ˜¯å·¥å‚æ–¹æ³•è¿”å›çš„å¯¹è±¡ç±»å‹ BufferedReader br = Files.newBufferedReader(path);   type ä¸€ä¸ªç”¨æ¥æ›¿ä»£ getType å’Œ newType çš„æ¯”è¾ƒç®€å•çš„æ–¹å¼ List\u0026lt;Complaint\u0026gt; litany = Collections.list(legacyLitany);         æ€»ç»“ é™æ€å·¥å‚æ–¹æ³•å’Œå…¬å…±æ„é€ å™¨éƒ½æœ‰å„è‡ªçš„ç”¨é€”ï¼Œç†è§£å®ƒä»¬ç›¸æ¯”è€Œè¨€çš„ä¼˜ç‚¹æ˜¯å€¼å¾—çš„ã€‚é€šå¸¸é™æ€å·¥å‚çš„æ–¹å¼æ›´å¯å–ï¼Œå› æ­¤åº”é¿å…åœ¨æ²¡æœ‰è€ƒè™‘é™æ€å·¥å‚çš„æƒ…å†µä¸‹å°±æä¾›å…¬å…±æ„é€ å‡½æ•°ã€‚\nReferenceï¼š\n Effective-Java-3rd-edition-Chinese-English-bilingual/Chapter-2-Item-1-Consider-static-factory-methods-instead-of-constructors.md at dev Â· clxering/Effective-Java-3rd-edition-Chinese-English-bilingual  ","description":"Consider static factory methods instead of constructorsã€‚","id":25,"section":"posts","tags":["EffectiveJava"],"title":"1-è€ƒè™‘ä»¥é™æ€å·¥å‚æ–¹æ³•ä»£æ›¿æ„é€ å‡½æ•°-ã€ŠEffective Javaã€‹ç¬”è®°","uri":"https://hugo.jiahongw.com/zh/posts/bookeffectivejava/1%E8%80%83%E8%99%91%E4%BB%A5%E9%9D%99%E6%80%81%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E4%BB%A3%E6%9B%BF%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/"},{"content":"å‡ºå‘å‰çš„å‡†å¤‡ æˆ‘è¿™é‡Œåˆ—äº†ä¸€ä¸ªå¤§è‡´çš„æ”»ç•¥ï¼ˆè™½ç„¶æœ€åå´‚å±±æ²¡å»æˆï¼‰ï¼š\né’å²›æ”»ç•¥\nè¿˜å‡†å¤‡äº†ä¸€ä¸ªè¡Œç¨‹è·¯çº¿ï¼š\nç¬¬ä¸€ç«™ æˆ‘ä»¬ä¸‹è½¦çš„åœ°æ–¹æ˜¯é’å²›ç«™ï¼Œä¸€ä¸‹æ¥ï¼Œå°±æ˜¯ä¸€ç§æ¬§å¼å»ºç­‘çš„æ„Ÿè§‰ï¼Œè¿™å°±æ˜¯é’å²›çš„ç‰¹è‰²å—\nçœ‹æµ· æ¥é’å²›æ€ä¹ˆèƒ½ä¸çœ‹æµ·ï¼Œé’å²›ä¸‰é¢ç¯æµ·ï¼Œæ¥çš„è¿™å‡ å¤©ï¼Œæµ·æµªè¿˜æŒºå¤§ï¼Œå¹ç€æŒºèˆ’æœ\næ³¢æ¶›æ±¹æ¶Œ\næœ‰æ„å¢ƒçš„ä¸€ç¬é—´\né’å²›æ ‡å¿—æ€§å»ºç­‘â€”â€”æ ˆæ¡¥\nåƒæµ·é²œ åœ¨é’å²›åƒæµ·é²œğŸ¦ï¼Œå–ğŸºå•¤é…’ã€‚\nä¹°æµ·é²œ\næ‰¾åˆ«äººåŠ å·¥\né€›é’å²›è¡—å¤´ åœ¨åæœˆä»½çš„é’å²›æ ‘æœ¨éå¸¸ç»¿ï¼Œè€Œä¸”é’å²›çš„è¡—é“ä¹Ÿå¾ˆæœ‰ç‰¹è‰²ï¼Œå°±æ˜¯é‚£ç§æ—è«é“çš„æ„Ÿè§‰ï¼Œè®©äººå¾ˆèˆ’æœ\né’å²›çš„é“è·¯å‘½åå¾ˆæœ‰æ„æ€ï¼Œéƒ½æ˜¯æ‹¿å…¶ä»–çœåä½œä¸ºé“è·¯åï¼Œæ®è¯´é’å²›çš„ç‰ˆå›¾å°±æ˜¯ä¸€ä¸ªå°å‹çš„ä¸­å›½\nå¤œæ™šåœ¨æ•™å ‚è¿˜æœ‰äººç»„ç»‡ä¸€èµ·çœ‹ç”µå½±ï¼Œå¥½ä¹…æ²¡æœ‰è¿™æ ·çš„æ–‡è‰ºæ´»åŠ¨äº†\nå…‰åœˆå†…çš„äºº\nå¤œæ™šçš„è¡—é“å’Œè¡Œäºº\næ€»ç»“ é’å²›æ˜¯ä¸€ä¸ªéå¸¸æ¼‚äº®çš„åŸå¸‚ï¼Œéå¸¸é€‚åˆæ—…æ¸¸ã€‚é’å²›ä¸ä»…æœ‰æµ·ï¼Œæœ‰æµ·é²œï¼Œè¿˜æœ‰å¾ˆå¤šç¾å¥³ã€‚æ­¤è¡Œå‰å‰ååä¹Ÿåšäº†ä¸€äº›æ”»ç•¥ï¼Œå…¶å®æ”»ç•¥æ˜¯æ¬¡è¦çš„ï¼Œä¸ä¸€å®šéè¦å°†æ”»ç•¥ä¸­çš„å„ä¸ªæ™¯ç‚¹éƒ½é€›äº†æ‰ç®—å®Œç¾ï¼Œåœ¨è¡Œç¨‹ä¸­äº«å—è¿‡ç¨‹æ‰æ˜¯æ›´é‡è¦çš„ã€‚\nå½©è›‹ï½\n","description":"å›½åº†æœŸé—´ï¼Œå»äº†ä¸€è¶Ÿé’å²›ã€‚","id":26,"section":"posts","tags":["é’å²›","Life"],"title":"é’å²›ä¹‹æ—…","uri":"https://hugo.jiahongw.com/zh/posts/life/qingdao-travel/"},{"content":"The photo about Beijing with me.ğŸ“¹\n","description":"è®°å½•åŒ—äº¬çš„ç…§ç‰‡ç”Ÿæ´»","id":27,"section":"gallery","tags":[""],"title":"åŒ—äº¬çš„æ—¥å­","uri":"https://hugo.jiahongw.com/zh/gallery/beijing/"},{"content":"âœŒcxc\nã€ŠJavaå®æˆ˜ã€‹ç¬”è®°\nstreamçš„ä½¿ç”¨æ³¨æ„ ä¸€ä¸ª Stream pipeline ä¸­åŒ…å«ä¸€ä¸ªæº Streamï¼Œæ¥ç€æ˜¯ 0ä¸ªæˆ–è€…å¤šä¸ªä¸­é—´æ“ä½œ( intermediatå·³ operation)å’Œä¸€ä¸ªç»ˆæ­¢æ“ä½œ( terminal operation)ã€‚ æ¯ä¸ªä¸­é—´æ“ä½œéƒ½ä¼šé€šè¿‡æŸç§æ–¹å¼å¯¹ Stream è¿›è¡Œè½¬æ¢ï¼Œä¾‹å¦‚å°†æ¯ä¸ªå…ƒç´ æ˜ å°„åˆ°è¯¥å…ƒç´ çš„å‡½æ•°ï¼Œæˆ–è€…è¿‡æ»¤æ‰ä¸æ»¡è¶³æŸäº›æ¡ä»¶çš„æ‰€æœ‰å…ƒç´  ã€‚ æ‰€æœ‰çš„ä¸­é—´æ“ä½œéƒ½æ˜¯å°†ä¸€ä¸ª Stream è½¬æ¢æˆå¦ ä¸€ä¸ª Streamï¼Œå…¶å…ƒç´ ç±»å‹å¯èƒ½ä¸è¾“å…¥çš„ Stream ä¸€æ ·ï¼Œä¹Ÿå¯èƒ½ä¸åŒ ã€‚ ç»ˆæ­¢æ“ä½œä¼šåœ¨æœ€å ä¸€ä¸ªä¸­é—´æ“ä½œ äº§ç”Ÿçš„ Stream ä¸Šæ‰§è¡Œä¸€ä¸ªæœ€ç»ˆçš„è®¡ç®—ï¼Œ ä¾‹å¦‚å°†å…¶å…ƒç´ ä¿å­˜åˆ°ä¸€ä¸ªé›†åˆä¸­ï¼Œå¹¶è¿”å›æŸä¸€ä¸ªå…ƒç´ ï¼Œæˆ–è€…æ‰“å°å‡ºæ‰€æœ‰å…ƒç´ ç­‰ã€‚\nStream pipelineé€šå¸¸æ˜¯ lazy çš„ : ç›´åˆ°è°ƒç”¨ç»ˆæ­¢æ“ä½œæ—¶æ‰ä¼šå¼€å§‹è®¡ç®— ï¼Œå¯¹äºå®Œæˆç»ˆæ­¢æ“ä½œ ä¸éœ€è¦çš„æ•°æ®å…ƒç´ ï¼Œå°†æ°¸è¿œéƒ½ä¸ä¼šè¢«è®¡ç®— ã€‚ æ­£æ˜¯è¿™ç§ lazy è®¡ç®—ï¼Œä½¿æ— é™ Stream æˆä¸ºå¯èƒ½ ã€‚ æ³¨æ„ï¼Œæ²¡æœ‰ç»ˆæ­¢æ“ä½œçš„ Stream pipelineå°†æ˜¯ä¸€ä¸ªé™é»˜çš„æ— æ“ä½œæŒ‡ä»¤ ï¼Œå› æ­¤åƒä¸‡ä¸èƒ½å¿˜è®°ç»ˆæ­¢æ“ä½œã€‚\n**æ»¥ç”¨Streamä¼šä½¿ç¨‹åºæ›´éš¾ä»¥è¯»æ‡‚å’Œç»´æŠ¤ã€‚**æœ€å¥½çš„æ–¹æ³•æ˜¯ï¼Œä¸è¦è¿‡åº¦çš„ä½¿ç”¨Streamï¼Œé€‚å½“çš„ä½¿ç”¨Streamã€‚\nStreamæ–¹æ³•ç»å¸¸ä¼šä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼Œåœ¨å¯¹æ²¡æœ‰ç±»å‹çš„å˜é‡å‘½åéœ€è¦æ›´åŠ æ¸…æ™°ï¼Œå¢åŠ å…¶å¯è¯»æ€§ã€‚\nåœ¨ Streamn pipeline ä¸­ä½¿ ç”¨ helpeæ–¹æ³•ï¼ˆæŒ‡çš„æ˜¯å¸¸è§„çš„å‡½æ•°æ–¹æ³•è€Œä¸æ˜¯Lambdaè¡¨è¾¾å¼ï¼‰å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§ã€‚\næœ€å¥½é¿å…ä½¿ç”¨Streamå¤„ç†Charå€¼ï¼Œå› ä¸ºChar Streamè¿”å›çš„å…ƒç´ æ˜¯intç±»å‹çš„è€Œä¸æ˜¯charç±»å‹çš„ã€‚å¦‚ï¼š\n1  \u0026#34;Hello World!\u0026#34;.chars().forEach(System.out::print);   Out:\n72101108108111328711111410810033 å¦‚æœå®åœ¨ä¸ç¡®å®šç”¨ Stream è¿˜æ˜¯ç”¨è¿­ä»£æ¯”è¾ƒå¥½ï¼Œé‚£ä¹ˆå°±ä¸¤ç§éƒ½è¯•è¯•ï¼Œçœ‹çœ‹å“ªä¸€ç§æ›´å¥½ç”¨ã€‚\nä¼˜å…ˆé€‰æ‹©Streamä¸­æ— å‰¯ä½œç”¨çš„å‡½æ•°ã€‚ï¼ˆä»€ä¹ˆæ˜¯æ— å‰¯ä½œç”¨çš„å‡½æ•°å‘¢ï¼ŸæŒ‡å…¶ç»“æœåªå–å†³äºè¾“å…¥çš„å‡½æ•° : å®ƒä¸ä¾èµ–ä»»ä½•å¯ å˜çš„çŠ¶æ€ï¼Œä¹Ÿä¸æ›´æ–°ä»»ä½•çŠ¶æ€ ï¼‰\nç»ˆæ­¢æ“ä½œä¸­çš„ forEach åº”è¯¥åªç”¨æ¥æŠ¥å‘Šç”± Stream æ‰§è¡Œçš„è®¡ ç®—ç»“æœï¼Œè€Œä¸æ˜¯è®©å®ƒæ‰§è¡Œè®¡ç®—ã€‚\nStream è¦ä¼˜å…ˆç”¨ Collection ä½œä¸ºè¿”å›ç±»å‹ã€‚å¦‚æœè¿”å›çš„åºåˆ—è¶³å¤Ÿå°ï¼Œå®¹æ˜“å­˜å‚¨ï¼Œæˆ–è®¸æœ€å¥½è¿”å›æ ‡å‡†çš„é›†åˆå®ç°ï¼Œå¦‚ ArrayListæˆ–è€…HashSetã€‚ ä½†æ˜¯åƒä¸‡åˆ«åœ¨å†…å­˜ä¸­ä¿å­˜å·¨å¤§çš„åºåˆ—ï¼Œå°†å®ƒä½œä¸ºé›†åˆè¿”å›ã€‚\næµåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œä½¿ç”¨å®Œï¼ˆå®Œæˆç»ˆç«¯æ“ä½œï¼‰å°±ä¼šè¢«é”€æ¯ï¼š\n1 2 3 4  List\u0026lt;String\u0026gt; title = Arrays.asList(\u0026#34;Modern\u0026#34;, \u0026#34;Java\u0026#34;, \u0026#34;In\u0026#34;, \u0026#34;Action\u0026#34;); Stream\u0026lt;String\u0026gt; s = title.stream(); s.forEach(System.out::println); s.forEach(System.out::println);   Out(æŠ¥é”™ï¼Œä¸èƒ½å†ä½¿ç”¨å·²ç»ä½¿ç”¨è¿‡çš„æµ):\nModern Java In Action Exception in thread \u0026quot;main\u0026quot; java.lang.IllegalStateException: stream has already been operated upon or closed at java.util.stream.AbstractPipeline.sourceStageSpliterator(AbstractPipeline.java:279) at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:580) at com.sankuai.stafftraining.wujiahong.demo.springdemo.usages.MainApp.main(MainApp.java:22) ä¸­é—´æ“ä½œå’Œç»ˆç«¯æ“ä½œ ä¸­é—´æ“ä½œä¼šè¿”å›å¦ä¸€ä¸ªæµï¼Œé™¤éæµæ°´çº¿ä¸Šè§¦å‘ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œå¦åˆ™ä¸­é—´æ“ä½œä¸ä¼šæ‰§è¡Œä»»ä½•å¤„ç†ã€‚ï¼ˆä¸­é—´æ“ä½œä¸€èˆ¬éƒ½å¯ä»¥åˆå¹¶èµ·æ¥ï¼Œåœ¨ç»ˆç«¯æ“ä½œæ—¶ä¸€æ¬¡æ€§å…¨éƒ¨å¤„ç†ï¼‰ã€‚\nç»ˆç«¯æ“ä½œä¼šä»æµçš„æµæ°´çº¿ç”Ÿæˆç»“æœï¼Œå…¶ç»“æœæ˜¯ä»»ä½•ä¸æ˜¯æµçš„å€¼ï¼Œæ¯”å¦‚ Listã€Integerï¼Œç”šè‡³voidã€‚\nä¸­é—´æ“ä½œå‡½æ•°ï¼š\n   æ“ä½œ å‚æ•°æè¿°ç¬¦ ä½œç”¨     filter T -\u0026gt; boolean ä¿ç•™è¡¨è¾¾å¼ä¸­ä¸ºtrueçš„å…ƒç´    map T -\u0026gt; R è½¬æ¢å…ƒç´ çš„ç±»å‹   flatMap  å„ä¸ªæ•°ç»„å¹¶ä¸æ˜¯åˆ†åˆ«æ˜ ô²¡æˆä¸€ä¸ªæµï¼Œè€Œæ˜¯æ˜ å°„æˆæµçš„å†…å®¹   limit  é™åˆ¶è¿”å›å…ƒç´ çš„ä¸ªæ•°ï¼Œå‚æ•°ä¸ºå…ƒç´ çš„ä¸ªæ•°   sorted ï¼ˆTï¼ŒTï¼‰-\u0026gt; int å¯¹å…ƒç´ è¿›è¡Œæ’åº   distinct  å¯¹æ‰€æœ‰å…ƒç´ å»é‡ï¼Œä¸éœ€è¦å‚æ•°.(æ ¹æ®æµæ‰€ç”Ÿæˆå…ƒç´ çš„ hashCode å’Œ equals æ–¹æ³•å®ç°)   skip  è¿”å›æ‰”æ‰å‰nä¸ªå…ƒç´ çš„æµ               skipå’Œlimitæ“ä½œæ˜¯äº’è¡¥çš„ã€‚\n ç»ˆç«¯æ“ä½œå‡½æ•°ï¼š\n   æ“ä½œ è¿”å›ç±»å‹ ä½œç”¨     forEach void ä½¿ç”¨Lambdaæ¶ˆè´¹æµä¸­çš„æ¯ä¸ªå…ƒç´    count long è¿”å›æµæœ€åå…ƒç´ çš„æ•°é‡   collect generic æŠŠæµè§„çº¦æˆä¸€ä¸ªé›†åˆï¼Œæ¯”å¦‚Listã€Mapï¼Œç”šè‡³æ˜¯Integer   anyMatch boolean æ£€æŸ¥è°“è¯æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´    allMatch boolean æ£€æŸ¥è°“è¯æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´    noneMatch boolean æ£€æŸ¥è°“è¯æ˜¯å¦å…¨éƒ½ä¸åŒ¹é…   findAny Optional å¯¹è±¡ è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´    findFirst  æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´    reduce  å½’çº¦ï¼Œå°†å¤šä¸ªå…ƒç´ åˆæˆä¸€ä¸ª         flatMapä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9  List\u0026lt;String\u0026gt; arrayOfWords = Lists.newArrayList(\u0026#34;Goodbye\u0026#34;, \u0026#34;World\u0026#34;); List\u0026lt;String\u0026gt; uniqueCharacters = arrayOfWords.stream() .map(word -\u0026gt; word.split(\u0026#34;\u0026#34;)) .flatMap(Arrays::stream) .distinct() .collect(Collectors.toList()); System.out.println(uniqueCharacters);   outï¼š\n[G, o, d, b, y, e, W, r, l] reduceå®ç°å¾ªç¯ç›¸åŠ æ±‚å’Œï¼š\n1  int sum = numbers.stream().reduce(0, (a, b) -\u0026gt; a + b);   æ›´ä¼˜é›…çš„å†™æ³•ï¼š\n1  int product = nums.stream().reduce(0, Integer::sum);   æ‰¾æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼š\n1 2  Optional\u0026lt;Integer\u0026gt; max = numbers.stream().reduce(Integer::max); Optional\u0026lt;Integer\u0026gt; min = numbers.stream().reduce(Integer::min);   æ¶ˆé™¤éå—æ£€çš„è­¦å‘Š ç”¨æ³›å‹ç¼–ç¨‹æ—¶ä¼šé‡åˆ°è®²å¤šç¼–è¯‘å™¨è­¦å‘Š : éå—æ£€è½¬æ¢è­¦å‘Š( unchecked cast warning)ã€éå—æ£€æ–¹æ³•è°ƒç”¨è­¦å‘Šã€éå—æ£€å‚æ•°åŒ–å¯å˜å‚æ•°ç±»å‹è­¦å‘Š( unchecked parameterized vararg type warning)ï¼Œä»¥åŠéå—æ£€è½¬æ¢è­¦å‘Š( unchecked conversion warning)ã€‚\nå¦‚æœæ¶ˆé™¤äº†æ‰€æœ‰è­¦å‘Šï¼Œå°±å¯ä»¥ç¡® ä¿ä»£ç æ˜¯ç±»å‹å®‰å…¨çš„ è¿™æ˜¯ä¸€ä»¶å¾ˆå¥½çš„äº‹æƒ…ã€‚\nåº”è¯¥å§‹ç»ˆåœ¨å°½å¯èƒ½å°çš„èŒƒå›´å†…ä½¿ç”¨ SuppressWarnings æ³¨è§£ã€‚\n1  @SuppressWarnings (â€œunchecked\u0026#34;)   åˆ—è¡¨ä¼˜äºæ•°ç»„ åˆ—è¡¨ä½¿ç”¨èŒƒå‹ï¼Œè€ŒèŒƒå‹èƒ½å¤Ÿåœ¨ç¼–è¯‘æ—¶æœŸå°±æ£€æŸ¥å‡ºç±»å‹çš„é¢é—®é¢˜ã€‚æ•°ç»„ç±»å‹å¯èƒ½åœ¨è¿è¡Œæ—¶æ‰æŠ¥é”™ã€‚\nenumä½¿ç”¨ ä½¿ç”¨enumä»£æ›¿int Javaçš„æšä¸¾ç±»å‹æ˜¯åŠŸèƒ½ååˆ†é½å…¨çš„ç±»ï¼Œå…¶åŠŸèƒ½æ¯”å…¶ä»–è¯­è¨€ä¸­çš„å¯¹åº”ç±»å¼ºå¤§ å¾—å¤šï¼Œ Javaçš„æšä¸¾æœ¬è´¨ä¸Šæ˜¯Intå€¼\nJavaæšä¸¾ç±»å‹çš„åŸºæœ¬æƒ³æ³•éå¸¸ç®€å•:è¿™äº›ç±»é€šè¿‡å…¬æœ‰çš„é™æ€ finalåŸŸä¸ºæ¯ä¸ªæšä¸¾å¸¸é‡å¯¼ å‡ºä¸€ä¸ªå®ä¾‹ã€‚ æšä¸¾ç±»å‹æ²¡æœ‰å¯ä»¥è®¿é—®çš„æ„é€ å™¨ï¼Œæ‰€ä»¥å®ƒæ˜¯çœŸæ­£çš„ finalç±»ã€‚ å®¢æˆ·ç«¯ä¸èƒ½åˆ›å»º æšä¸¾ç±»å‹çš„å®ä¾‹ï¼Œä¹Ÿä¸èƒ½å¯¹å®ƒè¿›è¡Œæ‰©å±•ï¼Œå› æ­¤ä¸å­˜åœ¨å®ä¾‹ï¼Œè€Œåªå­˜åœ¨å£°æ˜è¿‡çš„æšä¸¾å¸¸ é‡ ã€‚ æ¢ å¥è¯è¯´ï¼Œæšä¸¾ç±»å‹æ˜¯å®ä¾‹å—æ§çš„(è¯¦è§ç¬¬ 6 é¡µ) ã€‚ å®ƒä»¬æ˜¯å•ä¾‹( Singleton) çš„æ³› å‹åŒ–ï¼Œæœ¬è´¨ä¸Šæ˜¯å•å…ƒç´ çš„æšä¸¾ ã€‚\næ¨¡ç‰ˆä½¿ç”¨ å¦‚æœä½ éœ€è¦é‡‡ç”¨æŸä¸ªç®—æ³•çš„æ¡†æ¶ï¼ŒåŒæ—¶åˆå¸Œæœ›æœ‰ä¸€å®šçš„çµæ´»åº¦ï¼Œèƒ½å¯¹å®ƒçš„æŸäº›éƒ¨åˆ†è¿›è¡Œæ”¹è¿›ï¼Œ é‚£ä¹ˆé‡‡ç”¨æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼æ˜¯æ¯”è¾ƒé€šç”¨çš„æ–¹æ¡ˆã€‚æ¢å¥è¯è¯´ï¼Œæ¨¡æ¿ æ–¹æ³•æ¨¡å¼åœ¨ä½ **â€œå¸Œæœ›ä½¿ç”¨è¿™ä¸ªç®—æ³•ï¼Œä½†æ˜¯éœ€è¦å¯¹å…¶ä¸­çš„æŸäº›è¡Œè¿›è¡Œæ”¹è¿›**ï¼Œæ‰èƒ½è¾¾åˆ°å¸Œæœ›çš„æ•ˆæœâ€ æ—¶æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚\n å¥½çš„ API æ–‡æ¡£åº”è¯¥æè¿°ä¸€ä¸ªç»™å®šçš„æ–¹æ³•åšäº†ä»€ä¹ˆå·¥ä½œï¼Œè€Œä¸ æ˜¯æè¿°å®ƒæ˜¯å¦‚ä½•åšåˆ°çš„ ã€‚\n æ¨¡ç‰ˆè®¾è®¡æ–¹æ³•\nJavaå¹¶å‘ CompletableFutureçš„åŸç†ä¸å®è·µ-è®°å¤–å–å•†å®¶ç«¯APIçš„å¼‚æ­¥åŒ–\nCompletableFutureåŠŸèƒ½ä»‹ç»ä¸åŸç†åˆ†æ_å°˜é—´çµ®çš„ä¸“æ -CSDNåšå®¢\nåŒæ­¥æ¨¡å‹çš„é—®é¢˜ï¼š\nä¼šæœ‰é˜»å¡çš„æ—¶é—´ã€‚\nå¼‚æ­¥ä¸»è¦æ˜¯ï¼šå‡å°‘çº¿ç¨‹æ± çš„è°ƒåº¦å¼€é”€å’Œé˜»å¡æ—¶é—´\nCompletableFutureçš„ä¼˜åŠ¿ï¼š\n å¯å¼‚æ­¥ å¯ç»„åˆï¼ˆç¼–æ’ï¼‰  åº”ç”¨åœºæ™¯ï¼š\nä½¿ç”¨CompletableFutureå¼‚æ­¥æ‰§è¡Œå¾ªç¯ä¸­çš„ä»»åŠ¡ | localhost\nç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ï¼šç»™ä½ ä¸€æ‰¹å•†å“ç¼–å·æŸ¥è¯¢å‡ºå•†å“çš„æ‰€æœ‰ç›¸å…³ä¿¡æ¯ï¼Œè¿™äº›å•†å“ä¿¡æ¯å¹¶ä¸èƒ½é€šè¿‡ä¸€æ¡sqlå°±ç›´æ¥è·å–åˆ°ï¼Œéœ€è¦å¯¹æ¯ä¸€ä»¶å•†å“è°ƒç”¨å¾ˆå¤šæ¥å£æ¥è·å–ç›¸å…³ï¼Œå› æ­¤æŸ¥ä¸€ä»¶å•†å“çš„è€—æ—¶è¾ƒé•¿ï¼Œå¦‚æœæŸ¥è¯¢çš„å•†å“è¾ƒå¤šä½¿ç”¨å¾ªç¯æ¥æ‰§è¡Œçš„è¯ï¼Œæ‰€è€—è´¹çš„æ—¶é—´è‚¯å®šæ˜¯ç‰¹åˆ«é•¿çš„ã€‚\nCompletableFutureå¤„ç†å·¥å…·ç±»ï¼š\n FutureUtils   ä¸¤ä¸ªæˆ–è€…å¤šä¸ªä»»åŠ¡çš„å¼‚æ­¥æ‰§è¡Œã€‚\nUsefulæ–¹æ³• computeifAbsent Java 8 ä¸­æ–°å¢çš„ computeifAbsent æ–¹æ³• ã€‚ è¿™ä¸ªæ–¹æ³•ä¼šåœ¨æ˜ å°„ä¸­æŸ¥æ‰¾ä¸€ä¸ªé”®:å¦‚æœ è¿™ä¸ªé”®å­˜åœ¨ï¼Œè¯¥æ–¹æ³•åªä¼šè¿”å›ä¸ä¹‹å…³è”çš„å€¼\n1 2 3 4 5  Map\u0026lt;Long, List\u0026lt;Long\u0026gt;\u0026gt; mm = Maps.newHashMap(); mm.computeIfAbsent(1L,key-\u0026gt;Lists.newArrayList()).add(2L); for (Entry\u0026lt;Long,List\u0026lt;Long\u0026gt;\u0026gt; kv:mm.entrySet()) { System.out.println(kv.getKey() +\u0026#34;---\u0026#34; +kv.getValue()); }   è¾“å‡ºï¼š\n1---[2]  è¦æ˜¯ä½¿ç”¨åŸå§‹çš„æ–¹æ³•ï¼Œç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š\n1 2 3 4 5 6 7 8  Map\u0026lt;Long, List\u0026lt;Long\u0026gt;\u0026gt; mm = Maps.newHashMap(); if(CollectionUtils.isEmpty(mm.get(1))) { mm.put(1L,Lists.newArrayList()); } for (Entry\u0026lt;Long,List\u0026lt;Long\u0026gt;\u0026gt; kv:mm.entrySet()) { System.out.println(kv.getKey() +\u0026#34;---\u0026#34; +kv.getValue()); }   è¿™æ ·æ²¡æœ‰ä½¿ç”¨computeIfAbsentæ–¹æ³•ç®€æ´ã€‚\n Map.uniqueIndex æ ¹æ®keyå¯¹åˆ—è¡¨åˆ›å»ºMapæ˜ å°„ã€‚\ngroupby \u0026amp; groupingBy groupingBy()æ˜¯Stream APIä¸­æœ€å¼ºå¤§çš„æ”¶é›†å™¨Collectorä¹‹ä¸€ï¼Œæä¾›ä¸SQLçš„GROUP BYå­å¥ç±»ä¼¼çš„åŠŸèƒ½ã€‚\nä½¿ç”¨å½¢å¼ï¼š\n1  .collect(groupingBy(...));   https://blog.csdn.net/daobuxinzi/article/details/100190366\nåˆ†ç»„ï¼š\n1 2 3 4 5  // é‡æ–°åˆ†ç»„ Map\u0026lt;String, List\u0026lt;CompareStockVO\u0026gt;\u0026gt; detailMap = afterFilter.stream() .collect(Collectors.groupingBy(compareStockVO -\u0026gt; StringUtils .joinWith(\u0026#34;-\u0026#34;, compareStockVO.getPoiId(), compareStockVO.getSkuId(), compareStockVO.getSupplierId())));   å¦å¤–ä¸€ç§èšåˆçš„æ–¹æ³•ï¼š\n1 2 3 4 5 6  // èšåˆ Map\u0026lt;String, WmsStockSkuLotExpiryPO\u0026gt; poiLot2Expire = lotExpiryPOS.stream().collect( Collectors.toMap( lotExpiryPO -\u0026gt; expirySyncService .getExpiryEsKey(lotExpiryPO.getLotId(), lotExpiryPO.getPoiId()), a -\u0026gt; a, (k1, k2) -\u0026gt; k1));   èšåˆï¼š\n// é‡æ–°èšåˆ List\u0026lt;CompareStockVO\u0026gt; result = Lists.newArrayList(); for (List\u0026lt;CompareStockVO\u0026gt; compareStockVOList : detailMap.values()) { Optional\u0026lt;CompareStockVO\u0026gt; compareStockVO = compareStockVOList.stream() .reduce((left, right) -\u0026gt; { left.setQuantity(left.getQuantity().add(right.getQuantity())); left.setLockQuantity(left.getLockQuantity().add(right.getLockQuantity())); return left; }); if (compareStockVO.isPresent()) { result.add(compareStockVO.get()); } } partition å°†ä¸€ä¸ªåˆ—è¡¨åˆ’åˆ†æˆå¤šä¸ªåˆ—è¡¨ï¼Œå‚æ•°æ˜¯æ¯ä¸ªåˆ—è¡¨çš„å¤§å°ï¼š\n1 2  List\u0026lt;List\u0026lt;Long\u0026gt;\u0026gt; subLists = Lists.partition(result,20); List\u0026lt;List\u0026lt;Integer\u0026gt;\u0026gt; subSets = ListUtils.partition(intList, 3);   flatMap Java8 Streamä½¿ç”¨flatMapåˆå¹¶List\nCompletableFuture CompletableFutureçš„ä½¿ç”¨\n","description":"è®°å½•Effective Javaçš„ä¸€äº›é‡ç‚¹","id":28,"section":"posts","tags":["Java","Effective Java"],"title":"java8ç¬”è®°ğŸ“’","uri":"https://hugo.jiahongw.com/zh/posts/java/java8-note/"},{"content":"Bash Shell å‘½ä»¤è¡Œé€šç”¨å¿«æ·é”®ï¼š\n| å¿«æ·é”® | ä½œç”¨ |\n|\u0026mdash;\u0026mdash;\u0026ndash;|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;-|\n|  | åˆ é™¤å‰ä¸€ä¸ªå­—ç¬¦ |\n|  | åˆ é™¤å‰ä¸€ä¸ªå•è¯ |\n|  | åˆ é™¤è‡³è¡Œé¦– |\n| | \u0026lt;++\u0026gt; |\n| \u0026lt;++\u0026gt; | \u0026lt;++\u0026gt; |\n| \u0026lt;++\u0026gt; | \u0026lt;++\u0026gt; |\n| \u0026lt;++\u0026gt; | \u0026lt;++\u0026gt; |\n| \u0026lt;++\u0026gt; | \u0026lt;++\u0026gt; |\n| \u0026lt;++\u0026gt; | \u0026lt;++\u0026gt; |\n| \u0026lt;++\u0026gt; | \u0026lt;++\u0026gt; |\n| \u0026lt;++\u0026gt; | \u0026lt;++\u0026gt; |\nKey Mapping:\n mapè¡¨ç¤ºé€’å½’çš„æ˜ å°„ unmapè¡¨ç¤ºåˆ é™¤æŸä¸ªæ˜ å°„     key explain map     nore è¡¨ç¤ºéé€’å½’ noremap   n è¡¨ç¤ºåœ¨æ™®é€šæ¨¡å¼ä¸‹ç”Ÿæ•ˆ nmap   v è¡¨ç¤ºåœ¨å¯è§†å’Œé€‰æ‹©æ¨¡å¼ä¸‹ç”Ÿæ•ˆ vmap   i è¡¨ç¤ºåœ¨æ’å…¥æ¨¡å¼ä¸‹ç”Ÿæ•ˆ imap   c è¡¨ç¤ºåœ¨å‘½ä»¤æ¨¡å¼ä¸‹ç”Ÿæ•ˆ cmap   x å¯è§†æ¨¡å¼ä¸‹ç”Ÿæ•ˆ xmap    vimé…ç½®å¿«æ·é”®å‚è€ƒï¼š\n   å¿«æ·é”® ä½œç”¨ åŠ©è®°     Ctrl j ä¸‹ç§»å½“å‰è¡Œæˆ–è€…æ®µè½    Ctrl k ä¸Šç§»å½“å‰è¡Œæˆ–è€…æ®µè½    Ctrl h     Ctrl l      æ¸…ç©ºé«˜äº®    r è°ƒå‡ºæ›¿æ¢å‘½ä»¤    rc è°ƒå‡ºæ›¿æ¢å‘½ä»¤ï¼ˆéœ€è¦ç¡®è®¤ï¼‰    su ä¸Šåˆ†å± é¼ æ ‡åœ¨ä¸Šåˆ†å± split up   se ä¸‹åˆ†å± é¼ æ ‡åœ¨ä¸‹åˆ†å± split end   sn å³åˆ†å± é¼ æ ‡åœ¨å³åˆ†å±    S ä¿å­˜ :w save   Q é€€å‡º :q quit   tu åˆ›å»ºæ–°çš„æ ‡ç­¾é¡µ    tn å·¦ç§»æ ‡ç­¾é¡µ    ti å³ç§»æ ‡ç­¾é¡µ    tmn äº¤æ¢å·¦è¾¹æ ‡ç­¾é¡µ    tmi äº¤æ¢å³è¾¹æ ‡ç­¾é¡µ    ev ç¼–è¾‘.vimrcæ–‡ä»¶    sv ä½¿.vimrcç”Ÿæ•ˆ    cp æ‹·è´å½“å‰çš„ç¼“å­˜è·¯å¾„åˆ°å‰ªåˆ‡æ¿     è‡ªåŠ¨æ˜¾ç¤ºæ‰€æœ‰çš„ç©ºæ ¼     æ‹¼å†™æ£€æŸ¥     è®¾ç½®ç›¸å¯¹è¡Œ    f æŸ¥æ‰¾æ–‡ä»¶          åŸå§‹å¿«æ·é”®\n   é”®ä½ ä½œç”¨      Ctrl w åˆ é™¤å‰ä¸€ä¸ªå•è¯    Ctrl h åˆ é™¤å‰ä¸€ä¸ªå­—ç¬¦    Ctrl u åˆ é™¤è‡³è¡Œé¦–     åˆ‡æ¢æ™®é€šæ¨¡å¼    Ctrl [ åˆ‡æ¢æ™®é€šæ¨¡å¼    Ctrl o åˆ‡æ¢åˆ°æ’å…¥-æ™®é€šæ¨¡å¼     æ•°å­—+1 18è¡¨ç¤ºæ•°å­—+180    æ•°å­—-1    g~ åè½¬å¤§å°å†™ é…åˆawä½¿ç”¨   gu è½¬åŒ–ä¸ºå°å†™ é…åˆawä½¿ç”¨   gU è½¬åŒ–ä¸ºç­”è°¢ é…åˆawä½¿ç”¨   \u0026gt; å¢åŠ ç¼©è¿›    \u0026lt; å‡å°ç¼©è¿›     å‘ä¸‹ç¿»ä¸€é¡µ     å‘ä¸Šç¿»ä¸€é¡µ     å›åˆ°ä¸Šæ¬¡ä¿®æ”¹çš„åœ°æ–¹     æ’¤é”€æ’¤é”€     å¸¸è§çš„ç­‰æ•ˆå‘½ä»¤ï¼š\n| ç¬¦åˆå‘½ä»¤ | ç­‰æ•ˆçš„é•¿å‘½ä»¤ |\n|\u0026mdash;\u0026mdash;\u0026mdash;-|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;|\n| C | c$ |\n| s | cl |\n| S | ^c |\n| I | ^i |\n| A | $a |\n| o | A |\n| O | ko |\nå°½é‡ä½¿ç”¨ç¬¦åˆå‘½ä»¤ï¼Œå‡å°‘æ•²å‡»é”®ç›˜çš„æ¬¡æ•°ã€‚\nvim-markdownå¿«æ·é”®å‚è€ƒï¼š\n   å¿«æ·é”® ä½œç”¨     ,b åŠ ç²—   ,p æ–œä½“   ,q è¡Œå†…ä»£ç å—   ,c ä»£ç å—   ,g todo   ,p å›¾ç‰‡   ,a é“¾æ¥   ,n å‡ å· æ ‡é¢˜    vim-table-modeæ’ä»¶å‚è€ƒä½¿ç”¨:\nvimä¸­å†™table\n   æŒ‰é”® åŠŸèƒ½     \\tm å¼€å¯æˆ–è€…å…³é—­table mode   \\T å°†å†…å®¹è½¬åŒ–ä¸ºè¡¨å“¥   \\tdd åˆ é™¤æŸä¸€è¡Œ   \\tdc åˆ é™¤å½“å‰åˆ—   \\tfa æ·»åŠ å…¬å¼   \\tfe è®¡ç®—å…¬å¼   \\ts å¯¹æŸä¸€åˆ—æ’åº    å…¶ä»–å‚è€ƒï¼š\nå¯è§†æ¨¡å¼ Vim æœ‰ 3 ç§ä¸åŒçš„å¯å¯è§†æ¨¡å¼ï¼Œåˆ†åˆ«ç”¨äºæ“ä½œå­—ç¬¦æ–‡æœ¬ã€è¡Œæ–‡æœ¬å’Œå—æ–‡æœ¬ã€‚\né¢å‘å­—ç¬¦ é€‚åˆæ“ä½œå•è¯å’ŒçŸ­è¯­ã€‚æ¿€æ´»ï¼šv\nè¡Œæ–‡æœ¬ é€‚åˆæ“ä½œè¡Œæ–‡æœ¬ã€‚æ¿€æ´»ï¼šVã€‚\né€‰æ‹©å¤šè¡Œæ‰§è¡Œå‘½ä»¤ï¼š\nä¾‹å¦‚ï¼šVj + \u0026gt;. è¡¨ç¤ºå°†ä¸‹é¢ä¸¤è¡Œè¿›è¡Œä¸¤æ¬¡ç¼©è¿›\nå—æ–‡æœ¬ é€‚åˆæ“ä½œè¡¨æ ¼æˆ–è€…csvæ–‡ä»¶ã€‚æ¿€æ´»ï¼š\nåœ¨é•¿çŸ­ä¸ä¸€çš„é«˜äº®å—åé¢æ·»åŠ æ–‡æœ¬ã€‚æ“ä½œï¼š + 2j + $ + A + â€œæ·»åŠ çš„å­—ç¬¦ä¸²â€ + \n   å‘½ä»¤ ä½œç”¨     viw é«˜äº®ä¸€ä¸ªè¯(ç„¶åæŒ‰cè¿›è¡Œä¿®æ”¹)    or v å¯ä»¥åœ¨å¯è§†æ¨¡å¼å’Œé€‰æ‹©æ¨¡å¼ä¹‹é—´åˆ‡æ¢   b é€‰æ‹©å‰ä¸€ä¸ªè¯   w é€‰æ‹©åä¸€ä¸ªè¯   o å›åˆ°é€‰æ‹©çš„åˆå§‹ä½ç½®   e é€‰æ‹©åˆ°æœ«å°¾   vit é«˜äº®é€‰ä¸­æ ‡ç­¾å†…éƒ¨çš„å†…å®¹   U é€‰ä¸­çš„å­—ç¬¦å˜ä¸ºå¤§å†™(æ™®é€šæ¨¡å¼ä½¿ç”¨gUitæ›´ä¸ºå‡†ç¡®)   u é€‰ä¸­çš„å­—ç¬¦å˜ä¸ºå°å†™   r+å­—ç¬¦ é€‰æ‹©åŒºåŸŸæ›¿æ¢ä¸ºå­—ç¬¦    ä½¿ç”¨ç‚¹å‘½ä»¤æœ€å¥½é¿å…å¯è§†æ¨¡å¼ã€‚\nå‘½ä»¤è¡Œæ¨¡å¼ å¾…è¡¥å……ã€‚ã€‚ã€‚\nvimå®ç”¨æŠ€å·§ï¼š\n æŠŠæ’¤é”€å•å…ƒåˆ‡æˆå—ã€‚ ä»è¿›å…¥æ’å…¥æ¨¡å¼å¼€å§‹ï¼Œç›´åˆ°è¿”å›æ™® é€šæ¨¡å¼ä¸ºæ­¢ï¼Œåœ¨æ­¤æœŸé—´è¾“å…¥æˆ–åˆ é™¤çš„ä»»ä½•å†…å®¹éƒ½è¢«å½“æˆä¸€æ¬¡ä¿®æ”¹ã€‚å› æ­¤ï¼Œåªè¦æˆ‘ä»¬æ§åˆ¶ å¥½å¯¹  é”®çš„ä½¿ç”¨ï¼Œå°±å¯ä½¿æ’¤é”€å‘½ä»¤ä½œç”¨äºå•è¯ã€å¥å­æˆ–æ®µè½ å½“å¤„äºæ’å…¥æ¨¡å¼æ—¶ï¼Œå¦‚æœå…‰æ ‡ä½äºè¡Œå°¾çš„è¯ï¼Œå¦èµ·ä¸€è¡Œæœ€å¿«çš„æ–¹å¼æ˜¯æŒ‰ã€‚ä¸ è¿‡æœ‰æ—¶æˆ‘æ›´å–œæ¬¢æŒ‰ oï¼Œè¿™æ˜¯å› ä¸ºæˆ‘æœ‰é¢„æ„Ÿï¼Œä¹Ÿè®¸åœ¨æ’¤é”€æ—¶æˆ‘æƒ³æ‹¥æœ‰æ›´ç»†çš„ç²’åº¦ 124  å‘  æ‰“å¼€vimå›åˆ°ä¸Šæ¬¡çš„ä½ç½®ï¼šhttps://www.dyxmq.cn/linux/vim-setting-mouse-place.html  ","description":"","id":29,"section":"posts","tags":["vim"],"title":"vimä½¿ç”¨ç¬”è®°","uri":"https://hugo.jiahongw.com/zh/posts/efficient/vim/"},{"content":"ä¸ç»æ„é—´çœ‹è§äº†ä¸‹é¢çš„è¿™ç¯‡åšæ–‡ï¼Œè”æƒ³åˆ°è‡ªå·±ï¼Œæˆ‘è‡ªå·±å’Œçˆ¶äº²çš„å…³ç³»å°±éå¸¸ç±»ä¼¼ä¸‹é¢åšä¸»å’Œä»–çˆ¶äº²çš„å…³ç³»ã€‚\n æ–‡ç« é“¾æ¥(å¯èƒ½éœ€è¦ç¿»å¢™)   æˆ‘è‡ªå·±å¯¹å¾…çˆ¶äº²å…¶å®ä¸€ç›´ä»¥æ¥éƒ½å¾ˆå†·æ¼ ï¼Œä¹‹å‰æœ‰æ®µæ—¶é—´è¿˜ç»å¸¸çš„åµæ¶ï¼Œå› ä¸ºä¸€äº›äº‹ã€‚ä»”ç»†æƒ³ä¸€ä¸‹ï¼Œå¾ˆå¤šä¸œè¥¿æ˜¯å¤±å»äº†ä¹‹åæ‰æ‡‚å¾—çæƒœï¼Œä¹Ÿæœ‰å¾ˆå¤šä¸œè¥¿ï¼Œæ˜¯è‡ªå·±äº²èº«ä½“éªŒäº†ä¹‹åæ‰çŸ¥é“é‡Œé¢çš„è‹¦æ¥šã€‚æˆ‘å¯¹çˆ¶äº²çš„ä¸ç†è§£ï¼Œæˆ–è®¸åªæ˜¯æˆ‘æ²¡æœ‰ç»å†è¿‡ä»–ç»å†çš„ï¼Œä¹Ÿæˆ–è®¸æ˜¯æˆ‘è‡ªå·±çš„å‚²æ…¢ã€‚\nä½†æ˜¯ä¸ç®¡æ€ä¹ˆè¯´ï¼Œè¿™ç¯‡æ–‡ç« éƒ½ç›´æ¥ç»™äº†æˆ‘ä¸€ä¸ªè­¦ç¤ºï¼Œè®©æˆ‘æ€è€ƒå’Œçˆ¶äº²ç›¸å¤„çš„æ–¹å¼ã€‚æˆ‘çš„çˆ¶äº²ä¹Ÿå°†è¿‘äº”åå²äº†ï¼Œä¸€è·¯èµ°æ¥ä¹Ÿä¸å®¹æ˜“ï¼Œæˆ‘è¿˜æ˜¯åº”è¯¥æ„Ÿè°¢ä»–ï¼Œä¸ºæˆ‘ä»˜å‡ºäº†è¿™ä¹ˆå¤šï¼Œè€Œä¸”å¯èƒ½å¾ˆå¤šèƒŒåçš„ä»˜å‡ºæ˜¯æˆ‘æ²¡æœ‰çœ‹åˆ°çš„ã€‚æˆ‘éƒ½åº”è¯¥åœ¨æ¥ä¸‹æ¥çš„æ—¥å­é‡Œé¢å¥½å¥½çš„å›é¦ˆä»–ã€‚ä»¥å‰æˆ‘æ²¡æœ‰ä»€ä¹ˆå¯ä»¥ç»™ä»–ï¼Œä½†æ˜¯ç°åœ¨æˆ‘å·¥ä½œäº†ï¼Œè‡³å°‘è¿˜æ˜¯èƒ½å¤Ÿæœ‰ä¸€äº›èµ„æœ¬å¯ä»¥ç»™ä»–ä¹°ç‚¹ä¸œè¥¿æˆ–è€…è®©ä»–ç”Ÿæ´»çš„æ›´å¥½ï¼Œä¹Ÿå¸Œæœ›ä¹‹åçš„ä»–èƒ½å¤Ÿæ›´åŠ çš„å¿«ä¹ã€‚\nåŒæ—¶ï¼Œè¿™ç¯‡åšæ–‡ä¹Ÿè¯´äº†ï¼Œå¥åº·æ‰æ˜¯æœ€é‡è¦çš„ï¼Œè¦è¿‡å°±è¿‡æœ‰æ„ä¹‰çš„ç”Ÿæ´»ï¼Œæ¯”èµ·ä»–ä»€ä¹ˆéƒ½é‡è¦ã€‚ä¸‹é¢å¼•ç”¨æ–‡ç« ä½œè€…çš„ä¸€å¥è¯ï¼Œæˆ‘è§‰å¾—éå¸¸æœ‰é“ç†ï¼š\nå¦‚æœè¯´æˆ‘ä»è¿™æ®µäº²å­å…³ç³»é‡Œå­¦åˆ°äº†ä»€ä¹ˆï¼Œé‚£å°±æ˜¯è‡ªå·±çš„èº«ä½“å¥åº·ï¼Œå’Œé‡è¦çš„äººåº¦è¿‡æœ‰è´¨é‡ã€æœ‰æ„ä¹‰çš„æ—¶å…‰ï¼Œæ¯”ä»€ä¹ˆç‹—å±æˆç»©ã€èŒä½ã€æ”¶å…¥ï¼Œéƒ½é‡è¦çš„å¤šï¼Œä½ å¿…é¡»è‡ªå·±ç…§é¡¾å¥½è‡ªå·±ã€‚ ","description":"ç”Ÿæ´»ä¸­å¾ˆå°‘æ³¨æ„ä¸€äº›ä¸œè¥¿ï¼Œé”™è¿‡äº†å°±å°†ä¸å¤å­˜åœ¨ã€‚çæƒœå½“ä¸‹ï¼","id":30,"section":"posts","tags":["Life"],"title":"ä¸€ç¯‡æ–‡ç« æƒ³åˆ°çˆ¶äº²","uri":"https://hugo.jiahongw.com/zh/posts/life/myfather-some/"},{"content":"Youtubeä¸­çš„ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„è§†é¢‘æ´»åŠ¨ã€‚åœ¨èŠåŠ å“¥çš„å¤§è¡—ä¸Šï¼Œçœ‹çœ‹è·¯äººèƒ½å¦è§£å†³ä¸€äº›åˆçº§çš„ç¼–ç¨‹é—®é¢˜ï¼Œè§£å†³é—®é¢˜çš„èƒ½å¤Ÿå¾—åˆ°100ç¾å…ƒï¼Œéå¸¸æœ‰æ„æ€ã€‚å¯¹äºæˆ‘ä»¬æ¥è¯´è¿™äº›é—®é¢˜éå¸¸çš„ç®€å•ï¼Œä½†æ˜¯å¯¹äºæ™®é€šäººæ¥è¯´ï¼Œè¿˜æ˜¯æœ‰ä¸€å®šçš„éš¾åº¦çš„ã€‚ä¼¼ä¹åœ¨èŠåŠ å“¥çš„è¡—å¤´ä¸Šä¹Ÿä¼šç¼–ç¨‹çš„ä¹Ÿä¸æ˜¯æŒºå¤šäººï¼Œæˆ–è€…ï¼Œç¨‹åºçŒ¿éƒ½åœ¨ä¸Šç­å§ğŸ¶ã€‚\n åœ¨ç¬¬äºŒæœŸçš„é—®é¢˜å˜å¾—æ¯”è¾ƒéš¾ä¸€ç‚¹ï¼Œæ˜¯collegeæ°´å¹³çš„ï¼Œè§£å†³é—®é¢˜çš„èƒ½å¤Ÿå¾—åˆ°200ç¾å…ƒã€‚åé¢é‚£ä¸ªç†Ÿæ‚‰çš„åˆ¤æ–­å›æ–‡ä¸²ğŸ˜„ã€‚\n æƒ³è±¡è¿™ä¸ªæ´»åŠ¨è¦æ˜¯åœ¨ä¸­å›½è¯•ä¸€è¯•ï¼Œæ„Ÿè§‰è¡—å¤´å¾ˆå¤šäººèƒ½å¤Ÿåšå‡ºæ¥ï¼Œå› ä¸ºä¸­å›½çš„ç¨‹åºå‘˜è¶Šæ¥è¶Šå¤šäº†ã€‚\n","description":"Youtubeä¸­çš„ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„è§†é¢‘æ´»åŠ¨ã€‚åœ¨èŠåŠ å“¥çš„å¤§è¡—ä¸Šï¼Œçœ‹çœ‹è·¯äººèƒ½å¦å§å§ä¸€äº›åˆçº§çš„ç¼–ç¨‹é—®é¢˜ã€‚","id":31,"section":"posts","tags":["FunnySharing"],"title":"è¡—å¤´ä»£ç ç¼–ç¨‹","uri":"https://hugo.jiahongw.com/zh/posts/funnysharing/code-problem-solving-onstreet/"},{"content":"Javaè¯­è¨€è™½ç„¶å·ç§°ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼Œä½†åŸå§‹æ•°æ®ç±»å‹æ˜¯ä¾‹å¤–ã€‚\n åœ¨Java 5ä¸­ï¼Œå¼•å…¥äº†è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±åŠŸèƒ½ï¼ˆboxing/unboxingï¼‰ï¼ŒJavaå¯ä»¥æ ¹æ®ä¸Šä¸‹æ–‡ï¼Œè‡ªåŠ¨è¿›è¡Œè½¬æ¢ï¼Œæå¤§åœ°ç®€åŒ–äº†ç›¸å…³ç¼–ç¨‹ã€‚\n è‡ªåŠ¨è£…ç®±å®é™…ä¸Šç®—æ˜¯ä¸€ç§è¯­æ³•ç³– ã€‚å°±æ˜¯ä¿è¯ä¸åŒçš„å†™æ³•åœ¨è¿è¡Œæ—¶æ˜¯ç­‰ä»·çš„ã€‚å®ƒä»¬å‘ç”Ÿåœ¨ç¼–è¯‘é˜¶æ®µ ï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆçš„å­—èŠ‚ç æ˜¯ä¸€è‡´çš„ã€‚\n  è£…ç®±è¡¨ç¤ºå°†åŸå§‹æ•°æ®ç±»å‹è¿›è¡Œå°è£…èµ·æ¥ï¼Œç„¶åæ·»åŠ ä¸€äº›æ“ä½œä¾‹å¦‚æ•°å­¦è®¡ç®—å’Œå­—ç¬¦ä¸²è½¬æ¢ç­‰ã€‚\n  æ‹†ç®±è¡¨ç¤ºå°†ä¸€ä¸ªå°è£…äº†åŸå§‹æ•°æ®ç±»å‹çš„å¯¹è±¡è½¬å›ä¸ºåŸå§‹æ•°æ®ç±»å‹ã€‚\n  Javaçš„8ä¸ªåŸå§‹æ•°æ®ç±»å‹ï¼ˆbooleanã€byte ã€shortã€charã€intã€floatã€doubleã€long)åˆ†åˆ«å¯¹åº”çš„8ä¸ªå°è£…å¯¹è±¡ä¸ºBooleanã€Byteã€Shortã€Characterã€Integerã€Floatã€Doubleã€Longã€‚\nåœ¨Javaä¸­ï¼Œå‡ ä¹æ‰€æœ‰çš„åŸºæœ¬ç±»å‹å°è£…ç±»åœ¨è¿›è¡Œè‡ªåŠ¨è£…ç®±çš„æ—¶å€™éƒ½å®ç°äº†ç¼“å­˜ã€‚\n  Integerï¼Œç¼“å­˜äº†-128åˆ°127ä¹‹é—´çš„æ•°å€¼\n  Booleanï¼Œç¼“å­˜äº†true/falseå¯¹åº”å®ä¾‹ï¼Œç¡®åˆ‡è¯´ï¼Œåªä¼šè¿”å›ä¸¤ä¸ªå¸¸é‡å®ä¾‹Boolean.TRUE/FALSEã€‚\n  Shortï¼ŒåŒæ ·æ˜¯ç¼“å­˜äº†-128åˆ°127ä¹‹é—´çš„æ•°å€¼ã€‚\n  Byteï¼Œæ•°å€¼æœ‰é™ï¼Œæ‰€ä»¥å…¨éƒ¨éƒ½è¢«ç¼“å­˜ã€‚\n  Characterï¼Œç¼“å­˜èŒƒå›´â€™u0000â€™ åˆ° â€˜u007Fâ€™\n  è¿™åœ¨ä¸€å®šç¨‹åº¦èƒ½å¤ŸèŠ‚çœå†…å­˜ï¼Œæé«˜æ€§èƒ½ã€‚ä½†æ˜¯åŸåˆ™ä¸Šï¼Œå»ºè®®é¿å…æ— æ„ä¸­çš„è£…ç®±ã€æ‹†ç®±è¡Œä¸º ï¼Œå°¤å…¶æ˜¯åœ¨æ€§èƒ½æ•æ„Ÿçš„åœºåˆï¼Œåˆ›å»º10ä¸‡ä¸ªJavaå¯¹è±¡å’Œ10ä¸‡ä¸ªæ•´æ•°çš„å¼€é”€å¯ä¸æ˜¯ä¸€ä¸ªæ•°é‡çº§çš„ ï¼Œä¸ç®¡æ˜¯å†…å­˜ä½¿ç”¨è¿˜æ˜¯å¤„ç†é€Ÿåº¦ï¼Œå…‰æ˜¯å¯¹è±¡å¤´çš„ç©ºé—´å ç”¨å°±å·²ç»æ˜¯æ•°é‡çº§çš„å·®è·äº†ã€‚ä¸€äº›è¿½æ±‚æè‡´æ€§èƒ½çš„äº§å“æˆ–è€…ç±»åº“ï¼Œä¼šæåŠ›é¿å…åˆ›å»ºè¿‡å¤šå¯¹è±¡ã€‚å½“ç„¶ï¼Œåœ¨å¤§å¤šæ•°äº§å“ä»£ç é‡Œï¼Œå¹¶æ²¡æœ‰å¿…è¦è¿™ä¹ˆåšï¼Œè¿˜æ˜¯ä»¥å¼€å‘æ•ˆç‡ä¼˜å…ˆã€‚éœ€è¦æƒè¡¡åˆ©å¼Šã€‚\nIntegerä¾‹å­ javacæ›¿æˆ‘ä»¬è‡ªåŠ¨æŠŠè£…ç®±è½¬æ¢ä¸ºInteger.valueOf()ï¼ŒæŠŠæ‹†ç®±æ›¿æ¢ä¸ºInteger.intValue()ï¼Œæ—¢ç„¶è°ƒç”¨çš„æ˜¯Integer.valueOfï¼Œè‡ªç„¶èƒ½å¤Ÿå¾—åˆ°ç¼“å­˜çš„å¥½å¤„ã€‚\nä¸‹é¢çš„è°ƒç”¨äº†è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±ï¼š\n1 2  Integer integer = 1;// è‡ªåŠ¨è£…ç®± int unboxing = integer ++;//è‡ªåŠ¨æ‹†ç®±   åç¼–è¯‘å¾—åˆ°ï¼š\n1 2 3 4  1: invokestatic #2 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer; 8: invokevirtual #3 // Method java/lang/Integer.intValue:()I   å³è£…ç®±è½¬æ¢ä¸ºInteger.valueOf()ï¼ŒæŠŠæ‹†ç®±æ›¿æ¢ä¸ºInteger.intValue()ï¼Œåœ¨Javaæºç å¯è§è¿™ä¸ªå€¼é»˜è®¤ç¼“å­˜æ˜¯-128åˆ°127ä¹‹é—´ã€‚\næºç \nç¼“å­˜èŒƒå›´ï¼š\nè£…ç®±æ“ä½œ\næ‹†ç®±æ“ä½œ\n","description":"åœ¨Java 5ä¸­ï¼Œå¼•å…¥äº†è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±åŠŸèƒ½ï¼ˆboxing/unboxingï¼‰ï¼ŒJavaå¯ä»¥æ ¹æ®ä¸Šä¸‹æ–‡ï¼Œè‡ªåŠ¨è¿›è¡Œè½¬æ¢ï¼Œæå¤§åœ°ç®€åŒ–äº†ç›¸å…³ç¼–ç¨‹ã€‚","id":32,"section":"posts","tags":["Java"],"title":"Javaè£…ç®±æ‹†ç®±","uri":"https://hugo.jiahongw.com/zh/posts/java/boxing-unboxing/"},{"content":"æåŒ–ç¼–ç çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šåªåœ¨$Z\\left( W_{N}^{\\left( i \\right)} \\right)$è¿‘äº0çš„åæ ‡ä¿¡é“$W_{N}^{\\left( i \\right)}$ä¸Šå‘é€æ•°æ®æ¯”ç‰¹ã€‚æåŒ–ç å…·æœ‰ä¸€èˆ¬çš„äºŒå…ƒçº¿æ€§åˆ†ç»„ç çš„åŸºæœ¬ç¼–ç è¦ç´ ï¼Œå› è€Œå¯ä»¥é€šè¿‡æ˜¾ç¤ºåœ°å†™å‡ºå…¶ç”ŸæˆçŸ©é˜µæ¥å®Œæˆç¼–ç ï¼š\n$$\nx_{1}^{N}=u_{1}^{N}{G_{N}}\n$$\nå…¶ä¸­ï¼Œç¼–ç ç”ŸæˆçŸ©é˜µ${G_{N}}\\text{=}{B_{N}}{F^{\\otimes n}}$ï¼Œ$B_{N}$æ˜¯æ’åºçŸ©é˜µï¼Œå®Œæˆæ¯”ç‰¹çš„ååºæ“ä½œï¼Œ$F^{\\otimes n}$è¡¨ç¤ºçŸ©é˜µ$F$è¿›è¡Œ$n$æ¬¡$Kronecker$ç§¯æ“ä½œï¼Œæœ‰é€’å½’å…¬å¼${F^{\\otimes n}}=F\\otimes {F^{\\otimes \\left( n-1 \\right)}}$ä¸”${F^{\\otimes 1}}\\text{=}F=\\left[ \\begin{matrix}\n1 \u0026amp; 0 \\\n1 \u0026amp; 1 \\\n\\end{matrix} \\right]$ã€‚\nä¸»è¦çš„æ­¥éª¤ä¸ºï¼š\nå¯é æ€§ä¼°è®¡ å¯é æ€§ä¼°è®¡å°±æ˜¯æåŒ–ç çš„æ„é€ ï¼Œè¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬é€‰å‡ºä¿¡é“å®¹é‡é«˜çš„å­ä¿¡é“è¿›è¡Œä¼ è¾“ï¼Œä¿¡é“å®¹é‡ä½çš„å­ä¿¡é“ä¼ è¾“å†»ç»“æ¯”ç‰¹ã€‚\nå¸¸è§çš„å‡ ç§å¯é æ€§ä¼°è®¡çš„æ–¹æ³•ï¼ˆæåŒ–ç æ„é€ æ–¹æ³•ï¼‰æœ‰ï¼š\n  å·´å£«å‚æ•°ä¼°è®¡æ³•ã€‚\n  è’™ç‰¹å¡æ´›æ³•ã€‚\n  å¯†åº¦è¿›åŒ–æ³•ã€‚\n  é«˜æ–¯è¿‘ä¼¼æ³•ã€‚\n  æ¯”ç‰¹æ··åˆ å‡è®¾é€šè¿‡é”™è¯¯æ¦‚ç‡è¿›è¡ŒæåŒ–ç æ„é€ ä¹‹åå¾—åˆ°æåŒ–åºåˆ—ä¸º$\\left{ 3,5,6,7,0,1,2,4 \\right}$ ï¼Œé€‰æ‹©å‰é¢Kä¸ªä¿¡é“å³$A=\\left{ 3,5,6,7\\right}$å‘é€ä¿¡æ¯æ¯”ç‰¹ï¼›å¦å¤–çš„ä¿¡é“é›†åˆ${A^{c}}=\\left{ 0,1,2,4\\right}$ä½œä¸ºå›ºå®šæ¯”ç‰¹ä¼ è¾“ã€‚è®¾ä¿¡æ¯æ¯”ç‰¹é›†åˆä¸º$\\left( {i_{0}},{i_{1}},{i_{2}},{i_{3}} \\right)=\\left( 1,1,1,1 \\right)$ï¼Œå›ºå®šæ¯”ç‰¹è®¾ç½®ä¸º0ï¼Œåˆ™æœ€ç»ˆå¾—åˆ°å¾…ç¼–ç çš„ä¿¡æ¯æ¯”ç‰¹ï¼š\n$$\nu_{0}^{7}=\\left[ 0,0,0,{i_{0}},0,{i_{1}},{i_{2}},{i_{3}} \\right]=\\left[ 0,0,0,1,0,1,1,1 \\right]\n$$\nç»è¿‡ä¸Šé¢çš„è¿‡ç¨‹æˆ‘ä»¬å°±å®Œæˆäº†å¯¹ä¿¡æ¯ä½å’Œå†»ç»“ä½çš„æ¯”ç‰¹æ··åˆã€‚\næ„é€ ç”ŸæˆçŸ©é˜µ é¦–å…ˆæˆ‘ä»¬æ±‚å‡ºæ’åºçŸ©é˜µ$B_{N}$ï¼Œå…¶æœ‰é€’å½’å¼ï¼š\n$$\n{B_{N}}={R_{N}}\\left( {I_{2}}\\otimes {B_{N/{2};}} \\right)\n$$\n$$\n{B_{2}}={I_{2}}\n$$\næˆ‘ä»¬å¾—åˆ°æ’åºçŸ©é˜µ$B_{N}$ï¼Œå¯¹è¾“å…¥åºåˆ—å®Œæˆå¥‡åºå…ƒç´ å’Œå¶åºå…ƒç´ çš„åˆ†ç¦»ï¼Œå³å…ˆæ’å¥‡åºå…ƒç´ ï¼Œå†æ’å¶åºå…ƒç´ ï¼Œå…¶ä½œä¸ºæ•ˆæœå¦‚ä¸‹:\n$$\n\\left( {u_{1}},{u_{2}},{u_{3}},{u_{4}},\u0026hellip;,u{}*{N} \\right)\\times {R* {N}}=\\left( {u_{1}},{u_{3}},{u_{5}},\u0026hellip;,{u_{N-1}},{u_{2}},{u_{4}},{u_{6}},\u0026hellip;,{u_{N}} \\right)\n$$\n$F$çŸ©é˜µæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸‹é¢çš„é€’å½’å¼è¿›è¡Œæ±‚è§£ï¼š\n$$\n{F^{\\otimes n}}=F\\otimes {F^{\\otimes \\left( n-1 \\right)}}\n$$\n$$\nF=\\left[ \\begin{matrix}\n1 \u0026amp; 0 \\\n1 \u0026amp; 1 \\\n\\end{matrix} \\right]\n$$\næœ€åï¼Œæˆ‘ä»¬å°†æ±‚å¾—çš„æ’åºçŸ©é˜µå’Œ$F$çŸ©é˜µç›¸ä¹˜ï¼Œå¾—åˆ°ç”ŸæˆçŸ©é˜µ$G_{N}$ï¼š\n$$\n{G_{N}}={B_{N}}{F^{\\otimes n}}\n$$\nå‡è®¾æˆ‘ä»¬æ±‚å¾—çš„ç”ŸæˆçŸ©é˜µæ˜¯ï¼š\nç”ŸæˆæåŒ–ç  å°†ä¿¡æ¯æ¯”ç‰¹ä¸ç”ŸæˆçŸ©é˜µ$G_{N}$ç›¸ä¹˜å¾—åˆ°æœ€ç»ˆç¼–ç åçš„æåŒ–ç ï¼Œä¾‹å¦‚ï¼š\nå‚è€ƒï¼š\n Polar Codeï¼ˆ2ï¼‰ç¼–ç åŸç† | Marshall - Comm. Tech. Blog  ","description":"æåŒ–ç çš„ç¼–ç å°±æ˜¯ä¸€äº›ç®€å•çš„çº¿æ€§è¿ç®—ï¼Œé€šè¿‡çŸ©é˜µè¿›è¡Œç®€åŒ–å¤šç»´çš„è¿ç®—ï¼Œå½’æ ¹åˆ°åº•è¿˜æ˜¯åŸºäºåŸºæœ¬çš„å¼‚æˆ–æ“ä½œã€‚","id":33,"section":"posts","tags":["PolarCode","ç¼–ç "],"title":"æåŒ–ç -ç¼–ç ","uri":"https://hugo.jiahongw.com/zh/posts/polarcode/polar-code-encode/"},{"content":"åŸºæœ¬æ¦‚å¿µ ä¿¡å™ªæ¯” ä¿¡å™ªæ¯”ï¼Œè‹±æ–‡åç§°å«åšSNRï¼ˆSIGNAL-NOISE RATIO )ï¼Œæ˜¯æŒ‡ä¸€ä¸ªç”µå­è®¾å¤‡æˆ–è€…ç”µå­ç³»ç»Ÿä¸­ä¿¡å·ä¸å™ªå£°çš„æ¯”ä¾‹ã€‚ä¿¡å™ªæ¯”çš„è®¡ç®—å¯ä»¥ä¸ºæœ‰ç”¨ä¿¡å·åŠŸç‡ä¸å™ªå£°åŠŸç‡çš„æ¯” ï¼š\n$$\nSNR = \\frac {P_{signal}} {P_{noise}}\n$$\nå®ƒçš„å•ä½ä¸€èˆ¬ä½¿ç”¨åˆ†è´ï¼Œå…¶å€¼ä¸ºåå€å¯¹æ•°ä¿¡å·ä¸å™ªå£°åŠŸç‡æ¯”:\n$$\nSNR(dB) = 10\\log_{10}(\\frac {P_{sibnal}} {P_{noise}})\n$$\nå…¶ä¸­ï¼Œ$P_{signal}$ä¸ºä¿¡å·åŠŸç‡ï¼Œ$P_{noise}$ä¸ºå™ªå£°åŠŸç‡ã€‚\nè½¬ç§»æ¦‚ç‡ ä¸€ä¸ªäºŒè¿›åˆ¶è¾“å…¥ç¦»æ•£æ— è®°å¿†ä¿¡é“ï¼ˆB-DMCï¼‰å¯è¡¨ç¤ºä¸º$W:X\\to Y$ï¼Œ$X$æ˜¯è¾“å…¥ç¬¦å·é›†åˆï¼Œ$Y$æ˜¯è¾“å‡ºç¬¦å·é›†åˆï¼Œè½¬ç§»æ¦‚ç‡ä¸º$W\\left( y|x \\right),x\\in X,y\\in Y$ã€‚ç”±äºä¿¡é“æ˜¯äºŒè¿›åˆ¶è¾“å…¥ï¼Œé›†åˆ$X=\\left{ 0,1 \\right}$ï¼›$Y$å’Œ$W\\left( y|x \\right)$æ˜¯ä»»æ„å€¼ã€‚å¯¹ä¿¡é“$W$çš„$N$æ¬¡ä½¿ç”¨åçš„ä¿¡é“å¯è¡¨ç¤ºä¸º${W^{N}}$ï¼Œåˆ™ä¿¡é“${W^{N}}:{X^{N}}\\to {Y^{N}}$çš„è½¬ç§»æ¦‚ç‡ä¸ºï¼š\n$$\n{W^{N}}\\left( y_1^{N}|x_{1}^{N} \\right)=\\prod\\nolimits_{i=1}^{N}{W\\left( y|x \\right)}\n$$\nå¯¹ç§°å®¹é‡ å¯¹ç§°å®¹é‡æ˜¯å¯¹ä¿¡é“é€Ÿç‡çš„åº¦é‡ï¼Œè®°ä½œ$I(W)$ï¼Œè¡¨ç¤ºä¿¡é“$W$åœ¨ç­‰æ¦‚ç‡è¾“å…¥ä¸‹çš„å¯é ä¼ è¾“æ—¶çš„æœ€å¤§é€Ÿç‡,è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š\n$$\nI\\left( W \\right)\\triangleq \\sum\\limits_{y\\in Y}{\\sum\\limits_{x\\in X}{\\frac{1}{2}}}W\\left( y|x \\right)\\log \\frac{W\\left( y|x \\right)}{\\frac{1}{2}W\\left( y|0 \\right)+\\frac{1}{2}W\\left( y|1 \\right)}\n$$\nå½“ç é•¿$N$è¶‹è¿‘äºæ— ç©·çš„æ—¶å€™ï¼Œä¿¡é“å®¹é‡è¶‹è¿‘äº1çš„åˆ†è£‚ä¿¡é“æ¯”ä¾‹çº¦ä¸º$K=NÃ—I(W)$ï¼Œè¿™éƒ¨åˆ†æ˜¯ç”¨æ¥ä¼ è¾“ä¿¡æ¯æ¯”ç‰¹çš„ä¿¡é“æ•°é‡ï¼Œè€Œä¿¡é“å®¹é‡è¶‹è¿‘äº0çš„æ¯”ä¾‹çº¦ä¸º$NÃ—(1âˆ’I(W))$ï¼Œè¿™éƒ¨åˆ†è¡¨ç¤ºå†»ç»“æ¯”ç‰¹çš„ä¿¡é“æ•°é‡ã€‚å¯¹äºä¿¡é“å®¹é‡ä¸º1çš„å¯é ä¿¡é“ï¼Œå¯ä»¥ç›´æ¥æ”¾ç½®æ¶ˆæ¯æ¯”ç‰¹è€Œä¸é‡‡ç”¨ä»»ä½•ç¼–ç ï¼Œå³ç›¸å½“äºç¼–ç é€Ÿç‡ä¸º$R=1$ï¼›è€Œå¯¹äºä¿¡é“å®¹é‡ä¸º0çš„ä¸å¯é ä¿¡é“ï¼Œå¯ä»¥æ”¾ç½®å‘é€ç«¯å’Œæ¥æ”¶ç«¯éƒ½äº‹å…ˆå·²çŸ¥çš„å†»ç»“æ¯”ç‰¹ï¼Œå³ç›¸å½“äºç¼–ç é€Ÿç‡ä¸º$R=0$ã€‚é‚£ä¹ˆå½“ç é•¿$N \\to\\infty$æ—¶ï¼ŒæåŒ–ç çš„å¯è¾¾ç¼–ç é€Ÿç‡$R= \\frac {K}{N}= \\frac {NÃ—I(W)}{N}=I(W)$ï¼Œå³åœ¨ç†è®ºä¸Šï¼ŒæåŒ–ç å¯ä»¥è¢«è¯æ˜æ˜¯å¯è¾¾ä¿¡é“å®¹é‡çš„ã€‚\nä¿¡é“æåŒ– ä¿¡é“æåŒ–åˆ†ä¸ºä¿¡é“è”åˆå’Œä¿¡é“åˆ†è£‚ä¸¤ä¸ªé˜¶æ®µã€‚å¯¹äºé•¿åº¦ä¸º$N={2^{n}}$ï¼ˆ$n$ä¸ºä»»æ„æ•´æ•°ï¼‰çš„æåŒ–ç ï¼Œå®ƒåˆ©ç”¨ä¿¡é“$W$çš„$N$ä¸ªç‹¬ç«‹å‰¯æœ¬ï¼Œè¿›è¡Œä¿¡é“è”åˆå’Œä¿¡é“åˆ†è£‚ï¼Œå¾—åˆ°æ–°çš„$N$ä¸ªå­ä¿¡é“$\\left{ W_{N}^{\\left( 1 \\right)},W_{N}^{\\left( 2 \\right)},\u0026hellip;,W_{N}^{\\left( N \\right)} \\right}$ã€‚éšç€ç é•¿çš„å¢åŠ ï¼Œåˆ†è£‚ä¹‹åçš„ä¿¡é“å°†å‘ä¸¤ä¸ªæç«¯å‘å±•ï¼šå…¶ä¸­ä¸€éƒ¨åˆ†åˆ†è£‚ä¿¡é“ä¼šè¶‹è¿‘äºå®Œç¾ä¿¡é“ï¼Œå³ä¿¡é“å®¹é‡è¶‹è¿‘äº1çš„æ— å™ªå£°ä¿¡é“ï¼›è€Œå¦ä¸€éƒ¨åˆ†åˆ†è£‚ä¿¡é“ä¼šè¶‹è¿‘äºå®Œå…¨å™ªå£°ä¿¡é“ï¼Œå³ä¿¡é“å®¹é‡è¶‹è¿‘äº0çš„ä¿¡é“ã€‚\næˆ‘ä»¬ä¸»è¦ç ”ç©¶äºŒè¿›åˆ¶ç¦»æ•£æ— è®°å¿†ä¿¡é“ï¼Œå°†ä¸Šé¢çš„ä¿¡é“æ¨¡å‹ï¼ˆåŒ…æ‹¬BECã€BSCã€AWGNï¼‰è¿›è¡ŒæŠ½è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸‹é¢çš„ä¿¡é“ä¼ è¾“æ¨¡å‹ï¼š\nå›¾ä¸­çš„Wå¯ä»¥æ˜¯BECä¿¡é“ï¼Œä¹Ÿå¯ä»¥æ˜¯BSCä¿¡é“æˆ–è€…AWGNä¿¡é“ï¼Œå…¶ä¸­I(W)ä¸ºä¿¡é“å®¹é‡ã€‚\nä¿¡é“è”åˆ ä¿¡é“è”åˆæ˜¯å°†å¤šä¸ªå­ä¿¡é“è¿›è¡Œè¶å½¢çš„å¼‚æˆ–æ“ä½œçš„è¿‡ç¨‹ã€‚å¯¹äºç é•¿ä¸ºN=2çš„æåŒ–ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„è¶å½¢å¼‚æˆ–æ“ä½œå°†ä¸¤ä¸ªä¿¡é“è¿›è¡Œæ··åˆï¼š\nç”±ä¸Šå›¾å¯ä»¥å‘ç°ï¼Œè¿›è¡Œä¿¡é“è”åˆä¹‹åï¼Œåæ ‡ä¸åŒä¿¡é“çš„ä¿¡é“å®¹é‡å‘ç”Ÿäº†æåŒ–ç°è±¡ï¼Œæœ‰ä¸€ä¸ªæ¯”ç‰¹çš„ä¿¡é“ä¿¡é“å®¹é‡$I(W)$å¢åŠ äº†ï¼Œå¦å¤–ä¸€ä¸ªæ¯”ç‰¹çš„ä¿¡é“å®¹é‡$I(W)$å‡å°‘äº†ã€‚ä¿¡é“å®¹é‡å°çš„ï¼Œæˆ‘ä»¬ç§°ä¸ºå·®ä¿¡é“ï¼Œä¿¡é“å®¹é‡å¤§çš„ï¼Œæˆ‘ä»¬ç§°ä¸ºå·å¥½ä¿¡é“ã€‚å› ä¸ºè¿›è¡Œäº†ä¿¡é“è”åˆä¹‹åï¼Œå› ä¸ºè¦æ±‚å¾—å·¦è¾¹çš„ä¿¡é“$u1$ï¼Œå¿…é¡»æ˜¯åœ¨å³è¾¹çš„ä¿¡é“$y1$å’Œ$y2$åŒæ—¶éƒ½æ”¶åˆ°çš„æƒ…å†µä¸‹æ‰èƒ½å¤Ÿå¾—å‡º$u1$ï¼Œæ‰€ä»¥$u1$çš„ä¿¡é“å®¹é‡å°±æ˜¯ä¿¡é“$y1$å’Œ$y2$çš„ä¿¡é“å®¹é‡ä¹˜ç§¯ï¼›ç›¸åº”çš„ï¼Œå¯¹äºä¿¡é“$u2$ï¼Œåªæœ‰$y1$å’Œ$y2$éƒ½æ”¶ä¸åˆ°çš„æƒ…å†µä¸‹ï¼Œæ‰æ¥æ”¶ä¸åˆ°ä¿¡é“ï¼Œæ‰€ä»¥å®ƒçš„ä¿¡é“å®¹é‡$I(W)$ä¸º$2*0.5 - 0.5^{2}$ã€‚\næˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªäºŒç»´è¡¨æ ¼æ¥è®¡ç®—å®ƒä»¬ä¼ è¾“çš„æ¦‚ç‡ï¼š\n   y1 y2 u1 u2     âˆš âˆš âˆš âˆš   âˆš x x âˆš   x âˆš x âˆš   x x x x    ç”±è¡¨æ ¼1å¯ä»¥å‘ç°ï¼Œå¯¹äºæ¥æ”¶æ–¹æ”¶åˆ°çš„ä¿¡å·y1å’Œy2ï¼Œæ€»å…±æœ‰4ç§æƒ…å†µï¼ŒXè¡¨ç¤ºè¯¥ä¿¡é“å‘ç”Ÿé”™è¯¯ï¼Œæœªæ”¶åˆ°ä¿¡é“ï¼›âˆšè¡¨ç¤ºè¯¥ä¿¡é“æ”¶åˆ°äº†ä¿¡é“ã€‚å¯¹äºå­ä¿¡é“u1ï¼Œåœ¨å››ç§æƒ…å†µä¸­ï¼Œåªæœ‰ä¸€ç§æƒ…å†µèƒ½å¤Ÿæ¥å—å¾—åˆ°u1ï¼Œä¹Ÿå°±æ˜¯åŒæ—¶æ¥æ”¶åˆ°y1å’Œy2çš„æƒ…å†µ,æ‰€ä»¥ä¿¡é“å®¹é‡ä¸º1/4ï¼›è€Œå¯¹äºu2,åªè¦èƒ½å¤Ÿæ”¶åˆ°y1æˆ–y2çš„ä»»æ„ä¸€ä¸ªå®ƒå°±èƒ½å¤Ÿè§£å‡ºæ¥,æ ¹æ®ä¿¡é“æåŒ–ç†è®ºï¼Œæˆ‘ä»¬åœ¨è¿›è¡ŒæåŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå°±å·²ç»çŸ¥é“ä¿¡é“u1çš„ä¿¡é“å®¹é‡æ¯”è¾ƒå°ï¼Œæˆ‘ä»¬ä¼šæŠŠå®ƒä½œä¸ºå†»ç»“æ¯”ç‰¹ï¼Œå¡«å……ä¸º0ï¼Œä¸ä¼ è¾“ä¿¡æ¯æ¯”ç‰¹ï¼Œä»…ä¼ è¾“å†»ç»“æ¯”ç‰¹ï¼Œæ‰€ä»¥åœ¨æ²¡æœ‰æ¥æ”¶åˆ°y2çš„æƒ…å†µä¸‹æˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿå¾—å‡ºu2ã€‚\nå¯¹äºN=4çš„ç é•¿ï¼Œæˆ‘ä»¬å¯ä»¥é€’å½’çš„è¿›è¡Œä¿¡é“è”åˆï¼Œå¦‚å›¾ï¼Œåªä¸è¿‡ç›¸æ¯”äºN=2çš„ç é•¿çš„æåŒ–ç ï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ ä¸€æ¬¡çš„ä¿¡é“è”åˆè¿‡ç¨‹ï¼š\næŒ‰ç…§è¿™æ ·ä¸æ–­çš„é€’å½’ä¸‹å»ï¼Œåˆ°nçº§ä¹‹åï¼Œå¯ä»¥å¾—åˆ°é€’å½’çš„ä¸€èˆ¬å¼ï¼š${W_{N/{2};}}$çš„2ä¸ªç‹¬ç«‹å‰¯æœ¬è”åˆäº§ç”Ÿä¿¡é“${W_{N}}$ï¼Œæˆ‘ä»¬å¯ä»¥çš„åˆ°ä»»æ„ç é•¿ä¸º$N=2^{n}$çš„æåŒ–ç ã€‚\nä¿¡é“åˆ†è£‚ ä¿¡é“åˆ†è£‚ä½“ç°åœ¨ä¿¡é“è”åˆä¹‹ä¸­ ï¼Œå‚è€ƒæ–‡çŒ®ä¸­å¯¹äºä¿¡é“åˆ†è£‚çš„è§£é‡Šï¼Œå…¶å¤§è‡´è¿‡ç¨‹æ˜¯å°†ä¸¤ä¸ªä¿¡é“$W_{N/2}$è”åˆæˆä¸€ä¸ªä¿¡é“$W_N$ä¹‹åï¼Œå†å°†è”åˆçš„ä¿¡é“$W_N$åˆ†è£‚æˆä¸¤ä¸ªå­ä¿¡é“$W_{N/2}$ï¼Œæ­¤æ—¶ï¼Œè¿™ä¸¤ä¸ªå­ä¿¡é“çš„è½¬ç§»æ¦‚ç‡ä¹Ÿæ”¹å˜äº†ï¼Œè¿™æ ·æåŒ–ç å°±å®Œæˆäº†ä¿¡é“åˆ†è£‚ã€‚æ›´å…·ä½“çš„æ¥è¯´ï¼Œå®ƒå­˜åœ¨ä»¥ä¸‹ä¸¤ä¸ªé€’æ¨å…¬å¼è®¡ç®—å­ä¿¡é“çš„è½¬ç§»æ¦‚ç‡ï¼š\n$$\nW_{N}^{\\left( 2i-1 \\right)}\\left( y_{1}^{N},u_{1}^{2i-2}|{u_{2i-1}} \\right)=\\sum\\limits_{u_{2i}}{\\frac{1}{2}W_{N/{2};}^{\\left( i \\right)}\\left( y_{1}^{N/{2};},u_{1,o}^{2i-2}\\oplus u_{1,e}^{2i-2}|{u_{2i-1}}\\oplus {u_{2i}} \\right)\\cdot W_{N/{2};}^{\\left( i \\right)}\\left( y_{N/{2};+1}^{N},u_{1,e}^{2i-2}|{u_{2i}} \\right)}\n$$\n$$\nW_{N}^{\\left( 2i \\right)}\\left( y_{1}^{N},u_{1}^{2i-1}|{u_{2i}} \\right)=\\frac{1}{2}W_{N/{2};}^{\\left( i \\right)}\\left( y_{1}^{N/{2};},u_{1,o}^{2i-2}\\oplus u_{1,e}^{2i-2}|{u_{2i-1}}\\oplus {u_{2i}} \\right)\\cdot W_{N/{2};}^{\\left( i \\right)}\\left( y_{N/{2};+1}^{N},u_{1,e}^{2i-2}|{u_{2i}} \\right)\n$$\nå‚è€ƒï¼š\n ã€Šâ€œå¤ªææ··ä¸€â€â€”â€”æåŒ–ç åŸç†åŠ5Gåº”ç”¨ã€‹  ","description":"ä»‹ç»å…³äºæåŒ–ç çš„ä¸€äº›åŸºæœ¬çš„æ•°å­¦ä¸è®¡ç®—åŸç†ï¼ŒåŒ…æ‹¬å¦‚ä½•è¿›è¡Œæ¦‚ç‡çš„è½¬ç§»çš„ã€‚","id":34,"section":"posts","tags":["PolarCode","åŸºæœ¬åŸç†"],"title":"æåŒ–ç -åŸºæœ¬åŸç†","uri":"https://hugo.jiahongw.com/zh/posts/polarcode/polar-code-fundamentals/"},{"content":"åœ¨é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œç‰©ç†å±‚ä¼ è¾“çš„å°±æ˜¯ç”µä¿¡å·ï¼Œå‡å¦‚æˆ‘ä»¬åªç”¨0å’Œ1ä¼ è¾“ä¿¡å·ï¼Œå¹¶ä¸”è¿™äº›ä¿¡é“äº’ç›¸éƒ½æ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬ç§°ä¸ºäºŒè¿›åˆ¶ç¦»æ•£æ— è®°å¿†ä¿¡é“ã€‚ä¿¡é“æ¨¡å‹æ˜¯ç ”ç©¶ä¿¡é“ç¼–ç çš„åŸºç¡€ï¼Œå¸¸è§çš„å‡ ç§ä¿¡é“æ¨¡å‹åˆ†åˆ«æœ‰ï¼šäºŒè¿›åˆ¶åˆ é™¤ä¿¡é“ï¼ˆBECï¼‰ã€äºŒè¿›åˆ¶å¯¹ç§°ä¿¡é“ï¼ˆBSCï¼‰ã€é«˜æ–¯ä¿¡é“ï¼ˆAWGNï¼‰ã€‚è®¾ä¿¡é“çš„è¾“å…¥å’Œè¾“å‡ºåˆ†åˆ«æ˜¯é•¿ä¸ºNçš„åºåˆ—ï¼Œè¾“å…¥æ˜¯xï¼Œè¾“å‡ºæ˜¯yï¼Œå…¶ä¿¡é“çš„è½¬ç§»æ¦‚ç‡æ»¡è¶³ï¼š\n$$\np\\left( {y|x} \\right) = \\sum_{i=1}^N p\\left( {y_{i} | x_{i}} \\right)\n$$\næ— æŸä¿¡é“ æ— è®ºå‘é€ä»»ä½•æ¶ˆæ¯ï¼Œæ¥å—æ–¹éƒ½èƒ½å¤Ÿå‡†ç¡®æ— è¯¯çš„æ¥æ”¶åˆ°ï¼Œå¹¶ä¸”ä¸ä¼šå‘ç”Ÿé”™è¯¯ï¼Œé‚£ä¹ˆè¿™ä¸ªä¿¡é“å°±å¯ä»¥è¯´æ˜¯ä¸€ä¸ªæ— æŸä¿¡é“ã€‚æœ€ç®€å•çš„çš„å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ¨¡å‹ï¼Œä¸ç®¡å‘é€è€…å‘é€çš„æ˜¯0è¿˜æ˜¯1ï¼Œæ¥æ”¶è€…æ¥å—çš„éƒ½æ˜¯ä¸€è‡´çš„ã€‚\nå‡å¦‚æˆ‘ä»¬éšæœºè¿›è¡Œä¼ è¾“0æˆ–è€…1çš„æ•°æ®ï¼Œå…¶ä¼ è¾“çš„æ•°å€¼å›¾ä¸ºä¸‹é¢ï¼š\näºŒè¿›åˆ¶åˆ é™¤ä¿¡é“ äºŒè¿›åˆ¶åˆ é™¤ä¿¡é“ï¼Œç®€è®°ä¸ºBECï¼ˆBinary Erasure Channel ï¼‰ã€‚Ïµç§°ä¸ºåˆ é™¤æ¦‚ç‡ï¼Œè¡¨ç¤ºæœ‰Ïµçš„æ¦‚ç‡è¿™ä¸ªä¿¡å·ä¼šä¸¢å¤±ã€‚å½“æ¥æ”¶æ–¹å¾—åˆ°ä¸€ä¸ªä½ï¼Œå®ƒæ˜¯100%ç¡®å®šçš„ä½æ˜¯æ­£ç¡®çš„ã€‚åªæœ‰å½“ä½è¢«æ“¦é™¤æ—¶ï¼Œæ‰ä¼šå‡ºç°å”¯ä¸€çš„æ··æ·†ã€‚å¯¹äºäºŒè¿›åˆ¶ç¦»æ•£æ— è®°å¿†ä¿¡é“ï¼Œæˆ‘ä»¬æœ‰Ïµçš„æ¦‚ç‡ä¸¢å¤±0æˆ–è€…1çš„æ¯”ç‰¹ä½ã€‚\nBECçš„ä¿¡é“å®¹é‡ä¸ºï¼š\n$$\nC= 1 - \\epsilon\n$$\näºŒè¿›åˆ¶å¯¹ç§°ä¿¡é“ äºŒè¿›åˆ¶å¯¹ç§°ä¿¡é“ï¼Œç®€è®°ä¸ºBSCï¼ˆBinary Symmetric Channel ï¼‰ã€‚pç§°ä¸ºäº¤å‰æ¦‚ç‡ï¼Œè¡¨ç¤ºæœ‰pçš„æ¦‚ç‡ä¼šå¯¼è‡´ä¼ è¾“è¿‡ç¨‹ä¸­0ä¿¡å·å’Œ1ä¿¡å·çš„é”™ä¹±ã€‚ï¼ˆé”™ä¹±çš„æ„æ€æ˜¯å‘é€0ï¼Œæ”¶åˆ°å´æ˜¯1ï¼›æˆ–è€…å‘é€1ï¼Œæ”¶åˆ°å´æ˜¯0ï¼‰\nBSCçš„ä¿¡é“å®¹é‡ä¸ºï¼š\n$$\nC = \\log n + q\\log q + (1-q) \\log \\frac {1-q}{n-1}\n$$\nåŠ æ€§é«˜æ–¯ç™½å™ªå£°ä¿¡é“ é«˜æ–¯ä¿¡é“ï¼Œå¸¸æŒ‡åŠ æƒé«˜æ–¯ç™½å™ªå£°ï¼ˆAWGNï¼‰ä¿¡é“ã€‚è¿™ç§å™ªå£°å‡è®¾ä¸ºåœ¨æ•´ä¸ªä¿¡é“å¸¦å®½ä¸‹åŠŸç‡è°±å¯†åº¦ï¼ˆPDFï¼‰ä¸ºå¸¸æ•°ï¼Œå¹¶ä¸”æŒ¯å¹…ç¬¦åˆé«˜æ–¯æ¦‚ç‡åˆ†å¸ƒã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œé«˜æ–¯ä¿¡é“éœ€è¦é…åˆBPSKæœºåˆ¶è¿›è¡Œè°ƒåˆ¶ï¼Œåœ¨ä¼ è¾“ä¹‹å‰ï¼Œæˆ‘ä»¬å¯¹0å’Œ1æ¯”ç‰¹è¿›è¡Œå˜æ¢ï¼Œæ¯”ç‰¹0ä¼šå˜æˆ1ï¼Œæ¯”ç‰¹1å˜æˆ-1ï¼Œè€Œè¿™ä¸ªå°†æ¯”ç‰¹è¿›è¡Œè½¬æ¢çš„è¿‡ç¨‹å°±æ˜¯BPSKè°ƒåˆ¶ï¼Œæœ€ååœ¨BPSKè°ƒåˆ¶åå†åŠ ä¸Šé«˜æ–¯å™ªå£°ï¼Œå®é™…çš„æ¨¡å‹å¦‚ä¸‹ï¼šã€‚\né€šè¿‡BPSKè°ƒåˆ¶ä¹‹å0æ¯”ç‰¹å’Œ1æ¯”ç‰¹éƒ½ä¼šå‘1å’Œ-1è¿™ä¸¤ä¸ªä¸´ç•Œçº¿é ç»ï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹ä¼ å…¥é«˜æ–¯ä¿¡é“ï¼Œå³ä½¿å­˜åœ¨é«˜æ–¯å™ªå£°è¿›è¡Œå½±å“ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿå‡å°å®ƒçš„å½±å“ï¼Œåœ¨è§£ç ç«¯å¯¹ç å­—è¿›è¡ŒBPSKè§£è°ƒï¼Œèƒ½å¤Ÿå¾—åˆ°è¾ƒé«˜çš„å‡†ç¡®ç‡ã€‚\nç”±å›¾å¯ä»¥å‘ç°ï¼Œå€¼é è¿‘1çš„ä¿¡å·è¡¨ç¤ºåŸæ¥çš„ä¿¡å·æ˜¯0ï¼Œå€¼é è¿‘-1çš„ä¿¡å·è¡¨ç¤ºåŸæ¥çš„ä¿¡å·æ˜¯1ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å‡å°‘é«˜æ–¯å™ªå£°çš„å¹²æ‰°ï¼Œè®©ä¼ è¾“çš„ä¿¡å·æ›´åŠ ç¨³å®šã€‚\n ç‰¹åˆ«çš„ï¼Œ5Gæ ‡å‡†è¦æ±‚ä¿¡é“ç¼–ç è‡³å°‘èƒ½å¤Ÿåœ¨åŠ æ€§é«˜æ–¯ç™½å™ªå£°ä¿¡é“ï¼ˆAWGNï¼‰ä¸‹è¿›è¡Œä¼ è¾“ã€‚\n ","description":"åœ¨ä¿¡æ¯è®ºä¸­ï¼Œä¿¡é“æ˜¯æŒ‡ä¿¡æ¯ä¼ è¾“çš„é€šé“ã€‚æˆ‘ä»¬åœ¨å®é™…é€šä¿¡ä¸­æ‰€åˆ©ç”¨çš„å„ç§ç‰©ç†é€šé“æ˜¯ä¿¡é“çš„æœ€å…¸å‹çš„ä¾‹å­ï¼Œå¦‚ç”µç¼†ã€å…‰çº¤ã€ç”µæ³¢ä¼ å¸ƒçš„ç©ºé—´ã€è½½æ³¢çº¿è·¯ç­‰ç­‰ã€‚ä½†æ˜¯æåŒ–ç çš„ä¿¡é“æ¨¡å‹å°†ä»–ä»¬è¿›è¡Œäº†æŠ½è±¡ï¼Œå°†ä¿¡é“åˆ†æˆäº†å‡ ç±»ï¼šBECã€BSCã€AWGNã€‚","id":35,"section":"posts","tags":["PolarCode","ä¿¡é“æ¨¡å‹"],"title":"æåŒ–ç -ä¿¡é“æ¨¡å‹","uri":"https://hugo.jiahongw.com/zh/posts/polarcode/polar-code-channel-model/"},{"content":"ArÄ±kanæ•™æˆåœ¨æ–‡çŒ®[1]æå‡ºäº†ä¸²è¡ŒæŠµæ¶ˆSCè¯‘ç ç®—æ³•ã€‚SCè¯‘ç ç®—æ³•ç±»ä¼¼ä¸€ä¸ªæ·±åº¦ä¼˜å…ˆæœç´¢çš„ç®—æ³•ï¼Œå…¶æ ¹æ®ä¸¤ä¸ªåˆ¤å†³å‡½æ•°è¿›è¡Œè¿­ä»£è®¡ç®—æœ€å¤§ä¼¼ç„¶å¯¹æ•°æ¯”LLRï¼Œä¸¤ä¸ªåˆ¤å†³å‡½æ•°åˆ†åˆ«å«åšfå‡½æ•°å’Œgå‡½æ•°ã€‚ä¸‹é¢æ˜¯è¿™ä¸¤ä¸ªå…¬å¼çš„è®¡ç®—æ–¹æ³•ï¼š\n$$\n\\begin{align}\nf\\left( a,b \\right)=\\ln \\left( \\frac{1+{ {e}^{a+b}}}{ { {e}^{a}}+{ {e}^{b}}} \\right)\n\\end{align}\n$$\n$$\n\\begin{align}\ng\\left( a,b,{ {u}{s}} \\right)={ {\\left( -1 \\right)}^{ { {u} {s}}}}a+b\n\\end{align}\n$$\nå…¶ä¸­ï¼Œ$a,b\\in R,{ {u}_{s}}\\in \\left{ 0,1 \\right}$ã€‚LLRçš„é€’å½’è¿ç®—å€ŸåŠ©å‡½æ•°få’Œgè¡¨ç¤ºå¦‚ä¸‹ï¼š\n$$\n\\begin{align}\nL_{N}^{\\left( 2i-1 \\right)}\\left( y_{1}^{N},\\hat{u}*{1}^{2i-2} \\right)=f\\left( L* {N/2}^{\\left( i \\right)}\\left( y_{1}^{ {N}/{2};},\\hat{u}*{1,o}^{2i-2}\\oplus \\hat{u}* {1,e}^{2i-2} \\right),L_{N/2}^{\\left( i \\right)}\\left( y_{ {N}/{2};+1}^{N},\\hat{u}_{1,e}^{2i-2} \\right) \\right)\n\\end{align}\n$$\n$$\n\\begin{align}\nL_{N}^{\\left( 2i \\right)}\\left( y_{1}^{N},\\hat{u}*{1}^{2i-1} \\right)=g\\left( L* {N/2}^{\\left( i \\right)}\\left( y_{1}^{ {N}/{2};},\\hat{u}*{1,o}^{2i-2}\\oplus \\hat{u}* {1,e}^{2i-2} \\right),L_{N/2}^{\\left( i \\right)}\\left( y_{ {N}/{2};+1}^{N},\\hat{u}*{1,e}^{2i-2} \\right),{ { {\\hat{u}}}* {2i-1}} \\right)\n\\end{align}\n$$\né€’å½’çš„ç»ˆæ­¢æ¡ä»¶ä¸ºå½“$N=1$æ—¶ï¼Œå³åˆ°è¾¾äº†ä¿¡é“$W$ç«¯ï¼Œæ­¤æ—¶$L_{1}^{\\left( 1 \\right)}\\left( { {y}_{j}} \\right)=\\ln \\frac{W\\left( { {y}_{j}}|0 \\right)}{W\\left( { {y}_{j}}|1 \\right)}$ã€‚\nSCè¯‘ç ç®—æ³•ä¾é ä¸€ä¸ªè¶å½¢å•å…ƒï¼Œå¦‚å›¾10ï¼Œåœ¨è®¡ç®—çš„æ—¶å€™ä¸æ–­è¿›è¡Œé€’å½’ï¼Œä½†æ˜¯å¿…é¡»æ˜¯å…ˆè®¡ç®—å‡ºè¶å½¢å•å…ƒçš„ä¸Šè¡Œæ¯”ç‰¹ï¼Œæ‰èƒ½å¤Ÿè°ƒç”¨gå‡½æ•°æ±‚å‡ºä¸‹è¡Œæ¯”ç‰¹ã€‚å³å›¾10ä¸­å¿…é¡»ä½¿ç”¨få‡½æ•°è®¡ç®—å‡ºu1ï¼Œä¹‹åæ‰èƒ½å¤Ÿé€šè¿‡gå‡½æ•°æ±‚å‡ºu2ã€‚åœ¨å®é™…çš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œä»æ¥æ”¶çš„æ¯”ç‰¹è¿›è¡Œé€’å½’æ‰§è¡Œfå‡½æ•°å’Œgå‡½æ•°ï¼Œå…¶ä¸­å‡å¦‚ç¼–ç æ¯æ¬¡è¿›è¡Œä¸€æ¬¡æåŒ–ï¼Œåœ¨è¯‘ç é˜¶æ®µéƒ½ä¼šå¤šä¸€æ¬¡é€’å½’çš„è®¡ç®—ï¼Œä¸­é—´çš„è®¡ç®—å€¼å°±æ˜¯è¿›è¡ŒæåŒ–çš„ä¸´æ—¶å€¼ï¼Œåœ¨ä¸€æ•´ä¸ªè¶å½¢ç»“æ„ä¸­ä½“ç°ï¼Œæ˜¯ä¸€ä¸ªæ·±åº¦ä¼˜å…ˆçš„ç®—æ³•ã€‚\nSCLè¯‘ç ç®—æ³•[3]ç±»ä¼¼æ ‘çš„å¹¿åº¦ä¼˜å…ˆéå†ï¼Œå®ƒçš„å¥½å¤„å°±æ˜¯èƒ½å¤Ÿè¿›è¡Œå‰ªææ“ä½œï¼Œä¸ç”¨è®¡ç®—æ‰€æœ‰çš„èŠ‚ç‚¹ã€‚å®ƒä»æ ¹èŠ‚ç‚¹å¼€å§‹å¾€æ ‘åº•éƒ¨è¿›è¡Œå¹¿åº¦éå†æœç´¢ï¼Œæ¯ä¸€å±‚ä¼šè®¡ç®—å‡ºä¸€ä¸ªä¼°è®¡æ¯”ç‰¹ï¼Œç„¶ååœ¨è¿™ä¸ªä¼°è®¡æ¯”ç‰¹çš„åŸºç¡€ä¸Šå¾€ä¸‹è¿›è¡Œä¼°è®¡ä¸‹ä¸€ä¸ªæ¯”ç‰¹çš„å€¼ï¼Œå¦å¤–ï¼ŒSCLè¯‘ç ç®—æ³•è¿˜å¢åŠ äº†æƒ©ç½šå› å­ï¼Œå¯¹äºæƒ©ç½šå› å­è¿‡é«˜çš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è·³è¿‡å®ƒä»¥åŠå®ƒå­èŠ‚ç‚¹çš„è®¡ç®—ï¼Œå› ä¸ºå®ƒæ˜¯æ­£ç¡®çš„ç çš„å¯èƒ½æ€§æä½ï¼Œè¿™æ ·æ’é™¤äº†ä¸å¯èƒ½çš„è·¯å¾„ï¼ŒåŒæ—¶ï¼Œè¿™ä¹Ÿèƒ½è¾¾åˆ°å¯¹æ ‘è¿›è¡Œå‰ªæçš„æ•ˆæœï¼Œæé«˜è¯‘ç çš„é€Ÿåº¦ã€‚å›¾11å±•ç¤ºäº†è¿›è¡ŒSCLè¯‘ç çš„åŸºæœ¬è¿‡ç¨‹ï¼š\n","description":"è¯‘ç å’Œç¼–ç ç±»ä¼¼ï¼ŒåŸºäºé€’å½’çš„ç»“æ„ã€‚","id":36,"section":"posts","tags":["PolarCode","æåŒ–ç è¯‘ç "],"title":"æåŒ–ç -è¯‘ç ","uri":"https://hugo.jiahongw.com/zh/posts/polarcode/polar-code-decode/"},{"content":"åŸºæœ¬è¿ä½œæµç¨‹ Mavenå·¥å…·åœ¨æœ¬åœ°æœ‰ä¸€ä¸ªå­˜å‚¨åº“ï¼Œç„¶åå½“æœ¬åœ°å­˜å‚¨åº“æ²¡æœ‰çš„æƒ…å†µä¸‹ä¼šè‡ªåŠ¨çš„å»ä¸­å¤®ä»“åº“å¯»æ‰¾å¹¶ä¸”ä¸‹è½½åˆ°æœ¬åœ°å­˜å‚¨åº“ï¼Œç„¶ååœ¨æ‰§è¡Œè‡ªåŠ¨åŒ–æ„å»ºã€‚\nMavenå®‰è£…ç›®å½•   bin/å­˜æ”¾Mavençš„äºŒè¿›åˆ¶æ‰§è¡Œç¨‹åºï¼Œåˆ†ä¸ºLinuxå’ŒWindowsçš„\n  boot/å­˜æ”¾Mavençš„ç±»åŠ è½½å™¨ï¼Œç”¨äºåŠ è½½jaråŒ…å’Œç±»\n  conf/å­˜æ”¾çš„æ˜¯Mavençš„ä¸€äº›é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚settings.xml\n  lib/å­˜æ”¾Mavenå·¥å…·ä¾èµ–çš„jaråŒ…\n  usrlibs/æ˜¯ç”¨æˆ·è‡ªå®šä¹‰ä¿å­˜é¡¹ç›®ä¾èµ–åŒ…çš„ä½ç½®ï¼Œç”¨äºä½œä¸ºæœ¬åœ°ä»“åº“\n  Mavené¡¹ç›®ç›®å½• æ¯æ¬¡ä½¿ç”¨Mavenç”Ÿæˆåˆå§‹åŒ–çš„é¡¹ç›®ï¼Œé¡¹ç›®çš„åŸºæœ¬ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š\n  src/æ˜¯æºä»£ç ä¿å­˜çš„ä½ç½®\n main/ä¸šåŠ¡ä»£ç ä½ç½®  java/ å…·ä½“ä¸šåŠ¡ä»£ç  æ„å»ºåŒ… æ„å»ºç±»å‹ resources/ èµ„æºæ–‡ä»¶ é…ç½®æ–‡ä»¶ é™æ€æ–‡ä»¶ webapp/ webé¡¹ç›®éœ€è¦åŒ…å«æ­¤æ–‡ä»¶å¤¹ åŒ…å«è§†å›¾æ–‡ä»¶   test/ è¿›è¡Œæµ‹è¯•çš„æ–‡ä»¶å¤¹ä½ç½®    target/æ˜¯ç¼–è¯‘æ„å»ºä¹‹åçš„ç›®æ ‡å­˜æ”¾ä½ç½®\n  pom.xmlæ˜¯é¡¹ç›®çš„ä¾èµ–é…ç½®æ–‡ä»¶\n  ","description":"Mavenç›¸å½“äºä¸€ä¸ªé¡¹ç›®ç®¡ç†çš„æ¡†æ¶ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬è¿›è¡Œç®€ä¾¿çš„ä¾èµ–åŒ…ä¸‹è½½å’Œå¼•å…¥ï¼Œå¹¶ä¸”èƒ½å¤Ÿè‡ªåŠ¨åŒ–æ„å»ºé¡¹ç›®ï¼Œé¿å…ç¹ççš„æ­¥éª¤ã€‚","id":37,"section":"posts","tags":["Java","Maven"],"title":"mavenç›®å½•ç»“æ„","uri":"https://hugo.jiahongw.com/zh/posts/middleware/maven-dir/"},{"content":"å‡ºå‘å‰çš„å‡†å¤‡  å†²é”‹è¡£ï¼ˆé˜²é£ï¼Œé˜²æ™’ï¼Œé˜²é›¨ï¼Œé˜²å¯’ï¼‰ ç™»å±±é‹æˆ–è€…è¶Šé‡é‹ ç™»å±±æ– å¸½å­ é˜²æ™’éœœ ä¸€æ¬¡æ€§å†…è£¤å’Œä¸€æ¬¡æ€§é›¨è¡£ ç›¸æœº åšçš„è¡£æœ å£ç½© å­¦ç”Ÿè¯ èº«ä»½è¯ é©¾é©¶è¯  åŸºæœ¬è·¯çº¿ å°ç¯çº¿+ç¨»åŸäºšä¸\nå·è¥¿ç¾æ™¯ åˆç…§ some word å¤§å­¦å››å¹´ä¸€ä¸‹å°±è¿‡å»äº†ï¼Œå¾ˆé«˜å…´é‡è§äº†ä¸€ç¾¤å¾ˆæ£’çš„æœ‹å‹ã€‚å¸Œæœ›æœªæ¥çš„æˆ‘ä»¬ä¹Ÿæ›´åŠ ä¼˜ç§€ï¼æ—…æ¸¸çœŸæ˜¯ä¸€ä»¶åˆç´¯åˆè®©äººé‡æ–°è®¤è¯†ä¸–ç•Œäº‹æƒ…å•Šï¼\n","description":"åœ¨å¤§å­¦çš„æœ€åä¸€æ¬¡å’Œæœ‹å‹çš„æ—…è¡Œ......","id":38,"section":"posts","tags":["life"],"title":"æ¯•ä¸šæ—…è¡Œ-å·è¥¿","uri":"https://hugo.jiahongw.com/zh/posts/life/biyeluxing/"},{"content":"å·è¥¿æ¯•ä¸šæ—…è¡Œçš„å›¾ç‰‡ã€‚\n","description":"å·è¥¿æ¯•ä¸šæ—…è¡Œ","id":39,"section":"gallery","tags":null,"title":"å·è¥¿","uri":"https://hugo.jiahongw.com/zh/gallery/chuanxi/"},{"content":"5Gä¸‹çš„æåŒ–ç  è¿™ä¸ªä¸“æ ä»‹ç»æåŒ–ç çš„ç›¸å…³åŸç†ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸ºæˆ‘ç›®å‰çš„æ¯•ä¸šè®¾è®¡æ˜¯å…³äº5GæåŒ–ç æ–¹å‘çš„ï¼Œå¦ä¸€æ–¹é¢æˆ‘æƒ³å°†è‡ªå·±æ‰€å­¦çš„ä¸€äº›çŸ¥è¯†è®°å½•æˆ–è€…åˆ†äº«èµ·æ¥ã€‚\né¦–å…ˆï¼Œæˆ‘æƒ³è¦è¯´çš„æ˜¯ï¼ŒæåŒ–ç æ˜¯ä¸€ç§ç¼–ç æ–¹å¼ï¼Œå®ƒçš„ç›®çš„æ˜¯ä¸ºäº†ä½¿å¾—åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¼ è¾“æ›´å¤šæœ‰æ•ˆçš„æ¶ˆæ¯ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºè®©ä¼ è¾“æ›´å¯é çš„ç¼–ç æ–¹å¼ã€‚å½“ç„¶ï¼Œå¯¹äºä¿¡é“ç¼–ç æ¥è®²ï¼Œé‚£æœ€ä¸»è¦çš„å°±æ˜¯ç¼–ç å’Œè§£ç è¿™ä¸¤ä¸ªæ¿å—ã€‚é‚£ä»€ä¹ˆæ˜¯ä¿¡é“ç¼–ç å‘¢ï¼Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼šå‘é€æ–¹å…ˆå¯¹å‘é€çš„ä¿¡æ¯è¿›è¡Œç¼–ç ï¼Œé€šè¿‡ä¿¡é“è¿›è¡Œä¼ è¾“ï¼Œç„¶ååœ¨æ¥å—æ–¹é‚£è¾¹è¿›è¡Œè§£ç ï¼Œå¾—åˆ°æ¶ˆæ¯ï¼Œè¿™å°±æ˜¯ä¿¡é“ç¼–ç çš„åŸºæœ¬è¿‡ç¨‹ã€‚æˆ‘ä¼šåœ¨ä¹‹åçš„æ–‡ç« ä¸­åˆ†æè¿™äº›è¿‡ç¨‹ã€‚\nä¸“æ çš„ç›®å½•åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªæ¿å—ï¼š\n ä¿¡é“æ¨¡å‹ æåŒ–ç åŸºæœ¬åŸç† æåŒ–ç çš„ç¼–ç  æåŒ–ç çš„è¯‘ç  æåŒ–ç çš„æ„é€ ï¼ˆä¿¡é“çš„é€‰æ‹©ï¼‰ æåŒ–ç å®ç°  ","description":"æåŒ–ç å·²ç»å…¥é€‰5Gçš„æ ‡å‡†ï¼Œæ˜¯å”¯ä¸€ä¸€ä¸ªè¢«è¯æ˜å¯ä»¥è¾¾åˆ°é¦™å†œæé™çš„ä¸€ç§ç¼–ç æ–¹å¼ã€‚","id":40,"section":"posts","tags":["PolarCode"],"title":"5Gä¸‹çš„æåŒ–ç ","uri":"https://hugo.jiahongw.com/zh/posts/polarcode/polar-code-intro/"},{"content":"ä½¿ç”¨åœºæ™¯\n é¿å…å†—é•¿çš„if-elseæˆ–switchåˆ†æ”¯åˆ¤æ–­ æä¾›æ¡†æ¶çš„æ‰©å±•ç‚¹  ç­–ç•¥æ¨¡å¼ï¼š\nç­–ç•¥æ¨¡å¼å®šä¹‰äº†ç®—æ³•æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©ä»–ä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ã€‚æ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚\nç­–ç•¥å®šä¹‰ï¼š\nclassDiagram Strategy \u0026lt;|-- StrategyA : implements Strategy \u0026lt;|-- StrategyB : implements Strategy : algorithmInterface() StrategyA : algorithmInterface() StrategyB : algorithmInterface() ç­–ç•¥åˆ›å»ºï¼š\nclassDiagram Strategy \u0026lt;|-- StrategyA : implements Strategy \u0026lt;|-- StrategyB : implements Strategy : algorithmInterface() StrategyA : algorithmInterface() StrategyB : algorithmInterface() StrategyFactory --\u0026gt; Strategy : å…³è” StrategyFactory : getStrategy(type)  æ— çŠ¶æ€ç­–ç•¥ï¼šæ— çŠ¶æ€çš„ç­–ç•¥å› ä¸ºä¸ä¼šå˜ï¼Œå¯ä»¥è¿›è¡Œç¼“å­˜ï¼Œä¸€å¼€å§‹å°±åˆ›å»ºå¥½æ‰€æœ‰çš„ç­–ç•¥å³å¯ã€‚ï¼ˆç›´æ¥ä»mapä¸­æ‹¿å–ï¼‰ æœ‰çŠ¶æ€ç­–ç•¥ï¼šæœ‰çŠ¶æ€çš„ç­–ç•¥å› ä¸ºä¼šæ”¹å˜ï¼Œæ‰€ä»¥æ¯æ¬¡åˆ›å»ºéƒ½éœ€è¦æ˜¯ä¸€ä¸ªæœ€æ–°çš„ç­–ç•¥å¯¹è±¡ã€‚ï¼ˆåœ¨å·¥å‚ç±»ä¸­å­˜åœ¨if-elseåˆ¤æ–­ï¼‰  ç­–ç•¥ä½¿ç”¨ï¼š\nâ€‹\ngraph TD; æ‹¿å–ç­–ç•¥:getStrategy--\u0026gt;ä½¿ç”¨ç­–ç•¥æ¥å£:algorithmInterface;  ä»å·¥å‚ç±»ä¸­æ‹¿å–ç­–ç•¥ã€‚ è°ƒç”¨ç­–ç•¥å¯¹åº”çš„æ¥å£å‡½æ•°ã€‚  å¯¹äºJavaæ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨åå°„æ¥é¿å…ç­–ç•¥å·¥å‚ç±»çš„ä¿®æ”¹ã€‚ï¼ˆé…ç½®æ–‡ä»¶æˆ–è€…annotationï¼‰\n Springæ¡†æ¶ä¸­æœ‰org.springframework.beans.factory.ListableBeanFactory#getBeansOfType(java.lang.Class)å‡½æ•°å¯ä»¥ç›´æ¥è·å–æŒ‡å®šç±»å‹çš„Beanï¼Œé€šå¸¸è¿™ä¸ªç±»å‹å¯ä»¥è®¾ç½®æˆç­–ç•¥çš„æ¥å£ã€‚\n ç­–ç•¥æ¨¡å¼ä¸»è¦æ˜¯è§£è€¦ç­–ç•¥çš„å®šä¹‰ã€åˆ›å»ºå’Œä½¿ç”¨ï¼Œå¹¶ä¸”è¿˜èƒ½æ»¡è¶³å¼€é—­åŸåˆ™ï¼Œæ–¹ä¾¿åé¢è¿›è¡Œæ‹“å±•ã€‚\nè§£å†³ä»€ä¹ˆé—®é¢˜ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Ÿ\n å‘Šè­¦ é‡è¯• è§„åˆ™é…ç½®ï¼ˆè§„åˆ™å¼•æ“ï¼‰  ä»€ä¹ˆæƒ…å†µä¸‹æœ‰å¿…è¦å»é™¤if-elseæˆ–è€…switch-caseåˆ†æ”¯è¯­å¥ï¼Ÿ\n ä¸šåŠ¡é€»è¾‘è¿‡äºå¤æ‚ï¼Œåç»­éœ€æ±‚ä¸æ–­æ¥ã€‚ï¼ˆKISSåŸåˆ™ï¼‰  Reference:\n æå®¢æ—¶é—´ã€Šä½¿ç”¨ç­–ç•¥æ¨¡å¼é™¤å»if-elseåˆ†æ”¯é€»è¾‘ã€‹  ","description":"ç­–ç•¥æ¨¡å¼å®šä¹‰äº†ç®—æ³•æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©ä»–ä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢","id":41,"section":"posts","tags":["è¡Œä¸ºæ¨¡å¼","ç­–ç•¥æ¨¡å¼"],"title":"ç­–ç•¥æ¨¡å¼","uri":"https://hugo.jiahongw.com/zh/posts/designpattern/strategypattern/"},{"content":" åœ¨homeç›®å½•ä¸‹å®‰è£…çš„nginxç¨‹åºd\n ç”³è¯·è¯ä¹¦ letsencryptçš„è¯ä¹¦ ç”³è¯·ç½‘ç«™ï¼šhttps://letsencrypt.osfipin.com/\nè…¾è®¯äº‘çš„è¯ä¹¦ ç”³è¯·ç½‘ç«™ï¼šhttps://cloud.tencent.com/product/ssl\nè¯ä¹¦ç”³è¯·å®Œæˆä¹‹åï¼Œè®°å½•è¯ä¹¦çš„ä½ç½®ï¼Œåœ¨nginx.confæ–‡ä»¶è¿›è¡Œä¿®æ”¹å³å¯ï¼Œä¿®æ”¹æ–¹å¼å¯ä»¥å‚ç…§ä¸‹é¢çš„æ­¥éª¤ã€‚\nä½¿ç”¨certbotè‡ªåŠ¨åŒ– å‚è€ƒåœ°å€ï¼šhttps://blog.csdn.net/xs18952904/article/details/79262646\næ£€æŸ¥nginx æŸ¥çœ‹ nginx æ˜¯å¦å®‰è£… http_ssl_module æ¨¡å—\n/usr/local/nginx/sbin/nginx -V å¦‚æœå‡ºç° configure arguments: â€“with-http_ssl_module, åˆ™å·²å®‰è£…ï¼Œä¸ç„¶çš„è¯éœ€è¦é‡æ–°ç¼–è¯‘å®‰è£…ï¼Œå‚è€ƒä¸‹é¢ï¼š\nhttps://segmentfault.com/a/1190000022673232\nå®‰è£…certbot 1  yum install certbot python2-certbot-nginx   é…ç½® SSL è¯ä¹¦è¯ä¹¦æ—¶,æŠ¥é”™ImportError: cannot import name UnrewindableBodyErrorï¼Œå¯ä»¥å‚è€ƒï¼šhttps://www.cnblogs.com/codecheng99/p/12620850.html\néƒ¨ç½²æ­¥éª¤ ç”³è¯·è¯ä¹¦\ncertbot certonly --standalone -d jiahongw.com -d www.jiahongw.com è¯ä¹¦è·¯å¾„ï¼š\n/etc/letsencrypt/live/jiahongw.com/fullchain.pem /etc/letsencrypt/live/jiahongw.com/privkey.pem è¿›å…¥ä¿®æ”¹\nvim nginx.conf è®¾ç½®HTTPå¼ºåˆ¶è·³è½¬HTTPS\n1 2 3 4 5  server { listen 80; server_name example.com; #è¿™é‡Œä¿®æ”¹ä¸ºç½‘ç«™åŸŸå  rewrite ^(.*)$ https://$host$1 permanent; }   è®¾ç½®HTTPS\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  server { listen 443 ssl; server_name jiahongw.com www.jiahongw.com; ssl_certificate /etc/letsencrypt/live/jiahongw.com/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/jiahongw.com/privkey.pem; ssl_session_cache shared:SSL:1m; ssl_session_timeout 10m; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; #å®‰å…¨é“¾æ¥å¯é€‰çš„åŠ å¯†åè®®  ssl_prefer_server_ciphers on; location / { root html/my_website; # my  index index.html index.htm; } }   æµ‹è¯•é…ç½®æ–‡ä»¶çš„æ­£ç¡®æ€§\nnginx -t é‡å¯nginx\n/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf è‡ªåŠ¨ç»­è´¹\necho \u0026quot;0 0,12 * * * root python -c 'import random; import time; time.sleep(random.random() * 3600)' \u0026amp;\u0026amp; certbot renew\u0026quot; | sudo tee -a /etc/crontab \u0026gt; /dev/null æ‰‹åŠ¨ç»­æœŸ\ncertbot certonly --standalone -d example.com -d www.example.com é…ç½®httpsä»£ç†\nserver { listen 443 ssl; server_name hostname.com; ssl_certificate cert/214547145790616.pem; ssl_certificate_key cert/214547145790616.key; location / { proxy_pass http://localhost:12345; } } é…ç½®http2.0\nhttps://segmentfault.com/a/1190000017847301\né€šè¿‡ Certbot å®‰è£… Let\u0026rsquo;s Encrypt è¯ä¹¦ï¼Œå®ç°å…è´¹çš„å…¨ç«™ HTTPS è®¿é—® | Laravel å­¦é™¢\né…ç½®Nginx ä¸»è¦åŠŸèƒ½ï¼š\n é™æ€èµ„æº åå‘ä»£ç† APIæœåŠ¡  Nginxé…ç½®åå‘ä»£ç†ï¼š\naliasä¸rootçš„åŒºåˆ«  root å®é™…è®¿é—®æ–‡ä»¶è·¯å¾„ä¼šæ‹¼æ¥URLä¸­çš„è·¯å¾„\nalias å®é™…è®¿é—®æ–‡ä»¶è·¯å¾„ä¸ä¼šæ‹¼æ¥URLä¸­çš„è·¯å¾„\n ç¤ºä¾‹å¦‚ä¸‹ï¼š\nlocation ^~ /sta/ { alias /usr/local/nginx/html/static/; } è¯·æ±‚ï¼šhttp://test.com/sta/sta1.html\nå®é™…è®¿é—®ï¼š/usr/local/nginx/html/static/sta1.html æ–‡ä»¶\nlocation ^~ /tea/ { root /usr/local/nginx/html/; } è¯·æ±‚ï¼šhttp://test.com/tea/tea1.html\nå®é™…è®¿é—®ï¼š/usr/local/nginx/html/tea/tea1.html æ–‡ä»¶\nRefï¼š\n Nginx locationåŒ¹é…è§„åˆ™ - Ryan.Miao - åšå®¢å›­ Nginxé…ç½®æ–‡ä»¶è¯¦è§£ - ç¨‹åºå‘˜è‡ªç”±ä¹‹è·¯ - åšå®¢å›­  æ£€æµ‹HTTP3ï¼ˆquicï¼‰ï¼šHTTP/3 Check\n","description":"ä½¿ç”¨Nginx + certbotå¿«é€Ÿçš„é…ç½®ä¸€ä¸ªå¯ä»¥httpsè®¿é—®çš„ç½‘ç«™ã€‚","id":42,"section":"posts","tags":["nginx"],"title":"Nginxé…ç½®SSLè¯ä¹¦","uri":"https://hugo.jiahongw.com/zh/posts/nginx/nginx-ssl/"},{"content":"ã€Šè½¬è½½ã€‹ https://www.cnblogs.com/fanzhidongyzby/p/3250405.html\næŒ‰ç…§å†¯Â·è¯ºä¾æ›¼å­˜å‚¨ç¨‹åºåŸç†ï¼Œç¨‹åºä»£ç æ˜¯ä½œä¸ºäºŒè¿›åˆ¶æ•°æ®å­˜å‚¨åœ¨å†…å­˜çš„ï¼ŒåŒæ ·ç¨‹åºçš„æ•°æ®ä¹Ÿåœ¨å†…å­˜ä¸­ï¼Œå› æ­¤ç›´æ¥ä»å†…å­˜çš„äºŒè¿›åˆ¶å½¢å¼ä¸Šæ˜¯æ— æ³•åŒºåˆ†å“ªäº›æ˜¯æ•°æ®å“ªäº›æ˜¯ä»£ç çš„ï¼Œè¿™ä¹Ÿä¸ºç¼“å†²åŒºæº¢å‡ºæ”»å‡»æä¾›äº†å¯èƒ½ã€‚\nä¸Šå›¾æ˜¯è¿›ç¨‹åœ°å€ç©ºé—´åˆ†å¸ƒçš„ç®€å•è¡¨ç¤ºã€‚ä»£ç å­˜å‚¨äº†ç”¨æˆ·ç¨‹åºçš„æ‰€æœ‰å¯æ‰§è¡Œä»£ç ï¼Œåœ¨ç¨‹åºæ­£å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œç¨‹åºè®¡æ•°å™¨ï¼ˆPCæŒ‡é’ˆï¼‰åªä¼šåœ¨ä»£ç æ®µå’Œæ“ä½œç³»ç»Ÿåœ°å€ç©ºé—´ï¼ˆå†…æ ¸æ€ï¼‰å†…å¯»å€ã€‚æ•°æ®æ®µå†…å­˜å‚¨äº†ç”¨æˆ·ç¨‹åºçš„å…¨å±€å˜é‡ï¼Œæ–‡å­—æ± ç­‰ã€‚æ ˆç©ºé—´å­˜å‚¨äº†ç”¨æˆ·ç¨‹åºçš„å‡½æ•°æ ˆå¸§ï¼ˆåŒ…æ‹¬å‚æ•°ã€å±€éƒ¨æ•°æ®ç­‰ï¼‰ï¼Œå®ç°å‡½æ•°è°ƒç”¨æœºåˆ¶ï¼Œå®ƒçš„æ•°æ®å¢é•¿æ–¹å‘æ˜¯ä½åœ°å€æ–¹å‘ã€‚å †ç©ºé—´å­˜å‚¨äº†ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€ç”³è¯·çš„å†…å­˜æ•°æ®ç­‰ï¼Œæ•°æ®å¢é•¿æ–¹å‘æ˜¯é«˜åœ°å€æ–¹å‘ã€‚é™¤äº†ä»£ç æ®µå’Œå—æ“ä½œç³»ç»Ÿä¿æŠ¤çš„æ•°æ®åŒºåŸŸï¼Œå…¶ä»–çš„å†…å­˜åŒºåŸŸéƒ½å¯èƒ½ä½œä¸ºç¼“å†²åŒºï¼Œå› æ­¤ç¼“å†²åŒºæº¢å‡ºçš„ä½ç½®å¯èƒ½åœ¨æ•°æ®æ®µï¼Œä¹Ÿå¯èƒ½åœ¨å †ã€æ ˆæ®µã€‚å¦‚æœç¨‹åºçš„ä»£ç æœ‰è½¯ä»¶æ¼æ´ï¼Œæ¶æ„ç¨‹åºä¼šâ€œæ•™å”†â€ç¨‹åºè®¡æ•°å™¨ä»ä¸Šè¿°ç¼“å†²åŒºå†…å–æŒ‡ï¼Œæ‰§è¡Œæ¶æ„ç¨‹åºæä¾›çš„æ•°æ®ä»£ç ï¼\næ ˆæº¢å‡º æ ˆçš„ä¸»è¦åŠŸèƒ½æ˜¯å®ç°å‡½æ•°çš„è°ƒç”¨ã€‚å› æ­¤åœ¨ä»‹ç»æ ˆæº¢å‡ºåŸç†ä¹‹å‰ï¼Œéœ€è¦å¼„æ¸…å‡½æ•°è°ƒç”¨æ—¶æ ˆç©ºé—´å‘ç”Ÿäº†æ€æ ·çš„å˜åŒ–ã€‚æ¯æ¬¡å‡½æ•°è°ƒç”¨æ—¶ï¼Œç³»ç»Ÿä¼šæŠŠå‡½æ•°çš„è¿”å›åœ°å€ï¼ˆå‡½æ•°è°ƒç”¨æŒ‡ä»¤åç´§è·ŸæŒ‡ä»¤çš„åœ°å€ï¼‰ï¼Œä¸€äº›å…³é”®çš„å¯„å­˜å™¨å€¼ä¿å­˜åœ¨æ ˆå†…ï¼Œå‡½æ•°çš„å®é™…å‚æ•°å’Œå±€éƒ¨å˜é‡ï¼ˆåŒ…æ‹¬æ•°æ®ã€ç»“æ„ä½“ã€å¯¹è±¡ç­‰ï¼‰ä¹Ÿä¼šä¿å­˜åœ¨æ ˆå†…ã€‚è¿™äº›æ•°æ®ç»Ÿç§°ä¸ºå‡½æ•°è°ƒç”¨çš„æ ˆå¸§ï¼Œè€Œä¸”æ˜¯æ¯æ¬¡å‡½æ•°è°ƒç”¨éƒ½ä¼šæœ‰ä¸ªç‹¬ç«‹çš„æ ˆå¸§ï¼Œè¿™ä¹Ÿä¸ºé€’å½’å‡½æ•°çš„å®ç°æä¾›äº†å¯èƒ½ã€‚\nå¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„å‡½æ•°functionï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•´å½¢å‚æ•°ï¼Œåšä¸€æ¬¡ä¹˜æ³•æ“ä½œå¹¶è¿”å›ã€‚å½“è°ƒç”¨function(0)æ—¶ï¼Œargå‚æ•°è®°å½•äº†å€¼0å…¥æ ˆï¼Œå¹¶å°†call functionæŒ‡ä»¤ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€0x00bd16f0ä¿å­˜åˆ°æ ˆå†…ï¼Œç„¶åè·³è½¬åˆ°functionå‡½æ•°å†…éƒ¨æ‰§è¡Œã€‚æ¯ä¸ªå‡½æ•°å®šä¹‰éƒ½ä¼šæœ‰å‡½æ•°å¤´å’Œå‡½æ•°å°¾ä»£ç ï¼Œå¦‚å›¾ç»¿æ¡†è¡¨ç¤ºã€‚å› ä¸ºå‡½æ•°å†…éœ€è¦ç”¨ebpä¿å­˜å‡½æ•°æ ˆå¸§åŸºå€ï¼Œå› æ­¤å…ˆä¿å­˜ebpåŸæ¥çš„å€¼åˆ°æ ˆå†…ï¼Œç„¶åå°†æ ˆæŒ‡é’ˆespå†…å®¹ä¿å­˜åˆ°ebpã€‚å‡½æ•°è¿”å›å‰éœ€è¦åšç›¸åçš„æ“ä½œâ€”â€”å°†espæŒ‡é’ˆæ¢å¤ï¼Œå¹¶å¼¹å‡ºebpã€‚è¿™æ ·ï¼Œå‡½æ•°å†…æ­£å¸¸æƒ…å†µä¸‹æ— è®ºæ€æ ·ä½¿ç”¨æ ˆï¼Œéƒ½ä¸ä¼šä½¿æ ˆå¤±å»å¹³è¡¡ã€‚\nsub esp,44hæŒ‡ä»¤ä¸ºå±€éƒ¨å˜é‡å¼€è¾Ÿäº†æ ˆç©ºé—´ï¼Œæ¯”å¦‚retå˜é‡çš„ä½ç½®ã€‚ç†è®ºä¸Šï¼Œfunctionåªéœ€è¦å†å¼€è¾Ÿ4å­—èŠ‚ç©ºé—´ä¿å­˜retå³å¯ï¼Œä½†æ˜¯ç¼–è¯‘å™¨å¼€è¾Ÿäº†æ›´å¤šçš„ç©ºé—´ï¼ˆè¿™ä¸ªé—®é¢˜å¾ˆè¯¡å¼‚ï¼Œä½ è§‰å¾—å‘¢ï¼Ÿï¼‰ã€‚å‡½æ•°è°ƒç”¨ç»“æŸè¿”å›åï¼Œå‡½æ•°æ ˆå¸§æ¢å¤åˆ°ä¿å­˜å‚æ•°0æ—¶çš„çŠ¶æ€ï¼Œä¸ºäº†ä¿æŒæ ˆå¸§å¹³è¡¡ï¼Œéœ€è¦æ¢å¤espçš„å†…å®¹ï¼Œä½¿ç”¨add esp,4å°†å‹å…¥çš„å‚æ•°å¼¹å‡ºã€‚\nä¹‹æ‰€ä»¥ä¼šæœ‰ç¼“å†²åŒºæº¢å‡ºçš„å¯èƒ½ï¼Œä¸»è¦æ˜¯å› ä¸ºæ ˆç©ºé—´å†…ä¿å­˜äº†å‡½æ•°çš„è¿”å›åœ°å€ã€‚è¯¥åœ°å€ä¿å­˜äº†å‡½æ•°è°ƒç”¨ç»“æŸååç»­æ‰§è¡Œçš„æŒ‡ä»¤çš„ä½ç½®ï¼Œå¯¹äºè®¡ç®—æœºå®‰å…¨æ¥è¯´ï¼Œè¯¥ä¿¡æ¯æ˜¯å¾ˆæ•æ„Ÿçš„ã€‚å¦‚æœæœ‰äººæ¶æ„ä¿®æ”¹äº†è¿™ä¸ªè¿”å›åœ°å€ï¼Œå¹¶ä½¿è¯¥è¿”å›åœ°å€æŒ‡å‘äº†ä¸€ä¸ªæ–°çš„ä»£ç ä½ç½®ï¼Œç¨‹åºä¾¿èƒ½ä»å…¶å®ƒä½ç½®ç»§ç»­æ‰§è¡Œã€‚\næ ˆæº¢å‡ºåŸºæœ¬åŸç† ä¸Šè¾¹ç»™å‡ºçš„ä»£ç æ˜¯æ— æ³•è¿›è¡Œæº¢å‡ºæ“ä½œçš„ï¼Œå› ä¸ºç”¨æˆ·æ²¡æœ‰â€œæ’è¶³â€çš„æœºä¼šã€‚ä½†æ˜¯å®é™…ä¸Šå¾ˆå¤šç¨‹åºéƒ½ä¼šæ¥å—ç”¨æˆ·çš„å¤–ç•Œè¾“å…¥ï¼Œå°¤å…¶æ˜¯å½“å‡½æ•°å†…çš„ä¸€ä¸ªæ•°ç»„ç¼“å†²åŒºæ¥å—ç”¨æˆ·è¾“å…¥çš„æ—¶å€™ï¼Œä¸€æ—¦ç¨‹åºä»£ç æœªå¯¹è¾“å…¥çš„é•¿åº¦è¿›è¡Œåˆæ³•æ€§æ£€æŸ¥çš„è¯ï¼Œç¼“å†²åŒºæº¢å‡ºä¾¿æœ‰å¯èƒ½è§¦å‘ï¼æ¯”å¦‚ä¸‹è¾¹çš„ä¸€ä¸ªç®€å•çš„å‡½æ•°ã€‚\n1 2 3 4 5  void fun(unsigned char *data) { unsigned char buffer[BUF_LEN]; strcpy((char*)buffer,(char*)data);//æº¢å‡ºç‚¹ }   è¿™ä¸ªå‡½æ•°æ²¡æœ‰åšä»€ä¹ˆæœ‰â€œæ„ä¹‰â€çš„äº‹æƒ…ï¼ˆè¿™é‡Œä¸»è¦æ˜¯ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼‰ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ä¸ªå…¸å‹çš„æ ˆæº¢å‡ºä»£ç ã€‚åœ¨ä½¿ç”¨ä¸å®‰å…¨çš„strcpyåº“å‡½æ•°æ—¶ï¼Œç³»ç»Ÿä¼šç›²ç›®åœ°å°†dataçš„å…¨éƒ¨æ•°æ®æ‹·è´åˆ°bufferæŒ‡å‘çš„å†…å­˜åŒºåŸŸã€‚bufferçš„é•¿åº¦æ˜¯æœ‰é™çš„ï¼Œä¸€æ—¦dataçš„æ•°æ®é•¿åº¦è¶…è¿‡BUF_LENï¼Œä¾¿ä¼šäº§ç”Ÿç¼“å†²åŒºæº¢å‡ºã€‚\nç”±äºæ ˆæ˜¯ä½åœ°å€æ–¹å‘å¢é•¿çš„ï¼Œå› æ­¤å±€éƒ¨æ•°ç»„bufferçš„æŒ‡é’ˆåœ¨ç¼“å†²åŒºçš„ä¸‹æ–¹ã€‚å½“æŠŠdataçš„æ•°æ®æ‹·è´åˆ°bufferå†…æ—¶ï¼Œè¶…è¿‡ç¼“å†²åŒºåŒºåŸŸçš„é«˜åœ°å€éƒ¨åˆ†æ•°æ®ä¼šâ€œæ·¹æ²¡â€åŸæœ¬çš„å…¶ä»–æ ˆå¸§æ•°æ®ï¼Œæ ¹æ®æ·¹æ²¡æ•°æ®çš„å†…å®¹ä¸åŒï¼Œå¯èƒ½ä¼šæœ‰äº§ç”Ÿä»¥ä¸‹æƒ…å†µï¼š\n1ã€æ·¹æ²¡äº†å…¶ä»–çš„å±€éƒ¨å˜é‡ã€‚å¦‚æœè¢«æ·¹æ²¡çš„å±€éƒ¨å˜é‡æ˜¯æ¡ä»¶å˜é‡ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šæ”¹å˜å‡½æ•°åŸæœ¬çš„æ‰§è¡Œæµç¨‹ã€‚è¿™ç§æ–¹å¼å¯ä»¥ç”¨äºç ´è§£ç®€å•çš„è½¯ä»¶éªŒè¯ã€‚\n2ã€æ·¹æ²¡äº†ebpçš„å€¼ã€‚ä¿®æ”¹äº†å‡½æ•°æ‰§è¡Œç»“æŸåè¦æ¢å¤çš„æ ˆæŒ‡é’ˆï¼Œå°†ä¼šå¯¼è‡´æ ˆå¸§å¤±å»å¹³è¡¡ã€‚\n3ã€æ·¹æ²¡äº†è¿”å›åœ°å€ã€‚è¿™æ˜¯æ ˆæº¢å‡ºåŸç†çš„æ ¸å¿ƒæ‰€åœ¨ï¼Œé€šè¿‡æ·¹æ²¡çš„æ–¹å¼ä¿®æ”¹å‡½æ•°çš„è¿”å›åœ°å€ï¼Œä½¿ç¨‹åºä»£ç æ‰§è¡Œâ€œæ„å¤–â€çš„æµç¨‹ï¼\n4ã€æ·¹æ²¡å‚æ•°å˜é‡ã€‚ä¿®æ”¹å‡½æ•°çš„å‚æ•°å˜é‡ä¹Ÿå¯èƒ½æ”¹å˜å½“å‰å‡½æ•°çš„æ‰§è¡Œç»“æœå’Œæµç¨‹ã€‚\n5ã€æ·¹æ²¡ä¸Šçº§å‡½æ•°çš„æ ˆå¸§ï¼Œæƒ…å†µä¸ä¸Šè¿°4ç‚¹ç±»ä¼¼ï¼Œåªä¸è¿‡å½±å“çš„æ˜¯ä¸Šçº§å‡½æ•°çš„æ‰§è¡Œã€‚å½“ç„¶è¿™é‡Œçš„å‰ææ˜¯ä¿è¯å‡½æ•°èƒ½æ­£å¸¸è¿”å›ï¼Œå³å‡½æ•°åœ°å€ä¸èƒ½è¢«éšæ„ä¿®æ”¹ï¼ˆè¿™å¯èƒ½å¾ˆéº»çƒ¦ï¼ï¼‰ã€‚\nå¦‚æœåœ¨dataæœ¬èº«çš„æ•°æ®å†…å°±ä¿å­˜äº†ä¸€ç³»åˆ—çš„æŒ‡ä»¤çš„äºŒè¿›åˆ¶ä»£ç ï¼Œä¸€æ—¦æ ˆæº¢å‡ºä¿®æ”¹äº†å‡½æ•°çš„è¿”å›åœ°å€ï¼Œå¹¶å°†è¯¥åœ°å€æŒ‡å‘è¿™æ®µäºŒè¿›åˆ¶ä»£ç çš„å…¶å®ä½ç½®ï¼Œé‚£ä¹ˆå°±å®Œæˆäº†åŸºæœ¬çš„æº¢å‡ºæ”»å‡»è¡Œä¸ºã€‚\né€šè¿‡è®¡ç®—è¿”å›åœ°å€å†…å­˜åŒºåŸŸç›¸å¯¹äºbufferçš„åç§»ï¼Œå¹¶åœ¨å¯¹åº”ä½ç½®æ„é€ æ–°çš„åœ°å€æŒ‡å‘bufferå†…éƒ¨äºŒè¿›åˆ¶ä»£ç çš„å…¶å®ä½ç½®ï¼Œä¾¿èƒ½æ‰§è¡Œç”¨æˆ·çš„è‡ªå®šä¹‰ä»£ç ï¼è¿™æ®µæ—¢æ˜¯ä»£ç åˆæ˜¯æ•°æ®çš„äºŒè¿›åˆ¶æ•°æ®è¢«ç§°ä¸ºshellcodeï¼Œå› ä¸ºæ”»å‡»è€…å¸Œæœ›é€šè¿‡è¿™æ®µä»£ç æ‰“å¼€ç³»ç»Ÿçš„shellï¼Œä»¥æ‰§è¡Œä»»æ„çš„æ“ä½œç³»ç»Ÿå‘½ä»¤â€”â€”æ¯”å¦‚ä¸‹è½½ç—…æ¯’ï¼Œå®‰è£…æœ¨é©¬ï¼Œå¼€æ”¾ç«¯å£ï¼Œæ ¼å¼åŒ–ç£ç›˜ç­‰æ¶æ„æ“ä½œã€‚\nmoreï¼š\nå‚è€ƒé“¾æ¥ï¼š\n https://www.cnblogs.com/fanzhidongyzby/p/3250405.html å‡½æ•°æ ˆçš„å®ç°åŸç† https://xz.aliyun.com/t/5964  ","description":"ç¨‹åºä»£ç æ˜¯ä½œä¸ºäºŒè¿›åˆ¶æ•°æ®å­˜å‚¨åœ¨å†…å­˜çš„ï¼ŒåŒæ ·ç¨‹åºçš„æ•°æ®ä¹Ÿåœ¨å†…å­˜ä¸­ï¼Œå› æ­¤ç›´æ¥ä»å†…å­˜çš„äºŒè¿›åˆ¶å½¢å¼ä¸Šæ˜¯æ— æ³•åŒºåˆ†å“ªäº›æ˜¯æ•°æ®å“ªäº›æ˜¯ä»£ç çš„ï¼Œè¿™ä¹Ÿä¸ºç¼“å†²åŒºæº¢å‡ºæ”»å‡»æä¾›äº†å¯èƒ½ã€‚","id":43,"section":"posts","tags":["Linux"],"title":"ç¼“å†²åŒºæº¢å‡º","uri":"https://hugo.jiahongw.com/zh/posts/linux/buffer-overflow/"},{"content":"é“¾æ¥ é“¾æ¥(linking)æ˜¯å°†å„ç§ä»£ç å’Œæ•°æ®ç‰‡æ®µæ”¶é›†å¹¶ç»„åˆæˆä¸ºä¸€ä¸ªå•ä¸€æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªæ–‡ä»¶å¯è¢«åŠ è½½ï¼ˆå¤åˆ¶ï¼‰åˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚\né“¾æ¥å¯ä»¥æ‰§è¡Œäºç¼–è¯‘æ—¶ (compile time) ä¹Ÿå°±æ˜¯åœ¨æºä»£ç è¢«ç¿»è¯‘æˆæœºå™¨ä»£ç æ—¶ï¼›ä¹Ÿå¯ä»¥æ‰§è¡ŒäºåŠ æ ½æ—¶ï¼ˆload time)ï¼Œä¹Ÿå°±æ˜¯åœ¨ç¨‹åºè¢«åŠ è½½å™¨ï¼ˆloader)åŠ è½½åˆ°å†…å­˜å¹¶æ‰§è¡Œæ—¶ï¼›ç”šè‡³æ‰§è¡Œäºè¿è¡Œæ—¶ï¼ˆruntime)ï¼Œä¹Ÿå°±æ˜¯ç”±åº”ç”¨ç¨‹åºæ¥æ‰§è¡Œã€‚\ngccçš„ç¼–è¯‘è¿‡ç¨‹ï¼š\nç›®æ ‡æ–‡ä»¶  ç¼–è¯‘å™¨å’Œæ±‡ç¼–å™¨ç”Ÿæˆå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶(åŒ…æ‹¬å…±äº«ç›®æ ‡æ–‡ä»¶ï¼‰ã€‚é“¾æ¥å™¨ç”Ÿæˆå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ã€‚\n å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ åŒ…å«äºŒè¿›åˆ¶ä»£ç å’Œæ•°æ®ï¼Œå…¶å½¢å¼å¯ä»¥åœ¨ç¼–è¯‘æ—¶ä¸å…¶ä»–å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶åˆå¹¶èµ·æ¥ï¼Œåˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ã€‚\nä¸‹å›¾æ˜¯å…¸å‹çš„ELFå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ï¼š\nè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒELF å¤´ï¼ˆELF header)ä»¥ä¸€ä¸ª 16 å­—èŠ‚çš„åºåˆ—å¼€å§‹ï¼Œè¿™ä¸ªåºåˆ—æè¿°äº†ç”Ÿæˆè¯¥æ–‡ä»¶çš„ç³»ç»Ÿçš„å­—çš„å¤§å°å’Œå­—èŠ‚é¡ºåºã€‚ELF å¤´å‰©ä¸‹çš„éƒ¨åˆ†åŒ…å«å¸®åŠ©é“¾æ¥å™¨è¯­æ³•åˆ†æå’Œè§£é‡Šç›®æ ‡æ–‡ä»¶çš„ä¿¡æ¯ã€‚\nå¸®åŠ©é“¾æ¥å™¨è¯­æ³•åˆ†æå’Œè§£é‡Šç›®æ ‡æ–‡ä»¶çš„ä¿¡æ¯åŒ…æ‹¬ï¼š\n æ‹¬ ELF å¤´çš„å¤§å° ç›®æ ‡æ–‡ä»¶çš„ç±»å‹ æœºå™¨ç±»å‹ï¼ˆå¦‚ X86-64) èŠ‚å¤´éƒ¨è¡¨çš„æ–‡ä»¶åç§» èŠ‚å¤´éƒ¨è¡¨ä¸­æ¡ç›®çš„å¤§å°å’Œæ•°é‡   ä¸åŒèŠ‚çš„ä½ç½®å’Œå¤§å°æ˜¯ç”±èŠ‚å¤´éƒ¨è¡¨æè¿°çš„ï¼Œå…¶ä¸­ç›®æ ‡æ–‡ä»¶ä¸­æ¯ä¸ªèŠ‚éƒ½æœ‰ä¸€ä¸ªå›ºå®šå¤§å°çš„æ¡ç›®ï¼ˆentry)\n ELF å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶åŒ…å«ä¸‹é¢å‡ ä¸ªèŠ‚ï¼š\n .text: å·²ç¼–è¯‘ç¨‹åºçš„æœºå™¨ä»£ç  .rodata: åªè¯»æ•°æ®ï¼Œæ¯”å¦‚printfè¯­å¥ä¸­çš„æ ¼å¼ä¸²å’Œswitchè¯­å¥çš„è·³è½¬è¡¨ã€‚ .data: å·²åˆå§‹åŒ–çš„å…¨å±€å’Œé™æ€ C å˜é‡ã€‚(å±€éƒ¨ C å˜é‡åœ¨è¿è¡Œæ—¶è¢«ä¿å­˜åœ¨æ ˆä¸­ï¼Œæ—¢ä¸å‡ºç°åœ¨ .data èŠ‚ä¸­ï¼Œä¹Ÿä¸å‡ºç°åœ¨ .bss èŠ‚ä¸­) .-bss: æœªåˆå§‹åŒ–çš„å…¨å±€å’Œé™æ€ C å˜é‡ï¼Œä»¥åŠæ‰€æœ‰è¢«åˆå§‹åŒ–ä¸º 0 çš„å…¨å±€æˆ–é™æ€å˜é‡ã€‚ .symtab: â€”ä¸ªç¬¦å·è¡¨ï¼Œå®ƒå­˜æ”¾åœ¨ç¨‹åºä¸­å®šä¹‰å’Œå¼•ç”¨çš„å‡½æ•°å’Œå…¨å±€å˜é‡çš„ä¿¡æ¯ã€‚ .rel.text: â€”ä¸ª.text èŠ‚ä¸­ä½ç½®çš„åˆ—è¡¨ï¼Œå½“é“¾æ¥å™¨æŠŠè¿™ä¸ªç›®æ ‡æ–‡ä»¶å’Œå…¶ä»–æ–‡ä»¶ç»„åˆæ—¶ï¼Œéœ€è¦ä¿®æ”¹è¿™äº›ä½ç½®ã€‚ .rel.data: è¢«æ¨¡å—å¼•ç”¨æˆ–å®šä¹‰çš„æ‰€æœ‰å…¨å±€å˜é‡çš„é‡å®šä½ä¿¡æ¯ã€‚ .debug: ä¸€ä¸ªè°ƒè¯•ç¬¦å·è¡¨ï¼Œå…¶æ¡ç›®æ˜¯ç¨‹åºä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡å’Œç±»å‹å®šä¹‰ï¼Œç¨‹åºä¸­å®šä¹‰å’Œå¼•ç”¨çš„å…¨å±€å˜é‡ï¼Œä»¥åŠåŸå§‹çš„ C æºæ–‡ä»¶ã€‚ .line: åŸå§‹ C æºç¨‹åºä¸­çš„è¡Œå·å’Œ.text èŠ‚ä¸­æœºå™¨æŒ‡ä»¤ä¹‹é—´çš„æ˜ å°„ã€‚ .strtab: â€”ä¸ªå­—ç¬¦ä¸²è¡¨ï¼Œå…¶å†…å®¹åŒ…æ‹¬ .symtab å’Œ .debug èŠ‚ä¸­çš„ç¬¦å·è¡¨ï¼Œä»¥åŠèŠ‚å¤´éƒ¨ä¸­çš„ä»¤åå­—ã€‚  å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ åŒ…å«äºŒè¿›åˆ¶ä»£ç å’Œæ•°æ®ï¼Œå…¶å½¢å¼å¯ä»¥è¢«ç›´æ¥å¤åˆ¶åˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚\nåŠ è½½å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶\né€šè¿‡è°ƒç”¨æŸä¸ªé©»ç•™åœ¨å­˜å‚¨å™¨ä¸­ç§°ä¸ºåŠ è½½å™¨ï¼ˆloader)çš„æ“ä½œç³»ç»Ÿä»£ç æ¥è¿è¡Œå®ƒã€‚ä»»ä½•Linuxç¨‹åºéƒ½å¯ä»¥é€šè¿‡execve å‡½æ•°æ¥è°ƒç”¨åŠ è½½å™¨ã€‚\nåŠ è½½å™¨å°†å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä¸­çš„ä»£ç å’Œæ•°æ®ä»ç£ç›˜å¤åˆ¶åˆ°å†…å­˜ä¸­ï¼Œç„¶åé€šè¿‡è·³è½¬åˆ°ç¨‹åºçš„ç¬¬ä¸€æ¡æŒ‡ä»¤æˆ–å…¥å£ç‚¹æ¥è¿è¡Œè¯¥ç¨‹åºã€‚è¿™ä¸ªå°†ç¨‹åºå¤åˆ¶åˆ°å†…å­˜å¹¶è¿è¡Œçš„è¿‡ç¨‹å«åšåŠ æ ½ã€‚\nåœ¨ Linux X86-64ç³»ç»Ÿä¸­ï¼Œä»£ç æ®µæ€»æ˜¯ä»åœ°å€ 0x400åŠ 0 å¤„å¼€å§‹ï¼Œåé¢æ˜¯æ•°æ®æ®µã€‚è¿è¡Œæ—¶å †åœ¨æ•°æ®æ®µä¹‹åï¼Œé€šè¿‡è°ƒç”¨ malloc åº“å¾€ä¸Šå¢é•¿ã€‚\nç”¨æˆ·æ ˆæ€»æ˜¯ä»æœ€å¤§çš„åˆæ³•ç”¨æˆ·åœ°å€ï¼ˆ$2^{48}$ â€”1)å¼€å§‹ï¼Œå‘è¾ƒå°å†…å­˜åœ°å€å¢é•¿ã€‚æ ˆä¸Šçš„åŒºåŸŸï¼Œä»åœ°å€ $2^{48}$ å¼€å§‹ï¼Œæ˜¯ä¸ºå†…æ ¸ï¼ˆkernel)ä¸­çš„ä»£ç å’Œæ•°æ®ä¿ç•™çš„ï¼Œæ‰€è°“å†…æ ¸å°±æ˜¯æ“ä½œç³»ç»Ÿé©»ç•™åœ¨å†…å­˜çš„éƒ¨åˆ†ã€‚\nLinux X86-64 è¿è¡Œæ—¶å†…å­˜æ˜ åƒã€‚æ²¡æœ‰å±•ç¤ºå‡ºç”±äºæ®µå¯¹é½è¦æ±‚å’Œåœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼ˆASLR)é€ æˆçš„ç©ºéš™ã€‚\nåŠ è½½å™¨è¿è¡Œæ—¶ï¼Œåˆ›å»ºä¸Šé¢æ‰€ç¤ºçš„å†…å­˜æ˜ åƒã€‚åœ¨ç¨‹åºå¤´éƒ¨è¡¨çš„å¼•å¯¼ä¸‹,åŠ è½½å™¨å°†å¯æ‰§è¡Œæ–‡ä»¶çš„ç‰‡(chunk)å¤åˆ¶åˆ°ä»£ç æ®µå’Œæ•°æ®æ®µã€‚æ¥ä¸‹æ¥ï¼ŒåŠ è½½å™¨è·³è½¬åˆ°ç¨‹åºçš„äººå£ç‚¹ï¼Œä¹Ÿå°±æ˜¯_startå‡½æ•°çš„åœ°å€ã€‚è¿™ä¸ªå‡½æ•°æ˜¯åœ¨ç³»ç»Ÿç›®æ ‡æ–‡ä»¶ ctrl.o ä¸­å®šä¹‰çš„ï¼Œå¯¹æ‰€æœ‰çš„ C ç¨‹åºéƒ½æ˜¯ä¸€æ ·çš„ã€‚_start å‡½æ•°è°ƒç”¨ç³»ç»Ÿå¯åŠ¨å‡½æ•°__libc_start_mainï¼Œè¯¥å‡½æ•°å®šä¹‰åœ¨ libc.so ä¸­ã€‚å®ƒåˆå§‹åŒ–æ‰§è¡Œç¯å¢ƒï¼Œè°ƒç”¨ç”¨æˆ·å±‚çš„ main å‡½æ•°ï¼Œå¤„ç† main å‡½æ•°çš„è¿”å›å€¼ï¼Œå¹¶ä¸”åœ¨éœ€è¦çš„æ—¶å€™æŠŠæ§åˆ¶è¿”å›ç»™å†…æ ¸ã€‚\nå…±äº«ç›®æ ‡æ–‡ä»¶ ä¸€ç§ç‰¹æ®Šç±»å‹çš„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥åœ¨åŠ è½½æˆ–è€…è¿è¡Œæ—¶è¢«åŠ¨æ€åœ°åŠ è½½è¿›å†…å­˜å¹¶é“¾æ¥ã€‚\né™æ€é“¾æ¥  åƒ Linux LD ç¨‹åºè¿™æ ·çš„é™æ€é“¾æ¥å™¨ï¼ˆstatic linker)ä»¥ä¸€ç»„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œå‘½ä»¤è¡Œå‚æ•°ä½œä¸ºè¾“å…¥ï¼Œç”Ÿæˆä¸€ä¸ªå®Œå…¨é“¾æ¥çš„ã€å¯ä»¥åŠ è½½å’Œè¿è¡Œçš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä½œä¸ºè¾“å‡ºã€‚\n ä¸ºäº†æ„é€ å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé“¾æ¥å™¨å¿…é¡»å®Œæˆä¸¤ä¸ªä¸»è¦ä»»åŠ¡ï¼š\n ç¬¦å·è§£æï¼šæ¯ä¸ªç¬¦å·å¯¹åº”äºä¸€ä¸ªå‡½æ•°ã€ä¸€ä¸ªå…¨å±€å˜é‡æˆ–ä¸€ä¸ªé™æ€å˜é‡ é‡å®šä½ï¼šç¼–è¯‘å™¨å’Œæ±‡ç¼–å™¨ç”Ÿæˆä»åœ°å€ 0 å¼€å§‹çš„ä»£ç å’Œæ•°æ®èŠ‚ã€‚é“¾æ¥å™¨é€šè¿‡æŠŠæ¯ä¸ªç¬¦å·å®šä¹‰ä¸ä¸€ä¸ªå†…å­˜ä½ç½®å…³è”èµ·æ¥ï¼Œä»è€Œé‡å®šä½è¿™äº›èŠ‚ï¼Œç„¶åä¿®æ”¹æ‰€æœ‰å¯¹è¿™äº›ç¬¦å·çš„å¼•ç”¨ï¼Œä½¿å¾—å®ƒä»¬æŒ‡å‘è¿™ä¸ªå†…å­˜ä½ç½®  ä¸ºä»€ä¹ˆä½¿ç”¨é™æ€é“¾æ¥åº“ æ—©æœŸçš„é—®é¢˜ï¼šä¸ä½¿ç”¨é™æ€é“¾æ¥åº“ï¼Œå¦‚ä½•åƒç”¨æˆ·æä¾›æ ‡å‡†å‡½æ•°ï¼Ÿ\nä¸€ç§æ–¹æ³•æ˜¯è®©ç¼–è¯‘å™¨è¾¨è®¤å‡ºå¯¹æ ‡å‡†å‡½æ•°çš„è°ƒç”¨ï¼Œå¹¶ç›´æ¥ç”Ÿæˆç›¸åº”çš„ä»£ç ã€‚è¿™ç§æ–¹æ³•æ— ç–‘ä¼šå¢åŠ ç¼–è¯‘å™¨çš„å¤æ‚æ€§ã€‚(è€Œä¸”æ¯æ¬¡æ·»\nåŠ ã€åˆ é™¤æˆ–ä¿®æ”¹ä¸€ä¸ªæ ‡å‡†å‡½æ•°æ—¶ï¼Œå°±éœ€è¦ä¸€ä¸ªæ–°çš„ç¼–è¯‘å™¨ç‰ˆæœ¬)\nå¦ä¸€ç§æ–¹æ³•æ˜¯å°†æ‰€æœ‰çš„æ ‡å‡† C å‡½æ•°éƒ½æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„å¯é‡å®šä½ç›®æ ‡æ¨¡å—ä¸­ã€‚\nè¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å®ƒå°†ç¼–è¯‘å™¨çš„å®ç°ä¸æ ‡å‡†å‡½æ•°çš„å®ç°åˆ†ç¦»å¼€æ¥ï¼Œå¹¶ä¸”ä»ç„¶å¯¹ç¨‹åºå‘˜ä¿æŒé€‚åº¦çš„ä¾¿åˆ©ã€‚ç„¶è€Œï¼Œä¸€ä¸ªå¾ˆå¤§çš„ç¼ºç‚¹æ˜¯ç³»ç»Ÿä¸­æ¯ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ç°åœ¨éƒ½åŒ…å«ç€ä¸€ä»½æ ‡å‡†å‡½æ•°é›†åˆçš„å®Œå…¨å‰¯æœ¬ï¼Œè¿™å¯¹ç£ç›˜ç©ºé—´æ˜¯å¾ˆå¤§çš„æµªè´¹ã€‚å¦ä¸€ä¸ªå¤§çš„ç¼ºç‚¹æ˜¯ï¼Œå¯¹ä»»ä½•æ ‡å‡†å‡½æ•°çš„ä»»ä½•æ”¹å˜ï¼Œæ— è®ºå¤šä¹ˆå°çš„æ”¹å˜ï¼Œéƒ½è¦æ±‚åº“çš„å¼€å‘äººå‘˜é‡æ–°ç¼–è¯‘æ•´ä¸ªæºæ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸è€—æ—¶çš„æ“ä½œï¼Œä½¿å¾—æ ‡å‡†å‡½æ•°çš„å¼€å‘å’Œç»´æŠ¤å˜å¾—å¾ˆå¤æ‚\né™æ€åº“æ¦‚å¿µè¢«æå‡ºæ¥ï¼Œä»¥è§£å†³è¿™äº›ä¸åŒæ–¹æ³•çš„ç¼ºç‚¹ã€‚ç›¸å…³çš„å‡½æ•°å¯ä»¥è¢«ç¼–è¯‘ä¸ºç‹¬ç«‹çš„ç›®æ ‡æ¨¡å—ï¼Œç„¶åå°è£…æˆä¸€ä¸ªå•ç‹¬çš„é™æ€åº“æ–‡ä»¶ã€‚\nåœ¨é“¾æ¥æ—¶ï¼Œé“¾æ¥å™¨å°†åªå¤åˆ¶è¢«ç¨‹åºå¼•ç”¨çš„ç›®æ ‡æ¨¡å—ï¼Œè¿™å°±å‡å°‘äº†å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç£ç›˜å’Œå†…å­˜ä¸­çš„å¤§å°ã€‚\nä½¿ç”¨é™æ€é“¾æ¥åº“ è¦åˆ›å»ºä¸€ä¸ªé™æ€åº“ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ AR å·¥å…·\næ–°å»ºæ–‡ä»¶å¤¹staticlibï¼Œåœ¨ä¸‹é¢åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶add.cå’Œmul.c\n1 2 3 4  void add(int *x,int *y,int *z) { *z = (*x) + (*y); }   1 2 3 4  void mul(int *x,int *y,int *z) { *z = (*x) * (*y); }   å¹¶ä¸”æ–°å»ºä¸€ä¸ªæ–‡ä»¶mymath.hï¼Œé‡Œé¢åŒ…å«äº†ä¸Šé¢ä¸¤ä¸ªæ–‡ä»¶çš„å‡½æ•°ç”³æ˜ï¼š\n1 2  void add(int *x,int *y,int *z); void mul(int *x,int *y,int *z);   åœ¨æ–‡ä»¶å¤¹staticlibä¸‹æ‰§è¡Œï¼Œç¼–è¯‘æˆ.oæ–‡ä»¶(å°±æ˜¯ä¸€ç§å¯é‡å®šä½æ–‡ä»¶)\ngcc -c *.c ä½¿ç”¨ AR å·¥å…·ç”Ÿæˆé™æ€é“¾æ¥åº“\nar rcs libmymath.a add.o mul.o  åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œé™æ€åº“ä»¥ä¸€ç§ç§°ä¸ºå­˜æ¡£ï¼ˆarchive)çš„ç‰¹æ®Šæ–‡ä»¶æ ¼å¼å­˜æ”¾åœ¨ç£ç›˜ä¸­ã€‚å­˜æ¡£æ–‡ä»¶æ˜¯ä¸€ç»„è¿æ¥èµ·æ¥çš„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶çš„é›†åˆï¼Œæœ‰ä¸€ä¸ªå¤´éƒ¨ç”¨æ¥æè¿°æ¯ä¸ªæˆå‘˜ç›®æ ‡æ–‡ä»¶çš„å¤§å°å’Œä½ç½®ã€‚å­˜æ¡£æ–‡ä»¶åç”±åç¼€**.a** æ ‡è¯†ã€‚\n ä¸ºäº†ä½¿ç”¨è¿™ä¸ªåº“ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªåº”ç”¨ï¼Œä¸æ–‡ä»¶å¤¹staticlibåŒçº§åˆ›å»ºæ–‡ä»¶main.c\n1 2 3 4 5 6 7 8 9 10 11 12 13  #include \u0026lt;stdio.h\u0026gt;#include \u0026#34;staticlib/mymath.h\u0026#34; int main(int argc,const char *argv) { int x = 1,y = 2; int z; printf(\u0026#34;x = %d y = %d \\n\u0026#34;,x,y); add(\u0026amp;x,\u0026amp;y,\u0026amp;z); printf(\u0026#34;add: Z = %d\\n\u0026#34;,z); return 0; }   gcc - c main.c libc.aæ²¡æœ‰å®‰è£…ä¼šæŠ¥é”™ï¼Œæ­¤æ—¶å¯ä»¥æ‰§è¡Œä¸‹é¢çš„è¯­å¥å®‰è£…ï¼š\nyum install glibc-static ä¸‹é¢ä½¿ç”¨é™æ€é“¾æ¥é“¾æ¥ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶\ngcc -static -o main main.o ./staticlib/libmymath.a æˆ–è€…\ngcc -static -o main main.o -L staticlib/ -lmymath -static å‚æ•°å‘Šè¯‰ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åºï¼Œé“¾æ¥å™¨åº”è¯¥æ„å»ºä¸€ä¸ªå®Œå…¨é“¾æ¥çš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ï¼Œå®ƒå¯ä»¥åŠ è½½åˆ°å†…å­˜å¹¶è¿è¡Œï¼Œåœ¨åŠ è½½æ—¶æ— é¡»æ›´è¿›ä¸€æ­¥çš„é“¾æ¥ã€‚-lmymath å‚æ•°æ˜¯ libvector.a çš„ç¼©å†™ï¼Œ-L.å‚æ•°å‘Šè¯‰é“¾æ¥å™¨åœ¨å½“å‰ç›®å½•ä¸‹æŸ»æ‰¾ libvector.a\nå¤§æ¦‚çš„æµç¨‹æ˜¯ä¸‹é¢è¿™å¼ å›¾ï¼š\nå½“é“¾æ¥å™¨è¿è¡Œæ—¶ï¼Œå®ƒåˆ¤å®š mainå¼•ç”¨äº†add.oå®šä¹‰çš„ add ç¬¦å·ï¼Œæ‰€ä»¥å¤åˆ¶add.o åˆ°å¯æ‰§è¡Œæ–‡ä»¶ã€‚å› ä¸ºç¨‹åºä¸å¼•ç”¨ä»»ä½•ç”± mul.o å®šä¹‰çš„ç¬¦å·ï¼Œæ‰€ä»¥é“¾æ¥å™¨å°±ä¸ä¼šå¤åˆ¶è¿™ä¸ªæ¨¡å—åˆ°å¯æ‰§è¡Œæ–‡ä»¶ã€‚é“¾æ¥å™¨è¿˜ä¼šå¤åˆ¶ libc.a ä¸­çš„ printf.o æ¨¡å—ï¼Œä»¥åŠè®¸å¤š C è¿è¡Œæ—¶ç³»ç»Ÿä¸­çš„å…¶ä»–æ¨¡å—ã€‚\n ar æ˜¯ Linux çš„ä¸€ä¸ªå¤‡ä»½å‹ç¼©å‘½ä»¤ï¼Œå®ƒå¯ä»¥å°†å¤šä¸ªæ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ï¼ˆä¹Ÿå«å½’æ¡£æ–‡ä»¶ï¼‰ï¼Œä¹Ÿå¯ä»¥ä»å¤‡ä»½æ–‡ä»¶ä¸­æå–æˆå‘˜æ–‡ä»¶ã€‚ar å‘½ä»¤æœ€å¸¸è§çš„ç”¨æ³•æ˜¯å°†ç›®æ ‡æ–‡ä»¶æ‰“åŒ…ä¸ºé™æ€é“¾æ¥åº“ã€‚\nå¯¹å‚æ•°çš„è¯´æ˜ï¼š\n å‚æ•° r ç”¨æ¥æ›¿æ¢åº“ä¸­å·²æœ‰çš„ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–è€…åŠ å…¥æ–°çš„ç›®æ ‡æ–‡ä»¶ã€‚ å‚æ•° c è¡¨ç¤ºåˆ›å»ºä¸€ä¸ªåº“ã€‚ä¸ç®¡åº“å¦å­˜åœ¨ï¼Œéƒ½å°†åˆ›å»ºã€‚ã€€ å‚æ•° s ç”¨æ¥åˆ›å»ºç›®æ ‡æ–‡ä»¶ç´¢å¼•ï¼Œè¿™åœ¨åˆ›å»ºè¾ƒå¤§çš„åº“æ—¶èƒ½æé«˜é€Ÿåº¦ã€‚   ä½¿ç”¨é™æ€é“¾æ¥åº“æ—¶ï¼Œé™¤äº†éœ€è¦åº“æ–‡ä»¶æœ¬èº«ï¼Œè¿˜éœ€è¦å¯¹åº”çš„å¤´æ–‡ä»¶ï¼šåº“æ–‡ä»¶åŒ…å«äº†çœŸæ­£çš„å‡½æ•°ä»£ç ï¼Œä¹Ÿå³å‡½æ•°å®šä¹‰éƒ¨åˆ†ï¼›å¤´æ–‡ä»¶åŒ…å«äº†å‡½æ•°çš„è°ƒç”¨æ–¹æ³•ï¼Œä¹Ÿå³å‡½æ•°å£°æ˜éƒ¨åˆ†ã€‚\nå½“é“¾æ¥å™¨æ„é€ ä¸€ä¸ªè¾“å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œå®ƒåªå¤åˆ¶é™æ€åº“é‡Œè¢«åº”ç”¨ç¨‹åºå¼•ç”¨çš„ç›®æ ‡æ¨¡å—ã€‚\nç¬¦å·è§£æ é“¾æ¥å™¨å¦‚ä½•è§£æé™æ€é“¾æ¥åº“ï¼Ÿ\nåœ¨ç¬¦å·è§£æé˜¶æ®µï¼Œé“¾æ¥å™¨ä»å·¦åˆ°å³æŒ‰ç…§å®ƒä»¬åœ¨ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åºå‘½ä»¤è¡Œä¸Šå‡ºç°çš„é¡ºåºæ¥æ‰«æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œå­˜æ¡£æ–‡ä»¶ã€‚\né“¾æ¥å™¨ç»´æŠ¤çš„ä¸‰ä¸ªé›†åˆï¼š\n å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶é›†åˆE æœªè§£æçš„ç¬¦å·é›†åˆU å·²å®šä¹‰çš„ç¬¦å·é›†åˆD  åˆå§‹æ—¶ï¼Œä¸‰ä¸ªé›†åˆéƒ½ä¸ºç©ºï¼›æœ€ç»ˆçš„ç»“æœåº”è¯¥æ˜¯é›†åˆUä¸ºç©ºï¼Œæ‰æ˜¯é“¾æ¥æˆåŠŸï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚\nå‡å¦‚æ˜¯ç›®æ ‡æ–‡ä»¶\nå‡å¦‚æ˜¯å­˜æ¡£æ–‡ä»¶ï¼Œé‚£ä¹ˆé“¾æ¥å™¨å°±å°è¯•åŒ¹é… U ä¸­æœªè§£æçš„ç¬¦å·å’Œç”±å­˜æ¡£æ–‡ä»¶æˆå‘˜å®šä¹‰çš„ç¬¦å·ã€‚å¦‚æœæŸä¸ªå­˜æ¡£æ–‡ä»¶æˆå‘˜ må®šä¹‰äº†ä¸€ä¸ªç¬¦å·æ¥è§£æ U ä¸­çš„ä¸€ä¸ªå¼•ç”¨ï¼Œé‚£ä¹ˆå°±å°† m åŠ åˆ° Eä¸­ï¼Œå¹¶ä¸”é“¾æ¥å™¨ä¿®æ”¹U å’Œ Dæ¥åæ˜  m ä¸­çš„ç¬¦å·å®šä¹‰å’Œå¼•ç”¨ã€‚å¯¹å­˜æ¡£æ–‡ä»¶ä¸­æ‰€æœ‰çš„æˆå‘˜ç›®æ ‡æ–‡ä»¶éƒ½ä¾æ¬¡è¿›è¡Œè¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ° U å’Œ Déƒ½ä¸å†å‘ç”Ÿå˜åŒ–ã€‚æ­¤æ—¶ï¼Œä»»ä½•ä¸åŒ…å«åœ¨ Eä¸­çš„æˆå‘˜ç›®æ ‡æ–‡ä»¶éƒ½ç®€å•åœ°è¢«ä¸¢å¼ƒï¼Œè€Œé“¾æ¥å™¨å°†ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªè¾“å…¥æ–‡ä»¶ã€‚\næœ€åï¼Œå¦‚æœUæ˜¯ç©ºé›†ï¼Œå®ƒä¼šåˆå¹¶å’Œé‡å®šä½ Eä¸­çš„ç›®æ ‡æ–‡ä»¶ï¼Œæ„å»ºè¾“å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚\nåœ¨å‘½ä»¤è¡Œä¸­ï¼Œå¦‚æœå®šä¹‰ä¸€ä¸ªç¬¦å·çš„åº“å‡ºç°åœ¨å¼•ç”¨è¿™ä¸ªç¬¦å·çš„ç›®æ ‡æ–‡ä»¶ä¹‹å‰ï¼Œé‚£ä¹ˆå¼•ç”¨å°±ä¸èƒ½è¢«è§£æï¼Œé“¾æ¥ä¼šå¤±è´¥ã€‚(å› ä¸ºä¸€å¼€å§‹é›†åˆUæ˜¯ç©ºçš„ï¼Œå­˜æ¡£æ–‡ä»¶ä¼šå‡å¦‚Eä¸­ï¼Œå­˜æ¡£æ–‡ä»¶é‡Œé¢çš„å®šä¹‰æ°¸è¿œä¸ä¼šè¢«è§£æ)\nå…³äºåº“çš„ä¸€èˆ¬å‡†åˆ™æ˜¯å°†å®ƒä»¬æ”¾åœ¨å‘½ä»¤è¡Œçš„ç»“å°¾ã€‚\né‡å®šä½ æ­¤æ—¶ï¼Œé“¾æ¥å™¨å°±çŸ¥é“å®ƒçš„è¾“äººç›®æ ‡æ¨¡å—ä¸­çš„ä»£ç èŠ‚å’Œæ•°æ®èŠ‚çš„ç¡®åˆ‡å¤§å°ã€‚ç°åœ¨å°±å¯ä»¥å¼€å§‹é‡å®šä½æ­¥éª¤äº†ï¼Œåœ¨è¿™ä¸ªæ­¥éª¤ä¸­ï¼Œå°†åˆå¹¶è¾“äººæ¨¡å—ï¼Œå¹¶ä¸ºæ¯ä¸ªç¬¦å·åˆ†é…è¿è¡Œæ—¶åœ°å€ã€‚é‡å®šä½ç”±ä¸¤æ­¥ç»„æˆï¼š\n æ³¨æ„ä¸‹é¢ä¸€ä¸ªæ˜¯ç¬¦å·å®šä¹‰ï¼Œä¸€ä¸ªæ˜¯ç¬¦å·å¼•ç”¨ï¼Œä¸¤è€…ä¸ä¸€æ ·ï¼\n   é‡å®šä½èŠ‚å’Œç¬¦å·å®šä¹‰\nåœ¨è¿™ä¸€æ­¥ä¸­ï¼Œé“¾æ¥å™¨å°†æ‰€æœ‰ç›¸åŒç±»å‹çš„èŠ‚åˆå¹¶ä¸ºåŒä¸€ç±»å‹çš„æ–°çš„èšåˆèŠ‚ã€‚ä¾‹å¦‚ï¼Œæ¥è‡ªæ‰€æœ‰è¾“äººæ¨¡å—çš„.data èŠ‚è¢«å…¨éƒ¨åˆå¹¶æˆä¸€ä¸ªèŠ‚ï¼Œè¿™ä¸ªèŠ‚æˆä¸ºè¾“å‡ºçš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶çš„.data èŠ‚ã€‚ç„¶åï¼Œé“¾æ¥å™¨å°†è¿è¡Œæ—¶å†…å­˜åœ°å€èµ‹ç»™æ–°çš„èšåˆèŠ‚ï¼Œèµ‹ç»™è¾“äººæ¨¡å—å®šä¹‰çš„æ¯ä¸ªèŠ‚ï¼Œä»¥åŠèµ‹ç»™è¾“äººæ¨¡å—å®šä¹‰çš„æ¯ä¸ªç¬¦å·ã€‚å½“è¿™ä¸€æ­¥å®Œæˆæ—¶ï¼Œç¨‹åºä¸­çš„æ¯æ¡æŒ‡ä»¤å’Œå…¨å±€å˜é‡éƒ½æœ‰å”¯ä¸€çš„è¿è¡Œæ—¶å†…å­˜åœ°å€äº†ã€‚ä¹Ÿå°±æ˜¯æŒ‡ä»¤æ®µä¸ä»£ç æ®µä¸­å…¨å±€ã€é™æ€å˜é‡ã€å‡½æ•°å…¥å£ä»¥åŠæŒ‡ä»¤çš„è¿è¡Œæ—¶å†…å­˜åœ°å€éƒ½å·²ç¡®å®šã€‚\n æ³¨æ„ï¼š\n.bssæ®µåœ¨ç›®æ ‡æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶ä¸­å¹¶ä¸å ç”¨æ–‡ä»¶çš„ç©ºé—´ï¼Œä½†æ˜¯å®ƒåœ¨è£…è½½æ—¶å ç”¨åœ°å€ç©ºé—´ï¼ˆå ç”¨çš„æ˜¯è™šæ‹Ÿåœ°å€ç©ºé—´ï¼‰\n   é‡å®šä½èŠ‚ä¸­çš„ç¬¦å·å¼•ç”¨\nè¿™ä¸€æ­¥ä¸­ï¼Œé“¾æ¥å™¨ä¿®æ”¹ä»£ç èŠ‚å’Œæ•°æ®èŠ‚ä¸­å¯¹äºæ¯ä¸ªç¬¦å·çš„å¼•ç”¨ï¼Œä½¿å¾—ä»–ä»¬æŒ‡å‘æ­£ç¡®çš„è¿è¡Œæ—¶åœ°å€ã€‚ è¿™ä¸€æ­¥é“¾æ¥å™¨ä¾èµ–äºå¯é‡å®šä½ç›®æ ‡æ¨¡å—ä¸­ç§°ä¸ºé‡å®šä½æ¡ç›®çš„æ•°æ®ç»“æ„ã€‚\nå‚è€ƒåœ°å€ï¼šhttps://blog.csdn.net/weixin_44176696/article/details/106666236\né‡å®šä½æ¡ç›®\næ— è®ºä½•æ—¶æ±‡ç¼–å™¨é‡åˆ°å¯¹æœ€ç»ˆä½ç½®æœªçŸ¥çš„ç›®æ ‡å¼•ç”¨ï¼Œå®ƒå°±ä¼šç”Ÿæˆä¸€ä¸ªé‡å®šä½æ¡ç›® ï¼Œå‘Šè¯‰é“¾æ¥å™¨åœ¨å°†ç›®æ ‡æ–‡ä»¶åˆå¹¶æˆå¯æ‰§è¡Œæ–‡ä»¶æ—¶å¦‚ä½•ä¿®æ”¹è¿™ä¸ªå¼•ç”¨ã€‚ä»£ç çš„é‡å®šä½æ¡ç›®æ”¾åœ¨ .rel.text ä¸­ã€‚å·²åˆå§‹åŒ–æ•°æ®çš„é‡å®šä½æ¡ç›®æ”¾åœ¨ .rel.data ä¸­ã€‚\n  åŠ¨æ€é“¾æ¥ å¯¹äºé™æ€é“¾æ¥æ¥è¯´ï¼Œå®ƒè¿˜æ˜¯å¤ªæ¶ˆè€—å†…å­˜äº†ã€‚\nå…±äº«åº“ï¼ˆshared library)æ˜¯è‡´åŠ›äºè§£å†³é™æ€åº“ç¼ºé™·çš„ä¸€ä¸ªç°ä»£åˆ›æ–°äº§ç‰©ã€‚å…±äº«åº“æ˜¯ä¸€ä¸ªç›®æ ‡æ¨¡å—ï¼Œåœ¨è¿è¡Œæˆ–åŠ è½½æ—¶ï¼Œå¯ä»¥åŠ è½½åˆ°ä»»æ„çš„å†…å­˜åœ°å€ï¼Œå¹¶å’Œä¸€ä¸ªåœ¨å†…å­˜ä¸­çš„ç¨‹åºé“¾æ¥èµ·æ¥ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºåŠ¨æ€é“¾æ¥(dynamic linking)ï¿½ æ˜¯ç”±ä¸€ä¸ªå«åšåŠ¨æ€é“¾æ¥å™¨ï¼ˆdynamic linker)\nçš„ç¨‹åºæ¥æ‰§è¡Œçš„ã€‚\nå…±äº«åº“æ˜¯ä»¥ä¸¤ç§ä¸åŒçš„æ–¹å¼æ¥â€œå…±äº«â€ï¼š\n  åœ¨ä»»ä½•ç»™å®šçš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¯¹äºä¸€ä¸ªåº“åªæœ‰ä¸€ä¸ª.so æ–‡ä»¶ã€‚\næ‰€æœ‰å¼•ç”¨è¯¥åº“çš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶å…±äº«è¿™ä¸ª.soæ–‡ä»¶ä¸­çš„ä»£ç å’Œæ•°æ®ï¼Œè€Œä¸æ˜¯åƒé™æ€åº“çš„å†…å®¹é‚£æ ·è¢«å¤åˆ¶å’ŒåµŒäººåˆ°å¼•ç”¨å®ƒä»¬çš„å¯æ‰§è¡Œçš„æ–‡ä»¶ä¸­ã€‚\n  å…¶æ¬¡ï¼Œåœ¨å†…å­˜ä¸­ï¼Œä¸€ä¸ªå…±äº«åº“çš„ .text èŠ‚çš„ä¸€ä¸ªå‰¯æœ¬å¯ä»¥è¢«ä¸åŒçš„æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹å…±äº«ã€‚\n  åŸºæœ¬çš„æ€è·¯æ˜¯å½“åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œé™æ€æ‰§è¡Œä¸€äº›é“¾æ¥ï¼Œç„¶ååœ¨ç¨‹åºåŠ è½½æ—¶ï¼ŒåŠ¨æ€å®Œæˆé“¾æ¥è¿‡ç¨‹ã€‚\næ²¡æœ‰ä»»ä½• libmymath.so çš„ä»£ç å’Œæ•°æ®èŠ‚çœŸçš„è¢«å¤åˆ¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶ main ä¸­ã€‚åä¹‹ï¼Œé“¾æ¥å™¨å¤åˆ¶äº†ä¸€äº›é‡å®šä½å’Œç¬¦å·è¡¨ä¿¡æ¯ï¼Œå®ƒä»¬ä½¿å¾—è¿è¡Œæ—¶å¯ä»¥è§£æå¯¹ libmymath.so ä¸­ä»£ç å’Œæ•°æ®çš„å¼•ç”¨ã€‚\nåŠ¨æ€é“¾æ¥å™¨é€šè¿‡æ‰§è¡Œä¸‹é¢çš„é‡å®šä½å®Œæˆé“¾æ¥ä»»åŠ¡ï¼š\n é‡å®šä½ libc.so çš„æ–‡æœ¬å’Œæ•°æ®åˆ°æŸä¸ªå†…å­˜æ®µ é‡å®šä½ libmymath.so çš„æ–‡æœ¬å’Œæ•°æ®åˆ°å¦ä¸€ä¸ªå†…å­˜æ®µ é‡å®šä½ main ä¸­æ‰€æœ‰å¯¹ç”± libc.so å’Œ libmymath.so å®šä¹‰çš„ç¬¦å·çš„å¼•ç”¨  æœ€åï¼ŒåŠ¨æ€é“¾æ¥å™¨å°†æ§åˆ¶ä¼ é€’ç»™åº”ç”¨ç¨‹åºã€‚ä»è¿™ä¸ªæ—¶åˆ»å¼€å§‹ï¼Œå…±äº«åº“çš„ä½ç½®å°±å›ºå®šäº†ï¼Œå¹¶ä¸”åœ¨ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ä¸­éƒ½ä¸ä¼šæ”¹å˜ã€‚\nä½¿ç”¨åŠ¨æ€é“¾æ¥åº“ å¦‚æœæƒ³åˆ›å»ºä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼Œå¯ä»¥ä½¿ç”¨ GCC çš„-sharedé€‰é¡¹ã€‚è¾“å…¥æ–‡ä»¶å¯ä»¥æ˜¯æºæ–‡ä»¶ã€æ±‡ç¼–æ–‡ä»¶æˆ–è€…ç›®æ ‡æ–‡ä»¶ã€‚\nå¦å¤–è¿˜å¾—ç»“åˆ-fPICé€‰é¡¹ã€‚-fPIC é€‰é¡¹ä½œç”¨äºç¼–è¯‘é˜¶æ®µï¼Œå‘Šè¯‰ç¼–è¯‘å™¨äº§ç”Ÿä¸ä½ç½®æ— å…³ä»£ç ï¼ˆPosition-Independent Codeï¼‰ï¼›è¿™æ ·ä¸€æ¥ï¼Œäº§ç”Ÿçš„ä»£ç ä¸­å°±æ²¡æœ‰ç»å¯¹åœ°å€äº†ï¼Œå…¨éƒ¨ä½¿ç”¨ç›¸å¯¹åœ°å€ï¼Œæ‰€ä»¥ä»£ç å¯ä»¥è¢«åŠ è½½å™¨åŠ è½½åˆ°å†…å­˜çš„ä»»æ„ä½ç½®ï¼Œéƒ½å¯ä»¥æ­£ç¡®çš„æ‰§è¡Œã€‚è¿™æ­£æ˜¯å…±äº«åº“æ‰€è¦æ±‚çš„ï¼Œå…±äº«åº“è¢«åŠ è½½æ—¶ï¼Œåœ¨å†…å­˜çš„ä½ç½®ä¸æ˜¯å›ºå®šçš„ã€‚\næ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œåˆ›å»ºå’Œä½¿ç”¨åŠ¨æ€é“¾æ¥åº“\ngcc -shared -fpic -o libmymath.so add.c mul.c gcc -o main main.c ./libmymath.so -fPIC é€‰é¡¹ä½œç”¨äºç¼–è¯‘é˜¶æ®µï¼Œåœ¨ç”Ÿæˆç›®æ ‡æ–‡ä»¶æ—¶å°±å¾—ä½¿ç”¨è¯¥é€‰é¡¹ï¼Œä»¥ç”Ÿæˆä½ç½®æ— å…³çš„ä»£ç ã€‚\nå½“ç„¶ï¼Œå¿…é¡»è¦ç¡®ä¿ç¨‹åºåœ¨è¿è¡Œæ—¶å¯ä»¥æ‰¾åˆ°è¿™ä¸ªåŠ¨æ€é“¾æ¥åº“ã€‚ä½ å¯ä»¥å°†é“¾æ¥åº“æ”¾åˆ°æ ‡å‡†ç›®å½•ä¸‹ï¼Œä¾‹å¦‚ /usr/libï¼Œæˆ–è€…è®¾ç½®ä¸€ä¸ªåˆé€‚çš„ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚ LIBRARY_PATHã€‚ä¸åŒç³»ç»Ÿï¼Œå…·æœ‰ä¸åŒçš„åŠ è½½é“¾æ¥åº“çš„æ–¹æ³•ã€‚\nå‚è€ƒï¼š\n GCCåˆ›å»ºå’Œä½¿ç”¨é™æ€é“¾æ¥åº“ï¼ˆ.aæ–‡ä»¶ï¼‰ GCCç”ŸæˆåŠ¨æ€é“¾æ¥åº“ï¼ˆ.soæ–‡ä»¶ï¼‰ Cè¯­è¨€å’ŒC++çš„æ··åˆç¼–è¯‘  ","description":"é“¾æ¥(linking)æ˜¯å°†å„ç§ä»£ç å’Œæ•°æ®ç‰‡æ®µæ”¶é›†å¹¶ç»„åˆæˆä¸ºä¸€ä¸ªå•ä¸€æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªæ–‡ä»¶å¯è¢«åŠ è½½ï¼ˆå¤åˆ¶ï¼‰åˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚","id":44,"section":"posts","tags":["Linux"],"title":"linking","uri":"https://hugo.jiahongw.com/zh/posts/linux/linking/"},{"content":"åº“æ‰“æ¡©æœºåˆ¶ LInuxé“¾æ¥å™¨æœ‰å¼ºå¤§çš„åº“æ‰“æ¡©æœºåˆ¶ï¼Œå®ƒå…è®¸ä½ å¯¹å…±äº«åº“çš„ä»£ç è¿›è¡Œæˆªå–ï¼Œä»è€Œæ‰§è¡Œè‡ªå·±çš„ä»£ç ã€‚è€Œä¸ºäº†è°ƒè¯•ï¼Œä½ é€šå¸¸å¯ä»¥åœ¨è‡ªå·±çš„ä»£ç ä¸­åŠ å…¥ä¸€äº›è°ƒè¯•ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œè°ƒç”¨æ¬¡æ•°ï¼Œæ‰“å°ä¿¡æ¯ï¼Œè°ƒç”¨æ—¶é—´ç­‰ç­‰ã€‚\nåŸºæœ¬åŸç† åŸºæœ¬æ€æƒ³ ç»™å®šéœ€è¦æ‰“æ¡©çš„ç›®æ ‡å‡½æ•°ï¼Œå¸¸è§ä¸€ä¸ªwrapperå‡½æ•°ï¼Œå…¶åŸå‹å’Œç›®æ ‡å‡½æ•°ä¸€è‡´ã€‚åˆ©ç”¨ç‰¹æ®Šçš„æ‰“æ¡©æœºåˆ¶ï¼Œå¯ä»¥å®ç°è®©ç³»ç»Ÿè°ƒç”¨ä½ çš„wrapperå‡½æ•°è€Œä¸æ˜¯ç›®æ ‡å‡½æ•°ã€‚wrapperå‡½æ•°ä¸­é€šå¸¸ä¼šæ‰§è¡Œè‡ªå·±çš„é€»è¾‘ï¼Œç„¶åè°ƒç”¨ç›®æ ‡å‡½æ•°ï¼Œå†å°†ç›®æ ‡å‡½æ•°çš„è¿”å›å€¼ä¼ é€’ç»™è°ƒç”¨è€…ã€‚\n æ‰“æ¡©å¯ä»¥å‘ç”Ÿåœ¨ç¼–è¯‘æ—¶ã€é“¾æ¥æ—¶æˆ–è€…ç¨‹åºè¢«åŠ è½½æ‰§è¡Œçš„è¿è¡Œæ—¶ã€‚ä¸åŒçš„é˜¶æ®µéƒ½æœ‰å¯¹åº”çš„æ‰“æ¡©æœºåˆ¶ï¼Œä¹Ÿæœ‰å…¶å±€é™æ€§ã€‚\n æ‰“æ¡©æ—¶æœŸ åˆ›å»ºä¸€ä¸ªmain.cæ–‡ä»¶ï¼Œå†…å®¹ï¼š\n1 2 3 4 5 6 7 8 9  #include \u0026lt;stdio.h\u0026gt;#include \u0026lt;malloc.h\u0026gt;int main() { char *p = malloc(64); printf(\u0026#34;Hello\\n\u0026#34;); free(p); return 0; }   ç¼–è¯‘æ—¶æ‰“æ¡©  ä½¿ç”¨ C é¢„å¤„ç†å™¨åœ¨ç¼–è¯‘æ—¶æ‰“æ¡©ã€‚\n å®šä¹‰æ’æ¡©å‡½æ•°å¤´æ–‡ä»¶ malloc.h\n1 2 3 4 5  #define malloc(size) mymalloc(size)#define freeCptr) myfree(ptr) 23 void *mymalloc(size_t size); void myfree(void *ptr);   å®šä¹‰æ’æ¡©å‡½æ•°çš„æ–‡ä»¶ mymalloc.c\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  // mymalloc.c #ifdef COMPILETIME#include \u0026lt;stdio.h\u0026gt;#include \u0026lt;malloc.h\u0026gt; // malloc wrapper function void * mymalloc(size_t size) { void * ptr = malloc(size); printf(\u0026#34;malloc %p size %u\\n\u0026#34;, ptr, size); return ptr; } // free wrapper function void myfree(void *ptr) { free(ptr); printf(\u0026#34;free %p\\n\u0026#34;, ptr); } #endif  è¿™æ ·ç¼–è¯‘å’Œé“¾æ¥ç¨‹åº\n1 2  gcc -DCOMPILETIME -c mymalloc.c gcc -I. -o main main.c mymalloc.o   æ‰§è¡Œï¼š\n1  ./main   é“¾æ¥æ—¶æ‰“æ¡©  é“¾æ¥(linking)æ˜¯å°†å„ç§ä»£ç å’Œæ•°æ®ç‰‡æ®µæ”¶é›†å¹¶ç»„åˆæˆä¸ºä¸€ä¸ªå•ä¸€æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªæ–‡ä»¶å¯è¢«åŠ è½½ï¼ˆå¤åˆ¶ï¼‰åˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚\n è¿™ä¸ªä¸éœ€è¦å¤´æ–‡ä»¶ï¼Œç›´æ¥åˆ›å»ºä¸€ä¸ªæ’æ¡©å‡½æ•°æ–‡ä»¶ mymalloc.c:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  #ifdef LINKTIME#include \u0026lt;stdio.h\u0026gt;void *__real_malloc(size_t size); void __real_free(void *ptr); /* malloc wrapper function */ void *__wrap_malloc(size_t size) { void *p = __real_malloc(size); // è°ƒç”¨libcçš„malloc  printf(\u0026#34;malloc(%d) = %p \\n\u0026#34;,size,p); return p; } /* free wrapper function */ void *__wrap_free(void *ptr) { __real_free(ptr); printf(\u0026#34;free(%p)\\n\u0026#34;,ptr); } #endif  è¿™æ ·ç¼–è¯‘å’Œé“¾æ¥ç¨‹åº\n1 2 3  gcc -DLINKTIME -c mymalloc.c gcc -c main.c gcc -Wl,--wrap,malloc -Wl,--wrap,free -o main main.o mymalloc.o   æ‰§è¡Œ\n1  ./main   è¿è¡Œæ—¶æ‰“æ¡© åˆ›å»ºä¸€ä¸ªæ’æ¡©å‡½æ•°æ–‡ä»¶ mymalloc.c:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  #ifdef RUNTIME #define _GNU_SOURCE#include \u0026lt;stdio.h\u0026gt;#include \u0026lt;stdlib.h\u0026gt;#include \u0026lt;dlfcn.h\u0026gt; /* malloc wrapper function */ void *malloc(size_t size) { void *(*mallocp)(size_t size); char *error; mallocp = dlsym(RTLD_NEXT,\u0026#34;malloc\u0026#34;); // get the address of libc malloc  if((error = dlerror()) != NULL) { fputs(error,stderr); exit(1); } char *ptr = mallocp(size); printf(\u0026#34;malloc(%d) = %p \\n\u0026#34;,(int)size,ptr); return ptr; } /* free wrapper function */ void free(void* ptr) { void (*freep)(void*) = NULL; char *error; if(!ptr) return; freep = dlsym(RTLD_NEXT,\u0026#34;free\u0026#34;); if((error = dlerror()) != NULL) { fputs(error,stderr); exit(1); } freep(ptr); printf(\u0026#34;free(%p)\\n\u0026#34;,ptr); } #endif  è¿™æ ·ç¼–è¯‘é“¾æ¥æ‰§è¡Œç¨‹åº\n1 2 3  gcc -DRUNTIME -shared -fpic -o mymalloc.so mymalloc.c -ldl gcc -o main main.c LD_PRELOAD=\u0026#34;./mymalloc.so\u0026#34; ./main   GCCç›¸å…³å‚æ•°    å‚æ•° åŠŸèƒ½     -c åªæ¿€æ´»é¢„å¤„ç†,ç¼–è¯‘,å’Œæ±‡ç¼–,ä¹Ÿå°±æ˜¯ä»–åªæŠŠç¨‹åºåšæˆobjæ–‡ä»¶,å°†ç”Ÿæˆ .o çš„ obj æ–‡ä»¶\nä¾‹å­ï¼šgcc -c hello.c   -S åªæ¿€æ´»é¢„å¤„ç†å’Œç¼–è¯‘ï¼Œå°±æ˜¯æŒ‡æŠŠæ–‡ä»¶ç¼–è¯‘æˆä¸ºæ±‡ç¼–ä»£ç ,å°†ç”Ÿæˆ .s çš„æ±‡ç¼–ä»£ç ã€‚\nä¾‹å­ï¼šgcc -S hello.c    -E åªæ¿€æ´»é¢„å¤„ç†,è¿™ä¸ªä¸ç”Ÿæˆæ–‡ä»¶, ä½ éœ€è¦æŠŠå®ƒé‡å®šå‘åˆ°ä¸€ä¸ªè¾“å‡ºæ–‡ä»¶é‡Œé¢ã€‚\nä¾‹å­ï¼šgcc -E hello.c \u0026gt; pianoapan.txt gcc -E hello.c | more    -o æŒ‡å®šç›®æ ‡åç§°   -g åªæ˜¯ç¼–è¯‘å™¨ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œäº§ç”Ÿè°ƒè¯•ä¿¡æ¯ã€‚   -static æ­¤é€‰é¡¹å°†ç¦æ­¢ä½¿ç”¨åŠ¨æ€åº“ï¼Œæ‰€ä»¥ï¼Œç¼–è¯‘å‡ºæ¥çš„ä¸œè¥¿ï¼Œä¸€èˆ¬éƒ½å¾ˆå¤§ï¼Œä¹Ÿä¸éœ€è¦ä»€ä¹ˆåŠ¨æ€è¿æ¥åº“ï¼Œå°±å¯ä»¥è¿è¡Œã€‚   -share æ­¤é€‰é¡¹å°†å°½é‡ä½¿ç”¨åŠ¨æ€åº“ï¼Œæ‰€ä»¥ç”Ÿæˆæ–‡ä»¶æ¯”è¾ƒå°ï¼Œä½†æ˜¯éœ€è¦ç³»ç»Ÿç”±åŠ¨æ€åº“ã€‚    æˆ‘ä»¬é€šè¿‡lddå‘½ä»¤æŸ¥çœ‹ç¨‹åºé“¾æ¥çš„ç³»ç»Ÿåº“ï¼š\nå‚è€ƒé“¾æ¥ï¼š\n https://zhuanlan.zhihu.com/p/76036630 https://www.cnblogs.com/tocy/p/Linux-library-Interposition.html GCC å‚æ•°è¯¦è§£  ","description":"LInuxé“¾æ¥å™¨æœ‰å¼ºå¤§çš„åº“æ‰“æ¡©æœºåˆ¶ï¼Œå®ƒå…è®¸ä½ å¯¹å…±äº«åº“çš„ä»£ç è¿›è¡Œæˆªå–ï¼Œä»è€Œæ‰§è¡Œè‡ªå·±çš„ä»£ç ã€‚è€Œä¸ºäº†è°ƒè¯•ï¼Œä½ é€šå¸¸å¯ä»¥åœ¨è‡ªå·±çš„ä»£ç ä¸­åŠ å…¥ä¸€äº›è°ƒè¯•ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œè°ƒç”¨æ¬¡æ•°ï¼Œæ‰“å°ä¿¡æ¯ï¼Œè°ƒç”¨æ—¶é—´ç­‰ç­‰ã€‚","id":45,"section":"posts","tags":["MLK"],"title":"æ‰“æ¡©æœºåˆ¶","uri":"https://hugo.jiahongw.com/zh/posts/mlk/interposition/"},{"content":"DieHard ä¸€ä¸ªåŸºäºæ¦‚ç‡å†…å­˜å®‰å…¨çš„è¿è¡Œæ—¶ç³»ç»Ÿã€‚\nåŸºæœ¬ä»‹ç» æºç ï¼šhttps://github.com/emeryberger/DieHard\næ”¯æŒ  Windows Linux Mac OS X  å®‰è£…  éœ€è¦C++14æ”¯æŒ\n   è§£å‹å¹¶ä¸”è¿›å…¥æ–‡ä»¶å¤¹\n1 2  unzip DieHard.zip cd DieHard     ç¼–è¯‘\n1 2 3  cd src/ TARGET=libdiehard make linux-gcc-x86-64-replicated TARGET=libdieharder make linux-gcc-x86-64-replicated   ç¼–è¯‘å®Œæˆåœ¨ç›®å½•ä¸‹ä¼šæ–°å¢3ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼šlibdieharder.soå’Œlibdiehard.soã€libdieharder_r.so\n1 2 3  cd src/util/ g++ -pipe -g -fPIC -I. -I.. -I../../src/archipelago/brokenmalloc -D_REENTRANT=1 -shared libbrokenmalloc.cpp -o libbrokenmalloc.so -ldl g++ -fPIC -pipe -g -I. -I.. -I../../src/archipelago/brokenmalloc/ -D_REENTRANT=1 -shared libtrackalloc.cpp -o libtrackalloc.so -ldl   ç¼–è¯‘å®Œæˆä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆ2ä¸ªåŠ¨æ€é“¾æ¥åº“libbrokenmalloc.soå’Œlibtrackalloc.so\n  ä½¿ç”¨ åŸºæœ¬ä½¿ç”¨æ–¹æ³• åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼š\nåœ¨æ‰§è¡Œç¨‹åºä¹‹å‰æ·»åŠ æå‰åŠ è½½åº“é€‰é¡¹LD_PRELOAD=libdiehard.so\nä¾‹å¦‚ï¼š\n1  LD_PRELOAD=/mnt/MLK/Tools/DieHard/src/libdiehard.so app app_args   åŸç† é”™è¯¯ç±»å‹ æ¶µç›–çš„é”™è¯¯ç±»å‹å¤§æ¦‚ä¸€ä¸‹å‡ ç±»ï¼š\n  Dangling pointers\nè¿·é€”æŒ‡é’ˆï¼Œæˆ–ç§°æ‚¬ç©ºæŒ‡é’ˆã€é‡æŒ‡é’ˆï¼ŒæŒ‡çš„æ˜¯ä¸æŒ‡å‘ä»»ä½•åˆæ³•çš„å¯¹è±¡çš„æŒ‡é’ˆã€‚å½“æ‰€æŒ‡å‘çš„å¯¹è±¡è¢«é‡Šæ”¾æˆ–è€…æ”¶å›ï¼Œä½†æ˜¯å¯¹è¯¥æŒ‡é’ˆæ²¡æœ‰ä½œä»»ä½•çš„ä¿®æ”¹ï¼Œä»¥è‡³äºè¯¥æŒ‡é’ˆä»æ—§æŒ‡å‘å·²ç»å›æ”¶çš„å†…å­˜åœ°å€ï¼Œæ­¤æƒ…å†µä¸‹è¯¥æŒ‡é’ˆä¾¿ç§°è¿·é€”æŒ‡é’ˆã€‚\n  Buffer overflflows\nå †ç¼“å†²æº¢å‡ºã€‚è¶Šç•Œå†™ä¼šæŸåå †ä¸Šæ´»å¯¹è±¡çš„å†…å®¹ã€‚\n  Heap metadata overwrites\nå †å…ƒæ•°æ®è¢«è¦†ç›–ã€‚å¦‚æœå †å…ƒæ•°æ®å­˜å‚¨åœ¨å †å¯¹è±¡é™„è¿‘ï¼Œé‚£ä¹ˆå †è¶Šç•Œå†™å¯èƒ½ä¼šæŸåå®ƒã€‚\n  Uninitialized reads\næœªåˆå§‹åŒ–è¯»ã€‚ä»æ–°åˆ†é…æˆ–æœªåˆ†é…çš„å†…å­˜ä¸­è¯»å–å€¼ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚\n  Invalid frees\néæ³•é‡Šæ”¾å†…å­˜ã€‚å°†éæ³•åœ°å€ä¼ é€’ç»™freeå¯èƒ½ä¼šæŸåå †æˆ–å¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚\n  Double frees\né‡å¤é‡Šæ”¾å†…å­˜ã€‚\n   ä¸Šé¢çš„åˆ†ç±»å…¶å®æœ‰ç‚¹é—®é¢˜ï¼Œæ—¢ç„¶æœªåˆ†é…å†…å­˜è¯»å–éƒ½èƒ½å½’ä¸ºæœªåˆå§‹åŒ–è¯»çš„é—®é¢˜ï¼Œé‚£ä¹ˆé‡å¤é‡Šæ”¾å†…å­˜ä¸ºä»€ä¹ˆä¸èƒ½å½’ä¸ºéæ³•å†…å­˜é‡Šæ”¾å‘¢ï¼Ÿ\n  DieHardä»¥å¾ˆé«˜çš„æ¦‚ç‡æ¶ˆé™¤æˆ–é¿å…äº†ä¸Šè¿°æ‰€æœ‰å†…å­˜é”™è¯¯\n æ¦‚å¿µ probabilistic memory safety(åŸºäºæ¦‚ç‡çš„å†…å­˜å®‰å…¨) å°†ç¨‹åºå®šä¹‰ä¸ºå®Œå…¨å†…å­˜å®‰å…¨ï¼Œå¿…é¡»æ»¡è¶³ä¸‹é¢çš„æ¡ä»¶ï¼š\n ä»ä¸è¯»å–æœªåˆå§‹åŒ–çš„å†…å­˜ã€‚ åœ¨å †ä¸Šä¸æ‰§è¡Œéæ³•æ“ä½œ(éæ³•é‡Šæ”¾å†…å­˜/åŒé‡Šæ”¾å†…å­˜)ã€‚ ä¸è®¿é—®å·²é‡Šæ”¾çš„å†…å­˜(æ²¡æœ‰æ‚¬æµ®æŒ‡é’ˆé”™è¯¯)ã€‚   æ³¨æ„ï¼šä¸Šé¢çš„æ¡ä»¶ä¸­æ²¡æœ‰æåŠå †ç¼“å†²æº¢å‡ºã€‚\n é€šè¿‡ä¸­æ­¢å¯èƒ½è¿åè¿™äº›æ¡ä»¶ä¹‹ä¸€çš„è®¡ç®—ï¼Œå®‰å…¨çš„Cç¼–è¯‘å™¨æä¾›äº†å®Œæ•´çš„å†…å­˜å®‰å…¨ã€‚ ç„¶è€Œï¼Œä½œè€…ç†æƒ³åœ°å¸Œæœ›æœ‰ä¸€ä¸ªæ‰§è¡Œç¯å¢ƒï¼Œå…è®¸è¿™äº›ç¨‹åºåœ¨é¢å¯¹è¿™äº›é”™è¯¯æ—¶ç»§ç»­æ­£ç¡®åœ°æ‰§è¡Œã€‚(ä¾é å¤åˆ¶ç‰ˆæœ¬å®ç°)\nå®šä¹‰ä¸€ä¸ªç†æƒ³ä½†æ— æ³•å®ç°çš„è¿è¡Œæ—¶ç³»ç»Ÿã€‚æˆ‘ä»¬å«å®ƒæ— é™å †å†…å­˜ç®¡ç†å™¨ã€‚å®ƒæä¾›äº†æ— é™å †è¯­ä¹‰ã€‚\ninfifinite-heap(æ— é™å †) åœ¨è¿™æ ·çš„ç³»ç»Ÿä¸­ï¼Œå †çš„é¢ç§¯æ˜¯æ— é™å¤§çš„ï¼Œå› æ­¤ä¸å­˜åœ¨å †è€—å°½çš„é£é™©ã€‚ å¯¹è±¡æ°¸è¿œä¸ä¼šè¢«å»åˆ†é…ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½è¢«åˆ†é…åˆ°å½¼æ­¤æ— é™è¿œçš„åœ°æ–¹(ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬å¯ä»¥è¢«è®¤ä¸ºæ˜¯æ— é™çš„å†…å­˜å—ã€‚\n ä»æ­£ç¡®çš„Cæ‰§è¡Œçš„è§’åº¦æ¥çœ‹ï¼Œä¸€ä¸ªä¸åˆ»æ„å¯»æ±‚è€—å°½å †çš„ç¨‹åºä¸èƒ½åˆ¤æ–­å®ƒæ˜¯ç”¨æ™®é€šçš„å †å®ç°è¿è¡Œè¿˜æ˜¯ç”¨æ— é™çš„å †è¿è¡Œã€‚\n å› ä¸ºæ¯ä¸ªå¯¹è±¡éƒ½ç¦»å…¶ä»–å¯¹è±¡æ— é™è¿œï¼Œå°±ç®—æº¢å‡ºå†™è¦†ç›–çš„ä¹Ÿä¸æ˜¯æœ‰ç”¨çš„å¯¹è±¡æ•°æ®ï¼Œè€Œæ˜¯ç©ºæ•°æ®ï¼Œåˆ†é…çš„å¯¹è±¡ä»æœªè¢«è¦†ç›–ã€‚æ‰€ä»¥ä¸å­˜åœ¨å †ç¼“å†²æº¢å‡ºé—®é¢˜ã€‚\nå› ä¸ºå †å†…å­˜æ— é™å¤§ï¼Œæ‰€ä»¥æ ¹æœ¬ä¸éœ€è¦é‡Šæ”¾å†…å­˜ï¼Œæ‰€ä»¥æ‚¬æµ®æŒ‡é’ˆçš„é—®é¢˜ä¹Ÿæ¶ˆå¤±äº†ã€‚\nå¯¹å †çš„æœªåˆå§‹åŒ–è¯»å–ä»ç„¶æœªå®šä¹‰ã€‚ä¸Javaä¸åŒï¼Œæ–°åˆ†é…çš„Cå’ŒCå¯¹è±¡çš„å†…å®¹ä¸ä¸€å®šè¢«å®šä¹‰ã€‚\nå®é™…æ„å»ºçš„ç³»ç»Ÿ è¿‘ä¼¼æ— é™å † è™½ç„¶æ— é™å †å†…å­˜ç®¡ç†å™¨æ˜¯ä¸å¯å®ç°çš„ï¼Œä½†æˆ‘ä»¬å¯ä»¥æ¦‚ç‡åœ°è¿‘ä¼¼å®ƒçš„è¡Œä¸ºã€‚\næˆ‘ä»¬å°†æ— é™å †æ›¿æ¢ä¸ºä¸€ä¸ªæ‰€éœ€çš„æœ€å¤§å€¼çš„å †çš„Må€å†…å­˜ä»¥è·å¾—æ— é™å †è¯­ä¹‰ã€‚ é€šè¿‡åœ¨å †ä¸­å‡åŒ€åœ°éšæœºæ”¾ç½®å¯¹è±¡ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æœ€å°çš„æœŸæœ›åˆ†ç¦»é—´éš”ã€‚\n$$\nE[minimum separation] = (M - 1) objects\n$$\nä½¿å¾—æº¢å‡ºå°äºM-1å€å¯¹è±¡å¤§å°æ—¶æ˜¯æ— å®³çš„ã€‚\næœ€åï¼Œé€šè¿‡éšæœºé€‰æ‹©è¦å›æ”¶çš„å·²é‡Šæ”¾å¯¹è±¡ï¼Œæœ€è¿‘é‡Šæ”¾çš„å¯¹è±¡æä¸å¯èƒ½è¢«è¦†ç›–ã€‚\nä¸ºäº†æ£€æµ‹å¯¹å †çš„æœªåˆå§‹åŒ–è¯»ï¼Œæˆ‘ä»¬è¦æ±‚æ— é™å †å’Œæ¯ä¸ªåˆ†é…çš„å¯¹è±¡éƒ½å……æ»¡éšæœºå€¼ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŒæ—¶æ‰§è¡Œè‡³å°‘ä¸¤ä¸ªå…·æœ‰ä¸åŒéšæœºåˆ†é…å™¨çš„å‰¯æœ¬æ¥æ£€æµ‹æœªåˆå§‹åŒ–çš„è¯»å–å¹¶ä¸”æ¯”è¾ƒä»–ä»¬çš„è¾“å‡ºã€‚æœªåˆå§‹åŒ–çš„è¯»å–å°†åœ¨å‰¯æœ¬ä¸­è¿”å›ä¸åŒçš„ç»“æœï¼Œå¦‚æœæ­¤è¯»å–å½±å“è®¡ç®—ï¼Œåˆ™å‰¯æœ¬çš„è¾“å‡ºå°†ä¸åŒã€‚è¿™æ ·DieHardå°±èƒ½å¤Ÿæ£€æµ‹å‡ºæ¥ã€‚\néšæœºå†…å­˜ç®¡ç†å™¨ randomized memory manager éšæœºå†…å­˜ç®¡ç†å™¨ã€‚å…è®¸è®¡ç®—æ£€æµ‹æˆ–é¿å…å†…å­˜é”™è¯¯ç²¾ç¡®çš„æ¦‚ç‡ã€‚å¿«é€Ÿéšæœºå†…å­˜åˆ†é…å™¨ï¼Œå®ƒæ„æˆäº†ç‹¬ç«‹å’Œå¤åˆ¶ç‰ˆæœ¬çš„æ ¸å¿ƒã€‚\nDieHardçš„éšæœºå†…å­˜ç®¡ç†å™¨å°†å¯¹è±¡éšæœºæ”¾ç½®åœ¨ä¸€ä¸ªå †ä¸­ï¼Œå †çš„å¤§å°æ˜¯æ‰€éœ€æœ€å¤§å€¼çš„å‡ å€ã€‚ä¾‹å¦‚ä¸‹å›¾ï¼š\nå¯¹è±¡ä¹‹é—´çš„é—´éš”ä½¿å¾—ç¼“å†²åŒºæº¢å‡ºæœ€ç»ˆå¯èƒ½åªè¦†ç›–ç©ºé—²æ— ç”¨çš„ç©ºé—´\néšæœºåˆ†é…ä¹Ÿä½¿å¾—æ–°é‡Šæ”¾çš„å¯¹è±¡ä¸å¤ªå¯èƒ½å¾ˆå¿«è¢«éšåçš„åˆ†é…è¦†ç›–ï¼Œä»è€Œé¿å…äº†æ‚¬ç©ºæŒ‡é’ˆé”™è¯¯ã€‚\nå®ƒè¿˜é€šè¿‡å°†æ‰€æœ‰å †å…ƒæ•°æ®ä»å †ä¸­åˆ†ç¦»ï¼ˆé¿å…å¤§å¤šæ•°å †å…ƒæ•°æ®è¦†ç›–ï¼‰å’Œå¿½ç•¥é‡Šæ”¾å·²ç»åˆ›å»ºæˆ–æ— æ•ˆå¯¹è±¡çš„å°è¯•æ¥æé«˜åº”ç”¨ç¨‹åºçš„å¥å£®æ€§ã€‚\nå¯¹äºå¤åˆ¶ç‰ˆæœ¬ï¼š\næ¨¡å¼ å•ç‹¬æ¨¡å¼ + å¤åˆ¶æ¨¡å¼\nè€Œç‹¬ç«‹ç‰ˆæœ¬çš„Die Hardæä¾›äº†é˜²æ­¢å†…å­˜é”™è¯¯çš„å®è´¨æ€§ä¿æŠ¤ã€‚å¤åˆ¶çš„ç‰ˆæœ¬æ—¢å¢åŠ äº†ä¿æŠ¤ï¼Œåˆæ£€æµ‹äº†éæ³•è¯»å–å¼•èµ·çš„é”™è¯¯ã€‚ åœ¨å¤åˆ¶æ¨¡å¼ä¸‹ï¼ŒDieHardåŒæ—¶æ‰§è¡ŒåŒä¸€ç¨‹åºçš„å¤šä¸ªå‰¯æœ¬ï¼Œæ¯ä¸ªå‰¯æœ¬éƒ½æœ‰ä¸åŒçš„ç§å­ç»™å„è‡ªçš„éšæœºåˆ†é…å™¨ã€‚\nå¤åˆ¶æ¨¡å¼\nå¯¹ä¸ç¼“å†²åŒºæº¢å‡ºã€‚å› ä¸ºå¤šä¸ªå‰¯æœ¬ä½¿ç”¨ä¸ä¸€æ ·çš„ç§å­ä½œä¸ºéšæœºåˆ†é…ã€‚å› æ­¤ï¼Œç¼“å†²åŒºæº¢å‡ºç­‰é”™è¯¯å¾ˆå¯èƒ½ä¼šè¦†ç›–ä¸åŒå‰¯æœ¬ä¸­çš„ä¸åŒå†…å­˜åŒºåŸŸã€‚\nDieHardæ‹¦æˆªæ¥è‡ªæ‰€æœ‰ä¸åŒå‰¯æœ¬çš„è¾“å‡ºï¼Œå¹¶åœ¨å‘é€ä»»ä½•è¾“å‡ºä¹‹å‰æ¯”è¾ƒæ¯ä¸ªå‰¯æœ¬çš„å†…å®¹ã€‚ é€šè¿‡å¾ˆé«˜çš„æ¦‚ç‡ï¼Œå½“ä»»ä½•ä¸¤ä¸ªç¨‹åºåœ¨å…¶è¾“å‡ºä¸Šè¾¾æˆä¸€è‡´æ—¶ï¼Œå®ƒä»¬æ‰å®‰å…¨åœ°æ‰§è¡Œã€‚\nå¯¹äºæ‚¬æµ®æŒ‡é’ˆã€‚åœ¨ä»»ä½•ä¸€è‡´çš„å‰¯æœ¬ä¸­ï¼Œä»»ä½•ç¼“å†²åŒºæº¢å‡ºéƒ½åªè¦†ç›–æ— ç”¨çš„æ•°æ®ã€‚å‚çš„æŒ‡é’ˆä»æœªè¢«è¦†ç›–ã€‚\nå¯¹äºæœªåˆå§‹åŒ–çš„æ•°æ®ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„è¾“å‡ºä¾èµ–äºæœªåˆå§‹åŒ–çš„æ•°æ®ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å°†åœ¨å‰¯æœ¬ä¸­ä¸ä¸€è‡´ï¼ŒDieHardå°†ä¼šæ£€æµ‹åˆ°å®ƒä»¬ã€‚\n ä½¿ç”¨é¢å¤–çš„å‰¯æœ¬å¯ä»¥è¿›ä¸€æ­¥æé«˜å¯é æ€§ã€‚ è™½ç„¶é¢å¤–çš„å¤åˆ¶è‡ªç„¶ä¼šå¢åŠ å•å¤„ç†å™¨å¹³å°ä¸Šçš„æ‰§è¡Œæ—¶é—´ï¼Œä½†æˆ‘ä»¬è®¤ä¸ºä½¿ç”¨å¤åˆ¶çš„è‡ªç„¶è®¾ç½®æ˜¯åœ¨å…·æœ‰å¤šä¸ªå¤„ç†å™¨çš„ç³»ç»Ÿä¸Šã€‚Die Hardå¯ä»¥ä½¿ç”¨æ›´æ–°å¤„ç†å™¨ä¸Šçš„å¤šä¸ªæ ¸å¿ƒæ¥ä½¿é—ç•™ç¨‹åºæ›´å¯é ã€‚\n ä¼˜ç‚¹å’Œç¼ºç‚¹ ä¼˜ç‚¹  æ€§èƒ½å¥½ã€‚(è®ºæ–‡è¯´) ç”±äºç”¨DieHardæ›¿æ¢å †æ˜¾è‘—æé«˜äº†å¯é æ€§ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒé€‚åˆäºå¹¿æ³›çš„éƒ¨ç½²ï¼Œç‰¹åˆ«æ˜¯åœ¨æé«˜å¯é æ€§å€¼å¾—ç©ºé—´æˆæœ¬çš„åœºæ™¯ä¸­ã€‚  ç¼ºç‚¹  å®‰è£…å¤æ‚ï¼Œå¹¶ä¸”éœ€è¦C++14çš„æ”¯æŒã€‚ å¯ä»¥æŠ¥é”™ä½†æ˜¯ä¸èƒ½æä¾›é”™è¯¯çš„å…·ä½“ä½ç½®ä¿¡æ¯ã€‚ å†…å­˜æ¶ˆè€—å¤§ã€‚ å¤åˆ¶æ¨¡å¼éœ€è¦å¤šå¤„ç†å™¨å¹¶è¡Œã€‚ è¿™ç§éšæœºåˆ†é…ä½¿å¾—è®¡ç®—æœºæ— æ³•æ ¹æ®ç©ºé—´å±€éƒ¨æ€§æ¨æ–­ï¼Œç³»ç»Ÿä¸­çš„TLBå¾€å¾€å¤±æ•ˆã€‚ä¸ºäº†ä¿æŒæ€§èƒ½ï¼ŒDie Hardå †çš„ä½¿ç”¨ä¸­éƒ¨åˆ†åº”è¯¥é€‚åˆç‰©ç†RAMã€‚  å‚è€ƒï¼š\n https://securitygossip.com/blog/2018/09/29/guarder-a-tunable-secure-allocator/ https://firmianay.gitbooks.io/ctf-all-in-one/content/doc/8.46_freeguard.html  ","description":"ä¸€ä¸ªåŸºäºæ¦‚ç‡å†…å­˜å®‰å…¨çš„è¿è¡Œæ—¶ç³»ç»Ÿã€‚","id":46,"section":"posts","tags":["MLK"],"title":"DieHard","uri":"https://hugo.jiahongw.com/zh/posts/mlk/diehard/"},{"content":"Valgrind Valgrindå‘è¡Œç‰ˆç›®å‰åŒ…æ‹¬ä¸ƒä¸ªç”Ÿäº§è´¨é‡å·¥å…·ï¼šä¸€ä¸ªå†…å­˜é”™è¯¯æ£€æµ‹å™¨ï¼Œä¸¤ä¸ªçº¿ç¨‹é”™è¯¯æ£€æµ‹å™¨ï¼Œä¸€ä¸ªç¼“å­˜å’Œåˆ†æ”¯é¢„æµ‹æ¢æŸ¥å™¨ï¼Œä¸€ä¸ªç”Ÿæˆè°ƒç”¨å›¾çš„ç¼“å­˜å’Œåˆ†æ”¯é¢„æµ‹æ¢æŸ¥å™¨ä»¥åŠä¸¤ä¸ªä¸åŒçš„å †æ¢æŸ¥å™¨ã€‚å®ƒè¿˜åŒ…æ‹¬ä¸€ä¸ªå®éªŒæ€§çš„SimPointåŸºæœ¬å—çŸ¢é‡ç”Ÿæˆå™¨ã€‚\n åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬æœ‰æ—¶éœ€è¦è¿½è¸ªç¨‹åºæ‰§è¡Œã€è¯Šæ–­é”™è¯¯ã€è¡¡é‡æ€§èƒ½ç­‰éœ€æ±‚ã€‚å¦‚æœæœ‰æºä»£ç çš„è¯å¯ä»¥æ·»åŠ ç›¸åº”ä»£ç ï¼Œæ²¡æœ‰æºä»£ç æ—¶è¿™ä¸ªæ–¹æ³•å°±è¡Œä¸é€šäº†ã€‚å‰è€…å¯ä»¥å¯¹æºä»£ç åˆ†æï¼Œåè€…åªèƒ½åˆ†æäºŒè¿›åˆ¶äº†ã€‚æˆ‘çš„ç†è§£æ˜¯ï¼Œdynamic Binary Instrumentation (DBI)å¼ºè°ƒå¯¹äºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶çš„è¿½è¸ªä¸ä¿¡æ¯æ”¶é›†ï¼Œdynamic Binary Analysis (DBA)å¼ºè°ƒå¯¹æ”¶é›†ä¿¡æ¯çš„åˆ†æï¼Œvalgrindæ˜¯ä¸€ä¸ªDBIæ¡†æ¶ï¼Œä½¿ç”¨å®ƒå¯ä»¥å¾ˆæ–¹ä¾¿æ„å»ºä¸€ä¸ªDBAå·¥å…·ã€‚\n Valgrindä½œè€…è®¤ä¸ºå½“æ—¶çš„DBIæ¡†æ¶éƒ½æŠŠæ³¨æ„åŠ›æ”¾åœ¨äº†æ€§èƒ½æ£€æµ‹ä¸Šï¼Œå¯¹ç¨‹åºçš„è´¨é‡(åŸæ–‡capabilities)å¹¶æ²¡æœ‰å¤ªæ³¨æ„ã€‚æ‰€ä»¥è®¾è®¡äº†ä¸€ä¸ªæ–°çš„DBIæ¡†æ¶ï¼Œç›®æ ‡æ˜¯å¯ä»¥ä½¿ç”¨å®ƒå¼€å‘é‡å‹DBAå·¥å…·ã€‚\nåŸºæœ¬ä»‹ç» å®˜ç½‘ï¼š https://valgrind.org/\næ–‡æ¡£ï¼š https://valgrind.org/docs/manual/index.html\næºç ï¼š https://github.com/groleo/mpatrolhttps://valgrind.org/downloads/repository.html\næ”¯æŒ å®ƒå¯åœ¨ä»¥ä¸‹å¹³å°ä¸Šè¿è¡Œï¼š\nX86 / Linuxï¼ŒAMD64 / Linuxï¼ŒARM / Linuxï¼ŒARM64 / Linuxï¼ŒPPC32 / Linuxï¼ŒPPC64 / Linuxï¼ŒPPC64LE / Linuxï¼ŒS390X / Linuxï¼ŒMIPS32 / Linuxï¼ŒMIPS64 / Linuxï¼ŒX86 / Solaris ï¼ŒAMD64 / Solarisï¼ŒARM / Androidï¼ˆ2.3.xå’Œæ›´é«˜ç‰ˆæœ¬ï¼‰ï¼ŒARM64 / Androidï¼ŒX86 / Androidï¼ˆ4.0å’Œæ›´é«˜ç‰ˆæœ¬ï¼‰ï¼ŒMIPS32 / Androidï¼ŒX86 / Darwinå’ŒAMD64 / Darwinï¼ˆMac OS X 10.12ï¼‰ã€‚\nå®‰è£…   è§£å‹å®‰è£…åŒ…\n1 2  tar -jxvf valgrind-3.15.0.tar.bz2 cd valgrind-3.15.0/     åˆ›å»ºMakefile\n1  ./configure     å®‰è£…\n  1 2 3  make make install valgrind --version   ä½¿ç”¨ ç¼–è¯‘è¯´æ˜  æœ€å¥½ä½¿ç”¨debugç‰ˆæœ¬ï¼ˆgcc -gï¼‰ï¼Œè¿™æ ·æ‰“å°çš„ä¿¡æ¯ä¸­ä¼šå°†é”™è¯¯å’Œåˆ†æçš„ä¿¡æ¯æŒ‡å®šå‡ºç›¸å…³çš„ä»£ç è¡Œï¼› å¦‚æœæ˜¯C++æœ€å¥½å°†å†…è”å‡½æ•°ä»¥æ™®é€šå‡½æ•°å¯¹å¾…ï¼ˆgcc -fno-inlineï¼‰ï¼Œè¿™æ ·æ›´å®¹æ˜“çœ‹åˆ°å‡½æ•°è°ƒç”¨é“¾ï¼Œè¿™æœ‰åŠ©äºå‡å°‘åœ¨å¤§å‹C ++åº”ç”¨ç¨‹åºä¸­å¯¼èˆªæ—¶çš„æ··æ·†ï¼› ä¸è¦ä½¿ç”¨ä¼˜åŒ–ï¼ˆgcc -O2æˆ–gcc-O1ç­‰ï¼‰ï¼Œè¿™ä¼šå¯¼è‡´Memchecké”™è¯¯åœ°æŠ¥å‘Šæœªåˆå§‹åŒ–çš„å€¼é”™è¯¯æˆ–ä¸¢å¤±æœªåˆå§‹åŒ–çš„å€¼é”™è¯¯ï¼› æœ€å¥½ç¼–è¯‘æ—¶èƒ½æ˜¾ç¤ºæ‰€æœ‰è­¦å‘Šï¼ˆgcc -Wallï¼‰  é”™è¯¯æŠ¥å‘Š å½“é”™è¯¯æ£€æŸ¥å·¥å…·æ£€æµ‹åˆ°ç¨‹åºä¸­å‘ç”Ÿäº†é”™è¯¯æ—¶ï¼Œå°±ä¼šå‘æ³¨é‡Šä¸­å†™å…¥ä¸€æ¡é”™è¯¯æ¶ˆæ¯ã€‚ä»¥ä¸‹æ˜¯æ¥è‡ªMemcheckçš„ä¸€ä¸ªä¾‹å­ï¼š\n==25832== Invalid read of size 4 ==25832== at 0x8048724: BandMatrix::ReSize(int, int, int) (bogon.cpp:45) ==25832== by 0x80487AF: main (bogon.cpp:66) ==25832== Address 0xBFFFF74C is not stack'd, malloc'd or free'd è¿™ä¸ªæ¶ˆæ¯è¯´ï¼Œç¨‹åºéæ³•è¯»å–äº†åœ°å€0xBFFFF74Cçš„4å­—èŠ‚ï¼Œæ®Memcheckæ‰€çŸ¥ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å †æ ˆåœ°å€ï¼Œä¹Ÿä¸å¯¹åº”äºä»»ä½•å½“å‰å †å—æˆ–æœ€è¿‘é‡Šæ”¾çš„å †å—ã€‚å‘ç”Ÿåœ¨bogon.cppçš„ç¬¬45è¡Œã€‚ä»åŒä¸€æ–‡ä»¶çš„ç¬¬66è¡Œè°ƒç”¨ï¼Œç­‰ç­‰ã€‚å¯¹äºä¸å·²è¯†åˆ«çš„(å½“å‰æˆ–å·²é‡Šæ”¾çš„)å †å—ç›¸å…³çš„é”™è¯¯ï¼Œä¾‹å¦‚è¯»å–å·²é‡Šæ”¾çš„å†…å­˜ï¼ŒValgrindä¸ä»…ä¼šæŠ¥å‘Šé”™è¯¯å‘ç”Ÿçš„ä½ç½®ï¼Œè¿˜ä¼šæŠ¥å‘Šåˆ†é…/é‡Šæ”¾å…³è”å †å—çš„ä½ç½®ã€‚\nå‘½ä»¤è¡Œé€‰é¡¹ æœ€ç®€å•çš„é€‰é¡¹ï¼š\n--tool=\u0026lt;toolname\u0026gt; [default: memcheck] è¿è¡Œåä¸ºtoolnameçš„Valgrindå·¥å…·ï¼Œå¦‚memcheck, cachegrind, callgrind, helgrind, drd, massif, dhat, lackey, none, expi -bbvç­‰\nåŸºæœ¬ä½¿ç”¨æ–¹æ³• å‡å¦‚ä½ çš„ç¨‹åºåŸæ¥æ˜¯è¿™æ ·æ‰§è¡Œçš„ï¼šmyprog arg1 arg2\né‚£ä¹ˆä½¿ç”¨valgrindå¯ä»¥åœ¨å‰é¢æ·»åŠ  valgrind \u0026ndash;leak-check=yes å³å¯ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š\nvalgrind --leak-check=yes myprog arg1 arg2 å¦‚æœæˆ‘ä»¬æƒ³ç”¨valgrindçš„å†…å­˜æ£€æµ‹å·¥å…·ï¼Œæˆ‘ä»¬å°±è¦ç”¨å¦‚ä¸‹æ–¹æ³•è°ƒç”¨ï¼š\n#valgrind --leak-check=full --show-reachable=yes --trace-children= yes ./a.out (2\u0026gt;logfileåŠ ä¸Šä¼šå¥½äº›ï¼Œç¨‹åºåœ¨æ‰§è¡ŒæœŸé—´stderrä¼šæœ‰ä¸€äº›è¾“å‡ºã€‚æç¤ºæ¯”è¾ƒå¤š) è¿è¡Œvalgrind -hå¯ä»¥æŸ¥çœ‹è¯¦ç»†ä½¿ç”¨æ–¹æ³•ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š\nvalgrind [valgrind -hä¸­çš„é€‰é¡¹] å¾…æµ‹ç¨‹åº [å¾…æµ‹ç¨‹åºçš„å‘½ä»¤è¡Œå‚æ•°åˆ—è¡¨] æœ€é‡è¦çš„é€‰é¡¹æ˜¯â€“toolå†³å®šè¿è¡Œå“ªç§Valgrindå·¥å…·ã€‚\n--tool=\u0026lt;toolname\u0026gt; [default: memcheck]ï¼šæœ€å¸¸ç”¨çš„é€‰é¡¹ã€‚è¿è¡Œvalgrindä¸­åä¸ºtoolnameçš„å·¥å…·ã€‚å¦‚æœçœç•¥å·¥å…·åï¼Œé»˜è®¤è¿è¡Œmemcheckã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨å†…å­˜æ£€æŸ¥å·¥å…·Memcheck è¿è¡Œâ€œls -lâ€å‘½ä»¤ ï¼Œæ‰§è¡Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š\nvalgrind --tool = memcheck ls -l Memcheckæ˜¯é»˜è®¤è®¾ç½®ï¼Œå› æ­¤å¦‚æœè¦ä½¿ç”¨å®ƒï¼Œåˆ™å¯ä»¥çœç•¥è¯¥â€“toolé€‰é¡¹ï¼Œå¦‚ï¼š\nvalgrind ls -l https://blog.csdn.net/justheretobe/article/details/52986461\nåŸç† åŸºæœ¬æ¶æ„ Valgrind çš„æ ¸å¿ƒèŠ±è´¹å¤§éƒ¨åˆ†çš„æ—¶é—´åœ¨åˆ¶é€ ã€å¯»æ‰¾ã€æ‰§è¡Œ machine code å’Œ VEX IR çš„è½¬æ¢ï¼Œ è€Œ client program åŸæœ¬çš„ machine code éƒ½ä¸ä¼šè·‘åˆ°ã€‚å¯ä»¥çœ‹åˆ° Valgrind çš„å¤æ‚ä¾†è‡ªè¦æŠŠ client å’Œ tool æ”¾åœ¨åŒä¸€å€‹ processï¼Œ éœ€è¦ç”¨åˆ†äº«çš„èµ„æº (ä¾‹å¦‚ registers å’Œ memory)ï¼Œ è€Œä¸” Valgrind è¦å°å¿ƒåœ°ç¡®ä¿åœ¨ system callã€signalsã€threads å‚ä¸çš„ç‹€æ³ä¸‹ä¸æœƒå° client å¤±å»æŒæ§ã€‚\næ­£å¸¸å¤„ç†çš„ç¨‹åºæœ‰ï¼š\n normal executable code dynamically linked libraries shared libraries dynamically generated code  åªæœ‰ self-modifying code æœƒæœ‰å•é¡Œï¼Œ è€ŒåŸ·è¡Œéç¨‹ä¸­åªæœ‰ system calls è£¡é¢çš„ç‹€æ³æ˜¯ Valgrind ä¸èƒ½æŒæ§çš„ï¼Œ ä½†æ˜¯ system call çš„ side-effects é‚„æ˜¯å¯ä»¥é–“æ¥è§€å¯Ÿåˆ°ã€‚\n +--------------------+ +-------------------------+ +--------------+ | libVEX | | IR instrumentation tool | | | | | | | +--------------+ | | | | | | | | | | +--------------+ | | | | | | | | | | x86/Linux +--------------+ | +--------+ | | | AMD64/Linux | machine code | ------------\u0026gt; | VEX IR | --------\u0026gt;| | ARM/Linux +--------------+ | +--------+ | | | x86/MacOSX | | | | | | AMD64/MacOSX +--------------+ | -----------------| | .... | | | | | | | +--------------+ | | | | | | | +---------|----------+ +-------------------------+ +--------------+ | v +--------------+ | machine code | +--------------+ Valgrind Coreä¼šåæ±‡ç¼–åº”ç”¨ç¨‹åºä»£ç ï¼Œå¹¶å°†ä»£ç ç‰‡æ®µä¼ é€’ç»™å·¥å…·æ’ä»¶ä»¥è¿›è¡Œæ£€æµ‹ã€‚å·¥å…·æ’ä»¶ä¼šæ·»åŠ åˆ†æä»£ç å¹¶å°†å…¶é‡æ–°ç»„åˆã€‚å› æ­¤ï¼ŒValgrindæä¾›äº†åœ¨Valgrindæ¡†æ¶ä¹‹ä¸Šç¼–å†™æˆ‘ä»¬è‡ªå·±çš„å·¥å…·çš„çµæ´»æ€§ã€‚ Valgrindä½¿ç”¨å½±å­å¯„å­˜å™¨å’Œå½±å­å­˜å‚¨å™¨æ¥æ£€æµ‹è¯»/å†™æŒ‡ä»¤ï¼Œè¯»/å†™ç³»ç»Ÿè°ƒç”¨ï¼Œå †æ ˆå’Œå †åˆ†é…ã€‚\nvalgrindæä¾›äº†å›´ç»•ç³»ç»Ÿè°ƒç”¨çš„åŒ…è£…ï¼Œå¹¶ä¸ºæ¯ä¸ªç³»ç»Ÿè°ƒç”¨çš„å‰åå›è°ƒæ³¨å†Œï¼Œä»¥è·Ÿè¸ªä½œä¸ºç³»ç»Ÿè°ƒç”¨ä¸€éƒ¨åˆ†è®¿é—®çš„å†…å­˜ã€‚å› æ­¤ï¼ŒValgrindæ˜¯Linuxæ“ä½œç³»ç»Ÿå’Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä¹‹é—´çš„OSæŠ½è±¡å±‚ã€‚\nè¯¥å›¾è¯´æ˜äº†Valgrindçš„8ä¸ªé˜¶æ®µï¼š\né˜´å½±å€¼ Valgrind æŠŠé‡ç‚¹æ”¾åœ¨ shadow values è¿™æ¦‚å¿µä¸Šï¼Œ shadow values æ˜¯å¾ˆå¼ºå¤§ä½†ç›¸å…³çš„ç ”ç©¶è¾ƒå°‘ã€è¾ƒéš¾å®ä½œçš„ DBA æŠ€æœ¯ï¼Œ åœ¨è¿™æ¦‚å¿µä¸‹éœ€è¦å¯¹æ‰€æœ‰çš„ register å’Œ memory åš shadow (è‡ªå·±ç»´æŠ¤ä¸€ä»½)ï¼Œ ä¹Ÿå› ä¸ºè¿™ feature è®© Valgrind åšå‡ºæ¥çš„ lightweight å·¥å…·è·‘çš„ç›¸å¯¹æ…¢ï¼Œä½†æ˜¯ Valgrind å¯ä»¥åšå‡ºæ›´å¤šæ›´æœ‰è¶£ã€æ›´é‡é‡çº§çš„å·¥å…·ï¼Œ è¿™æ˜¯å…¶ä»– frameworks å¾ˆéš¾åšåˆ°çš„ (ä¾‹å¦‚ Pin æˆ– DynamoRIO)ã€‚\nshadow value tools ä¼šç»´æŠ¤ä¸€ä»½ç¨‹å¼çš„çŠ¶æ€ï¼Œ æŠŠåŸæœ¬çš„ç¨‹å¼çŠ¶æ€ç§°ä¸º Sï¼Œ é‚£å°±ä¼šå­˜ä¸€ä»½ Sâ€™ é‡Œé¢åŒ…å« S çš„æ‰€æœ‰å€¼ (ä¾‹å¦‚ register å’Œ user-mode address)ï¼Œ è€Œ shadow values æœ‰ä¹ç§éœ€æ±‚è¦æ»¡è¶³ï¼Œ ä¹ç§éœ€æ±‚å¯ä»¥ä¾ç…§ç‰¹æ€§åˆ†æˆå››ç±» (Shadow Stateã€è¯»å†™æ“ä½œã€Allocation/Deallocationã€å¢åŠ è¾…åŠ©èµ„è®¯)ï¼š\n é˜´å½±å€¼ç®€å•æ¥è¯´å°±æ˜¯ï¼šåœ¨è½¯ä»¶ä¸­æˆ–è€…å¯„å­˜å™¨ä¸­ç”¨å¦å¤–ä¸€ä¸ªæ˜ å°„å€¼æ¥è¯´æ˜ä¸€äº›å†…å®¹\n é˜´å½±å€¼çš„å„ä¸ªå·¥å…·çš„åº”ç”¨\n memcheckä½¿ç”¨é˜´å½±å€¼è·Ÿè¸ªå“ªä¸ªbitçš„å€¼æ˜¯æœªå®šä¹‰çš„ã€‚ TaintCheckè·Ÿè¸ªå“ªäº›å­—èŠ‚è¢«æ±¡æŸ“(ä¸å—ä¿¡ä»»çš„æºï¼Œæˆ–æ¥è‡ªå—æ±¡æŸ“çš„å€¼). McCamant and Ernstâ€™s secret-tracking toolè·Ÿè¸ªæ¯ä¸€ä¸ªç§˜å¯†bitçš„å€¼ï¼Œå¹¶ä¸”ç¡®å®šå…¬å…±çš„è¾“å‡ºä¸­æš´éœ²äº†å¤šå°‘ç§˜å¯†çš„ä¿¡æ¯ã€‚ Hobbesè·Ÿè¸ªæ¯ä¸€ä¸ªå€¼å¾—ç±»å‹ï¼Œå› æ­¤å¯ä»¥æ£€æµ‹åç»­æ“ä½œä¸é€‚åˆè¯¥ç±»å‹çš„å€¼ã€‚ DynCompBç±»ä¼¼åœ°ï¼Œä¸ºç¨‹åºç†è§£å’Œä¸å˜æ£€æµ‹ç›®çš„ç¡®å®šå­—èŠ‚å€¼çš„æŠ½è±¡ç±»å‹ã€‚ Annelidè·Ÿè¸ªæ˜¯æ•°ç»„æŒ‡é’ˆçš„wordï¼Œå¯ä»¥æ£€æµ‹è¶Šç•Œé”™è¯¯ã€‚ Reduxåˆ›å»ºäº†ä¸€ä¸ªåŠ¨æ€æ•°æ®æµå›¾ï¼Œæ˜¯ç¨‹åºçš„æ•´ä¸ªè®¡ç®—çš„å¯è§†åŒ–ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹åˆ°æ‰€æœ‰æœ‰åŠ©äºæ¯ä¸ªå€¼åˆ›å»ºçš„å…ˆå‰æ“ä½œã€‚  å¯ä»¥æ˜¯ï¼š\n æ¯bitä¸€ä¸ªshadow bit æ¯byteä¸€ä¸ªshadow byte æ¯wordä¸€ä¸ªshadow word   æè¿°é˜´å½±å€¼å·¥å…· å¦‚ä½•åœ¨DBIæ¡†æ¶ä¸­æ”¯æŒé˜´å½±å€¼ DBIæ¡†æ¶å¹¶ä¸å®Œå…¨ç›¸åŒ  ä¸ºäº†å®ç°shadow valueséœ€è¦æ¡†æ¶å®ç°ä»¥ä¸‹4ä¸ªéƒ¨åˆ†ï¼š\n Shadow State è¯»å†™æ“ä½œ åˆ†é…å’Œé‡Šæ”¾æ“ä½œ é€æ˜æ‰§è¡Œ+é¢å¤–çš„è¾“å‡º  9ä¸ªåŠŸèƒ½\n instrument read/write instructions instrument read/write system calls Allocation and deallocation operations instrument start-up allocations instrument system call (de)allocations instrument stack (de)allocations instrument heap (de)allocations Transparent execution, but with extra output extra output  å…·ä½“æ¥è¯´å°±æ˜¯ï¼š\n  Shadow State\n R1ï¼šæä¾›é˜´å½±å¯„å­˜å™¨(ä¾‹å¦‚ integerã€FPã€SIMD)ã€‚ R2ï¼šæä¾›é˜´å½±å†…å­˜(å¹¶ä¸”éœ€è¦åœ¨ multithread ä¸‹å¯ä»¥å®‰å…¨åœ°å­˜å– shadow memory)ã€‚    è¯»å†™æ“ä½œ\n  R3ï¼šæ’æ¡©è¯»å†™æŒ‡ä»¤ã€‚\n éœ€è¦çŸ¥é“æ¯å€‹ instruction å­˜å–äº†å“ªäº› memory å’Œ registers æœ€å¥½èƒ½åšåˆ°è·¨å¹³å° (è·¨ ISA)    R4ï¼šæ’æ¡©ç³»ç»Ÿè¯»å†™è°ƒç”¨ã€‚\næ‰€æœ‰çš„ system call éƒ½ä¼šå»å­˜å– register æˆ– memoryï¼Œè¿˜å¯èƒ½ä» register æˆ– stack è¯»å‚æ•°ï¼Œæœ€åå†™å› register æˆ– memoryï¼Œè€Œä¸”è¿˜è¦æ³¨æ„è®¸å¤š system call ä¼šå­˜å– user-mode çš„ memory (pointer)\n    åˆ†é…å’Œé‡Šæ”¾æ“ä½œ\n R5ï¼šæ’æ¡©å¯åŠ¨æ—¶çš„åˆ†é…æ“ä½œã€‚  åœ¨ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰ register éƒ½æœƒè¢« â€œallocatedâ€ï¼Œå› ç‚ºæ˜¯ statically allocated memory locationsï¼Œæ‰€ä»¥ shadow value tool å¿…é ˆä¹Ÿé€™äº›åšå¥½ (create suitable ä¼šhadow values) å¯¹äºæ­¤æ—¶è¿˜æ²¡ allocated çš„ä¹Ÿè¦å¤„ç†ï¼Œå¯èƒ½åœ¨ allocated ä¹‹å‰å‘ç”Ÿä¸å½“çš„å­˜å–   R6ï¼šæ’æ¡©ç³»ç»Ÿè°ƒç”¨çš„åˆ†é…å’Œé‡Šæ”¾ã€‚  ä¸€äº› system call ä¼š allocate memory (e.g. brk, mmap)ï¼Œä¸€äº›ä¼š deallocate memory (e.g. munmap) mremap æœƒè®©memory è¢« copyï¼Œshadow memory ä¹Ÿè¦ copy å¥½   R7ï¼šæ’æ¡©æ ˆçš„åˆ†é…å’Œé‡Šæ”¾ã€‚  æ›´æ–° stack pointer è¿™éƒ¨ä»½ä¼šæ¯”è¾ƒè€—æ—¶ï¼Œå› ä¸º stack pointer æ—¶å¸¸å˜åŠ¨ï¼Œè€Œä¸”æœ‰äº›ç¨‹å¼ä¼šåœ¨å¤šä¸ª stack ä¹‹é—´åˆ‡æ¢ï¼Œshadow value tool ä¼šéœ€è¦æŠŠè¿™äº› stack allocations æˆ– deallocations åŒºåˆ†å‡ºæ¥ï¼Œè¿™å¯¹äº binary level æ¥è¯´ä¸å®¹æ˜“   R8ï¼šæ’æ¡©å †çš„åˆ†é…å’Œé‡Šæ”¾.  å¤§éƒ¨åˆ†çš„ç¨‹å¼ä¼šåˆ©ç”¨æ¥è‡ª library çš„ heap allocatorï¼Œheap allocator ä¼šæŠŠç”¨ system call (brkã€mmap) å–å¾—çš„ large chuncks ä¸­çš„ä¸€å— heap blocks ä¼ å›å»ç»™ clientï¼Œæ¯æ®µ heap block éƒ½æœ‰ book-keeping data (ä¾‹å¦‚ block size)ï¼Œè¿™äº›æ˜¯ client program ä¸åº”è¯¥å­˜å–çš„ (è¯»å¯èƒ½è¿˜å®‰å…¨ï¼Œå†™çš„è¯å¯èƒ½ä¼š crash allocator)ï¼Œæ‰€ä»¥æœ‰ kernel-level addressability ä¹‹ä¸Šç›–äº†ä¸€å±‚ library-level addressability çš„æ¦‚å¿µ å¿½ç•¥ large chuncks çš„ kernel-level allocations ç›´åˆ° allocator æŠŠ allocated çš„ bytes è½¬äº¤ç»™ client ä¹‹å‰éƒ½ä¸æŠŠ memory å½“ä½œ active realloc ä¹Ÿè¦åƒ mremap ä¸€æ ·è¢«å¤„ç†      é€æ˜æ‰§è¡Œ+é¢å¤–çš„è¾“å‡º\n R9ï¼šé¢å¤–çš„è¾“å‡ºã€‚  ä¸å½±å“æ‰§è¡Œï¼Œäº§ç”Ÿæœ‰å¸®åŠ©çš„ output å¦å¤–å¼€ä¸ªåœ°æ–¹ä¾† outputï¼Œä¾‹å¦‚æ²’åœ¨ç”¨çš„ stderr æˆ– file      æ ¸å¿ƒæ€æƒ³å°±æ˜¯è¦æŠŠå¯„å­˜å™¨å’Œå†…å­˜ä¸­çš„ä¸œè¥¿è‡ªå·±ç»´æŠ¤ä¸€ä»½ï¼Œå¹¶ä¸”åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½å¯ä»¥å®‰å…¨æ­£ç¡®åœ°ä½¿ç”¨ï¼ŒåŒæ—¶è®°å½•ç¨‹åºçš„æ‰€æœ‰æ“ä½œï¼Œåœ¨ä¸å½±å“ç¨‹åºæ‰§è¡Œç»“æœå‰æä¸‹ï¼Œè¾“å‡ºæœ‰ç”¨çš„ä¿¡æ¯ã€‚ä½¿ç”¨shadow valuesæŠ€æœ¯çš„DBIæ¡†æ¶éƒ½ä½¿ç”¨ä¸åŒæ–¹å¼å®ç°äº†ä¸Šè¿°å…¨éƒ¨åŠŸèƒ½æˆ–éƒ¨åˆ†åŠŸèƒ½ã€‚\n é˜´å½±çŠ¶æ€ï¼šä¸€ä¸ªé˜´å½±çŠ¶æ€Sâ€™åŒ…æ‹¬æ¯ä¸€ä¸ªå€¼å¯¹åº”çš„é˜´å½±å€¼Sã€‚\n é˜´å½±å€¼çš„æ”¯æŒ\n  é˜´å½±å¯„å­˜å™¨æ˜¯ä¸€æµçš„å®ä½“ï¼š\n åœ¨çº¿ç¨‹çŠ¶æ€ä¸‹ä¸ºå®ƒä»¬æä¾›ç©ºé—´ å®ƒä»¬å¯ä»¥åƒæ¥å®¿ä¸»å¯„å­˜å™¨ä¸€æ ·å®¹æ˜“åœ°è®¿é—® ä»–ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼æ“çºµå’Œæ“ä½œ    å…¶æ¬¡ï¼ŒIRæä¾›äº†ä¸å—é™åˆ¶çš„ä¸´æ—¶èµ„æºï¼Œå¯ä»¥åœ¨å…¶ä¸­æ“çºµæ¥å®¾å¯„å­˜å™¨ï¼Œå½±å­å¯„å­˜å™¨å’Œä¸­é—´å€¼ã€‚è¿™å¯¹äºæ˜“ç”¨æ€§éå¸¸é‡è¦ï¼Œå› ä¸º\nå½±å­æ“ä½œä¼šå¼•å…¥è®¸å¤šé¢å¤–çš„ä¸­é—´å€¼ã€‚\n  ç¬¬ä¸‰ï¼ŒIRçš„RISC-nesså…¬å¼€äº†æ‰€æœ‰éšå¼ä¸­é—´å€¼ï¼Œä¾‹å¦‚ç”±å¤æ‚å¯»å€æ¨¡å¼è®¡ç®—çš„ä¸­é—´å€¼ï¼Œè¿™å¯ä»¥ä½¿æµ‹è¯•å˜å¾—æ›´å®¹æ˜“ï¼Œç‰¹åˆ«æ˜¯åœ¨åƒx86è¿™æ ·çš„CISCä½“ç³»ç»“æ„ä¸Š\n  ç¬¬å››ï¼Œæ‰€æœ‰ä»£ç ä¸€è§†åŒä»ã€‚ é˜´å½±æ“ä½œå……åˆ†é€‚åˆValgrindçš„åä»ªå™¨IRä¼˜åŒ–å™¨å’ŒæŒ‡ä»¤é€‰æ‹©å™¨ã€‚\n   Valgrindä¸æä¾›é˜´å½±å†…å­˜çš„å…¬å¼€æ”¯æŒï¼Œä¾‹å¦‚å†…ç½®çš„æ•°æ®ç»“æ„ï¼Œé˜´å½±å†…å­˜ä»å·¥å…·åˆ°å·¥å…·çš„å˜åŒ–è¶³å¤Ÿå¤§ã€‚\n äº‹ä»¶ç³»ç»Ÿ\nValgrindä¸ºæ¯ä¸ªç³»ç»Ÿè°ƒç”¨æä¾›ä¸€ä¸ªåŒ…è£…å™¨ï¼Œå®ƒæ ¹æ®éœ€è¦è°ƒç”¨è¿™äº›å›è°ƒã€‚ æ¯ä¸ªç³»ç»Ÿè°ƒç”¨éƒ½æœ‰ä¸åŒçš„å‚æ•°ï¼Œå› æ­¤æœ‰ä¸åŒçš„åŒ…è£…å™¨ã€‚\nå¯¹äºæ•°æ®çš„å¤„ç† å¦‚ä½•çŸ¥é“é‚£äº›åœ°å€æ˜¯åˆæ³•çš„ï¼ˆå†…å­˜å·²åˆ†é…ï¼‰ï¼Ÿ\nç»´æŠ¤ä¸€å¼ åˆæ³•åœ°å€è¡¨ï¼ˆValid-address (A) bitsï¼‰ï¼Œå½“å‰æ‰€æœ‰å¯ä»¥åˆæ³•è¯»å†™ï¼ˆå·²åˆ†é…ï¼‰çš„åœ°å€åœ¨å…¶ä¸­æœ‰å¯¹åº”çš„è¡¨é¡¹ã€‚è¯¥è¡¨é€šè¿‡ä»¥ä¸‹æªæ–½ç»´æŠ¤\nå…¨å±€æ•°æ®(data, bss section)--åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™æ ‡è®°ä¸ºåˆæ³•åœ°å€ å±€éƒ¨å˜é‡--ç›‘æ§sp(stack pointer)çš„å˜åŒ–ï¼ŒåŠ¨æ€ç»´æŠ¤ åŠ¨æ€åˆ†é…çš„å†…å­˜--æˆªè· åˆ†é…/é‡Šæ”¾ å†…å­˜çš„è°ƒç”¨ ï¼šmalloc, calloc, realloc, valloc, memalign, free, new, new[], delete and delete[] ç³»ç»Ÿè°ƒç”¨--æˆªè·mmapæ˜ å°„çš„åœ°å€ å…¶ä»–--å¯ä»¥æ˜¾ç¤ºçŸ¥ä¼šmemcheckæŸåœ°å­—æ®µæ˜¯åˆæ³•çš„ å½“è¦è¯»å†™å†…å­˜ä¸­çš„æŸä¸ªå­—èŠ‚æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥è¿™ä¸ªå­—èŠ‚å¯¹åº”çš„A bitã€‚å¦‚æœè¯¥A bitæ˜¾ç¤ºè¯¥ä½ç½®æ˜¯æ— æ•ˆä½ç½®ï¼Œmemcheckåˆ™ä¼šæŠ¥å‘Šè¯»å†™é”™è¯¯\nå¦‚ä½•çŸ¥é“æŸå†…å­˜æ˜¯å¦å·²ç»è¢«èµ‹å€¼(åˆå§‹åŒ–)ï¼Ÿ\nç»´æŠ¤ä¸€å¼ åˆæ³•å€¼è¡¨ï¼ˆValid-value (V) bitsï¼‰ï¼ŒæŒ‡ç¤ºå¯¹åº”çš„bitæ˜¯å¦å·²ç»è¢«èµ‹å€¼ã€‚å› ä¸ºè™šæ‹ŸCPUå¯ä»¥æ•è·æ‰€æœ‰å¯¹å†…å­˜çš„å†™æŒ‡ä»¤ï¼Œæ‰€ä»¥è¿™å¼ è¡¨å¾ˆå®¹æ˜“ç»´æŠ¤ã€‚\nä¸€æ—¦å¯„å­˜å™¨ä¸­çš„å€¼ï¼Œè¢«ç”¨æ¥äº§ç”Ÿå†…å­˜åœ°å€ï¼Œæˆ–è€…è¯¥å€¼èƒ½å¤Ÿå½±å“ç¨‹åºè¾“å‡ºï¼Œåˆ™memcheckä¼šæ£€æŸ¥å¯¹åº”çš„V bitsï¼Œå¦‚æœè¯¥å€¼å°šæœªåˆå§‹åŒ–ï¼Œåˆ™ä¼šæŠ¥å‘Šä½¿ç”¨æœªåˆå§‹åŒ–å†…å­˜é”™è¯¯ã€‚\nå›¾è§£\nç»„ä»¶ valgrindç»“æ„ä¸Šåˆ†ä¸ºcoreå’Œtoolï¼Œä¸åŒçš„toolå…·æœ‰ä¸åŒçš„åŠŸèƒ½ã€‚æ¯”è¾ƒç‰¹åˆ«çš„æ˜¯ï¼Œvalgrind tooléƒ½åŒ…å«coreçš„é™æ€é“¾æ¥ï¼Œè™½ç„¶æœ‰ç‚¹æµªè´¹ç©ºé—´ï¼Œä½†å¯ä»¥ç®€åŒ–æŸäº›äº‹æƒ…ã€‚å½“æˆ‘ä»¬åœ¨è°ƒç”¨valgrindæ—¶ï¼Œå®é™…ä¸Šå¯åŠ¨çš„åªæ˜¯ä¸€ä¸ªè§£æå‘½ä»¤å‚æ•°çš„å¯åŠ¨å™¨ï¼Œç”±è¿™ä¸ªå¯åŠ¨å™¨å¯åŠ¨å…·ä½“çš„toolã€‚\nä¸ºäº†å®ç°ä¸Šè¿°åŠŸèƒ½ï¼Œvalgrindä¼šåˆ©ç”¨dynamic binary re-compilationæŠŠæµ‹è¯•ç¨‹åºï¼ˆclientç¨‹åºï¼‰çš„æœºå™¨ç è§£æåˆ°VEXä¸­é—´è¯­è¨€ã€‚VEX IRæ˜¯valgrindå¼€å‘è€…ä¸“é—¨è®¾è®¡ç»™DBIä½¿ç”¨çš„ä¸­é—´è¯­è¨€ï¼Œæ˜¯ä¸€ç§RISC likeçš„è¯­è¨€ã€‚ç›®å‰VEX IRä»valgrindåˆ†ç¦»å‡ºå»æˆlibVEXäº†ã€‚libVEXé‡‡ç”¨execution-drivençš„æ–¹å¼ç”¨just-in-timeæŠ€æœ¯åŠ¨æ€åœ°æŠŠæœºå™¨ç è½¬æ¢ä¸ºIRï¼Œå¦‚æœå‘ç”Ÿäº†æŸäº›toolæ„Ÿå…´è¶£çš„äº‹ä»¶ï¼Œå°±ä¼šhook toolçš„å‡½æ•°ï¼Œtoolä¼šæ’å…¥ä¸€äº›åˆ†æä»£ç ï¼Œå†æŠŠè¿™äº›ä»£ç è½¬æ¢ä¸ºæœºå™¨ç ï¼Œå­˜å‚¨åˆ°code cacheä¸­ï¼Œä»¥ä¾¿å†éœ€è¦çš„æ—¶å€™æ‰§è¡Œã€‚\nMachine Code --\u0026gt; IR --\u0026gt; IR --\u0026gt; Machine Code ^ ^ ^ | | | translate | | | | instrument | | translate valgrindå¯åŠ¨åï¼Œcoreã€toolå’Œclientéƒ½åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå…±ç”¨ä¸€ä¸ªåœ°å€ç©ºé—´ã€‚coreé¦–å…ˆä¼šåˆå§‹åŒ–å¿…è¦çš„ç»„ä»¶ï¼Œç„¶åè½½å…¥clientï¼Œå»ºç«‹clientçš„stackï¼Œå®Œæˆåä¼šè¦æ±‚toolåˆå§‹åŒ–è‡ªå·±ï¼Œtoolå®Œæˆå‰©ä½™éƒ¨åˆ†çš„åˆå§‹åŒ–ï¼Œè¿™æ ·toolå°±å…·æœ‰äº†æ§åˆ¶æƒï¼Œå¼€å§‹è½¬æ¢clientç¨‹å¼ã€‚ä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œvalgrindæ‰§è¡Œçš„éƒ½æ˜¯åŠ å·¥åçš„clientç¨‹åºçš„ä»£ç ã€‚\nDBI framework æœ‰ä¸¤ç§åŸºæœ¬çš„æ–¹å¼å¯ä»¥è¡¨ç¤ºcodeå’Œè¿›è¡Œ instrumentationï¼š\n disassemble-and-resynthesise (D\u0026amp;R)ã€‚  Valgrind ä½¿ç”¨è¿™ç§æŠŠmachine codeå…ˆè½¬æˆIRï¼ŒIRä¼šé€šè¿‡åŠ å…¥æ›´IRæ¥instrumentã€‚IRæœ€åè½¬å›machine codeæ‰§è¡Œï¼ŒåŸæœ¬çš„codeå¯¹ guest stateçš„æ‰€æœ‰å½±å“éƒ½å¿…é¡»æ˜ç¡®åœ°è½¬æˆIRï¼Œå› ä¸ºæœ€åæ‰§è¡Œçš„æ˜¯çº¯ç²¹ç”±IRè½¬æˆçš„machine codeã€‚   copy-and-annotate (C\u0026amp;A)ã€‚instructionsä¼šè¢«é€å­—åœ°å¤åˆ¶(é™¤äº†ä¸€äº› control flow æ”¹å˜)  æ¯ä¸ªinstructionéƒ½åŠ ä¸Šæ³¨è§£æè¿°å…¶å½±å“(annotate)ï¼Œåˆ©ç”¨è¿™äº›æè¿°æ¥å¸®åŠ©åšinstrumentation é€šè¿‡ç»™æ¯æ¡æŒ‡ä»¤æ·»åŠ ä¸€ä¸ªé¢å¤–çš„data structure (DynamoRIO) é€šè¿‡æä¾›ç›¸åº”çš„è·å–æŒ‡ä»¤ç›¸å…³ä¿¡æ¯çš„API (Intel Pin) è¿™äº›æ·»åŠ çš„æ³¨è§£å¯ä»¥æŒ‡å¯¼è¿›è¡Œç›¸åº”çš„instrumentï¼Œå¹¶ä¸”ä¸å½±å“åŸæ¥çš„native codeçš„æ‰§è¡Œæ•ˆæœã€‚    åŸºæœ¬ä¸Š DBI framework å¯ä»¥åˆ†æˆè¿™ä¸¤ç§ï¼Œ ä½†æ˜¯æ··ç”¨æ˜¯å¯ä»¥åšåˆ°çš„ï¼Œ æ—©æœŸçš„ Valgrind å¯¹ interger instructions ä½¿ç”¨ D\u0026amp;Rï¼Œ è€Œå¯¹ floating point insturctions å’Œ SIMD ä½¿ç”¨ C\u0026amp;A (paper ä¸Šå†™è¯´å¹¶éè®¾è®¡æƒ³å¾€è¿™è¾¹èµ°ï¼Œè€Œæ˜¯æ„å¤–)ã€‚å¦å¤–ï¼Œåšä¸€äº›å˜åŒ–ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¾‹å¦‚ DynamoRIO å…è®¸ instructions åœ¨å¤åˆ¶å‰ in-place åœ°ä¿®æ”¹ã€‚\nå„ä¸ªè®¾è®¡éƒ½æœ‰ä¼˜ç¼ºç‚¹ï¼Œè€Œ D\u0026amp;R çš„æ–¹å¼éœ€è¦æ›´å¤šçš„å®ä½œå’Œè®¾è®¡ï¼Œ è€Œä¸”æœ€åä» IR ç”Ÿå‡ºæœ‰æ•ˆç‡åœ° machine code ä¹Ÿéœ€è¦ä¸€äº›åŠªåŠ›ï¼Œ Valgrind JIT å°±ç”¨äº†å¾ˆå¤šç¼–è¯‘å™¨çš„æŠ€æœ¯ã€‚ç›¸å¯¹åœ°ï¼ŒC\u0026amp;A çš„ä½œæ³•å°±å¯ä»¥æ¯” D\u0026amp;R å°‘è´¹äº›å¿ƒåŠ›ã€‚\nä¼˜ç‚¹å’Œç¼ºç‚¹ ä¼˜ç‚¹ 1.ç”¨valgrindç›‘æµ‹å†…å­˜æ³„æ¼ï¼Œä¸ç”¨é‡æ–°ç¼–è¯‘åº”ç”¨ç¨‹åºï¼Œä¸ç”¨é‡æ–°é“¾æ¥åº”ç”¨ç¨‹åºï¼Œä¸ç”¨å¯¹åº”ç”¨è¿›ç¨‹åšä»»ä½•ä¿®æ”¹ã€‚å¦‚æœæƒ³æŸ¥çœ‹è¯¦ç»†çš„å‡ºé”™ä¿¡æ¯ï¼Œåªéœ€è¦åœ¨ç¼–è¯‘æ—¶åŠ ä¸Š-gé€‰é¡¹ã€‚\nç¼ºç‚¹  é€šå¸¸æƒ…å†µä¸‹ï¼Œä½¿ç”¨memcheckå·¥å…·ååº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶é—´ä¼šæ¯”åŸç”Ÿä»£ç æ…¢å¤§çº¦10-50å€ã€‚ -å†…å­˜å ç”¨é«˜ï¼Œå› ä¸ºè¦ç»´æŠ¤ä¸¤å¼ è¡¨æ ¼ï¼Œè€Œè¿™ä¸¤å¼ è¡¨çš„ç»´åº¦æ­£æ¯”äºç¨‹åºçš„å†…å­˜ -memcheckæ— æ³•æ£€æµ‹globalå’Œstackä¸Šçš„å†…å­˜æº¢å‡ºï¼Œå› ä¸ºæº¢å‡ºçš„åœ°æ–¹ä¹Ÿåœ¨Valid-address (A) bitsä¸­ã€‚è¿™æ˜¯ç”±memcheck çš„å·¥ä½œåŸç†å†³å®šçš„ã€‚ å¯¹äºä¸€äº›ä¸åœæœºè¿è¡Œçš„æœåŠ¡å™¨ç¨‹åºçš„å†…å­˜é—®é¢˜ï¼Œvalgrindæ— èƒ½ä¸ºåŠ›ã€‚ä¸ä»…ä»…æ˜¯å› ä¸ºvalgrindæ— æ³•ä½¿ä¹‹åœæ­¢ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯å› ä¸ºæœåŠ¡å™¨è¿›ç¨‹æœ¬èº«å°±è¢«è®¾è®¡ä¸ºç”³è¯·ä¸€äº›ç”Ÿå‘½å‘¨æœŸ ä¸è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸä¸€æ ·é•¿çš„å†…å­˜ï¼Œæ°¸è¿œä¸é‡Šæ”¾ï¼Œè¿™äº›å†…å­˜ä¼šè¢«valgrindæŠ¥æ³„æ¼é”™è¯¯ã€‚ valgrindå¯¹å¤šçº¿ç¨‹ç¨‹åºæ”¯æŒå¾—ä¸å¤Ÿå¥½ã€‚åœ¨å¤šçº¿ç¨‹ç¨‹åºæ‰§è¡Œæ—¶ï¼Œvalgrindåœ¨åŒä¸€æ—¶åˆ»åªè®©å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œå®ƒä¸ä¼šå……åˆ†åˆ©ç”¨å¤šæ ¸çš„ç¯å¢ƒã€‚åœ¨ç”¨valgrindè¿è¡Œæ‚¨çš„å¤šçº¿ç¨‹ç¨‹åº æ—¶ï¼Œæ‚¨çš„å®è´µç¨‹åºçš„è¿è¡Œæƒ…å†µå¯èƒ½è·Ÿä¸ä½¿ç”¨valgrindçš„è¿è¡Œæƒ…å†µåƒå·®ä¸‡åˆ«ã€‚  å‚è€ƒï¼š\n https://blog.mengy.org/how-valgrind-work/ https://www.valgrind.org/docs/pubs.html https://blog.csdn.net/yinliyinli/article/details/51346431 https://blog.csdn.net/u014652595/article/details/23660347 valgrindå¦‚ä½•å·¥ä½œï¼Ÿ http://awhite2008.blog.sohu.com/164824340.html https://wdv4758h-notes.readthedocs.io/zh_TW/latest/valgrind/dynamic-binary-instrumentation.html  ","description":"å®˜æ–¹é¦–é¡µä¸Šè¿™ä¸ªéª‘å£«ä¸æ¶é¾™çš„ç»˜ç”»ç”±ä¼¦æ•¦ç”»å®¶ Rupert Lees åˆ›ä½œã€‚çµæ„Ÿæ¥è‡ªäºç¥è¯ä¼ è¯´ St George and the Dragon ã€‚æŸæ—¥ï¼Œåœ£ä¹”æ²»åˆ°åˆ©æ¯”äºšå»ï¼Œå½“åœ°æ²¼æ³½ä¸­çš„ä¸€åªæ¶é¾™ï¼ˆä¸€è¯´é³„é±¼ï¼‰åœ¨æ°´æ³‰æ—è¾¹ç­‘å·¢ï¼Œè¿™æ°´æ³‰æ˜¯SileneåŸå”¯ä¸€çš„æ°´æºï¼Œå¸‚æ°‘ä¸ºäº†å–æ°´ï¼Œæ¯å¤©éƒ½è¦æŠŠä¸¤å¤´ç»µç¾ŠçŒ®ç¥­ç»™æ¶é¾™ã€‚ åˆ°åæ¥ï¼Œç»µç¾Šéƒ½åƒå®Œäº†ï¼Œåªå¥½ç”¨æ´»äººæ¥æ›¿ä»£ï¼Œæ¯å¤©æŠ½ç­¾å†³å®šä½•äººåº”é€‰æ´¾ä½œç‰ºç‰²ã€‚ æœ‰ä¸€å¤©ï¼Œå›½ç‹çš„å¥³å„¿è¢«æŠ½ä¸­ï¼Œå›½ç‹ä¹Ÿæ²¡æœ‰åŠæ³•ï¼Œæ‚²ç—›æ¬²ç»ã€‚å½“å°‘å¥³èµ°è¿‘ï¼Œæ­£è¦è¢«æ¶é¾™ååƒæ—¶ï¼Œåœ£ä¹”æ²»åœ¨è¿™æ—¶èµ¶åˆ°ï¼Œæèµ·åˆ©çŸ›å¯¹æŠ—æ¶é¾™ï¼Œå¹¶ç”¨è…°å¸¦æŠŠå®ƒæŸç¼šä½ï¼Œç‰µåˆ°åŸé‡Œå½“ä¼—æ€æ­»ï¼Œæ•‘å‡ºäº†å…¬ä¸»ã€‚","id":47,"section":"posts","tags":["MLK"],"title":"Valgrind","uri":"https://hugo.jiahongw.com/zh/posts/mlk/valgrind/"},{"content":"duma DUMAæ˜¯ä¸€ä¸ªå¼€æºåº“(åœ¨GNUé€šç”¨å…¬å…±è®¸å¯è¯ä¸‹)ï¼Œç”¨äºæ£€æµ‹Cå’ŒC++ç¨‹åºä¸­çš„ç¼“å†²åŒºæº¢å‡ºå’Œè¿è¡Œé”™è¯¯ï¼Œæ˜¯ä¸€ä¸ªRed-Zone memory allocatorã€‚è¿™ä¸ªåº“æ˜¯ Electric Fenceåº“çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶æ·»åŠ äº†ä¸€äº›æ–°åŠŸèƒ½ã€‚\n è¯¥åº“æ˜¯Buce Perens Electric Fenceåº“çš„åˆ†æ”¯ï¼Œå¹¶æ·»åŠ äº†ä¸€äº›å…¶ä»–åŠŸèƒ½ï¼Œä¾‹å¦‚å†…å­˜æ³„æ¼æŠ¥å‘Šã€‚\n åŸºæœ¬ä»‹ç» å®˜ç½‘ï¼š http://duma.sourceforge.net/\næºç ï¼š https://github.com/fortitudepub/duma\næ–‡æ¡£ï¼š http://duma.sourceforge.net/README.txt\næ”¯æŒ  Linux / Unix MS Windows NT/2K/XP  å®‰è£…  éœ€è¦gmakeå·¥å…·\n 1 2 3 4  unzip duma-master.zip cd duma-master gmake gmake install   ï¼ˆä¸è¡Œçš„è¯ç¼–è¾‘GNUmakefileï¼Œåœ¨å¼€å¤´æ·»åŠ OS=linuxï¼‰\né—®é¢˜\n  Centos8æˆ–è€…é«˜ç‰ˆæœ¬C++å¯èƒ½ä¼šå¯¼è‡´ä¸C++98çš„æŠ›å‡ºå¼‚å¸¸ä¸ä¸€\nè§£å†³åŠæ³•ï¼šéœ€è¦è¿›å…¥GNUmakefileä¸­ä¿®æ”¹æ·»åŠ å‚æ•°-std=c++98\n  ä½¿ç”¨ åŸºæœ¬åŠŸèƒ½  è¶…å‡ºåŠ¨æ€åˆ†é…ç¼“å†²åŒºçš„æœ«å°¾ï¼ˆæˆ–å¼€å§‹ï¼‰ã€‚ è¿”å›åˆ°å †åä½¿ç”¨åŠ¨æ€åˆ†é…çš„ç¼“å†²åŒºã€‚ æ£€æµ‹å†…å­˜æ³„æ¼ã€‚ æ£€æµ‹åˆ†é…/å–æ¶ˆåˆ†é…åŠŸèƒ½çš„ä¸åŒ¹é…ï¼šä¾‹å¦‚ï¼Œ\nä½¿ç”¨mallocï¼ˆï¼‰è¿›è¡Œåˆ†é…ï¼Œä½†ä½¿ç”¨è¿ç®—ç¬¦deleteè¿›è¡Œé‡Šæ”¾ã€‚  åŸºæœ¬ä½¿ç”¨æ–¹æ³• ä½¿ç”¨é™åˆ¶ï¼š\n ä¸èƒ½å’Œlmallocã€lmallocdebugç­‰malloc-debuggeræ··ç”¨ dumaä¼šåˆ›å»ºcoreæ–‡ä»¶ï¼Œæ³¨æ„æ“ä½œç³»ç»Ÿå¯¹coreæ–‡ä»¶çš„é™åˆ¶ -ldumaéœ€è¦å…¨å±€å®‰è£…ï¼Œå¦åˆ™å°±è¦æŒ‡å®šè·¯å¾„ï¼Œä¹Ÿå¯ä»¥ç¯å¢ƒå˜é‡çš„å½¢å¼åº”ç”¨äºæ‰€æœ‰åŠ¨æ€å¯æ‰§è¡Œæ–‡ä»¶  æ–¹æ³•ï¼š\n  å‡å¦‚dumaå·²ç»å®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨-ldumaå»é“¾æ¥ç¼–è¯‘æˆ–è€…åœ¨å‘½ä»¤è¡Œæ·»åŠ é“¾æ¥åº“çš„ä½ç½®è¿›è¡Œé“¾æ¥ã€‚(é™æ€)\n  æ²¡æœ‰æ˜¾ç¤ºå®‰è£…dumaä¹Ÿå¯ä»¥ä½¿ç”¨åŠ¨æ€é“¾æ¥ï¼Œå¦‚ä¸‹(åŠ¨æ€)\n1  (export LD_PRELOAD=/usr/lib/libduma.so; export DYLD_INSERT_LIBRARIES=libduma.dylib; export DYLD_FORCE_FLAT_NAMESPACE=1; exec APP args)   æˆ–è€…\n1  LD_PRELOAD=/usr/lib/libduma.so APP args     å¦‚æœä½ çš„ç¨‹åºæœ‰ä¸€ä¸ªè¢«DUMAæ£€æµ‹åˆ°çš„é”™è¯¯ï¼Œå®ƒå°†å¾—åˆ°ä¸€ä¸ªé”™è¯¯æŒ‡ä»¤çš„segmentation fault(SIGSEGV)ã€‚ä½¿ç”¨debugger æ‰¾åˆ°é”™è¯¯çš„å£°æ˜ï¼Œå¹¶ä¿®å¤å®ƒã€‚\nä¸‹é¢æ˜¯ä½¿ç”¨gdbæ‰¾åˆ°é”™è¯¯ä½ç½®çš„å…·ä½“æ“ä½œï¼š\né™æ€(ä¸Šé¢ç¬¬ä¸€ç§æ–¹æ³•ç¼–è¯‘çš„ç¨‹åº)ï¼š\n  ä½¿ç”¨gdbå¯åŠ¨ç¨‹åºï¼Œä¾‹å¦‚ï¼š\n1  gdb app     åœ¨gdbé‡Œé¢è®¾ç½®ç¯å¢ƒå˜é‡ã€‚\n1  set environment DUMA_PROTECT_BELOW 1     åœ¨gdbé‡Œé¢è®¾ç½®ç¨‹åºçš„å‚æ•°ã€‚\n1  set args ..     è¿è¡Œç¨‹åºç­‰å¾…å­—æ®µé”™è¯¯ã€‚\n1  run     åŠ¨æ€(ä¸Šé¢ç¬¬äºŒç§æ–¹æ³•ç¼–è¯‘çš„ç¨‹åº)ï¼š\n  è®¾ç½®â€œulimit -c unlimitedâ€è·å–å†…æ ¸æ–‡ä»¶ã€‚\n  è¿è¡Œé™æ€é“¾æ¥çš„ç¨‹åºæˆ–è€…åŠ¨æ€é“¾æ¥çš„ç¨‹åºã€‚\n  ç­‰å¾…å­—æ®µé”™è¯¯ï¼Œä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸€ä¸ªå†…æ ¸æ–‡ä»¶core.pidã€‚å¯ä»¥ä½¿ç”¨gdbæ‰“å¼€ï¼š\n1  gdb \u0026lt;program\u0026gt; -c \u0026lt;core file\u0026gt;     ç¯å¢ƒå˜é‡  æ”¯æŒåœ¨gdbé‡Œé¢é€šè¿‡å‘½ä»¤\u0026rsquo;set environment variable value\u0026rsquo; è®¾ç½®ç¯å¢ƒå˜é‡\n   DUMA_ALIGNMENT\nè¿™æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå®ƒæŒ‡å®šå°†ç”±malloc()ã€calloc()å’Œrealloc()è¿”å›çš„ä»»ä½•å†…å­˜åˆ†é…çš„å¯¹é½å¤§å°ã€‚å› æ­¤ï¼Œå€¼ä¸º4å°†å¯¼è‡´å†…å­˜å¯¹é½åˆ°32ä½ï¼Œé™¤éç³»ç»Ÿæ²¡æœ‰8ä½çš„charã€‚\n é»˜è®¤æƒ…å†µä¸‹ï¼ŒDUMA_ALIGNMENTè®¾ç½®ä¸ºç‰¹å®šäºç¯å¢ƒçš„æœ€å°æ‰€éœ€å¯¹é½ã€‚ æœ€å°æ‰€éœ€å¯¹é½ç”±createconfæ£€æµ‹å¹¶å­˜å‚¨åœ¨æ–‡ä»¶duma_config.hä¸­ã€‚\n å› æ­¤ï¼Œåˆ†é…å°äºDUMA_ALIGNMENTçš„å—å¯èƒ½ä¼šå¯¼è‡´æ›´å°çš„å¯¹é½-ä¾‹å¦‚ï¼Œå½“åˆ†é…3ä¸ªå­—èŠ‚æ—¶ï¼Œå®ƒä»¬å°†è¢«å¯¹é½åˆ°2ä¸ªå­—èŠ‚è¾¹ç•Œã€‚ è¿™å¯ä»¥æ›´å¥½åœ°æ£€æµ‹æº¢å‡ºã€‚\n å‡ºäºè¿™ä¸ªåŸå› ï¼Œæ‚¨æœ‰æ—¶å¸Œæœ›å°†DUMA_ALIGNMENTè®¾ç½®ä¸º1ï¼ˆæ²¡æœ‰å¯¹é½ï¼‰ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥æ£€æµ‹åˆ°è¶…å‡ºCPUå•è¯å¤§å°çš„æƒ…å†µ\n å¦‚æœæ‚¨åªéœ€è¦å¯¹ä¸€äº›ç‰¹æ®Šç¼“å†²åŒºè¿›è¡Œæ›´å¤§çš„å¯¹é½,æ‚¨ä¸éœ€è¦æ›´æ”¹æ­¤è®¾ç½®ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å‡½æ•°\n1  memalign(alignment, userSize).     DUMA_PROTECT_BELOW\nDUMAé€šå¸¸ä¼šåœ¨æ¯æ¬¡å†…å­˜åˆ†é…åç«‹å³æ”¾ç½®ä¸€ä¸ªä¸å¯è®¿é—®çš„é¡µé¢ï¼Œè¿™æ ·å°±ä¼šæ£€æµ‹åˆ°åœ¨åˆ†é…ç»“æŸåè¿è¡Œçš„è½¯ä»¶ã€‚\n å°†DUMA_PROTECT_BELOWè®¾ç½®ä¸º1å°†å¯¼è‡´DUMAåœ¨åˆ†é…ä¹‹å‰å°†æ— æ³•è®¿é—®çš„é¡µé¢æ”¾ç½®åœ¨åœ°å€ç©ºé—´ä¸­ï¼Œè¿™æ ·å°±ä¼šæ£€æµ‹åˆ°è¿è¡Œä¸è¶³è€Œä¸æ˜¯è¿è¡Œè¿‡åº¦\n   DUMA_SKIPCOUNT_INIT\nä¸€èˆ¬ä½¿ç”¨ç¬¬ä¸€ä¸ªåˆ†é…å™¨åˆ†é…ã€‚åœ¨æŸäº›ç³»ç»Ÿä¸­ï¼Œè¿™å¯èƒ½ä¼šä¸pthreadsæˆ–å…¶ä»–libariesçš„åˆå§‹åŒ–å‘ç”Ÿå†²çªå¹¶äº§ç”ŸæŒ‚èµ·ã€‚ ä¸ºäº†è·å¾—DUMAå·¥ä½œï¼Œå³ä½¿åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ‚¨ä¹Ÿå¯ä»¥æ§åˆ¶ï¼ˆä½¿ç”¨æ­¤ç¯å¢ƒå˜é‡ï¼‰åœ¨å®ŒæˆDUMAçš„å…¨éƒ¨å†…éƒ¨åˆå§‹åŒ–åçš„åˆ†é…æ•°é‡ã€‚ é»˜è®¤ä¸º0ã€‚\n  DUMA_REPORT_ALL_LEAKS\nDUMAé€šå¸¸åªæŠ¥å‘Šå†…å­˜æ³„æ¼ï¼Œå…¶ä¸­å·²çŸ¥åˆ†é…æŒ‡ä»¤è¡Œå·çš„æºæ–‡ä»¶åã€‚å¹¶ä¸æŠ¥é”™é€€å‡ºã€‚\né»˜è®¤å€¼ä¸º0ï¼Œä»¥é¿å…ä»ç³»ç»Ÿ/ç¼–è¯‘å™¨ç¯å¢ƒæŠ¥å‘Šæ— å…³å†…å­˜æ³„æ¼ã€‚\n  DUMA_FILL\nå½“è®¾ç½®ä¸º0åˆ°255ä¹‹é—´çš„å€¼æ—¶ï¼Œåˆ†é…å†…å­˜çš„æ¯ä¸ªå­—èŠ‚éƒ½è¢«åˆå§‹åŒ–ä¸ºè¯¥å€¼ã€‚\n è¿™å¯ä»¥å¸®åŠ©æ£€æµ‹æœªåˆå§‹åŒ–å†…å­˜çš„è¯»å–\n å½“è®¾ç½®ä¸º-1æ—¶ï¼ŒDUMAä¸ä¼šåœ¨åˆ†é…æ—¶åˆå§‹åŒ–å†…å­˜ã€‚ ä½†æ˜¯ä¸€äº›å†…å­˜ä¸­å……æ»¡äº†é›¶ï¼ˆå¤§å¤šæ•°ç³»ç»Ÿé»˜è®¤çš„æ“ä½œç³»ç»Ÿï¼‰ï¼Œä¸€äº›å†…å­˜å°†ä¿ç•™åœ¨ä¸Šæ¬¡ä½¿ç”¨æœŸé—´å†™å…¥çš„å€¼ã€‚æ¯ä¸ªé»˜è®¤çš„DUMAå°†åˆå§‹åŒ–æ‰€æœ‰åˆ†é…çš„å­—èŠ‚åˆ°255(=0x FF)ã€‚\n  DUMA_SLACKFILL\nå½“DUMAåœ¨æ•´ä¸ªé¡µé¢ä¸­å†…éƒ¨åˆ†é…å†…å­˜æ—¶ï¼Œå°±ä¼šä¿ç•™ä¸€ä¸ªæœªä½¿ç”¨å’Œæ— æ³•ä¿æŠ¤çš„å†…å­˜å—ï¼šå¯ç”¨ä½†æ˜¯è¿˜æ²¡ä½¿ç”¨çš„å†…å­˜åŒºåŸŸã€‚ æ¯ä¸ªé»˜è®¤çš„DUMAå°†åˆå§‹åŒ–è¿™ä¸ªåŒºåŸŸåˆ°170(=0x AA)ï¼Œè¿™æ˜¯10101010åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºã€‚\n  DUMA_CHECK_FREQ\nå°†æ­¤å˜é‡è®¾ç½®ä¸º1ï¼Œä»¥ä¾¿åœ¨æ¯ä¸ªåˆ†é…å’Œè§£é™¤åˆ†é…æ—¶å…è®¸DUMAæ£€æŸ¥æ— äººåŒºã€‚æ¯ä¸ªé»˜è®¤å€¼éƒ½ä½¿ç”¨0ï¼Œè¿™æ„å‘³ç€åªåœ¨å–æ¶ˆåˆ†é…æ—¶æ£€æŸ¥\n  DUMA_ALLOW_MALLOC_0\nå¤§å°ä¸ºé›¶çš„å†…å­˜åˆ†é…ç¬¦åˆANSIã€‚ ä½†è¿™å¾€å¾€æ˜¯è½¯ä»¶é”™è¯¯çš„ç»“æœã€‚ å› æ­¤ï¼ŒDUMAå¯èƒ½ä¼šå°†è¿™æ ·çš„è°ƒç”¨æ•è·åˆ°å¤§å°ä¸ºé›¶çš„malloc()ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘å°†ç¦ç”¨æ­¤é€‰é¡¹ï¼Œä½†æ‚¨å¯ä»¥è‡ªç”±åœ°æ•è·è¿™äº›è°ƒç”¨ï¼Œå°†shellç¯å¢ƒä¸­çš„DUMA_ALLOC_MALLOC_0è®¾ç½®ä¸ºæ•´æ•°å€¼ã€‚\n  DUMA_MALLOC_0_STRATEGY\næ­¤ç¯å¢ƒå˜é‡æ§åˆ¶DUMAåœ¨mallocï¼ˆ0)ä¸Šçš„è¡Œä¸ºï¼‰ï¼š\nALLOW_MALLOC_0çš„å€¼\n0 - abort program with segfault\n1 - è¿”å›ç©ºæŒ‡é’ˆ\n2 - è¿”å›åˆ°æŸäº›å—ä¿æŠ¤é¡µé¢çš„æŒ‡é’ˆæ€»æ˜¯ç›¸åŒçš„\n3 - è¿”å›å”¯ä¸€å—ä¿æŠ¤é¡µçš„ä¸­é—´åœ°å€ï¼ˆ=é»˜è®¤ï¼‰\n æ³¨æ„ï¼šåªæœ‰1å’Œ3æ˜¯ANSIç¬¦åˆã€‚ ä½†æ˜¯å€¼1ä¼šç ´åå¤§å¤šæ•°ç¨‹åºï¼Œå¯¼è‡´å€¼3ç­–ç•¥å¤§å¤šæ•°ç³»ç»Ÿåº“ä½¿ç”¨/å®ç°ã€‚ æ‰€æœ‰è¿”å›çš„æŒ‡é’ˆéƒ½å¯ä»¥ä¼ é€’ç»™è‡ªç”±()ã€‚\n   DUMA_NEW_0_STRATEGY\næ­¤ç¯å¢ƒå˜é‡æ§åˆ¶DUMAåœ¨å¤§å°ä¸ºé›¶çš„Cæ“ä½œç¬¦ä¸Šçš„è¡Œä¸ºï¼š\n2 - è¿”å›åˆ°æŸäº›å—ä¿æŠ¤é¡µé¢çš„æŒ‡é’ˆæ€»æ˜¯ç›¸åŒçš„\n3 - è¿”å›å”¯ä¸€å—ä¿æŠ¤é¡µçš„ä¸­é—´åœ°å€ï¼ˆ=é»˜è®¤ï¼‰\n æ³¨æ„ï¼šåªæœ‰3æ˜¯æ ‡å‡†ç¬¦åˆã€‚ ä»·å€¼2å¯èƒ½ä¼šæ‰“ç ´ä¸€äº›ï¼Œä½†å°†é€‚ç”¨äºå¤§å¤šæ•°ç¨‹åºã€‚ å€¼2å¯ä»¥å‡å°‘å†…å­˜æ¶ˆè€—ã€‚\n   ç­‰ç­‰â€”\nåŸç†   DUMAä½¿ç”¨è®¡ç®—æœºçš„è™šæ‹Ÿå†…å­˜ç¡¬ä»¶ï¼Œåœ¨æ¯æ¬¡å†…å­˜åˆ†é…ä¹‹åï¼ˆæˆ–ä¹‹å‰ï¼Œé€‰æ‹©ä¹‹å‰ï¼‰ç«‹å³æ”¾ç½®ä¸€ä¸ªä¸å¯è®¿é—®çš„å†…å­˜é¡µé¢ã€‚è¯»å†™è¿™ä¸ªä¸å¯è®¿é—®çš„ä¹Ÿé¡µé¢ä¼šè§¦å‘æ®µé”™è¯¯ï¼Œç„¶åä½¿ç”¨è°ƒè¯•å™¨åˆ†æå¹¶ä¸”è§£å†³é—®é¢˜\n  â€œé‡è½½â€æ‰€æœ‰æ ‡å‡†å†…å­˜åˆ†é…å‡½æ•°åŠé‡Šæ”¾å‡½æ•°ã€‚\nåˆ©ç”¨CPUçš„MMUï¼ˆå†…å­˜ç®¡ç†å•å…ƒï¼‰åˆ†é…å¹¶ä¿æŠ¤ä¸€ä¸ªé¢å¤–çš„å†…å­˜é¡µï¼Œä»¥æ£€æµ‹è¶…å‡ºç¼“å†²åŒºé¡¶éƒ¨ï¼ˆæˆ–åº•éƒ¨ï¼Œç”±ç”¨æˆ·é€‰æ‹©ï¼‰ä¹‹å¤–çš„ä»»ä½•éæ³•è®¿é—®ã€‚\n  ä»¥free()æ–¹å¼é‡Šæ”¾çš„å†…å­˜ä¹Ÿè¢«è®¾ç½®ä¸ºä¸å¯è®¿é—®ï¼Œä»»ä½•è¯•å›¾æ¥è§¦å®ƒçš„ä»£ç éƒ½ä¼šå¾—åˆ°ä¸€ä¸ªsegmentation faultã€‚\n  åˆå§‹åŒ–çš„å†…å­˜å¯ä»¥è‡ªå®šä¹‰1-255çš„åˆå§‹å€¼ï¼Œé»˜è®¤ä¸è®¾ç½®\n  ä½¿ç”¨0xAAå¡«å……ç”³è¯·é¡µå—ä¸­æœªä½¿ç”¨ä½†æ˜¯å¯ä»¥ä½¿ç”¨çš„å†…å­˜\n  å†…å­˜ä½¿ç”¨å’Œæ‰§è¡Œé€Ÿåº¦ ç”±äºDUMAçš„æ¯ä¸ªåˆ†é…è‡³å°‘ä½¿ç”¨ä¸¤ä¸ªè™šæ‹Ÿå†…å­˜é¡µé¢ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯æ€•çš„å†…å­˜å ç”¨ã€‚ æˆ‘æœ‰æ—¶å‘ç°æœ‰å¿…è¦ä½¿ç”¨swaponï¼ˆ8ï¼‰æ·»åŠ ä¸€ä¸ªäº¤æ¢æ–‡ä»¶ï¼Œè¿™æ ·ç³»ç»Ÿå°±æœ‰è¶³å¤Ÿçš„è™šæ‹Ÿå†…å­˜æ¥è°ƒè¯•æˆ‘çš„ç¨‹åºã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬æ“ä½œå†…å­˜çš„æ–¹å¼å¯¼è‡´å„ç§ç¼“å­˜å’Œè½¬æ¢ç¼“å†²åŒºæ¡ç›®è¢«åˆ·æ–°ï¼Œæ¯æ¬¡è°ƒç”¨mallocæˆ–å…è´¹ã€‚ æœ€ç»ˆçš„ç»“æœæ˜¯ï¼Œæ‚¨çš„ç¨‹åºå°†æ…¢å¾—å¤šï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨DUMAè°ƒè¯•æ—¶ä½¿ç”¨æ›´å¤šçš„èµ„æºã€‚\nä¸è¦ç”¨äºç”Ÿäº§ç¯å¢ƒï¼\nä¼˜ç‚¹å’Œç¼ºç‚¹ ä¼˜ç‚¹  å®‰è£…æ–¹ä¾¿ é¢„åŠ è½½åº“å½¢å¼ï¼Œæ— éœ€ä¿®æ”¹ä»£ç é‡æ–°ç¼–è¯‘ æ”¯æŒC++  ç¼ºç‚¹  æ€§èƒ½æ¯”è¾ƒå·®  æ‰§è¡Œæ•ˆç‡ï¼šæˆ‘ä»¬æ“ä½œå†…å­˜çš„æ–¹å¼å¯¼è‡´å„ç§ç¼“å­˜å’Œè½¬æ¢ç¼“å†²åŒºæ¡ç›®è¢«åˆ·æ–°ï¼Œæ¯æ¬¡è°ƒç”¨mallocæˆ–freeã€‚ æœ€ç»ˆçš„ç»“æœæ˜¯ï¼Œæ‚¨çš„ç¨‹åºå°†æ…¢å¾—å¤š å†…å­˜å¼€é”€ï¼šæ¯ä¸ªåˆ†é…ä½¿ç”¨è‡³å°‘ä¸¤ä¸ªè™šæ‹Ÿå†…å­˜é¡µé¢    ","description":"DUMAæ˜¯ä¸€ä¸ªå¼€æºåº“(åœ¨GNUé€šç”¨å…¬å…±è®¸å¯è¯ä¸‹)ï¼Œç”¨äºæ£€æµ‹Cå’ŒC++ç¨‹åºä¸­çš„ç¼“å†²åŒºæº¢å‡ºå’Œè¿è¡Œé”™è¯¯ï¼Œæ˜¯ä¸€ä¸ªRed-Zone memory allocatorã€‚","id":48,"section":"posts","tags":["MLK"],"title":"duma","uri":"https://hugo.jiahongw.com/zh/posts/mlk/duma/"},{"content":"Eletric-Fence Electric Fenceæ˜¯å¦ä¸€ç§mallocï¼ˆï¼‰è°ƒè¯•å™¨ã€‚å®ƒä½¿ç”¨ç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜ç¡¬ä»¶æ¥æ£€æµ‹è½¯ä»¶ä½•æ—¶è¶…å‡ºäº†mallocï¼ˆï¼‰ç¼“å†²åŒºçš„è¾¹ç•Œã€‚å®ƒè¿˜å°†æ£€æµ‹freeï¼ˆï¼‰é‡Šæ”¾çš„ä»»ä½•å†…å­˜è®¿é—®ã€‚å› ä¸ºå®ƒä½¿ç”¨VMç¡¬ä»¶è¿›è¡Œæ£€æµ‹ï¼Œæ‰€ä»¥Electric Fenceä¼šåœ¨å¯¼è‡´è¾¹ç•Œè¿åçš„ç¬¬ä¸€æ¡æŒ‡ä»¤ä¸Šåœæ­¢æ‚¨çš„ç¨‹åºã€‚\nåŸºæœ¬ä»‹ç» å®˜ç½‘ã€å‚è€ƒæ–‡æ¡£ï¼š\n1.https://www.bbsmax.com/A/gVdnRMOadW/\n2.https://xsyr.github.io/%E7%BC%96%E7%A8%8B/c/c++/2013/10/13/use-electric-fence-to-detect-heap-overruns-and-underruns.html\næºç ï¼š https://github.com/kallisti5/ElectricFence\næ”¯æŒ æ”¯æŒæ‰€æœ‰Linuxã€Unixå¹³å°ã€‚(Linux kernel version 1.1.83 and above)\nå®‰è£…  efenceåº“ä¾èµ–äºpthread(å¤šçº¿ç¨‹)åº“\nå®‰è£…ä¾èµ–äºsconså·¥å…·ï¼šyum install scons -y\nSConsæ˜¯ä¸€ä¸ªåŸºäºpythonçš„è½¯ä»¶æ„å»ºå·¥å…·ï¼Œå·²ç»ç§»æ¤åˆ°å¤§å¤šæ•°å¹³å°ä¸Šï¼Œå¹¶ä¸”å¯ä»¥åœ¨å¤§å¤šæ•°Linuxå‘è¡Œåº“ä¸­ä½¿ç”¨ã€‚\n  To compile  scons   To clean  scons -c    ä½¿ç”¨ åŸºæœ¬ä½¿ç”¨æ–¹æ³• ä½¿ç”¨æ­¥éª¤ï¼š\n  åœ¨ç¼–è¯‘çš„æ—¶å€™æ·»åŠ å‚æ•°: -lefence -lpthread\nå¦‚æœæ²¡æœ‰å®‰è£…Efenceï¼Œåˆ™éœ€è¦æŒ‡å®šlibefence.açš„ä½ç½®ï¼š\ngcc â€“g â€“o ef ef.c â€“lefence â€“L /usr/lib\n  æˆ–è€…\n  Link the generated static libefence.a archive into your application at build.\n  Preload the generated shared library\nlibefence.so at runtime via the following:\n Linux / Haiku / Solaris / HP-UX  LD_PRELOAD=./path/to/library/libefence.so /bin/myapplication   AIX 5.3+ (32-bit)  LDR_PRELOAD=./path/to/library/libefence.so /bin/myapplication   AIX 5.3+ (64-bit)  LDR_PRELOAD64=./path/to/library/libefence.so /bin/myapplication        ç¼–è¯‘è¿è¡Œï¼ŒæŸ¥çœ‹è¿è¡Œäº§ç”Ÿçš„coreæ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰coreæ–‡ä»¶ï¼Œè¯´æ˜æµ‹è¯•é€šè¿‡\nå½“å‘ç”Ÿsegmentation faultæ—¶å°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿäº§ä¸€ä¸ªcoreæ–‡ä»¶ï¼Œåœ¨linuxä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨GDBæ¥è°ƒè¯•coreï¼š\nGdb ef core.xxxx\nç„¶åè¾“å…¥whereå°±å¯ä»¥çœ‹åˆ°ç¨‹åºå´©æºƒæ—¶çš„å‡½æ•°è°ƒç”¨å †æ ˆä¿¡æ¯äº†ã€‚\n  å¯ä»¥åœ¨æ‰§è¡Œçš„æ—¶å€™ä½¿ç”¨gdbè°ƒè¯•ï¼Œä¾‹å¦‚gdb -q ./testï¼Œç„¶åæ‰§è¡Œrunå¯ä»¥çœ‹åˆ°æ‰§è¡Œåçš„ç»“æœ\n   åªéœ€å°†åº”ç”¨ç¨‹åºä¸libefence.aè¿æ¥èµ·æ¥ï¼Œå°±å¯ä»¥æ£€æµ‹åˆ°mallocç¼“å†²åŒºçš„å¤§éƒ¨åˆ†ï¼ˆä½†ä¸æ˜¯å…¨éƒ¨ï¼‰æº¢å‡ºå’Œå…è´¹å†…å­˜çš„è®¿é—®ã€‚\n å¯ä»¥é€šè¿‡é…ç½®ä»¥ä¸‹å‡ ä¸ªå…¨å±€å˜é‡å’Œç¯å¢ƒå˜é‡æ¥æ§åˆ¶Efenceçš„è¡Œä¸ºï¼š\n EF_ALIGNMENTï¼šè¿™æ˜¯Efence mallocåˆ†é…ç©ºé—´çš„å†…å­˜å¯¹é½å­—èŠ‚æ•°ã€‚è¿™ä¸ªå˜é‡çš„é»˜è®¤å€¼æ˜¯sizeof(int)ï¼Œ32ä½å­—é•¿çš„CPUå¯¹åº”çš„è¯¥å€¼æ˜¯4ã€‚è¿™ä¸ªå€¼ä¹Ÿæ˜¯Efenceèƒ½å¤Ÿæ£€æµ‹çš„å†…å­˜è¶Šç•Œçš„æœ€å°å€¼ã€‚ EF_PROTECT_BELOWï¼š é»˜è®¤æƒ…å†µä¸‹Efenceæ˜¯æŠŠinaccessibleçš„é¡µé¢ç½®äºåˆ†é…çš„ç©ºé—´ä¹‹åï¼Œæ‰€ä»¥æ£€æµ‹åˆ°çš„æ˜¯é«˜åœ°å€æ–¹å‘çš„è¶Šç•Œè®¿é—®ã€‚æŠŠè¿™ä¸ªå€¼è®¾ä¸º1å¯ä»¥æ£€æµ‹åˆ°ä½åœ°å€çš„è¶Šç•Œè®¿é—®ã€‚ EF_PROTECT_FREEï¼š é€šå¸¸freeåçš„å†…å­˜å—ä¼šè¢«æ”¾åˆ°å†…å­˜æ± ï¼Œç­‰å¾…é‡æ–°è¢«ç”³è¯·åˆ†é…ã€‚æŠŠè¿™ä¸ªå€¼è®¾ä¸º1åï¼Œfreeåçš„å†…å­˜å—å°±ä¸ä¼šè¢«é‡æ–°åˆ†é…å‡ºå»ï¼Œè€Œæ˜¯ä¹Ÿè¢«è®¾ç½®ä¸ºinaccessibleï¼Œæ‰€ä»¥Efenceèƒ½å¤Ÿå‘ç°ç¨‹åºå†æ¬¡è®¿é—®è¿™å—å·²ç»freeçš„å†…å­˜ã€‚ EF_ALLOW_MALLOC_0ï¼š Efenceé»˜è®¤ä¼šæ•æ‰malloc(0)çš„æƒ…å†µã€‚æŠŠè¯¥å€¼è®¾ä¸º1ååˆ™ä¸ä¼šæ•æ‰ç”³è¯·0å­—èŠ‚å†…å­˜çš„æƒ…å†µã€‚ EF_FILLï¼š åˆ†é…å†…å­˜åEfenceä¼šå°†æ¯ä¸€byteåˆå§‹åŒ–æˆè¿™ä¸ªå€¼(0-255)ã€‚å½“è¿™ä¸ªå€¼è¢«è®¾æˆ-1æ—¶ï¼Œå†…å­˜çš„å€¼ä¸å›ºå®šã€‚  è°ƒè¯•ç¨‹åºæ–¹æ³•  é“¾æ¥efenceåº“å¹¶ä¸”æ‰§è¡Œè‡ªå·±çš„ç¨‹åºã€‚ åœ¨debuggerä¸Šè¿è¡Œç¨‹åºå¹¶ä¸”ä¿®å¤æº¢å‡ºæˆ–è€…è®¿é—®å·²é‡Šæ”¾å†…å­˜çš„é”™è¯¯ã€‚ é€€å‡ºdebuggerå·¥å…·ã€‚ åœ¨shellç¯å¢ƒå˜é‡ä¸­Set EF_PROTECT_BELOW = 1 é‡å¤step 2 é€€å‡ºdebuggerå·¥å…·ã€‚ çœ‹æ˜¯å¦å¯ä»¥å°†EF_ALIGNMENTè®¾ç½®ä¸º0ï¼Œé‡å¤æ­¥éª¤2ã€‚ æœ‰æ—¶è¿™å°†æ˜¯å¤ªå¤šçš„å·¥ä½œï¼Œæˆ–è€…åœ¨åº“ä¾‹ç¨‹ä¸­ä¼šæœ‰é—®é¢˜ï¼Œè€Œæ‚¨æ²¡æœ‰æºï¼Œè¿™å°†é˜»æ­¢æ‚¨è¿™æ ·åšã€‚  åŸç†ã€åŠŸèƒ½ å­—èŠ‚å¯¹é½å’Œæº¢å‡ºæ£€æµ‹ åœ¨malloc()æ“ä½œçš„å¯¹é½é™åˆ¶å’ŒElectric Fenceä½¿ç”¨çš„è°ƒè¯•ç­–ç•¥ä¹‹é—´å­˜åœ¨å†²çªã€‚\nmallocåˆ†é…æ˜¯æŒ‰ç…§å­—èŠ‚å¯¹é½çš„ï¼Œä½†æ˜¯Electric Fenceçš„åˆ†é…è‡³å°‘æ˜¯ä¸¤ä¸ªè™šæ‹Ÿé¡µæˆ–è€…æ›´å¤šï¼Œå¹¶ä¸”æœ€åä¸€é¡µè¢«è®¾ç½®ä¸ºä¸å¯è¯»å†™ï¼Œå³è¿”å›çš„åœ°å€ä¸ºä¸å¯è¯»å†™çš„çš„ç¬¬ä¸€ä¸ªbyteåœ°å€å‡å»ç”³è¯·çš„å†…å­˜å¤§å°ã€‚å› æ­¤ï¼Œä»»ä½•åˆ†é…ç©ºé—´çš„æº¢å‡ºå°†å¯¼è‡´ segmentation faultã€‚\nå¦‚æœElectric Fence malloc()è¦è¿”å›å¯¹é½åœ°å€ï¼Œåˆ™å¿…é¡»å°†åˆ†é…çš„å¤§å°å¢åŠ åˆ°wordå¤§å°çš„å€æ•°ã€‚ æ­¤å¤–ï¼Œå‡½æ•°memalign()å’Œvalloc()å¿…é¡»éµå®ˆå†…å­˜åˆ†é…å¯¹é½çš„æ˜¾å¼è§„èŒƒï¼Œè¿™ä¹Ÿåªèƒ½é€šè¿‡å¢åŠ åˆ†é…çš„å¤§å°æ¥å®ç°ã€‚ å› æ­¤ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå†…å­˜åˆ†é…çš„æœ«å°¾åŒ…å«ä¸€äº›å¡«å……ç©ºé—´ï¼Œå¹¶ä¸”ä¸ä¼šæ£€æµ‹åˆ°è¯¥å¡«å……ç©ºé—´çš„è®¿é—®ï¼Œå³ä½¿å®ƒä»¬æ˜¯è¶…æ”¯çš„ã€‚(å­˜åœ¨æ¼åˆ¤ï¼Ÿ)\nElectric Fenceæä¾›äº†å˜é‡EF_ALIGNMENTï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥æ§åˆ¶malloc()ã€calloc()å’Œrealloc()ä½¿ç”¨çš„é»˜è®¤å¯¹é½æ–¹å¼ã€‚\n è‹¥è¦è°ƒè¯•å°åˆ°å•å­—èŠ‚çš„æº¢å‡ºï¼Œå¯ä»¥å°†EF_ALIGNMENTè®¾ç½®ä¸ºé›¶\n Efenceæœ‰2ä¸ªä¸»è¦çš„åŠŸèƒ½ï¼š\n å†…å­˜è¶Šç•Œè¯»å†™æ—¶æŠ›å‡ºsegmentation faultã€‚å½“ç¨‹åºç”¨mallocç”³è¯·å†…å­˜æ—¶ï¼ŒEfenceä¼šä½¿ç”¨è™šæ‹Ÿå†…å­˜æŠ€æœ¯å°†åˆ†é…çš„å†…å­˜ç©ºé—´ä¹‹åçš„å†…å­˜é¡µé¢è®¾ç½®ä¸ºinaccessible(ä¸å¯è¯»å†™å’Œæ‰§è¡Œ)ï¼Œæ‰€ä»¥å½“ç¨‹åºå‘ç”Ÿè¶Šç•Œè¯»å†™æ—¶ï¼ŒOSä¼šå‘å‡ºSIGSEGVä¿¡å·ï¼Œç”Ÿæˆcoreæ–‡ä»¶(core dump)ï¼Œè¿›ç¨‹é€€å‡ºã€‚ å½“è®¿é—®å·²ç»è¢«é‡Šæ”¾çš„å†…å­˜ç©ºé—´æ—¶æŠ›å‡ºsegmentation faultã€‚å½“ç¨‹åºæŠŠä¸€å—ç©ºé—´freeä¹‹åï¼ŒEfenceåŒæ ·æŠŠè¿™å—å†…å­˜çš„è®¿é—®ä¿æŠ¤çº§åˆ«è®¾ç½®ä¸ºinaccessibleï¼Œæ‰€ä»¥å½“ç¨‹åºå†æ¬¡è®¿é—®è¿™å—å·²ç»é‡Šæ”¾çš„å†…å­˜æ—¶ä¹Ÿä¼šå¯¼è‡´segmentation faultã€‚  æ€§èƒ½ å†…å­˜æ¶ˆè€— ç”±äºElectric Fenceåœ¨æ¯ä¸ªåˆ†é…ä¸­è‡³å°‘ä½¿ç”¨ä¸¤ä¸ªè™šæ‹Ÿå†…å­˜é¡µé¢ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå¯æ€•çš„å†…å­˜å ç”¨ã€‚ æˆ‘æœ‰æ—¶å‘ç°æœ‰å¿…è¦ä½¿ç”¨swaponï¼ˆ8ï¼‰æ·»åŠ ä¸€ä¸ªäº¤æ¢æ–‡ä»¶ï¼Œè¿™æ ·ç³»ç»Ÿå°±æœ‰è¶³å¤Ÿçš„è™šæ‹Ÿå†…å­˜æ¥è°ƒè¯•æˆ‘çš„ç¨‹åºã€‚\né€Ÿåº¦ åœ¨å¯¹å„ç§ç¼“å­˜å’Œè½¬æ¢ç¼“å†²åŒºè°ƒç”¨mallocå’Œfreddçš„æ“ä½œå†…å­˜çš„æ–¹å¼ã€‚å°†å¯¼è‡´æ…¢å¹¶ä¸”ç”¨æ›´å¤šçš„èµ„æºã€‚\nä¼˜ç‚¹å’Œç¼ºç‚¹ ä¼˜ç‚¹  ä¸éœ€è¦æ‚¨å¯¹ç¨‹åºçš„æºä»£ç è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚æ‚¨åªéœ€è¦åœ¨ç¼–è¯‘æœŸé—´å°†ç¨‹åºä¸å·¥å…·çš„åº“é“¾æ¥å³å¯ã€‚ è°ƒè¯•å·¥å…·çš„å®ç°æ–¹å¼å¯ç¡®ä¿åœ¨å¯¼è‡´è¾¹ç•Œå†²çªçš„ç¬¬ä¸€æ¡æŒ‡ä»¤ä¸Šäº§ç”Ÿåˆ†æ®µé”™è¯¯ï¼Œè¿™æ€»æ˜¯æ¯”åœ¨ä»¥åé˜¶æ®µå‘ç°é—®é¢˜è¦å¥½ã€‚  ç¼ºç‚¹   ä»…æ”¯æŒLinuxï¼Œéè·¨å¹³å°\n  æ¯ä¸€æ¬¡åˆ†é…éƒ½æ˜¯åˆ©ç”¨ä¸€ä¸ª semaphore åŒæ­¥ï¼Œæ²¡æœ‰ thread local çš„åˆ†é…\n  malloc å’Œ free åœ¨ slot éƒ½æ˜¯çº¿æ€§æŸ¥æ‰¾ï¼Œè¿™ä¹Ÿé€ æˆäº†æ•´ä½“æ€§èƒ½çš„è½å\n  å†…å­˜æ¶ˆè€—å¤§ï¼Œç‰¹åˆ«å¯¹äºé¢‘ç¹çš„å°å†…å­˜åˆ†é…\nreal_size = user_size + (alignment â€“ (user_size % alignment )) + page_size   è¯¥å·¥å…·æ— æ³•æ£€æµ‹åˆ°åˆ†é…ç»™æ ˆçš„å†…å­˜æº¢å‡º\n  ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚\n  å¦ä¸€ä¸ªå±€é™æ€§æ˜¯å®ƒä¸èƒ½æ˜ç¡®åœ°æŒ‡å‡ºé—®é¢˜å‡ºåœ¨ç¨‹åºä»£ç ä¸­çš„ä»€ä¹ˆä½ç½®-å®ƒæ‰€åšçš„åªæ˜¯åœ¨æ£€æµ‹åˆ°ä¸å†…å­˜ç›¸å…³çš„é”™è¯¯æ—¶å°±äº§ç”Ÿåˆ†æ®µé”™è¯¯ã€‚\nåªèƒ½é…åˆdbugå·¥å…·è¿›è¡Œåˆ†æå…·ä½“ä½ç½®ã€‚\n  ä¸èƒ½æ£€æµ‹å†…å­˜æ³„æ¼\n  å‚è€ƒé“¾æ¥ï¼š\n https://www.cnblogs.com/jingzhishen/p/6025702.html?utm_source=itdadao\u0026amp;utm_medium=referral https://blog.csdn.net/chessinge/article/details/6743764 https://linux.die.net/man/3/efence http://www.bubuko.com/infodetail-2434473.html https://www.computerworld.com/article/3003957/review-5-memory-debuggers-for-linux-coding.htm  ","description":"Electric Fenceæ˜¯å¦ä¸€ç§mallocï¼ˆï¼‰è°ƒè¯•å™¨ã€‚å®ƒä½¿ç”¨ç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜ç¡¬ä»¶æ¥æ£€æµ‹è½¯ä»¶ä½•æ—¶è¶…å‡ºäº†mallocï¼ˆï¼‰ç¼“å†²åŒºçš„è¾¹ç•Œã€‚å®ƒè¿˜å°†æ£€æµ‹freeï¼ˆï¼‰é‡Šæ”¾çš„ä»»ä½•å†…å­˜è®¿é—®ã€‚","id":49,"section":"posts","tags":["MLK"],"title":"Eletric-Fence","uri":"https://hugo.jiahongw.com/zh/posts/mlk/eletric-fence/"},{"content":"Dbgmem DBGMEMæ˜¯ç”¨äºCå’ŒC ++ç¨‹åºçš„åŠŸèƒ½ä¸°å¯Œçš„å†…å­˜è°ƒè¯•å™¨ã€‚ç›®å‰ä»…é€‚ç”¨äºLinuxã€‚\nåŸºæœ¬ä»‹ç» å®˜ç½‘ï¼š http://dbgmem.sourceforge.net/\næºç ï¼š https://sourceforge.net/p/dbgmem/code/HEAD/tree/\n Github: https://github.com/MoserMichael/cstuff\n æ–‡æ¡£ï¼š http://dbgmem.sourceforge.net/README.html\næ”¯æŒ ä½¿ç”¨Perlç¼–å†™ï¼Œåªæ”¯æŒLinuxã€‚\nå®‰è£…   è§£å‹\n1 2  tar xvfz DBGMEM.tar.gz . cd dbgmem     æ„å»ºæµ‹è¯•é›†\n1  ./make     ä¹Ÿå¯ä»¥æ„å»ºcppç‰ˆæœ¬çš„æµ‹è¯•é›†(å°šæœ‰é—®é¢˜)\n1  ./make cpp     å®‰è£…åˆ° /usr/local/dbgmem\n  1  ./make install   ä½¿ç”¨ åŸºæœ¬åŠŸèƒ½ è¯¥å·¥å…·å°†è¦†ç›–GLIBCå†…å­˜åˆ†é…åŠŸèƒ½ï¼Œå†…å­˜å’Œå­—ç¬¦ä¸²å¤„ç†åŠŸèƒ½ï¼Œä»¥æ·»åŠ å…¶åŠŸèƒ½ã€‚\nåŸºæœ¬ä½¿ç”¨æ–¹æ³•  ä»…å†…å­˜æ³„æ¼æ£€æµ‹ä½¿ç”¨å‚æ•°ï¼š-d simple ï¼›å†…å­˜æ£€æµ‹+å†…å­˜æ£€æŸ¥ä½¿ç”¨å‚æ•°ï¼š-d check å°†å†…å­˜é”™è¯¯é™„åŠ åˆ°è¯¥ç¨‹åºçš„dbgä¸Šæ·»åŠ å‚æ•°ï¼š-a gdb å¯¹äºå†…å­˜åˆ†é…ï¼Œæœ€å¤šçºªå½•nå±‚æ ˆå¸§å¯ä»¥ä½¿ç”¨å‚æ•°ï¼š-s n (ä¾‹å¦‚çºªå½•7å±‚æ ˆå¸§:-s 7) å°†åˆ†é…å’Œé‡Šæ”¾çš„å†…å­˜åˆå§‹åŒ–ä½¿ç”¨å‚æ•°ï¼š-b  åŸºç¡€è¦æ±‚ï¼š\n ä¸ä½¿ç”¨-Oé€‰é¡¹ï¼Œæˆ–è€…åŒæ—¶ä½¿ç”¨-Oå’Œ-fno-omit-frame-pointer å¿…é¡»åŠ ä¸Š-gé€‰é¡¹ã€‚ ä¸èƒ½ä½¿ç”¨é™æ€é“¾æ¥ç¼–è¯‘ã€‚ä¾‹å¦‚-static-libgccæˆ–-static é“¾æ¥é€‰é¡¹ã€‚ åœæ­¢ç¨‹åºé€šè¿‡ä¿¡å·å¿…é¡»ä¿è¯ä¿¡å·æ²¡æœ‰è¢«æ³¨å†Œã€‚  åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼š\næ—¥å¿—æ–‡ä»¶åŒ…æ‹¬ä¸‹é¢ä¸‰ä¸ªéƒ¨åˆ†ï¼š\n è¿”å›ä¿¡æ¯ å†…å­˜é”™è¯¯æŠ¥å‘Š å†…å­˜æ³„æ¼æŠ¥å‘Š  é€‰é¡¹ æ‰€æœ‰å·¥å…·å…±æœ‰çš„é€‰é¡¹ æŠ¥å‘Š åœ¨ç¨‹åºé€€å‡ºæ—¶æˆ–åº”ç”¨ç¨‹åºè¯·æ±‚æ—¶ç”ŸæˆåŒ…å«åˆ†é…æ—¶æ‰€æœ‰å†…å­˜å—åŠæ ˆçš„åˆ†é…æ—¶é—´è·Ÿè¸ªï¼›åŒæ—¶æ£€æŸ¥æ‰€æœ‰å†…å­˜å—æ˜¯å¦æº¢å‡ºã€‚\næ£€æŸ¥ åº”ç”¨ç¨‹åºå¯ä»¥è°ƒç”¨æœåŠ¡å‡½æ•°æ¥æ£€æŸ¥æ‰€æœ‰å†…å­˜å—æ˜¯å¦æº¢å‡ºã€‚æˆ–è€…æ‰“å°å‡ºæ‰€æœ‰å †å†…å­˜å—ï¼›æˆ–è€…ï¼Œè¯¥å·¥å…·å…è®¸æ‚¨ä¸ºæ¯ä¸ªä»»åŠ¡å®‰è£…ä¸¤ä¸ªä¿¡å·å¤„ç†ç¨‹åºã€‚\né”™è¯¯å¤„ç† æ¯å½“é‡åˆ°å†…å­˜é”™è¯¯æ—¶ï¼Œäº‹ä»¶éƒ½ä¼šè¢«è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶å’Œæ ‡å‡†é”™è¯¯æµä¸­ï¼›æ‚¨å¯ä»¥é€‰æ‹©ä¸‹é¢å‡ ç§æ“ä½œè¿›è¡Œå¤„ç†ï¼š\n ç»§ç»­æ‰§è¡Œ Dump core å°†gdbè°ƒè¯•å™¨é™„åŠ åˆ°å½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹  é’©å­ è¯¥å·¥å…·hooksä»¥ä¸‹GLIBCå‡½æ•°ï¼Œå¹¶è·Ÿè¸ªç”±å®ƒä»¬è¿”å›çš„åŠ¨æ€åˆ†é…çš„å†…å­˜\n malloc calloc realloc memalign posix_memalign valign free strdup strndup getcwd new/new[]/delete/delete[] (for C++ version only) malloc_usable_size returns size of requested block.  å¡«å……æ¨¡å¼å€¼ (æœ‰ä¸€ä¸ªé€‰é¡¹-bå¡«å……)\n åˆå§‹åŒ–æ‰€æœ‰åˆ†é…çš„å †å†…å­˜â€”â€”ç”¨0xDDå¡«å…… æ‰€æœ‰é‡Šæ”¾çš„å†…å­˜â€”â€”ç”¨0xFFå¡«å……  è¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç‰¹æ€§ï¼Œä½¿ç”¨å·²é‡Šæ”¾çš„å†…å­˜æˆ–è€…æˆ–è€…æœªå‡ºä¸–åçš„å†…å­˜å°†å¯¼è‡´ç¨‹åºé”™è¯¯ï¼Œä¸å¼€å¯å°†å¯¼è‡´æœªè¢«å‘ç°ã€‚ å¦‚æœå·²é‡Šæ”¾/æœªåˆå§‹åŒ–å†…å­˜åŒ…å«ä¸€ä¸ªæŒ‡é’ˆï¼Œåˆ™å–æ¶ˆå¼•ç”¨è¯¥æŒ‡é’ˆå°†å¯¼è‡´ core dump.ã€‚\nä¿¡å·å¤„ç† æœ‰ä¸€ä¸ªé€‰é¡¹å¯ä»¥å®‰è£…SIGSEGV/SIGBUSä¿¡å·å¤„ç†ç¨‹åºï¼Œè¯¥å¤„ç†ç¨‹åºè¿˜å¯ä»¥æ£€æŸ¥æ‰€æœ‰å †å—æ˜¯å¦è¦†ç›–/è¶Šç•Œå†™ã€‚\nå¹¶è¡Œè°ƒè¯• æ‚¨å¯ä»¥è¿è¡Œä¸€ä¸ªé€‰é¡¹-a dbgï¼Œè¯¥é€‰é¡¹å°†ç¨‹åºä¸è°ƒè¯•ç¨‹åºå¹¶è¡Œè°ƒç”¨ï¼Œä»¥ä¾¿å®ƒä¸“é—¨ç›‘è§†è°ƒè¯•è¿‡ç¨‹çš„å†…å­˜æ¶ˆè€—ã€‚\nsimpleå·¥å…·  ä½¿ç”¨-d simple é€‰é¡¹\n  åœ¨æœ€å°å¼€é”€çš„å®æ—¶ç³»ç»Ÿä¸­ç²¾ç¡®å®šä½å’Œè·Ÿè¸ªå†…å­˜æ³„æ¼ï¼›ï¼Ÿï¼Ÿä¸ºä»€ä¹ˆæ˜¯æœ€å°å¼€é”€ï¼Œä»€ä¹ˆåŸç†å‘¢ï¼Ÿ åœ¨åˆ†é…çš„å—ä¹‹å‰å’Œåˆ†é…çš„å—ä¹‹åï¼Œåœ¨å¤´ä¸­ä¿å­˜é¢å¤–çš„å†…åŠ¡ä¿¡æ¯(housekeeping information)ï¼Œå› æ­¤å †é”™è¯¯æ£€æŸ¥å¹¶ä¸æ€»æ˜¯å®Œç¾çš„ï¼›æ£€æŸ¥å·¥å…·æ›´å¥½åœ°æ”¯æŒè¿™äº›æƒ…å†µ æ£€æŸ¥åŒé‡Šæ”¾å’Œé‡Šæ”¾æœªåˆ†é…çš„å†…å­˜ã€‚  checkå·¥å…·  ä½¿ç”¨-d checké€‰é¡¹\n   é«˜æ•ˆåœ°æ£€æŸ¥å †æŸåï¼Œç²¾ç¡®å®šä½å’Œè·Ÿè¸ªæ´»ç³»ç»Ÿä¸­çš„å†…å­˜æ³„æ¼ï¼Œè·Ÿè¸ªå®æ—¶ç³»ç»Ÿä¸­çš„å†…å­˜æ³„æ¼ï¼Œåœ¨åŒ¿åå…±äº«å†…å­˜æ®µä¸­ï¼Œå†…åŠ¡ä¿¡æ¯è¢«ä¿å­˜åœ¨å †ä¹‹å¤–ï¼Œå› æ­¤å †æ£€æŸ¥åœ¨è¿™é‡Œæ›´å¥½ï¼Œå°½ç®¡é€Ÿåº¦æœ‰ç‚¹æ…¢\n  æ£€æŸ¥é‡Šæ”¾æœªåˆ†é…çš„å†…å­˜ã€‚\n  å¯¹äºä¸€ç»„æ ‡å‡†åº“å‡½æ•°ï¼Œè¿˜æ£€æŸ¥ä»¥ä¸‹é”™è¯¯\n  å—ä¿æŠ¤çš„ä¸€ç»„å‡½æ•°ä¸­çš„å †è¶Šç•Œå†™\n  Reading past allocated heap memory range\n  æ ˆsmashï¼ˆæœ‰é™çš„æ”¯æŒï¼Œåªæœ‰å½“æ‚¨ç²‰ç¢å‡½æ•°è¿”å›åœ°å€æ—¶ï¼Œæ£€æŸ¥æ‰è§¦å‘ï¼‰è¢«æ£€æŸ¥çš„å‡½æ•°é›†\næ£€æŸ¥å‡½æ•°çš„é›†åˆï¼š memcpyã€memmoveã€memsetã€strncpyã€strcatã€strncatã€strcmpã€strncmp\n    åŸç† æœ¯è¯­ ä¸€ä¸ªç¨‹åºçš„ä¸åŒé˜¶æ®µï¼š\n[--- INITIALIZATION ---] [--- ACTIVE STAGE ---] [--- SHUTDOWN ---] [--- EXIT ---] INITIALIZATION ç¨‹åºåˆå§‹åŒ–ã€‚é€šå¸¸åœ¨è¿™é‡Œè¯»å–é…ç½®ï¼Œåˆå§‹åŒ–ç¼“å­˜ï¼Œå¹¶åˆ›å»ºå’Œåˆå§‹åŒ–æ•´ä¸ªè¿›ä¸€æ­¥é˜¶æ®µä½¿ç”¨çš„å¯¹è±¡å’Œèµ„æºã€‚\nACTIVE STAGE è¿™ä¸ªè¿‡ç¨‹æ˜¯æœåŠ¡è¯·æ±‚ï¼Œå¹¶åšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…ï¼š\n åœ¨æ­¤é˜¶æ®µï¼Œè¿›ç¨‹å®Œæˆä¸€ä¸ªæˆ–å¤šä¸ªé€»è¾‘å¤„ç†å•å…ƒã€‚ æ¯ä¸ªè¿™æ ·çš„å•å…ƒå¯ä»¥æ˜¯å¤„ç†æ¥è‡ªç½‘ç»œçš„è¯·æ±‚æˆ–ä¸€ç³»åˆ—è¯·æ±‚ã€å¤„ç†æ‰¹å¤„ç†æ•°æ®ä½œä¸šæˆ–å¤„ç†äº¤äº’å¼ç”¨æˆ·è¯·æ±‚ã€‚   é€šå¸¸ï¼Œåœ¨å¤„ç†æŸäº›èµ„æºå’Œå†…å­˜çš„æ¯ä¸ªé€»è¾‘å•å…ƒæœŸé—´éƒ½ä¼šåˆ†é…ç„¶åé‡Šæ”¾æˆ–è€…ç›´æ¥æ³„æ¼ã€‚\n SHUTDOWN è¿›ç¨‹å·²ç»æ”¶åˆ°ä¸€ä¸ªä¿¡å·ï¼Œç„¶åå°†é€€å‡ºã€‚è¿™ä¸ªè¿‡ç¨‹æ­£åœ¨æ¸…ç†ç¼“å­˜ï¼Œå¹¶ä¸”æ­£åœ¨é‡Šæ”¾èµ„æºã€‚\n è¿™æ˜¯ä¸€ä¸ªå¸¸è§ä½†å¯é€‰çš„é˜¶æ®µ\n EXIT ç¨‹åºé€€å‡ºã€‚\nå†…å­˜æ³„æ¼çš„åŸå› (Nice)  æ³„æ¼æ˜¯æ˜¯æŒ‡ä¸€ç§èµ„æºå®ƒåœ¨è¿›ç¨‹çš„å®é™…çŠ¶æ€ä¸­è¢«åˆ†é…å¹¶ä¸”æ²¡æœ‰é‡Šæ”¾ã€‚\n ä¸‹é¢æ˜¯å‡ ç§å†…å­˜æ³„æ¼ï¼š\n  ç®€å•çš„å†…å­˜æ³„æ¼ï¼šèµ„æºè¢«åˆ†é…ç„¶åå¿˜è®°é‡Šæ”¾äº†ã€‚\n  åç¼“å­˜æ³„æ¼ï¼šå¦‚æœå¯¹è±¡æ€»æ˜¯æ·»åŠ åˆ°ç¼“å­˜ä¸­ï¼Œå¹¶ä¸”é‡ç”¨è¯¥ç¼“å­˜ï¼Œåˆ™æ­¤æ¨¡å¼å¯èƒ½å¯¼è‡´æ³„æ¼ã€‚\n  å¼•ç”¨è®¡æ•°æ³„æ¼ï¼š\nå‚è€ƒè®¡æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„åƒåœ¾æ”¶é›†å½¢å¼ï¼Œé€šå¸¸åœ¨C/C++ç¨‹åºä¸­å®ç°ï¼›å­˜åœ¨æ½œåœ¨çš„é—®é¢˜ï¼Œå¦‚:\n  è®¡æ•°æ³„æ¼ï¼šåªæœ‰åœ¨é‡Šæ”¾æ‰€æœ‰æœªå®Œæˆçš„å¼•ç”¨æ—¶ï¼Œæ‰ä¼šé‡Šæ”¾å¼•ç”¨è®¡æ•°å¯¹è±¡ã€‚ å½“ä¸€ä¸ªå¯¹è±¡çš„è‡³å°‘ä¸€ä¸ªå¼•ç”¨ä»ç„¶å­˜åœ¨æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿæ³„æ¼ï¼Œå› ä¸ºä¸çŸ¥ä½•æ•…ï¼Œæˆ‘ä»¬å¿˜è®°æ¸…é™¤ä¸€ä¸ªçªå‡ºçš„å¯¹è±¡å¼•ç”¨ã€‚ å¦‚æœæ ¹å¯¹è±¡å¼•ç”¨æ‰€æœ‰å…¶ä»–å¯¹è±¡ï¼Œä½†å¿˜è®°æ¸…é™¤å…¶å¼•ç”¨ï¼Œåˆ™ç»å¸¸ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚\n è¯·æ³¨æ„ï¼Œè¿™ç±»ä¼¼äºåç¼“å­˜æ³„æ¼ã€‚ è¯·æ³¨æ„ï¼Œè¿™ç§æƒ…å†µç»å¸¸å‘ç”Ÿåœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå¦‚Javaã€‚\n   ç¯å½¢å¼•ç”¨ï¼šå¯¹è±¡Aå¼•ç”¨å¯¹è±¡Bï¼ŒBä¹Ÿå¼•ç”¨å¯¹è±¡Aï¼›ä¸ç®¡æ€æ ·ï¼Œå¯¹è±¡Aæ€»æ˜¯æœ‰æ¥è‡ªå¯¹è±¡Bçš„è‡³å°‘ä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥å®ƒæ°¸è¿œä¸ä¼šè¢«åˆ é™¤ã€‚\n    è§£å†³å†…å­˜æ³„æ¼çš„æ–¹æ³• åœ¨ä¸åŒæ—¶é—´ç‚¹æ‰€ä½œçš„ä¸¤ä»½æŠ¥å‘Šï¼š\nåœ¨å®ŒæˆSHUTDOWNæ—¶æœŸ  åœ¨è¿›ç¨‹æ­£å¸¸é€€å‡ºä¹‹å‰ï¼Œæ­¤æŠ¥å‘Šæ€»æ˜¯ç”±DBGMEMç”Ÿæˆï¼Œé™¤éè¿›ç¨‹è¢«SIGKILLä¿¡å·æ€æ­»\n æœ¬æŠ¥å‘Šåˆ—å‡ºäº†å¤§å¤šæ•°æ³„æ¼é—®é¢˜çš„èµ·æºï¼›åˆ†é…æ³„æ¼å†…å­˜å—çš„å †æ ˆè·Ÿè¸ªå°†ç»™æ‚¨ä¸€ä¸ªå¼ºæœ‰åŠ›çš„æç¤ºï¼Œè¯´æ˜å¦‚ä½•ä¿®å¤è¿™äº›é—®é¢˜ã€‚\n å¯¹äºä¸å¼•ç”¨è®¡æ•°ç›¸å…³çš„æŸäº›ç±»å‹çš„æ³„æ¼ï¼Œæ‚¨éœ€è¦æ›´å¤šçš„ä¿¡æ¯\n åœ¨SHUTDOWNä¹‹å‰å®ŒæˆACTIVE STAGEä¹‹å å¦‚æœæ‚¨æƒ³è·Ÿè¸ªå¼•ç”¨è®¡æ•°æ³„æ¼ï¼Œæ­¤é˜¶æ®µæ˜¯æœ‰ç”¨çš„ï¼š\né€šå¸¸ï¼Œå½“è¿™äº›å¼•ç”¨çš„æ ¹å¯¹è±¡è¢«åˆ é™¤æ—¶ï¼Œè¿™äº›æ³„æ¼çš„å¼•ç”¨åœ¨SHUTDOWNé˜¶æ®µè¢«åˆ é™¤ã€‚\nå½“è®¸å¤šå—å‘ç”Ÿåœ¨SHUTDOWNé˜¶æ®µä¹‹å‰çš„æŠ¥å‘Šä¸­ï¼Œä½†åœ¨EXITä¹‹å‰çš„æŠ¥å‘Šä¸­æ²¡æœ‰å‡ºç°æ—¶ï¼Œè¿™å¯èƒ½è¡¨ç¤ºæ³„æ¼ã€‚\n è¿™ä¸€åˆ†æä¸æ˜¯ç”±å·¥å…·å®Œæˆçš„ï¼Œè€Œæ˜¯ç”±çƒ­å¿ƒçš„è¯»è€…å®Œæˆçš„ï¼Œå½“ä»–æ¯”è¾ƒè¿™ä¸¤ä»½æŠ¥å‘Šæ—¶ï¼›çƒ­å¿ƒçš„è¯»è€…ä¹ŸæŒæ¡äº†ä»–çš„ç¨‹åºçš„å·¥ä½œåŸç†ï¼Œå¹¶å°†èƒ½å¤Ÿæ€»ç»“æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚\n ä¸¤ç§æ–¹æ³•è¿›å…¥ä¸‹é¢ä¸¤ä¸ªé˜¶æ®µï¼š\n INITIALIZATION and ACTIVE STAGE ACTIVE STAGE and SHUTDOWN stage  way1ï¼šå…è®¸dbgmemçš„å‘½ä»¤è¡Œé€‰é¡¹å»è®¾ç½®ä¸¤ä¸ªä¿¡å·å¤„ç†ï¼Œæ¯ä¸ªä¿¡å·å¤„ç†ç¨‹åºå°†æ‰§è¡Œè¯·æ±‚çš„çŠ¶æ€è½¬æ¢\nway2ï¼šä¿®æ”¹å·²è°ƒè¯•çš„ç¨‹åºï¼Œä»¥ä¾¿å®ƒè°ƒç”¨è°ƒè¯•åº“æ¥æŒ‡ç¤ºè¿™ä¸¤ä¸ªäº‹ä»¶ï¼›å¦‚æœæ‚¨å¸Œæœ›ä»å•å…ƒæµ‹è¯•/ç³»ç»Ÿæµ‹è¯•ä¸­è¿è¡ŒDBGMEMï¼Œåˆ™è¿™æ˜¯é¦–é€‰çš„è§£å†³æ–¹æ¡ˆã€‚\nç»„ä»¶ è¯¥å·¥å…·ç”±ä»¥ä¸‹ç»„ä»¶ç»„æˆï¼š\n /usr/mdbg/scripts/runè„šæœ¬ï¼šè¯¥è„šæœ¬è¿è¡Œè°ƒè¯•ç¨‹åºã€‚ åº“/usr/local/dbgmem/lib/libdmemc.soå’Œ/usr/mdbg/lib/libdmems.soï¼šæ¯ä¸ªå…±äº«åº“éƒ½æ˜¯å†…å­˜è°ƒè¯•å·¥å…·ä¸­çš„ä¸€ä¸ªé™·å…¥ã€‚ åº“/usr/local/dbgmem libdmems.soå®ç°äº†åœ¨æ¯ä¸ªåˆ†é…ä¸­æ·»åŠ arena headerçš„ç®€å•å·¥å…·  ä¸‹ä¸€ä¸ª/å…ˆå‰çš„å—æŒ‡é’ˆ ä½•æ—¶åˆ†é…å—çš„å †æ ˆ å—å¤§å° ç”Ÿæˆæ ‡ç­¾å€¼ç±» + ä¸€äº›åˆ†é…å‡½æ•°(malloc/new/new[]) åœ¨ä¿¡æ¯å—ä¹‹åï¼Œåœ¨ç”¨æˆ·åˆ†é…å—ç»“æŸåï¼Œä¸€ä¸ªsize of(void*)ä¿æŠ¤åŒºåŸŸæ˜¯kepsï¼Œå®ƒç”±å“¨å…µå€¼åˆå§‹åŒ–ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æ£€æŸ¥å†…å­˜è¦†ç›–/è¦†ç›–ã€‚   åº“ /usr/local/dbgmem/lib/libdmems.soï¼šå®ç°äº†æ›´å¤æ‚çš„æ£€æŸ¥å·¥å…· åœ¨è¢«è°ƒè¯•çš„è¿›ç¨‹é€€å‡ºä¹‹åï¼Œnoteate.plè„šæœ¬å°†ç”±è¿è¡Œè„šæœ¬å¯åŠ¨ã€‚ è„šæœ¬/usr/mdbg/scripts/annotate.plè¯»å–åŸå§‹æŠ¥å‘Šå¹¶åˆ›å»ºæœ€ç»ˆæŠ¥å‘Š  ä¼˜ç‚¹å’Œç¼ºç‚¹ ä¼˜ç‚¹  ä½¿ç”¨ç®€å•ï¼Œç›´æ¥å‘½ä»¤è¡Œä½¿ç”¨ã€‚ å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œæ£€æµ‹ã€‚  ç¼ºç‚¹  å­˜åœ¨è¯¯åˆ¤ï¼Œä¸€äº›å†…å­˜é”™è¯¯åˆ¤æ–­æˆå†…å­˜æ³„æ¼ã€‚ ä»…æ”¯æŒLinux  ","description":"DBGMEMæ˜¯ç”¨äºCå’ŒC ++ç¨‹åºçš„åŠŸèƒ½ä¸°å¯Œçš„å†…å­˜è°ƒè¯•å™¨ã€‚ç›®å‰ä»…é€‚ç”¨äºLinuxã€‚","id":50,"section":"posts","tags":["MLK"],"title":"Dbgmem","uri":"https://hugo.jiahongw.com/zh/posts/mlk/dbgmem/"},{"content":"AddressSanitizer åŸºæœ¬ä»‹ç» å®˜ç½‘ï¼šhttp://clang.llvm.org/docs/AddressSanitizer.html\næºç ï¼šhttps://github.com/google/sanitizers\næ–‡æ¡£ï¼šhttps://github.com/google/sanitizers/wiki/AddressSanitizer\næ”¯æŒ                 OS x86 x86_64 ARM ARM64 MIPS MIPS64 PowerPC PowerPC64   Linux yes yes   yes yes yes yes   OS X yes yes         iOS Simulator yes yes         FreeBSD yes yes         Android yes yes yes yes        å®‰è£… llvm==3.4.2ï¼Œyum -y install clang \u0026amp;\u0026amp; yum -y install gcc gcc-c++  GCC4.8ä¹‹åç›´æ¥æä¾›äº†å¯¹è¿™ä¸ªå·¥å…·çš„æ”¯æŒ\n ä½¿ç”¨ åŸºæœ¬è¦æ±‚  llvm\u0026gt;3.1ï¼Œclangç¼–è¯‘ ç¼–è¯‘æ—¶ä¸å…è®¸ä½¿ç”¨-staticå‚æ•°ï¼ˆä¸æ”¯æŒé™æ€é“¾æ¥ï¼‰ å°½é‡ä¸åŠ -O2å’Œ-O1ï¼ˆå®æµ‹æ£€æµ‹ä¼šå¤±æ•ˆï¼Œå…·ä½“é¡¹å¾…éªŒè¯ï¼‰ Clangä¸gccä¸èƒ½æ··ç”¨ç¼–è¯‘æˆ–é“¾æ¥  åŸºæœ¬ä½¿ç”¨æ–¹æ³• é€‰é¡¹  ç”¨-fsanitize=addressé€‰é¡¹ç¼–è¯‘å’Œé“¾æ¥ä½ çš„ç¨‹åº; ç”¨-fno-omit-frame-pointerç¼–è¯‘ï¼Œä»¥åœ¨é”™è¯¯æ¶ˆæ¯ä¸­æ·»åŠ æ›´å¥½çš„å †æ ˆè·Ÿè¸ªã€‚ å¢åŠ -O1ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚ é¿å…ä½¿ç”¨ -Wl,-z,defsï¼Œå› ä¸ºå¯èƒ½ä¼šé€ æˆé“¾æ¥é”™è¯¯ è¦è·å¾—å®Œç¾çš„å †æ ˆè·Ÿè¸ªï¼Œæ‚¨å¯èƒ½éœ€è¦ç¦ç”¨å†…è”(åªä½¿ç”¨-O1)å’Œå°¾éƒ¨è°ƒç”¨æ¶ˆé™¤(-fno-optimize-sibling-call)  ä½¿ç”¨ ç®€å•å†…å­˜æ£€æŸ¥ä½¿ç”¨(ä¸åŒ…æ‹¬æ£€æŸ¥å†…å­˜æ³„æ¼)ï¼š\n1  clang -O1 -g -fsanitize=address -fno-omit-frame-pointer {testfile.c} -o {testfile}   å•ç‹¬æ£€æŸ¥å†…å­˜æ³„æ¼ï¼š\n1  clang -O1 -g -fsanitize=leak -fno-omit-frame-pointer {testfile.c} -o {testfile}   æ£€æŸ¥å†…å­˜é”™è¯¯å’Œå†…å­˜æ³„æ¼ï¼š\n1  clang -fsanitize=address -g {testfile.c} - o {testfile} ; ASAN_OPTIONS=detect_leaks=1 ./testfile   æœ€åæ‰§è¡Œç¨‹åº\n1  ./testfile   æ£€æŸ¥çš„é”™è¯¯ç±»å‹ åŸç† é˜´å½±å†…å­˜ å¸¸è§æ–¹æ³•æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯ç›´æ¥å°†å®é™…åœ°å€è¿›è¡Œç¼©æ”¾+åç§»æ˜ å°„åˆ°ä¸€ä¸ªshadowåœ°å€ï¼Œä»è€Œå°†æ•´ä¸ªçš„åº”ç”¨ç¨‹åºåœ°å€ç©ºé—´æ˜ å°„åˆ°ä¸€ä¸ªshadowåœ°å€ç©ºé—´ï¼›ä¸€ç§æ˜¯å¢åŠ é¢å¤–çš„åœ°å€è½¬æ¢è¡¨ï¼Œé€šè¿‡æŸ¥è¡¨å®Œæˆå®é™…åœ°å€åˆ°shadowåœ°å€çš„è½¬æ¢ã€‚æ¯”å¦‚Valgrindå’ŒDr.Memoryå°±æ˜¯å°†shadowåœ°å€åˆ†æˆå¤šä¸ªç‰‡æ®µï¼Œç„¶åé€šè¿‡æŸ¥æ‰¾è¡¨è½¬æ¢shadowåœ°å€ã€‚è€ŒAddressSanitizeråˆ™é‡‡ç”¨äº†ç›´æ¥ç¼©æ”¾+åç§»çš„æ–¹å¼ã€‚\n å…¸å‹çš„ç›´æ¥æ˜ å°„çš„æ–¹æ³•åŒ…æ‹¬TraintTraceå’ŒLIFT\nä½¿ç”¨å¤šçº§ç¿»è¯‘æ¨¡å¼ï¼Œä¾‹å¦‚Valgrindå’ŒDrMemoryã€‚å°†å®ƒä»¬çš„å½±å­å†…å­˜åˆ†æˆå‡ éƒ¨åˆ†ï¼Œå¹¶ä½¿ç”¨è¡¨æŸ¥æ‰¾æ¥è·å¾—å½±å­åœ°å€ï¼Œéœ€è¦é¢å¤–çš„å†…å­˜åŠ è½½ã€‚\nUmbraç»“åˆäº†çµæ´»çš„å¸ƒå±€å’Œé«˜æ•ˆæ€§ï¼Œé¿å…äº†éå‡åŒ€æŸ¥è¡¨å’ŒåŠ¨æ€ç¼©æ”¾ä»¥åŠåç§»æ¨¡å¼\nBoundlesså°†å…¶æŸäº›å…ƒæ•°æ®å­˜å‚¨åœ¨64ä½æŒ‡é’ˆçš„é«˜16ä½ä¸­ï¼Œä½†ä¼šåœ¨æ…¢é€Ÿè·¯å¾„ä¸Šå›é€€åˆ°æ›´ä¼ ç»Ÿçš„å½±å­å†…å­˜ã€‚\nLBCä½¿ç”¨å­˜å‚¨åœ¨åº”ç”¨ç¨‹åºå†…å­˜ä¸­çš„ç‰¹æ®Šå€¼æ‰§è¡Œå¿«é€Ÿè·¯å¾„æ£€æŸ¥ï¼Œå¹¶ä¾èµ–æ…¢é€Ÿè·¯å¾„ä¸Šçš„ä¸¤çº§å½±å­å†…å­˜\n é˜´å½±å†…å­˜æ˜ å°„\nå‡è®¾åº”ç”¨ç¨‹åºå†…å­˜åœ°å€ä¸ºAddrï¼Œé‚£ä¹ˆå…¶å¯¹åº”çš„Shadowåœ°å€ä¸º(Addr\u0026raquo;3)+Offsetã€‚å¦‚æœè™šæ‹Ÿåœ°å€ç©ºé—´çš„æœ€å¤§åˆæ³•åœ°å€ä¸ºMax-1ï¼Œé‚£ä¹ˆOffsetå€¼çš„é€‰æ‹©éœ€è¦ç¡®ä¿ä»Offsetåˆ°Offset+Max/8åœ¨å¯åŠ¨æ—¶ä¸ä¼šè¢«å ç”¨ã€‚å¯¹äºå¸¸è§çš„32ä½Linuxå’ŒMacOSç³»ç»Ÿæ¥è¯´ï¼Œå…¶è™šæ‹Ÿåœ°å€ç©ºé—´ä¸º0x00000000-0xffffffffï¼Œæˆ‘ä»¬ä»¤Offset = 0x20000000 (2^29)ã€‚å¯¹äºå…·æœ‰47ä¸ªåœ°å€ä½çš„64ä½ç³»ç»Ÿæ¥è¯´ï¼Œæˆ‘ä»¬ä»¤Offset =0x0000100000000000 (2^44)ã€‚\n Sanitizerç»´æŠ¤ç¨‹åºçš„æ‰€æœ‰åœ°å€è®¿é—®æƒé™ï¼Œç”¨äºåˆ¤æ–­å†…å­˜è®¿é—®æ˜¯å¦åˆæ³•ã€‚éœ€è¦å¼€è¾Ÿä¸€å®šçš„ç©ºé—´å­˜å‚¨é˜´å½±å†…å­˜ã€‚\n æ³¨æ„åˆ°mallocå‡½æ•°çš„è¿”å›åœ°å€éƒ½æ˜¯8å­—èŠ‚å¯¹é½çš„, æ‰€ä»¥å¯¹äºheapä¸Šçš„8å­—èŠ‚å†…å­˜ç©ºé—´, åªæœ‰9ç§çŠ¶æ€, åˆ†åˆ«è¡¨ç¤ºfirst k (0 \u0026lt;= k \u0026lt;= 8)æ˜¯å¦å¯ä»¥è®¿é—®, è€Œ9ç§çŠ¶æ€åªéœ€è¦1ä¸ªå­—èŠ‚å°±å¯ä»¥è¡¨ç¤º, ä¸¥æ ¼è¯´1å­—èŠ‚éƒ½ç”¨ä¸ç€, ä¹Ÿå°±æ˜¯è¯´åªä½¿ç”¨1/8çš„è™šæ‹Ÿåœ°å€ç©ºé—´çš„shadow memoryå°±å¯ä»¥æè¿°æ‰€æœ‰çš„åœ°å€ã€‚\né˜´å½±å†…å­˜çš„åœ°å€çš„æ˜ å°„è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š\nShadowAddr = (Addr \u0026gt;\u0026gt; 3) + Offset å›¾ç¤ºå¦‚ä¸‹æ‰€ç¤ºï¼š\n  å› ä¸ºshadow memoryæ”¾åœ¨äº†ä¸­é—´, æ‰€ä»¥ç”¨æˆ·çš„å†…å­˜ç©ºé—´åˆ†æˆäº†ä¸Šä¸‹2ä¸ªéƒ¨åˆ† shadow memoryæœ¬èº«ä¹Ÿä½¿ç”¨åŒæ ·çš„æ˜ å°„ç®—æ³•, ä½†æ˜¯shadow memoryä¼šæ˜ å°„åˆ°badåŒºåŸŸ, å› ä¸ºè¿™æ˜¯ASANæ·»åŠ çš„å†…å­˜åŒºåŸŸ, ç¨‹åºæ˜¯ä¸èƒ½è®¿é—®çš„ badåŒºåŸŸåœ¨é¡µè¡¨ä¸­æ˜¯ç¦æ­¢è®¿é—®çš„   ä¸Šé¢ç®€å•æè¿‡å¯¹é½çš„8å­—èŠ‚æœ‰9ç§çŠ¶æ€, åœ¨ASANçš„å®ç°ä¸­é‡‡ç”¨å¦‚ä¸‹ç¼–ç :\n 0 - è¯¥8å­—èŠ‚å‡å¯è®¿é—® k (1 \u0026lt;= k \u0026lt;= 7) - å‰kä¸ªå­—èŠ‚å¯è®¿é—® negative - è¯¥8å­—èŠ‚å‡ä¸å¯è®¿é—®  è´Ÿå€¼è¡¨ç¤ºæ‰€æœ‰8ä¸ªå­—èŠ‚éƒ½æ˜¯ä¸å¯è®¿é—®çš„ã€‚åŒæ—¶æˆ‘ä»¬é‡‡ç”¨ä¸åŒçš„è´Ÿå€¼æ¥æ ‡ç¤ºä¸åŒç±»å‹çš„ä¸å¯è®¿é—®åœ°å€ï¼š\nHeap left redzone: fa Heap righ redzone: fb Freed Heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ç»„æˆ  AddressSanitizer consists of two parts: an instrumentation module and a run-time library.\n AddressSanitizer åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šæŒ‡ä»¤æ¨¡å—å’Œè¿è¡Œæ—¶åº“ã€‚\nä»£ç æ’æ¡©æ¨¡å—(instrumentation) ä½œç”¨ï¼šä»£ç æ’æ¡©æ¨¡å—ä¼šå¯¹codeè¿›è¡Œä¿®æ”¹ä»¥åœ¨æ¯æ¬¡å†…å­˜è®¿é—®æ—¶æ£€æŸ¥shadow stateï¼ŒåŒæ—¶è´Ÿè´£åœ¨æ ˆå’Œå…¨å±€å¯¹è±¡å‘¨å›´åˆ›å»ºç”¨äºæ£€æµ‹overflowå’Œunderflowçš„poisoned redzonesã€‚\nåŸºäºLLVMç¼–è¯‘å™¨æŒ‡ä»¤é›†ã€‚\n å…¶ä»–å·¥å…·éƒ½ä¸èƒ½å‘ç°æ ˆæº¢å‡ºçš„é”™è¯¯ã€‚\n å‹å•†æ¯”è¾ƒ\n Mudflapä½¿ç”¨ç¼–è¯‘æ—¶æ£€æµ‹å› æ­¤èƒ½å¤Ÿæ£€æŸ¥å¯¹è±¡çš„è¶Šç•Œè®¿é—®ï¼Œä½†æ˜¯å› ä¸ºå¯¹è±¡ä¹‹é—´æ²¡æœ‰æ’å…¥çº¢è‰²åŒºåŸŸï¼Œæ‰€ä»¥ä¸èƒ½æ£€æŸ¥å‡ºæ‰€æœ‰çš„æ ˆæº¢å‡ºbug\nCCuredç¼–è¯‘æŒ‡ä»¤ä½¿ç”¨é™æ€åˆ†æ(ä»…Cç¨‹åº)æ¶ˆé™¤å¤šä½™çš„æ£€æŸ¥ï¼›å®ƒä»¬çš„æŒ‡ä»¤ä¸éæŒ‡ä»¤åº“ä¸å…¼å®¹ã€‚\nLBCä½¿ç”¨æºåˆ°æºçš„è½¬æ¢å’ŒåŸºäºCCuredå»æ¶ˆé™¤å¤šä½™çš„æ£€æŸ¥ã€‚(ä»…é™Cè¯­è¨€å’Œä¸èƒ½å¤„ç†use-after-free)\nInsure++ä¸»è¦ä¾é ç¼–è¯‘æ—¶å·¥å…·ï¼Œä½†ä¹Ÿä½¿ç”¨äºŒè¿›åˆ¶å·¥å…·ã€‚å®æ–½ç»†èŠ‚å°šæœªå…¬å¼€ã€‚\n Mudflapå°±æ˜¯é‡‡ç”¨çš„ç¼–è¯‘æ—¶ä»£ç æ’å…¥æŠ€æœ¯ï¼Œå› æ­¤å®ƒå¯ä»¥æ£€æµ‹åˆ°æ ˆå¯¹è±¡çš„è¶Šç•Œè®¿é—®ã€‚ä½†æ˜¯ï¼Œç”±äºå®ƒå¹¶æ²¡æœ‰åœ¨æ ˆå¸§ä¸Šçš„æ¯ä¸ªå¯¹è±¡ä¹‹é—´æ’å…¥redzoneï¼Œå› æ­¤æ— æ³•å‘ç°æ‰€æœ‰çš„æ ˆç¼“å†²åŒºæº¢å‡ºbugï¼ŒåŒæ—¶å¯¹äºå¤æ‚C++ä»£ç è¿˜å­˜åœ¨è¯¯æŠ¥çš„é—®é¢˜ã€‚AddressSanitizeré‡‡ç”¨äº†compile-time instrumentationï¼Œå› æ­¤å¯ä»¥å‘ç°æ ˆåŠglobalå¯¹è±¡çš„ç›¸å…³è¶Šç•Œè®¿é—®ã€‚\n æœ‰äº†shadow memoryä¹‹å, è¿˜éœ€è¦åœ¨è®¿é—®å†…å­˜çš„æ—¶å€™è¿›è¡Œæ£€æŸ¥, å¦‚æœæ˜¯å·²ç»ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶é—®é¢˜, å®ƒæ˜¯ä¸çŸ¥é“shadow memoryçš„, æ‰€ä»¥è¿™å°±éœ€è¦åœ¨ç¼–è¯‘çš„æ—¶å€™æ’å…¥ç›¸åº”çš„æŒ‡ä»¤, ä¹Ÿå°±æ˜¯è¯´å¿…é¡»å¸¦ä¸ŠASANç¼–è¯‘æ‰èƒ½ä½¿ç”¨åˆ°è¿™ä¸ªåŠŸèƒ½.\n ASANçš„æ£€æŸ¥æ¯”è¾ƒç®€å•(æ„å‘³ç€é«˜æ•ˆ), å¯¹äº8å­—èŠ‚å†…å­˜è®¿é—®åªéœ€è¦é¢å¤–çš„ä¸€æ¬¡å†…å­˜è®¿é—®:\nè®¿é—®8å­—èŠ‚å†…å­˜ï¼š\n1 2 3 4 5 6 7  byte *shadow_address = MemToShadow(address); byte shadow_value = *shadow_address; if (shadow_value) { if (SlowPathCheck(shadow_value, address, kAccessSize)) { ReportError(address, kAccessSize, kIsWrite); } }   è®¿é—®é8å­—èŠ‚å†…å­˜(1-, 2-, 4-byteçš„å†…å­˜è®¿é—®)ï¼š\n1 2 3 4 5 6  // Check the cases where we access first k bytes of the qword // and these k bytes are unpoisoned. bool SlowPathCheck(shadow_value, address, kAccessSize) { last_accessed_byte = (address \u0026amp; 7) + kAccessSize - 1; return (last_accessed_byte \u0026gt;= shadow_value); }   è¿™ä¸¤ç§æƒ…å†µéƒ½æ˜¯ä¸ºåŸå§‹ä»£ç ä¸­çš„æ¯ä¸€æ¬¡å†…å­˜è®¿é—®(è¯»\u0026amp;å†™)å¢åŠ äº†ä¸€æ¬¡å†…å­˜è¯»ã€‚\n è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯, å¯¹äºunaligned access(ä¸å¯¹é½çš„å†…å­˜è®¿é—®), ASANæœ‰å¯èƒ½æ£€æŸ¥ä¸å‡ºæ¥.\n é”™è¯¯æŠ¥å‘Šä»£ç (ReportAndCrash(Addr))æœ€å¤šåªä¼šè¢«æ‰§è¡Œä¸€æ¬¡{!AddressSanitizerçš„æœºåˆ¶æ˜¯ä¸€æ—¦æ£€æµ‹åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå°±ç›´æ¥æŠ¥å‘Šé”™è¯¯é€€å‡ºï¼Œè¿™æ ·åšçš„ç†ç”±æ˜¯å®ç°ç®€å•ï¼Œä¹Ÿå‡å°‘äº†è®°å½•æ‰€æœ‰é”™è¯¯çš„å¼€é”€}ï¼Œä½†æ˜¯ä¼šè¢«æ’å…¥åˆ°ä»£ç çš„å¾ˆå¤šåœ°æ–¹ï¼Œå› æ­¤éœ€è¦ç¡®ä¿å®ƒçš„ç´§å‡‘æ€§ã€‚\nå¦‚ä½•æ£€æµ‹æ ˆåŒºå’Œå…¨å±€å¯¹è±¡ï¼Ÿ\n å¯¹äºglobalsï¼Œåœ¨ç¼–è¯‘æ—¶åˆ›å»ºredzonesï¼Œåœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶å°†redzonesçš„åœ°å€ä¼ é€’ç»™è¿è¡Œæ—¶åº“ã€‚è¿è¡Œæ—¶åº“è®¾ç½®çº¢åŒºä¸å¯è®¿é—®å¹¶ä¸”è®°å½•åœ°å€ä»¥è¿›è¡Œè¿›ä¸€æ­¥çš„é”™è¯¯æŠ¥å‘Šã€‚ å¯¹äºæ ˆå¯¹è±¡ï¼Œçº¢åŒºè¢«åˆ›å»ºå’Œè®¾ç½®ä¸ºä¸å¯è®¿é—®åœ¨è¿è¡Œæ—¶ã€‚  ä¾‹å¦‚ç»™ä¸€ä¸ªç¨‹åºï¼š\n1 2 3 4  void foo() { char a[10]; \u0026lt;function body\u0026gt; }   å°†è¢«è½¬æ¢ä¸ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  void foo() { char rz1[32] char arr[10]; char rz2[32-10+32]; unsigned *shadow = (unsigned*)(((long)rz1\u0026gt;\u0026gt;8)+Offset); // poison the redzones around arr.  shadow[0] = 0xffffffff; // rz1  shadow[1] = 0xffff0200; // arr and rz2  shadow[2] = 0xffffffff; // rz2  \u0026lt;function body\u0026gt; // un-poison all.  shadow[0] = shadow[1] = shadow[2] = 0; }   è¿è¡Œæ—¶åº“(Run-time Libaray) ä½œç”¨ï¼šæ›¿æ¢mallocã€freeç­‰ç›¸å…³çš„å‡½æ•°ï¼Œå¹¶ä¸”åœ¨å †åŒºå‘¨å›´åˆ›å»ºç”¨äºæ£€æµ‹çš„poisoned redzonesï¼Œå»¶è¿Ÿå·²è¢«freeçš„å †ç©ºé—´çš„é‡ç”¨(æ­£å¸¸æƒ…å†µä¸‹ä¸ºæé«˜å†…å­˜ä½¿ç”¨ç‡ï¼Œå·²ç»è¢«freeçš„å†…å­˜æ˜¯å¯ä»¥è¢«é‡ç”¨çš„ï¼Œä½†æ˜¯å¯¹äºAddressSanitizeræ¥è¯´ï¼Œå› ä¸ºè¦æ£€æŸ¥use-after-freeé”™è¯¯ï¼Œå› æ­¤è¢«freeçš„ç©ºé—´ä¼šè¢«æ”¾åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œè¿™äº›æ¥ç¡®ä¿å·²è¢«freeçš„å†…å­˜å¦‚æœè¿˜ä¼šè¢«ä½¿ç”¨çš„è¯èƒ½å¤Ÿè¢«å‘ç°ï¼Œå½“ç„¶è¯¥é˜Ÿåˆ—è¿˜æ˜¯æœ‰ä¸€å®šçš„å¤§å°é™åˆ¶ï¼ŒæŒ‰ç…§FIFOçš„åŸåˆ™è¿›è¡Œé€€å‡º)ï¼ŒåŒæ—¶è¿˜ä¼šè´Ÿè´£æŠ¥å‘Šé”™è¯¯ã€‚\nä¸»è¦å·¥ä½œåŒ…æ‹¬:\n åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™, ç”³è¯·shadow memoryçš„ç©ºé—´. æ³¨æ„è¿™é‡Œæ˜¯è™šæ‹Ÿåœ°å€ç©ºé—´, å¹¶ä¸æ˜¯å®é™…çš„ç‰©ç†å†…å­˜, è®¾ç½®badåŒºåŸŸä¸ºä¸å¯è®¿é—® malloc/freeçš„é‡æ–°å®ç°  å…¶å®é€šè¿‡shadow memoryå’Œinstrumentationäº†, æˆ‘ä»¬å·²ç»å¯ä»¥æ£€æŸ¥å‡ºé‚£äº›å†…å­˜æ˜¯å¯ä»¥è®¿é—®çš„, é‚£ä¹ˆé‡æ–°å®ç°malloc/freeçš„ç›®çš„æ˜¯ä»€ä¹ˆ?\n é¦–å…ˆ, åˆæ³•è®¿é—®ä¸ä»£è¡¨æ˜¯æ­£ç¡®çš„è®¿é—®, æ¯”å¦‚2æ¬¡mallocè¿”å›è¿ç»­çš„åœ°å€, é‚£ä¹ˆout-of-boundså°±å¯èƒ½è®¿é—®åˆ°å¦å¤–ä¸€ä¸ªåˆæ³•çš„å†…å­˜. å¦‚æœ2æ¬¡mallocçš„å†…å­˜ä¸­é—´åŠ ä¸Šredzone, é‚£ä¹ˆå°±å¯ä»¥å°½é‡æŠ“ä½è¿™ç§æƒ…å†µ. redzoneæœ¬èº«æ˜¯ä¸ä¼šè¢«ç¨‹åºå†™åçš„, å› ä¸ºåœ¨å†™ä¹‹å‰å°±å·²ç»å‘ç°è¿™æ˜¯ä¸€æ¬¡éæ³•è®¿é—®äº† redzoneå¯ä»¥ç”¨æ¥è®°å½•ä¸€äº›é¢å¤–çš„ä¿¡æ¯, æ¯”å¦‚mallocçš„è°ƒç”¨æ ˆ (freeçš„è°ƒç”¨æ ˆç›´æ¥è®°å½•åœ¨å†…å­˜åŒºåŸŸ)  å¦å¤–, å¦‚æœfreeçš„å†…å­˜é‡æ–°è¢«åˆ«äººmallocäº†, é‚£ä¹ˆuse-after-free, double freeå¯èƒ½ä¸èƒ½åŠæ—¶æ£€æŸ¥å‡ºæ¥, æ‰€ä»¥åœ¨freeçš„æ—¶å€™å°½é‡é¿å…è¯¥å†…å­˜é‡æ–°è¢«mallocå‡ºæ¥.\n ä»æ•´ä½“ä¸Šçœ‹ï¼ŒAddressSanitizeré‡‡ç”¨çš„æ–¹æ³•ç±»ä¼¼äºåŸºäºValgrindçš„å·¥å…·AddrCheckï¼šé‡‡ç”¨Shadow Memoryæ¥è®°å½•åº”ç”¨ç¨‹åºçš„æ¯ä¸€å­—èŠ‚æ˜¯å¦å¯ä»¥å®‰å…¨åœ°è®¿é—®ï¼ŒåŒæ—¶é‡‡ç”¨ä»£ç æ’æ¡©æŠ€æœ¯æ¥é’ˆå¯¹åº”ç”¨çš„æ¯æ¬¡loadå’Œstoreå¯¹Shadow Memoryè¿›è¡Œæ£€æŸ¥ã€‚ä½†æ˜¯AddressSanitizeré‡‡ç”¨äº†ä¸€ç§æ›´é«˜æ•ˆçš„Shadowæ˜ å°„æ–¹å¼ï¼Œä¸€ç§æ›´ç´§è‡´çš„Shadowç¼–ç æŠ€æœ¯ï¼Œé™¤äº†å¯ä»¥å¯¹å †è¿›è¡Œæ£€æŸ¥å¤–è¿˜å¯ä»¥æ£€æŸ¥æ ˆå’Œglobalå¯¹è±¡ï¼Œå¦å¤–å®ƒè¦æ¯”AddrCheckå¿«ä¸€ä¸ªæ•°é‡çº§ã€‚\n ç²¾åº¦ä¸èµ„æºä½¿ç”¨tunning å¦‚ä¸‹ä¸‰ä¸ªå› ç´ ä¼šå½±å“AddressSanitizerçš„ç²¾åº¦åŠèµ„æºä½¿ç”¨ï¼Œè¿™ä¸‰ä¸ªå€¼éƒ½æ˜¯ç”±ç¯å¢ƒå˜é‡æ§åˆ¶ï¼Œå¯ä»¥åœ¨ç¨‹åºå¯åŠ¨æ—¶è®¾ç½®ï¼š\n1)Depth of stack unwinding (default: 30)ã€‚å¯¹äºæ¯ä¸ªmallocå’Œfreeè°ƒç”¨ï¼Œè¯¥å·¥å…·éƒ½ä¼šå¯¹è°ƒç”¨æ ˆè¿›è¡Œunwindä»¥ä¸ºé”™è¯¯æŠ¥å‘Šæä¾›æ›´å¤šä¿¡æ¯ã€‚è¯¥é€‰é¡¹ä¼šå½±å“å·¥å…·çš„æ‰§è¡Œé€Ÿåº¦ï¼Œå°¤å…¶æ˜¯å¯¹äºé‚£äº›å±äºmallocè°ƒç”¨å¯†é›†å‹çš„è°ƒç”¨æ¥è¯´ã€‚å®ƒä¸ä¼šå½±å“å†…å­˜å ç”¨åŠæŸ¥æ‰¾bugçš„èƒ½åŠ›ï¼Œä½†æ˜¯è°ƒç”¨æ ˆå¤ªçŸ­çš„è¯ä¸åˆ©äºå®šä½é—®é¢˜ã€‚\n2)Quarantine size (default: 256MB)ã€‚å³ä¿å­˜åˆ°å‰é¢æåˆ°çš„FIFOé˜Ÿåˆ—ä¸­çš„å·²freeçš„å†…å­˜ç©ºé—´å¤§å°ä¹‹å’Œï¼Œè¿™ä¸ªå€¼ä¼šå½±å“å‘ç°use-after-freeç±»å‹bugçš„èƒ½åŠ›ã€‚ä½†æ˜¯å®ƒä¸å½±å“æ€§èƒ½ã€‚\n3)Size of the heap redzone (default: 128 bytes)ã€‚è¯¥é€‰é¡¹ä¼šå½±å“å‘ç°å †å¼‚å¸¸ç±»å‹bugçš„èƒ½åŠ›ã€‚è¯¥å€¼è¶Šå¤§ï¼Œä¼šå¯¼è‡´æ€§èƒ½å˜ä½å¹¶ä¸”å ç”¨æ›´å¤šå†…å­˜ï¼Œå°¤å…¶æ˜¯å¯¹é‚£äº›è¿›è¡Œäº†å¾ˆå¤šå°å—å†…å­˜åˆ†é…çš„ç¨‹åºæ¥è¯´ã€‚ç”±äºredzoneä¼šè¢«ç”¨æ¥ä¿å­˜mallocçš„è°ƒç”¨æ ˆï¼Œå› æ­¤å‡å°‘è¿™ä¸ªå€¼ï¼Œä¼šå¯¼è‡´æœ€å¤§unwindingæ·±åº¦å˜å°ã€‚\nä¼˜ç‚¹å’Œç¼ºç‚¹ å¯ä»¥ä»å¤šä¸ªæ–¹é¢çœ‹ï¼š\n è¿è¡Œé€Ÿåº¦ å†…å­˜æ¶ˆè€— æ”¯æŒçš„å†…å­˜é”™è¯¯ç±»å‹ å‘ç°é”™è¯¯çš„å¯èƒ½æ€§(ä¼šä¸ä¼šè¯¯æŠ¥) æ”¯æŒçš„å¹³å° å…¶ä»–çš„ç‰¹æ€§  ä¼˜ç‚¹   æ”¯æŒè·¨å¹³å°ã€‚\n  æ”¯æŒçš„é”™è¯¯æŠ¥å‘Šç±»å‹å¤šè¾¾21ç§ã€‚\n  å¹³å‡é€Ÿåº¦ä¸ºè¶Šæ¥çš„73%,å†…å­˜æ¶ˆè€—å¤§çº¦3.4å€ã€‚é€Ÿåº¦å’Œæ¶ˆè€—éƒ½ä¸é”™ã€‚\n  æ”¯æŒCä¸C++ã€‚\n  çº¿ç¨‹å®‰å…¨ã€‚\nå› ä¸ºå®ƒåªä¼šåœ¨åº”ç”¨ç¨‹åºå†…å­˜æ•°æ®ä¸å¯è®¿é—®æ—¶(åœ¨mallocå’Œfreeå†…éƒ¨ï¼Œåœ¨æ ˆå¸§è¢«åˆ›å»ºå’Œé”€æ¯æ—¶ï¼Œåœ¨æ¨¡å—åˆå§‹åŒ–æ—¶)æ‰ä¼šå¯¹å®ƒè¿›è¡Œä¿®æ”¹\n  ç¼ºç‚¹   æ¼æŠ¥\n  é‚£äº›äº§ç”Ÿå±€éƒ¨è¶Šç•Œçš„æœªå¯¹é½çš„å†…å­˜è®¿é—®ã€‚\n1 2 3  int *a = new int[2]; // 8-aligned int *u = (int*)((char*)a + 6); *u = 1; // Access to range [6-9]   æ ¹æ®å‰è¿°çš„shadowè®¡ç®—æ–¹æ³•ï¼Œuè¿™ä¸ªåœ°å€ä¼šè¢«å·¦ç§»3ä½ï¼Œå®é™…ä¸Šå¾—åˆ°çš„ShadowAddrä¸aæ²¡å•¥åŒºåˆ«ï¼Œè¿™æ ·k = *ShadowAddr;ç›´æ¥å°±æ˜¯0ï¼Œè€Œä¸ä¼šæŠ¥é”™ã€‚ç›®å‰AddressSanitizeræ²¡æœ‰è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºç›®å‰èƒ½å¤Ÿæƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆéƒ½ä¼šé€ æˆæ€§èƒ½æŸå¤±ã€‚\n  è·³è¿‡redzoneçš„è¶Šç•Œè®¿é—®ã€‚\n1 2 3  char *a = new char[100]; char *b = new char[1000]; a[500] = 0; // may end up somewhere in b   é™·å…¥åˆ°redzoneçš„è¶Šç•Œè®¿é—®ï¼Œ100%ä¼šè¢«æ£€æµ‹åˆ°ï¼Œä½†æ˜¯å¦‚ä¸Šçš„è¶Šç•Œè®¿é—®ï¼Œå¯èƒ½åˆšå¥½å·²ç»è½åˆ°båˆ†é…çš„åˆæ³•ç©ºé—´å†…äº†ã€‚å¦‚æœå†…å­˜å……è¶³ï¼Œæ¨èé‡‡ç”¨128å­—èŠ‚çš„redzoneã€‚\n  å¦‚æœåœ¨freeå’Œä¸‹æ¬¡useä¹‹é—´ï¼Œåˆå‘ç”Ÿäº†å¤§é‡å†…å­˜çš„åˆ†é…å’Œé‡Šæ”¾ï¼Œuse-after-freeé”™è¯¯å¯èƒ½æ— æ³•è¢«æ£€æµ‹åˆ°ã€‚\n1 2 3 4 5 6  char *a = new char[1 \u0026lt;\u0026lt; 20]; // 1MB delete [] a; // \u0026lt;\u0026lt;\u0026lt; \u0026#34;free\u0026#34; char *b = new char[1 \u0026lt;\u0026lt; 28]; // 256MB delete [] b; // drains the quarantine queue. char *c = new char[1 \u0026lt;\u0026lt; 20]; // 1MB a[0] = 0; // \u0026#34;use\u0026#34;. May land in â€™câ€™       éæœŸæœ›çš„bugæŠ¥å‘Š\n  ä¸ç¼–è¯‘å™¨çš„Load Wideningå‘ç”Ÿå†²çªã€‚\n1 2 3 4  struct X { char a, b, c; }; void foo() { X x; ... ... = x.a + x.c; }   åœ¨è¯¥ä»£ç ä¸­ï¼Œå¯¹è±¡xæ˜¯3å­—èŠ‚å¤§å°ï¼Œ4å­—èŠ‚å¯¹é½çš„ã€‚Load Wideningä¼šå°†x.a+x.cè½¬æ¢æˆä¸€ä¸ª4å­—èŠ‚çš„loadã€‚æŒ‰ç…§ä¹‹å‰çš„æ ˆä»£ç æ’å…¥æ–¹å¼ï¼Œç¬¬4ä¸ªå­—èŠ‚åº”è¯¥æ˜¯è¢«æŸ“æ¯’çš„ï¼Œè¿™æ ·åœ¨loadè¿™4ä¸ªå­—èŠ‚æ—¶ï¼Œå°±ä¼šæŠ¥é”™ã€‚é€šè¿‡åœ¨LLVMä¸­ä¸´æ—¶å…³é—­load wideningè§£å†³ã€‚\n  ä¸Cloneå†²çªã€‚\né¦–å…ˆè¿›ç¨‹ï¼Œé‡‡ç”¨CLONE VM|CLONE FILESè°ƒç”¨äº†cloneï¼Œè¯¥æ“ä½œä¼šåˆ›å»ºä¸€ä¸ªä¸çˆ¶è¿›ç¨‹å…±äº«å†…å­˜çš„å­è¿›ç¨‹ã€‚ç‰¹åˆ«æ˜¯ï¼Œå­è¿›ç¨‹çš„æ ˆä½¿ç”¨çš„å†…å­˜ä¹Ÿæ˜¯å±äºçˆ¶è¿›ç¨‹çš„ã€‚ç„¶åå­è¿›ç¨‹è°ƒç”¨äº†ä¸€ä¸ªåŒ…å«æ ˆä¸Šå¯¹è±¡çš„å‡½æ•°ï¼Œæ­¤æ—¶AddressSanitizerä¼šå°†æ ˆå¯¹è±¡çš„redzoneåŒºåŸŸæŸ“æ¯’ã€‚æœ€åï¼Œå­è¿›ç¨‹è°ƒç”¨äº†ä¸€ä¸ªä¸ä¼šreturnçš„å‡½æ•°(æ¯”å¦‚_exitæˆ–exec)ï¼Œè¿™æ ·è¯¥å‡½æ•°å¯¹redzoneè¿›è¡Œæ¶ˆæ¯’(un-poisoning)çš„é‚£éƒ¨åˆ†ä»£ç å°±ä¸ä¼šè¢«æ‰§è¡Œã€‚è¿™æ ·çˆ¶è¿›ç¨‹åœ°å€ç©ºé—´ä»å¤„äºæŸ“æ¯’çŠ¶æ€ï¼Œå½“è¯¥å†…å­˜è¢«å†æ¬¡ä½¿ç”¨æ—¶å°±ä¼šæŠ¥é”™ã€‚æˆ‘ä»¬é€šè¿‡æ‰¾åˆ°æ‰€æœ‰çš„never-returnå‡½æ•°(åƒ_exitæˆ–execè¿™æ ·å…·æœ‰è¯¥å±æ€§çš„é‚£äº›å‡½æ•°)ï¼Œç„¶ååœ¨è°ƒç”¨å®ƒä»¬ä¹‹å‰å°†æ•´ä¸ªæ ˆå†…å­˜æ¶ˆæ¯’ã€‚ä¸ä¹‹ç±»ä¼¼ï¼ŒAddressSanitizerè¿˜å¿…é¡»è¦å¯¹longjmpå’ŒC++å¼‚å¸¸è¿›è¡Œæ‹¦æˆªã€‚\n    ä¸èƒ½æ‰§è¡Œè¿‡ç¨‹æ·»åŠ ï¼Œéœ€è¦ç¼–è¯‘æ—¶æœŸè¿›è¡ŒæŒ‡å®š\n  æ›´å¤šå·¥å…·   ThreadSanitizer\nThreadSanitizeræ˜¯ä¸€ä¸ªç”¨äºC/C++å’ŒGoçš„å¿«é€Ÿæ•°æ®ç«äº‰æ£€æµ‹å™¨ã€‚\n  MemorySanitizer\nä¸€ä¸ªå¿«é€Ÿçš„åŸºäºllvmçš„å·¥å…·ï¼Œç”¨äºæ£€æµ‹æœªåˆå§‹åŒ–å†…å­˜çš„ä½¿ç”¨æƒ…å†µã€‚\n  å‚è€ƒé“¾æ¥ï¼š\n .AddressSanitizerä½¿ç”¨ä»‹ç» https://github.com/google/sanitizers/wiki/AddressSanitizerLeakSanitizer#suppressions è®ºæ–‡ã€ŠAddressSanitizer: A Fast Address Sanity Checkerã€‹ https://zhuanlan.zhihu.com/p/95977383 https://zhuanlan.zhihu.com/p/338158556  ","description":"A Fast Address Sanity Checker","id":51,"section":"posts","tags":["MLK"],"title":"AddressSanitizer Tool","uri":"https://hugo.jiahongw.com/zh/posts/mlk/addresssanitizer/"},{"content":"Find and Note ä»£ç è§„èŒƒ pylint https://www.jianshu.com/p/c0bd637f706d\nhttps://pylint.readthedocs.io/en/latest/tutorial.html\nflake8 https://www.jianshu.com/p/adf743fc8e78\næ—¥å¿—çš„ç­‰çº§ æ—¥å¿—çº§åˆ« | æè¿° \u0026mdash;|\u0026mdash; OFF | å…³é—­ï¼šæœ€é«˜çº§åˆ«ï¼Œä¸æ‰“å°æ—¥å¿—ã€‚ FATAL | è‡´å‘½ï¼šæŒ‡æ˜éå¸¸ä¸¥é‡çš„å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨ç»ˆæ­¢æ‰§è¡Œé”™è¯¯äº‹ä»¶ã€‚ ERROR | é”™è¯¯ï¼šæŒ‡æ˜é”™è¯¯äº‹ä»¶ï¼Œä½†åº”ç”¨å¯èƒ½è¿˜èƒ½ç»§ç»­è¿è¡Œã€‚ WARN | è­¦å‘Šï¼šæŒ‡æ˜å¯èƒ½æ½œåœ¨çš„å±é™©çŠ¶å†µã€‚ INFO | ä¿¡æ¯ï¼šæŒ‡æ˜æè¿°ä¿¡æ¯ï¼Œä»ç²—ç²’åº¦ä¸Šæè¿°äº†åº”ç”¨è¿è¡Œè¿‡ç¨‹ã€‚ DEBUG | è°ƒè¯•ï¼šæŒ‡æ˜ç»†è‡´çš„äº‹ä»¶ä¿¡æ¯ï¼Œå¯¹è°ƒè¯•åº”ç”¨æœ€æœ‰ç”¨ã€‚ TRACE | è·Ÿè¸ªï¼šæŒ‡æ˜ç¨‹åºè¿è¡Œè½¨è¿¹ï¼Œæ¯”DEBUGçº§åˆ«çš„ç²’åº¦æ›´ç»†ã€‚ ALL | æ‰€æœ‰ï¼šæ‰€æœ‰æ—¥å¿—çº§åˆ«ï¼ŒåŒ…æ‹¬å®šåˆ¶çº§åˆ«ã€‚\næ‰€ä»¥ï¼Œæ—¥å¿—ä¼˜å…ˆçº§åˆ«æ ‡å‡†é¡ºåºä¸ºï¼š\n ALL \u0026lt; TRACE \u0026lt; DEBUG \u0026lt; INFO \u0026lt; WARN \u0026lt; ERROR \u0026lt; FATAL \u0026lt; OFF\n äº‘è®¡ç®—ç›¸å…³ç¤¾åŒº https://www.linux-kvm.org/page/Main_Page\nhttps://www.qemu.org/\nhttps://wiki.qemu.org/Features/\nvi vim æŸ¥æ‰¾å’Œæ›¿æ¢å­—ç¬¦ä¸² å‘½ä»¤ https://blog.csdn.net/doubleface999/article/details/55798741\nå¦‚ä½•æ›¿æ¢æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²ï¼Ÿ\nsedæ˜¯ä¸€ç§æµç¼–è¾‘å™¨ï¼Œå®ƒæ˜¯æ–‡æœ¬å¤„ç†ä¸­éå¸¸ä¸­çš„å·¥å…·ï¼Œèƒ½å¤Ÿå®Œç¾çš„é…åˆæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨ï¼ŒåŠŸèƒ½ä¸åŒå‡¡å“ã€‚å¤„ç†æ—¶ï¼ŒæŠŠå½“å‰å¤„ç†çš„è¡Œå­˜å‚¨åœ¨ä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œç§°ä¸ºâ€œæ¨¡å¼ç©ºé—´â€ï¼ˆpattern spaceï¼‰ï¼Œæ¥ç€ç”¨sedå‘½ä»¤å¤„ç†ç¼“å†²åŒºä¸­çš„å†…å®¹ï¼Œå¤„ç†å®Œæˆåï¼ŒæŠŠç¼“å†²åŒºçš„å†…å®¹é€å¾€å±å¹•ã€‚æ¥ç€å¤„ç†ä¸‹ä¸€è¡Œï¼Œè¿™æ ·ä¸æ–­é‡å¤ï¼Œç›´åˆ°æ–‡ä»¶æœ«å°¾ã€‚æ–‡ä»¶å†…å®¹å¹¶æ²¡æœ‰ æ”¹å˜ï¼Œé™¤éä½ ä½¿ç”¨é‡å®šå‘å­˜å‚¨è¾“å‡ºã€‚Sedä¸»è¦ç”¨æ¥è‡ªåŠ¨ç¼–è¾‘ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼›ç®€åŒ–å¯¹æ–‡ä»¶çš„åå¤æ“ä½œï¼›ç¼–å†™è½¬æ¢ç¨‹åºç­‰ã€‚\nï¼š%s/vivian/sky/ï¼ˆç­‰åŒäºï¼šg/vivian/s//sky/ï¼‰æ›¿æ¢æ¯ä¸€è¡Œçš„ç¬¬ä¸€ä¸ª vivian ä¸º sky\nï¼š%s/vivian/sky/gï¼ˆç­‰åŒäºï¼šg/vivian/s//sky/gï¼‰æ›¿æ¢æ¯ä¸€è¡Œä¸­æ‰€æœ‰ vivian ä¸º sky\nLinuxæ–‡ä»¶ç³»ç»Ÿç±»å‹å·®åˆ« åœ¨Linuxä¸­ï¼Œext2æ–‡ä»¶ç³»ç»Ÿå°†ç£ç›˜åˆ’åˆ†æˆè‹¥å¹²ä¸ªblock groupsï¼Œæ¯ä¸ªblock groupåŒ…å«ä¸€ä¸ªinode bitmap, data bitmap, inodeså’Œè‹¥å¹²ä¸ªdata blocksï¼Œå®ƒæ²¡æœ‰ä½¿ç”¨æ—¥å¿—ã€‚\nè€Œåœ¨ext3æ–‡ä»¶ç³»ç»Ÿä¸­ï¼ŒåŠ å…¥äº†å¯¹æ—¥å¿—çš„æ”¯æŒï¼Œæ—¥å¿—éƒ¨åˆ†å•ç‹¬å æ®ä¸€å—ç£ç›˜ç©ºé—´ã€‚\nä»€ä¹ˆæ˜¯linuxç³»ç»Ÿç£ç›˜åªè¯»é—®é¢˜ï¼Ÿ åªè¯»çš„åŸå› åœ¨ç³»ç»Ÿæ—¥å¿—/var/log/messagesé‡Œæœ‰ï¼Œä¸€èˆ¬æ˜¯å› ä¸ºæ£€æµ‹åˆ°æ–‡ä»¶ç³»ç»Ÿæœ‰é”™è¯¯\nç£ç›˜åªè¯»ä¸€èˆ¬çš„å¸¸è§åŸå› ï¼š\n  ç£ç›˜ç©ºé—´æ»¡ï¼šå¯ä»¥é€šè¿‡df -hå‘½ä»¤æŸ¥çœ‹ç£ç›˜çš„ä½¿ç”¨æƒ…å†µï¼Œç„¶ååˆ é™¤å¤šä½™çš„æ–‡ä»¶é‡Šæ”¾ç£ç›˜ç©ºé—´ï¼›\n  ç£ç›˜inodeèµ„æºå ç”¨å®Œï¼šå¯ä»¥é€šè¿‡df -iå‘½ä»¤æŸ¥çœ‹ï¼Œç¡®è®¤ç›¸å…³çš„è¿›ç¨‹ï¼›\n  ç¡¬ä»¶æ•…éšœï¼š\n  ä»€ä¹ˆæ˜¯å†…å­˜ECCï¼Ÿ https://www.crucial.cn/learn-with-crucial/memory/what-is-ecc-memory\nå¯¹äºå¤§å¤šæ•°ä¼ä¸šæ¥è¯´ï¼Œæ¶ˆé™¤æ•°æ®æŸåæ˜¯ä¸€é¡¹å…³é”®ä»»åŠ¡â€”â€”è¿™æ­£æ˜¯ ECCï¼ˆçº é”™ç ï¼‰å†…å­˜çš„ç›®çš„ã€‚ECC æ˜¯ä¸€ç§æŒ‡ä»¤çº é”™æŠ€æœ¯ï¼Œèƒ½å¤Ÿæ£€æµ‹å¹¶çº æ­£å¸¸è§çš„å„ç§å†…å­˜æ•°æ®æŸåæƒ…å†µï¼Œå³Error Checking and Correctingã€‚\nlinux /devç›®å½• https://www.cnblogs.com/hongzg1982/articles/2168450.html\ndev æ˜¯è®¾å¤‡(device)çš„è‹±æ–‡ç¼©å†™ã€‚è¿™ä¸ªç›®å½•å¯¹æ‰€æœ‰çš„ç”¨æˆ·éƒ½ååˆ†é‡è¦ã€‚å› ä¸ºåœ¨è¿™ä¸ªç›®å½•ä¸­åŒ…å«äº†æ‰€æœ‰Linuxç³»ç»Ÿä¸­ä½¿ç”¨çš„å¤–éƒ¨è®¾å¤‡ã€‚\n/sbinç›®å½•ï¼Ÿ https://blog.csdn.net/kkdelta/article/details/7708250\n /binæ˜¯ç³»ç»Ÿçš„ä¸€äº›æŒ‡ä»¤ã€‚binä¸ºbinaryçš„ç®€å†™ä¸»è¦æ”¾ç½®ä¸€äº›ç³»ç»Ÿçš„å¿…å¤‡æ‰§è¡Œæ¡£ä¾‹å¦‚:catã€cpã€chmod dfã€dmesgã€gzipã€killã€lsã€mkdirã€moreã€mountã€rmã€suã€tarç­‰ã€‚ /sbinä¸€èˆ¬æ˜¯æŒ‡è¶…çº§ç”¨æˆ·æŒ‡ä»¤**ã€‚**ä¸»è¦æ”¾ç½®ä¸€äº›ç³»ç»Ÿç®¡ç†çš„å¿…å¤‡ç¨‹å¼ä¾‹å¦‚:cfdiskã€dhcpcdã€dumpã€e2fsckã€fdiskã€haltã€ifconfigã€ifupã€ ifdownã€initã€insmodã€liloã€lsmodã€mke2fsã€modprobeã€quotacheckã€rebootã€rmmodã€ runlevelã€shutdownç­‰ã€‚ /usr/binã€€æ˜¯ä½ åœ¨åæœŸå®‰è£…çš„ä¸€äº›è½¯ä»¶çš„è¿è¡Œè„šæœ¬ã€‚ä¸»è¦æ”¾ç½®ä¸€äº›åº”ç”¨è½¯ä½“å·¥å…·çš„å¿…å¤‡æ‰§è¡Œæ¡£ä¾‹å¦‚c++ã€g++ã€gccã€chdrvã€diffã€digã€duã€ejectã€elmã€freeã€gnome*ã€ gzipã€htpasswdã€kfmã€ktopã€lastã€lessã€localeã€m4ã€makeã€manã€mcopyã€ncftpã€ newaliasesã€nslookup passwdã€quotaã€smb*ã€wgetç­‰ã€‚ /usr/sbin æ”¾ç½®ä¸€äº›ç”¨æˆ·å®‰è£…çš„ç³»ç»Ÿç®¡ç†çš„å¿…å¤‡ç¨‹å¼ä¾‹å¦‚:dhcpdã€httpdã€imapã€in.*dã€inetdã€lpdã€namedã€netconfigã€nmbdã€sambaã€sendmailã€squidã€swapã€tcpdã€tcpdumpç­‰ã€‚  è™šæ‹ŸåŒ– https://zhuanlan.zhihu.com/p/69629212\nå®Œå…¨è™šæ‹ŸåŒ–å’Œç±»è™šæ‹ŸåŒ–\nhttps://www.redhat.com/zh/topics/virtualization\nè™šæ‹Ÿæœºç›‘æ§ç¨‹åº(Hypervisor)å¯èƒ½ä½äºæ“ä½œç³»ç»Ÿçš„é¡¶å±‚ï¼ˆä¾‹å¦‚åœ¨ä¾¿æºå¼è®¡ç®—æœºä¸Šï¼‰ï¼Œæˆ–è€…ç›´æ¥å®‰è£…åœ¨ç¡¬ä»¶ä¸Šï¼ˆä¾‹å¦‚æœåŠ¡å™¨ï¼‰ï¼Œè¿™æ˜¯å¤§å¤šæ•°ä¼ä¸šä½¿ç”¨è™šæ‹ŸåŒ–çš„æ–¹å¼ã€‚è™šæ‹Ÿæœºç›‘æ§ç¨‹åºæ¥ç®¡ç‰©ç†èµ„æºï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œåˆ’åˆ†ï¼Œä»¥ä¾¿è™šæ‹Ÿç¯å¢ƒèƒ½å¤Ÿå¯¹å…¶è¿›è¡Œä½¿ç”¨\nmakefileæ•™ç¨‹ makefileå…³ç³»åˆ°äº†æ•´ä¸ªå·¥ç¨‹çš„ç¼–è¯‘è§„åˆ™ã€‚ä¸€ä¸ªå·¥ç¨‹ä¸­çš„æºæ–‡ä»¶ä¸è®¡æ•°ï¼Œå…¶æŒ‰ç±»å‹ã€åŠŸèƒ½ã€æ¨¡å—åˆ†åˆ«æ”¾åœ¨è‹¥å¹²ä¸ªç›®å½•ä¸­ï¼Œmakefileå®šä¹‰äº†ä¸€ç³»åˆ—çš„è§„åˆ™æ¥æŒ‡å®šï¼Œå“ªäº›æ–‡ä»¶éœ€è¦å…ˆç¼–è¯‘ï¼Œå“ªäº›æ–‡ä»¶éœ€è¦åç¼–è¯‘ï¼Œå“ªäº›æ–‡ä»¶éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œç”šè‡³äºè¿›è¡Œæ›´å¤æ‚çš„åŠŸèƒ½æ“ä½œï¼Œå› ä¸ºmakefileå°±åƒä¸€ä¸ªShellè„šæœ¬ä¸€æ ·ï¼Œå…¶ä¸­ä¹Ÿå¯ä»¥æ‰§è¡Œæ“ä½œç³»ç»Ÿçš„å‘½ä»¤ã€‚makefileå¸¦æ¥çš„å¥½å¤„å°±æ˜¯â€”â€”â€œè‡ªåŠ¨åŒ–ç¼–è¯‘â€ï¼Œä¸€æ—¦å†™å¥½ï¼Œåªéœ€è¦ä¸€ä¸ªmakeå‘½ä»¤ï¼Œæ•´ä¸ªå·¥ç¨‹å®Œå…¨è‡ªåŠ¨ç¼–è¯‘ï¼Œæå¤§çš„æé«˜äº†è½¯ä»¶å¼€å‘çš„æ•ˆç‡ã€‚makeæ˜¯ä¸€ä¸ªå‘½ä»¤å·¥å…·ï¼Œæ˜¯ä¸€ä¸ªè§£é‡Šmakefileä¸­æŒ‡ä»¤çš„å‘½ä»¤å·¥å…·ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¤§å¤šæ•°çš„IDEéƒ½æœ‰è¿™ä¸ªå‘½ä»¤ï¼Œæ¯”å¦‚ï¼šDelphiçš„makeï¼ŒVisual C++çš„nmakeï¼ŒLinuxä¸‹GNUçš„makeã€‚å¯è§ï¼Œmakefileéƒ½æˆä¸ºäº†ä¸€ç§åœ¨å·¥ç¨‹æ–¹é¢çš„ç¼–è¯‘æ–¹æ³•ã€‚\nhttps://blog.csdn.net/weixin_38391755/article/details/80380786\nGCC å‚æ•°è¯¦è§£ https://www.runoob.com/w3cnote/gcc-parameter-detail.html\nCé£æ ¼æŒ‡å— https://zh-google-styleguide.readthedocs.io/en/latest/google-cpp-styleguide/comments/#id2\nå¤šæœåŠ¡å™¨ç®¡ç†å·¥å…·â€”â€”ClusterShell https://www.cnblogs.com/kevingrace/p/6099205.html\nVimä½¿ç”¨å¤§å…¨ linux å‘½ä»¤è¡Œ å…‰æ ‡ç§»åŠ¨æŠ€å·§ https://blog.csdn.net/leo_618/article/details/53003111\nCtrl+aè·³åˆ°æœ¬è¡Œçš„è¡Œé¦–ï¼Œ\nCtrl+eåˆ™è·³åˆ°é¡µå°¾ã€‚\nCtrl+uåˆ é™¤å½“å‰å…‰æ ‡å‰é¢çš„æ–‡å­—\nctrl+k-åˆ é™¤å½“å‰å…‰æ ‡åé¢çš„æ–‡å­—\nCtrl+wå’ŒAlt+d-å¯¹äºå½“å‰çš„å•è¯è¿›è¡Œåˆ é™¤æ“ä½œï¼Œwåˆ é™¤å…‰æ ‡å‰é¢çš„å•è¯çš„å­—ç¬¦ï¼Œdåˆ™åˆ é™¤åé¢çš„å­—ç¬¦\nAlt+Backsapce-åˆ é™¤å½“å‰å…‰æ ‡åé¢çš„å•è¯ï¼Œ\nå¦‚æœåˆ é™¤é”™è¯¯ï¼Œä½¿ç”¨Ctrl+yè¿›è¡Œæ¢å¤Ctrl+Lè¿›è¡Œæ¸…å±æ“ä½œ\nctrl+a:å…‰æ ‡ç§»åˆ°è¡Œé¦–ã€‚\nctrl+b:å…‰æ ‡å·¦ç§»ä¸€ä¸ªå­—æ¯\nctrl+c:æ€æ­»å½“å‰è¿›ç¨‹ã€‚\nctrl+d:é€€å‡ºå½“å‰ Shellã€‚\nctrl+e:å…‰æ ‡ç§»åˆ°è¡Œå°¾ã€‚\nctrl+h:åˆ é™¤å…‰æ ‡å‰ä¸€ä¸ªå­—ç¬¦ï¼ŒåŒ backspace é”®ç›¸åŒã€‚\nctrl+k:æ¸…é™¤å…‰æ ‡åè‡³è¡Œå°¾çš„å†…å®¹ã€‚\nctrl+l:æ¸…å±ï¼Œç›¸å½“äºclearã€‚\nctrl+r:æœç´¢ä¹‹å‰æ‰“è¿‡çš„å‘½ä»¤ã€‚ä¼šæœ‰ä¸€ä¸ªæç¤ºï¼Œæ ¹æ®ä½ è¾“å…¥çš„å…³é”®å­—è¿›è¡Œæœç´¢bashçš„history\nctrl+u: æ¸…é™¤å…‰æ ‡å‰è‡³è¡Œé¦–é—´çš„æ‰€æœ‰å†…å®¹ã€‚\nctrl+w: ç§»é™¤å…‰æ ‡å‰çš„ä¸€ä¸ªå•è¯\nctrl+t: äº¤æ¢å…‰æ ‡ä½ç½®å‰çš„ä¸¤ä¸ªå­—ç¬¦\nctrl+y: ç²˜è´´æˆ–è€…æ¢å¤ä¸Šæ¬¡çš„åˆ é™¤\nctrl+d: åˆ é™¤å…‰æ ‡æ‰€åœ¨å­—æ¯;æ³¨æ„å’Œbackspaceä»¥åŠctrl+hçš„åŒºåˆ«ï¼Œè¿™2ä¸ªæ˜¯åˆ é™¤å…‰æ ‡å‰çš„å­—ç¬¦\nctrl+f: å…‰æ ‡å³ç§»\nctrl+z : æŠŠå½“å‰è¿›ç¨‹è½¬åˆ°åå°è¿è¡Œï¼Œä½¿ç”¨â€™ fg â€˜å‘½ä»¤æ¢å¤ã€‚æ¯”å¦‚top -d1 ç„¶åctrl+z ï¼Œåˆ°åå°ï¼Œç„¶åfg,é‡æ–°æ¢å¤\nescç»„åˆ\nesc+d: åˆ é™¤å…‰æ ‡åçš„ä¸€ä¸ªè¯\nesc+f: å¾€å³è·³ä¸€ä¸ªè¯\nesc+b: å¾€å·¦è·³ä¸€ä¸ªè¯\nesc+t: äº¤æ¢å…‰æ ‡ä½ç½®å‰çš„ä¸¤ä¸ªå•è¯ã€‚\nåŒºåˆ«gccä¸­çš„-w -Wå’Œ-Wallé€‰é¡¹ https://blog.csdn.net/cjtstrive/article/details/85375477\n-wçš„æ„æ€æ˜¯å…³é—­ç¼–è¯‘æ—¶çš„è­¦å‘Šï¼Œä¹Ÿå°±æ˜¯ç¼–è¯‘åä¸æ˜¾ç¤ºä»»ä½•warningï¼Œå› ä¸ºæœ‰æ—¶åœ¨ç¼–è¯‘ä¹‹åç¼–è¯‘å™¨ä¼šæ˜¾ç¤ºä¸€äº›ä¾‹å¦‚æ•°æ®è½¬æ¢ä¹‹ç±»çš„è­¦å‘Šï¼Œè¿™äº›è­¦å‘Šæ˜¯æˆ‘ä»¬å¹³æ—¶å¯ä»¥å¿½ç•¥çš„ã€‚\n-Wallé€‰é¡¹æ„æ€æ˜¯ç¼–è¯‘åæ˜¾ç¤ºæ‰€æœ‰è­¦å‘Šã€‚\n-Wé€‰é¡¹ç±»ä¼¼-Wallï¼Œä¼šæ˜¾ç¤ºè­¦å‘Šï¼Œä½†æ˜¯åªæ˜¾ç¤ºç¼–è¯‘å™¨è®¤ä¸ºä¼šå‡ºç°é”™è¯¯çš„è­¦å‘Šã€‚\nåœ¨ç¼–è¯‘ä¸€äº›é¡¹ç›®çš„æ—¶å€™å¯ä»¥-Wå’Œ-Wallé€‰é¡¹ä¸€èµ·ä½¿ç”¨ã€‚\nä¸­æ–‡æŠ€æœ¯æ–‡æ¡£çš„å†™ä½œè§„èŒƒ https://github.com/ruanyf/document-style-guide\nä¸ºä»€ä¹ˆé€‰æ‹©â€œã€œâ€ä»£è¡¨ä¸»ç›®å½•ï¼Ÿ https://qastack.cn/unix/34196/why-was-chosen-to-represent-the-home-directory\nå°†githubä¸­çš„issueå¯¼å‡º(å…¶å®æ˜¯è°ƒç”¨Githubçš„APIæ–‡æ¡£) https://www.jianshu.com/p/5180f364be18\nhttps://github.com/verygood-ops/export-pull-requests\nepr -x issues -m 7 redisread/HUGO_blog -t 0cbb300dffa5d19e30e4fffee6f23cc504252904 -p github \u0026gt; issue.csv epr redisread/HUGO_blo \u0026gt; pr.csv Bpazy blog issue https://github.com/Bpazy/blog/issues\nShellå¸¸ç”¨å‘½ä»¤ https://www.cnblogs.com/mainz/articles/1027168.html\nå°†githubä¸­çš„issueå¯¼å‡º(å…¶å®æ˜¯è°ƒç”¨Githubçš„APIæ–‡æ¡£) https://www.jianshu.com/p/5180f364be18\nhttps://github.com/verygood-ops/export-pull-requests\nepr -x issues -m 7 redisread/HUGO_blog -t 0cbb300dffa5d19e30e4fffee6f23cc504252904 -p github \u0026gt; issue.csv epr redisread/HUGO_blo \u0026gt; pr.csv awkå‘½ä»¤ awkå‘½ä»¤ç”¨æ³•\n","description":"é›¶é›¶æ•£æ•£ï¼Œæœ€è¿‘éƒ½ä¸æ€ä¹ˆè®°å½•äº†ã€‚åˆå¼€å§‹å›åˆ°ä¹‹å‰çš„æ‡’æƒ°çŠ¶æ€äº†ã€‚è¿™é‡Œè®°å½•äº†è¿‘æœŸä¸€äº›é›¶æ•£çš„å­¦ä¹ ä»¥åŠè¿‡ç¨‹ã€‚","id":52,"section":"posts","tags":["life"],"title":"è¿™æ®µæ—¶é—´çš„ä¸€äº›è®°å½•","uri":"https://hugo.jiahongw.com/zh/posts/undefined/find-and-note/"},{"content":"ä»€ä¹ˆæ˜¯æ±‰æ˜ç ï¼Ÿ çœ‹ä¸‹é¢è¿™å¼ å›¾ï¼Œè“è‰²çš„è¡¨ç¤ºéœ€è¦å‘é€çš„æ•°æ®ï¼Œæˆ‘ä»¬å°±å‡è®¾å‘é€çš„æ•°æ®ä¸º0101å§ï¼Œå¤–é¢æ©™è‰²çš„ç å°±æ˜¯æ±‰æ˜ç ï¼Œæ±‰æ˜ç æ˜¯ä¸€ç§çº é”™ç ï¼Œä½†æ˜¯åªèƒ½çº æ­£ä¸€ä¸ªé”™è¯¯çš„æ¯”ç‰¹ã€‚æ±‰æ˜ç æ˜¯æ·»åŠ åˆ°åˆ°å‘é€æ•°æ®åé¢çš„å†—ä½™ç ã€‚æ¯ä¸€ä¸ªæ±‰æ˜ç ä¸åŒä¸€ä¸ªåœ†ä¸­çš„æ‰€æœ‰æ•°æ®è¿›è¡Œå¼‚æˆ–éƒ½æ˜¯0.\næ±‰æ˜ç æ€ä¹ˆè¿›è¡Œçº é”™çš„ï¼Ÿ   å‡è®¾åŸæ¥çš„æ•°æ®ä¸­ä¸€ä¸ªæ¯”ç‰¹é”™è¯¯äº†ï¼Œå¦‚ä¸‹é¢çº¢è‰²çš„å­—ï¼ŒåŸæ¥çš„1å˜æˆäº†0\næ­¤æ—¶å¯¹äºæ¯ä¸€ä¸ªå›­ï¼Œå®ƒä»¬è¿›è¡Œå¼‚æˆ–çš„å€¼éƒ½ä¸æ˜¯0ï¼Œè¯´æ˜é”™è¯¯çš„åœ°æ–¹æ˜¯ä¸‰ä¸ªåœ†å…¬å…±çš„éƒ¨åˆ†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥çŸ¥é“é”™è¯¯çš„æ˜¯ä¸­é—´çš„ä½ç½®ï¼š\n  å‡å¦‚æ˜¯æ±‰æ˜ç ä¸­çš„ä¸€ä¸ªæ¯”ç‰¹é”™è¯¯äº†ï¼Œå¦‚ä¸‹é¢çº¢è‰²çš„å­—ï¼ŒåŸæ¥çš„0å˜æˆäº†1\næ­¤æ—¶åªæœ‰å³ä¸Šè§’é‚£ä¸ªåœ†çš„æ‰€æœ‰æ¯”ç‰¹å¼‚æˆ–ä¸ä¸º0ï¼Œè€Œå³ä¸Šè§’çš„åœ†ä¸å…¶ä»–åœ†æ²¡æœ‰å…³ç³»çš„éƒ¨åˆ†å°±æ˜¯å®ƒçš„æ±‰æ˜ç éƒ¨åˆ†ï¼Œæ‰€ä»¥å¯ä»¥æ¨æ–­æ˜¯å³ä¸Šè§’çš„åœ†çš„æ±‰æ˜ç é”™è¯¯äº†\n  æ±‰æ˜ç æ”¾ç½®çš„ä½ç½®åœ¨å“ªé‡Œå‘¢ï¼Ÿ é¦–å…ˆéœ€è¦è®¡ç®—æ±‰æ˜ç çš„æ ¡éªŒä½æ•°ã€‚\næ±‰æ˜ç çš„æ ¡éªŒä½æ•° è®¾æ•°æ®æœ‰$n$ä½ï¼Œæ ¡éªŒç æœ‰$x$ä½ã€‚åˆ™æ ¡éªŒç ä¸€å…±æœ‰$2^x$ç§å–å€¼æ–¹å¼ã€‚å…¶ä¸­éœ€è¦ä¸€ç§å–å€¼æ–¹å¼è¡¨ç¤ºæ•°æ®æ­£ç¡®ï¼Œå‰©ä¸‹$2^x - 1$ç§å–å€¼æ–¹å¼è¡¨ç¤ºæœ‰ä¸€ä½æ•°æ®å‡ºé”™ã€‚å› ä¸ºç¼–ç åçš„äºŒè¿›åˆ¶ä¸²æœ‰$n+x$ä½ï¼Œå› æ­¤xåº”è¯¥æ»¡è¶³ï¼š$2^x -1 \u0026gt;= n + x$ã€€ä½¿ä¸ç­‰å¼æˆç«‹çš„xçš„æœ€å°å€¼å°±æ˜¯æ ¡éªŒç çš„ä½æ•°ã€‚\nå‡è®¾ä»¥1010110ä¸ºä¾‹è¿›è¡Œæµ·æ˜ç ç¼–ç ã€‚\nä½¿ä¸ç­‰å¼æˆç«‹çš„xçš„æœ€å°å€¼å°±æ˜¯æ ¡éªŒç çš„ä½æ•°ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œn=7ï¼Œè§£å¾—x=4ã€‚\nä¿¡æ¯ç å’Œæ ¡éªŒç çš„å¯¹åº”å…³ç³»å¦‚ä¸‹è¡¨ï¼š\n   ä¿¡æ¯ç ä½æ•° 1 2~4 5~11 12~26 27~57 58~120     æ ¡éªŒç ä½æ•° 2 3 4 5 6 7    è§„å®šåœ¨é‡‡ç”¨æ±‰æ˜ç çš„ä¸€ä¸²æ•°æ®ä¸­ï¼Œ2çš„iæ¬¡æ–¹çš„ä½ç½®ä¸Šï¼Œæˆ‘ä»¬æ”¾æ ¡éªŒç ã€‚\næ›´åŠ è¯¦ç»†çš„æ ¡éªŒç ä½ç½®å¯çœ‹ä¸‹é¢ç»¿è‰²çš„æ¯”ç‰¹ï¼Œä¸‹å›¾ä¸ºåˆ†ç»„åŠæ ¡éªŒç ä½ç½®å›¾ï¼š\næ±‰æ˜ç å¦‚ä½•åˆ†ç»„ï¼Œä¸ºä»€ä¹ˆï¼Ÿ æŒ‰ä½ç½®åˆ†ç»„\n å‡¡æ˜¯ä½ç½®ç¬¦åˆè¿™ç§å½¢å¼çš„ï¼ŒXXX1ï¼Œå½’åˆ°P1ï¼› å‡¡æ˜¯ä½ç½®ç¬¦åˆè¿™ç§å½¢å¼çš„ï¼ŒXX1Xï¼Œå½’åˆ°P2ï¼› å‡¡æ˜¯ä½ç½®ç¬¦åˆè¿™ç§å½¢å¼çš„ï¼ŒX1XXï¼Œå½’åˆ°P3ï¼› å‡¡æ˜¯ä½ç½®ç¬¦åˆè¿™ç§å½¢å¼çš„ï¼Œ1XXXï¼Œå½’åˆ°P4ï¼›  â€¦â€¦..\n å…¶ä¸­çš„è§„å¾‹å°±æ˜¯ä½¿ç”¨æ¯ä¸ªæ¯”ç‰¹åˆ¤æ–­æ•°æ®åºåˆ—çš„å­é›†ï¼Œç„¶åé€æ­¥ç¼©å°èŒƒå›´ï¼Œä»æ—¶é—´å¤æ‚åº¦$O(n)$é™åˆ°$O(log(n))$\n è®¡ç®—æ ¡éªŒç ï¼Ÿ æ¯ä¸€è¡Œéƒ½æ˜¯ä»å¯¹åº”çš„æ ¡éªŒä½å¼€å§‹æ ¡éªŒï¼Œå³ä»ç¬¬$2^n / 2$ä½å¼€å§‹æ ¡éªŒï¼Œæ ¡éªŒ$2^n / 2$ä¸ªï¼Œç„¶åè·³è¿‡$2^n / 2$ä¸ªã€‚\nä¸‹é¢è®¡ç®—æœ¬ä¾‹å­(ä»¥1010110ä¸ºä¾‹è¿›è¡Œæµ·æ˜ç ç¼–ç )ï¼Œå°†è¡¨æ ¼ä¸­çš„ä½ç½®ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºï¼š\n   ä½ç½® 0001 0010 0011 0100 0101 0110 0111 1000 1001 1010 1011     å†…å®¹ x1 x2 1 x3 0 1 0 x4 1 1 0    è®¡ç®—x1:\nx1æ˜¯ç¬¬ä¸€ä¸ªæ ¡éªŒç ï¼Œä½ç½®å¯¹åº”æ æ‰€æœ‰æœ€åä¸€ä½ä¸º1ï¼ˆxxx1æ ¼å¼ï¼‰çš„ç›¸å¼‚æˆ–ä¸º0ï¼Œå³:\n   ä½ç½® 0001 0010 0011 0100 0101 0110 0111 1000 1001 1010 1011     å†…å®¹ x1 x2 1 x3 0 1 0 x4 1 1 0    $$\nx1 \\oplus 1 \\oplus 0 \\oplus 0 \\oplus 1 \\oplus 0 = 0\n$$\nåˆ™x1 = 0ã€‚\nè®¡ç®—x2:\nx2æ˜¯ç¬¬äºŒä¸ªæ ¡éªŒç ï¼Œä½ç½®å¯¹åº”æ æ‰€æœ‰å€’æ•°ç¬¬äºŒä½ä¸º1ï¼ˆxx1xæ ¼å¼ï¼‰çš„ç›¸å¼‚æˆ–ä¸º0ï¼Œå³\n   ä½ç½® 0001 0010 0011 0100 0101 0110 0111 1000 1001 1010 1011     å†…å®¹ x1 x2 1 x3 0 1 0 x4 1 1 0    $$\nx2 \\oplus 1 \\oplus 1 \\oplus 0 \\oplus 1 \\oplus 0 = 0\n$$\nåˆ™x2 = 1ã€‚\nè®¡ç®—x3:\nx3æ˜¯ç¬¬ä¸‰ä¸ªæ ¡éªŒç ï¼Œä½ç½®å¯¹åº”æ æ‰€æœ‰å€’æ•°ç¬¬ä¸‰ä½ä¸º1ï¼ˆx1xxæ ¼å¼ï¼‰çš„ç›¸å¼‚æˆ–ä¸º0ï¼Œå³\n   ä½ç½® 0001 0010 0011 0100 0101 0110 0111 1000 1001 1010 1011     å†…å®¹ x1 x2 1 x3 0 1 0 x4 1 1 0    $$\nx3 \\oplus 0 \\oplus 1 \\oplus 0 = 0\n$$\nåˆ™x3 = 1ã€‚\nè®¡ç®—x4:\nx4æ˜¯ç¬¬å››ä¸ªæ ¡éªŒç ï¼Œä½ç½®å¯¹åº”æ æ‰€æœ‰å€’æ•°ç¬¬å››ä½ä¸º1ï¼ˆ1xxxæ ¼å¼ï¼‰çš„ç›¸å¼‚æˆ–ä¸º0ï¼Œå³\n   ä½ç½® 0001 0010 0011 0100 0101 0110 0111 1000 1001 1010 1011     å†…å®¹ x1 x2 1 x3 0 1 0 x4 1 1 0    $$\nx4 \\oplus 1 \\oplus 1 \\oplus 0 = 0\n$$\nåˆ™x4 = 0ã€‚\næ‰€ä»¥æœ€ç»ˆçš„æ±‰æ˜ç ä¸º: 01100100110,å³\n   ä½ç½® 0001 0010 0011 0100 0101 0110 0111 1000 1001 1010 1011     å†…å®¹ 0 1 1 1 0 1 0 0 1 1 0    å¦‚ä½•è¿›è¡Œæ ¡éªŒï¼Ÿ   å‡è®¾ä½ç½®ä¸º1011çš„æ•°æ®ä¼ è¾“é”™è¯¯ï¼Œç”±0å˜æˆäº†1ï¼Œåˆ™æ ¡éªŒçº é”™çš„è¿‡ç¨‹ä¸ºï¼š\nå°†æ‰€æœ‰ä½ç½®å½¢å¦‚xxx1, xx1x, x1xx, 1xxxçš„æ•°æ®åˆ†åˆ«å¼‚æˆ–ã€‚\nxxx1: 0^1^0^0^1^1 = 1\nxx1x: 1^1^1^0^1^1 = 1\nx1x: 1^0^1^0 = 0\n1xxx: 0^1^1^1 = 1\né‚£ä¹ˆå‡ºé”™æ•°æ®çš„ä½ç½®ä¸º1011ï¼Œè¿™æ ·ä¾¿å¯å¾—åˆ°å‡ºé”™çš„ä½ç½®ã€‚\n  å‡è®¾åŒæ—¶æœ‰ä¸¤ä¸ªä½ç½®å‡ºé”™ï¼Œæœ¬ä¾‹ä¸­å‡è®¾ä½ç½®ä¸º1010å¯¹åº”æ•°æ®ç”±1å˜æˆ0,ï¼Œä½ç½®ä¸º1011å¯¹åº”æ•°æ®ç”±0å˜æˆ1ï¼Œåˆ™æ¨å‡ºæ ¡éªŒçº é”™è¿‡ç¨‹ï¼š\nxxx1: 0^1^0^0^1^1 = 1\nxx1x: 1^1^1^0^0^1 = 0\nx1x: 1^0^1^0 = 0\n1xxx: 0^1^0^1 = 0\né‚£ä¹ˆæ ¡ç®—å‡ºçš„é”™è¯¯ä½æ˜¯0001ï¼Œå³ç¬¬ä¸€ä½ï¼›ä½†å®é™…ä¸Šæ˜¯å€’æ•°ç¬¬äºŒä½å’Œæœ€åä¸€ä½éƒ½æœ‰é”™è¯¯ï¼Œè¯´æ˜æµ·æ˜ç ä¸èƒ½æ ¡éªŒä¸¤ä½ä»¥ä¸Šå‡ºé”™çš„æ•°æ®ï¼Œå³æµ·æ˜ç åªèƒ½æ£€æµ‹å¹¶çº æ­£ä¸€ä½é”™è¯¯ã€‚\n  more å¦‚æœä¸€æ¡ä¿¡æ¯ä¸­åŒ…å«æ›´å¤šç”¨äºçº é”™çš„ä½ï¼Œä¸”é€šè¿‡å¦¥å–„å®‰æ’è¿™äº›çº é”™ä½ä½¿å¾—ä¸åŒçš„å‡ºé”™ä½äº§ç”Ÿä¸åŒçš„é”™è¯¯ç»“æœï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ‰¾å‡ºå‡ºé”™ä½äº†ã€‚åœ¨ä¸€ä¸ª7ä½çš„ä¿¡æ¯ä¸­ï¼Œå•ä¸ªä½å‡ºé”™æœ‰7ç§å¯èƒ½ï¼Œå› æ­¤3ä¸ªé”™è¯¯æ§åˆ¶ä½å°±è¶³ä»¥ç¡®å®šæ˜¯å¦å‡ºé”™åŠå“ªä¸€ä½å‡ºé”™äº†ã€‚\næ±‰æ˜ç ”ç©¶äº†åŒ…æ‹¬äº”å–äºŒç åœ¨å†…çš„ç¼–ç æ–¹æ¡ˆï¼Œå¹¶å½’çº³äº†ä»–ä»¬çš„æƒ³æ³•ã€‚\nReferenceï¼š\n æ±‰æ˜ç ï¼ˆæµ·æ˜ç ã€hamming codeï¼‰é€šä¿—æ˜“æ‡‚çš„è§£é‡Š æµ·æ˜ç ä¹‹ç¼–ç åŸç†å’Œæ ¡éªŒæ–¹æ³• ä¸‰è“ä¸€è¤ æ±‰æ˜ç  ç»´åŸºç™¾ç§‘ https://zh.wikipedia.org/wiki/%E6%B1%89%E6%98%8E%E7%A0%81  ","description":"åœ¨ä¸€ä¸ª7ä½çš„ä¿¡æ¯ä¸­ï¼Œå•ä¸ªä½å‡ºé”™æœ‰7ç§å¯èƒ½ï¼Œå› æ­¤3ä¸ªé”™è¯¯æ§åˆ¶ä½å°±è¶³ä»¥ç¡®å®šæ˜¯å¦å‡ºé”™åŠå“ªä¸€ä½å‡ºé”™äº†ã€‚","id":53,"section":"posts","tags":["æ±‰æ˜ç "],"title":"æ±‰æ˜ç ","uri":"https://hugo.jiahongw.com/zh/posts/network/hamming-code/"},{"content":"æ±‚èŒåŸç†ä¸‰è¦ç´  1. ä»·å€¼ ç»â¼¤éƒ¨åˆ†å…¬å¸è´­ä¹°â¼ˆæ‰éƒ½æ˜¯ä¸ºäº†ä½¿â½¤ï¼Œæ‰€ä»¥ä»–ä»¬çœ‹ä¸­çš„æ˜¯å…¶ä½¿â½¤ä»·å€¼ï¼è¿™ä¸ªä½¿â½¤ä»·å€¼è¯´å¾—æ›´ç›´â½©â¼€ç‚¹ï¼Œå°±æ˜¯â¼ˆæ‰å¦‚ä½•ç›´æ¥æˆ–è€…é—´æ¥çš„ä¸ºå…¬å¸æŒ£é’±ã€‚\n2. ä¾›éœ€ ä¸€ä¸ªæ®µå­ï¼š\n è¯»â¼©å­¦æ—¶ï¼Œâ¼¤å­¦ä¸è¦é’±ï¼›è¯»â¼¤å­¦æ—¶ï¼Œâ¼©å­¦ä¸è¦é’±ï¼›è¿˜æ²¡â¼¯ä½œæ—¶ï¼Œâ¼¯ä½œæ˜¯åˆ†é…çš„ï¼›å¯ä»¥â¼¯ä½œæ—¶ï¼Œå¾—â¾ƒè°‹èŒä¸šï¼›æ²¡æŒ£é’±æ—¶ï¼Œæˆ¿â¼¦æ˜¯åˆ†é…çš„ï¼›èƒ½æŒ£é’±æ—¶ï¼Œå‘ç°â¼€è¾ˆâ¼¦çš„è–ªâ½”ä¹Ÿä¹°ä¸èµ·æˆ¿â¼¦ã€‚\n ç®€å•çš„è¯´ï¼Œå½“ä¼ä¸šçš„èŒä½ç©ºç¼ºè¿œå°‘äºæ‰¾â¼¯ä½œçš„â¼ˆæ•°æ—¶ï¼Œâ¼ˆæ‰çš„ä»·æ ¼å°±ä¼šä¸‹é™ï¼›â½½å½“ä¼ä¸šçš„èŒä½ç©ºç¼ºâ½æ‰¾â¼¯ä½œçš„â¼ˆæ•°æ›´å¤šæ—¶ï¼Œâ¼ˆæ‰çš„ä»·æ ¼å°±ä¼šä¸Šå‡ã€‚\nä¸¾ä¸ªä¾‹â¼¦ï¼ŒåŒæ ·æ˜¯ç®¡æœåŠ¡å™¨ï¼Œæ™®é€šè¿ç»´â¼¯ç¨‹å¸ˆå’Œäº‘è®¡ç®—è¿ç»´â¼¯ç¨‹å¸ˆçš„è–ªèµ„å·®å¼‚æ˜¯â¾®å¸¸â¼¤çš„ã€‚â¼€ä¸ªæ™®é€šè¿ç»´è¦å˜æˆäº‘è®¡ç®—è¿ç»´ï¼Œéœ€è¦è¡¥å……çš„çŸ¥è¯†å¹¶ä¸æ˜¯ç‰¹åˆ«å¤šã€‚æ‰€ä»¥ä½ åªè¦åˆç†å®‰æ’å¥½â¾ƒâ¼°çš„èŒä¸šè§„åˆ’ï¼Œâ½å¦‚ä»¥ç›¸å¯¹è¾ƒä½çš„è–ªèµ„åˆ°ç±»ä¼¼æ–°æµªäº‘è¿™æ ·çš„åœ°â½…â¼¯ä½œâ¼€åˆ°ä¸¤å¹´ï¼Œä½ çš„èƒ½â¼’å’Œäº¤æ¢ä»·å€¼éƒ½ä¼šâ¼¤å¹…åº¦æå‡ã€‚\n3. ä¿¡æ¯é€æ˜åº¦ å½“â¼ˆæ‰å¸‚åœºå¾ˆâ¼©çš„æ—¶å€™ï¼Œä¿¡æ¯æ˜¯å¾ˆé€æ˜çš„ã€‚å› ä¸ºå¾ˆå®¹æ˜“äº†è§£åˆ°å„â¾ƒçš„æƒ…å†µã€‚\nä½†å½“ä¿¡æ¯é‡å˜â¼¤åï¼Œä½ å°±ä¼šå‘ç°è™½ç„¶æ•´ä¸ªå¸‚åœºå¾ˆâ¼¤ï¼Œä½†åªæœ‰ä½ æ¥è§¦åˆ°çš„æ‰å¯¹ä½ æœ‰æ„ä¹‰ã€‚\n â½å¦‚åŒ—äº¬ç°åœ¨æœ‰100å®¶å…¬å¸éƒ½åœ¨æ‹›è˜PHPï¼Œä½†ä½ åªçŸ¥é“å…¶ä¸­3å®¶ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå…¶ä»–97å®¶å…¬\nå¸çš„å­˜åœ¨å¯¹ä½ â½½â¾”æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå³ä½¿è¿™3å®¶ç»™ä½ çš„è–ªèµ„â½å…¶ä»–å…¬å¸ä½ï¼Œä½ ä¹Ÿåªèƒ½è¢«è¿«æ¥\nå—ã€‚è¿™å°±æ˜¯ä¿¡æ¯é€æ˜åº¦å¯¹æˆ‘ä»¬æ±‚èŒçš„å½±å“ã€‚\n æ‰€ä»¥è¦æƒ³æ‹¿åˆ°â¾œå¤Ÿå¥½çš„è–ªèµ„å’Œè·å¾—â¾œå¤Ÿå¤šçš„æœºä¼šï¼Œæˆ‘ä»¬è¦å­¦ä¼šå’Œä¿¡æ¯ä¸å¯¹ç§°è¿›â¾æŠ—äº‰ã€‚â¼€\nå®šè¦åœ¨çŸ­æ—¶é—´å†…è·å–åˆ°â¼¤é‡çš„æœºä¼šï¼Œè¿™æ ·æ‰èƒ½ã€Œ åšé€‰æ‹©é¢˜ ã€â½½ä¸æ˜¯ã€Œ åšåˆ¤æ–­é¢˜ ã€ã€‚\nç¨‹åºå‘˜èŒä¸šè·¯çº¿å›¾ æ„å»ºä¸ªäººå“ç‰Œ å¯¹äºæŠ€æœ¯â¼ˆå‘˜ï¼Œä¸‹è¾¹è¿™ä¸ªåˆ—è¡¨æˆ‘æ˜¯å»ºè®®ä½ è¦æœ‰çš„ï¼š\n Githubè´¦å·ï¼Œä¸è§£é‡Šã€‚ æŠ€æœ¯åšå®¢ï¼Œå¯ä»¥ç›´æ¥æ”¾åˆ°Githubä¸Šï¼ŒBigæ›´â¾¼ã€‚ å¾®åšï¼Œæœ€å¥½èƒ½åŠ Vï¼Œâ½¤äºä¸šå†…äº¤æµã€‚ æŠ€æœ¯ç¤¾åŒºè´¦å·ï¼Œâ½å¦‚stackoverflowã€‚  æœ¬æ–‡å–è‡ªã€Šç¨‹åºå‘˜è·³æ§½æ”»ç•¥ã€‹\n","description":"æ°¸è¿œä¸è¦å› ä¸ºã€Œç°åœ¨å¾ˆå·®ã€è€Œè·³æ§½ï¼Œè¦å› ä¸ºã€Œæœªæ¥æ›´å¥½ã€è€Œè·³æ§½ã€‚åªæœ‰è¿™æ ·æ‰èƒ½ä¿è¯ä½ ä¸€ç›´å¾€ä¸Šèµ°ã€‚","id":54,"section":"posts","tags":["è·³æ§½"],"title":"ç¨‹åºå‘˜èŒä¸šè·¯çº¿","uri":"https://hugo.jiahongw.com/zh/posts/ideas/programer-go-go/"},{"content":"ä»ä¸¤ä¸ªå±‚é¢ä¸Šæ¥è¯´ï¼šä¸€ä¸ªæ˜¯æ•°æ®çš„è®¿é—®é¢‘æ¬¡å±‚é¢ï¼Œä¸€ä¸ªæ˜¯æ•°æ®åˆ†æå±‚é¢ã€‚\nè®¿é—®é¢‘æ¬¡å±‚é¢ çƒ­æ•°æ®ï¼šæ˜¯éœ€è¦è¢«è®¡ç®—èŠ‚ç‚¹é¢‘ç¹è®¿é—®çš„åœ¨çº¿ç±»æ•°æ®ã€‚\nå†·æ•°æ®ï¼šæ˜¯å¯¹äºç¦»çº¿ç±»ä¸ç»å¸¸è®¿é—®çš„æ•°æ®ï¼Œæ¯”å¦‚ä¼ä¸šå¤‡ä»½æ•°æ®ã€ä¸šåŠ¡ä¸æ“ä½œæ—¥å¿—æ•°æ®ã€è¯å•ä¸ç»Ÿè®¡æ•°æ®ã€‚\næ•°æ®åˆ†æå±‚é¢ ç‹¬æœ‰çš„æ•°æ®æŠ€æœ¯å¼•æ“ï¼šå†·æ•°æ®ã€æ¸©æ•°æ®å’Œçƒ­æ•°æ®ã€‚\n å†·æ•°æ®â€”â€”æ€§åˆ«ã€å…´è¶£ã€å¸¸ä½åœ°ã€èŒä¸šã€å¹´é¾„ç­‰æ•°æ®ç”»åƒï¼Œè¡¨å¾â€œè¿™æ˜¯ä»€ä¹ˆæ ·çš„äººâ€ï¼› æ¸©æ•°æ®â€”â€”è¿‘æœŸæ´»è·ƒåº”ç”¨ã€è¿‘æœŸå»è¿‡çš„åœ°æ–¹ç­‰å…·æœ‰ä¸€å®šæ—¶æ•ˆæ€§çš„è¡Œä¸ºæ•°æ®ï¼Œè¡¨å¾â€œæœ€è¿‘å¯¹ä»€ä¹ˆæ„Ÿå…´è¶£â€ï¼› çƒ­æ•°æ®â€”â€”å½“å‰åœ°ç‚¹ã€æ‰“å¼€çš„åº”ç”¨ç­‰åœºæ™¯åŒ–æ˜æ˜¾çš„ã€ç¨çºµå³é€çš„è¥é”€æœºä¼šï¼Œè¡¨å¾â€œæ­£åœ¨å“ªé‡Œå¹²ä»€ä¹ˆâ€ã€‚  Referenceï¼š\n å†·æ•°æ®ã€æ¸©æ•°æ®ã€çƒ­æ•°æ®ï¼Œéš¾é“æ•°æ®ä¹Ÿæ˜¯æœ‰æ¸©åº¦çš„ï¼Ÿ  ","description":"æ¸©åº¦è¿˜æœ‰æ•°æ®äº†ï¼Ÿæˆ‘å°±å¥‡æ€ªäº†ã€‚","id":55,"section":"posts","tags":["å†·æ•°æ®","çƒ­æ•°æ®"],"title":"å†·æ•°æ®ä¸çƒ­æ•°æ®","uri":"https://hugo.jiahongw.com/zh/posts/cloudcomputing/data-hot-ice/"},{"content":"æœ€è¿‘åœ¨çŸ¥ä¹ä¸“æ ã€Šé«˜æ•ˆå­¦ä¹ æ³•ã€‹ä¸­çœ‹åˆ°ä¸€ç¯‡æ¯”è¾ƒæœ‰ç”¨çš„æ–‡ç« ï¼Œä¸»è¦å°±æ˜¯è®²é«˜æ•ˆäººå£«çš„å…­ä¸ªå¥½ä¹ æƒ¯ã€‚æˆ‘è§‰å¾—è¿™äº›ä¹ æƒ¯å€’æ˜¯å¯ä»¥å¥½å¥½å­¦ä¹ ï¼Œå› ä¸ºå…¶å®æœ‰å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¸èƒ½å¤Ÿåˆ¤æ–­è‡ªå·±å½“å‰æœ€åº”è¯¥åšä»€ä¹ˆäº‹æƒ…ã€‚å‡å¦‚æˆ‘ä»¬è¿™ä¸ªæ—¶å€™æœ‰äº†ä¸€ä¸ªå¥½çš„ä¹ æƒ¯ä½œä¸ºå‡†åˆ™ï¼Œä¸€èˆ¬æ¥è¯´æˆ‘ä»¬éƒ½ä¼šåšå‡ºä¸€ä¸ªæ¯”è¾ƒæ­£ç¡®çš„é€‰æ‹©ã€‚è‡³å°‘ï¼Œæˆ‘ä»¬ä¼šå˜å¾—æ›´ä¼˜ç§€ï¼\nä¸‹é¢æ˜¯éº¦è‚¯é”¡æ€ç»´é«˜æ•ˆå·¥ä½œçš„å…­ä¸ªä¹ æƒ¯ï¼š\n  åšæ­£ç¡®çš„äº‹å’Œæ­£ç¡®çš„åšäº‹ã€‚ è¿™ä¸ªä¹ æƒ¯ä¸€æ–¹é¢å¼ºè°ƒé€‰æ‹©æ¯”åŠªåŠ›æ›´é‡è¦ï¼Œå¦ä¸€æ–¹é¢åˆå¼ºè°ƒäº†é€‰å¯¹æ–¹æ³•è§£å†³é—®é¢˜å¾ˆé‡è¦ã€‚\n  æé«˜æ•ˆç‡çš„èµ·ç‚¹â€”â€”ç®¡ç†æ—¶é—´ å¯¹äº‹æƒ…çš„é‡è¦ç¨‹åº¦å’Œç´§æ€¥ç¨‹åº¦è¿›è¡Œæ’åº\n  æ‰¾åˆ°å…³é”®çš„é©±åŠ¨ç‚¹ï¼Œæ‰èƒ½æ›´å¥½çš„è§£å†³é—®é¢˜ã€‚   ä½¿ç”¨é€»è¾‘æ ‘åˆ†ææ³•è§£å†³æœ‰éš¾åº¦çš„é—®é¢˜ å°†å¤æ‚çš„é—®é¢˜åˆ†è§£ä¸ºå°è€Œç®€å•çš„é—®é¢˜ï¼Œå…ˆä»å°äº‹åšèµ·ï¼Œæ‰¾åˆ°æˆå°±æ„Ÿã€‚\n  å¦‚ä½•æŠŠå·¥ä½œç®€å•åŒ–ï¼Ÿ  æ‰¾åˆ°é‡ç‚¹ æé«˜æŠ€æœ¯æ°´å¹³ æˆæƒæˆ–å¤–åŒ… å–æ¶ˆ    æé«˜æ•ˆç‡çš„ç»æ‹›â€”â€”ç©¿é€åŠ› é›†ä¸­å…¨éƒ¨åŠ›é‡åœ¨ä½ è¦åšçš„é‡è¦äº‹æƒ…ä¸Šã€‚\n æ‘†è„±äº‹ç‰© æŠ—å¹²æ‰° æ˜ç¡®ç›®æ ‡    ","description":"ä¸€ä¸ªå¥½çš„ä¹ æƒ¯èƒ½å¤Ÿè®©ä½ åšäº‹æƒ…æ›´åŠ çš„è½»æ¾ï¼Œä¹Ÿèƒ½å¤Ÿå±•ç¤ºä½ è¿™ä¸ªäººçš„é£æ ¼ï¼›å¥½çš„ä¹ æƒ¯æ˜¯åå¤©å…»æˆçš„ï¼Œä¸æ˜¯ä¸€è¹´è€Œå°±çš„ã€‚","id":56,"section":"posts","tags":["ä¹ æƒ¯"],"title":"é«˜æ•ˆäººå£«çš„å‡ ä¸ªä¹ æƒ¯","uri":"https://hugo.jiahongw.com/zh/posts/ideas/seven-habits/"},{"content":"å¦‚ä½•è®©ç½‘ç»œæ•°æ®ä¼ è¾“åœ°æ›´å¿«ï¼Ÿ(åˆå¹¶ä¸€äº›å±‚)\nä¸ºä»€ä¹ˆéœ€è¦QUICï¼Ÿ   ä¸­é—´è®¾å¤‡çš„åƒµåŒ–\nå¯èƒ½æ˜¯ TCP åè®®ä½¿ç”¨å¾—å¤ªä¹…ï¼Œä¹Ÿéå¸¸å¯é ã€‚æ‰€ä»¥æˆ‘ä»¬å¾ˆå¤šä¸­é—´è®¾å¤‡ï¼ŒåŒ…æ‹¬é˜²ç«å¢™ã€NAT ç½‘å…³ï¼Œæ•´æµå™¨ç­‰å‡ºç°äº†ä¸€äº›çº¦å®šä¿—æˆçš„åŠ¨ä½œã€‚\n  ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„å®ç°å¯¼è‡´åè®®åƒµåŒ–\nTCP æ˜¯ç”±æ“ä½œç³»ç»Ÿåœ¨å†…æ ¸è¥¿æ–¹æ ˆå±‚é¢å®ç°çš„ï¼Œåº”ç”¨ç¨‹åºåªèƒ½ä½¿ç”¨ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ã€‚è™½ç„¶åº”ç”¨ç¨‹åºçš„æ›´æ–°è¿­ä»£éå¸¸å¿«é€Ÿå’Œç®€å•ã€‚ä½†æ˜¯ TCP çš„è¿­ä»£å´éå¸¸ç¼“æ…¢ï¼ŒåŸå› å°±æ˜¯æ“ä½œç³»ç»Ÿå‡çº§å¾ˆéº»çƒ¦ã€‚\n  å»ºç«‹è¿æ¥çš„æ¡æ‰‹å»¶è¿Ÿå¤§\nä¸ç®¡æ˜¯ HTTP1.0/1.1 è¿˜æ˜¯ HTTPSï¼ŒHTTP2ï¼Œéƒ½ä½¿ç”¨äº† TCP è¿›è¡Œä¼ è¾“ã€‚HTTPS å’Œ HTTP2 è¿˜éœ€è¦ä½¿ç”¨ TLS åè®®æ¥è¿›è¡Œå®‰å…¨ä¼ è¾“ã€‚è¿™å°±å‡ºç°äº†ä¸¤ä¸ªæ¡æ‰‹å»¶è¿Ÿï¼š\n  TCP ä¸‰æ¬¡æ¡æ‰‹å¯¼è‡´çš„ TCP è¿æ¥å»ºç«‹çš„å»¶è¿Ÿã€‚\n  TLS å®Œå…¨æ¡æ‰‹éœ€è¦è‡³å°‘ 2 ä¸ª RTT æ‰èƒ½å»ºç«‹ï¼Œç®€åŒ–æ¡æ‰‹éœ€è¦ 1 ä¸ª RTT çš„æ¡æ‰‹å»¶è¿Ÿã€‚\n  å¯¹äºå¾ˆå¤šçŸ­è¿æ¥åœºæ™¯ï¼Œè¿™æ ·çš„æ¡æ‰‹å»¶è¿Ÿå½±å“å¾ˆå¤§ï¼Œä¸”æ— æ³•æ¶ˆé™¤ã€‚\n  é˜Ÿå¤´é˜»å¡\né˜Ÿå¤´é˜»å¡ä¸»è¦æ˜¯ TCP åè®®çš„å¯é æ€§æœºåˆ¶å¼•å…¥çš„ã€‚TCP ä½¿ç”¨åºåˆ—å·æ¥æ ‡è¯†æ•°æ®çš„é¡ºåºï¼Œæ•°æ®å¿…é¡»æŒ‰ç…§é¡ºåºå¤„ç†ï¼Œå¦‚æœå‰é¢çš„æ•°æ®ä¸¢å¤±ï¼Œåé¢çš„æ•°æ®å°±ç®—åˆ°è¾¾äº†ä¹Ÿä¸ä¼šé€šçŸ¥åº”ç”¨å±‚æ¥å¤„ç†ã€‚\nå¦å¤– TLS åè®®å±‚é¢ä¹Ÿæœ‰ä¸€ä¸ªé˜Ÿå¤´é˜»å¡ï¼Œå› ä¸º TLS åè®®éƒ½æ˜¯æŒ‰ç…§ record æ¥å¤„ç†æ•°æ®çš„ï¼Œå¦‚æœä¸€ä¸ª record ä¸­ä¸¢å¤±äº†æ•°æ®ï¼Œä¹Ÿä¼šå¯¼è‡´æ•´ä¸ª record æ— æ³•æ­£ç¡®å¤„ç†ã€‚\n  QUIC åè®®é€‰æ‹©äº† UDPï¼Œå› ä¸º UDP æœ¬èº«æ²¡æœ‰è¿æ¥çš„æ¦‚å¿µï¼Œä¸éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¼˜åŒ–äº†è¿æ¥å»ºç«‹çš„æ¡æ‰‹å»¶è¿Ÿï¼ŒåŒæ—¶åœ¨åº”ç”¨ç¨‹åºå±‚é¢å®ç°äº† TCP çš„å¯é æ€§ï¼ŒTLS çš„å®‰å…¨æ€§å’Œ HTTP2 çš„å¹¶å‘æ€§ï¼Œåªéœ€è¦ç”¨æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„åº”ç”¨ç¨‹åºæ”¯æŒ QUIC åè®®ï¼Œå®Œå…¨é¿å¼€äº†æ“ä½œç³»ç»Ÿå’Œä¸­é—´è®¾å¤‡çš„é™åˆ¶ã€‚\nQUICæ¦‚è¿° QUIC æ˜¯ Quick UDP Internet Connections çš„ç¼©å†™ï¼Œè°·æ­Œå‘æ˜çš„æ–°ä¼ è¾“åè®®ã€‚\n ä¸ TCP ç›¸æ¯”ï¼ŒQUIC å¯ä»¥å‡å°‘å»¶è¿Ÿã€‚\n QUIC åè®®å¯ä»¥åœ¨ 1 åˆ° 2 ä¸ªæ•°æ®åŒ…ï¼ˆå–å†³äºè¿æ¥çš„æœåŠ¡å™¨æ˜¯æ–°çš„è¿˜æ˜¯å·²çŸ¥çš„ï¼‰å†…ï¼Œå®Œæˆè¿æ¥çš„åˆ›å»ºï¼ˆåŒ…æ‹¬ TLSï¼‰ã€‚\nQUIC ä¸ç°æœ‰ TCP + TLS + HTTP/2 æ–¹æ¡ˆç›¸æ¯”ï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹ä¸»è¦ç‰¹å¾ï¼š\n åˆ©ç”¨ç¼“å­˜ï¼Œæ˜¾è‘—å‡å°‘è¿æ¥å»ºç«‹æ—¶é—´ï¼›(å‡å°‘äº† TCP ä¸‰æ¬¡æ¡æ‰‹åŠ TLS æ¡æ‰‹æ—¶é—´) æ”¹å–„æ‹¥å¡æ§åˆ¶ï¼Œæ‹¥å¡æ§åˆ¶ä»å†…æ ¸ç©ºé—´åˆ°ç”¨æˆ·ç©ºé—´ï¼› æ²¡æœ‰ head of line é˜»å¡çš„å¤šè·¯å¤ç”¨ï¼› å‰å‘çº é”™ï¼Œå‡å°‘é‡ä¼ ï¼› è¿æ¥å¹³æ»‘è¿ç§»ï¼Œç½‘ç»œçŠ¶æ€çš„å˜æ›´ä¸ä¼šå½±å“è¿æ¥æ–­çº¿ã€‚  æ‹¥å¡æ§åˆ¶ã€åŠ å¯†å’Œä¸€äº›HTTP/2çš„ç‰¹æ€§éƒ½ç§»åŠ¨åˆ°QUICå±‚å»äº†\nä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼ŒQUIC åº•å±‚é€šè¿‡ UDP åè®®æ›¿ä»£äº† TCPï¼Œä¸Šå±‚åªéœ€è¦ä¸€å±‚ç”¨äºå’Œè¿œç¨‹æœåŠ¡å™¨äº¤äº’çš„ HTTP/2 APIã€‚è¿™æ˜¯å› ä¸º QUIC åè®®å·²ç»åŒ…å«äº†å¤šè·¯å¤ç”¨å’Œè¿æ¥ç®¡ç†ï¼ŒHTTP API åªéœ€è¦å®Œæˆ HTTP åè®®çš„è§£æå³å¯ã€‚\nQUICä¹Ÿåˆå¹¶äº†TLSæ¡æ‰‹è¿‡ç¨‹åˆ°å®ƒçš„è¿æ¥è¿‡ç¨‹ä¹‹ä¸­\nç›®æ ‡ QUIC åè®®çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯ä¸ºäº†æ•´åˆ TCP åè®®çš„å¯é æ€§å’Œ UDP åè®®çš„é€Ÿåº¦å’Œæ•ˆç‡ã€‚\nQUICè¿æ¥è¿‡ç¨‹ å¦‚ä½•åšåˆ°0RTTï¼Ÿ é¦–å…ˆè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯0RTTã€‚\næ‰€è°“çš„0RTTå°±æ˜¯ï¼Œé€šä¿¡åŒæ–¹å‘èµ·é€šä¿¡è¿æ¥æ—¶ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…ä¾¿å¯ä»¥æºå¸¦æœ‰æ•ˆçš„ä¸šåŠ¡æ•°æ®ã€‚è€Œæˆ‘ä»¬çŸ¥é“ï¼Œè¿™ä¸ªä½¿ç”¨ä¼ ç»Ÿçš„TCPæ˜¯å®Œå…¨ä¸å¯èƒ½çš„ï¼Œé™¤éä½ ä½¿èƒ½äº†TCP Fast Openç‰¹æ€§ï¼Œè€Œè¿™ä¸ªå¾ˆéš¾ï¼Œå› ä¸ºå‡ ä¹æ²¡äººæ„¿æ„ä¸ºäº†è¿™ä¸ªæ”¶ç›Šå»å¯¹æ“ä½œç³»ç»Ÿçš„ç½‘ç»œåè®®æ ˆå¤§åŠ¨æ‰‹è„šã€‚æœªä½¿èƒ½Fast Opençš„TCPä¼ è¾“ç¬¬ä¸€ç¬”æ•°æ®å‰ï¼Œè‡³å°‘è¦ç­‰1ä¸ªRTTï¼š\næ­¤å¤–ï¼Œå¯¹äºHTTPSè¿™ç§åº”ç”¨è€Œè¨€ï¼Œç”±äºè¿˜éœ€è¦é¢å¤–çš„TLSæ¡æ‰‹ï¼Œ0RTTå°±æ›´ä¸å¯èƒ½äº†ã€‚\né¦–å…ˆå£°æ˜ä¸€ç‚¹ï¼Œå¦‚æœä¸€å¯¹ä½¿ç”¨QUICè¿›è¡ŒåŠ å¯†é€šä¿¡çš„åŒæ–¹æ­¤å‰ä»æ¥æ²¡æœ‰é€šä¿¡è¿‡ï¼Œé‚£ä¹ˆ0RTTæ˜¯ä¸å¯èƒ½çš„ï¼Œå³ä¾¿æ˜¯QUICä¹Ÿæ˜¯ä¸å¯èƒ½çš„ï¼Œæ‰€è°“çš„0RTTæ˜¯å€¼ä¹‹å‰è¿æ¥è¿‡æœåŠ¡å™¨ï¼Œåé¢å†æ¬¡è¿æ¥çš„æ—¶å€™å°±æ˜¯0RTTã€‚\nè¿æ¥è¿‡ç¨‹ Step1ï¼šé¦–æ¬¡è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å‘é€ Inchoate Client Hello ç»™æœåŠ¡ç«¯ï¼Œç”¨äºè¯·æ±‚è¿æ¥ï¼›\nStep2ï¼šæœåŠ¡ç«¯ç”Ÿæˆ gã€pã€aï¼Œæ ¹æ® gã€p å’Œ a ç®—å‡º Aï¼Œç„¶åå°† gã€pã€A æ”¾åˆ° Server Config ä¸­å†å‘é€ Rejection æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼›\nStep3ï¼šå®¢æˆ·ç«¯æ¥æ”¶åˆ° gã€pã€A åï¼Œè‡ªå·±å†ç”Ÿæˆ bï¼Œæ ¹æ® gã€pã€b ç®—å‡º Bï¼Œæ ¹æ® Aã€pã€b ç®—å‡ºåˆå§‹å¯†é’¥ Kã€‚B å’Œ K ç®—å¥½åï¼Œå®¢æˆ·ç«¯ä¼šç”¨ K åŠ å¯† HTTP æ•°æ®ï¼Œè¿åŒ B ä¸€èµ·å‘é€ç»™æœåŠ¡ç«¯ï¼›\nStep4ï¼šæœåŠ¡ç«¯æ¥æ”¶åˆ° B åï¼Œæ ¹æ® aã€pã€B ç”Ÿæˆä¸å®¢æˆ·ç«¯åŒæ ·çš„å¯†é’¥ï¼Œå†ç”¨è¿™å¯†é’¥è§£å¯†æ”¶åˆ°çš„ HTTP æ•°æ®ã€‚ä¸ºäº†è¿›ä¸€æ­¥çš„å®‰å…¨ï¼ˆå‰å‘å®‰å…¨æ€§ï¼‰ï¼ŒæœåŠ¡ç«¯ä¼šæ›´æ–°è‡ªå·±çš„éšæœºæ•° a å’Œå…¬é’¥ï¼Œå†ç”Ÿæˆæ–°çš„å¯†é’¥ Sï¼Œç„¶åæŠŠå…¬é’¥é€šè¿‡ Server Hello å‘é€ç»™å®¢æˆ·ç«¯ã€‚è¿åŒ Server Hello æ¶ˆæ¯ï¼Œè¿˜æœ‰ HTTP è¿”å›æ•°æ®ï¼›\nStep5ï¼šå®¢æˆ·ç«¯æ”¶åˆ° Server Hello åï¼Œç”Ÿæˆä¸æœåŠ¡ç«¯ä¸€è‡´çš„æ–°å¯†é’¥ Sï¼Œåé¢çš„ä¼ è¾“éƒ½ä½¿ç”¨ S åŠ å¯†ã€‚\nè¿™æ ·ï¼ŒQUIC ä»è¯·æ±‚è¿æ¥åˆ°æ­£å¼æ¥å‘ HTTP æ•°æ®ä¸€å…±èŠ±äº† 1 RTTï¼Œè¿™ 1 ä¸ª RTT ä¸»è¦æ˜¯ä¸ºäº†è·å– Server Configï¼Œåé¢çš„è¿æ¥å¦‚æœå®¢æˆ·ç«¯ç¼“å­˜äº† Server Configï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥å‘é€ HTTP æ•°æ®ï¼Œå®ç° 0 RTT å»ºç«‹è¿æ¥ã€‚\nè¿™é‡Œä½¿ç”¨çš„æ˜¯ DH å¯†é’¥äº¤æ¢ç®—æ³•ï¼ŒDH ç®—æ³•çš„æ ¸å¿ƒå°±æ˜¯æœåŠ¡ç«¯ç”Ÿæˆ aã€gã€p 3 ä¸ªéšæœºæ•°ï¼Œa è‡ªå·±æŒæœ‰ï¼Œg å’Œ p è¦ä¼ è¾“ç»™å®¢æˆ·ç«¯ï¼Œè€Œå®¢æˆ·ç«¯ä¼šç”Ÿæˆ b è¿™ 1 ä¸ªéšæœºæ•°ï¼Œé€šè¿‡ DH ç®—æ³•å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯ä»¥ç®—å‡ºåŒæ ·çš„å¯†é’¥ã€‚åœ¨è¿™è¿‡ç¨‹ä¸­ a å’Œ b å¹¶ä¸å‚ä¸ç½‘ç»œä¼ è¾“ï¼Œå®‰å…¨æ€§å¤§å¤§æé«˜ã€‚å› ä¸º p å’Œ g æ˜¯å¤§æ•°ï¼Œæ‰€ä»¥å³ä½¿åœ¨ç½‘ç»œä¸­ä¼ è¾“çš„ pã€gã€Aã€B éƒ½è¢«åŠ«æŒï¼Œé‚£ä¹ˆé ç°åœ¨çš„è®¡ç®—æœºç®—åŠ›ä¹Ÿæ²¡æ³•ç ´è§£å¯†é’¥ã€‚\nå¦‚ä¸‹å›¾ï¼š\nQUICè¿æ¥è¿ç§»  å½“æ‰‹æœºä»æ•°æ®ä¿¡å·åˆ‡æ¢åˆ°WIFIä¿¡å·æ—¶éœ€è¦å¯ä»¥çµæ´»çš„è¿›è¡Œè¿æ¥çš„åˆ‡æ¢ã€‚\n TCP è¿æ¥åŸºäºå››å…ƒç»„ï¼ˆæº IPã€æºç«¯å£ã€ç›®çš„ IPã€ç›®çš„ç«¯å£ï¼‰ï¼Œåˆ‡æ¢ç½‘ç»œæ—¶è‡³å°‘ä¼šæœ‰ä¸€ä¸ªå› ç´ å‘ç”Ÿå˜åŒ–ï¼Œå¯¼è‡´è¿æ¥å‘ç”Ÿå˜åŒ–ã€‚å½“è¿æ¥å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¦‚æœè¿˜ä½¿ç”¨åŸæ¥çš„ TCP è¿æ¥ï¼Œåˆ™ä¼šå¯¼è‡´è¿æ¥å¤±è´¥ï¼Œå°±å¾—ç­‰åŸæ¥çš„è¿æ¥è¶…æ—¶åé‡æ–°å»ºç«‹è¿æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰æ—¶å€™å‘ç°åˆ‡æ¢åˆ°ä¸€ä¸ªæ–°ç½‘ç»œæ—¶ï¼Œå³ä½¿æ–°ç½‘ç»œçŠ¶å†µè‰¯å¥½ï¼Œä½†å†…å®¹è¿˜æ˜¯éœ€è¦åŠ è½½å¾ˆä¹…ã€‚å¦‚æœå®ç°å¾—å¥½ï¼Œå½“æ£€æµ‹åˆ°ç½‘ç»œå˜åŒ–æ—¶ç«‹åˆ»å»ºç«‹æ–°çš„ TCP è¿æ¥ï¼Œå³ä½¿è¿™æ ·ï¼Œå»ºç«‹æ–°çš„è¿æ¥è¿˜æ˜¯éœ€è¦å‡ ç™¾æ¯«ç§’çš„æ—¶é—´ã€‚\nQUIC çš„è¿æ¥ä¸å—å››å…ƒç»„çš„å½±å“ï¼Œå½“è¿™å››ä¸ªå…ƒç´ å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒåŸè¿æ¥ä¾ç„¶ç»´æŒã€‚é‚£è¿™æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿé“ç†å¾ˆç®€å•ï¼ŒQUIC è¿æ¥ä¸ä»¥å››å…ƒç»„ä½œä¸ºæ ‡è¯†ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ª 64 ä½çš„éšæœºæ•°ï¼Œè¿™ä¸ªéšæœºæ•°è¢«ç§°ä¸º Connection IDï¼Œå³ä½¿ IP æˆ–è€…ç«¯å£å‘ç”Ÿå˜åŒ–ï¼Œåªè¦ Connection ID æ²¡æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆè¿æ¥ä¾ç„¶å¯ä»¥ç»´æŒã€‚\næ˜¯ä¸æ˜¯å¾ˆå¼º~\nQUICè§£å†³é˜Ÿå¤´é˜»å¡é—®é¢˜ HTTP ä¸€èˆ¬åˆå…è®¸æ¯ä¸ªä¸»æœºå»ºç«‹ 6 ä¸ª TCP è¿æ¥ï¼Œè¿™æ ·å¯ä»¥æ›´åŠ å……åˆ†åœ°åˆ©ç”¨å¸¦å®½èµ„æºï¼Œä½†æ¯ä¸ªè¿æ¥ä¸­é˜Ÿå¤´é˜»å¡çš„é—®é¢˜è¿˜æ˜¯å­˜åœ¨ã€‚\nHTTP/2 çš„å¤šè·¯å¤ç”¨è§£å†³äº†ä¸Šè¿°çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚ä¸åƒ HTTP/1.1 ä¸­åªæœ‰ä¸Šä¸€ä¸ªè¯·æ±‚çš„æ‰€æœ‰æ•°æ®åŒ…è¢«ä¼ è¾“å®Œæ¯•ä¸‹ä¸€ä¸ªè¯·æ±‚çš„æ•°æ®åŒ…æ‰å¯ä»¥è¢«ä¼ è¾“ï¼ŒHTTP/2 ä¸­æ¯ä¸ªè¯·æ±‚éƒ½è¢«æ‹†åˆ†æˆå¤šä¸ª Frame é€šè¿‡ä¸€æ¡ TCP è¿æ¥åŒæ—¶è¢«ä¼ è¾“ï¼Œè¿™æ ·å³ä½¿ä¸€ä¸ªè¯·æ±‚è¢«é˜»å¡ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–çš„è¯·æ±‚ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸åŒé¢œè‰²ä»£è¡¨ä¸åŒçš„è¯·æ±‚ï¼Œç›¸åŒé¢œè‰²çš„è‰²å—ä»£è¡¨è¯·æ±‚è¢«åˆ‡åˆ†çš„ Frameã€‚\näº‹æƒ…è¿˜æ²¡å®Œï¼ŒHTTP/2 è™½ç„¶å¯ä»¥è§£å†³â€œè¯·æ±‚â€è¿™ä¸ªç²’åº¦çš„é˜»å¡ï¼Œä½† HTTP/2 çš„åŸºç¡€ TCP åè®®æœ¬èº«å´ä¹Ÿå­˜åœ¨ç€é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ã€‚HTTP/2 çš„æ¯ä¸ªè¯·æ±‚éƒ½ä¼šè¢«æ‹†åˆ†æˆå¤šä¸ª Frameï¼Œä¸åŒè¯·æ±‚çš„ Frame ç»„åˆæˆ Streamï¼ŒStream æ˜¯ TCP ä¸Šçš„é€»è¾‘ä¼ è¾“å•å…ƒï¼Œè¿™æ · HTTP/2 å°±è¾¾åˆ°äº†ä¸€æ¡è¿æ¥åŒæ—¶å‘é€å¤šæ¡è¯·æ±‚çš„ç›®æ ‡ï¼Œè¿™å°±æ˜¯å¤šè·¯å¤ç”¨çš„åŸç†ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼Œåœ¨ä¸€æ¡ TCP è¿æ¥ä¸ŠåŒæ—¶å‘é€ 4 ä¸ª Streamï¼Œå…¶ä¸­ Stream1 å·²æ­£ç¡®é€è¾¾ï¼ŒStream2 ä¸­çš„ç¬¬ 3 ä¸ª Frame ä¸¢å¤±ï¼ŒTCP å¤„ç†æ•°æ®æ—¶æœ‰ä¸¥æ ¼çš„å‰åé¡ºåºï¼Œå…ˆå‘é€çš„ Frame è¦å…ˆè¢«å¤„ç†ï¼Œè¿™æ ·å°±ä¼šè¦æ±‚å‘é€æ–¹é‡æ–°å‘é€ç¬¬ 3 ä¸ª Frameï¼ŒStream3 å’Œ Stream4 è™½ç„¶å·²åˆ°è¾¾ä½†å´ä¸èƒ½è¢«å¤„ç†ï¼Œé‚£ä¹ˆè¿™æ—¶æ•´æ¡è¿æ¥éƒ½è¢«é˜»å¡ã€‚\nä¸ä»…å¦‚æ­¤ï¼Œç”±äº HTTP/2 å¿…é¡»ä½¿ç”¨ HTTPSï¼Œè€Œ HTTPS ä½¿ç”¨çš„ TLS åè®®ä¹Ÿå­˜åœ¨é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚TLS åŸºäº Record ç»„ç»‡æ•°æ®ï¼Œå°†ä¸€å †æ•°æ®æ”¾åœ¨ä¸€èµ·ï¼ˆå³ä¸€ä¸ª Recordï¼‰åŠ å¯†ï¼ŒåŠ å¯†å®Œååˆæ‹†åˆ†æˆå¤šä¸ª TCP åŒ…ä¼ è¾“ã€‚ä¸€èˆ¬æ¯ä¸ª Record 16Kï¼ŒåŒ…å« 12 ä¸ª TCP åŒ…ï¼Œè¿™æ ·å¦‚æœ 12 ä¸ª TCP åŒ…ä¸­æœ‰ä»»ä½•ä¸€ä¸ªåŒ…ä¸¢å¤±ï¼Œé‚£ä¹ˆæ•´ä¸ª Record éƒ½æ— æ³•è§£å¯†ã€‚\né‚£ QUIC æ˜¯å¦‚ä½•è§£å†³é˜Ÿå¤´é˜»å¡é—®é¢˜çš„å‘¢ï¼Ÿä¸»è¦æœ‰ä¸¤ç‚¹ã€‚\n QUIC çš„ä¼ è¾“å•å…ƒæ˜¯ Packetï¼ŒåŠ å¯†å•å…ƒä¹Ÿæ˜¯ Packetï¼Œæ•´ä¸ªåŠ å¯†ã€ä¼ è¾“ã€è§£å¯†éƒ½åŸºäº Packetï¼Œä¸ä¼šè·¨è¶Šå¤šä¸ª Packetï¼Œè¿™æ ·å°±èƒ½é¿å… TLS çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ï¼› QUIC åŸºäº UDPï¼ŒUDP çš„æ•°æ®åŒ…åœ¨æ¥æ”¶ç«¯æ²¡æœ‰å¤„ç†é¡ºåºï¼Œå³ä½¿ä¸­é—´ä¸¢å¤±ä¸€ä¸ªåŒ…ï¼Œä¹Ÿä¸ä¼šé˜»å¡æ•´æ¡è¿æ¥ï¼Œå…¶ä»–çš„èµ„æºä¼šè¢«æ­£å¸¸å¤„ç†ã€‚(Stream ä¹‹é—´ç›¸äº’ç‹¬ç«‹)   å½“ç„¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ QUIC æ•°æ®éƒ½ä¸ä¼šå—åˆ°é˜Ÿå¤´é˜»å¡çš„å½±å“ï¼Œæ¯”å¦‚ QUIC å½“å‰ä¹Ÿæ˜¯ä½¿ç”¨ Hpack å‹ç¼©ç®—æ³• [10]ï¼Œç”±äºç®—æ³•çš„é™åˆ¶ï¼Œä¸¢å¤±ä¸€ä¸ªå¤´éƒ¨æ•°æ®æ—¶ï¼Œå¯èƒ½é‡åˆ°é˜Ÿå¤´é˜»å¡ã€‚\næ€»ä½“æ¥è¯´ï¼ŒQUIC åœ¨ä¼ è¾“å¤§é‡æ•°æ®æ—¶ï¼Œæ¯”å¦‚è§†é¢‘ï¼Œå—åˆ°é˜Ÿå¤´é˜»å¡çš„å½±å“å¾ˆå°ã€‚\n QUICçš„æ‹¥å¡æ§åˆ¶(å¯æ’æ‹”) æ‹¥å¡æ§åˆ¶çš„ç›®çš„æ˜¯é¿å…è¿‡å¤šçš„æ•°æ®ä¸€ä¸‹å­æ¶Œå…¥ç½‘ç»œï¼Œå¯¼è‡´ç½‘ç»œè¶…å‡ºæœ€å¤§è´Ÿè·ã€‚QUIC çš„æ‹¥å¡æ§åˆ¶ä¸ TCP ç±»ä¼¼ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šåšäº†æ”¹è¿›ã€‚\nAIMD:çº¿æ€§å¢åŠ ï¼Œä¹˜æ€§å‡å°‘åé¦ˆæ§åˆ¶ç®—æ³•ã€‚\nçƒ­æ‹”æ’ TCP ä¸­å¦‚æœè¦ä¿®æ”¹æ‹¥å¡æ§åˆ¶ç­–ç•¥ï¼Œéœ€è¦åœ¨ç³»ç»Ÿå±‚é¢è¿›è¡Œæ“ä½œã€‚QUIC ä¿®æ”¹æ‹¥å¡æ§åˆ¶ç­–ç•¥åªéœ€è¦åœ¨åº”ç”¨å±‚æ“ä½œï¼Œå¹¶ä¸” QUIC ä¼šæ ¹æ®ä¸åŒçš„ç½‘ç»œç¯å¢ƒã€ç”¨æˆ·æ¥åŠ¨æ€é€‰æ‹©æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚\nQUICå‰å‘çº é”™FEC QUIC ä½¿ç”¨å‰å‘çº é”™(FECï¼ŒForward Error Correction)æŠ€æœ¯å¢åŠ åè®®çš„å®¹é”™æ€§ã€‚ä¸€æ®µæ•°æ®è¢«åˆ‡åˆ†ä¸º 10 ä¸ªåŒ…åï¼Œä¾æ¬¡å¯¹æ¯ä¸ªåŒ…è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œè¿ç®—ç»“æœä¼šä½œä¸º FEC åŒ…ä¸æ•°æ®åŒ…ä¸€èµ·è¢«ä¼ è¾“ï¼Œå¦‚æœä¸å¹¸åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªæ•°æ®åŒ…ä¸¢å¤±ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ ¹æ®å‰©ä½™ 9 ä¸ªåŒ…ä»¥åŠ FEC åŒ…æ¨ç®—å‡ºä¸¢å¤±çš„é‚£ä¸ªåŒ…çš„æ•°æ®ï¼Œè¿™æ ·å°±å¤§å¤§å¢åŠ äº†åè®®çš„å®¹é”™æ€§ã€‚\nè¿™æ˜¯ç¬¦åˆç°é˜¶æ®µç½‘ç»œæŠ€æœ¯çš„ä¸€ç§æ–¹æ¡ˆï¼Œç°é˜¶æ®µå¸¦å®½å·²ç»ä¸æ˜¯ç½‘ç»œä¼ è¾“çš„ç“¶é¢ˆï¼Œå¾€è¿”æ—¶é—´æ‰æ˜¯ï¼Œæ‰€ä»¥æ–°çš„ç½‘ç»œä¼ è¾“åè®®å¯ä»¥é€‚å½“å¢åŠ æ•°æ®å†—ä½™ï¼Œå‡å°‘é‡ä¼ æ“ä½œã€‚\nQUICé‡ä¼ åºåˆ—å·å•è°ƒé€’å¢ TCP ä¸ºäº†ä¿è¯å¯é æ€§ï¼Œä½¿ç”¨ Sequence Number å’Œ ACK æ¥ç¡®è®¤æ¶ˆæ¯æ˜¯å¦æœ‰åºåˆ°è¾¾ï¼Œä½†è¿™æ ·çš„è®¾è®¡å­˜åœ¨ç¼ºé™·ã€‚\nè¶…æ—¶å‘ç”Ÿåå®¢æˆ·ç«¯å‘èµ·é‡ä¼ ï¼Œåæ¥æ¥æ”¶åˆ°äº† ACK ç¡®è®¤æ¶ˆæ¯ï¼Œä½†å› ä¸ºåŸå§‹è¯·æ±‚å’Œé‡ä¼ è¯·æ±‚æ¥æ”¶åˆ°çš„ ACK æ¶ˆæ¯ä¸€æ ·ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯å°±éƒé—·äº†ï¼Œä¸çŸ¥é“è¿™ä¸ª ACK å¯¹åº”çš„æ˜¯åŸå§‹è¯·æ±‚è¿˜æ˜¯é‡ä¼ è¯·æ±‚ã€‚å¦‚æœå®¢æˆ·ç«¯è®¤ä¸ºæ˜¯åŸå§‹è¯·æ±‚çš„ ACKï¼Œä½†å®é™…ä¸Šæ˜¯å·¦å›¾çš„æƒ…å½¢ï¼Œåˆ™è®¡ç®—çš„é‡‡æ · RTT åå¤§ï¼›å¦‚æœå®¢æˆ·ç«¯è®¤ä¸ºæ˜¯é‡ä¼ è¯·æ±‚çš„ ACKï¼Œä½†å®é™…ä¸Šæ˜¯å³å›¾çš„æƒ…å½¢ï¼Œåˆä¼šå¯¼è‡´é‡‡æ · RTT åå°ã€‚\n å›¾ä¸­æœ‰å‡ ä¸ªæœ¯è¯­ï¼ŒRTO æ˜¯æŒ‡è¶…æ—¶é‡ä¼ æ—¶é—´ï¼ˆRetransmission TimeOutï¼‰ï¼Œè·Ÿæˆ‘ä»¬ç†Ÿæ‚‰çš„ RTTï¼ˆRound Trip Timeï¼Œå¾€è¿”æ—¶é—´ï¼‰å¾ˆé•¿å¾—å¾ˆåƒã€‚é‡‡æ · RTT ä¼šå½±å“ RTO è®¡ç®—ï¼Œè¶…æ—¶æ—¶é—´çš„å‡†ç¡®æŠŠæ¡å¾ˆé‡è¦ï¼Œé•¿äº†çŸ­äº†éƒ½ä¸åˆé€‚ã€‚\n QUIC è§£å†³äº†ä¸Šé¢çš„æ­§ä¹‰é—®é¢˜ã€‚ä¸ Sequence Number ä¸åŒçš„æ˜¯ï¼ŒPacket Number ä¸¥æ ¼å•è°ƒé€’å¢ï¼Œå¦‚æœ Packet N ä¸¢å¤±äº†ï¼Œé‚£ä¹ˆé‡ä¼ æ—¶ Packet çš„æ ‡è¯†ä¸ä¼šæ˜¯ Nï¼Œè€Œæ˜¯æ¯” N å¤§çš„æ•°å­—ï¼Œæ¯”å¦‚ N + Mï¼Œè¿™æ ·å‘é€æ–¹æ¥æ”¶åˆ°ç¡®è®¤æ¶ˆæ¯æ—¶å°±èƒ½æ–¹ä¾¿åœ°çŸ¥é“ ACK å¯¹åº”çš„æ˜¯åŸå§‹è¯·æ±‚è¿˜æ˜¯é‡ä¼ è¯·æ±‚ã€‚\nå¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒRTO å‘ç”Ÿåï¼Œæ ¹æ®é‡ä¼ çš„ Packet Number å°±èƒ½ç¡®å®šç²¾ç¡®çš„ RTT è®¡ç®—ã€‚å¦‚æœ Ack çš„ Packet Number æ˜¯ N+Mï¼Œå°±æ ¹æ®é‡ä¼ è¯·æ±‚è®¡ç®—é‡‡æ · RTTã€‚å¦‚æœ Ack çš„ Pakcet Number æ˜¯ Nï¼Œå°±æ ¹æ®åŸå§‹è¯·æ±‚çš„æ—¶é—´è®¡ç®—é‡‡æ · RTTï¼Œæ²¡æœ‰æ­§ä¹‰æ€§ã€‚\nä¿è¯åŒ…çš„é¡ºåº å•çº¯ä¾é ä¸¥æ ¼é€’å¢çš„ Packet Number è‚¯å®šæ˜¯æ— æ³•ä¿è¯æ•°æ®çš„é¡ºåºæ€§å’Œå¯é æ€§ã€‚QUIC åˆå¼•å…¥äº†ä¸€ä¸ª Stream Offset çš„æ¦‚å¿µã€‚\nå³ä¸€ä¸ª Stream å¯ä»¥ç»è¿‡å¤šä¸ª Packet ä¼ è¾“ï¼ŒPacket Number ä¸¥æ ¼é€’å¢ï¼Œæ²¡æœ‰ä¾èµ–ã€‚ä½†æ˜¯ Packet é‡Œçš„ Payload å¦‚æœæ˜¯ Stream çš„è¯ï¼Œå°±éœ€è¦ä¾é  Stream çš„ Offset æ¥ä¿è¯åº”ç”¨æ•°æ®çš„é¡ºåºã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‘é€ç«¯å…ˆåå‘é€äº† Pakcet N å’Œ Pakcet N+1ï¼ŒStream çš„ Offset åˆ†åˆ«æ˜¯ x å’Œ x+yã€‚\nå‡è®¾ Packet N ä¸¢å¤±äº†ï¼Œå‘èµ·é‡ä¼ ï¼Œé‡ä¼ çš„ Packet Number æ˜¯ N+2ï¼Œä½†æ˜¯å®ƒçš„ Stream çš„ Offset ä¾ç„¶æ˜¯ xï¼Œè¿™æ ·å°±ç®— Packet N + 2 æ˜¯ååˆ°çš„ï¼Œä¾ç„¶å¯ä»¥å°† Stream x å’Œ Stream x+y æŒ‰ç…§é¡ºåºç»„ç»‡èµ·æ¥ã€‚\nä¸å…è®¸ Reneging ä»€ä¹ˆå« Reneging å‘¢ï¼Ÿå°±æ˜¯æ¥æ”¶æ–¹ä¸¢å¼ƒå·²ç»æ¥æ”¶å¹¶ä¸”ä¸ŠæŠ¥ç»™ SACK é€‰é¡¹çš„å†…å®¹ã€‚TCP åè®®ä¸é¼“åŠ±è¿™ç§è¡Œä¸ºï¼Œä½†æ˜¯åè®®å±‚é¢å…è®¸è¿™æ ·çš„è¡Œä¸ºã€‚ä¸»è¦æ˜¯è€ƒè™‘åˆ°æœåŠ¡å™¨èµ„æºæœ‰é™ï¼Œæ¯”å¦‚ Buffer æº¢å‡ºï¼Œå†…å­˜ä¸å¤Ÿç­‰æƒ…å†µã€‚\nReneging å¯¹æ•°æ®é‡ä¼ ä¼šäº§ç”Ÿå¾ˆå¤§çš„å¹²æ‰°ã€‚å› ä¸º Sack éƒ½å·²ç»è¡¨æ˜æ¥æ”¶åˆ°äº†ï¼Œä½†æ˜¯æ¥æ”¶ç«¯äº‹å®ä¸Šä¸¢å¼ƒäº†è¯¥æ•°æ®ã€‚QUIC ä¸­çš„ ACK åŒ…å«äº†ä¸ TCP ä¸­ SACK ç­‰ä»·çš„ä¿¡æ¯ï¼Œä½† QUIC ä¸å…è®¸ä»»ä½•ï¼ˆåŒ…æ‹¬è¢«ç¡®è®¤æ¥å—çš„ï¼‰æ•°æ®åŒ…è¢«ä¸¢å¼ƒã€‚è¿™æ ·ä¸ä»…å¯ä»¥ç®€åŒ–å‘é€ç«¯ä¸æ¥æ”¶ç«¯çš„å®ç°éš¾åº¦ï¼Œè¿˜å¯ä»¥å‡å°‘å‘é€ç«¯çš„å†…å­˜å‹åŠ›ã€‚\nQUIC åœ¨åè®®å±‚é¢ç¦æ­¢ Renegingï¼Œä¸€ä¸ª Packet åªè¦è¢« Ackï¼Œå°±è®¤ä¸ºå®ƒä¸€å®šè¢«æ­£ç¡®æ¥æ”¶ï¼Œå‡å°‘äº†è¿™ç§å¹²æ‰°ã€‚\næ›´å¤šçš„ ACK å— ä¸€èˆ¬æ¥è¯´ï¼Œæ¥æ”¶æ–¹æ”¶åˆ°å‘é€æ–¹çš„æ¶ˆæ¯åéƒ½åº”è¯¥å‘é€ä¸€ä¸ª ACK å›å¤ï¼Œè¡¨ç¤ºæ”¶åˆ°äº†æ•°æ®ã€‚ä½†æ¯æ”¶åˆ°ä¸€ä¸ªæ•°æ®å°±è¿”å›ä¸€ä¸ª ACK å›å¤å¤ªéº»çƒ¦ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šç«‹å³å›å¤ï¼Œè€Œæ˜¯æ¥æ”¶åˆ°å¤šä¸ªæ•°æ®åå†å›å¤ï¼ŒTCP SACK æœ€å¤šæä¾› 3 ä¸ª ACK blockã€‚ä½†æœ‰äº›åœºæ™¯ä¸‹ï¼Œæ¯”å¦‚ä¸‹è½½ï¼Œåªéœ€è¦æœåŠ¡å™¨è¿”å›æ•°æ®å°±å¥½ï¼Œä½†æŒ‰ç…§ TCP çš„è®¾è®¡ï¼Œæ¯æ”¶åˆ° 3 ä¸ªæ•°æ®åŒ…å°±è¦â€œç¤¼è²Œæ€§â€åœ°è¿”å›ä¸€ä¸ª ACKã€‚è€Œ QUIC æœ€å¤šå¯ä»¥æå¸¦ 256 ä¸ª ACK blockã€‚åœ¨ä¸¢åŒ…ç‡æ¯”è¾ƒä¸¥é‡çš„ç½‘ç»œä¸‹ï¼Œæ›´å¤šçš„ ACK block å¯ä»¥å‡å°‘é‡ä¼ é‡ï¼Œæå‡ç½‘ç»œæ•ˆç‡ã€‚\nACK Delay TCP è®¡ç®— RTT æ—¶æ²¡æœ‰è€ƒè™‘æ¥æ”¶æ–¹æ¥æ”¶åˆ°æ•°æ®åˆ°å‘é€ç¡®è®¤æ¶ˆæ¯ä¹‹é—´çš„å»¶è¿Ÿï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™æ®µå»¶è¿Ÿå³ ACK Delayã€‚QUIC è€ƒè™‘äº†è¿™æ®µå»¶è¿Ÿï¼Œä½¿å¾— RTT çš„è®¡ç®—æ›´åŠ å‡†ç¡®ã€‚\n è¿™æ®µæ—¶é—´å¯èƒ½æ˜¯è§£æåŒ…çš„æ—¶é—´ã€‚\n QUICæµé‡æ§åˆ¶(åŸºäº stream å’Œ connecton çº§åˆ«) QUIC çš„æµé‡æ§åˆ¶å’Œ TCP æœ‰ç‚¹åŒºåˆ«ï¼ŒTCP ä¸ºäº†ä¿è¯å¯é æ€§ï¼Œçª—å£å·¦è¾¹æ²¿å‘å³æ»‘åŠ¨æ—¶çš„é•¿åº¦å–å†³äºå·²ç»ç¡®è®¤çš„å­—èŠ‚æ•°ã€‚å¦‚æœä¸­é—´å‡ºç°ä¸¢åŒ…ï¼Œå°±ç®—æ¥æ”¶åˆ°äº†æ›´å¤§åºå·çš„ Segmentï¼Œçª—å£ä¹Ÿæ— æ³•è¶…è¿‡è¿™ä¸ªåºåˆ—å·ã€‚\nä½† QUIC ä¸åŒï¼Œå°±ç®—æ­¤å‰æœ‰äº› packet æ²¡æœ‰æ¥æ”¶åˆ°ï¼Œå®ƒçš„æ»‘åŠ¨åªå–å†³äºæ¥æ”¶åˆ°çš„æœ€å¤§åç§»å­—èŠ‚æ•°ã€‚\né’ˆå¯¹ Streamï¼š\n$$\nå¯ç”¨çª—å£ = æœ€å¤§çª—å£ - æ¥å—åˆ°çš„æœ€å¤§åç§»æ•°\n$$\né’ˆå¯¹ Connectionï¼š\n$$\nå¯ç”¨çª—å£= stream1å¯ç”¨çª—å£ + stream2å¯ç”¨çª—å£ + streamNå¯ç”¨çª—å£\n$$\næœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å†…å­˜ä¸è¶³æˆ–è€…ä¸Šæ¸¸å¤„ç†æ€§èƒ½å‡ºç°é—®é¢˜æ—¶ï¼Œé€šè¿‡æµé‡æ§åˆ¶æ¥é™åˆ¶ä¼ è¾“é€Ÿç‡ï¼Œä¿éšœæœåŠ¡å¯ç”¨æ€§ã€‚\nåŠ å¯†è®¤è¯çš„æŠ¥æ–‡ TCP åè®®å¤´éƒ¨æ²¡æœ‰ç»è¿‡ä»»ä½•åŠ å¯†å’Œè®¤è¯ï¼Œæ‰€ä»¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¾ˆå®¹æ˜“è¢«ä¸­é—´ç½‘ç»œè®¾å¤‡ç¯¡æ”¹ï¼Œæ³¨å…¥å’Œçªƒå¬ã€‚æ¯”å¦‚ä¿®æ”¹åºåˆ—å·ã€æ»‘åŠ¨çª—å£ã€‚è¿™äº›è¡Œä¸ºæœ‰å¯èƒ½æ˜¯å‡ºäºæ€§èƒ½ä¼˜åŒ–ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸»åŠ¨æ”»å‡»ã€‚\nä½†æ˜¯ QUIC çš„ packet å¯ä»¥è¯´æ˜¯æ­¦è£…åˆ°äº†ç‰™é½¿ã€‚é™¤äº†ä¸ªåˆ«æŠ¥æ–‡æ¯”å¦‚ PUBLIC_RESET å’Œ CHLOï¼Œæ‰€æœ‰æŠ¥æ–‡å¤´éƒ¨éƒ½æ˜¯ç»è¿‡è®¤è¯çš„ï¼ŒæŠ¥æ–‡ Body éƒ½æ˜¯ç»è¿‡åŠ å¯†çš„ã€‚\nè¿™æ ·åªè¦å¯¹ QUIC æŠ¥æ–‡ä»»ä½•ä¿®æ”¹ï¼Œæ¥æ”¶ç«¯éƒ½èƒ½å¤ŸåŠæ—¶å‘ç°ï¼Œæœ‰æ•ˆåœ°é™ä½äº†å®‰å…¨é£é™©ã€‚\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œçº¢è‰²éƒ¨åˆ†æ˜¯ Stream Frame çš„æŠ¥æ–‡å¤´éƒ¨ï¼Œæœ‰è®¤è¯ã€‚ç»¿è‰²éƒ¨åˆ†æ˜¯æŠ¥æ–‡å†…å®¹ï¼Œå…¨éƒ¨ç»è¿‡åŠ å¯†ã€‚\nReferenceï¼š\n The Road to QUIC ç§‘æ™®ï¼šQUICåè®®åŸç†åˆ†æ Quicåè®®ä»‹ç»å’Œæµ…æ QUICåè®®æ˜¯å¦‚ä½•åšåˆ°0RTTåŠ å¯†ä¼ è¾“çš„ Quicåè®®ä»‹ç»å’Œæµ…æ  ","description":"æ–°ä¸€ä»£HTTPåè®®ï¼Œæˆä¸ºHTTP/3ï¼ŒåŸºäºUDPï¼Œéå¸¸å¼ºå¤§.æœ‰æ›´å¿«é€Ÿã€æ›´çµæ´»ã€æ›´å®‰å…¨çš„ç‰¹ç‚¹ã€‚","id":57,"section":"posts","tags":["quic"],"title":"Quicåè®®ä¸ºä»€ä¹ˆè¿™ä¹ˆå¥½","uri":"https://hugo.jiahongw.com/zh/posts/network/quic-protocol/"},{"content":"TCPæ‹¥å¡æ§åˆ¶ç®—æ³•çš„ç›®çš„å¯ä»¥ç®€å•æ¦‚æ‹¬ä¸ºï¼šå…¬å¹³ç«äº‰ã€å……åˆ†åˆ©ç”¨ç½‘ç»œå¸¦å®½ã€é™ä½ç½‘ç»œå»¶æ—¶ã€ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œç„¶è€Œå°±ç›®å‰è€Œè¨€è¦å®ç°è¿™äº›ç›®æ ‡å°±éš¾å…æœ‰æƒè¡¡å’Œå–èˆã€‚\nç®—æ³•åˆ†ç±» åŸºäºä¸¢åŒ…ç­–ç•¥çš„ä¼ ç»Ÿæ‹¥å¡æ§åˆ¶ç®—æ³•çš„å‡ ä¸ªè¿­ä»£ç‰ˆæœ¬ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\nä¸æ­¤åŒæ—¶è¿˜æœ‰ä¸€ç±»ç®—æ³•æ˜¯åŸºäºRTTå»¶æ—¶ç­–ç•¥æ¥è¿›è¡Œæ§åˆ¶çš„ï¼Œä½†æ˜¯è¿™ç±»ç®—æ³•åœ¨å‘åŒ…é€Ÿç‡ä¸Šå¯èƒ½ä¸å¤Ÿæ¿€è¿›ï¼Œç«äº‰æ€§èƒ½ä¸å¦‚å…¶ä»–ç®—æ³•ï¼Œå› æ­¤åœ¨å…±äº«ç½‘ç»œå¸¦å®½æ—¶æœ‰å¤±å…¬å¹³æ€§ï¼Œä½†æ˜¯ç®—æ³•é€Ÿç‡æ›²çº¿å´æ˜¯å¾ˆå¹³æ»‘\nåŸºäºé“¾è·¯å®¹é‡çš„æ‹¥å¡æ§åˆ¶ï¼šå®æ—¶æµ‹é‡ç½‘ç»œå¸¦å®½å’Œæ—¶å»¶ï¼Œè®¤ä¸ºç½‘ç»œä¸ŠæŠ¥æ–‡æ€»é‡å¤§äºå¸¦å®½æ—¶å»¶ä¹˜ç§¯æ—¶å‡ºç°äº†æ‹¥å¡ï¼Œå¦‚ BBRã€‚\nåŸºäºå­¦ä¹ çš„æ‹¥å¡æ§åˆ¶ï¼šæ²¡æœ‰ç‰¹å®šçš„æ‹¥å¡ä¿¡å·ï¼Œè€Œæ˜¯å€ŸåŠ©è¯„ä»·å‡½æ•°ï¼ŒåŸºäºè®­ç»ƒæ•°æ®ï¼Œä½¿ç”¨æœºå™¨å­¦ä¹ çš„æ–¹æ³•å½¢æˆä¸€ä¸ªæ§åˆ¶ç­–ç•¥ï¼Œå¦‚ Remyã€‚\nå¦‚ä½•æ„ŸçŸ¥æ‹¥å¡ åŸºäºå„ç§æ‹¥å¡ç­–ç•¥çš„æ‹¥å¡æ§åˆ¶ç®—æ³•æœ‰ä¸ä¸€æ ·çš„æ‹¥å¡åˆ¤æ–­æ ‡å‡†ï¼š\n  åŸºäºä¸¢åŒ…\nä¸¢åŒ…å¯ä»¥ç”±é‡ä¼ è¶…æ—¶RTOå’Œé‡å¤ç¡®è®¤æ¥åšåˆ¤æ–­ã€‚\n  åŸºäºæ—¶å»¶\n  åŸºäºé“¾è·¯å®¹é‡\n  åŸºäºæœºå™¨å­¦ä¹ \næ ¹æ®å‚æ•°å¾—å‡ºä¸€ä¸ªæ‹¥å¡çª—å£å€¼\n  æ‹¥å¡æ§åˆ¶åŸºæœ¬ç­–ç•¥ æ‹¥å¡æ§åˆ¶æ˜¯ä¸€ä¸ªåŠ¨æ€çš„è¿‡ç¨‹ï¼Œå®ƒæ—¢è¦æé«˜å¸¦å®½åˆ©ç”¨ç‡å‘é€å°½é‡å¤šçš„æ•°æ®åˆè¦é¿å…ç½‘ç»œæ‹¥å µä¸¢åŒ…RTTå¢å¤§ç­‰é—®é¢˜ï¼ŒåŸºäºè¿™ç§é«˜è¦æ±‚å¹¶ä¸æ˜¯å•ä¸€ç­–ç•¥å¯ä»¥æå®šçš„ï¼Œå› æ­¤TCPçš„ æ‹¥å¡æ§åˆ¶ç­–ç•¥å®é™…ä¸Šæ˜¯åˆ†é˜¶æ®µåˆ†ç­–ç•¥çš„ç»¼åˆè¿‡ç¨‹ï¼š\nåŸºäºä¸¢åŒ…çš„æ‹¥å¡æ§åˆ¶ Tahoeç®—æ³• å¦‚æœæ”¶åˆ°ä¸‰æ¬¡é‡å¤ç¡®è®¤å³ç¬¬å››æ¬¡æ”¶åˆ°ç›¸åŒç¡®è®¤å·çš„åˆ†æ®µç¡®è®¤ï¼Œå¹¶ä¸”åˆ†æ®µå¯¹åº”åŒ…æ— è´Ÿè½½åˆ†æ®µå’Œæ— æ”¹å˜æ¥æ”¶çª—å£çš„è¯ï¼ŒTahoeç®—æ³•åˆ™è¿›å…¥å¿«é€Ÿé‡ä¼ ï¼Œå°†æ…¢å¯åŠ¨é˜ˆå€¼æ”¹ä¸ºå½“å‰æ‹¥å¡çª—å£çš„ä¸€åŠï¼Œå°†æ‹¥å¡çª—å£é™ä¸º1ä¸ªMSSï¼Œå¹¶é‡æ–°è¿›å…¥æ…¢å¯åŠ¨é˜¶æ®µã€‚\næ‹¥å¡æ§åˆ¶è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š\nRenoç®—æ³•(æˆ‘ä»¬å½“å‰ç†è§£çš„ç®—æ³•) å¦‚æœæ”¶åˆ°ä¸‰æ¬¡é‡å¤ç¡®è®¤ï¼ŒRenoç®—æ³•åˆ™è¿›å…¥å¿«é€Ÿé‡ä¼ åªå°†æ‹¥å¡çª—å£å‡åŠæ¥è·³è¿‡æ…¢å¯åŠ¨é˜¶æ®µï¼Œå°†æ…¢å¯åŠ¨é˜ˆå€¼è®¾ä¸ºå½“å‰æ–°çš„æ‹¥å¡çª—å£å€¼ï¼Œè¿›å…¥ä¸€ä¸ªç§°ä¸ºå¿«é€Ÿæ¢å¤çš„æ–°è®¾è®¡é˜¶æ®µã€‚\næ‹¥å¡æ§åˆ¶æµç¨‹å¦‚ä¸‹ï¼š\nReno ç®—æ³•å°†æ”¶åˆ° ACK è¿™ä¸€ä¿¡å·ä½œä¸ºæ‹¥å¡çª—å£å¢é•¿çš„ä¾æ®ï¼Œåœ¨æ—©æœŸä½å¸¦å®½ã€ä½æ—¶å»¶çš„ç½‘ç»œä¸­èƒ½å¤Ÿå¾ˆå¥½çš„å‘æŒ¥ä½œç”¨ï¼Œä½†æ˜¯éšç€ç½‘ç»œå¸¦å®½å’Œå»¶æ—¶çš„å¢åŠ ï¼ŒReno çš„ç¼ºç‚¹å°±æ¸æ¸ä½“ç°å‡ºæ¥äº†ï¼Œå‘é€ç«¯ä»å‘é€æŠ¥æ–‡åˆ°æ”¶åˆ° ACK ç»å†ä¸€ä¸ª RTTï¼Œåœ¨é«˜å¸¦å®½å»¶æ—¶ï¼ˆHigh Bandwidth-Delay Productï¼ŒBDPï¼‰ç½‘ç»œä¸­ï¼ŒRTT å¾ˆå¤§ï¼Œå¯¼è‡´æ‹¥å¡çª—å£å¢é•¿å¾ˆæ…¢ï¼Œä¼ è¾“é€Ÿåº¦éœ€è¦ç»è¿‡å¾ˆé•¿æ—¶é—´æ‰èƒ½è¾¾åˆ°æœ€å¤§å¸¦å®½ï¼Œå¯¼è‡´å¸¦å®½åˆ©ç”¨ç‡å°†ä½ã€‚\né€‚ç”¨åœºæ™¯ï¼š\né€‚ç”¨äºä½å»¶æ—¶ã€ä½å¸¦å®½çš„ç½‘ç»œã€‚\n TCP New Renoæ˜¯å¯¹TCP Renoä¸­å¿«é€Ÿæ¢å¤é˜¶æ®µçš„é‡ä¼ è¿›è¡Œæ”¹å–„çš„ä¸€ç§æ”¹è¿›ç®—æ³•ï¼ŒNew Renoåœ¨ä½é”™è¯¯ç‡æ—¶è¿è¡Œæ•ˆç‡å’Œé€‰æ‹©ç¡®è®¤SACKç›¸å½“ï¼Œåœ¨é«˜é”™è¯¯ç‡ä»ä¼˜äºRenoã€‚\n CUBICç®—æ³• Cubicæ˜¯ Linux å†…æ ¸ 2.6 ä¹‹åçš„é»˜è®¤ TCP æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œ ä½¿ç”¨ä¸€ä¸ªç«‹æ–¹å‡½æ•°ï¼ˆcubic functionï¼‰:\n$$\nW_{cubic} = C(t-K)^3 + W_{max}\n$$\nä½œä¸ºæ‹¥å¡çª—å£çš„å¢é•¿å‡½æ•°ï¼Œå…¶ä¸­ï¼ŒC æ˜¯è°ƒèŠ‚å› å­ï¼Œt æ˜¯ä»ä¸Šä¸€æ¬¡ç¼©å°æ‹¥å¡çª—å£ç»è¿‡çš„æ—¶é—´ï¼Œ$W_{max}$æ˜¯ä¸Šä¸€æ¬¡å‘ç”Ÿæ‹¥å¡æ—¶çš„çª—å£å¤§å°ï¼Œ\n$$\nK = \\sqrt[3]{W_{max}\\beta /C}\n$$\nÎ²æ˜¯ä¹˜æ³•å‡å°å› å­ã€‚ä»å‡½æ•°ä¸­å¯ä»¥çœ‹å‡ºæ‹¥å¡çª—å£çš„å¢é•¿ä¸å†ä¸ RTT æœ‰å…³ï¼Œè€Œä»…ä»…å–å†³ä¸Šæ¬¡å‘ç”Ÿæ‹¥å¡æ—¶çš„æœ€å¤§çª—å£å’Œè·ç¦»ä¸Šæ¬¡å‘ç”Ÿæ‹¥å¡çš„æ—¶é—´é—´éš”å€¼ã€‚\nCubic æ‹¥å¡çª—å£å¢é•¿æ›²çº¿å¦‚ä¸‹ï¼Œå‡¸æ›²çº¿éƒ¨åˆ†ä¸ºç¨³å®šå¢é•¿é˜¶æ®µï¼Œå‡¹æ›²çº¿éƒ¨åˆ†ä¸ºæœ€å¤§å¸¦å®½æ¢æµ‹é˜¶æ®µã€‚å¦‚å›¾ä¸‹å›¾ æ‰€ç¤ºï¼Œåœ¨åˆšå¼€å§‹æ—¶ï¼Œæ‹¥å¡çª—å£å¢é•¿å¾ˆå¿«ï¼Œåœ¨æ¥è¿‘ $W_{max}$ å£æ—¶ï¼Œå¢é•¿é€Ÿåº¦å˜çš„å¹³ç¼“ï¼Œé¿å…æµé‡çªå¢è€Œå¯¼è‡´ä¸¢åŒ…ï¼›åœ¨ $W_{max}$ é™„è¿‘ï¼Œæ‹¥å¡çª—å£ä¸å†å¢åŠ ï¼›ä¹‹åå¼€å§‹ç¼“æ…¢åœ°æ¢æµ‹ç½‘ç»œæœ€å¤§ååé‡ï¼Œä¿è¯ç¨³å®šæ€§ï¼ˆåœ¨ $W_{max}$ é™„è¿‘å®¹æ˜“å‡ºç°æ‹¥å¡ï¼‰ï¼Œåœ¨è¿œç¦» $W_{max}$ åï¼Œå¢å¤§çª—å£å¢é•¿çš„é€Ÿåº¦ï¼Œä¿è¯äº†å¸¦å®½çš„åˆ©ç”¨ç‡ã€‚\nå½“å‡ºç°ä¸¢åŒ…æ—¶ï¼Œå°†æ‹¥å¡çª—å£è¿›è¡Œä¹˜æ³•å‡å°(æ‹¥å¡çª—å£å‡å°åˆ°å½“å‰çš„ä¸€åŠ)ï¼Œå†ç»§ç»­å¼€å§‹ä¸Šè¿°å¢é•¿è¿‡ç¨‹ã€‚æ­¤æ–¹å¼å¯ä»¥ä½¿å¾—æ‹¥å¡çª—å£ä¸€ç›´ç»´æŒåœ¨ $W_{max}$ é™„è¿‘ï¼Œä»è€Œä¿è¯äº†å¸¦å®½çš„åˆ©ç”¨ç‡ã€‚Cubic çš„æ‹¥å¡æ§åˆ¶è¿‡ç¨‹ï¼š\nCubic ç®—æ³•çš„ä¼˜ç‚¹åœ¨äºåªè¦æ²¡æœ‰å‡ºç°ä¸¢åŒ…ï¼Œå°±ä¸ä¼šä¸»åŠ¨é™ä½è‡ªå·±çš„å‘é€é€Ÿåº¦ï¼Œå¯ä»¥æœ€å¤§ç¨‹åº¦çš„åˆ©ç”¨ç½‘ç»œå‰©ä½™å¸¦å®½ï¼Œæé«˜ååé‡ï¼Œåœ¨é«˜å¸¦å®½ã€ä½ä¸¢åŒ…ç‡çš„ç½‘ç»œä¸­å¯ä»¥å‘æŒ¥è¾ƒå¥½çš„æ€§èƒ½ã€‚\nä½†æ˜¯ï¼ŒCubic åŒä¹‹å‰çš„æ‹¥å¡æ§åˆ¶ç®—æ³•ä¸€æ ·ï¼Œæ— æ³•åŒºåˆ†æ‹¥å¡ä¸¢åŒ…å’Œä¼ è¾“é”™è¯¯ä¸¢åŒ…ï¼Œåªè¦å‘ç°ä¸¢åŒ…ï¼Œå°±ä¼šå‡å°æ‹¥å¡çª—å£ï¼Œé™ä½å‘é€é€Ÿç‡ï¼Œè€Œäº‹å®ä¸Šä¼ è¾“é”™è¯¯ä¸¢åŒ…æ—¶ç½‘ç»œä¸ä¸€å®šå‘ç”Ÿäº†æ‹¥å¡ï¼Œä½†æ˜¯ä¼ è¾“é”™è¯¯ä¸¢åŒ…çš„æ¦‚ç‡å¾ˆä½ï¼Œæ‰€ä»¥å¯¹ Cubic ç®—æ³•çš„æ€§èƒ½å½±å“ä¸æ˜¯å¾ˆå¤§ã€‚\nCubic ç®—æ³•çš„å¦ä¸€ä¸ªä¸è¶³ä¹‹å¤„æ˜¯è¿‡äºæ¿€è¿›ï¼Œåœ¨æ²¡æœ‰å‡ºç°ä¸¢åŒ…æ—¶ä¼šä¸åœåœ°å¢åŠ æ‹¥å¡çª—å£çš„å¤§å°ï¼Œå‘ç½‘ç»œæ³¨å…¥æµé‡ï¼Œå°†ç½‘ç»œè®¾å¤‡çš„ç¼“å†²åŒºå¡«æ»¡ï¼Œå‡ºç° Bufferbloatï¼ˆç¼“å†²åŒºè†¨èƒ€ï¼‰ã€‚ç”±äºç¼“å†²åŒºé•¿æœŸè¶‹äºé¥±å’ŒçŠ¶æ€ï¼Œæ–°è¿›å…¥ç½‘ç»œçš„çš„æ•°æ®åŒ…ä¼šåœ¨ç¼“å†²åŒºé‡Œæ’é˜Ÿï¼Œå¢åŠ æ— è°“çš„æ’é˜Ÿæ—¶å»¶ï¼Œç¼“å†²åŒºè¶Šå¤§ï¼Œæ—¶å»¶å°±è¶Šé«˜ã€‚å¦å¤– Cubic ç®—æ³•åœ¨é«˜å¸¦å®½åˆ©ç”¨ç‡çš„åŒæ—¶ä¾ç„¶åœ¨å¢åŠ æ‹¥å¡çª—å£ï¼Œé—´æ¥å¢åŠ äº†ä¸¢åŒ…ç‡ï¼Œé€ æˆç½‘ç»œæŠ–åŠ¨åŠ å‰§ã€‚\né€‚ç”¨åœºæ™¯ï¼š\né€‚ç”¨äºé«˜å¸¦å®½ã€ä½ä¸¢åŒ…ç‡ç½‘ç»œï¼Œèƒ½å¤Ÿæœ‰æ•ˆåˆ©ç”¨å¸¦å®½ã€‚\nåŸºäºé“¾è·¯å®¹é‡çš„ç®—æ³• BRRç®—æ³•  BBR[4] æ˜¯è°·æ­Œåœ¨ 2016 å¹´æå‡ºçš„ä¸€ç§æ–°çš„æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œå·²ç»åœ¨ Youtube æœåŠ¡å™¨å’Œè°·æ­Œè·¨æ•°æ®ä¸­å¿ƒå¹¿åŸŸç½‘ä¸Šéƒ¨ç½²ï¼Œæ® Youtube å®˜æ–¹æ•°æ®ç§°ï¼Œéƒ¨ç½² BBR åï¼Œåœ¨å…¨çƒèŒƒå›´å†…è®¿é—® Youtube çš„å»¶è¿Ÿé™ä½äº† 53%ï¼Œåœ¨æ—¶å»¶è¾ƒé«˜çš„å‘å±•ä¸­å›½å®¶ï¼Œå»¶è¿Ÿé™ä½äº† 80%ã€‚ç›®å‰ BBR å·²ç»é›†æˆåˆ° Linux 4.9 ä»¥ä¸Šç‰ˆæœ¬çš„å†…æ ¸ä¸­ã€‚\n BBR ç®—æ³•ä¸å°†å‡ºç°ä¸¢åŒ…æˆ–æ—¶å»¶å¢åŠ ä½œä¸ºæ‹¥å¡çš„ä¿¡å·ï¼Œè€Œæ˜¯è®¤ä¸ºå½“ç½‘ç»œä¸Šçš„æ•°æ®åŒ…æ€»é‡å¤§äºç“¶é¢ˆé“¾è·¯å¸¦å®½å’Œæ—¶å»¶çš„ä¹˜ç§¯æ—¶æ‰å‡ºç°äº†æ‹¥å¡ã€‚\nBBR ç®—æ³•å‘¨æœŸæ€§åœ°æ¢æµ‹ç½‘ç»œçš„å®¹é‡ï¼Œäº¤æ›¿æµ‹é‡ä¸€æ®µæ—¶é—´å†…çš„å¸¦å®½æå¤§å€¼å’Œæ—¶å»¶æå°å€¼ï¼Œå°†å…¶ä¹˜ç§¯ä½œä¸ºä½œä¸ºæ‹¥å¡çª—å£å¤§å°ï¼ˆäº¤æ›¿æµ‹é‡çš„åŸå› æ˜¯æå¤§å¸¦å®½å’Œæå°æ—¶å»¶ä¸å¯èƒ½åŒæ—¶å¾—åˆ°ï¼Œå¸¦å®½æå¤§æ—¶ç½‘ç»œè¢«å¡«æ»¡é€ æˆæ’é˜Ÿï¼Œæ—¶å»¶å¿…ç„¶æå¤§ï¼Œæ—¶å»¶æå°æ—¶éœ€è¦æ•°æ®åŒ…ä¸è¢«æ’é˜Ÿç›´æ¥è½¬å‘ï¼Œå¸¦å®½å¿…ç„¶æå°ï¼‰ï¼Œä½¿å¾—æ‹¥å¡çª—å£å§‹çš„å€¼å§‹ç»ˆä¸ç½‘ç»œçš„å®¹é‡ä¿æŒä¸€è‡´ã€‚\nä»€ä¹ˆå«åšBDPå‘¢ï¼Ÿå®ƒå«åšå¸¦å®½æ—¶å»¶ç§¯ï¼Œä¾‹å¦‚ä¸€æ¡é“¾è·¯çš„å¸¦å®½æ˜¯100Mbpsï¼Œè€ŒRTTæ˜¯40msï¼Œé‚£ä¹ˆ\nBDP=100Mbps*0.04s=4Mb=0.5MB å³å¹³å‡æ¯ç§’é£è¡Œä¸­çš„æŠ¥æ–‡åº”å½“æ˜¯0.5MBã€‚å› æ­¤Linuxçš„æ¥æ”¶çª—å£ç¼“å­˜å¸¸å‚è€ƒæ­¤è®¾ç½®ï¼š\näº‹å®ä¸Šï¼Œæˆ‘ä»¬çš„ä¼ è¾“é€Ÿåº¦åœ¨3ä¸ªé˜¶æ®µè¢«ä¸åŒçš„å› ç´ é™åˆ¶ï¼š\n åº”ç”¨ç¨‹åºé™åˆ¶é˜¶æ®µï¼Œæ­¤æ—¶RTTä¸å˜ï¼Œéšç€åº”ç”¨ç¨‹åºå¼€å§‹å‘é€å¤§æ–‡ä»¶ï¼Œé€Ÿç‡ç›´çº¿ä¸Šå‡ï¼› BDPé™åˆ¶é˜¶æ®µï¼Œæ­¤æ—¶RTTå¼€å§‹ä¸æ–­ä¸Šå‡ï¼Œä½†ååé‡ä¸å˜ï¼Œå› ä¸ºæ­¤æ—¶ç“¶é¢ˆè·¯ç”±å™¨å·²ç»è¾¾åˆ°ä¸Šé™ï¼Œç¼“å†²é˜Ÿåˆ—æ­£åœ¨ä¸æ–­å¢åŠ ï¼› ç“¶é¢ˆè·¯ç”±å™¨ç¼“å†²é˜Ÿåˆ—é™åˆ¶é˜¶æ®µï¼Œæ­¤æ—¶å¼€å§‹å¤§é‡ä¸¢åŒ…ã€‚  å¦‚ä¸‹æ‰€ç¤ºï¼š\nå¦‚CUBICè¿™æ ·åŸºäºä¸¢åŒ…çš„æ‹¥å¡æ§åˆ¶ç®—æ³•åœ¨ç¬¬2æ¡ç°è‰²ç«–çº¿å‘ç”Ÿä½œç”¨ï¼Œè¿™å·²ç»å¤ªæ™šäº†ï¼Œæ›´å¥½çš„ä½œç”¨ç‚¹æ˜¯BDPä¸Šé™å¼€å§‹å‘æŒ¥ä½œç”¨æ—¶ï¼Œä¹Ÿå°±æ˜¯ç¬¬1æ¡ç°è‰²ç«–çº¿ã€‚\nè€ŒBBRé€šè¿‡æ£€æµ‹RTpropå’Œ~BtlBw~æ¥å®ç°æ‹¥å¡æ§åˆ¶ã€‚ä»€ä¹ˆæ˜¯RTpropå‘¢ï¼Ÿè¿™æ˜¯é“¾è·¯çš„ç‰©ç†æ—¶å»¶ï¼Œå› ä¸ºRTTé‡Œå«æœ‰æŠ¥æ–‡åœ¨è·¯ç”±å™¨é˜Ÿåˆ—é‡Œçš„æ’é˜Ÿæ—¶é—´ã€ACKçš„å»¶è¿Ÿç¡®è®¤æ—¶é—´ç­‰ã€‚ä»€ä¹ˆå«å»¶è¿Ÿç¡®è®¤å‘¢ï¼ŸTCPæ¯ä¸ªæŠ¥æ–‡å¿…é¡»è¢«ç¡®è®¤ï¼Œç¡®è®¤åŠ¨ä½œæ˜¯é€šè¿‡æ¥æ”¶ç«¯å‘é€ACKæŠ¥æ–‡å®ç°çš„ï¼Œä½†ç”±äºTCPå’ŒIPå¤´éƒ¨æœ‰40ä¸ªå­—èŠ‚ï¼Œå¦‚æœä¸æºå¸¦æ•°æ®åªä¸ºå‘é€ACKç½‘ç»œæ•ˆç‡è¿‡ä½ï¼Œæ‰€ä»¥ä¼šè®©ç‹¬ç«‹çš„ACKæŠ¥æ–‡ç­‰ä¸€ç­‰ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ•°æ®å‘çš„æ—¶å€™é¡ºä¾¿å¸¦ç»™å¯¹æ–¹ï¼Œæˆ–è€…ç­‰ç­‰çœ‹å¤šä¸ªACKä¸€èµ·å‘ã€‚æ‰€ä»¥ï¼Œå¯ä»¥ç”¨ä¸‹åˆ—å…¬å¼è¡¨ç¤ºRTTä¸RTpropçš„å·®åˆ«ï¼š\n$$\nRTT_t = RT_{prop_t} + n_t\n$$\n RTTæˆ‘ä»¬å¯ä»¥æµ‹é‡å¾—å‡ºï¼ŒRTpropå‘¢ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ç“¶é¢ˆè·¯ç”±å™¨é˜Ÿåˆ—ä¸ºç©ºæ—¶å¤šæ¬¡RTTæµ‹é‡çš„æœ€å°å€¼å³å¯\n è€ŒBtlBwå…¨ç§°æ˜¯bottleneck bandwithï¼Œå³ç“¶é¢ˆå¸¦å®½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æµ‹é‡å·²å‘é€ä½†æœªACKç¡®è®¤çš„é£è¡Œä¸­å­—èŠ‚é™¤ä»¥é£è¡Œæ—¶é—´deliveryRateæ¥æµ‹é‡\n æ—©åœ¨1979å¹´Leonard Kleinrockå°±æå‡ºäº†ç¬¬1æ¡ç«–çº¿æ˜¯æœ€å¥½çš„æ‹¥å¡æ§åˆ¶ç‚¹ï¼Œä½†è¢«Jeffrey M. Jaffeè¯æ˜ä¸å¯èƒ½å®ç°ï¼Œå› ä¸ºæ²¡æœ‰åŠæ³•åˆ¤æ–­RTTå˜åŒ–åˆ°åº•æ˜¯ä¸æ˜¯å› ä¸ºé“¾è·¯å˜åŒ–äº†ï¼Œä»è€Œä¸åŒçš„è®¾å¤‡ç“¶é¢ˆå¯¼è‡´çš„ï¼Œè¿˜æ˜¯ç“¶é¢ˆè·¯ç”±å™¨ä¸Šçš„å…¶ä»–TCPè¿æ¥çš„æµé‡å‘ç”Ÿäº†å¤§çš„å˜åŒ–ã€‚ä½†æˆ‘ä»¬æœ‰äº†RTpropå’ŒBtlBwåï¼Œå½“RTpropå‡é«˜æ—¶æˆ‘ä»¬ä¾¿å¾—åˆ°äº†BtlBwï¼Œè¿™ä¾¿æ‰¾åˆ°ç¬¬1æ¡ç°è‰²ç«–çº¿æœ€å¥½çš„æ‹¥å¡æ§åˆ¶ç‚¹ï¼Œä¹Ÿæœ‰äº†åç»­å‘é€é€Ÿç‡çš„ä¾æ®ã€‚\n ç”±äº BBR çš„æ‹¥å¡çª—å£æ˜¯ç²¾ç¡®æµ‹é‡å‡ºæ¥çš„ï¼Œä¸ä¼šæ— é™çš„å¢åŠ æ‹¥å¡çª—å£ï¼Œä¹Ÿå°±ä¸ä¼šå°†ç½‘ç»œè®¾å¤‡çš„ç¼“å†²åŒºå¡«æ»¡ï¼Œé¿å…äº†å‡ºç° Bufferbloat (ç¼“å†²åŒºè†¨èƒ€)é—®é¢˜ï¼Œä½¿å¾—æ—¶å»¶å¤§å¤§é™ä½ã€‚\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç½‘ç»œç¼“å†²åŒºè¢«å¡«æ»¡æ—¶æ—¶å»¶ä¸º 250msï¼ŒCubic ç®—æ³•ä¼šç»§ç»­å¢åŠ æ‹¥å¡çª—å£ï¼Œä½¿å¾—æ—¶å»¶æŒç»­å¢åŠ åˆ° 500ms å¹¶å‡ºç°ä¸¢åŒ…ï¼Œæ•´ä¸ªè¿‡ç¨‹ Cubic ä¸€ç›´å¤„äºé«˜æ—¶å»¶çŠ¶æ€ï¼Œè€Œ BBR ç”±äºä¸ä¼šå¡«æ»¡ç½‘ç»œç¼“å†²åŒºï¼Œæ—¶å»¶ä¸€ç›´å¤„äºè¾ƒä½çŠ¶æ€ã€‚\nç”±äº BBR ç®—æ³•ä¸å°†ä¸¢åŒ…ä½œä¸ºæ‹¥å¡ä¿¡å·ï¼Œæ‰€ä»¥åœ¨ä¸¢åŒ…ç‡è¾ƒé«˜çš„ç½‘ç»œä¸­ï¼ŒBBR ä¾ç„¶æœ‰æé«˜çš„ååé‡ï¼Œå¦‚å›¾ 5ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨ 1% ä¸¢åŒ…ç‡çš„ç½‘ç»œç¯å¢ƒä¸‹ï¼ŒCubic çš„ååé‡å·²ç»é™ä½ 90% ä»¥ä¸Šï¼Œè€Œ BBR çš„ååé‡å‡ ä¹æ²¡æœ‰å—åˆ°å½±å“ï¼Œå½“ä¸¢åŒ…ç‡å¤§äº 15% æ—¶ï¼ŒBBR çš„ååé‡æ‰å¤§å¹…ä¸‹é™ã€‚\nBBR ç®—æ³•æ˜¯åé¦ˆé©±åŠ¨çš„ï¼Œæœ‰è‡ªä¸»è°ƒèŠ‚æœºåˆ¶ï¼Œä¸å— TCP æ‹¥å¡æ§åˆ¶çŠ¶æ€æœºçš„æ§åˆ¶ï¼Œé€šè¿‡æµ‹é‡ç½‘ç»œå®¹é‡æ¥è°ƒæ•´æ‹¥å¡çª—å£ï¼Œå‘é€é€Ÿç‡ç”±è‡ªå·±æŒæ§ï¼Œè€Œä¼ ç»Ÿçš„æ‹¥å¡æ§åˆ¶ç®—æ³•åªè´Ÿè´£è®¡ç®—æ‹¥å¡çª—å£ï¼Œè€Œä¸ç®¡å‘é€é€Ÿç‡ï¼ˆpacing rateï¼‰ï¼Œæ€ä¹ˆå‘ç”± TCP è‡ªå·±å†³å®šï¼Œè¿™æ ·ä¼šåœ¨ç“¶é¢ˆå¸¦å®½é™„è¿‘å› å‘é€é€Ÿç‡çš„æ¿€å¢å¯¼è‡´æ•°æ®åŒ…æ’é˜Ÿæˆ–å‡ºç°ä¸¢åŒ…ã€‚\nç»è¿‡æµ‹è¯•ï¼Œåœ¨é«˜å»¶æ—¶ã€é«˜ä¸¢åŒ…ç‡çš„ç¯å¢ƒä¸‹ï¼ŒBBR ç›¸å¯¹äº Cubic ç®—æ³•åœ¨ä¼ è¾“é€Ÿåº¦ä¸Šæœ‰è¾ƒå¤§çš„æå‡ï¼Œå…·ä½“çš„æµ‹è¯•ç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š\n200ms å»¶æ—¶ä¸‹ Cubic ä¸ BBR ä¼ è¾“é€Ÿåº¦å¯¹æ¯” BBR ç®—æ³•çš„ä¸è¶³ä¹‹å¤„åœ¨äºè®¾å¤‡é˜Ÿåˆ—ç¼“å­˜è¾ƒå¤§æ—¶ï¼ŒBBR å¯èƒ½ä¼šç«äº‰ä¸è¿‡ Cubic ç­‰æ¯”è¾ƒæ¿€è¿›ç®—æ³•ï¼ŒåŸå› æ˜¯ BBR ä¸ä¸»åŠ¨å»å æ®é˜Ÿåˆ—ç¼“å­˜ï¼Œå¦‚æœ Cubic çš„æµé‡é•¿æœŸå æ®é˜Ÿåˆ—ç¼“å­˜ï¼Œä¼šä½¿å¾— BBR åœ¨å¤šä¸ªå‘¨æœŸå†…æµ‹é‡çš„æå° RTT å¢å¤§ï¼Œè¿›è€Œä½¿ BBR çš„å¸¦å®½å‡å°ã€‚\né€‚ç”¨åœºæ™¯ï¼š\né€‚ç”¨äºé«˜å¸¦å®½ã€é«˜æ—¶å»¶ã€æœ‰ä¸€å®šä¸¢åŒ…ç‡çš„é•¿è‚¥ç½‘ç»œï¼Œå¯ä»¥æœ‰æ•ˆé™ä½ä¼ è¾“æ—¶å»¶ï¼Œå¹¶ä¿è¯è¾ƒé«˜çš„ååé‡ã€‚\nåŸºäºå­¦ä¹ çš„ç®—æ³• Remy Remy ä¹Ÿç§°ä¸ºè®¡ç®—æœºç”Ÿæˆçš„æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼ˆcomputer-generated congestion-control algorithmï¼‰ï¼Œé‡‡ç”¨æœºå™¨å­¦ä¹ çš„æ–¹å¼ç”Ÿæˆæ‹¥å¡æ§åˆ¶ç®—æ³•æ¨¡å‹ã€‚\nç•¥äº†å§\u0026hellip;\u0026hellip;ğŸ™ƒ\nåŸºäºæ—¶å»¶çš„ç®—æ³• Vegasç®—æ³• Vegaså°†æ—¶å»¶ RTT çš„å¢åŠ ä½œä¸ºç½‘ç»œå‡ºç°æ‹¥å¡çš„ä¿¡å·ï¼ŒRTT å¢åŠ ï¼Œæ‹¥å¡çª—å£å‡å°ï¼ŒRTT å‡å°ï¼Œæ‹¥å¡çª—å£å¢åŠ ã€‚å…·ä½“æ¥è¯´ï¼ŒVegas é€šè¿‡æ¯”è¾ƒå®é™…ååé‡å’ŒæœŸæœ›ååé‡æ¥è°ƒèŠ‚æ‹¥å¡çª—å£çš„å¤§å°.\næœŸæœ›ååé‡ä¸ºï¼š\n$$\nExpected = cwnd / BaseRTT\n$$\nå®é™…ååé‡ä¸ºï¼š\n$$\nActual = cwnd / RTT\n$$\nå®šä¹‰ä¸€ä¸ªå®ƒä»¬ä¹‹é—´çš„å·®è·diff:\n$$\ndiff = (Expected-Actual) * BaseRTT\n$$\nBaseRTT æ˜¯æ‰€æœ‰è§‚æµ‹æ¥å›å“åº”æ—¶é—´çš„æœ€å°å€¼ï¼Œä¸€èˆ¬æ˜¯å»ºç«‹è¿æ¥åæ‰€å‘çš„ç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„ RTTï¼Œcwnd æ˜¯ç›®å‰çš„æ‹¥å¡çª—å£çš„å¤§å°ã€‚Vegas å®šä¹‰äº†ä¸¤ä¸ªé˜ˆå€¼ aï¼Œbï¼Œå½“ diff \u0026gt; b æ—¶ï¼Œæ‹¥å¡çª—å£å‡å°ï¼Œå½“ a \u0026lt;= diff \u0026lt;=b æ—¶ï¼Œæ‹¥å¡çª—å£ä¸å˜ï¼Œå½“ diff \u0026lt; a æ—¶ï¼Œæ‹¥å¡çª—å£å¢åŠ ã€‚\nVegas ç®—æ³•é‡‡ç”¨ RTT çš„æ”¹å˜æ¥åˆ¤æ–­ç½‘ç»œçš„å¯ç”¨å¸¦å®½ï¼Œèƒ½ç²¾ç¡®åœ°æµ‹é‡ç½‘ç»œçš„å¯ç”¨å¸¦å®½ï¼Œæ•ˆç‡æ¯”è¾ƒå¥½ã€‚ä½†æ˜¯ï¼Œç½‘ç»œä¸­ Vegas ä¸å…¶å®ƒç®—æ³•å…±å­˜çš„æƒ…å†µä¸‹ï¼ŒåŸºäºä¸¢åŒ…çš„æ‹¥å¡æ§åˆ¶ç®—æ³•ä¼šå°è¯•å¡«æ»¡ç½‘ç»œä¸­çš„ç¼“å†²åŒºï¼Œå¯¼è‡´ Vegas è®¡ç®—çš„ RTT å¢å¤§ï¼Œè¿›è€Œé™ä½æ‹¥å¡çª—å£ï¼Œä½¿å¾—ä¼ è¾“é€Ÿåº¦è¶Šæ¥è¶Šæ…¢ï¼Œå› æ­¤ Vegas æœªèƒ½åœ¨ Internet ä¸Šæ™®éé‡‡ç”¨ã€‚\né€‚ç”¨åœºæ™¯ï¼š\né€‚ç”¨äºç½‘ç»œä¸­åªå­˜åœ¨ Vegas ä¸€ç§æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œç«äº‰å…¬å¹³çš„æƒ…å†µã€‚\nReferenceï¼š\n ä¸‡å­—é•¿æ–‡|å…¨ç½‘æœ€å¼º TCP/IP æ‹¥å¡æ§åˆ¶æ€»ç»“\u0026hellip; ä¸‡å­—è¯¦æ–‡ï¼šTCP æ‹¥å¡æ§åˆ¶è¯¦è§£ æµ…è°ˆ TCP æ‹¥å¡æ§åˆ¶ç®—æ³• ä¸€æ–‡è§£é‡Šæ¸…æ¥šgoogle-bbræ‹¥å¡æ§åˆ¶ç®—æ³•åŸç†  ","description":"ä»¥å¾€çš„æ‹¥å¡æ§åˆ¶ç®—æ³•æ˜¯åŸºäºTCPä¸¢åŒ…çš„ï¼Œéšç€æŠ€æœ¯çš„å‘å±•ï¼Œä¹Ÿå‡ºç°äº†åŸºäºé“¾è·¯å®¹é‡çš„ä¸€äº›æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œä¾‹å¦‚BBRï¼Œä½¿å¾—æ‹¥å¡æ§åˆ¶ä¹Ÿå¯ä»¥åŸºäºUDPï¼Œæ›´è¿›ä¸€æ­¥çš„æ¨åŠ¨äº†HTTP/3çš„å‘å±•ã€‚","id":58,"section":"posts","tags":["æ‹¥å¡æ§åˆ¶"],"title":"æ‹¥å¡æ§åˆ¶ç®—æ³•","uri":"https://hugo.jiahongw.com/zh/posts/network/congestion-control/"},{"content":"å“ˆå¤«æ›¼ç¼–ç ç®—æ³•ç”¨å­—ç¬¦åœ¨æ–‡ä»¶ä¸­å‡ºç°çš„é¢‘ç‡è¡¨æ¥å»ºç«‹ä¸€ä¸ªç”¨0ï¼Œ1ä¸²è¡¨ç¤ºå„å­—ç¬¦çš„æœ€ä¼˜è¡¨ç¤ºæ–¹å¼ã€‚ç»™å‡ºç°é¢‘ç‡é«˜çš„å­—ç¬¦è¾ƒçŸ­çš„ç¼–ç ï¼Œå‡ºç°é¢‘ç‡è¾ƒä½çš„å­—ç¬¦ä»¥è¾ƒé•¿çš„ç¼–ç ï¼Œå¯ä»¥å¤§å¤§ç¼©çŸ­æ€»ç é•¿ã€‚\nHuffman Codingä¸¤ä¸ªæ­¥éª¤  ç¼–ç (ä»è¾“å…¥çš„å­—ç¬¦æ•°æ®æ„å»ºä¸€é¢—å“ˆå¤«æ›¼æ ‘ï¼Œå¹¶å°†å­—ç¬¦ä¸²è½¬åŒ–ä½01ç¼–ç ) è§£ç (éå†å“ˆå¤«æ›¼æ ‘å°†01ç¼–ç è½¬åŒ–ä¸ºå­—ç¬¦)  æ„å»ºå“ˆå¤«æ›¼æ ‘çš„è¿‡ç¨‹  è®¡ç®—è¾“å…¥æ•°æ®çš„æ¯ä¸€ä¸ªå­—ç¬¦çš„å‡ºç°é¢‘ç‡ã€‚ ä»æœ€å°å †ä¸­æå–ä¸¤ä¸ªé¢‘ç‡æœ€å°çš„å­—ç¬¦ã€‚ åˆ›å»ºä¸€ä¸ªé¢‘ç‡ç­‰äºä¸¤ä¸ªèŠ‚ç‚¹é¢‘ç‡ä¹‹å’Œçš„æ–°å†…éƒ¨èŠ‚ç‚¹ã€‚ä½¿ç¬¬ä¸€ä¸ªæå–çš„èŠ‚ç‚¹ä¸ºå…¶å·¦å­èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªæå–çš„èŠ‚ç‚¹ä¸ºå…¶å³å­èŠ‚ç‚¹ã€‚å°†æ­¤èŠ‚ç‚¹æ·»åŠ åˆ°æœ€å°å †ä¸­ã€‚ é‡å¤step2å’Œstep3ç›´åˆ°æœ€å°å †ä¸ºç©ºã€‚  å‡å¦‚æœ‰å¦‚ä¸‹å‡ ä¸ªå­—æ¯åŠå®ƒä»¬å‡ºç°çš„æ¬¡æ•°(é¢‘ç‡):\n   å­—ç¬¦ å­—æ•°     a 5   b 4   c 3   d 2   e 1    åœ¨çº¿æ¼”ç¤ºéœå¤«æ›¼æ ‘çš„æ„å»ºï¼šhttps://people.ok.ubc.ca/ylucet/DS/Huffman.html\nC++ä½¿ç”¨STLå®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110  // C++ program for Huffman Coding #include \u0026lt;bits/stdc++.h\u0026gt; using namespace std; // A Huffman tree node struct MinHeapNode { // One of the input characters \tchar data; // Frequency of the character \tunsigned freq; // Left and right child \tMinHeapNode *left, *right; MinHeapNode(char data, unsigned freq) { left = right = NULL; this-\u0026gt;data = data; this-\u0026gt;freq = freq; } }; // For comparison of // two heap nodes (needed in min heap) struct compare { bool operator()(MinHeapNode* l, MinHeapNode* r) { return (l-\u0026gt;freq \u0026gt; r-\u0026gt;freq); } }; // Prints huffman codes from // the root of Huffman Tree. void printCodes(struct MinHeapNode* root, string str) { if (!root) return; if (root-\u0026gt;data != \u0026#39;$\u0026#39;) cout \u0026lt;\u0026lt; root-\u0026gt;data \u0026lt;\u0026lt; \u0026#34;: \u0026#34; \u0026lt;\u0026lt; str \u0026lt;\u0026lt; \u0026#34;\\n\u0026#34;; printCodes(root-\u0026gt;left, str + \u0026#34;0\u0026#34;); printCodes(root-\u0026gt;right, str + \u0026#34;1\u0026#34;); } // The main function that builds a Huffman Tree and // print codes by traversing the built Huffman Tree void HuffmanCodes(char data[], int freq[], int size) { struct MinHeapNode *left, *right, *top; // Create a min heap \u0026amp; inserts all characters of data[] \tpriority_queue\u0026lt;MinHeapNode*, vector\u0026lt;MinHeapNode*\u0026gt;, compare\u0026gt; minHeap; for (int i = 0; i \u0026lt; size; ++i) minHeap.push(new MinHeapNode(data[i], freq[i])); // Iterate while size of heap doesn\u0026#39;t become 1 \twhile (minHeap.size() != 1) { // Extract the two minimum \t// freq items from min heap \tleft = minHeap.top(); minHeap.pop(); right = minHeap.top(); minHeap.pop(); // Create a new internal node with \t// frequency equal to the sum of the \t// two nodes frequencies. Make the \t// two extracted node as left and right children \t// of this new node. Add this node \t// to the min heap \u0026#39;$\u0026#39; is a special value \t// for internal nodes, not used \ttop = new MinHeapNode(\u0026#39;$\u0026#39;, left-\u0026gt;freq + right-\u0026gt;freq); top-\u0026gt;left = left; top-\u0026gt;right = right; minHeap.push(top); } // Print Huffman codes using \t// the Huffman tree built above \tprintCodes(minHeap.top(), \u0026#34;\u0026#34;); } // Driver program to test above functions int main() { char arr[] = { \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;f\u0026#39; }; int freq[] = { 5, 9, 12, 13, 16, 45 }; int size = sizeof(arr) / sizeof(arr[0]); HuffmanCodes(arr, freq, size); return 0; } // This code is contributed by Aditya Goel   Reference:\n å“ˆå¤«æ›¼ç¼–ç çš„ç†è§£(Huffman Coding) å“ˆå¤«æ›¼ç¼–ç  Huffman Coding | Greedy Algo-3  ","description":"å“ˆå¤«æ›¼ç¼–ç ç®—æ³•ç”¨å­—ç¬¦åœ¨æ–‡ä»¶ä¸­å‡ºç°çš„é¢‘ç‡è¡¨æ¥å»ºç«‹ä¸€ä¸ªç”¨0ï¼Œ1ä¸²è¡¨ç¤ºå„å­—ç¬¦çš„æœ€ä¼˜è¡¨ç¤ºæ–¹å¼ã€‚","id":59,"section":"posts","tags":["huffman"],"title":"Huffman Treeæ˜¯å¦‚ä½•ç¼–ç çš„ï¼Ÿ","uri":"https://hugo.jiahongw.com/zh/posts/algorithmstructure/huffman-coding/"},{"content":"å‚è€ƒåœ°å€ï¼š\n cloudflare.com ä½¿ç”¨Cloudflareå’ŒNginxæ¥æ‰˜ç®¡ç½‘ç«™ ç®¡ç† Cloudflare Origin CA è¯ä¹¦ å·²å®‰è£…nginxæ”¯æŒhttpsé…ç½® nginxå¯åŠ¨ã€é‡å¯ã€å…³é—­ nginxé…ç½®sslå®ç°httpsè®¿é—®  ç‚¹å‡»SSL/TLSï¼Œå¹¶ä¸”ç‚¹å‡»æºæœåŠ¡å™¨\nè¿›å…¥ä¸‹é¢çš„é¡µé¢ï¼Œç‚¹å‡»ä¸‹é¢çš„åˆ›å»ºè¯ä¹¦ï¼Œæ¥ä¸‹æ¥æŒ‰ç…§ä¸‹é¢é“¾æ¥çš„æŒ‡å¯¼è¿›è¡Œæ“ä½œï¼š\nä½¿ç”¨Cloudflareå’ŒNginxæ¥æ‰˜ç®¡ç½‘ç«™\nåŒæ—¶åœ¨NginxæœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶nginx.confä¸­è®¾ç½®ç›¸å…³çš„é…ç½®\nnginxé…ç½®sslå®ç°httpsè®¿é—®\nå‡å¦‚Nginxæç¤ºthe \u0026quot;ssl\u0026quot; parameter requires ngx_http_ssl_module,è¡¨ç¤ºNginxæ²¡æœ‰å®‰è£…SSLæ¨¡å—ï¼ŒæŒ‰ç…§ä¸‹é¢çš„é“¾æ¥æŒ‡å¯¼è¿›è¡Œæ“ä½œ\nå·²å®‰è£…nginxæ”¯æŒhttpsé…ç½®\næ¥ä¸‹æ¥åœ¨CloudFlareä¸­è®¾ç½®å®Œå…¨ä¸¥æ ¼\næœ€åå°±å¯ä»¥çœ‹åˆ°å°é”å¤´å•¦\n","description":"ä½¿ç”¨Nginxé…åˆCloudFlareè®¾ç½®æœåŠ¡å™¨ä½¿ç”¨Httpsè¯ä¹¦ã€‚","id":60,"section":"posts","tags":["Nginx","https"],"title":"CloudFlare+Nginxé…ç½®HTTPSè¿æ¥","uri":"https://hugo.jiahongw.com/zh/posts/settings/https-set/"},{"content":"ğŸ‚ HTTPæŠ¥æ–‡ è¯·æ±‚æŠ¥æ–‡ HTTP è¯·æ±‚æŠ¥æ–‡ç”±3éƒ¨åˆ†ç»„æˆ(è¯·æ±‚è¡Œ+è¯·æ±‚å¤´+è¯·æ±‚ä½“)\nè¯·æ±‚è¡ŒåŒ…æ‹¬ï¼šè¯·æ±‚æ–¹æ³•ã€è¯·æ±‚URLã€HTTPåè®®åŠç‰ˆæœ¬ï¼š\nGETå’ŒPOSTæ˜¯æœ€å¸¸è§çš„HTTPæ–¹æ³•,åˆæ¬¡ä»¥å¤–è¿˜åŒ…æ‹¬ DELETEã€HEADã€OPTIONSã€PUTã€TRACEï¼Œä¸è¿‡ç°åœ¨å¤§éƒ¨åˆ†çš„æµè§ˆå™¨åªæ”¯æŒGETå’ŒPOST\nè¯·æ±‚å¯¹åº”çš„URLåœ°å€,ä»–å’ŒæŠ¥æ–‡å¤´çš„Hostå±æ€§,ç»„åˆèµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚URL\næŠ¥æ–‡å¤´æ˜¯ä¸€äº›å‚æ•°ä¿¡æ¯ï¼š\næœ‰è‹¥å¹²ä¸ªå±æ€§,å½¢å¼ä¸ºkey:val,æœåŠ¡ç«¯æ®æ­¤è·å–å®¢æˆ·ç«¯ä¿¡æ¯\næŠ¥æ–‡ä½“æ˜¯å…·ä½“ä¼ è¾“çš„å†…å®¹ã€‚\nå“åº”æŠ¥æ–‡ å“åº”æŠ¥æ–‡ä¸è¯·æ±‚æŠ¥æ–‡ä¸€æ ·,ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ(å“åº”è¡Œ,å“åº”å¤´,å“åº”ä½“)\nå‚è€ƒï¼šHTTPè¯·æ±‚å¤´å’Œå“åº”å¤´è¯¦è§£\nğŸš‰ HTTPçŠ¶æ€ç ï¼š  1xxï¼šè¡¨ç¤ºé€šçŸ¥ä¿¡æ¯ï¼Œå¦‚è¯·æ±‚æ”¶åˆ°äº†æˆ–æ­£åœ¨è¿›è¡Œå¤„ç†  100 Continueï¼šç»§ç»­ï¼Œå®¢æˆ·ç«¯åº”ç»§ç»­å…¶è¯·æ±‚ 101 Switching Protocols åˆ‡æ¢åè®®ã€‚æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ‡æ¢åè®®ã€‚åªèƒ½åˆ‡æ¢åˆ°æ›´é«˜çº§çš„åè®®ï¼Œä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ° HTTP çš„æ–°ç‰ˆæœ¬åè®®   2xxï¼šè¡¨ç¤ºæˆåŠŸï¼Œå¦‚æ¥æ”¶æˆ–çŸ¥é“äº†  200 OK: è¯·æ±‚æˆåŠŸ   3xxï¼šè¡¨ç¤ºé‡å®šå‘ï¼Œå¦‚è¦å®Œæˆè¯·æ±‚è¿˜å¿…é¡»é‡‡å–è¿›ä¸€æ­¥çš„è¡ŒåŠ¨  301 Moved Permanently: æ°¸ä¹…ç§»åŠ¨ã€‚è¯·æ±‚çš„èµ„æºå·²è¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°æ–° URLï¼Œè¿”å›ä¿¡æ¯ä¼šåŒ…æ‹¬æ–°çš„ URLï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®šå‘åˆ°æ–° URLã€‚ä»Šåä»»ä½•æ–°çš„è¯·æ±‚éƒ½åº”ä½¿ç”¨æ–°çš„ URL ä»£æ›¿   4xxï¼šè¡¨ç¤ºå®¢æˆ·çš„å·®é”™ï¼Œå¦‚è¯·æ±‚ä¸­æœ‰é”™è¯¯çš„è¯­æ³•æˆ–ä¸èƒ½å®Œæˆ  400 Bad Request: å®¢æˆ·ç«¯è¯·æ±‚çš„è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£ 401 Unauthorized: è¯·æ±‚è¦æ±‚ç”¨æˆ·çš„èº«ä»½è®¤è¯ 403 Forbidden: æœåŠ¡å™¨ç†è§£è¯·æ±‚å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œæ­¤è¯·æ±‚ï¼ˆæƒé™ä¸å¤Ÿï¼‰ 404 Not Found: æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚é€šè¿‡æ­¤ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯è®¾ç½® â€œæ‚¨æ‰€è¯·æ±‚çš„èµ„æºæ— æ³•æ‰¾åˆ°â€ çš„ä¸ªæ€§é¡µé¢ 408 Request Timeout: æœåŠ¡å™¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ—¶é—´è¿‡é•¿ï¼Œè¶…æ—¶   5xxï¼šè¡¨ç¤ºæœåŠ¡å™¨çš„å·®é”™ï¼Œå¦‚æœåŠ¡å™¨å¤±æ•ˆæ— æ³•å®Œæˆè¯·æ±‚  500 Internal Server Error: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ 503 Service Unavailable: ç”±äºè¶…è½½æˆ–ç³»ç»Ÿç»´æŠ¤ï¼ŒæœåŠ¡å™¨æš‚æ—¶çš„æ— æ³•å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å»¶æ—¶çš„é•¿åº¦å¯åŒ…å«åœ¨æœåŠ¡å™¨çš„ Retry-After å¤´ä¿¡æ¯ä¸­ 504 Gateway Timeout: å……å½“ç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼ŒæœªåŠæ—¶ä»è¿œç«¯æœåŠ¡å™¨è·å–è¯·æ±‚    âœ‹ HTTPçš„ä¸»è¦æ–¹æ³•   ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯æŸ¥è¯¢HTTPæœåŠ¡å™¨ç«¯æ”¯æŒçš„HTTPæ–¹æ³•ç§ç±»ã€‚\n  å‚è€ƒï¼šHTTPè¯·æ±‚å¤´å’Œå“åº”å¤´è¯¦è§£\n","description":"Httpæ˜¯å®šä¹‰åœ¨TCPä¸Šçš„ä¸€ç§ä¼ è¾“åè®®ï¼Œè¦ä¼ è¾“æ¶ˆæ¯å°±å¿…é¡»éµå®ˆè§„å®šï¼Œæœ¬æ–‡æ˜¯ä½¿ç”¨Httpçš„å‘é€æ¶ˆæ¯ä¸æ¥å—æ¶ˆæ¯çš„æŠ¥æ–‡è§„å®šåŠæ–¹æ³•ã€‚","id":61,"section":"posts","tags":["http"],"title":"HttpæŠ¥æ–‡æ ¼å¼åŠHttpæ–¹æ³•","uri":"https://hugo.jiahongw.com/zh/posts/network/http-message/"},{"content":"åŒæ­¥å¼‚æ­¥ä¸é˜»å¡éé˜»å¡ ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´ æ“ä½œç³»ç»Ÿä¸ºäº†æ”¯æŒå¤šä¸ªåº”ç”¨åŒæ—¶è¿è¡Œï¼Œéœ€è¦ä¿è¯ä¸åŒè¿›ç¨‹ä¹‹é—´ç›¸å¯¹ç‹¬ç«‹ï¼ˆä¸€ä¸ªè¿›ç¨‹çš„å´©æºƒä¸ä¼šå½±å“å…¶ä»–çš„è¿›ç¨‹ ï¼Œ æ¶æ„è¿›ç¨‹ä¸èƒ½ç›´æ¥è¯»å–å’Œä¿®æ”¹å…¶ä»–è¿›ç¨‹è¿è¡Œæ—¶çš„ä»£ç å’Œæ•°æ®ï¼‰ã€‚ å› æ­¤æ“ä½œç³»ç»Ÿå†…æ ¸éœ€è¦æ‹¥æœ‰é«˜äºæ™®é€šè¿›ç¨‹çš„æƒé™ï¼Œ ä»¥æ­¤æ¥è°ƒåº¦å’Œç®¡ç†ç”¨æˆ·çš„åº”ç”¨ç¨‹åºã€‚\näºæ˜¯å†…å­˜ç©ºé—´è¢«åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†ä¸ºå†…æ ¸ç©ºé—´ï¼Œä¸€éƒ¨åˆ†ä¸ºç”¨æˆ·ç©ºé—´ï¼Œå†…æ ¸ç©ºé—´å­˜å‚¨çš„ä»£ç å’Œæ•°æ®å…·æœ‰æ›´é«˜çº§åˆ«çš„æƒé™ã€‚å†…å­˜è®¿é—®çš„ç›¸å…³ç¡¬ä»¶åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ä¼šè¿›è¡Œè®¿é—®æ§åˆ¶ï¼ˆ Access Controlï¼‰ï¼Œä½¿å¾—ç”¨æˆ·ç©ºé—´çš„ç¨‹åºä¸èƒ½ç›´æ¥è¯»å†™å†…æ ¸ç©ºé—´çš„å†…å­˜ã€‚\nè¿›ç¨‹åˆ‡æ¢ ä¸Šå›¾å±•ç¤ºäº†è¿›ç¨‹åˆ‡æ¢ä¸­å‡ ä¸ªæœ€é‡è¦çš„æ­¥éª¤ï¼š\n å½“ä¸€ä¸ªç¨‹åºæ­£åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œ ä¸­æ–­ï¼ˆinterruptï¼‰ æˆ– ç³»ç»Ÿè°ƒç”¨ï¼ˆsystem callï¼‰ å‘ç”Ÿå¯ä»¥ä½¿å¾— CPU çš„æ§åˆ¶æƒä¼šä»å½“å‰è¿›ç¨‹è½¬ç§»åˆ°æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚ æ“ä½œç³»ç»Ÿå†…æ ¸è´Ÿè´£ä¿å­˜è¿›ç¨‹ i åœ¨ CPU ä¸­çš„ä¸Šä¸‹æ–‡ï¼ˆç¨‹åºè®¡æ•°å™¨ï¼Œ å¯„å­˜å™¨ï¼‰åˆ° PCBi ï¼ˆæ“ä½œç³»ç»Ÿåˆ†é…ç»™è¿›ç¨‹çš„ä¸€ä¸ªå†…å­˜å—ï¼‰ä¸­ã€‚ ä» PCBj å–å‡ºè¿›ç¨‹ j çš„CPU ä¸Šä¸‹æ–‡ï¼Œ å°† CPU æ§åˆ¶æƒè½¬ç§»ç»™è¿›ç¨‹ j ï¼Œ å¼€å§‹æ‰§è¡Œè¿›ç¨‹ j çš„æŒ‡ä»¤ã€‚   å¯ä»¥çœ‹å‡ºæ¥ï¼Œ æ“ä½œç³»ç»Ÿåœ¨è¿›è¡Œè¿›åˆ‡æ¢æ—¶ï¼Œéœ€è¦è¿›è¡Œä¸€ç³»åˆ—çš„å†…å­˜è¯»å†™æ“ä½œï¼Œ è¿™å¸¦æ¥äº†ä¸€å®šçš„å¼€é”€\n è¿›ç¨‹é˜»å¡ ä¸Šå›¾å±•ç¤ºäº†ä¸€ä¸ªè¿›ç¨‹çš„ä¸åŒçŠ¶æ€ï¼š\n New. è¿›ç¨‹æ­£åœ¨è¢«åˆ›å»º. Running. è¿›ç¨‹çš„æŒ‡ä»¤æ­£åœ¨è¢«æ‰§è¡Œ Waiting. è¿›ç¨‹æ­£åœ¨ç­‰å¾…ä¸€äº›äº‹ä»¶çš„å‘ç”Ÿï¼ˆä¾‹å¦‚ I/O çš„å®Œæˆæˆ–è€…æ”¶åˆ°æŸä¸ªä¿¡å·ï¼‰ Ready. è¿›ç¨‹åœ¨ç­‰å¾…è¢«æ“ä½œç³»ç»Ÿè°ƒåº¦ Terminated. è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ï¼ˆå¯èƒ½æ˜¯è¢«å¼ºè¡Œç»ˆæ­¢çš„ï¼‰  æˆ‘ä»¬æ‰€è¯´çš„ â€œé˜»å¡â€æ˜¯æŒ‡è¿›ç¨‹åœ¨å‘èµ·äº†ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼ˆSystem Callï¼‰ åï¼Œ ç”±äºè¯¥ç³»ç»Ÿè°ƒç”¨çš„æ“ä½œä¸èƒ½ç«‹å³å®Œæˆï¼Œéœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œäºæ˜¯å†…æ ¸å°†è¿›ç¨‹æŒ‚èµ·ä¸º**ç­‰å¾… ï¼ˆwaitingï¼‰**çŠ¶æ€ï¼Œ ä»¥ç¡®ä¿å®ƒä¸ä¼šè¢«è°ƒåº¦æ‰§è¡Œï¼Œ å ç”¨ CPU èµ„æºã€‚\né˜»å¡çš„åŸç†\né˜»å¡çš„åŸç†ï¼Ÿ\nå¯¹äºSocketæ¥è¯´ï¼š\nå½“å‘ç”Ÿé˜»å¡æ—¶å€™ï¼Œè°ƒç”¨é˜»å¡ç¨‹åºï¼Œè€Œé˜»å¡ç¨‹åºæœ€é‡è¦çš„ä¸€ä¸ªæ“ä½œå°±æ˜¯å°†è¿›ç¨‹ä»å·¥ä½œé˜Ÿåˆ—ç§»é™¤ï¼Œå¹¶ä¸”å°†å…¶åŠ åˆ°ç­‰å¾…é˜Ÿåˆ—ã€‚\nå½“å‘ç”Ÿä¸­æ–­æ—¶å€™ï¼Œè°ƒç”¨ä¸­æ–­ç¨‹åºï¼Œè€Œä¸­æ–­ç¨‹åºæœ€é‡è¦çš„ä¸€ä¸ªæ“ä½œå°±æ˜¯å°†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„è¿›ç¨‹é‡æ–°ç§»å›å·¥ä½œé˜Ÿåˆ—ï¼Œç»§ç»­åˆ†é…ç³»ç»Ÿçš„CPUèµ„æºã€‚\næ–‡ä»¶æè¿°ç¬¦ æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„å¥æŸ„æ˜¯0ã€1ã€2ä¸‰ä¸ªï¼Œ0æ˜¯æ ‡å‡†è¾“å…¥ï¼Œ1æ˜¯æ ‡å‡†è¾“å‡ºï¼Œ2æ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºã€‚0ã€1ã€2æ˜¯æ•´æ•°è¡¨ç¤ºçš„ï¼Œå¯¹åº”çš„FILE *ç»“æ„çš„è¡¨ç¤ºå°±æ˜¯stdinã€stdoutã€stderrï¼Œ0å°±æ˜¯stdinï¼Œ1å°±æ˜¯stdoutï¼Œ2å°±æ˜¯stderrã€‚\n1 2 3 4 5 6 7 8 9 10 11  #include \u0026lt;stdio.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;#include \u0026lt;string.h\u0026gt;int main(int argc, char **argv) { char buf[10] = \u0026#34;\u0026#34;; read(0, buf, 9);\t/* ä»æ ‡å‡†è¾“å…¥ 0 è¯»å…¥å­—ç¬¦ */ // fprintf(stdout, \u0026#34;%s\\n\u0026#34;, buf); /* å‘æ ‡å‡†è¾“å‡º stdout å†™å­—ç¬¦ */ \twrite(1, buf, strlen(buf)); return 0; }   åŒæ­¥ åŒæ­¥å°±æ˜¯ä¸€ä¸ªä»»åŠ¡çš„å®Œæˆéœ€è¦ä¾èµ–å¦å¤–ä¸€ä¸ªä»»åŠ¡æ—¶ï¼Œåªæœ‰ç­‰å¾…è¢«ä¾èµ–çš„ä»»åŠ¡å®Œæˆåï¼Œä¾èµ–çš„ä»»åŠ¡æ‰èƒ½ç®—å®Œæˆï¼Œè¿™æ˜¯ä¸€ç§å¯é çš„ä»»åŠ¡åºåˆ—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè°ƒç”¨ä¼šç­‰å¾…è¿”å›ç»“æœè®¡ç®—å®Œæˆæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚\nå¼‚æ­¥ å¼‚æ­¥æ˜¯ä¸éœ€è¦ç­‰å¾…è¢«ä¾èµ–çš„ä»»åŠ¡å®Œæˆï¼Œåªæ˜¯é€šçŸ¥è¢«ä¾èµ–çš„ä»»åŠ¡è¦å®Œæˆä»€ä¹ˆå·¥ä½œï¼Œä¾èµ–çš„ä»»åŠ¡ä¹Ÿç«‹å³æ‰§è¡Œï¼Œåªè¦è‡ªå·±å®Œæˆäº†æ•´ä¸ªä»»åŠ¡å°±ç®—å®Œæˆäº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶å®å¼‚æ­¥è°ƒç”¨ä¼šç›´æ¥è¿”å›ï¼Œä½†æ˜¯è¿™ä¸ªç»“æœä¸æ˜¯è®¡ç®—çš„ç»“æœï¼Œå½“ç»“æœè®¡ç®—å‡ºæ¥ä¹‹åï¼Œæ‰é€šçŸ¥è¢«è°ƒç”¨çš„ç¨‹åºã€‚\n ä¸¾ä¸ªé€šä¿—çš„ä¾‹å­ï¼š\nä½ æ‰“ç”µè¯é—®ä¹¦åº—è€æ¿æœ‰æ²¡æœ‰ã€Šåˆ†å¸ƒå¼ç³»ç»Ÿã€‹è¿™æœ¬ä¹¦ï¼Œå¦‚æœæ˜¯åŒæ­¥é€šä¿¡æœºåˆ¶ï¼Œä¹¦åº—è€æ¿ä¼šè¯´ï¼Œä½ ç¨ç­‰ï¼Œâ€æˆ‘æŸ¥ä¸€ä¸‹\u0026rdquo;ï¼Œç„¶åå¼€å§‹æŸ¥å•ŠæŸ¥ï¼Œç­‰æŸ¥å¥½äº†ï¼ˆå¯èƒ½æ˜¯5ç§’ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€å¤©ï¼‰å‘Šè¯‰ä½ ç»“æœï¼ˆè¿”å›ç»“æœï¼‰ã€‚\nè€Œå¼‚æ­¥é€šä¿¡æœºåˆ¶ï¼Œä¹¦åº—è€æ¿ç›´æ¥å‘Šè¯‰ä½ æˆ‘æŸ¥ä¸€ä¸‹å•Šï¼ŒæŸ¥å¥½äº†æ‰“ç”µè¯ç»™ä½ ï¼Œç„¶åç›´æ¥æŒ‚ç”µè¯äº†ï¼ˆä¸è¿”å›ç»“æœï¼‰ã€‚ç„¶åæŸ¥å¥½äº†ï¼Œä»–ä¼šä¸»åŠ¨æ‰“ç”µè¯ç»™ä½ ã€‚åœ¨è¿™é‡Œè€æ¿é€šè¿‡â€œå›ç”µâ€è¿™ç§æ–¹å¼æ¥å›è°ƒã€‚\n é˜»å¡ é˜»å¡è°ƒç”¨æ˜¯æŒ‡è°ƒç”¨ç»“æœè¿”å›ä¹‹å‰ï¼Œå½“å‰çº¿ç¨‹ä¼šè¢«æŒ‚èµ·ï¼Œä¸€ç›´å¤„äºç­‰å¾…æ¶ˆæ¯é€šçŸ¥ï¼Œä¸èƒ½å¤Ÿæ‰§è¡Œå…¶ä»–ä¸šåŠ¡ã€‚\néé˜»å¡ ä¸ç®¡å¯ä¸å¯ä»¥è¯»å†™ï¼Œå®ƒéƒ½ä¼šç«‹å³è¿”å›ï¼Œè¿”å›æˆåŠŸè¯´æ˜è¯»å†™æ“ä½œå®Œæˆäº†ï¼Œè¿”å›å¤±è´¥ä¼šè®¾ç½®ç›¸åº”errnoçŠ¶æ€ç ï¼Œæ ¹æ®è¿™ä¸ªerrnoå¯ä»¥è¿›ä¸€æ­¥æ‰§è¡Œå…¶ä»–å¤„ç†ã€‚å®ƒä¸ä¼šåƒé˜»å¡IOé‚£æ ·ï¼Œå¡åœ¨é‚£é‡Œä¸åŠ¨ã€‚\n é˜»å¡å’Œéé˜»å¡å…³æ³¨çš„æ˜¯ç¨‹åºåœ¨ç­‰å¾…è°ƒç”¨ç»“æœï¼ˆæ¶ˆæ¯ï¼Œè¿”å›å€¼ï¼‰æ—¶çš„çŠ¶æ€.\n å¯ä»¥è¿™ä¹ˆç†è§£ä¹ˆï¼Ÿé˜»å¡å’Œéé˜»å¡ï¼Œåº”è¯¥æè¿°çš„æ˜¯ä¸€ç§çŠ¶æ€ï¼ŒåŒæ­¥ä¸éåŒæ­¥æè¿°çš„æ˜¯è¡Œä¸ºæ–¹å¼.\nå¤šè·¯å¤ç”¨ ==IOå¤šè·¯å¤ç”¨æ˜¯æŒ‡å†…æ ¸ä¸€æ—¦å‘ç°è¿›ç¨‹æŒ‡å®šçš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªIOæ¡ä»¶å‡†å¤‡è¯»å–ï¼Œå®ƒå°±é€šçŸ¥è¯¥è¿›ç¨‹==ã€‚\nåœ¨å¤„ç† IO çš„æ—¶å€™ï¼Œé˜»å¡å’Œéé˜»å¡éƒ½æ˜¯åŒæ­¥ IOã€‚\nåªæœ‰ä½¿ç”¨äº†ç‰¹æ®Šçš„ API æ‰æ˜¯å¼‚æ­¥ IOã€‚\nselectã€pollã€epollä¹‹é—´çš„åŒºåˆ«ï¼š\n   \\ select poll epoll     æ“ä½œæ–¹å¼ éå† éå† å›è°ƒ   åº•å±‚å®ç° æ•°ç»„ é“¾è¡¨ å“ˆå¸Œè¡¨   IOæ•ˆç‡ æ¯æ¬¡è°ƒç”¨éƒ½è¿›è¡Œçº¿æ€§éå†ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n) æ¯æ¬¡è°ƒç”¨éƒ½è¿›è¡Œçº¿æ€§éå†ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n) äº‹ä»¶é€šçŸ¥æ–¹å¼ï¼Œæ¯å½“fdå°±ç»ªï¼Œç³»ç»Ÿæ³¨å†Œçš„å›è°ƒå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ï¼Œå°†å°±ç»ªfdæ”¾åˆ°rdllisté‡Œé¢ã€‚æ—¶é—´å¤æ‚åº¦O(1)   æœ€å¤§è¿æ¥æ•° 1024ï¼ˆx86ï¼‰æˆ– 2048ï¼ˆx64ï¼‰ æ— ä¸Šé™ æ— ä¸Šé™   fdæ‹·è´ æ¯æ¬¡è°ƒç”¨selectï¼Œéƒ½éœ€è¦æŠŠfdé›†åˆä»ç”¨æˆ·æ€æ‹·è´åˆ°å†…æ ¸æ€ æ¯æ¬¡è°ƒç”¨pollï¼Œéƒ½éœ€è¦æŠŠfdé›†åˆä»ç”¨æˆ·æ€æ‹·è´åˆ°å†…æ ¸æ€ è°ƒç”¨epoll_ctlæ—¶æ‹·è´è¿›å†…æ ¸å¹¶ä¿å­˜ï¼Œä¹‹åæ¯æ¬¡epoll_waitä¸æ‹·è´    Select åŸºäºselectè°ƒç”¨çš„I/Oå¤ç”¨æ¨¡å‹å¦‚ä¸‹ï¼š\næµç¨‹ ä¼ ç»Ÿselect/pollçš„å¦ä¸€ä¸ªè‡´å‘½å¼±ç‚¹å°±æ˜¯å½“ä½ æ‹¥æœ‰ä¸€ä¸ªå¾ˆå¤§çš„socketé›†åˆï¼Œç”±äºç½‘ç»œå¾—å»¶æ—¶ï¼Œä½¿å¾—ä»»ä¸€æ—¶é—´åªæœ‰éƒ¨åˆ†çš„socketæ˜¯\u0026quot;æ´»è·ƒ\u0026rdquo; çš„ï¼Œè€Œselect/pollæ¯æ¬¡è°ƒç”¨éƒ½ä¼šçº¿æ€§æ‰«æå…¨éƒ¨çš„é›†åˆï¼Œå¯¼è‡´æ•ˆç‡å‘ˆç°çº¿æ€§ä¸‹é™ã€‚\nä½†æ˜¯epollä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œå®ƒåªä¼šå¯¹\u0026quot;æ´»è·ƒ\u0026quot;çš„socketè¿› è¡Œæ“ä½œ\u0026mdash;è¿™æ˜¯å› ä¸ºåœ¨å†…æ ¸å®ç°ä¸­epollæ˜¯æ ¹æ®æ¯ä¸ªfdä¸Šé¢çš„callbackå‡½æ•°å®ç°çš„ã€‚äºæ˜¯ï¼Œåªæœ‰\u0026quot;æ´»è·ƒ\u0026quot;çš„socketæ‰ä¼šä¸»åŠ¨å»è°ƒç”¨ callbackå‡½æ•°ï¼Œå…¶ä»–idleçŠ¶æ€çš„socketåˆ™ä¸ä¼šï¼Œåœ¨è¿™ç‚¹ä¸Šï¼Œepollå®ç°äº†ä¸€ä¸ª\u0026ldquo;ä¼ª\u0026quot;AIOï¼Œå› ä¸ºè¿™æ—¶å€™æ¨åŠ¨åŠ›åœ¨oså†…æ ¸ã€‚\nè¿‡ç¨‹\nå½“è¿›ç¨‹Aè°ƒç”¨selectè¯­å¥çš„æ—¶å€™ï¼Œä¼šå°†è¿›ç¨‹Aæ·»åŠ åˆ°å¤šä¸ªç›‘å¬socketçš„ç­‰å¾…é˜Ÿåˆ—ä¸­\nå½“ç½‘å¡æ¥æ”¶åˆ°æ•°æ®ï¼Œç„¶åç½‘å¡é€šè¿‡ä¸­æ–­ä¿¡å·é€šçŸ¥cpuæœ‰æ•°æ®åˆ°è¾¾ï¼Œæ‰§è¡Œä¸­æ–­ç¨‹åºï¼Œä¸­æ–­ç¨‹åºä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼š\n å°†ç½‘ç»œæ•°æ®å†™å…¥åˆ°å¯¹åº”socketçš„æ¥æ”¶ç¼“å†²åŒºé‡Œé¢ å”¤é†’é˜Ÿåˆ—ä¸­çš„ç­‰å¾…è¿›ç¨‹(A),é‡æ–°å°†è¿›ç¨‹Aæ”¾å…¥å·¥ä½œé˜Ÿåˆ—ä¸­.  å¦‚ä¸‹å›¾ï¼Œå°†æ‰€æœ‰ç­‰å¾…é˜Ÿåˆ—çš„è¿›ç¨‹ç§»é™¤ï¼Œå¹¶ä¸”æ·»åŠ åˆ°å·¥ä½œé˜Ÿåˆ—ä¸­ã€‚\n ä¸Šé¢åªæ˜¯ä¸€ç§æƒ…å†µï¼Œå½“ç¨‹åºè°ƒç”¨ Select æ—¶ï¼Œå†…æ ¸ä¼šå…ˆéå†ä¸€é Socketï¼Œå¦‚æœæœ‰ä¸€ä¸ªä»¥ä¸Šçš„ Socket æ¥æ”¶ç¼“å†²åŒºæœ‰æ•°æ®ï¼Œé‚£ä¹ˆ Select ç›´æ¥è¿”å›ï¼Œä¸ä¼šé˜»å¡ã€‚\n é—®é¢˜ï¼š\n æ¯æ¬¡è°ƒç”¨ Select éƒ½éœ€è¦å°†è¿›ç¨‹åŠ å…¥åˆ°æ‰€æœ‰ç›‘è§† Socket çš„ç­‰å¾…é˜Ÿåˆ—ï¼Œæ¯æ¬¡å”¤é†’éƒ½éœ€è¦ä»æ¯ä¸ªé˜Ÿåˆ—ä¸­ç§»é™¤ã€‚è¿™é‡Œæ¶‰åŠäº†ä¸¤æ¬¡éå†ï¼Œè€Œä¸”æ¯æ¬¡éƒ½è¦å°†æ•´ä¸ª FDS åˆ—è¡¨ä¼ é€’ç»™å†…æ ¸ï¼Œæœ‰ä¸€å®šçš„å¼€é”€ã€‚ è¿›ç¨‹è¢«å”¤é†’åï¼Œç¨‹åºå¹¶ä¸çŸ¥é“å“ªäº› Socket æ”¶åˆ°æ•°æ®ï¼Œè¿˜éœ€è¦éå†ä¸€æ¬¡   selectå’Œpollåœ¨å†…éƒ¨æœºåˆ¶æ–¹é¢å¹¶æ²¡æœ‰å¤ªå¤§çš„å·®å¼‚ã€‚ç›¸æ¯”äºselectæœºåˆ¶ï¼Œpollåªæ˜¯å–æ¶ˆäº†æœ€å¤§ç›‘æ§æ–‡ä»¶æè¿°ç¬¦æ•°é™åˆ¶ï¼Œå¹¶æ²¡æœ‰ä»æ ¹æœ¬ä¸Šè§£å†³selectå­˜åœ¨çš„é—®é¢˜ã€‚\n Slect API è½®è¯¢æ‰€æœ‰çš„å¥æŸ„ï¼Œæ‰¾åˆ°æœ‰å¤„ç†çŠ¶æ€çš„å¥æŸ„å¹¶ä¸”è¿›è¡Œæ“ä½œã€‚\nä¸»è¦å‡½æ•°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  /* According to POSIX.1-2001 */ #include \u0026lt;sys/select.h\u0026gt; /* According to earlier standards */ #include \u0026lt;sys/time.h\u0026gt;#include \u0026lt;sys/types.h\u0026gt;#include \u0026lt;unistd.h\u0026gt; int select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, struct timeval *timeout); /** nfds: ç›‘æ§çš„æ–‡ä»¶æè¿°ç¬¦é›†é‡Œæœ€å¤§æ–‡ä»¶æè¿°ç¬¦åŠ 1ï¼Œå› ä¸ºæ­¤å‚æ•°ä¼šå‘Šè¯‰å†…æ ¸æ£€æµ‹å‰å¤šå°‘ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„çŠ¶æ€ readfdsï¼š ç›‘æ§æœ‰è¯»æ•°æ®åˆ°è¾¾æ–‡ä»¶æè¿°ç¬¦é›†åˆï¼Œä¼ å…¥ä¼ å‡ºå‚æ•° writefdsï¼š ç›‘æ§å†™æ•°æ®åˆ°è¾¾æ–‡ä»¶æè¿°ç¬¦é›†åˆï¼Œä¼ å…¥ä¼ å‡ºå‚æ•° exceptfdsï¼š ç›‘æ§å¼‚å¸¸å‘ç”Ÿè¾¾æ–‡ä»¶æè¿°ç¬¦é›†åˆ,å¦‚å¸¦å¤–æ•°æ®åˆ°è¾¾å¼‚å¸¸ï¼Œä¼ å…¥ä¼ å‡ºå‚æ•° timeoutï¼š å®šæ—¶é˜»å¡ç›‘æ§æ—¶é—´ï¼Œ3ç§æƒ…å†µ 1.NULLï¼Œæ°¸è¿œç­‰ä¸‹å» 2.è®¾ç½®timevalï¼Œç­‰å¾…å›ºå®šæ—¶é—´ 3.è®¾ç½®timevalé‡Œæ—¶é—´å‡ä¸º0ï¼Œæ£€æŸ¥æè¿°å­—åç«‹å³è¿”å›ï¼Œè½®è¯¢ struct timeval { long tv_sec; // seconds long tv_usec; // microseconds }; */ void FD_CLR(int fd, fd_set *set);\t// æŠŠæ–‡ä»¶æè¿°ç¬¦é›†åˆé‡Œfdæ¸…0 int FD_ISSET(int fd, fd_set *set); // æµ‹è¯•æ–‡ä»¶æè¿°ç¬¦é›†åˆé‡Œfdæ˜¯å¦ç½®1 void FD_SET(int fd, fd_set *set); // æŠŠæ–‡ä»¶æè¿°ç¬¦é›†åˆé‡Œfdä½ç½®1 void FD_ZERO(fd_set *set);\t//æŠŠæ–‡ä»¶æè¿°ç¬¦é›†åˆé‡Œæ‰€æœ‰ä½æ¸…0   Selectä¾‹å­ æœåŠ¡å™¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215  /************************************************************************* \u0026gt; File Name: server.cpp \u0026gt; Author: SongLee \u0026gt; E-mail: lisong.shine@qq.com \u0026gt; Created Time: 2016å¹´04æœˆ28æ—¥ æ˜ŸæœŸå›› 22æ—¶02åˆ†43ç§’ \u0026gt; Personal Blog: http://songlee24.github.io/ ************************************************************************/ #include \u0026lt;netinet/in.h\u0026gt; // sockaddr_in#include \u0026lt;sys/types.h\u0026gt; // socket#include \u0026lt;sys/socket.h\u0026gt; // socket#include \u0026lt;arpa/inet.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;#include \u0026lt;sys/select.h\u0026gt; // select#include \u0026lt;sys/ioctl.h\u0026gt;#include \u0026lt;sys/time.h\u0026gt;#include \u0026lt;iostream\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;string\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; #define BUFFER_SIZE 1024 struct PACKET_HEAD { int length; }; class Server { private: struct sockaddr_in server_addr; socklen_t server_addr_len; int listen_fd; // ç›‘å¬çš„fd  int max_fd; // æœ€å¤§çš„fd  fd_set master_set; // æ‰€æœ‰fdé›†åˆï¼ŒåŒ…æ‹¬ç›‘å¬fdå’Œå®¢æˆ·ç«¯fd  fd_set working_set; // å·¥ä½œé›†åˆ  struct timeval timeout; public: Server(int port); ~Server(); void Bind(); void Listen(int queue_len = 20); void Accept(); void Run(); void Recv(int nums); }; Server::Server(int port) { bzero(\u0026amp;server_addr, sizeof(server_addr)); server_addr.sin_family = AF_INET; server_addr.sin_addr.s_addr = htons(INADDR_ANY); server_addr.sin_port = htons(port); // create socket to listen  listen_fd = socket(PF_INET, SOCK_STREAM, 0); if (listen_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Create Socket Failed!\u0026#34;; exit(1); } int opt = 1; // å…è®¸é‡ç”¨æœ¬åœ°åœ°å€å’Œç«¯å£  setsockopt(listen_fd, SOL_SOCKET, SO_REUSEADDR, \u0026amp;opt, sizeof(opt)); } Server::~Server() { for (int fd = 0; fd \u0026lt;= max_fd; ++fd) { if (FD_ISSET(fd, \u0026amp;master_set)) { close(fd); } } } void Server::Bind() { if (-1 == (bind(listen_fd, (struct sockaddr *)\u0026amp;server_addr, sizeof(server_addr)))) { cout \u0026lt;\u0026lt; \u0026#34;Server Bind Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Bind Successfully.\\n\u0026#34;; } void Server::Listen(int queue_len) { if (-1 == listen(listen_fd, queue_len)) { cout \u0026lt;\u0026lt; \u0026#34;Server Listen Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Listen Successfully.\\n\u0026#34;; } void Server::Accept() { struct sockaddr_in client_addr; socklen_t client_addr_len = sizeof(client_addr); int new_fd = accept(listen_fd, (struct sockaddr *)\u0026amp;client_addr, \u0026amp;client_addr_len); if (new_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Server Accept Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;new connection was accepted.\\n\u0026#34;; // å°†æ–°å»ºç«‹çš„è¿æ¥çš„fdåŠ å…¥master_set  FD_SET(new_fd, \u0026amp;master_set); if (new_fd \u0026gt; max_fd) { max_fd = new_fd; } } void Server::Run() { max_fd = listen_fd; // åˆå§‹åŒ–max_fd  FD_ZERO(\u0026amp;master_set); FD_SET(listen_fd, \u0026amp;master_set); // æ·»åŠ ç›‘å¬fd  while (1) { FD_ZERO(\u0026amp;working_set); memcpy(\u0026amp;working_set, \u0026amp;master_set, sizeof(master_set)); timeout.tv_sec = 30; timeout.tv_usec = 0; int nums = select(max_fd + 1, \u0026amp;working_set, NULL, NULL, \u0026amp;timeout); if (nums \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;select() error!\u0026#34;; exit(1); } if (nums == 0) { //cout \u0026lt;\u0026lt; \u0026#34;select() is timeout!\u0026#34;;  continue; } if (FD_ISSET(listen_fd, \u0026amp;working_set)) Accept(); // æœ‰æ–°çš„å®¢æˆ·ç«¯è¯·æ±‚  else Recv(nums); // æ¥æ”¶å®¢æˆ·ç«¯çš„æ¶ˆæ¯  } } void Server::Recv(int nums) { for (int fd = 0; fd \u0026lt;= max_fd; ++fd) { if (FD_ISSET(fd, \u0026amp;working_set)) { bool close_conn = false; // æ ‡è®°å½“å‰è¿æ¥æ˜¯å¦æ–­å¼€äº†  PACKET_HEAD head; recv(fd, \u0026amp;head, sizeof(head), 0); // å…ˆæ¥å—åŒ…å¤´ï¼Œå³æ•°æ®æ€»é•¿åº¦  // std::cout \u0026lt;\u0026lt; head.length \u0026lt;\u0026lt; std::endl;  char *buffer = new char[head.length]; bzero(buffer, head.length); int total = 0; while (total \u0026lt; head.length) { int len = recv(fd, buffer + total, head.length - total, 0); if (len \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;recv() error!\u0026#34;; close_conn = true; break; } total = total + len; } if (total == head.length) // å°†æ”¶åˆ°çš„æ¶ˆæ¯åŸæ ·å‘å›ç»™å®¢æˆ·ç«¯  { int ret1 = send(fd, \u0026amp;head, sizeof(head), 0); int ret2 = send(fd, buffer, head.length, 0); if (ret1 \u0026lt; 0 || ret2 \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;send() error!\u0026#34;; close_conn = true; } } delete buffer; if (close_conn) // å½“å‰è¿™ä¸ªè¿æ¥æœ‰é—®é¢˜ï¼Œå…³é—­å®ƒ  { close(fd); FD_CLR(fd, \u0026amp;master_set); if (fd == max_fd) // éœ€è¦æ›´æ–°max_fd;  { while (FD_ISSET(max_fd, \u0026amp;master_set) == false) --max_fd; } } } } } int main() { Server server(15000); server.Bind(); server.Listen(); server.Run(); return 0; }   å®¢æˆ·ç«¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127  /************************************************************************* \u0026gt; File Name: client.cpp \u0026gt; Author: SongLee \u0026gt; E-mail: lisong.shine@qq.com \u0026gt; Created Time: 2016å¹´04æœˆ28æ—¥ æ˜ŸæœŸå›› 23æ—¶10åˆ†15ç§’ \u0026gt; Personal Blog: http://songlee24.github.io/ ************************************************************************/ #include\u0026lt;netinet/in.h\u0026gt; // sockaddr_in#include\u0026lt;sys/types.h\u0026gt; // socket#include\u0026lt;sys/socket.h\u0026gt; // socket#include\u0026lt;arpa/inet.h\u0026gt;#include\u0026lt;sys/ioctl.h\u0026gt;#include\u0026lt;unistd.h\u0026gt;#include\u0026lt;iostream\u0026gt;#include\u0026lt;string\u0026gt;#include\u0026lt;cstdlib\u0026gt;#include\u0026lt;cstdio\u0026gt;#include\u0026lt;cstring\u0026gt;using namespace std; #define BUFFER_SIZE 1024 struct PACKET_HEAD { int length; }; class Client { private: struct sockaddr_in server_addr; socklen_t server_addr_len; int fd; public: Client(string ip, int port); ~Client(); void Connect(); void Send(string str); string Recv(); }; Client::Client(string ip, int port) { bzero(\u0026amp;server_addr, sizeof(server_addr)); server_addr.sin_family = AF_INET; if(inet_pton(AF_INET, ip.c_str(), \u0026amp;server_addr.sin_addr) == 0) { cout \u0026lt;\u0026lt; \u0026#34;Server IP Address Error!\u0026#34;; exit(1); } server_addr.sin_port = htons(port); server_addr_len = sizeof(server_addr); // create socket  fd = socket(AF_INET, SOCK_STREAM, 0); if(fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Create Socket Failed!\u0026#34;; exit(1); } } Client::~Client() { close(fd); } void Client::Connect() { cout \u0026lt;\u0026lt; \u0026#34;Connecting......\u0026#34; \u0026lt;\u0026lt; endl; if(connect(fd, (struct sockaddr*)\u0026amp;server_addr, server_addr_len) \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Can not Connect to Server IP!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Connect to Server successfully.\u0026#34; \u0026lt;\u0026lt; endl; } void Client::Send(string str) { PACKET_HEAD head; head.length = str.size()+1; // æ³¨æ„è¿™é‡Œéœ€è¦+1  int ret1 = send(fd, \u0026amp;head, sizeof(head), 0); int ret2 = send(fd, str.c_str(), head.length, 0); if(ret1 \u0026lt; 0 || ret2 \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Send Message Failed!\u0026#34;; exit(1); } } string Client::Recv() { PACKET_HEAD head; recv(fd, \u0026amp;head, sizeof(head), 0); char* buffer = new char[head.length]; bzero(buffer, head.length); int total = 0; while(total \u0026lt; head.length) { int len = recv(fd, buffer + total, head.length - total, 0); if(len \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;recv() error!\u0026#34;; break; } total = total + len; } string result(buffer); delete buffer; return result; } int main() { Client client(\u0026#34;127.0.0.1\u0026#34;, 15000); client.Connect(); while(1) { string msg; getline(cin, msg); if(msg == \u0026#34;exit\u0026#34;) break; client.Send(msg); cout \u0026lt;\u0026lt; client.Recv() \u0026lt;\u0026lt; endl; } return 0; }   è¯´æ˜ï¼š\n ç›‘å¬socketä¹Ÿç”±selectæ¥è½®è¯¢ï¼Œä¸éœ€è¦å•ç‹¬çš„çº¿ç¨‹ï¼› working_setæ¯æ¬¡éƒ½è¦é‡æ–°è®¾ç½®ï¼Œå› ä¸ºselectè°ƒç”¨åå®ƒæ‰€æ£€æµ‹çš„é›†åˆworking_setä¼šè¢«ä¿®æ”¹ï¼› æ¥æ”¶å¾ˆé•¿ä¸€æ®µæ•°æ®æ—¶ï¼Œéœ€è¦å¾ªç¯å¤šæ¬¡recvã€‚ä½†æ˜¯recvå‡½æ•°ä¼šé˜»å¡ï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰åŒ…å¤´ï¼ˆä¿å­˜æ•°æ®é•¿åº¦ï¼‰  Poll pollçš„æœºåˆ¶ä¸selectç±»ä¼¼ï¼Œä¸selectåœ¨æœ¬è´¨ä¸Šæ²¡æœ‰å¤šå¤§å·®åˆ«ï¼Œç®¡ç†å¤šä¸ªæè¿°ç¬¦ä¹Ÿæ˜¯è¿›è¡Œè½®è¯¢ï¼Œæ ¹æ®æè¿°ç¬¦çš„çŠ¶æ€è¿›è¡Œå¤„ç†ï¼Œä½†æ˜¯pollæ²¡æœ‰æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°é‡çš„é™åˆ¶ã€‚pollå’ŒselectåŒæ ·å­˜åœ¨ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯ï¼ŒåŒ…å«å¤§é‡æ–‡ä»¶æè¿°ç¬¦çš„æ•°ç»„è¢«æ•´ä½“å¤åˆ¶äºç”¨æˆ·æ€å’Œå†…æ ¸çš„åœ°å€ç©ºé—´ä¹‹é—´ï¼Œè€Œä¸è®ºè¿™äº›æ–‡ä»¶æè¿°ç¬¦æ˜¯å¦å°±ç»ªï¼Œå®ƒçš„å¼€é”€éšç€æ–‡ä»¶æè¿°ç¬¦æ•°é‡çš„å¢åŠ è€Œçº¿æ€§å¢å¤§ã€‚\nç›¸å…³çš„å‡½æ•°ï¼š\n1 2  #include \u0026lt;poll.h\u0026gt;int poll(struct pollfd fds[], nfds_t nfds, int timeout)ï¼›   å‚æ•°æè¿°ï¼š\n è¯¥poll()å‡½æ•°è¿”å›fdsé›†åˆä¸­å°±ç»ªçš„è¯»ã€å†™ï¼Œæˆ–å‡ºé”™çš„æè¿°ç¬¦æ•°é‡ï¼Œè¿”å›0è¡¨ç¤ºè¶…æ—¶ï¼Œè¿”å›-1è¡¨ç¤ºå‡ºé”™ï¼› fdsæ˜¯ä¸€ä¸ªstruct pollfdç±»å‹çš„æ•°ç»„ï¼Œç”¨äºå­˜æ”¾éœ€è¦æ£€æµ‹å…¶çŠ¶æ€çš„socketæè¿°ç¬¦ï¼Œå¹¶ä¸”è°ƒç”¨pollå‡½æ•°ä¹‹åfdsæ•°ç»„ä¸ä¼šè¢«æ¸…ç©ºï¼› nfdsï¼šè®°å½•æ•°ç»„fdsä¸­æè¿°ç¬¦çš„æ€»æ•°é‡ï¼› timeoutï¼šè°ƒç”¨pollå‡½æ•°é˜»å¡çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼›  å…¶ä¸­pollfdç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š\n1 2 3 4 5  typedef struct pollfd { int fd; /* éœ€è¦è¢«æ£€æµ‹æˆ–é€‰æ‹©çš„æ–‡ä»¶æè¿°ç¬¦*/ short events; /* å¯¹æ–‡ä»¶æè¿°ç¬¦fdä¸Šæ„Ÿå…´è¶£çš„äº‹ä»¶ */ short revents; /* æ–‡ä»¶æè¿°ç¬¦fdä¸Šå½“å‰å®é™…å‘ç”Ÿçš„äº‹ä»¶*/ } pollfd_t;   ä¸€ä¸ªpollfdç»“æ„ä½“è¡¨ç¤ºä¸€ä¸ªè¢«ç›‘è§†çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡ä¼ é€’fds[]æŒ‡ç¤º poll() ç›‘è§†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå…¶ä¸­ï¼š\n ç»“æ„ä½“çš„eventsåŸŸæ˜¯ç›‘è§†è¯¥æ–‡ä»¶æè¿°ç¬¦çš„äº‹ä»¶æ©ç ï¼Œç”±ç”¨æˆ·æ¥è®¾ç½®è¿™ä¸ªåŸŸã€‚ ç»“æ„ä½“çš„reventsåŸŸæ˜¯æ–‡ä»¶æè¿°ç¬¦çš„æ“ä½œç»“æœäº‹ä»¶æ©ç ï¼Œå†…æ ¸åœ¨è°ƒç”¨è¿”å›æ—¶è®¾ç½®è¿™ä¸ªåŸŸã€‚  eventsåŸŸä¸­è¯·æ±‚çš„ä»»ä½•äº‹ä»¶éƒ½å¯èƒ½åœ¨reventsåŸŸä¸­è¿”å›ã€‚åˆæ³•çš„äº‹ä»¶å¦‚ä¸‹ï¼š\n   å¸¸é‡ è¯´æ˜     POLLIN æ™®é€šæˆ–ä¼˜å…ˆçº§å¸¦æ•°æ®å¯è¯»   POLLRDNORM æ™®é€šæ•°æ®å¯è¯»   POLLRDBAND ä¼˜å…ˆçº§å¸¦æ•°æ®å¯è¯»   POLLPRI é«˜ä¼˜å…ˆçº§æ•°æ®å¯è¯»   POLLOUT æ™®é€šæ•°æ®å¯å†™   POLLWRNORM æ™®é€šæ•°æ®å¯å†™   POLLWRBAND ä¼˜å…ˆçº§å¸¦æ•°æ®å¯å†™   POLLERR å‘ç”Ÿé”™è¯¯   POLLHUP å‘ç”ŸæŒ‚èµ·   POLLNVAL æè¿°å­—ä¸æ˜¯ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶    å½“éœ€è¦ç›‘å¬å¤šä¸ªäº‹ä»¶æ—¶ï¼Œä½¿ç”¨POLLIN | POLLRDNORMè®¾ç½® events åŸŸï¼›å½“pollè°ƒç”¨ä¹‹åæ£€æµ‹æŸäº‹ä»¶æ˜¯å¦å°±ç»ªæ—¶ï¼Œfds[i].revents \u0026amp; POLLINè¿›è¡Œåˆ¤æ–­ã€‚\nPollä¾‹å­ æœåŠ¡å™¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213  #include \u0026lt;netinet/in.h\u0026gt; // sockaddr_in#include \u0026lt;sys/types.h\u0026gt; // socket#include \u0026lt;sys/socket.h\u0026gt; // socket#include \u0026lt;arpa/inet.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;#include \u0026lt;poll.h\u0026gt; // poll#include \u0026lt;sys/ioctl.h\u0026gt;#include \u0026lt;sys/time.h\u0026gt;#include \u0026lt;iostream\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;string\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; #define BUFFER_SIZE 1024#define MAX_FD 1000 struct PACKET_HEAD { int length; }; class Server { private: struct sockaddr_in server_addr; socklen_t server_addr_len; int listen_fd; // ç›‘å¬çš„fd  struct pollfd fds[MAX_FD]; // fdæ•°ç»„ï¼Œå¤§å°ä¸º1000  int nfds; public: Server(int port); ~Server(); void Bind(); void Listen(int queue_len = 20); void Accept(); void Run(); void Recv(); }; Server::Server(int port) { bzero(\u0026amp;server_addr, sizeof(server_addr)); server_addr.sin_family = AF_INET; server_addr.sin_addr.s_addr = htons(INADDR_ANY); server_addr.sin_port = htons(port); // create socket to listen  listen_fd = socket(PF_INET, SOCK_STREAM, 0); if (listen_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Create Socket Failed!\u0026#34;; exit(1); } int opt = 1; setsockopt(listen_fd, SOL_SOCKET, SO_REUSEADDR, \u0026amp;opt, sizeof(opt)); } Server::~Server() { for (int i = 0; i \u0026lt; MAX_FD; ++i) { if (fds[i].fd \u0026gt;= 0) { close(fds[i].fd); } } } void Server::Bind() { if (-1 == (bind(listen_fd, (struct sockaddr *)\u0026amp;server_addr, sizeof(server_addr)))) { cout \u0026lt;\u0026lt; \u0026#34;Server Bind Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Bind Successfully.\\n\u0026#34;; } void Server::Listen(int queue_len) { if (-1 == listen(listen_fd, queue_len)) { cout \u0026lt;\u0026lt; \u0026#34;Server Listen Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Listen Successfully.\\n\u0026#34;; } void Server::Accept() { struct sockaddr_in client_addr; socklen_t client_addr_len = sizeof(client_addr); int new_fd = accept(listen_fd, (struct sockaddr *)\u0026amp;client_addr, \u0026amp;client_addr_len); if (new_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Server Accept Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;new connection was accepted.\\n\u0026#34;; // å°†æ–°å»ºç«‹çš„è¿æ¥çš„fdåŠ å…¥fds[]  int i; for (i = 1; i \u0026lt; MAX_FD; ++i) { if (fds[i].fd \u0026lt; 0) { fds[i].fd = new_fd; break; } } // è¶…è¿‡æœ€å¤§è¿æ¥æ•°  if (i == MAX_FD) { cout \u0026lt;\u0026lt; \u0026#34;Too many clients.\\n\u0026#34;; exit(1); } fds[i].events = POLLIN; // è®¾ç½®æ–°æè¿°ç¬¦çš„è¯»äº‹ä»¶  nfds = i \u0026gt; nfds ? i : nfds; // æ›´æ–°è¿æ¥æ•° } void Server::Run() { fds[0].fd = listen_fd; // æ·»åŠ ç›‘å¬æè¿°ç¬¦  fds[0].events = POLLIN; nfds = 0; for (int i = 1; i \u0026lt; MAX_FD; ++i) fds[i].fd = -1; while (1) { int nums = poll(fds, nfds + 1, -1); if (nums \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;poll() error!\u0026#34;; exit(1); } if (nums == 0) { continue; } if (fds[0].revents \u0026amp; POLLIN) Accept(); // æœ‰æ–°çš„å®¢æˆ·ç«¯è¯·æ±‚  else Recv(); } } void Server::Recv() { for (int i = 1; i \u0026lt; MAX_FD; ++i) { if (fds[i].fd \u0026lt; 0) continue; if (fds[i].revents \u0026amp; POLLIN) // è¯»å°±ç»ª  { int fd = fds[i].fd; bool close_conn = false; // æ ‡è®°å½“å‰è¿æ¥æ˜¯å¦æ–­å¼€äº†  PACKET_HEAD head; recv(fd, \u0026amp;head, sizeof(head), 0); // å…ˆæ¥å—åŒ…å¤´ï¼Œå³æ•°æ®æ€»é•¿åº¦  char *buffer = new char[head.length]; bzero(buffer, head.length); int total = 0; while (total \u0026lt; head.length) { int len = recv(fd, buffer + total, head.length - total, 0); if (len \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;recv() error!\u0026#34;; close_conn = true; break; } total = total + len; } if (total == head.length) // å°†æ”¶åˆ°çš„æ¶ˆæ¯åŸæ ·å‘å›ç»™å®¢æˆ·ç«¯  { int ret1 = send(fd, \u0026amp;head, sizeof(head), 0); int ret2 = send(fd, buffer, head.length, 0); if (ret1 \u0026lt; 0 || ret2 \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;send() error!\u0026#34;; close_conn = true; } } delete buffer; if (close_conn) // å½“å‰è¿™ä¸ªè¿æ¥æœ‰é—®é¢˜ï¼Œå…³é—­å®ƒ  { close(fd); fds[i].fd = -1; } } } } int main() { Server server(15000); server.Bind(); server.Listen(); server.Run(); return 0; }   å®¢æˆ·ç«¯\næ ¸Selectå®¢æˆ·ç«¯ä¸€æ ·\nEpoll epollå¯ä»¥ç†è§£ä¸ºevent poll(åŸºäºäº‹ä»¶çš„è½®è¯¢)ã€‚\nä½¿ç”¨åœºåˆï¼š   å½“å®¢æˆ·å¤„ç†å¤šä¸ªæè¿°ç¬¦æ—¶ï¼ˆä¸€èˆ¬æ˜¯äº¤äº’å¼è¾“å…¥å’Œç½‘ç»œå¥—æ¥å£ï¼‰ï¼Œå¿…é¡»ä½¿ç”¨I/Oå¤ç”¨ã€‚\n  å½“ä¸€ä¸ªå®¢æˆ·åŒæ—¶å¤„ç†å¤šä¸ªå¥—æ¥å£æ—¶ï¼Œè€Œè¿™ç§æƒ…å†µæ˜¯å¯èƒ½çš„ï¼Œä½†å¾ˆå°‘å‡ºç°ã€‚\n  å¦‚æœä¸€ä¸ªTCPæœåŠ¡å™¨æ—¢è¦å¤„ç†ç›‘å¬å¥—æ¥å£ï¼Œåˆè¦å¤„ç†å·²è¿æ¥å¥—æ¥å£ï¼Œä¸€èˆ¬ä¹Ÿè¦ç”¨åˆ°I/Oå¤ç”¨ã€‚\n  å¦‚æœä¸€ä¸ªæœåŠ¡å™¨å³è¦å¤„ç†TCPï¼Œåˆè¦å¤„ç†UDPï¼Œä¸€èˆ¬è¦ä½¿ç”¨I/Oå¤ç”¨ã€‚\n  å¦‚æœä¸€ä¸ªæœåŠ¡å™¨è¦å¤„ç†å¤šä¸ªæœåŠ¡æˆ–å¤šä¸ªåè®®ï¼Œä¸€èˆ¬è¦ä½¿ç”¨I/Oå¤ç”¨ã€‚\n   I/Oå¤šè·¯å¤ç”¨æœ‰å¾ˆå¤šç§å®ç°ã€‚åœ¨linuxä¸Šï¼Œ2.4å†…æ ¸å‰ä¸»è¦æ˜¯selectå’Œpollï¼Œè‡ªLinux 2.6å†…æ ¸æ­£å¼å¼•å…¥epollä»¥æ¥ï¼Œepollå·²ç»æˆä¸ºäº†ç›®å‰å®ç°é«˜æ€§èƒ½ç½‘ç»œæœåŠ¡å™¨çš„å¿…å¤‡æŠ€æœ¯ã€‚å°½ç®¡ä»–ä»¬çš„ä½¿ç”¨æ–¹æ³•ä¸å°½ç›¸åŒï¼Œä½†æ˜¯æœ¬è´¨ä¸Šå´æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚\n EpollåŸç† ä¸åŒäºselect/pollï¼ŒEpollæ­£æ˜¯ä¿å­˜äº†é‚£äº›æ”¶åˆ°æ•°æ®çš„Socketåˆ°ä¸€ä¸ªåŒå‘é“¾è¡¨ä¸­ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±å°‘äº†ä¸€æ¬¡éå†ã€‚epoll = å‡å°‘éå† + ä¿å­˜å°±ç»ªSocket\n å‡å°‘éå†  å°†æ§åˆ¶ä¸é˜»å¡åˆ†ç¦»ã€‚\nä¿å­˜å°±ç»ªSocket  ç»´æŠ¤ä¸€ä¸ªrdlistä»¥åŠrb_treeï¼Œç±»ä¼¼äºåŒå‘é“¾è¡¨æ“ä½œã€‚\né€šè¿‡ epoll_ctl æ·»åŠ  Sock1ã€Sock2 å’Œ Sock3 çš„ç›‘è§†ï¼Œå†…æ ¸ä¼šå°† eventpollçš„å¼•ç”¨ æ·»åŠ åˆ°è¿™ä¸‰ä¸ª Socket çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚\nepoll åœ¨ Linux å†…æ ¸ä¸­ç”³è¯·äº†ä¸€ä¸ªç®€æ˜“çš„æ–‡ä»¶ç³»ç»Ÿï¼Œç”¨äºå­˜å‚¨ç›¸å…³çš„å¯¹è±¡ï¼Œæ¯ä¸€ä¸ª epoll å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ eventpoll ç»“æ„ä½“ï¼Œè¿™ä¸ªç»“æ„ä½“ä¼šåœ¨å†…æ ¸ç©ºé—´ä¸­åˆ›é€ ç‹¬ç«‹çš„å†…å­˜ï¼Œç”¨äºå­˜å‚¨ä½¿ç”¨epoll_ctl æ–¹æ³•å‘ epoll å¯¹è±¡ä¸­æ·»åŠ è¿›æ¥çš„äº‹ä»¶ã€‚è¿™äº›äº‹ä»¶éƒ½ä¼šæŒ‚åˆ° rbr çº¢é»‘æ ‘ä¸­ï¼Œè¿™æ ·ï¼Œé‡å¤æ·»åŠ çš„äº‹ä»¶å°±å¯ä»¥é€šè¿‡çº¢é»‘æ ‘è€Œé«˜æ•ˆåœ°è¯†åˆ«å‡ºæ¥ã€‚\nepollåº•å±‚å®ç°æœ€é‡è¦çš„ä¸¤ä¸ªæ•°æ®ç»“æ„:epitemå’Œeventpollã€‚å¯ä»¥ç®€å•çš„è®¤ä¸ºepitemæ˜¯å’Œæ¯ä¸ªç”¨æˆ·æ€ç›‘æ§IOçš„fdå¯¹åº”çš„,eventpollæ˜¯ç”¨æˆ·æ€åˆ›å»ºçš„ç®¡ç†æ‰€æœ‰è¢«ç›‘æ§fdçš„ç»“æ„ï¼Œè¯¦ç»†çš„å®šä¹‰å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  struct epitem { struct rb_node rbn; struct list_head rdllink; struct epitem *next; struct epoll_filefd ffd; int nwait; struct list_head pwqlist; struct eventpoll *ep; struct list_head fllink; struct epoll_event event; }; struct eventpoll { spin_lock_t lock; struct mutex mtx; wait_queue_head_t wq; wait_queue_head_t poll_wait; struct list_head rdllist; //å°±ç»ªé“¾è¡¨  struct rb_root rbr; //çº¢é»‘æ ‘æ ¹èŠ‚ç‚¹  struct epitem *ovflist; };   epollè¿‡ç¨‹\nè°ƒç”¨epoll_createï¼Œå†…æ ¸ä¼šåˆ›å»ºä¸€ä¸ªeventpollå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯ç¨‹åºä¸­epfdæ‰€ä»£è¡¨çš„å¯¹è±¡ï¼‰ã€‚eventpollå¯¹è±¡ä¹Ÿæ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€å‘˜ï¼Œå’Œsocketä¸€æ ·ï¼Œå®ƒä¹Ÿä¼šæœ‰ç­‰å¾…é˜Ÿåˆ—ã€‚\né€šè¿‡ epoll_ctl æ·»åŠ  Sock1ã€Sock2 å’Œ Sock3 çš„ç›‘è§†ï¼Œå†…æ ¸ä¼šå°† eventpollçš„å¼•ç”¨ æ·»åŠ åˆ°è¿™ä¸‰ä¸ª Socket çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚\nå½“Socketæ”¶åˆ°æ•°æ®ä¹‹åï¼Œä¸­æ–­ç¨‹åºä¼šæ‰§è¡Œå°†Socketçš„å¼•ç”¨æ·»åŠ åˆ°eventpollå¯¹è±¡çš„rdlistå°±ç»ªåˆ—è¡¨ä¸­ã€‚\nå‡è®¾è®¡ç®—æœºä¸­æ­£åœ¨è¿è¡Œè¿›ç¨‹ A å’Œè¿›ç¨‹ Bã€Cï¼Œåœ¨æŸæ—¶åˆ»è¿›ç¨‹ A è¿è¡Œåˆ°äº† epoll_wait è¯­å¥ï¼Œä¼šå°†è¿›ç¨‹Aæ·»åŠ åˆ°eventpollçš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚\nå½“ Socket æ¥æ”¶åˆ°æ•°æ®ï¼Œä¸­æ–­ç¨‹åºä¸€æ–¹é¢ä¿®æ”¹ Rdlistï¼Œå¦ä¸€æ–¹é¢å”¤é†’ eventpoll ç­‰å¾…é˜Ÿåˆ—ä¸­çš„è¿›ç¨‹ï¼Œè¿›ç¨‹ A å†æ¬¡è¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚å› ä¸ºSoketåŒ…å«eventpollå¯¹è±¡çš„å¼•ç”¨ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ“ä½œeventpollå¯¹è±¡.\nepoll API\nepollçš„apiå®šä¹‰:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  //ç”¨æˆ·æ•°æ®è½½ä½“ typedef union epoll_data { void *ptr; int fd; uint32_t u32; uint64_t u64; } epoll_data_t; //fdè£…è½½å…¥å†…æ ¸çš„è½½ä½“  struct epoll_event { uint32_t events; /* Epoll events */ epoll_data_t data; /* User data variable */ }; //ä¸‰æ¿æ–§api int epoll_create(int size); int epoll_ctl(int epfd, int op, int fd, struct epoll_event *event); int epoll_wait(int epfd, struct epoll_event *events, int maxevents, int timeout);    poll_createæ˜¯åœ¨å†…æ ¸åŒºåˆ›å»ºä¸€ä¸ªepollç›¸å…³çš„ä¸€äº›åˆ—ç»“æ„ï¼Œå¹¶ä¸”å°†ä¸€ä¸ªå¥æŸ„fdè¿”å›ç»™ç”¨æˆ·æ€ï¼Œåç»­çš„æ“ä½œéƒ½æ˜¯åŸºäºæ­¤fdçš„ï¼Œå‚æ•°sizeæ˜¯å‘Šè¯‰å†…æ ¸è¿™ä¸ªç»“æ„çš„å…ƒç´ çš„å¤§å°ï¼Œç±»ä¼¼äºstlçš„vectoråŠ¨æ€æ•°ç»„ï¼Œå¦‚æœsizeä¸åˆé€‚ä¼šæ¶‰åŠå¤åˆ¶æ‰©å®¹ï¼Œä¸è¿‡è²Œä¼¼4.1.2å†…æ ¸ä¹‹åsizeå·²ç»æ²¡æœ‰å¤ªå¤§ç”¨é€”äº†ï¼› epoll_ctlæ˜¯å°†fdæ·»åŠ /åˆ é™¤äºepoll_createè¿”å›çš„epfdä¸­ï¼Œå…¶ä¸­epoll_eventæ˜¯ç”¨æˆ·æ€å’Œå†…æ ¸æ€äº¤äº’çš„ç»“æ„ï¼Œå®šä¹‰äº†ç”¨æˆ·æ€å…³å¿ƒçš„äº‹ä»¶ç±»å‹å’Œè§¦å‘æ—¶æ•°æ®çš„è½½ä½“epoll_dataï¼› epoll_wait*æ˜¯é˜»å¡ç­‰å¾…å†…æ ¸è¿”å›çš„å¯è¯»å†™äº‹ä»¶ï¼Œepfdè¿˜æ˜¯epoll_createçš„è¿”å›å€¼ï¼Œeventsæ˜¯ä¸ªç»“æ„ä½“æ•°ç»„æŒ‡é’ˆå­˜å‚¨epoll_eventï¼Œä¹Ÿå°±æ˜¯å°†å†…æ ¸è¿”å›çš„å¾…å¤„ç†epoll_eventç»“æ„éƒ½å­˜å‚¨ä¸‹æ¥ï¼Œmaxeventså‘Šè¯‰å†…æ ¸æœ¬æ¬¡è¿”å›çš„æœ€å¤§fdæ•°é‡ï¼Œè¿™ä¸ªå’ŒeventsæŒ‡å‘çš„æ•°ç»„æ˜¯ç›¸å…³çš„ï¼› epoll_waitæ˜¯ç”¨æˆ·æ€éœ€ç›‘æ§fdçš„ä»£è¨€äººï¼Œåç»­ç”¨æˆ·ç¨‹åºå¯¹fdçš„æ“ä½œéƒ½æ˜¯åŸºäºæ­¤ç»“æ„çš„ï¼›  epollä¾‹å­ æœåŠ¡ç«¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194  #include \u0026lt;netinet/in.h\u0026gt; // sockaddr_in#include \u0026lt;sys/types.h\u0026gt; // socket#include \u0026lt;sys/socket.h\u0026gt; // socket#include \u0026lt;arpa/inet.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;#include \u0026lt;sys/epoll.h\u0026gt; // epoll#include \u0026lt;sys/ioctl.h\u0026gt;#include \u0026lt;sys/time.h\u0026gt;#include \u0026lt;iostream\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;string\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; #define BUFFER_SIZE 1024#define EPOLLSIZE 100 struct PACKET_HEAD { int length; }; class Server { private: struct sockaddr_in server_addr; socklen_t server_addr_len; int listen_fd; // ç›‘å¬çš„fd  int epfd; // epoll fd  struct epoll_event events[EPOLLSIZE]; // epoll_waitè¿”å›çš„å°±ç»ªäº‹ä»¶ public: Server(int port); ~Server(); void Bind(); void Listen(int queue_len = 20); void Accept(); void Run(); void Recv(int fd); }; Server::Server(int port) { bzero(\u0026amp;server_addr, sizeof(server_addr)); server_addr.sin_family = AF_INET; server_addr.sin_addr.s_addr = htons(INADDR_ANY); server_addr.sin_port = htons(port); // create socket to listen  listen_fd = socket(PF_INET, SOCK_STREAM, 0); if (listen_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Create Socket Failed!\u0026#34;; exit(1); } int opt = 1; setsockopt(listen_fd, SOL_SOCKET, SO_REUSEADDR, \u0026amp;opt, sizeof(opt)); } Server::~Server() { close(epfd); } void Server::Bind() { if (-1 == (bind(listen_fd, (struct sockaddr *)\u0026amp;server_addr, sizeof(server_addr)))) { cout \u0026lt;\u0026lt; \u0026#34;Server Bind Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Bind Successfully.\\n\u0026#34;; } void Server::Listen(int queue_len) { if (-1 == listen(listen_fd, queue_len)) { cout \u0026lt;\u0026lt; \u0026#34;Server Listen Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Listen Successfully.\\n\u0026#34;; } void Server::Accept() { struct sockaddr_in client_addr; socklen_t client_addr_len = sizeof(client_addr); int new_fd = accept(listen_fd, (struct sockaddr *)\u0026amp;client_addr, \u0026amp;client_addr_len); if (new_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Server Accept Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;new connection was accepted.\\n\u0026#34;; // åœ¨epfdä¸­æ³¨å†Œæ–°å»ºç«‹çš„è¿æ¥  struct epoll_event event; event.data.fd = new_fd; event.events = EPOLLIN; epoll_ctl(epfd, EPOLL_CTL_ADD, new_fd, \u0026amp;event); } void Server::Run() { epfd = epoll_create(1); // åˆ›å»ºepollå¥æŸ„  struct epoll_event event; event.data.fd = listen_fd; event.events = EPOLLIN; epoll_ctl(epfd, EPOLL_CTL_ADD, listen_fd, \u0026amp;event); // æ³¨å†Œlisten_fd  while (1) { int nums = epoll_wait(epfd, events, EPOLLSIZE, -1); if (nums \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;poll() error!\u0026#34;; exit(1); } if (nums == 0) { continue; } for (int i = 0; i \u0026lt; nums; ++i) // éå†æ‰€æœ‰å°±ç»ªäº‹ä»¶  { int fd = events[i].data.fd; if ((fd == listen_fd) \u0026amp;\u0026amp; (events[i].events \u0026amp; EPOLLIN)) Accept(); // æœ‰æ–°çš„å®¢æˆ·ç«¯è¯·æ±‚  else if (events[i].events \u0026amp; EPOLLIN) Recv(fd); // è¯»æ•°æ®  else ; } } } void Server::Recv(int fd) { bool close_conn = false; // æ ‡è®°å½“å‰è¿æ¥æ˜¯å¦æ–­å¼€äº†  PACKET_HEAD head; recv(fd, \u0026amp;head, sizeof(head), 0); // å…ˆæ¥å—åŒ…å¤´ï¼Œå³æ•°æ®æ€»é•¿åº¦  char *buffer = new char[head.length]; bzero(buffer, head.length); int total = 0; while (total \u0026lt; head.length) { int len = recv(fd, buffer + total, head.length - total, 0); if (len \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;recv() error!\u0026#34;; close_conn = true; break; } total = total + len; } if (total == head.length) // å°†æ”¶åˆ°çš„æ¶ˆæ¯åŸæ ·å‘å›ç»™å®¢æˆ·ç«¯  { int ret1 = send(fd, \u0026amp;head, sizeof(head), 0); int ret2 = send(fd, buffer, head.length, 0); if (ret1 \u0026lt; 0 || ret2 \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;send() error!\u0026#34;; close_conn = true; } } delete buffer; if (close_conn) // å½“å‰è¿™ä¸ªè¿æ¥æœ‰é—®é¢˜ï¼Œå…³é—­å®ƒ  { close(fd); struct epoll_event event; event.data.fd = fd; event.events = EPOLLIN; epoll_ctl(epfd, EPOLL_CTL_DEL, fd, \u0026amp;event); // Deleteä¸€ä¸ªfd  } } int main() { Server server(15000); server.Bind(); server.Listen(); server.Run(); return 0; }   æ€»ç»“ï¼š\næ¯æ¬¡è°ƒç”¨poll/selectç³»ç»Ÿè°ƒç”¨ï¼Œæ“ä½œç³»ç»Ÿéƒ½è¦æŠŠcurrentï¼ˆå½“å‰è¿›ç¨‹ï¼‰æŒ‚åˆ°fdå¯¹åº”çš„æ‰€æœ‰è®¾å¤‡çš„ç­‰å¾…é˜Ÿåˆ—ä¸Šï¼Œå¯ä»¥æƒ³è±¡ï¼Œfdå¤šåˆ°ä¸Šåƒçš„æ—¶å€™ï¼Œè¿™æ ·â€œæŒ‚â€æ³•å¾ˆè´¹äº‹ï¼›è€Œæ¯æ¬¡è°ƒç”¨epoll_waitåˆ™æ²¡æœ‰è¿™ä¹ˆç½—å—¦ï¼Œepollåªåœ¨epoll_ctlæ—¶æŠŠcurrentæŒ‚ä¸€éï¼ˆè¿™ç¬¬ä¸€éæ˜¯å…ä¸äº†çš„ï¼‰å¹¶ç»™æ¯ä¸ªfdä¸€ä¸ªå‘½ä»¤â€œå¥½äº†å°±è°ƒå›è°ƒå‡½æ•°â€ï¼Œå¦‚æœè®¾å¤‡æœ‰äº‹ä»¶äº†ï¼Œé€šè¿‡å›è°ƒå‡½æ•°ï¼Œä¼šæŠŠfdæ”¾å…¥rdllistï¼Œè€Œæ¯æ¬¡è°ƒç”¨epoll_waitå°±åªæ˜¯æ”¶é›†rdllisté‡Œçš„fdå°±å¯ä»¥äº†â€”â€”epollå·§å¦™çš„åˆ©ç”¨å›è°ƒå‡½æ•°ï¼Œå®ç°äº†æ›´é«˜æ•ˆçš„äº‹ä»¶é©±åŠ¨æ¨¡å‹ã€‚\nepollå·¥ä½œæ¨¡å¼ LTæ¨¡å¼ LT(level triggered)æ˜¯ç¼ºçœçš„å·¥ä½œæ–¹å¼ï¼Œå¹¶ä¸”åŒæ—¶æ”¯æŒblockå’Œno-block socketã€‚åœ¨è¿™ç§åšæ³•ä¸­ï¼Œå†…æ ¸å‘Šè¯‰ä½ ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦æ˜¯å¦å°±ç»ªäº†ï¼Œç„¶åä½ å¯ä»¥å¯¹è¿™ä¸ªå°±ç»ªçš„fdè¿›è¡ŒIOæ“ä½œã€‚å¦‚æœä½ ä¸ä½œä»»ä½•æ“ä½œï¼Œå†…æ ¸è¿˜æ˜¯ä¼šç»§ç»­é€šçŸ¥ä½ çš„ï¼Œæ‰€ä»¥ï¼Œè¿™ç§æ¨¡å¼ç¼–ç¨‹å‡ºé”™è¯¯å¯èƒ½æ€§è¦å°ä¸€ç‚¹ã€‚ä¼ ç»Ÿçš„select/polléƒ½æ˜¯è¿™ç§æ¨¡å‹çš„ä»£è¡¨ã€‚\nETæ¨¡å¼ ET (edge-triggered) æ˜¯é«˜é€Ÿå·¥ä½œæ–¹å¼ï¼Œåªæ”¯æŒno-block socket(éé˜»å¡)ã€‚ åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå½“æè¿°ç¬¦ä»æœªå°±ç»ªå˜ä¸ºå°±ç»ªæ—¶ï¼Œå†…æ ¸å°±é€šè¿‡epollå‘Šè¯‰ä½ ï¼Œç„¶åå®ƒä¼šå‡è®¾ä½ çŸ¥é“æ–‡ä»¶æè¿°ç¬¦å·²ç»å°±ç»ªï¼Œå¹¶ä¸”ä¸ä¼šå†ä¸ºé‚£ä¸ªæ–‡ä»¶æè¿°ç¬¦å‘é€æ›´å¤šçš„ å°±ç»ªé€šçŸ¥ï¼Œç›´åˆ°ä½ åšäº†æŸäº›æ“ä½œè€Œå¯¼è‡´é‚£ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¸å†æ˜¯å°±ç»ªçŠ¶æ€(æ¯”å¦‚ ä½ åœ¨å‘é€ï¼Œæ¥æ”¶æˆ–æ˜¯æ¥å—è¯·æ±‚ï¼Œæˆ–è€…å‘é€æ¥æ”¶çš„æ•°æ®å°‘äºä¸€å®šé‡æ—¶å¯¼è‡´äº†ä¸€ä¸ªEWOULDBLOCK é”™è¯¯)ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼Œå¦‚æœä¸€ç›´ä¸å¯¹è¿™ä¸ªfdä½œIOæ“ä½œ(ä»è€Œå¯¼è‡´å®ƒå†æ¬¡å˜æˆæœªå°±ç»ª)ï¼Œå†…æ ¸å°±ä¸ä¼šå‘é€æ›´å¤šçš„é€šçŸ¥(only once)ã€‚ä¸è¿‡åœ¨TCPåè®®ä¸­ï¼ŒETæ¨¡å¼çš„åŠ é€Ÿæ•ˆç”¨ä»éœ€è¦æ›´å¤šçš„benchmarkç¡®è®¤ã€‚\nå‚è€ƒï¼š\n IOå¤šè·¯å¤ç”¨ä¹‹selectæ€»ç»“ IOå¤šè·¯å¤ç”¨ä¹‹pollæ€»ç»“ IOå¤šè·¯å¤ç”¨ä¹‹epollæ€»ç»“ Linux IOæ¨¡å¼åŠ selectã€pollã€epollè¯¦è§£ selectè¯¦è§£ Linuxä¸‹çš„I/Oå¤ç”¨ä¸epollè¯¦è§£ èŠèŠåŒæ­¥ã€å¼‚æ­¥ã€é˜»å¡ä¸éé˜»å¡ èŠèŠLinux äº”ç§IOæ¨¡å‹ èŠèŠIOå¤šè·¯å¤ç”¨ä¹‹selectã€pollã€epollè¯¦è§£ Linux IOæ¨¡å¼åŠ selectã€pollã€epollè¯¦è§£ å½»åº•å­¦ä¼šä½¿ç”¨epoll(ä¸€)â€”â€”ETæ¨¡å¼å®ç°åˆ†æ epoll æˆ–è€… kqueue çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ epolläº‹ä»¶å¤„ç†æœºåˆ¶è¯¦è§£ å¦‚æœè¿™ç¯‡æ–‡ç« è¯´ä¸æ¸…epollçš„æœ¬è´¨ï¼Œé‚£å°±è¿‡æ¥ææ­»æˆ‘å§ selectã€pollã€epollæ•´ç†æ€»ç»“  ","description":"æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¤šè·¯å¤ç”¨ä¸­çš„ä¸‰ç§æ¨¡å‹ï¼Œå®ƒä»¬æ˜¯è¿­ä»£æ›´æ–°çš„ç»“æœã€‚ç°åœ¨å¸¸ç”¨çš„ä¼šæ˜¯Epollã€‚","id":62,"section":"posts","tags":["Epoll","Select","Poll"],"title":"Select Poll Epoll è¯¦è§£","uri":"https://hugo.jiahongw.com/zh/posts/linux/select-poll-epoll/"},{"content":"è™šæ‹Ÿå­˜å‚¨å™¨ä½œä¸ºç°ä»£æ“ä½œç³»ç»Ÿä¸­å­˜å‚¨å™¨ç®¡ç†çš„ä¸€é¡¹é‡è¦æŠ€æœ¯ï¼Œå®ç°äº†å†…å­˜æ‰©å……åŠŸèƒ½ã€‚**ä½†è¯¥åŠŸèƒ½å¹¶éæ˜¯ä»ç‰©ç†ä¸Šå®é™…åœ°æ‰©å¤§å†…å­˜çš„å®¹é‡ï¼Œè€Œæ˜¯ä»é€»è¾‘ä¸Šå®ç°å¯¹å†…å­˜å®¹é‡çš„æ‰©å……ï¼Œè®©ç”¨æˆ·æ‰€æ„Ÿè§‰åˆ°çš„å†…å­˜å®¹é‡æ¯”å®é™…å†…å­˜å®¹é‡å¤§å¾—å¤šã€‚**äºæ˜¯ä¾¿å¯ä»¥è®©æ¯”å†…å­˜ç©ºé—´æ›´å¤§çš„ç¨‹åºè¿è¡Œï¼Œæˆ–è€…è®©æ›´å¤šçš„ç”¨æˆ·ç¨‹åºå¹¶å‘è¿è¡Œã€‚è¿™æ ·æ—¢æ»¡è¶³äº†ç”¨æˆ·çš„éœ€è¦ï¼Œåˆæ”¹å–„äº†ç³»ç»Ÿçš„æ€§èƒ½ã€‚\nè™šæ‹Ÿå†…å­˜æ˜¯æ“ä½œç³»ç»Ÿç‰©ç†å†…å­˜å’Œè¿›ç¨‹ä¹‹é—´çš„ä¸­é—´å±‚ï¼Œå®ƒä¸ºè¿›ç¨‹éšè—äº†ç‰©ç†å†…å­˜è¿™ä¸€æ¦‚å¿µï¼Œä¸ºè¿›ç¨‹æä¾›äº†æ›´åŠ ç®€æ´å’Œæ˜“ç”¨çš„æ¥å£ä»¥åŠæ›´åŠ å¤æ‚çš„åŠŸèƒ½ã€‚\næˆ‘ä»¬å¯ä»¥å°†è™šæ‹Ÿå†…å­˜çœ‹ä½œæ˜¯åœ¨ç£ç›˜ä¸Šä¸€ç‰‡ç©ºé—´ï¼Œå½“è¿™ç‰‡ç©ºé—´ä¸­çš„ä¸€éƒ¨åˆ†è®¿é—®æ¯”è¾ƒé¢‘ç¹æ—¶ï¼Œè¯¥éƒ¨åˆ†æ•°æ®ä¼šä»¥é¡µä¸ºå•ä½è¢«ç¼“å­˜åˆ°ä¸»å­˜ä¸­ä»¥åŠ é€Ÿ CPU è®¿é—®æ•°æ®çš„æ€§\nèƒ½ï¼Œè™šæ‹Ÿå†…å­˜åˆ©ç”¨ç©ºé—´è¾ƒå¤§çš„ç£ç›˜å­˜å‚¨ä½œä¸ºã€å†…å­˜ã€å¹¶ä½¿ç”¨ä¸»å­˜å‚¨ç¼“å­˜è¿›è¡ŒåŠ é€Ÿï¼Œè®©ä¸Šå±‚è®¤ä¸ºæ“ä½œç³»ç»Ÿçš„å†…å­˜å¾ˆå¤§è€Œä¸”å¾ˆå¿«ï¼Œç„¶è€ŒåŒºåŸŸå¾ˆå¤§çš„ç£ç›˜å¹¶ä¸å¿«ï¼Œè€Œå¾ˆå¿«çš„å†…å­˜ä¹Ÿå¹¶ä¸å¤§ã€‚\nLinuxä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿå†…å­˜:\n ä¸ºåº”ç”¨ç¨‹åºæä¾›çœ‹èµ·æ¥å®¹é‡è¶³å¤Ÿå¤§ä¸”è®¿é—®è¶³å¤Ÿå¿«çš„å­˜å‚¨ã€‚ é€šè¿‡å…±äº«ä»£ç åº“ä»¥å‡å°‘ç‰©ç†å†…å­˜çš„å¼€é”€ã€‚è®©æ”¹åŠ¨å°½å¯èƒ½çš„å°‘ã€‚ é€šè¿‡åˆ†é…è¿ç»­çš„è™šæ‹Ÿå†…å­˜ï¼ˆç‰©ç†å†…å­˜ä¸Šä¸ä¸€å®šè¿ç»­ï¼‰ ç®€åŒ–å†…å­˜çš„è¿æ¥ã€åˆ†é…è¿‡ç¨‹ã€‚ é€šè¿‡ç»™å„ä¸ªè¿›ç¨‹åˆ†é…ä¸åŒçš„è™šæ‹Ÿå†…å­˜ç©ºé—´å®ç°å†…å­˜è®¿é—®ä¸Šçš„éš”ç¦»ï¼Œæä¾›äº†ä¸€å®šçš„å®‰å…¨æ€§ã€‚   æ‹“å±•ï¼š\nâ€‹\tå½“æˆ‘ä»¬åœ¨ Linux ä¸­è°ƒç”¨ fork åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œå®é™…ä¸Šåªå¤åˆ¶äº†çˆ¶è¿›ç¨‹çš„é¡µè¡¨ã€‚\n é—®é¢˜â“  å½“æœ‰ä¸€ä¸ªä½œä¸šå¾ˆå¤§ï¼Œè¶…è¿‡äº†å†…å­˜çš„æ€»å®¹é‡ï¼Œä½œä¸šä¸èƒ½å…¨éƒ¨è£…å…¥å†…å­˜æ€ä¹ˆåŠï¼Ÿ æœ‰å¤§é‡ä½œä¸šéœ€è¦è¿è¡Œï¼Œä½†æ˜¯ç”±äºå†…å­˜å®¹é‡ä¸è¶³ä»¥å®¹çº³è¿™äº›æ‰€æœ‰çš„ä½œä¸šæ€ä¹ˆåŠï¼Ÿ(å…ˆæ‰§è¡Œä¸€éƒ¨åˆ†)  è§£å†³åŠæ³•ï¼š\n å¢åŠ ç‰©ç†å†…å­˜å®¹é‡ é€»è¾‘ä¸Šæ‰©å……å†…å­˜å®¹é‡(è™šæ‹Ÿå†…å­˜æ–¹æ³•)  å±€éƒ¨æ€§åŸç†ğŸ¥‡ ç¨‹åºåœ¨æ‰§è¡Œæ—¶å°†å‘ˆç°å‡ºå±€éƒ¨æ€§è§„å¾‹ï¼Œå³åœ¨ä¸€è¾ƒçŸ­çš„æ—¶é—´å†…ï¼Œç¨‹åºçš„æ‰§è¡Œä»…å±€é™äºæŸä¸ªéƒ¨åˆ†ï¼Œç›¸åº”åœ°ï¼Œå®ƒæ‰€è®¿é—®çš„å­˜å‚¨ç©ºé—´ä¹Ÿå±€é™äºæŸä¸ªåŒºåŸŸã€‚\n æ—¶é—´å±€éƒ¨æ€§ï¼šè®¿é—®æœ€è¿‘è®¿é—®è¿‡çš„ç©ºé—´çš„å¯èƒ½æ€§è¾ƒå¤§ã€‚ ç©ºé—´å±€éƒ¨æ€§ï¼šè®¿é—®å½“å‰ç©ºé—´å‘¨å›´çš„ç©ºé—´çš„å¯èƒ½è¾ƒå¤§ã€‚   å±€éƒ¨æ€§åŸç†ä½¿å¾—è™šæ‹Ÿå­˜å‚¨æŠ€æœ¯çš„å®ç°æˆä¸ºå¯èƒ½ã€‚\n åŸºäºå±€éƒ¨æ€§åŸç†å¯çŸ¥ï¼Œåº”ç”¨ç¨‹åºåœ¨è¿è¡Œä¹‹å‰æ²¡æœ‰å¿…è¦å°†ä¹‹å…¨éƒ¨è£…å…¥å†…å­˜ï¼Œè€Œä»…é¡»å°†é‚£äº›å½“å‰è¦è¿è¡Œçš„å°‘æ•°é¡µé¢æˆ–æ®µå…ˆè£…å…¥å†…å­˜ä¾¿å¯è¿è¡Œï¼Œå…¶ä½™éƒ¨åˆ†æš‚ç•™åœ¨ç›˜ä¸Šã€‚ç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œå¦‚æœå®ƒæ‰€è¦è®¿é—®çš„é¡µ(æ®µ)å·²è°ƒå…¥å†…å­˜ï¼Œä¾¿å¯ç»§ç»­æ‰§è¡Œä¸‹å»ï¼›ä½†å¦‚æœç¨‹åºæ‰€è¦è®¿é—®çš„é¡µ(æ®µ)å°šæœªè°ƒå…¥å†…å­˜(ç§°ä¸ºç¼ºé¡µæˆ–ç¼ºæ®µ)ï¼Œä¾¿å‘å‡ºç¼ºé¡µ(æ®µ)ä¸­æ–­è¯·æ±‚ï¼Œæ­¤æ—¶ OS å°†åˆ©ç”¨è¯·æ±‚è°ƒé¡µ(æ®µ)åŠŸèƒ½å°†å®ƒä»¬è°ƒå…¥å†…å­˜ï¼Œä»¥ä½¿è¿›ç¨‹èƒ½ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚å¦‚æœæ­¤æ—¶å†…å­˜å·²æ»¡ï¼Œæ— æ³•å†è£…å…¥æ–°çš„é¡µ(æ®µ)ï¼ŒOS è¿˜é¡»å†åˆ©ç”¨é¡µ(æ®µ)çš„ç½®æ¢åŠŸèƒ½ï¼Œå°†å†…å­˜ä¸­æš‚æ—¶ä¸ç”¨çš„é¡µ(æ®µ)è°ƒè‡³ç›˜ä¸Šï¼Œè…¾å‡ºè¶³å¤Ÿçš„å†…å­˜ç©ºé—´åï¼Œå†å°†è¦è®¿é—®çš„é¡µ(æ®µ)è°ƒå…¥å†…å­˜ï¼Œä½¿ç¨‹åºç»§ç»­æ‰§è¡Œä¸‹å»ã€‚è¿™æ ·ï¼Œä¾¿å¯ä½¿ä¸€ä¸ªå¤§çš„ç”¨æˆ·ç¨‹åºåœ¨è¾ƒå°çš„å†…å­˜ç©ºé—´ä¸­è¿è¡Œï¼Œä¹Ÿå¯åœ¨å†…å­˜ä¸­åŒæ—¶è£…å…¥æ›´å¤šçš„è¿›ç¨‹ï¼Œä½¿å®ƒä»¬å¹¶å‘æ‰§è¡Œã€‚\nè™šæ‹Ÿå­˜å‚¨å™¨ğŸ“ å®šä¹‰ **æ‰€è°“è™šæ‹Ÿå­˜å‚¨å™¨ï¼Œæ˜¯æŒ‡å…·æœ‰è¯·æ±‚è°ƒå…¥åŠŸèƒ½å’Œç½®æ¢åŠŸèƒ½ï¼Œèƒ½ä»é€»è¾‘ä¸Šå¯¹å†…å­˜å®¹é‡åŠ ä»¥æ‰©å……çš„ä¸€ç§å­˜å‚¨å™¨ç³»ç»Ÿã€‚**å…¶é€»è¾‘å®¹é‡ç”±å†…å­˜å®¹é‡å’Œå¤–å­˜å®¹é‡ä¹‹å’Œæ‰€å†³å®šï¼Œå…¶è¿è¡Œé€Ÿåº¦æ¥è¿‘äºå†…å­˜é€Ÿåº¦ï¼Œè€Œæ¯ä½çš„æˆæœ¬å´åˆæ¥è¿‘äºå¤–å­˜ã€‚\n å½“ç”¨æˆ·çœ‹åˆ°è‡ªå·±çš„ç¨‹åºèƒ½åœ¨ç³»ç»Ÿä¸­æ­£å¸¸è¿è¡Œæ—¶ï¼Œä»–ä¼šè®¤ä¸ºï¼Œè¯¥ç³»ç»Ÿæ‰€å…·æœ‰çš„å†…å­˜å®¹é‡ä¸€å®šæ¯”è‡ªå·±çš„ç¨‹åºå¤§ï¼Œæˆ–è€…è¯´ï¼Œç”¨æˆ·æ‰€æ„Ÿè§‰åˆ°çš„å†…å­˜å®¹é‡ä¼šæ¯”å®é™…å†…å­˜å®¹é‡å¤§å¾—å¤šã€‚ä½†ç”¨æˆ·æ‰€çœ‹åˆ°çš„å¤§å®¹é‡åªæ˜¯ä¸€ç§é”™è§‰ï¼Œæ˜¯è™šçš„ï¼Œæ•…äººä»¬æŠŠè¿™æ ·çš„å­˜å‚¨å™¨ç§°ä¸ºè™šæ‹Ÿå­˜å‚¨å™¨ã€‚\n è™šæ‹Ÿå­˜å‚¨å™¨å¹¶éå¯ä»¥æ— é™å¤§ï¼Œå…¶å®¹é‡å—å¤–å­˜å¤§å°å’ŒæŒ‡ä»¤ä¸­åœ°å€é•¿åº¦ä¸¤æ–¹é¢çš„é™åˆ¶ã€‚\nç‰¹å¾  å¤šæ¬¡æ€§ å¯¹æ¢æ€§ è™šæ‹Ÿæ€§  å®ç°æ–¹æ³• æ‰€æœ‰çš„è™šæ‹Ÿå­˜å‚¨å™¨éƒ½æ˜¯é‡‡ç”¨ä¸‹è¿°æ–¹å¼ä¹‹ä¸€å®ç°çš„ï¼š\n è¯·æ±‚åˆ†é¡µç³»ç»Ÿ è¯·æ±‚åˆ†æ®µç³»ç»Ÿ  è¯·æ±‚åˆ†é¡µå­˜å‚¨ç®¡ç†æ–¹å¼ è¯·æ±‚åˆ†é¡µç³»ç»Ÿæ˜¯å»ºç«‹åœ¨åŸºæœ¬åˆ†é¡µåŸºç¡€ä¸Šçš„ï¼Œä¸ºäº†èƒ½æ”¯æŒè™šæ‹Ÿå­˜å‚¨å™¨åŠŸèƒ½ï¼Œè€Œå¢åŠ äº†è¯·æ±‚è°ƒé¡µåŠŸèƒ½å’Œé¡µé¢ç½®æ¢åŠŸèƒ½ã€‚ç›¸åº”åœ°ï¼Œæ¯æ¬¡è°ƒå…¥å’Œæ¢å‡ºçš„åŸºæœ¬å•ä½éƒ½æ˜¯é•¿åº¦å›ºå®šçš„é¡µé¢ï¼Œè¿™ä½¿å¾—è¯·æ±‚åˆ†é¡µç³»ç»Ÿåœ¨å®ç°ä¸Šè¦æ¯”è¯·æ±‚åˆ†æ®µç³»ç»Ÿç®€å•(åè€…åœ¨æ¢è¿›å’Œæ¢å‡ºæ—¶æ˜¯å¯å˜é•¿åº¦çš„æ®µ)ã€‚å› æ­¤ï¼Œè¯·æ±‚åˆ†é¡µä¾¿æˆä¸ºç›®å‰æœ€å¸¸ç”¨çš„ä¸€ç§å®ç°è™šæ‹Ÿå­˜å‚¨å™¨çš„æ–¹å¼ã€‚\nè¯·æ±‚é¡µè¡¨æœºåˆ¶(åŸºæœ¬åŸç†) åœ¨è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­éœ€è¦çš„ä¸»è¦æ•°æ®ç»“æ„æ˜¯è¯·æ±‚é¡µè¡¨ï¼Œå…¶åŸºæœ¬ä½œç”¨ä»ç„¶æ˜¯å°†ç”¨æˆ·åœ°å€ç©ºé—´ä¸­çš„é€»è¾‘åœ°å€æ˜ å°„ä¸ºå†…å­˜ç©ºé—´ä¸­çš„ç‰©ç†åœ°å€ã€‚ä¸ºäº†æ»¡è¶³é¡µé¢æ¢è¿›æ¢å‡ºçš„éœ€è¦ï¼Œåœ¨è¯·æ±‚é¡µè¡¨ä¸­åˆå¢åŠ äº†å››ä¸ªå­—æ®µã€‚è¿™æ ·ï¼Œåœ¨è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­çš„æ¯ä¸ªé¡µè¡¨åº”å«ä»¥ä¸‹è¯¸é¡¹(é…åˆclockç½®æ¢ç®—æ³•)ï¼š\nå­—æ®µè¯´æ˜ï¼š\n çŠ¶æ€ä½(P)ï¼šç”¨äºæŒ‡ç¤ºè¯¥é¡µæ˜¯å¦å·²è°ƒå…¥å†…å­˜ï¼Œä¾›ç¨‹åºè®¿é—®æ—¶å‚è€ƒã€‚ è®¿é—®å­—æ®µ(A)ï¼šè®°å½•æœ¬é¡µåœ¨ä¸€æ®µæ—¶é—´å†…è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæˆ–è€…è®°å½•æœ¬é¡µæœ€è¿‘å·²æœ‰å¤šä¹…æ—¶é—´æœªè¢«è®¿é—®ï¼Œä¾›ç½®æ¢ç®—æ³•åœ¨é€‰æ‹©æ¢å‡ºé¡µé¢æ—¶å‚è€ƒã€‚ ä¿®æ”¹ä½(M)ï¼šè¡¨ç¤ºè¯¥é¡µåœ¨è°ƒå…¥å†…å­˜ä¹‹åæœ‰æ²¡æœ‰è¢«ä¿®æ”¹ã€‚ä¾›ç½®æ¢é¡µé¢æ—¶å‚è€ƒã€‚æœªä¿®æ”¹åˆ™æ— éœ€å†™å…¥å¤–å­˜ã€‚ å¤–å­˜åœ°å€ï¼šç”¨äºæŒ‡å‡ºè¯¥é¡µåœ¨å¤–å­˜ä¸Šçš„åœ°å€ï¼Œé€šå¸¸æ˜¯ç‰©ç†å—å·åœ°å€ï¼Œä¾›è°ƒå…¥è¯¥é¡µæ—¶å‚è€ƒã€‚  ç¼ºé¡µä¸­æ–­æœºæ„ åœ¨è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­ï¼Œæ¯å½“æ‰€è¦è®¿é—®çš„é¡µé¢ä¸åœ¨å†…å­˜æ—¶ï¼Œä¾¿äº§ç”Ÿä¸€ç¼ºé¡µä¸­æ–­ï¼Œè¯·æ±‚ OSå°†ç¼ºçš„é¡µè°ƒå…¥å†…å­˜ã€‚\n**ç¼ºé¡µä¸­æ–­ä½œä¸ºä¸­æ–­ï¼Œå®ƒä»¬åŒæ ·éœ€è¦ç»å†è¯¸å¦‚ä¿æŠ¤ CPU ç¯å¢ƒã€åˆ†æä¸­æ–­åŸå› ã€è½¬å…¥ç¼ºé¡µä¸­æ–­å¤„ç†ç¨‹åºè¿›è¡Œå¤„ç†ï¼Œä»¥åŠåœ¨ä¸­æ–­å¤„ç†å®Œæˆåå†æ¢å¤ CPU ç¯å¢ƒç­‰å‡ ä¸ªæ­¥éª¤ã€‚**ä½†ç¼ºé¡µä¸­æ–­åˆæ˜¯ä¸€ç§ç‰¹æ®Šçš„ä¸­æ–­ï¼Œå®ƒä¸ä¸€èˆ¬çš„ä¸­æ–­ç›¸æ¯”æœ‰ç€æ˜æ˜¾çš„åŒºåˆ«ï¼Œä¸»è¦è¡¨ç°åœ¨ä¸‹é¢ä¸¤ä¸ªæ–¹é¢ï¼š\n åœ¨æŒ‡ä»¤æ‰§è¡ŒæœŸé—´äº§ç”Ÿå’Œå¤„ç†ä¸­æ–­ä¿¡å·ã€‚ ä¸€æ¡æŒ‡ä»¤åœ¨æ‰§è¡ŒæœŸé—´å¯èƒ½äº§ç”Ÿå¤šæ¬¡ç¼ºé¡µä¸­æ–­ã€‚  åœ°å€å˜æ¢æœºæ„ è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­çš„åœ°å€å˜æ¢æœºæ„æ˜¯åœ¨åˆ†é¡µç³»ç»Ÿåœ°å€å˜æ¢æœºæ„çš„åŸºç¡€ä¸Šï¼Œä¸ºå®ç°è™šæ‹Ÿå­˜å‚¨å™¨ï¼Œå†å¢åŠ äº†æŸäº›åŠŸèƒ½æ‰€å½¢æˆçš„ï¼Œå¦‚äº§ç”Ÿå’Œå¤„ç†ç¼ºé¡µä¸­æ–­ï¼Œä»¥åŠä»å†…å­˜ä¸­æ¢å‡ºä¸€é¡µçš„åŠŸèƒ½ç­‰ç­‰ã€‚ä¸‹å›¾ç¤ºå‡ºäº†è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­çš„åœ°å€å˜æ¢è¿‡ç¨‹ï¼š\nåœ¨è¿›è¡Œåœ°å€å˜æ¢æ—¶ï¼Œé¦–å…ˆæ£€ç´¢å¿«è¡¨ï¼Œè¯•å›¾ä»ä¸­æ‰¾å‡ºæ‰€è¦è®¿é—®çš„é¡µã€‚è‹¥æ‰¾åˆ°ï¼Œä¾¿ä¿®æ”¹é¡µè¡¨é¡¹ä¸­çš„è®¿é—®ä½ï¼Œä¾›ç½®æ¢ç®—æ³•é€‰æ¢å‡ºé¡µé¢æ—¶å‚è€ƒã€‚å¯¹äºå†™æŒ‡ä»¤ï¼Œè¿˜é¡»å°†ä¿®æ”¹ä½ç½®æˆâ€œ1â€,è¡¨ç¤ºè¯¥é¡µåœ¨è°ƒå…¥å†…å­˜åå·²è¢«ä¿®æ”¹ã€‚ç„¶ååˆ©ç”¨é¡µè¡¨é¡¹ä¸­ç»™å‡ºçš„ç‰©ç†å—å·å’Œé¡µå†…åœ°å€å½¢æˆç‰©ç†åœ°å€ã€‚åœ°å€å˜æ¢è¿‡ç¨‹åˆ°æ­¤ç»“æŸã€‚\nå¦‚æœåœ¨å¿«è¡¨ä¸­æœªæ‰¾åˆ°è¯¥é¡µçš„é¡µè¡¨é¡¹ï¼Œåˆ™åº”åˆ°å†…å­˜ä¸­å»æŸ¥æ‰¾é¡µè¡¨ï¼Œå†ä»æ‰¾åˆ°çš„é¡µè¡¨é¡¹ä¸­çš„çŠ¶æ€ä½ P æ¥äº†è§£è¯¥é¡µæ˜¯å¦å·²è°ƒå…¥å†…å­˜ã€‚è‹¥è¯¥é¡µå·²è°ƒå…¥å†…å­˜ï¼Œè¿™æ—¶åº”å°†è¯¥é¡µçš„é¡µè¡¨é¡¹å†™å…¥å¿«è¡¨ã€‚å½“å¿«è¡¨å·²æ»¡æ—¶ï¼Œåˆ™åº”å…ˆè°ƒå‡ºæŒ‰æŸç§ç®—æ³•æ‰€ç¡®å®šçš„é¡µçš„é¡µè¡¨é¡¹ï¼Œç„¶åå†å†™å…¥è¯¥é¡µçš„é¡µè¡¨é¡¹ï¼›è‹¥è¯¥é¡µå°šæœªè°ƒå…¥å†…å­˜ï¼Œè¿™æ—¶åº”äº§ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œè¯·æ±‚ OS ä»å¤–å­˜æŠŠè¯¥é¡µè°ƒå…¥å†…å­˜ã€‚\nè¯·æ±‚åˆ†é¡µçš„å†…å­˜åˆ†é… ä¸‰ä¸ªé—®é¢˜ï¼š\n  æœ€å°ç‰©ç†å—æ•°çš„ç¡®å®šã€‚å…ˆåˆ†é…ç»™è¿›ç¨‹å¤šå°‘ç‰©ç†ç©ºé—´å®ƒæ‰èƒ½å…ˆæ­£å¸¸è¿è¡Œã€‚\n  å†…å­˜åˆ†é…ç­–ç•¥ã€‚\n  å›ºå®šåˆ†é…å±€éƒ¨ç½®æ¢\næ‰€è°“å›ºå®šåˆ†é…ï¼Œæ˜¯æŒ‡ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€ç»„å›ºå®šæ•°ç›®çš„ç‰©ç†å—ï¼Œåœ¨è¿›ç¨‹è¿è¡ŒæœŸé—´ä¸å†æ”¹å˜ã€‚æ‰€è°“å±€éƒ¨ç½®æ¢ï¼Œæ˜¯æŒ‡å¦‚æœè¿›ç¨‹åœ¨è¿è¡Œä¸­å‘ç°ç¼ºé¡µï¼Œåˆ™åªèƒ½ä»åˆ†é…ç»™è¯¥è¿›ç¨‹çš„ n ä¸ªé¡µè€Œä¸­é€‰å‡ºä¸€é¡µæ¢å‡ºï¼Œç„¶åå†è°ƒå…¥ä¸€é¡µï¼Œä»¥ä¿è¯åˆ†é…ç»™è¯¥è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸å˜ã€‚\n  å¯å˜åˆ†é…å…¨å±€ç½®æ¢\næ‰€è°“å¯å˜åˆ†é…ï¼Œæ˜¯æŒ‡å…ˆä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€å®šæ•°ç›®çš„ç‰©ç†å—ï¼Œåœ¨è¿›ç¨‹è¿è¡ŒæœŸé—´ï¼Œå¯æ ¹æ®æƒ…å†µåšé€‚å½“çš„å¢åŠ æˆ–å‡å°‘ã€‚æ‰€è°“å…¨å±€ç½®æ¢ï¼Œæ˜¯æŒ‡å¦‚æœè¿›ç¨‹åœ¨è¿è¡Œä¸­å‘ç°ç¼ºé¡µï¼Œåˆ™å°† OS æ‰€ä¿ç•™çš„ç©ºé—²ç‰©ç†å—(ä¸€èˆ¬ç»„ç»‡ä¸ºä¸€ä¸ªç©ºé—²ç‰©ç†å—é˜Ÿåˆ—)å–å‡ºä¸€å—åˆ†é…ç»™è¯¥è¿›ç¨‹ï¼Œæˆ–è€…ä»¥æ‰€æœ‰è¿›ç¨‹çš„å…¨éƒ¨ç‰©ç†å—ä¸ºæ ‡çš„ï¼Œé€‰æ‹©ä¸€å—æ¢å‡ºï¼Œç„¶åå°†æ‰€ç¼ºä¹‹é¡µè°ƒå…¥ã€‚è¿™æ ·ï¼Œåˆ†é…ç»™è¯¥è¿›ç¨‹çš„å†…å­˜ç©ºé—´å°±éšä¹‹å¢åŠ ã€‚\n  å¯å˜åˆ†é…å±€éƒ¨ç½®æ¢\nè¯¥ç­–ç•¥åŒæ ·æ˜¯åŸºäºè¿›ç¨‹çš„ç±»å‹æˆ–æ ¹æ®ç¨‹åºå‘˜çš„è¦æ±‚ï¼Œä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€å®šæ•°ç›®çš„ç‰©ç†å—ï¼Œä½†å½“æŸè¿›ç¨‹å‘ç°ç¼ºé¡µæ—¶ï¼Œåªå…è®¸ä»è¯¥è¿›ç¨‹åœ¨å†…å­˜çš„é¡µé¢ä¸­é€‰æ‹©ä¸€é¡µæ¢å‡ºï¼Œè¿™æ ·å°±ä¸ä¼šå½±å“å…¶å®ƒè¿›ç¨‹çš„è¿è¡Œã€‚å¦‚æœè¿›ç¨‹åœ¨è¿è¡Œä¸­é¢‘ç¹åœ°å‘ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œåˆ™ç³»ç»Ÿé¡»å†ä¸ºè¯¥è¿›ç¨‹åˆ†é…è‹¥å¹²é™„åŠ çš„ç‰©ç†å—ï¼Œç›´è‡³è¯¥è¿›ç¨‹çš„ç¼ºé¡µç‡å‡å°‘åˆ°é€‚å½“ç¨‹åº¦ä¸ºæ­¢ã€‚åä¹‹ï¼Œè‹¥ä¸€ä¸ªè¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­çš„ç¼ºé¡µç‡ç‰¹åˆ«ä½ï¼Œåˆ™æ­¤æ—¶å¯é€‚å½“å‡å°‘åˆ†é…ç»™è¯¥è¿›ç¨‹çš„ç‰©ç†å—æ•°ï¼Œä½†ä¸åº”å¼•èµ·å…¶ç¼ºé¡µç‡çš„æ˜æ˜¾å¢åŠ ã€‚\n    ç‰©ç†å—åˆ†é…ç®—æ³•\n å¹³å‡åˆ†é…ç®—æ³• æ¯”ä¾‹åˆ†é…ç®—æ³• è€ƒè™‘ä¼˜å…ˆæƒçš„åˆ†é…ç®—æ³•    é¡µé¢è°ƒå…¥ç­–ç•¥ é—®é¢˜ï¼š\n  ä½•æ—¶è°ƒå…¥é¡µé¢\n é¢„è°ƒé¡µç­–ç•¥ï¼Œä¸€æ¬¡è°ƒå…¥è‹¥å¹²ä¸ªç›¸é‚»çš„é¡µé¢ã€‚ è¯·æ±‚è°ƒé¡µæœºåˆ¶ï¼Œå½“è¯·æ±‚çš„é¡µé¢ä¸å­˜åœ¨å†…å­˜ï¼Œç”±OSå°†æ‰€éœ€é¡µé¢è°ƒå…¥å†…å­˜ã€‚    ä½•å¤„è°ƒå…¥é¡µé¢\nå°†è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­çš„å¤–å­˜åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šç”¨äºå­˜æ”¾æ–‡ä»¶çš„æ–‡ä»¶åŒºå’Œç”¨äºå­˜æ”¾å¯¹æ¢é¡µè€Œçš„å¯¹æ¢åŒºã€‚é€šå¸¸ï¼Œç”±äºå¯¹æ¢åŒºæ˜¯é‡‡ç”¨è¿ç»­åˆ†é…æ–¹å¼ï¼Œè€Œæ–‡ä»¶åŒºæ˜¯é‡‡ç”¨ç¦»æ•£åˆ†é…æ–¹å¼ï¼Œæ‰€ä»¥å¯¹æ¢åŒºçš„æ•°æ®å­˜å–(ç£ç›˜ I/O)é€Ÿåº¦æ¯”æ–‡ä»¶åŒºçš„é«˜ã€‚\n ç³»ç»Ÿæ‹¥æœ‰è¶³å¤Ÿçš„å¯¹æ¢åŒºç©ºé—´ï¼Œè¿™æ—¶å¯ä»¥å…¨éƒ¨ä»å¯¹æ¢åŒºè°ƒå…¥æ‰€éœ€é¡µé¢ï¼Œä»¥æé«˜è°ƒé¡µé€Ÿåº¦ã€‚ä¸ºæ­¤ï¼Œåœ¨è¿›ç¨‹è¿è¡Œå‰ï¼Œä¾¿é¡»å°†ä¸è¯¥è¿›ç¨‹æœ‰å…³çš„æ–‡ä»¶ä»æ–‡ä»¶åŒºæ‹·è´åˆ°å¯¹æ¢åŒºã€‚ ç³»ç»Ÿç¼ºå°‘è¶³å¤Ÿçš„å¯¹æ¢åŒºç©ºé—´ï¼Œè¿™æ—¶å‡¡æ˜¯ä¸ä¼šè¢«ä¿®æ”¹çš„æ–‡ä»¶ï¼Œéƒ½ç›´æ¥ä»æ–‡ä»¶åŒºè°ƒå…¥ï¼›è€Œå½“æ¢å‡ºè¿™äº›é¡µé¢æ—¶ï¼Œç”±äºå®ƒä»¬æœªè¢«ä¿®æ”¹ï¼Œåˆ™ä¸å¿…å†å°†å®ƒä»¬é‡å†™åˆ°ç£ç›˜(æ¢å‡º)ï¼Œä»¥åå†è°ƒå…¥æ—¶ï¼Œä»ä»æ–‡ä»¶åŒºç›´æ¥è°ƒå…¥ã€‚ä½†å¯¹äºé‚£äº›å¯èƒ½è¢«ä¿®æ”¹çš„éƒ¨åˆ†ï¼Œåœ¨å°†å®ƒä»¬æ¢å‡ºæ—¶ä¾¿é¡»è°ƒåˆ°å¯¹æ¢åŒºï¼Œä»¥åéœ€è¦æ—¶å†ä»å¯¹æ¢åŒºè°ƒå…¥ã€‚ UNIX æ–¹å¼ã€‚ç”±äºä¸è¿›ç¨‹æœ‰å…³çš„æ–‡ä»¶éƒ½æ”¾åœ¨æ–‡ä»¶åŒºï¼Œæ•…å‡¡æ˜¯æœªè¿è¡Œè¿‡çš„é¡µé¢ï¼Œéƒ½åº”ä»æ–‡ä»¶åŒºè°ƒå…¥ã€‚è€Œå¯¹äºæ›¾ç»è¿è¡Œè¿‡ä½†åˆè¢«æ¢å‡ºçš„é¡µé¢ï¼Œç”±äºæ˜¯è¢«æ”¾åœ¨å¯¹æ¢åŒºï¼Œå› æ­¤åœ¨ä¸‹æ¬¡è°ƒå…¥æ—¶åº”ä»å¯¹æ¢åŒºè°ƒå…¥ã€‚ç”±äº UNIX ç³»ç»Ÿå…è®¸é¡µé¢å…±äº«ï¼Œå› æ­¤ï¼ŒæŸè¿›ç¨‹æ‰€è¯·æ±‚çš„é¡µé¢æœ‰å¯èƒ½å·²è¢«å…¶å®ƒè¿›ç¨‹è°ƒå…¥å†…å­˜ï¼Œæ­¤æ—¶ä¹Ÿå°±æ— éœ€å†ä»å¯¹æ¢åŒºè°ƒå…¥ã€‚    é¡µé¢è°ƒå…¥è¿‡ç¨‹\næ¯å½“ç¨‹åºæ‰€è¦è®¿é—®çš„é¡µé¢æœªåœ¨å†…å­˜æ—¶(å­˜åœ¨ä½ä¸ºâ€œ0â€)ï¼Œä¾¿å‘ CPU å‘å‡ºä¸€ç¼ºé¡µä¸­æ–­ï¼Œä¸­æ–­å¤„ç†ç¨‹åºé¦–å…ˆä¿ç•™ CPU ç¯å¢ƒï¼Œåˆ†æä¸­æ–­åŸå› åè½¬å…¥ç¼ºé¡µä¸­æ–­å¤„ç†ç¨‹åºã€‚è¯¥ç¨‹åºé€šè¿‡æ³æ‰¾é¡µè¡¨å¾—åˆ°è¯¥é¡µåœ¨å¤–å­˜çš„ç‰©ç†å—åï¼Œå¦‚æœæ­¤æ—¶å†…å­˜èƒ½å®¹çº³æ–°é¡µï¼Œåˆ™å¯åŠ¨ç£ç›˜ I/Oï¼Œå°†æ‰€ç¼ºä¹‹é¡µè°ƒå…¥å†…å­˜ï¼Œç„¶åä¿®æ”¹é¡µè¡¨ã€‚å¦‚æœå†…å­˜å·²æ»¡ï¼Œåˆ™é¡»å…ˆæŒ‰ç…§æŸç§ç½®æ¢ç®—æ³•ï¼Œä»å†…å­˜ä¸­é€‰å‡ºä¸€é¡µå‡†å¤‡æ¢å‡ºï¼›å¦‚æœè¯¥é¡µæœªè¢«ä¿®æ”¹è¿‡(ä¿®æ”¹ä½ä¸ºâ€œ0â€)ï¼Œå¯ä¸å¿…å°†è¯¥é¡µå†™å›ç£ç›˜ï¼›ä½†å¦‚æœæ­¤é¡µå·²è¢«ä¿®æ”¹(ä¿®æ”¹ä½ä¸ºâ€œ1â€)ï¼Œåˆ™å¿…é¡»å°†å®ƒå†™å›ç£ç›˜ï¼Œç„¶åå†æŠŠæ‰€ç¼ºçš„é¡µè°ƒå…¥å†…å­˜ï¼Œå¹¶ä¿®æ”¹é¡µè¡¨ä¸­çš„ç›¸åº”è¡¨é¡¹ï¼Œç½®å…¶å­˜åœ¨ä½ä¸ºâ€œ1â€ï¼Œå¹¶å°†æ­¤é¡µè¡¨é¡¹å†™å…¥å¿«è¡¨ä¸­ã€‚åœ¨ç¼ºé¡µè°ƒå…¥å†…å­˜åï¼Œåˆ©ç”¨ä¿®æ”¹åçš„é¡µè¡¨å½¢æˆæ‰€è¦è®¿é—®æ•°æ®çš„ç‰©ç†åœ°å€ï¼Œå†å»è®¿é—®å†…å­˜æ•°æ®ã€‚æ•´ä¸ªé¡µé¢çš„è°ƒå…¥è¿‡ç¨‹å¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ã€‚\n  é¡µé¢ç½®æ¢ç®—æ³• ä¸é€‚å½“çš„ç®—æ³•å¯èƒ½ä¼šå¯¼è‡´è¿›ç¨‹å‘ç”Ÿâ€œæŠ–åŠ¨â€(Thrashing)ï¼Œå³åˆšè¢«æ¢å‡ºçš„é¡µå¾ˆå¿«åˆè¦è¢«è®¿é—®ï¼Œéœ€è¦å°†å®ƒé‡æ–°è°ƒå…¥ï¼Œæ­¤æ—¶åˆéœ€è¦å†é€‰ä¸€é¡µè°ƒå‡ºï¼›è€Œæ­¤åˆšè¢«è°ƒå‡ºçš„é¡µå¾ˆå¿«åˆè¢«è®¿é—®,åˆéœ€å°†å®ƒè°ƒå…¥ï¼Œå¦‚æ­¤é¢‘ç¹åœ°æ›´æ¢é¡µé¢ï¼Œä»¥è‡´ä¸€ä¸ªè¿›ç¨‹åœ¨è¿è¡Œä¸­æŠŠå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±è´¹åœ¨é¡µé¢ç½®æ¢å·¥ä½œä¸Šï¼Œæˆ‘ä»¬ç§°è¯¥è¿›ç¨‹å‘ç”Ÿäº†â€œæŠ–åŠ¨â€ã€‚\nå‡å®šç³»ç»Ÿä¸ºæŸè¿›ç¨‹åˆ†é…äº†ä¸‰ä¸ªç‰©ç†å—ï¼Œå¹¶è€ƒè™‘æœ‰ä»¥ä¸‹çš„é¡µé¢å·å¼•ç”¨ä¸²ï¼š\n7,0,1,2,0,3,0,4,2,3,0,3,2,1,2,0,1,7,0,1 æœ€ä½³ç½®æ¢ç®—æ³• æ˜¯ä¸€ç§ç†æƒ³åŒ–çš„ç®—æ³•ï¼Œå…·æœ‰æœ€å¥½çš„æ€§èƒ½ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯å®ç°ä¸äº†çš„ï¼Œä½†æ˜¯å¯ä»¥ä½œä¸ºè¯„ä¼°å…¶ä»–ç®—æ³•çš„ä¼˜åŠ£ã€‚é‡‡ç”¨è¿™ç§ç®—æ³•å¯ä»¥è·å–æœ€ä½çš„ç¼ºé¡µç‡ã€‚\nå…ˆè¿›å…ˆå‡ºç½®æ¢ç®—æ³• è¯¥ç®—æ³•æ€»æ˜¯æ·˜æ±°æœ€å…ˆè¿›å…¥å†…å­˜çš„é¡µé¢ï¼Œå³é€‰æ‹©åœ¨å†…å­˜ä¸­é©»ç•™æ—¶é—´æœ€ä¹…çš„é¡µé¢äºˆä»¥æ·˜æ±°ã€‚ç”¨é“¾è¡¨å°±èƒ½å¤Ÿå¾ˆå®¹æ˜“çš„å®ç°ã€‚\næœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç½®æ¢ç®—æ³•(LRU) FIFO ç½®æ¢ç®—æ³•çš„æ€§èƒ½ä¹‹æ‰€ä»¥è¾ƒå·®ï¼Œæ˜¯å› ä¸ºå®ƒæ‰€ä¾æ®çš„æ¡ä»¶æ˜¯å„ä¸ªé¡µé¢è°ƒå…¥å†…å­˜çš„æ—¶é—´ï¼Œè€Œé¡µé¢è°ƒå…¥çš„å…ˆåå¹¶ä¸èƒ½åæ˜ é¡µé¢çš„ä½¿ç”¨æƒ…å†µã€‚æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨(LRU)çš„é¡µé¢ç½®æ¢ç®—æ³•æ˜¯æ ¹æ®é¡µé¢è°ƒå…¥å†…å­˜åçš„ä½¿ç”¨æƒ…å†µåšå‡ºå†³ç­–çš„ã€‚ç”±äºæ— æ³•é¢„æµ‹å„é¡µé¢å°†æ¥çš„ä½¿ç”¨æƒ…å†µï¼Œåªèƒ½åˆ©ç”¨â€œæœ€è¿‘çš„è¿‡å»â€ä½œä¸ºâ€œæœ€è¿‘çš„å°†æ¥â€çš„è¿‘ä¼¼ï¼Œå› æ­¤ï¼ŒLRU ç½®æ¢ç®—æ³•æ˜¯é€‰æ‹©æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢äºˆä»¥æ·˜æ±°ã€‚è¯¥ç®—æ³•èµ‹äºˆæ¯ä¸ªé¡µé¢ä¸€ä¸ªè®¿é—®å­—æ®µï¼Œç”¨æ¥è®°å½•ä¸€ä¸ªé¡µè€Œè‡ªä¸Šæ¬¡è¢«è®¿é—®ä»¥æ¥æ‰€ç»å†çš„æ—¶é—´ tã€‚å½“éœ€æ·˜æ±°ä¸€ä¸ªé¡µé¢æ—¶ï¼Œé€‰æ‹©ç°æœ‰é¡µé¢ä¸­å…¶ t å€¼æœ€å¤§çš„ï¼Œå³æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢äºˆä»¥æ·˜æ±°ã€‚\nç®—æ³•å®ç°(ç¡¬ä»¶æ”¯æŒ)ï¼š\n  å¯„å­˜å™¨\nä¸ºäº†è®°å½•æŸè¿›ç¨‹åœ¨å†…å­˜ä¸­å„é¡µçš„ä½¿ç”¨æƒ…å†µï¼Œé¡»ä¸ºæ¯ä¸ªåœ¨å†…å­˜ä¸­çš„é¡µé¢é…ç½®ä¸€ä¸ªç§»ä½å¯„å­˜å™¨ï¼Œå¯è¡¨ç¤ºä¸ºï¼š\n$$\nR = R_{n-1}R_{n-2}R_{n-3} â€¦ R_2R_1R_0\n$$\nå½“è¿›ç¨‹è®¿é—®æŸç‰©ç†å—æ—¶ï¼Œè¦å°†ç›¸åº”å¯„å­˜å™¨çš„ $R_{n-1}$ä½ç½®æˆ 1ã€‚æ­¤æ—¶ï¼Œå®šæ—¶ä¿¡å·å°†æ¯éš”ä¸€å®šæ—¶é—´(ä¾‹å¦‚ 100 ms)å°†å¯„å­˜å™¨å³ç§»ä¸€ä½ã€‚å¦‚æœæˆ‘ä»¬æŠŠ n ä½å¯„å­˜å™¨çš„æ•°çœ‹ä½œæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œé‚£ä¹ˆï¼Œå…·æœ‰æœ€å°æ•°å€¼çš„å¯„å­˜å™¨æ‰€å¯¹åº”çš„é¡µé¢ï¼Œå°±æ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢ã€‚ä¸‹å›¾ä¸­ç¬¬ä¸‰ä¸ªå†…å­˜é¡µé¢çš„Rå€¼æœ€å°ï¼Œç¼ºé¡µæ—¶å› è¯¥è¢«æ¢å‡ºï¼š\n  ç‰¹æ®Šçš„æ ˆ\nå¯åˆ©ç”¨ä¸€ä¸ªç‰¹æ®Šçš„æ ˆä¿å­˜å½“å‰ä½¿ç”¨çš„å„ä¸ªé¡µé¢çš„é¡µé¢å·ã€‚æ¯å½“è¿›ç¨‹è®¿é—®æŸé¡µè€Œæ—¶ï¼Œä¾¿å°†è¯¥é¡µé¢çš„é¡µé¢å·ä»æ ˆä¸­ç§»å‡ºï¼Œå°†å®ƒå‹å…¥æ ˆé¡¶ã€‚å› æ­¤ï¼Œæ ˆé¡¶å§‹ç»ˆæ˜¯æœ€æ–°è¢«è®¿é—®é¡µé¢çš„ç¼–å·,è€Œæ ˆåº•åˆ™æ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨é¡µé¢çš„é¡µé¢å·ã€‚\n  map + åŒå‘é“¾è¡¨å®ç°LRUç®—æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75  struct MyNode { int k, v; MyNode(int tk = 0, int tv = 0) { k = tk; v = tv; } }; // @lc code=start class LRUCache { private: map\u0026lt;int, int\u0026gt; hashtable; list\u0026lt;MyNode *\u0026gt; cache; unsigned int capacity; public: LRUCache(int capacity) { this-\u0026gt;capacity = capacity; } int get(int key) { if (hashtable.find(key) != hashtable.end()) { MyNode *node = new MyNode(key, hashtable[key]); for (list\u0026lt;MyNode *\u0026gt;::iterator it = cache.begin(); it != cache.end(); it++) { if ((*it)-\u0026gt;k == key) { cache.erase(it); break; } } cache.push_front(node); return hashtable[key]; } return -1; } void put(int key, int value) { MyNode *node = new MyNode(key, value); if (hashtable.find(key) == hashtable.end()) { // ä¸å­˜åœ¨è¿™ä¸ªKey  if (hashtable.size() \u0026gt;= capacity) { // è¶…è¿‡å®¹é‡ï¼Œç§»é™¤é˜Ÿå°¾å…ƒç´   MyNode *rnode = cache.back(); cache.pop_back(); hashtable.erase(rnode-\u0026gt;k); } hashtable[key] = value; cache.push_front(node); } else { // å­˜åœ¨è¿™ä¸ªkey  // ç§»é™¤  for (list\u0026lt;MyNode *\u0026gt;::iterator it = cache.begin(); it != cache.end(); it++) { if ((*it)-\u0026gt;k == key) { cache.erase(it); break; } } cache.push_front(node); hashtable[key] = value; } } };     æœ€å°‘ä½¿ç”¨ç½®æ¢ç®—æ³•(LFU) LFUï¼ˆLeast Frequently Usedï¼‰æœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•ã€‚å®ƒæ˜¯åŸºäºâ€œå¦‚æœä¸€ä¸ªæ•°æ®åœ¨æœ€è¿‘ä¸€æ®µæ—¶é—´å†…ä½¿ç”¨æ¬¡æ•°å¾ˆå°‘ï¼Œé‚£ä¹ˆåœ¨å°†æ¥ä¸€æ®µæ—¶é—´å†…è¢«ä½¿ç”¨çš„å¯èƒ½æ€§ä¹Ÿå¾ˆå°â€çš„æ€è·¯ã€‚\næ³¨æ„LFUå’ŒLRUç®—æ³•çš„ä¸åŒä¹‹å¤„ï¼ŒLRUçš„æ·˜æ±°è§„åˆ™æ˜¯åŸºäºè®¿é—®æ—¶é—´ï¼Œè€ŒLFUæ˜¯åŸºäºè®¿é—®æ¬¡æ•°çš„ã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š\nä¸ºäº†èƒ½å¤Ÿæ·˜æ±°æœ€å°‘ä½¿ç”¨çš„æ•°æ®ï¼Œå› æ­¤LFUç®—æ³•æœ€ç®€å•çš„ä¸€ç§è®¾è®¡æ€è·¯å°±æ˜¯ åˆ©ç”¨ä¸€ä¸ªæ•°ç»„å­˜å‚¨ æ•°æ®é¡¹ï¼Œç”¨hashmapå­˜å‚¨æ¯ä¸ªæ•°æ®é¡¹åœ¨æ•°ç»„ä¸­å¯¹åº”çš„ä½ç½®ï¼Œç„¶åä¸ºæ¯ä¸ªæ•°æ®é¡¹è®¾è®¡ä¸€ä¸ªè®¿é—®é¢‘æ¬¡ï¼Œå½“æ•°æ®é¡¹è¢«å‘½ä¸­æ—¶ï¼Œè®¿é—®é¢‘æ¬¡è‡ªå¢ï¼Œåœ¨æ·˜æ±°çš„æ—¶å€™æ·˜æ±°è®¿é—®é¢‘æ¬¡æœ€å°‘çš„æ•°æ®ã€‚è¿™æ ·ä¸€æ¥çš„è¯ï¼Œåœ¨æ’å…¥æ•°æ®å’Œè®¿é—®æ•°æ®çš„æ—¶å€™éƒ½èƒ½è¾¾åˆ°O(1)çš„æ—¶é—´å¤æ‚åº¦ï¼Œåœ¨æ·˜æ±°æ•°æ®çš„æ—¶å€™ï¼Œé€šè¿‡é€‰æ‹©ç®—æ³•å¾—åˆ°åº”è¯¥æ·˜æ±°çš„æ•°æ®é¡¹åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•ï¼Œå¹¶å°†è¯¥ç´¢å¼•ä½ç½®çš„å†…å®¹æ›¿æ¢ä¸ºæ–°æ¥çš„æ•°æ®å†…å®¹å³å¯ï¼Œè¿™æ ·çš„è¯ï¼Œæ·˜æ±°æ•°æ®çš„æ“ä½œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚\nClockç½®æ¢ç®—æ³• ç®€å•Clockç½®æ¢ç®—æ³• æ¯é¡µè®¾ç½®ä¸€ä¸ªè®¿é—®ä½ï¼Œå–å€¼ä¸º0å’Œ1ï¼Œå½“è¯¥é¡µè¢«è®¿é—®æ—¶ï¼Œè®¿é—®ä½ç½®ä¸º1ã€‚\nå½“åˆ©ç”¨ç®€å• Clock ç®—æ³•æ—¶ï¼Œåªéœ€ä¸ºæ¯é¡µè®¾ç½®ä¸€ä½è®¿é—®ä½ï¼Œå†å°†å†…å­˜ä¸­çš„æ‰€æœ‰é¡µé¢éƒ½é€šè¿‡é“¾æ¥æŒ‡é’ˆé“¾æ¥æˆä¸€ä¸ªå¾ªç¯é˜Ÿåˆ—ã€‚å½“æŸé¡µè¢«è®¿é—®æ—¶ï¼Œå…¶è®¿é—®ä½è¢«ç½® 1ã€‚ç½®æ¢ç®—æ³•åœ¨é€‰æ‹©ä¸€é¡µæ·˜æ±°æ—¶ï¼Œåªéœ€æ£€æŸ¥é¡µçš„è®¿é—®ä½ã€‚å¦‚æœæ˜¯ Oï¼Œå°±é€‰æ‹©è¯¥é¡µæ¢å‡ºï¼›è‹¥ä¸º 1ï¼Œåˆ™é‡æ–°å°†å®ƒç½® Oï¼Œæš‚ä¸æ¢å‡ºï¼Œç»™äºˆè¯¥é¡µç¬¬äºŒæ¬¡é©»ç•™å†…å­˜çš„æœºä¼šï¼Œå†æŒ‰ç…§ FIFO ç®—æ³•æ£€æŸ¥ä¸‹ä¸€ä¸ªé¡µé¢ã€‚å½“æ£€æŸ¥åˆ°é˜Ÿåˆ—ä¸­çš„æœ€åä¸€ä¸ªé¡µé¢æ—¶ï¼Œè‹¥å…¶è®¿é—®ä½ä»ä¸º 1ï¼Œåˆ™å†è¿”å›åˆ°é˜Ÿé¦–å»æ£€æŸ¥ç¬¬ä¸€ä¸ªé¡µé¢ã€‚\næ”¹è¿›Clockç½®æ¢ç®—æ³• è®¾ç½®ä¸¤ä¸ªå…³é”®ä½ï¼Œä¸€ä¸ªä¸ºè®¿é—®ä½ï¼Œä¸€ä¸ªä¸ºä¿®æ”¹ä½ã€‚\né¡µé¢ã€‚ç”±è®¿é—®ä½ A å’Œä¿®æ”¹ä½ M å¯ä»¥ç»„åˆæˆä¸‹é¢å››ç§ç±»å‹çš„é¡µé¢ï¼š\n1 ç±»(A=0ï¼ŒM=0)ï¼šè¡¨ç¤ºè¯¥é¡µæœ€è¿‘æ—¢æœªè¢«è®¿é—®ï¼Œåˆæœªè¢«ä¿®æ”¹ï¼Œæ˜¯æœ€ä½³æ·˜æ±°é¡µã€‚\n2 ç±»(A=0ï¼ŒM=1ï¼‰ï¼šè¡¨ç¤ºè¯¥é¡µæœ€è¿‘æœªè¢«è®¿é—®ï¼Œä½†å·²è¢«ä¿®æ”¹ï¼Œå¹¶ä¸æ˜¯å¾ˆå¥½çš„æ·˜æ±°é¡µã€‚\n3 ç±»(A=1ï¼ŒM=O)ï¼šè¡¨ç¤ºæœ€è¿‘å·²è¢«è®¿é—®ï¼Œä½†æœªè¢«ä¿®æ”¹ï¼Œè¯¥é¡µæœ‰å¯èƒ½å†è¢«è®¿é—®ã€‚\n4 ç±»(A=1ï¼ŒM=1)ï¼šè¡¨ç¤ºæœ€è¿‘å·²è¢«è®¿é—®ä¸”è¢«ä¿®æ”¹ï¼Œè¯¥é¡µå¯èƒ½å†è¢«è®¿é—®ã€‚\né¢ä¸­çš„å“ªä¸€ç§ã€‚å…¶æ‰§è¡Œè¿‡ç¨‹å¯åˆ†æˆä»¥ä¸‹ä¸‰æ­¥:\n ä»æŒ‡é’ˆæ‰€æŒ‡ç¤ºçš„å½“å‰ä½ç½®å¼€å§‹ï¼Œæ‰«æå¾ªç¯é˜Ÿåˆ—ï¼Œå¯»æ‰¾ A=0 ä¸” M=0 çš„ç¬¬ä¸€ç±»é¡µé¢ï¼Œå°†æ‰€é‡åˆ°çš„ç¬¬ä¸€ä¸ªé¡µé¢ä½œä¸ºæ‰€é€‰ä¸­çš„æ·˜æ±°é¡µã€‚åœ¨ç¬¬ä¸€æ¬¡æ‰«ææœŸé—´ä¸æ”¹å˜è®¿é—®ä½ Aã€‚ å¦‚æœç¬¬ä¸€æ­¥å¤±è´¥ï¼Œå³æŸ¥æ‰¾ä¸€è½®åæœªé‡åˆ°ç¬¬ä¸€ç±»é¡µé¢ï¼Œåˆ™å¼€å§‹ç¬¬äºŒè½®æ‰«æï¼Œå¯»æ‰¾ä¸” M=1 çš„ç¬¬äºŒç±»é¡µé¢ï¼Œå°†æ‰€é‡åˆ°çš„ç¬¬ä¸€ä¸ªè¿™ç±»é¡µé¢ä½œä¸ºæ·˜æ±°é¡µã€‚åœ¨ç¬¬äºŒè½®æ‰«ææœŸé—´ï¼Œå°†æ‰€æœ‰æ‰«æè¿‡çš„é¡µé¢çš„è®¿é—®ä½éƒ½ç½® 0ã€‚ å¦‚æœç¬¬äºŒæ­¥ä¹Ÿå¤±è´¥ï¼Œäº¦å³æœªæ‰¾åˆ°ç¬¬äºŒç±»é¡µé¢ï¼Œåˆ™å°†æŒ‡é’ˆè¿”å›åˆ°å¼€å§‹çš„ä½ç½®ï¼Œå¹¶å°†æ‰€æœ‰çš„è®¿é—®ä½å¤ 0ã€‚ç„¶åé‡å¤ç¬¬ä¸€æ­¥ï¼Œå³å¯»æ‰¾ A=O ä¸” M=O çš„ç¬¬ä¸€ç±»é¡µé¢ï¼Œå¦‚æœä»å¤±è´¥ï¼Œå¿…è¦æ—¶å†é‡å¤ç¬¬äºŒæ­¥ï¼Œå¯»æ‰¾ A=0 ä¸” M=1 çš„ç¬¬äºŒç±»é¡µé¢ï¼Œæ­¤æ—¶å°±ä¸€å®šèƒ½æ‰¾åˆ°è¢«æ·˜æ±°çš„é¡µã€‚  è¯¥ç®—æ³•ä¸ç®€å• Clock ç®—æ³•æ¯”è¾ƒï¼Œå¯å‡å°‘ç£ç›˜çš„ I/O æ“ä½œæ¬¡æ•°ã€‚ä½†ä¸ºäº†æ‰¾åˆ°ä¸€ä¸ªå¯ç½®æ¢çš„é¡µï¼Œå¯èƒ½é¡»ç»è¿‡å‡ è½®æ‰«æã€‚æ¢è¨€ä¹‹ï¼Œå®ç°è¯¥ç®—æ³•æœ¬èº«çš„å¼€é”€å°†æœ‰æ‰€å¢åŠ ã€‚\nå‚è€ƒé“¾æ¥ï¼š\n ä¸ºä»€ä¹ˆ Linux éœ€è¦è™šæ‹Ÿå†…å­˜ ã€Šæ“ä½œç³»ç»Ÿã€‹- ç¬¬å››ç‰ˆ  ","description":"è™šæ‹Ÿå†…å­˜æ˜¯æ“ä½œç³»ç»Ÿç‰©ç†å†…å­˜å’Œè¿›ç¨‹ä¹‹é—´çš„ä¸­é—´å±‚ï¼Œå®ƒä¸ºè¿›ç¨‹éšè—äº†ç‰©ç†å†…å­˜è¿™ä¸€æ¦‚å¿µï¼Œä¸ºè¿›ç¨‹æä¾›äº†æ›´åŠ ç®€æ´å’Œæ˜“ç”¨çš„æ¥å£ä»¥åŠæ›´åŠ å¤æ‚çš„åŠŸèƒ½ã€‚","id":63,"section":"posts","tags":["è™šæ‹Ÿå†…å­˜"],"title":"Linuxè™šæ‹Ÿå†…å­˜ä¸åˆ†é¡µå­˜å‚¨ç®¡ç†","uri":"https://hugo.jiahongw.com/zh/posts/linux/virtual-memory/"},{"content":"ä»ä»Šå¤©å¼€å§‹ï¼Œå‡†å¤‡è®°å½•ä»¥ä¸‹è‡ªå·±å¹³æ—¶çš„æƒ³æ³•ã€‚å› ä¸ºæœ‰è¶£çš„æƒ³æ³•å¯èƒ½ä¸€ç¬é—´å°±æ¶ˆå¤±äº†ã€‚å¦‚æœæ²¡æœ‰å°†è¿™äº›æƒ³æ³•åŠè¿‡ç¨‹è®°å½•ä¸‹æ¥ï¼Œåé¢å¯èƒ½è¢«ä»€ä¹ˆäº‹æƒ…ç»™è€½æäº†ï¼Œå¾ˆå¿«å°±ä¼šå¿˜è®°ã€‚è¿™æ ·å‰é¢çš„æƒ³æ³•å°±åªèƒ½è¿›è¡Œåˆ°ä¸€åŠï¼Œæ²¡æœ‰åç»­äº†ã€‚æˆ‘å¸Œæœ›ä»¥åèƒ½å¤Ÿç»å¸¸è®°å½•è‡ªå·±çš„æƒ³æ³•ï¼Œå› ä¸ºè‡ªå·±çš„è®°å¿†åŠ›å…¶å®ä¸å¤ªå¥½ï¼Œè¿™ä¹Ÿè®¸æ˜¯ä¸€ç§æ–¹æ³•èƒ½å¤Ÿè®©æˆ‘åšæŒä¸‹å»åšæŸä¸€ä»¶äº‹æƒ…å§\nå¹¶ä¸”æˆ‘è¿˜æƒ³åˆ°çš„ä¸€ä»¶äº‹æƒ…å°±æ˜¯ï¼Œå…¶å®å¤šå†™å…³äºè‡ªå·±çš„æƒ³æ³•è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯èƒ½å¤Ÿæ‹“å®½è‡ªå·±çš„æ€ç»´ã€‚å› ä¸ºæˆ‘åœ¨å†™ä¸œè¥¿çš„æ—¶å€™ä¹Ÿå–œæ¬¢å’Œè‡ªå·±è¿›è¡Œå¯¹è¯ï¼Œè¿™æ ·èƒ½å¤Ÿå¾—å‡ºå¾ˆå¤šä¸ä¸€æ ·çš„idea. ğŸ¤ \n","description":"æŠŠæœ‰è¶£çš„ä¸œè¥¿è®°å½•ä¸‹æ¥ï¼Œæ‰èƒ½è®°ä½å½“ä¸‹è‡ªå·±åœ¨åšä»€ä¹ˆï¼","id":64,"section":"posts","tags":["life"],"title":"åšå®¢å°è®°","uri":"https://hugo.jiahongw.com/zh/posts/ideas/first-thoughts/"},{"content":"æ•°æ®åº“äº‹åŠ¡ äº‹åŠ¡ï¼ˆTransactionï¼‰æ˜¯ç”±ä¸€ç³»åˆ—å¯¹ç³»ç»Ÿä¸­æ•°æ®è¿›è¡Œè®¿é—®ä¸æ›´æ–°çš„æ“ä½œæ‰€ç»„æˆçš„ä¸€ä¸ªç¨‹åºæ‰§è¡Œé€»è¾‘å•å…ƒã€‚äº‹åŠ¡æ˜¯DBMSä¸­æœ€åŸºç¡€çš„å•ä½ï¼Œäº‹åŠ¡ä¸å¯åˆ†å‰²ã€‚\næ•°æ®åº“äº‹åŠ¡å››å¤§ç‰¹æ€§(ACID)  åŸå­æ€§ï¼šä¸å¯åˆ†å‰²ï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆæäº¤ï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»š ä¸€è‡´æ€§ï¼šä¸€è‡´æ€§æ˜¯æŒ‡äº‹åŠ¡å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜æ¢åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œä¹‹å‰å’Œæ‰§è¡Œä¹‹åéƒ½å¿…é¡»å¤„äºä¸€è‡´æ€§çŠ¶æ€ã€‚ éš”ç¦»æ€§ï¼šå¤šç”¨æˆ·ä¸€èµ·è¿›è¡Œäº‹åŠ¡æ“ä½œäº’ä¸å½±å“ï¼Œç›¸äº’éš”ç¦»ã€‚ æŒä¹…æ€§ï¼šä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤äº†ï¼Œé‚£ä¹ˆå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œå³ä¾¿æ˜¯åœ¨æ•°æ®åº“ç³»ç»Ÿé‡åˆ°æ•…éšœçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±æäº¤äº‹åŠ¡çš„æ“ä½œã€‚  æ•°æ®åº“äº‹åŠ¡éš”ç¦»çº§åˆ« è¯»å–çš„é—®é¢˜\nusers    id name age     1 Joe 20   2 Jill 25      è„è¯»\nå½“ä¸€ä¸ªäº‹åŠ¡å…è®¸è¯»å–å¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹ä½†æœªæäº¤çš„æ•°æ®æ—¶ï¼Œå°±å¯èƒ½å‘ç”Ÿè„è¯»ã€‚\nä¾‹å­ä¸­ï¼Œäº‹åŠ¡2ä¿®æ”¹äº†ä¸€è¡Œï¼Œä½†æ˜¯æ²¡æœ‰æäº¤ï¼Œäº‹åŠ¡1è¯»äº†è¿™ä¸ªæ²¡æœ‰æäº¤çš„æ•°æ®ã€‚ç°åœ¨å¦‚æœäº‹åŠ¡2å›æ»šäº†åˆšæ‰çš„ä¿®æ”¹æˆ–è€…åšäº†å¦å¤–çš„ä¿®æ”¹çš„è¯ï¼Œäº‹åŠ¡1ä¸­æŸ¥åˆ°çš„æ•°æ®å°±æ˜¯ä¸æ­£ç¡®çš„äº†ã€‚\n  ä¸å¯é‡å¤è¯»\nåœ¨ä¸€æ¬¡äº‹åŠ¡ä¸­ï¼Œå½“ä¸€è¡Œæ•°æ®è·å–ä¸¤éå¾—åˆ°ä¸åŒçš„ç»“æœè¡¨ç¤ºå‘ç”Ÿäº†â€œä¸å¯é‡å¤è¯»â€.\nåœ¨åŸºäºé”çš„å¹¶å‘æ§åˆ¶ä¸­â€œä¸å¯é‡å¤è¯»â€ç°è±¡å‘ç”Ÿåœ¨å½“æ‰§è¡ŒSELECT æ“ä½œæ—¶æ²¡æœ‰è·å¾—è¯»é”æˆ–è€…SELECTæ“ä½œæ‰§è¡Œå®Œåé©¬ä¸Šé‡Šæ”¾äº†è¯»é”ï¼› å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ä¸­å½“æ²¡æœ‰è¦æ±‚ä¸€ä¸ªæäº¤å†²çª(commit conflict)çš„äº‹åŠ¡å›æ»šä¹Ÿä¼šå‘ç”Ÿâ€œä¸å¯é‡å¤è¯»â€ç°è±¡ã€‚\nè¿™ä¸ªä¾‹å­ä¸­ï¼Œäº‹åŠ¡2æäº¤æˆåŠŸï¼Œå› æ­¤ä»–å¯¹idä¸º1çš„è¡Œçš„ä¿®æ”¹å°±å¯¹å…¶ä»–äº‹åŠ¡å¯è§äº†ã€‚ä½†æ˜¯äº‹åŠ¡1åœ¨æ­¤å‰å·²ç»ä»è¿™è¡Œè¯»åˆ°äº†å¦å¤–ä¸€ä¸ªâ€œageâ€çš„å€¼ã€‚åœ¨å¯åºåˆ—åŒ–ï¼ˆSERIALIZABLEï¼‰å’Œå¯é‡å¤è¯»çš„éš”ç¦»çº§åˆ«ï¼Œæ•°æ®åº“åœ¨ç¬¬äºŒæ¬¡SELECTè¯·æ±‚çš„æ—¶å€™åº”è¯¥è¿”å›äº‹åŠ¡2æ›´æ–°ä¹‹å‰çš„å€¼ã€‚åœ¨æäº¤è¯»å’Œæœªæäº¤è¯»ï¼Œè¿”å›çš„æ˜¯æ›´æ–°ä¹‹åçš„å€¼ï¼Œè¿™ä¸ªç°è±¡å°±æ˜¯ä¸å¯é‡å¤è¯»ã€‚\n è§£å†³ä¸å¯é‡å¤è¯»ï¼š\n è¦æ±‚äº‹åŠ¡2å»¶è¿Ÿåˆ°äº‹åŠ¡1æäº¤æˆ–è€…å›æ»šä¹‹åå†æ‰§è¡Œã€‚è¿™ç§æ–¹å¼å®ç°äº†T1, T2 çš„ä¸²è¡ŒåŒ–è°ƒåº¦ã€‚ä¸²è¡ŒåŒ–è°ƒåº¦å¯ä»¥æ”¯æŒå¯é‡å¤è¯»ã€‚ å¦ä¸€ç§ç­–ç•¥æ˜¯å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ã€‚ä¸ºäº†å¾—åˆ°æ›´å¥½çš„å¹¶å‘æ€§èƒ½ï¼Œå…è®¸äº‹åŠ¡2å…ˆæäº¤ã€‚ä½†å› ä¸ºäº‹åŠ¡1åœ¨äº‹åŠ¡2ä¹‹å‰å¼€å§‹ï¼Œäº‹åŠ¡1å¿…é¡»åœ¨å…¶å¼€å§‹æ‰§è¡Œæ—¶é—´ç‚¹çš„æ•°æ®åº“çš„å¿«ç…§ä¸Šé¢æ“ä½œã€‚å½“äº‹åŠ¡1æœ€ç»ˆæäº¤æ—¶å€™ï¼Œæ•°æ®åº“ä¼šæ£€æŸ¥å…¶ç»“æœæ˜¯å¦ç­‰ä»·äºT1, T2ä¸²è¡Œè°ƒåº¦ã€‚å¦‚æœç­‰ä»·ï¼Œåˆ™å…è®¸äº‹åŠ¡1æäº¤ï¼Œå¦‚æœä¸ç­‰ä»·ï¼Œäº‹åŠ¡1éœ€è¦å›æ»šå¹¶æŠ›å‡ºä¸ªä¸²è¡ŒåŒ–å¤±è´¥çš„é”™è¯¯     å¹»è¯»\nåœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“ä¸¤ä¸ªå®Œå…¨ç›¸åŒçš„æŸ¥è¯¢è¯­å¥æ‰§è¡Œå¾—åˆ°ä¸åŒçš„ç»“æœé›†ã€‚è¿™ç§ç°è±¡ç§°ä¸ºâ€œå¹»å½±è¯»ï¼ˆphantom readï¼‰â€\nå½“äº‹åŠ¡æ²¡æœ‰è·å–*èŒƒå›´é”*çš„æƒ…å†µä¸‹æ‰§è¡Œ*SELECT \u0026hellip; WHERE*æ“ä½œå¯èƒ½ä¼šå‘ç”Ÿâ€œå¹»å½±è¯»â€ã€‚\nâ€œå¹»å½±è¯»â€æ˜¯ä¸å¯é‡å¤è¯»çš„ä¸€ç§ç‰¹æ®Šåœºæ™¯ï¼šå½“äº‹åŠ¡1ä¸¤æ¬¡æ‰§è¡ŒSELECT \u0026hellip; WHEREæ£€ç´¢ä¸€å®šèŒƒå›´å†…æ•°æ®çš„æ“ä½œä¸­é—´ï¼Œäº‹åŠ¡2åœ¨è¿™ä¸ªè¡¨ä¸­åˆ›å»ºäº†(å¦‚INSERT)äº†ä¸€è¡Œæ–°æ•°æ®ï¼Œè¿™æ¡æ–°æ•°æ®æ­£å¥½æ»¡è¶³äº‹åŠ¡1çš„â€œWHEREâ€å­å¥ã€‚\néœ€è¦æŒ‡å‡ºçš„æ˜¯äº‹åŠ¡1æ‰§è¡Œäº†ä¸¤éåŒæ ·çš„æŸ¥è¯¢è¯­å¥ã€‚å¦‚æœè®¾äº†æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œä¸¤æ¬¡ä¼šå¾—åˆ°åŒæ ·çš„ç»“æœé›†ï¼Œè¿™ä¹Ÿæ­£æ˜¯æ•°æ®åº“åœ¨å¯åºåˆ—åŒ–ï¼ˆSERIALIZABLEï¼‰éš”ç¦»çº§åˆ«ä¸Šéœ€è¦æ»¡è¶³çš„ã€‚ä½†æ˜¯åœ¨è¾ƒä½çš„éš”ç¦»çº§åˆ«ä¸Šï¼Œç¬¬äºŒæ¬¡æŸ¥è¯¢å¯èƒ½ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœé›†ã€‚\n   äº‹åŠ¡éš”ç¦»å…¶å®å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šé¢æåˆ°çš„è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»è¿™å‡ ä¸ªé—®é¢˜\n éš”ç¦»çº§åˆ«\n  è¯»æœªæäº¤ï¼ˆREAD UNCOMMITTEDï¼‰\næœªæäº¤è¯»ï¼ˆREAD UNCOMMITTEDï¼‰æ˜¯æœ€ä½çš„éš”ç¦»çº§åˆ«ã€‚å…è®¸â€œè„è¯»â€ï¼ˆdirty readsï¼‰ï¼Œäº‹åŠ¡å¯ä»¥çœ‹åˆ°å…¶ä»–äº‹åŠ¡â€œå°šæœªæäº¤â€çš„ä¿®æ”¹ã€‚\n  è¯»æäº¤ ï¼ˆREAD COMMITTEDï¼‰\nåœ¨æäº¤è¯»ï¼ˆREAD COMMITTEDï¼‰çº§åˆ«ä¸­ï¼ŒåŸºäºé”æœºåˆ¶å¹¶å‘æ§åˆ¶çš„DBMSéœ€è¦å¯¹é€‰å®šå¯¹è±¡çš„å†™é”ä¸€ç›´ä¿æŒåˆ°äº‹åŠ¡ç»“æŸï¼Œä½†æ˜¯è¯»é”åœ¨SELECTæ“ä½œå®Œæˆåé©¬ä¸Šé‡Šæ”¾ã€‚\n  å¯é‡å¤è¯» ï¼ˆREPEATABLE READï¼‰\nåœ¨å¯é‡å¤è¯»ï¼ˆREPEATABLE READSï¼‰éš”ç¦»çº§åˆ«ä¸­ï¼ŒåŸºäºé”æœºåˆ¶å¹¶å‘æ§åˆ¶çš„DBMSéœ€è¦å¯¹é€‰å®šå¯¹è±¡çš„è¯»é”ï¼ˆread locksï¼‰å’Œå†™é”ï¼ˆwrite locksï¼‰ä¸€ç›´ä¿æŒåˆ°äº‹åŠ¡ç»“æŸã€‚\n ä¸ºäº†è§£å†³ä¸å¯é‡å¤è¯»ï¼Œæˆ–è€…ä¸ºäº†å®ç°å¯é‡å¤è¯»ï¼ŒMySQL é‡‡ç”¨äº† MVVC (å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶) çš„æ–¹å¼ã€‚\n æˆ‘ä»¬åœ¨æ•°æ®åº“è¡¨ä¸­çœ‹åˆ°çš„ä¸€è¡Œè®°å½•å¯èƒ½å®é™…ä¸Šæœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œæ¯ä¸ªç‰ˆæœ¬çš„è®°å½•é™¤äº†æœ‰æ•°æ®æœ¬èº«å¤–ï¼Œè¿˜è¦æœ‰ä¸€ä¸ªè¡¨ç¤ºç‰ˆæœ¬çš„å­—æ®µï¼Œè®°ä¸º row trx_idï¼Œè€Œè¿™ä¸ªå­—æ®µå°±æ˜¯ä½¿å…¶äº§ç”Ÿçš„äº‹åŠ¡çš„ idï¼Œäº‹åŠ¡ ID è®°ä¸º transaction idï¼Œå®ƒåœ¨äº‹åŠ¡å¼€å§‹çš„æ—¶å€™å‘äº‹åŠ¡ç³»ç»Ÿç”³è¯·ï¼ŒæŒ‰æ—¶é—´å…ˆåé¡ºåºé€’å¢ã€‚\næŒ‰ç…§ä¸Šé¢è¿™å¼ å›¾ç†è§£ï¼Œä¸€è¡Œè®°å½•ç°åœ¨æœ‰ 3 ä¸ªç‰ˆæœ¬ï¼Œæ¯ä¸€ä¸ªç‰ˆæœ¬éƒ½è®°å½•è¿™ä½¿å…¶äº§ç”Ÿçš„äº‹åŠ¡ IDï¼Œæ¯”å¦‚äº‹åŠ¡Açš„transaction id æ˜¯100ï¼Œé‚£ä¹ˆç‰ˆæœ¬1çš„row trx_id å°±æ˜¯ 100ï¼ŒåŒç†ç‰ˆæœ¬2å’Œç‰ˆæœ¬3ã€‚\nè¯»æäº¤å’Œå¯é‡å¤è¯»çš„æ—¶å€™éƒ½æåˆ°äº†ä¸€ä¸ªè¯ï¼Œå«åšå¿«ç…§ï¼Œå­¦åå«åšä¸€è‡´æ€§è§†å›¾ï¼Œè¿™ä¹Ÿæ˜¯å¯é‡å¤è¯»å’Œä¸å¯é‡å¤è¯»çš„å…³é”®ã€‚å¯é‡å¤è¯»æ˜¯åœ¨äº‹åŠ¡å¼€å§‹çš„æ—¶å€™ç”Ÿæˆä¸€ä¸ªå½“å‰äº‹åŠ¡å…¨å±€æ€§çš„å¿«ç…§ï¼Œè€Œè¯»æäº¤åˆ™æ˜¯æ¯æ¬¡æ‰§è¡Œè¯­å¥çš„æ—¶å€™éƒ½é‡æ–°ç”Ÿæˆä¸€æ¬¡å¿«ç…§ã€‚\n  ä¸²è¡ŒåŒ– ï¼ˆSERIALIZABLEï¼‰\nä¸²è¡ŒåŒ–æ˜¯4ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸­éš”ç¦»æ•ˆæœæœ€å¥½çš„ï¼Œè§£å†³äº†è„è¯»ã€å¯é‡å¤è¯»ã€å¹»è¯»çš„é—®é¢˜ï¼Œä½†æ˜¯æ•ˆæœæœ€å·®ï¼Œå®ƒå°†äº‹åŠ¡çš„æ‰§è¡Œå˜ä¸ºé¡ºåºæ‰§è¡Œï¼Œä¸å…¶ä»–ä¸‰ä¸ªéš”ç¦»çº§åˆ«ç›¸æ¯”ï¼Œå®ƒå°±ç›¸å½“äºå•çº¿ç¨‹ï¼Œåä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œå¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªäº‹åŠ¡ç»“æŸã€‚è¯»çš„æ—¶å€™åŠ å…±äº«é”ï¼Œä¹Ÿå°±æ˜¯å…¶ä»–äº‹åŠ¡å¯ä»¥å¹¶å‘è¯»ï¼Œä½†æ˜¯ä¸èƒ½å†™ã€‚å†™çš„æ—¶å€™åŠ æ’å®ƒé”ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å¹¶å‘å†™ä¹Ÿä¸èƒ½å¹¶å‘è¯»ã€‚\n åœ¨åŸºäºé”æœºåˆ¶å¹¶å‘æ§åˆ¶çš„DBMSå®ç°å¯ä¸²è¡ŒåŒ–ï¼Œè¦æ±‚åœ¨é€‰å®šå¯¹è±¡ä¸Šçš„è¯»é”å’Œå†™é”ä¿æŒç›´åˆ°äº‹åŠ¡ç»“æŸåæ‰èƒ½é‡Šæ”¾ã€‚åœ¨SELECT çš„æŸ¥è¯¢ä¸­ä½¿ç”¨ä¸€ä¸ªâ€œWHEREâ€å­å¥æ¥æè¿°ä¸€ä¸ªèŒƒå›´æ—¶åº”è¯¥è·å¾—ä¸€ä¸ªâ€œèŒƒå›´é”â€ï¼ˆrange-locksï¼‰ã€‚è¿™ç§æœºåˆ¶å¯ä»¥é¿å…â€œå¹»è¯»â€ï¼ˆphantom readsï¼‰ç°è±¡\n   å¹¶å‘å†™é—®é¢˜\nå­˜åœ¨è¿™çš„æƒ…å†µï¼Œä¸¤ä¸ªäº‹åŠ¡ï¼Œå¯¹åŒä¸€æ¡æ•°æ®åšä¿®æ”¹ã€‚æœ€åç»“æœåº”è¯¥æ˜¯å“ªä¸ªäº‹åŠ¡çš„ç»“æœå‘¢ï¼Œè‚¯å®šè¦æ˜¯æ—¶é—´é åçš„é‚£ä¸ªã€‚\nå‡è®¾äº‹åŠ¡Aæ‰§è¡Œ update æ“ä½œï¼Œ update çš„æ—¶å€™è¦å¯¹æ‰€ä¿®æ”¹çš„è¡ŒåŠ è¡Œé”ï¼Œè¿™ä¸ªè¡Œé”ä¼šåœ¨æäº¤ä¹‹åæ‰é‡Šæ”¾ã€‚è€Œåœ¨äº‹åŠ¡Aæäº¤ä¹‹å‰ï¼Œäº‹åŠ¡Bä¹Ÿæƒ³ update è¿™è¡Œæ•°æ®ï¼Œäºæ˜¯ç”³è¯·è¡Œé”ï¼Œä½†æ˜¯ç”±äºå·²ç»è¢«äº‹åŠ¡Aå æœ‰ï¼Œäº‹åŠ¡Bæ˜¯ç”³è¯·ä¸åˆ°çš„ï¼Œæ­¤æ—¶ï¼Œäº‹åŠ¡Bå°±ä¼šä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°äº‹åŠ¡Aæäº¤ï¼Œäº‹åŠ¡Bæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œå¦‚æœäº‹åŠ¡Açš„æ—¶é—´å¤ªé•¿ï¼Œé‚£ä¹ˆäº‹åŠ¡Bå¾ˆæœ‰å¯èƒ½å‡ºç°è¶…æ—¶å¼‚å¸¸ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåŠ å…¥æŸ¥è¯¢çš„å­—æ®µè®¾ç½®äº†ç´¢å¼•ï¼Œé‚£ä¹ˆæ•°æ®åº“ç³»ç»Ÿå¯ä»¥å¾ˆæ–¹ä¾¿çš„ç»™è¯¥è¡Œæ•°æ®åŠ ä¸Šä¸€ä¸ªè¡Œé”ï¼›åŠ å…¥æ²¡æœ‰è®¾ç½®ç´¢å¼•çš„è¯ï¼Œæ•°æ®åº“ç³»ç»Ÿä¼šç›´æ¥å°†è¯¥è¡¨çš„æ‰€æœ‰è¡ŒåŠ ä¸Šè¡Œé”ï¼Œç„¶åå†éå†ä¸€éï¼Œé‡Šæ”¾æ‰æ²¡ç”¨çš„è¡Œé”ã€‚\nè§£å†³å¹»è¯»\nå¹¶å‘å†™é—®é¢˜çš„è§£å†³æ–¹å¼å°±æ˜¯è¡Œé”ï¼Œè€Œè§£å†³å¹»è¯»ç”¨çš„ä¹Ÿæ˜¯é”ï¼Œå«åšé—´éš™é”ï¼ŒMySQL æŠŠè¡Œé”å’Œé—´éš™é”åˆå¹¶åœ¨ä¸€èµ·ï¼Œè§£å†³äº†å¹¶å‘å†™å’Œå¹»è¯»çš„é—®é¢˜ï¼Œè¿™ä¸ªé”å«åš Next-Keyé”ã€‚\nåœ¨æ•°æ®åº“ä¸­ä¼šä¸ºç´¢å¼•ç»´æŠ¤ä¸€å¥—B+æ ‘ï¼Œç”¨æ¥å¿«é€Ÿå®šä½è¡Œè®°å½•ã€‚B+ç´¢å¼•æ ‘æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥ä¼šæŠŠè¿™å¼ è¡¨çš„ç´¢å¼•åˆ†å‰²æˆå‡ ä¸ªåŒºé—´ã€‚å¯èƒ½ä¼šæœ‰å¦‚ä¸‹çš„B+æ ‘ï¼š\nå¦‚å›¾æ‰€ç¤ºï¼Œåˆ†æˆäº†3 ä¸ªåŒºé—´ï¼Œ(è´Ÿæ— ç©·,10]ã€(10,30]ã€(30,æ­£æ— ç©·]ï¼Œåœ¨è¿™3ä¸ªåŒºé—´æ˜¯å¯ä»¥åŠ é—´éš™é”çš„ã€‚\nåœ¨äº‹åŠ¡Aæäº¤ä¹‹å‰ï¼Œäº‹åŠ¡Bçš„æ’å…¥æ“ä½œåªèƒ½ç­‰å¾…ï¼Œè¿™å°±æ˜¯é—´éš™é”èµ·å¾—ä½œç”¨ã€‚å½“äº‹åŠ¡Aæ‰§è¡Œupdate user set name='é£ç­2å·â€™ where age = 10; çš„æ—¶å€™ï¼Œç”±äºæ¡ä»¶ where age = 10 ï¼Œæ•°æ®åº“ä¸ä»…åœ¨ age =10 çš„è¡Œä¸Šæ·»åŠ äº†è¡Œé”ï¼Œè€Œä¸”åœ¨è¿™æ¡è®°å½•çš„ä¸¤è¾¹ï¼Œä¹Ÿå°±æ˜¯(è´Ÿæ— ç©·,10]ã€(10,30]è¿™ä¸¤ä¸ªåŒºé—´åŠ äº†é—´éš™é”ï¼Œä»è€Œå¯¼è‡´äº‹åŠ¡Bæ’å…¥æ“ä½œæ— æ³•å®Œæˆï¼Œåªèƒ½ç­‰å¾…äº‹åŠ¡Aæäº¤ã€‚ä¸ä»…æ’å…¥ age = 10 çš„è®°å½•éœ€è¦ç­‰å¾…äº‹åŠ¡Aæäº¤ï¼Œage\u0026lt;10ã€10\u0026lt;age\u0026lt;30 çš„è®°å½•é¡µæ— æ³•å®Œæˆï¼Œè€Œå¤§äºç­‰äº30çš„è®°å½•åˆ™ä¸å—å½±å“ï¼Œè¿™è¶³ä»¥è§£å†³å¹»è¯»é—®é¢˜äº†ã€‚\n è¿™æ˜¯æœ‰ç´¢å¼•çš„æƒ…å†µï¼Œå¦‚æœ age ä¸æ˜¯ç´¢å¼•åˆ—ï¼Œé‚£ä¹ˆæ•°æ®åº“ä¼šä¸ºæ•´ä¸ªè¡¨åŠ ä¸Šé—´éš™é”ã€‚æ‰€ä»¥ï¼Œå¦‚æœæ˜¯æ²¡æœ‰ç´¢å¼•çš„è¯ï¼Œä¸ç®¡ age æ˜¯å¦å¤§äºç­‰äº30ï¼Œéƒ½è¦ç­‰å¾…äº‹åŠ¡Aæäº¤æ‰å¯ä»¥æˆåŠŸæ’å…¥ã€‚\n éš”ç¦»çº§åˆ«vsè¯»ç°è±¡\n   éš”ç¦»çº§åˆ« è„è¯» ä¸å¯é‡å¤è¯» å¹»å½±è¯»     æœªæäº¤è¯» å¯èƒ½å‘ç”Ÿ å¯èƒ½å‘ç”Ÿ å¯èƒ½å‘ç”Ÿ   æäº¤è¯» - å¯èƒ½å‘ç”Ÿ å¯èƒ½å‘ç”Ÿ   å¯é‡å¤è¯» - - å¯èƒ½å‘ç”Ÿ   å¯åºåˆ—åŒ– - - -    å¯åºåˆ—åŒ–ï¼ˆSerializableï¼‰éš”ç¦»çº§åˆ«ä¸ç­‰åŒäºå¯ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ã€‚å¯ä¸²è¡ŒåŒ–è°ƒåº¦æ˜¯é¿å…ä»¥ä¸Šä¸‰ç§ç°è±¡çš„å¿…è¦æ¡ä»¶ï¼Œä½†ä¸æ˜¯å……åˆ†æ¡ä»¶ã€‚\n â€œå¯èƒ½å‘ç”Ÿâ€è¡¨ç¤ºè¿™ä¸ªéš”ç¦»çº§åˆ«ä¼šå‘ç”Ÿå¯¹åº”çš„ç°è±¡ï¼Œâ€œ-â€è¡¨ç¤ºä¸ä¼šå‘ç”Ÿã€‚é‡‡ç”¨å“ªç§éš”ç¦»çº§åˆ«è¦æ ¹æ®ç³»ç»Ÿéœ€æ±‚æƒè¡¡å†³å®šï¼Œå…¶ä¸­ï¼Œå¯é‡å¤è¯»æ˜¯ MySQL çš„é»˜è®¤çº§åˆ«ã€‚\n éš”ç¦»çº§åˆ«vs é”æŒç»­æ—¶é—´\nåœ¨åŸºäºé”çš„å¹¶å‘æ§åˆ¶ä¸­ï¼Œéš”ç¦»çº§åˆ«å†³å®šäº†é”çš„æŒæœ‰æ—¶é—´ã€‚\u0026ldquo;C\u0026rdquo;-è¡¨ç¤ºé”ä¼šæŒç»­åˆ°äº‹åŠ¡æäº¤ã€‚ \u0026ldquo;S\u0026rdquo; â€“è¡¨ç¤ºé”æŒç»­åˆ°å½“å‰è¯­å¥æ‰§è¡Œå®Œæ¯•ã€‚å¦‚æœé”åœ¨è¯­å¥æ‰§è¡Œå®Œæ¯•å°±é‡Šæ”¾åˆ™å¦å¤–ä¸€ä¸ªäº‹åŠ¡å°±å¯ä»¥åœ¨è¿™ä¸ªäº‹åŠ¡æäº¤å‰ä¿®æ”¹é”å®šçš„æ•°æ®ï¼Œä»è€Œé€ æˆæ··ä¹±\n   éš”ç¦»çº§åˆ« å†™æ“ä½œ è¯»æ“ä½œ èŒƒå›´æ“ä½œ (\u0026hellip;where\u0026hellip;)     æœªæäº¤è¯» S S S   æäº¤è¯» C S S   å¯é‡å¤è¯» C C S   å¯åºåˆ—åŒ– C C C    MySQLéš”ç¦»æ“ä½œï¼š\n æŸ¥çœ‹Mysqlé»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼š  1 2 3 4 5 6 7  mysql\u0026gt; show variables like \u0026#39;transaction_isolation\u0026#39;; +-----------------------+-----------------+ | Variable_name | Value | +-----------------------+-----------------+ | transaction_isolation | REPEATABLE-READ | +-----------------------+-----------------+ 1 row in set, 1 warning (0.11 sec)   å¯ä»¥å‘ç°Mysqlé»˜è®¤çš„éš”ç¦»çº§åˆ«ä¸ºå¯é‡å¤è¯»\nä¿®æ”¹æ”¹æ•°æ®åº“çš„éš”ç¦»çº§åˆ«ï¼šset [ä½œç”¨åŸŸ] transaction isolation level [äº‹åŠ¡éš”ç¦»çº§åˆ«]ï¼Œå…·ä½“å¦‚ä¸‹ï¼š\n1  SET [SESSION | GLOBAL] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE}ã€‚   æ•°æ®åº“ç´¢å¼•(INDEX) æ•°æ®åº“ç´¢å¼•æ˜¯ä¸ºäº†å¢åŠ æŸ¥è¯¢é€Ÿåº¦è€Œå¯¹è¡¨å­—æ®µé™„åŠ çš„ä¸€ç§æ ‡è¯†ï¼Œæ˜¯å¯¹æ•°æ®åº“è¡¨ä¸­ä¸€åˆ—æˆ–å¤šåˆ—çš„å€¼è¿›è¡Œæ’åºçš„ä¸€ç§ç»“æ„ã€‚\nMysqlåˆ›å»ºç´¢å¼•ï¼š\n1  CREATE INDEX INDEX_NAME ON TABLE_NAME (COLUMN_LIST)   æ•°æ®åº“çš„ä¸‰å¤§èŒƒå¼ ç¬¬ä¸€èŒƒå¼\nå½“å…³ç³»æ¨¡å¼Rçš„æ‰€æœ‰å±æ€§éƒ½ä¸èƒ½å†åˆ†è§£ä¸ºæ›´åŸºæœ¬çš„æ•°æ®å•ä½æ—¶ï¼Œç§°Ræ˜¯æ»¡è¶³ç¬¬ä¸€èŒƒå¼ï¼Œå³å±æ€§ä¸å¯åˆ†\nç¬¬äºŒèŒƒå¼\nå¦‚æœå…³ç³»æ¨¡å¼Ræ»¡è¶³ç¬¬ä¸€èŒƒå¼ï¼Œå¹¶ä¸”Rå¾—æ‰€æœ‰éä¸»å±æ€§éƒ½å®Œå…¨ä¾èµ–äºRçš„æ¯ä¸€ä¸ªå€™é€‰å…³é”®å±æ€§ï¼Œç§°Ræ»¡è¶³ç¬¬äºŒèŒƒå¼\nç¬¬ä¸‰èŒƒå¼\nè®¾Ræ˜¯ä¸€ä¸ªæ»¡è¶³ç¬¬ä¸€èŒƒå¼æ¡ä»¶çš„å…³ç³»æ¨¡å¼ï¼ŒXæ˜¯Rçš„ä»»æ„å±æ€§é›†ï¼Œå¦‚æœXéä¼ é€’ä¾èµ–äºRçš„ä»»æ„ä¸€ä¸ªå€™é€‰å…³é”®å­—ï¼Œç§°Ræ»¡è¶³ç¬¬ä¸‰èŒƒå¼ï¼Œå³éä¸»å±æ€§ä¸ä¼ é€’ä¾èµ–äºé”®ç \nå‚è€ƒé“¾æ¥ï¼š\n https://www.cnblogs.com/fengzheng/p/12557762.html https://zh.wikipedia.org/wiki/%E4%BA%8B%E5%8B%99%E9%9A%94%E9%9B%A2#%E8%84%8F%E8%AF%BB  mysqlçš„MVCCæœºåˆ¶ MVCCçš„ç»´åŸºç™¾ç§‘è§£é‡Šï¼šå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶(Multiversion concurrency controlï¼Œ MCC æˆ– MVCC)ï¼Œæ˜¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå¸¸ç”¨çš„ä¸€ç§å¹¶å‘æ§åˆ¶ï¼Œä¹Ÿç”¨äºç¨‹åºè®¾è®¡è¯­è¨€å®ç°äº‹åŠ¡å†…å­˜ã€‚\n MVCCæ˜¯ä¸€ç§å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼Œæ˜¯MySQLçš„InnoDBå­˜å‚¨å¼•æ“å®ç°éš”ç¦»çº§åˆ«çš„ä¸€ç§å…·ä½“æ–¹å¼ï¼Œç”¨äºå®ç°æäº¤è¯»å’Œå¯é‡å¤è¯»è¿™ä¸¤ç§éš”ç¦»çº§åˆ«\n MVCCä½œç”¨\nMVCCæ„å›¾è§£å†³è¯»å†™é”é€ æˆçš„å¤šä¸ªã€é•¿æ—¶é—´çš„è¯»æ“ä½œé¥¿æ­»å†™æ“ä½œé—®é¢˜ã€‚æ‰€ä»¥MVCCé€šè¿‡ä¿å­˜æŸä¸ªæ—¶é—´ç‚¹çš„å¿«ç…§æ¥å®ç°è¯¥æœºåˆ¶ï¼Œæ¯ä¸ªäº‹åŠ¡è¯»åˆ°çš„æ•°æ®é¡¹éƒ½æ˜¯ä¸€ä¸ªå†å²å¿«ç…§ï¼ˆsnapshot)å¹¶ä¾èµ–äºå®ç°çš„éš”ç¦»çº§åˆ«ã€‚å†™æ“ä½œä¸è¦†ç›–å·²æœ‰æ•°æ®é¡¹ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œç›´è‡³æ‰€åœ¨æ“ä½œæäº¤æ—¶æ‰å˜ä¸ºå¯è§ã€‚å¿«ç…§éš”ç¦»ä½¿å¾—äº‹ç‰©çœ‹åˆ°å®ƒå¯åŠ¨æ—¶çš„æ•°æ®çŠ¶æ€ã€‚\n MVCCå¯ä»¥æ— é”å®ç°ã€‚\n å¸¸è§çš„æ•°æ®åº“ä¼˜åŒ–æ–¹æ³•  æˆ–è€…ç´¢å¼•ç›¸å…³çš„ç‚¹ä½ å…¨éƒ¨éƒ½çŸ¥é“ä¹ˆï¼Ÿèšç°‡ç´¢å¼•ï¼Œéèšç°‡ç´¢å¼•ï¼Œæ™®é€šç´¢å¼•ï¼Œå”¯ä¸€ç´¢å¼•ï¼Œchange bufferï¼Œè¡¨é”ã€è¡Œé”ã€é—´éš™é”ä»¥åŠè¡Œé”å¹¶å‘æƒ…å†µä¸‹çš„æœ€å¤§TPSæ˜¯å¤šå°‘ï¼Ÿè¿˜æœ‰ç´¢å¼•ä¸ºå•¥ä¼šé€‰æ‹©é”™è¯¯ï¼Ÿè¿™äº›å¤§å®¶çŸ¥é“å˜›ï¼Ÿ\n æ•°æ®åº“çš„ç»„æˆç»“æ„å›¾ï¼š\næˆ‘ä»¬æ‰€è°“çš„è°ƒä¼˜ä¹Ÿå°±æ˜¯åœ¨ï¼Œæ‰§è¡Œå™¨æ‰§è¡Œä¹‹å‰çš„åˆ†æå™¨ï¼Œä¼˜åŒ–å™¨é˜¶æ®µå®Œæˆçš„ã€‚\n  å…ˆè·‘sql explain\nMySQL æä¾›äº†ä¸€ä¸ª EXPLAIN å‘½ä»¤, å®ƒå¯ä»¥å¯¹ SELECT è¯­å¥è¿›è¡Œåˆ†æ, å¹¶è¾“å‡º SELECT æ‰§è¡Œçš„è¯¦ç»†ä¿¡æ¯, ä»¥ä¾›å¼€å‘äººå‘˜é’ˆå¯¹æ€§ä¼˜åŒ–.\nEXPLAIN å‘½ä»¤ç”¨æ³•ååˆ†ç®€å•, åœ¨ SELECT è¯­å¥å‰åŠ ä¸Š Explain å°±å¯ä»¥äº†, ä¾‹å¦‚:\n1  EXPLAIN SELECT * from user_info WHERE id \u0026lt; 300;   EXPLAIN å‘½ä»¤çš„è¾“å‡ºå†…å®¹å¤§è‡´å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  mysql\u0026gt; explain select * from user_info where id = 2\\G *************************** 1. row *************************** id: 1 select_type: SIMPLE table: user_info partitions: NULL type: const possible_keys: PRIMARY key: PRIMARY key_len: 8 ref: const rows: 1 filtered: 100.00 Extra: NULL 1 row in set, 1 warning (0.00 sec)   å„åˆ—çš„å«ä¹‰å¦‚ä¸‹:\n  id: SELECT æŸ¥è¯¢çš„æ ‡è¯†ç¬¦. æ¯ä¸ª SELECT éƒ½ä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦.\n  select_type: SELECT æŸ¥è¯¢çš„ç±»å‹.\nå®ƒçš„å¸¸ç”¨å–å€¼æœ‰:\n SIMPLE, è¡¨ç¤ºæ­¤æŸ¥è¯¢ä¸åŒ…å« UNION æŸ¥è¯¢æˆ–å­æŸ¥è¯¢ PRIMARY, è¡¨ç¤ºæ­¤æŸ¥è¯¢æ˜¯æœ€å¤–å±‚çš„æŸ¥è¯¢ UNION, è¡¨ç¤ºæ­¤æŸ¥è¯¢æ˜¯ UNION çš„ç¬¬äºŒæˆ–éšåçš„æŸ¥è¯¢ DEPENDENT UNION, UNION ä¸­çš„ç¬¬äºŒä¸ªæˆ–åé¢çš„æŸ¥è¯¢è¯­å¥, å–å†³äºå¤–é¢çš„æŸ¥è¯¢ UNION RESULT, UNION çš„ç»“æœ SUBQUERY, å­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ª SELECT DEPENDENT SUBQUERY: å­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ª SELECT, å–å†³äºå¤–é¢çš„æŸ¥è¯¢. å³å­æŸ¥è¯¢ä¾èµ–äºå¤–å±‚æŸ¥è¯¢çš„ç»“æœ.    table: æŸ¥è¯¢çš„æ˜¯å“ªä¸ªè¡¨\n  partitions: åŒ¹é…çš„åˆ†åŒº\n  type: join ç±»å‹\ntype å­—æ®µæ¯”è¾ƒé‡è¦, å®ƒæä¾›äº†åˆ¤æ–­æŸ¥è¯¢æ˜¯å¦é«˜æ•ˆçš„é‡è¦ä¾æ®ä¾æ®. é€šè¿‡ type å­—æ®µ, æˆ‘ä»¬åˆ¤æ–­æ­¤æ¬¡æŸ¥è¯¢æ˜¯ å…¨è¡¨æ‰«æ è¿˜æ˜¯ ç´¢å¼•æ‰«æ ç­‰.\ntype å¸¸ç”¨çš„å–å€¼æœ‰:\n system: è¡¨ä¸­åªæœ‰ä¸€æ¡æ•°æ®. è¿™ä¸ªç±»å‹æ˜¯ç‰¹æ®Šçš„ const ç±»å‹. const: é’ˆå¯¹ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•çš„ç­‰å€¼æŸ¥è¯¢æ‰«æ, æœ€å¤šåªè¿”å›ä¸€è¡Œæ•°æ®. const æŸ¥è¯¢é€Ÿåº¦éå¸¸å¿«, å› ä¸ºå®ƒä»…ä»…è¯»å–ä¸€æ¬¡å³å¯.    possible_keys: æ­¤æ¬¡æŸ¥è¯¢ä¸­å¯èƒ½é€‰ç”¨çš„ç´¢å¼•\npossible_keys è¡¨ç¤º MySQL åœ¨æŸ¥è¯¢æ—¶, èƒ½å¤Ÿä½¿ç”¨åˆ°çš„ç´¢å¼•. æ³¨æ„, å³ä½¿æœ‰äº›ç´¢å¼•åœ¨ possible_keys ä¸­å‡ºç°, ä½†æ˜¯å¹¶ä¸è¡¨ç¤ºæ­¤ç´¢å¼•ä¼šçœŸæ­£åœ°è¢« MySQL ä½¿ç”¨åˆ°. MySQL åœ¨æŸ¥è¯¢æ—¶å…·ä½“ä½¿ç”¨äº†å“ªäº›ç´¢å¼•, ç”± key å­—æ®µå†³å®š.\n  key: æ­¤æ¬¡æŸ¥è¯¢ä¸­ç¡®åˆ‡ä½¿ç”¨åˆ°çš„ç´¢å¼•.\n  ref: å“ªä¸ªå­—æ®µæˆ–å¸¸æ•°ä¸ key ä¸€èµ·è¢«ä½¿ç”¨\n  rows: æ˜¾ç¤ºæ­¤æŸ¥è¯¢ä¸€å…±æ‰«æäº†å¤šå°‘è¡Œ. è¿™ä¸ªæ˜¯ä¸€ä¸ªä¼°è®¡å€¼.\nrows ä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦çš„å­—æ®µ. MySQL æŸ¥è¯¢ä¼˜åŒ–å™¨æ ¹æ®ç»Ÿè®¡ä¿¡æ¯, ä¼°ç®— SQL è¦æŸ¥æ‰¾åˆ°ç»“æœé›†éœ€è¦æ‰«æè¯»å–çš„æ•°æ®è¡Œæ•°.\nè¿™ä¸ªå€¼éå¸¸ç›´è§‚æ˜¾ç¤º SQL çš„æ•ˆç‡å¥½å, åŸåˆ™ä¸Š rows è¶Šå°‘è¶Šå¥½.\n  filtered: è¡¨ç¤ºæ­¤æŸ¥è¯¢æ¡ä»¶æ‰€è¿‡æ»¤çš„æ•°æ®çš„ç™¾åˆ†æ¯”\n  extra: é¢å¤–çš„ä¿¡æ¯\n    æ’é™¤ç¼“å­˜å¹²æ‰°(Mysql8.0ä¹‹å‰éœ€è¦éœ€è¦æ’é™¤)\næˆ‘ä»¬åœ¨æ‰§è¡ŒSQLçš„æ—¶å€™ï¼Œè®°å¾—åŠ ä¸ŠSQL NoCacheå»è·‘SQLï¼Œè¿™æ ·è·‘å‡ºæ¥çš„æ—¶é—´å°±æ˜¯çœŸå®çš„æŸ¥è¯¢æ—¶é—´äº†ã€‚\n ä¸ºä»€ä¹ˆç¼“å­˜ä¼šå¤±æ•ˆï¼Œè€Œä¸”æ˜¯ç»å¸¸å¤±æ•ˆï¼Ÿ\nç¼“å­˜å¤±æ•ˆæ¯”è¾ƒé¢‘ç¹çš„åŸå› å°±æ˜¯ï¼Œåªè¦æˆ‘ä»¬ä¸€å¯¹è¡¨è¿›è¡Œæ›´æ–°ï¼Œé‚£è¿™ä¸ªè¡¨æ‰€æœ‰çš„ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºï¼Œå…¶å®æˆ‘ä»¬å¾ˆå°‘å­˜åœ¨ä¸æ›´æ–°çš„è¡¨ã€‚\n   è¦†ç›–ç´¢å¼•\næˆ‘ä»¬åœ¨æ•°æ®åº“æŸ¥è¯¢çš„æ“ä½œä¸­ï¼Œå¯èƒ½æœ‰å›è¡¨çš„æ“ä½œï¼Œæˆ‘ä»¬å¸Œæœ›ä¸è¿›è¡Œå›è¡¨æ“ä½œï¼Œåœ¨è‡ªå·±çš„ç´¢å¼•ä¸Šå°±æŸ¥åˆ°è‡ªå·±æƒ³è¦çš„ï¼Œä¸è¿›è¡Œä¸»é”®ç´¢å¼•æŸ¥æ‰¾ã€‚\nå¦‚æœåœ¨æˆ‘ä»¬å»ºç«‹çš„ç´¢å¼•ä¸Šå°±å·²ç»æœ‰æˆ‘ä»¬éœ€è¦çš„å­—æ®µï¼Œå°±ä¸éœ€è¦å›è¡¨äº†ï¼Œåœ¨ç”µå•†é‡Œé¢ä¹Ÿæ˜¯å¾ˆå¸¸è§çš„ï¼Œæˆ‘ä»¬éœ€è¦å»å•†å“è¡¨é€šè¿‡å„ç§ä¿¡æ¯æŸ¥è¯¢åˆ°å•†å“idï¼Œidä¸€èˆ¬éƒ½æ˜¯ä¸»é”®ï¼Œå¯èƒ½sqlç±»ä¼¼è¿™æ ·ï¼š\n1  select itemId from itemCenter where size between 1 and 6   å› ä¸ºå•†å“id itemIdä¸€èˆ¬éƒ½æ˜¯ä¸»é”®ï¼Œåœ¨sizeç´¢å¼•ä¸Šè‚¯å®šä¼šæœ‰æˆ‘ä»¬è¿™ä¸ªå€¼ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¸éœ€è¦å›ä¸»é”®è¡¨å»æŸ¥è¯¢idä¿¡æ¯äº†ã€‚\nç”±äºè¦†ç›–ç´¢å¼•å¯ä»¥å‡å°‘æ ‘çš„æœç´¢æ¬¡æ•°ï¼Œæ˜¾è‘—æå‡æŸ¥è¯¢æ€§èƒ½ï¼Œæ‰€ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µã€‚\n  è”åˆç´¢å¼•â€”â€”æ„å»ºä¸¤ä¸ªå±æ€§ä¹‹é—´çš„å¿«é€ŸæŸ¥è¯¢\nè¿˜æ˜¯å•†å“è¡¨ä¸¾ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä»–çš„åç§°ï¼Œå»æŸ¥ä»–çš„åº“å­˜ï¼Œå‡è®¾è¿™æ˜¯ä¸€ä¸ªå¾ˆé«˜é¢‘çš„æŸ¥è¯¢è¯·æ±‚ï¼Œä½ ä¼šæ€ä¹ˆå»ºç«‹ç´¢å¼•å‘¢ï¼Ÿ\n æ€è€ƒå›è¡¨çš„æ¶ˆè€—å¯¹SQLè¿›è¡Œä¼˜åŒ–ã€‚\n å»ºç«‹ä¸€ä¸ªï¼Œåç§°å’Œåº“å­˜çš„è”åˆç´¢å¼•ï¼Œè¿™æ ·åç§°æŸ¥å‡ºæ¥å°±å¯ä»¥çœ‹åˆ°åº“å­˜äº†ï¼Œä¸éœ€è¦æŸ¥å‡ºidä¹‹åå»å›è¡¨å†æŸ¥è¯¢åº“å­˜äº†ï¼Œè”åˆç´¢å¼•åœ¨æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯å¸¸è§çš„ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯å¯ä»¥ä¸€ç›´å»ºç«‹çš„ï¼Œå¤§å®¶è¦æ€è€ƒç´¢å¼•å æ®çš„ç©ºé—´ã€‚\n  æœ€å·¦åŒ¹é…åŸåˆ™\nå¦‚æœåˆ©ç”¨ä¸€ä¸ªæ¨¡ç³ŠæŸ¥è¯¢ itemname like â€™æ•–ä¸™%â€˜ï¼Œè¿™æ ·è¿˜æ˜¯èƒ½åˆ©ç”¨åˆ°è¿™ä¸ªç´¢å¼•çš„ï¼Œè€Œä¸”å¦‚æœæœ‰è¿™æ ·çš„è”åˆç´¢å¼•ï¼Œå¤§å®¶ä¹Ÿæ²¡å¿…è¦å»æ–°å»ºä¸€ä¸ªå•†å“åç§°å•ç‹¬çš„ç´¢å¼•äº†ã€‚\n å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ç´¢å¼•å¯èƒ½æ²¡å»ºå¯¹ï¼Œé‚£ä½ è°ƒæ•´ä¸€ä¸‹é¡ºåºï¼Œå¯èƒ½å°±å¯ä»¥ä¼˜åŒ–åˆ°æ•´ä¸ªSQLäº†ã€‚\n   ç´¢å¼•ä¸‹æ¨\nçŸ¥é“äº†å‰ç¼€ç´¢å¼•è§„åˆ™ï¼Œé‚£æˆ‘å°±è¯´ä¸€ä¸ªå®˜æ–¹å¸®æˆ‘ä»¬ä¼˜åŒ–çš„ä¸œè¥¿ï¼Œç´¢å¼•ä¸‹æ¨ã€‚\n1  select * from itemcenter where name like \u0026#39;æ•–%\u0026#39; and size=22 and age = 20;   æ‰€ä»¥è¿™ä¸ªè¯­å¥åœ¨æœç´¢ç´¢å¼•æ ‘çš„æ—¶å€™ï¼Œåªèƒ½ç”¨ â€œæ•–â€ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½•ID1ï¼Œå½“ç„¶ï¼Œè¿™è¿˜ä¸é”™ï¼Œæ€»æ¯”å…¨è¡¨æ‰«æè¦å¥½ã€‚\nç„¶åæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ç´¢å¼•ä¸‹æ¨è¿›è¡Œä¼˜åŒ–ï¼š\nåœ¨MySQL 5.6ä¹‹å‰ï¼Œåªèƒ½ä»ID1å¼€å§‹ä¸€ä¸ªä¸ªå›è¡¨ï¼Œåˆ°ä¸»é”®ç´¢å¼•ä¸Šæ‰¾å‡ºæ•°æ®è¡Œï¼Œå†å¯¹æ¯”å­—æ®µå€¼ã€‚\nè€ŒMySQL 5.6 å¼•å…¥çš„ç´¢å¼•ä¸‹æ¨ä¼˜åŒ–ï¼ˆindex condition pushdown)ï¼Œ å¯ä»¥åœ¨ç´¢å¼•éå†è¿‡ç¨‹ä¸­ï¼Œå¯¹ç´¢å¼•ä¸­åŒ…å«çš„å­—æ®µå…ˆåšåˆ¤æ–­ï¼Œç›´æ¥è¿‡æ»¤æ‰ä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå‡å°‘å›è¡¨æ¬¡æ•°ã€‚\n  å”¯ä¸€ç´¢å¼•æ™®é€šç´¢å¼•é€‰æ‹©\nå½“éœ€è¦æ›´æ–°ä¸€ä¸ªæ•°æ®é¡µæ—¶ï¼Œå¦‚æœæ•°æ®é¡µåœ¨å†…å­˜ä¸­å°±ç›´æ¥æ›´æ–°ï¼Œè€Œå¦‚æœè¿™ä¸ªæ•°æ®é¡µè¿˜æ²¡æœ‰åœ¨å†…å­˜ä¸­çš„è¯ï¼Œåœ¨ä¸å½±å“æ•°æ®ä¸€è‡´æ€§çš„å‰æä¸‹ï¼ŒInooDBä¼šå°†è¿™äº›æ›´æ–°æ“ä½œç¼“å­˜åœ¨change bufferä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä»ç£ç›˜ä¸­è¯»å…¥è¿™ä¸ªæ•°æ®é¡µäº†ã€‚\nåœ¨ä¸‹æ¬¡æŸ¥è¯¢éœ€è¦è®¿é—®è¿™ä¸ªæ•°æ®é¡µçš„æ—¶å€™ï¼Œå°†æ•°æ®é¡µè¯»å…¥å†…å­˜ï¼Œç„¶åæ‰§è¡Œchange bufferä¸­ä¸è¿™ä¸ªé¡µæœ‰å…³çš„æ“ä½œï¼Œé€šè¿‡è¿™ç§æ–¹å¼å°±èƒ½ä¿è¯è¿™ä¸ªæ•°æ®é€»è¾‘çš„æ­£ç¡®æ€§ã€‚\n å°†change bufferä¸­çš„æ“ä½œåº”ç”¨åˆ°åŸæ•°æ®é¡µï¼Œå¾—åˆ°æœ€æ–°ç»“æœçš„è¿‡ç¨‹ç§°ä¸ºmergeã€‚é™¤äº†è®¿é—®è¿™ä¸ªæ•°æ®é¡µä¼šè§¦å‘mergeå¤–ï¼Œç³»ç»Ÿæœ‰åå°çº¿ç¨‹ä¼šå®šæœŸmergeã€‚åœ¨æ•°æ®åº“æ­£å¸¸å…³é—­ï¼ˆshutdownï¼‰çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šæ‰§è¡Œmergeæ“ä½œã€‚\n é‚£ä¹ˆï¼Œä»€ä¹ˆæ¡ä»¶ä¸‹å¯ä»¥ä½¿ç”¨change bufferå‘¢ï¼Ÿ\nå¯¹äºå”¯ä¸€ç´¢å¼•æ¥è¯´ï¼Œæ‰€æœ‰çš„æ›´æ–°æ“ä½œéƒ½è¦å…ˆåˆ¤æ–­è¿™ä¸ªæ“ä½œæ˜¯å¦è¿åå”¯ä¸€æ€§çº¦æŸã€‚\nè¦åˆ¤æ–­è¡¨ä¸­æ˜¯å¦å­˜åœ¨è¿™ä¸ªæ•°æ®ï¼Œè€Œè¿™å¿…é¡»è¦å°†æ•°æ®é¡µè¯»å…¥å†…å­˜æ‰èƒ½åˆ¤æ–­ï¼Œå¦‚æœéƒ½å·²ç»è¯»å…¥åˆ°å†…å­˜äº†ï¼Œé‚£ç›´æ¥æ›´æ–°å†…å­˜ä¼šæ›´å¿«ï¼Œå°±æ²¡å¿…è¦ä½¿ç”¨change bufferäº†ã€‚\nå› æ­¤ï¼Œå”¯ä¸€ç´¢å¼•çš„æ›´æ–°å°±ä¸èƒ½ä½¿ç”¨change bufferï¼Œå®é™…ä¸Šä¹Ÿåªæœ‰æ™®é€šç´¢å¼•å¯ä»¥ä½¿ç”¨ã€‚\nchange bufferç”¨çš„æ˜¯buffer poolé‡Œçš„å†…å­˜ï¼Œå› æ­¤ä¸èƒ½æ— é™å¢å¤§ï¼Œchange bufferçš„å¤§å°ï¼Œå¯ä»¥é€šè¿‡å‚æ•°innodb_change_buffer_max_sizeæ¥åŠ¨æ€è®¾ç½®ï¼Œè¿™ä¸ªå‚æ•°è®¾ç½®ä¸º50çš„æ—¶å€™ï¼Œè¡¨ç¤ºchange bufferçš„å¤§å°æœ€å¤šåªèƒ½å ç”¨buffer poolçš„50%ã€‚\nå°†æ•°æ®ä»ç£ç›˜è¯»å…¥å†…å­˜æ¶‰åŠéšæœºIOçš„è®¿é—®ï¼Œæ˜¯æ•°æ®åº“é‡Œé¢æˆæœ¬æœ€é«˜çš„æ“ä½œä¹‹ä¸€ï¼Œchange bufferå› ä¸ºå‡å°‘äº†éšæœºç£ç›˜è®¿é—®ï¼Œæ‰€ä»¥å¯¹æ›´æ–°æ€§èƒ½çš„æå‡æ˜¯ä¼šå¾ˆæ˜æ˜¾çš„ã€‚\n  å‰ç¼€ç´¢å¼•\næˆ‘ä»¬å­˜åœ¨é‚®ç®±ä½œä¸ºç”¨æˆ·åçš„æƒ…å†µï¼Œæ¯ä¸ªäººçš„é‚®ç®±éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥åœ¨é‚®ç®±ä¸Šå»ºç«‹ç´¢å¼•ï¼Œä½†æ˜¯é‚®ç®±è¿™ä¹ˆé•¿ï¼Œæˆ‘ä»¬æ€ä¹ˆå»å»ºç«‹ç´¢å¼•å‘¢ï¼Ÿ\nMySQLæ˜¯æ”¯æŒå‰ç¼€ç´¢å¼•çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥å®šä¹‰å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ä½œä¸ºç´¢å¼•ã€‚é»˜è®¤åœ°ï¼Œå¦‚æœä½ åˆ›å»ºç´¢å¼•çš„è¯­å¥ä¸æŒ‡å®šå‰ç¼€é•¿åº¦ï¼Œé‚£ä¹ˆç´¢å¼•å°±ä¼šåŒ…å«æ•´ä¸ªå­—ç¬¦ä¸²ã€‚\n  Mysqlå„ç§å¼•æ“å’ŒåŒºåˆ«  MySQLä¸­çš„æ•°æ®ç”¨å„ç§ä¸åŒçš„æŠ€æœ¯å­˜å‚¨åœ¨æ–‡ä»¶ï¼ˆæˆ–è€…å†…å­˜ï¼‰ä¸­ã€‚è¿™äº›æŠ€æœ¯ä¸­çš„æ¯ä¸€ç§æŠ€æœ¯éƒ½ä½¿ç”¨ä¸åŒçš„å­˜å‚¨æœºåˆ¶ã€ç´¢å¼•æŠ€å·§ã€é”å®šæ°´å¹³å¹¶ä¸”æœ€ç»ˆæä¾›å¹¿æ³›çš„ä¸åŒçš„åŠŸèƒ½å’Œèƒ½åŠ›ã€‚é€šè¿‡é€‰æ‹©ä¸åŒçš„æŠ€æœ¯ï¼Œä½ èƒ½å¤Ÿè·å¾—é¢å¤–çš„é€Ÿåº¦æˆ–è€…åŠŸèƒ½ï¼Œä»è€Œæ”¹å–„ä½ çš„åº”ç”¨çš„æ•´ä½“åŠŸèƒ½ã€‚\n MySQLå­˜å‚¨å¼•æ“ä¸»è¦æœ‰ï¼š MyIsamã€InnoDBã€Memoryã€Blackholeã€CSVã€Performance_Schemaã€Archiveã€Federatedã€Mrg_Myisamã€‚\nä½†æ˜¯æœ€å¸¸ç”¨çš„æ˜¯InnoDBå’ŒMylsamã€‚\nInnoDB\nInnoDBæ˜¯ä¸€ä¸ªäº‹åŠ¡å‹çš„å­˜å‚¨å¼•æ“ï¼Œæœ‰è¡Œçº§é”å®šå’Œå¤–é”®çº¦æŸã€‚\nInnodbå¼•æ“æä¾›äº†å¯¹æ•°æ®åº“ACIDäº‹åŠ¡çš„æ”¯æŒï¼Œå¹¶ä¸”å®ç°äº†SQLæ ‡å‡†çš„å››ç§éš”ç¦»çº§åˆ«ï¼Œå…³äºæ•°æ®åº“äº‹åŠ¡ä¸å…¶éš”ç¦»çº§åˆ«çš„å†…å®¹è¯·è§æ•°æ®åº“äº‹åŠ¡ä¸å…¶éš”ç¦»çº§åˆ«è¿™ç±»å‹çš„æ–‡ç« ã€‚è¯¥å¼•æ“è¿˜æä¾›äº†è¡Œçº§é”å’Œå¤–é”®çº¦æŸï¼Œå®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯å¤„ç†å¤§å®¹é‡æ•°æ®åº“ç³»ç»Ÿï¼Œå®ƒæœ¬èº«å…¶å®å°±æ˜¯åŸºäºMySQLåå°çš„å®Œæ•´æ•°æ®åº“ç³»ç»Ÿï¼ŒMySQLè¿è¡Œæ—¶Innodbä¼šåœ¨å†…å­˜ä¸­å»ºç«‹ç¼“å†²æ± ï¼Œç”¨äºç¼“å†²æ•°æ®å’Œç´¢å¼•ã€‚ä½†æ˜¯è¯¥å¼•æ“ä¸æ”¯æŒFULLTEXTç±»å‹çš„ç´¢å¼•ï¼Œè€Œä¸”å®ƒæ²¡æœ‰ä¿å­˜è¡¨çš„è¡Œæ•°ï¼Œå½“SELECT COUNT(*) FROM TABLEæ—¶éœ€è¦æ‰«æå…¨è¡¨ã€‚å½“éœ€è¦ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡æ—¶ï¼Œè¯¥å¼•æ“å½“ç„¶æ˜¯é¦–é€‰ã€‚ç”±äºé”çš„ç²’åº¦æ›´å°ï¼Œå†™æ“ä½œä¸ä¼šé”å®šå…¨è¡¨ï¼Œæ‰€ä»¥åœ¨å¹¶å‘è¾ƒé«˜æ—¶ï¼Œä½¿ç”¨Innodbå¼•æ“ä¼šæå‡æ•ˆç‡ã€‚ä½†æ˜¯ä½¿ç”¨è¡Œçº§é”ä¹Ÿä¸æ˜¯ç»å¯¹çš„ï¼Œå¦‚æœåœ¨æ‰§è¡Œä¸€ä¸ªSQLè¯­å¥æ—¶MySQLä¸èƒ½ç¡®å®šè¦æ‰«æçš„èŒƒå›´ï¼ŒInnoDBè¡¨åŒæ ·ä¼šé”å…¨è¡¨ã€‚\n é€‚ç”¨åœºæ™¯ï¼š\nç»å¸¸æ›´æ–°çš„è¡¨ï¼Œé€‚åˆå¤„ç†å¤šé‡å¹¶å‘çš„æ›´æ–°è¯·æ±‚ã€‚\n ç´¢å¼•ç»“æ„ï¼šInnoDBæ˜¯B+Treeeç´¢å¼•ç»“æ„ã€‚å¹¶ä¸”Innodbçš„ç´¢å¼•æ–‡ä»¶æœ¬èº«å°±æ˜¯æ•°æ®æ–‡ä»¶ï¼Œå³B+Treeçš„æ•°æ®åŸŸå­˜å‚¨çš„å°±æ˜¯å®é™…çš„æ•°æ®ï¼Œè¿™ç§ç´¢å¼•å°±æ˜¯èšé›†ç´¢å¼•ã€‚\n InnoDBçš„è¾…åŠ©ç´¢å¼•æ•°æ®åŸŸå­˜å‚¨çš„ä¹Ÿæ˜¯ç›¸åº”è®°å½•ä¸»é”®çš„å€¼è€Œä¸æ˜¯åœ°å€ï¼Œæ‰€ä»¥å½“ä»¥è¾…åŠ©ç´¢å¼•æŸ¥æ‰¾æ—¶ï¼Œä¼šå…ˆæ ¹æ®è¾…åŠ©ç´¢å¼•æ‰¾åˆ°ä¸»é”®ï¼Œå†æ ¹æ®ä¸»é”®ç´¢å¼•æ‰¾åˆ°å®é™…çš„æ•°æ®ã€‚æ‰€ä»¥Innodbä¸å»ºè®®ä½¿ç”¨è¿‡é•¿çš„ä¸»é”®ï¼Œå¦åˆ™ä¼šä½¿è¾…åŠ©ç´¢å¼•å˜å¾—è¿‡å¤§ã€‚å»ºè®®ä½¿ç”¨è‡ªå¢çš„å­—æ®µä½œä¸ºä¸»é”®ï¼Œè¿™æ ·B+Treeçš„æ¯ä¸€ä¸ªç»“ç‚¹éƒ½ä¼šè¢«é¡ºåºçš„å¡«æ»¡ï¼Œè€Œä¸ä¼šé¢‘ç¹çš„åˆ†è£‚è°ƒæ•´ï¼Œä¼šæœ‰æ•ˆçš„æå‡æ’å…¥æ•°æ®çš„æ•ˆç‡ã€‚\n Mylsam\nMyIASMæ˜¯MySQLé»˜è®¤çš„å¼•æ“ï¼Œä½†æ˜¯å®ƒæ²¡æœ‰æä¾›å¯¹æ•°æ®åº“äº‹åŠ¡çš„æ”¯æŒï¼Œä¹Ÿä¸æ”¯æŒè¡Œçº§é”å’Œå¤–é”®ï¼Œå› æ­¤å½“INSERTæˆ–UPDATEæ•°æ®æ—¶å³å†™æ“ä½œéœ€è¦é”å®šæ•´ä¸ªè¡¨ï¼Œæ•ˆç‡ä¾¿ä¼šä½ä¸€äº›ã€‚MyIsam å­˜å‚¨å¼•æ“ç‹¬ç«‹äºæ“ä½œç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åœ¨windowsä¸Šä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥æ¯”è¾ƒç®€å•çš„å°†æ•°æ®è½¬ç§»åˆ°linuxæ“ä½œç³»ç»Ÿä¸Šå»ã€‚\n é€‚ç”¨åœºæ™¯ï¼š\nä¸æ”¯æŒäº‹åŠ¡çš„è®¾è®¡ï¼Œä½†æ˜¯å¹¶ä¸ä»£è¡¨ç€æœ‰äº‹åŠ¡æ“ä½œçš„é¡¹ç›®ä¸èƒ½ç”¨MyIsamå­˜å‚¨å¼•æ“ï¼Œå¯ä»¥åœ¨serviceå±‚è¿›è¡Œæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡éœ€æ±‚è¿›è¡Œç›¸åº”çš„æ§åˆ¶ã€‚\nä¸æ”¯æŒå¤–é”®çš„è¡¨è®¾è®¡ã€‚\næŸ¥è¯¢é€Ÿåº¦å¾ˆå¿«ï¼Œå¦‚æœæ•°æ®åº“insertå’Œupdateçš„æ“ä½œæ¯”è¾ƒå¤šçš„è¯æ¯”è¾ƒé€‚ç”¨ã€‚\næ•´å¤©å¯¹è¡¨è¿›è¡ŒåŠ é”çš„åœºæ™¯ã€‚\nMyISAMæåº¦å¼ºè°ƒå¿«é€Ÿè¯»å–æ“ä½œã€‚\n ç´¢å¼•ç»“æ„ï¼šMyISAMç´¢å¼•ç”¨çš„B+ treeæ¥å‚¨å­˜æ•°æ®ï¼ŒMyISAMç´¢å¼•çš„æŒ‡é’ˆæŒ‡å‘çš„æ˜¯é”®å€¼çš„åœ°å€ï¼Œåœ°å€å­˜å‚¨çš„æ˜¯æ•°æ®ã€‚B+Treeçš„æ•°æ®åŸŸå­˜å‚¨çš„å†…å®¹ä¸ºå®é™…æ•°æ®çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒçš„ç´¢å¼•å’Œå®é™…çš„æ•°æ®æ˜¯åˆ†å¼€çš„ï¼Œåªä¸è¿‡æ˜¯ç”¨ç´¢å¼•æŒ‡å‘äº†å®é™…çš„æ•°æ®ï¼Œè¿™ç§ç´¢å¼•å°±æ˜¯æ‰€è°“çš„éèšé›†ç´¢å¼•ã€‚\nInnoDBå’ŒMyISAMçš„åŒºåˆ«\n  äº‹åŠ¡ï¼šMyISAMç±»å‹ä¸æ”¯æŒäº‹åŠ¡å¤„ç†ç­‰é«˜çº§å¤„ç†ï¼Œè€ŒInnoDBç±»å‹æ”¯æŒï¼Œæä¾›äº‹åŠ¡æ”¯æŒå·²ç»å¤–éƒ¨é”®ç­‰é«˜çº§æ•°æ®åº“åŠŸèƒ½\n  æ€§èƒ½ï¼šMyISAMç±»å‹çš„è¡¨å¼ºè°ƒçš„æ˜¯æ€§èƒ½ï¼Œå…¶æ‰§è¡Œæ•°åº¦æ¯”InnoDBç±»å‹æ›´å¿«ã€‚\n  è¡Œæ•°ä¿å­˜ï¼šInnoDB ä¸­ä¸ä¿å­˜è¡¨çš„å…·ä½“è¡Œæ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰§è¡Œselect count() fromtableæ—¶ï¼ŒInnoDBè¦æ‰«æä¸€éæ•´ä¸ªè¡¨æ¥è®¡ç®—æœ‰å¤šå°‘è¡Œï¼Œä½†æ˜¯MyISAMåªè¦ç®€å•çš„è¯»å‡ºä¿å­˜å¥½çš„è¡Œæ•°å³å¯ã€‚æ³¨æ„çš„æ˜¯ï¼Œå½“count()è¯­å¥åŒ…å«whereæ¡ä»¶æ—¶ï¼Œä¸¤ç§è¡¨çš„æ“ä½œæ˜¯ä¸€æ ·çš„ã€‚\n  ç´¢å¼•å­˜å‚¨ï¼šå¯¹äºAUTO_INCREMENTç±»å‹çš„å­—æ®µï¼ŒInnoDBä¸­å¿…é¡»åŒ…å«åªæœ‰è¯¥å­—æ®µçš„ç´¢å¼•ï¼Œä½†æ˜¯åœ¨MyISAMè¡¨ä¸­ï¼Œå¯ä»¥å’Œå…¶ä»–å­—æ®µä¸€èµ·å»ºç«‹è”åˆç´¢å¼•ã€‚MyISAMæ”¯æŒå…¨æ–‡ç´¢å¼•ï¼ˆFULLTEXTï¼‰ã€å‹ç¼©ç´¢å¼•ï¼ŒInnoDBä¸æ”¯æŒã€‚\nMyISAMçš„ç´¢å¼•å’Œæ•°æ®æ˜¯åˆ†å¼€çš„ï¼Œå¹¶ä¸”ç´¢å¼•æ˜¯æœ‰å‹ç¼©çš„ï¼Œå†…å­˜ä½¿ç”¨ç‡å°±å¯¹åº”æé«˜äº†ä¸å°‘ã€‚èƒ½åŠ è½½æ›´å¤šç´¢å¼•ï¼Œè€ŒInnodbæ˜¯ç´¢å¼•å’Œæ•°æ®æ˜¯ç´§å¯†æ†ç»‘çš„ï¼Œæ²¡æœ‰ä½¿ç”¨å‹ç¼©ä»è€Œä¼šé€ æˆInnodbæ¯”MyISAMä½“ç§¯åºå¤§ä¸å°ã€‚\nInnoDBå­˜å‚¨å¼•æ“è¢«å®Œå…¨ä¸MySQLæœåŠ¡å™¨æ•´åˆï¼ŒInnoDBå­˜å‚¨å¼•æ“ä¸ºåœ¨ä¸»å†…å­˜ä¸­ç¼“å­˜æ•°æ®å’Œç´¢å¼•è€Œç»´æŒå®ƒè‡ªå·±çš„ç¼“å†²æ± ã€‚InnoDBå­˜å‚¨å®ƒçš„è¡¨ï¼†ç´¢å¼•åœ¨ä¸€ä¸ªè¡¨ç©ºé—´ä¸­ï¼Œè¡¨ç©ºé—´å¯ä»¥åŒ…å«æ•°ä¸ªæ–‡ä»¶ï¼ˆæˆ–åŸå§‹ç£ç›˜åˆ†åŒºï¼‰ã€‚è¿™ä¸MyISAMè¡¨ä¸åŒï¼Œæ¯”å¦‚åœ¨MyISAMè¡¨ä¸­æ¯ä¸ªè¡¨è¢«å­˜åœ¨åˆ†ç¦»çš„æ–‡ä»¶ä¸­ã€‚InnoDB è¡¨å¯ä»¥æ˜¯ä»»ä½•å°ºå¯¸ï¼Œå³ä½¿åœ¨æ–‡ä»¶å°ºå¯¸è¢«é™åˆ¶ä¸º2GBçš„æ“ä½œç³»ç»Ÿä¸Šã€‚\n  æœåŠ¡å™¨æ•°æ®å¤‡ä»½ï¼šInnoDBå¿…é¡»å¯¼å‡ºSQLæ¥å¤‡ä»½ï¼ŒLOAD TABLE FROM MASTERæ“ä½œå¯¹InnoDBæ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œè§£å†³æ–¹æ³•æ˜¯é¦–å…ˆæŠŠInnoDBè¡¨æ”¹æˆMyISAMè¡¨ï¼Œå¯¼å…¥æ•°æ®åå†æ”¹æˆInnoDBè¡¨ï¼Œä½†æ˜¯å¯¹äºä½¿ç”¨çš„é¢å¤–çš„InnoDBç‰¹æ€§(ä¾‹å¦‚å¤–é”®)çš„è¡¨ä¸é€‚ç”¨ã€‚\nMyISAMåº”å¯¹é”™è¯¯ç¼–ç å¯¼è‡´çš„æ•°æ®æ¢å¤é€Ÿåº¦å¿«ã€‚MyISAMçš„æ•°æ®æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜å‚¨ï¼Œæ‰€ä»¥åœ¨è·¨å¹³å°çš„æ•°æ®è½¬ç§»ä¸­ä¼šå¾ˆæ–¹ä¾¿ã€‚åœ¨å¤‡ä»½å’Œæ¢å¤æ—¶å¯å•ç‹¬é’ˆå¯¹æŸä¸ªè¡¨è¿›è¡Œæ“ä½œã€‚\nInnoDBæ˜¯æ‹·è´æ•°æ®æ–‡ä»¶ã€å¤‡ä»½ binlogï¼Œæˆ–è€…ç”¨ mysqldumpï¼Œåœ¨æ•°æ®é‡è¾¾åˆ°å‡ åGçš„æ—¶å€™å°±ç›¸å¯¹ç—›è‹¦äº†ã€‚\n  é”çš„æ”¯æŒï¼šMyISAMåªæ”¯æŒè¡¨é”ã€‚InnoDBæ”¯æŒè¡¨é”ã€è¡Œé” è¡Œé”å¤§å¹…åº¦æé«˜äº†å¤šç”¨æˆ·å¹¶å‘æ“ä½œçš„æ–°èƒ½ã€‚ä½†æ˜¯InnoDBçš„è¡Œé”ï¼Œåªæ˜¯åœ¨WHEREçš„ä¸»é”®æ˜¯æœ‰æ•ˆçš„ï¼Œéä¸»é”®çš„WHEREéƒ½ä¼šé”å…¨è¡¨çš„ã€‚\n  å‚è€ƒé“¾æ¥ï¼š\n æœ‰å“ªäº›å¸¸è§çš„æ•°æ®åº“ä¼˜åŒ–æ–¹æ³•ï¼Ÿ MySQL æ€§èƒ½ä¼˜åŒ–ç¥å™¨ Explain ä½¿ç”¨åˆ†æ  ","description":"","id":65,"section":"talks","tags":[""],"title":"Database Talk","uri":"https://hugo.jiahongw.com/zh/talks/database-talk/"},{"content":"546. ç§»é™¤ç›’å­ ç»™å‡ºä¸€äº›ä¸åŒé¢œè‰²çš„ç›’å­ï¼Œç›’å­çš„é¢œè‰²ç”±æ•°å­—è¡¨ç¤ºï¼Œå³ä¸åŒçš„æ•°å­—è¡¨ç¤ºä¸åŒçš„é¢œè‰²ã€‚\nä½ å°†ç»è¿‡è‹¥å¹²è½®æ“ä½œå»å»æ‰ç›’å­ï¼Œç›´åˆ°æ‰€æœ‰çš„ç›’å­éƒ½å»æ‰ä¸ºæ­¢ã€‚æ¯ä¸€è½®ä½ å¯ä»¥ç§»é™¤å…·æœ‰ç›¸åŒé¢œè‰²çš„è¿ç»­ k ä¸ªç›’å­ï¼ˆk \u0026gt;= 1ï¼‰ï¼Œè¿™æ ·ä¸€è½®ä¹‹åä½ å°†å¾—åˆ° k*k ä¸ªç§¯åˆ†ã€‚\nå½“ä½ å°†æ‰€æœ‰ç›’å­éƒ½å»æ‰ä¹‹åï¼Œæ±‚ä½ èƒ½è·å¾—çš„æœ€å¤§ç§¯åˆ†å’Œã€‚\nç¤ºä¾‹ï¼š\nè¾“å…¥ï¼šboxes = [1,3,2,2,2,3,4,3,1] è¾“å‡ºï¼š23 è§£é‡Šï¼š [1, 3, 2, 2, 2, 3, 4, 3, 1] ----\u0026gt; [1, 3, 3, 4, 3, 1] (3*3=9 åˆ†) ----\u0026gt; [1, 3, 3, 3, 1] (1*1=1 åˆ†) ----\u0026gt; [1, 1] (3*3=9 åˆ†) ----\u0026gt; [] (2*2=4 åˆ†) æç¤ºï¼š\n 1 \u0026lt;= boxes.length \u0026lt;= 100 1 \u0026lt;= boxes[i] \u0026lt;= 100  åˆ†æ ä¸€èˆ¬æ¥è¯´ï¼Œæ±‚æœ€å€¼çš„é—®é¢˜å‡ ä¹å’ŒåŠ¨æ€è§„åˆ’æœ‰å…³ç³»ï¼Œé‚£ä¹ˆè¿™é¢˜ä¹Ÿæ˜¯ä»åŠ¨æ€è§„åˆ’çš„è§’åº¦å»æ€è€ƒè§£å†³æ–¹æ¡ˆã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  class Solution { int len; int removeBoxes(vector\u0026lt;int\u0026gt;\u0026amp; boxes,int i,int j,int k,vector\u0026lt;vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;\u0026gt;\u0026amp; dp) { if(i \u0026gt; j) return 0; if(dp[i][j][k] \u0026gt; 0) return dp[i][j][k]; for(;i+1 \u0026lt;= j \u0026amp;\u0026amp; boxes[i+1] == boxes[i];++i,++k); int res = (k+1) * (k+1) + removeBoxes(boxes,i+1,j,0,dp); for(int m = i + 1;m \u0026lt;= j;++m) if(boxes[m] == boxes[i]) res = max(res,removeBoxes(boxes,i+1,m-1,0,dp) + removeBoxes(boxes,m,j,k+1,dp)); return dp[i][j][k] = res; } public: int removeBoxes(vector\u0026lt;int\u0026gt;\u0026amp; boxes) { len = boxes.size(); // dp[i][j][k] è¡¨ç¤ºä»iåˆ°jçš„èŒƒå›´æœ‰kä¸ªç›¸åŒé¢œè‰²çš„æ•°å­—åœ¨içš„å‰é¢ï¼Œå¹¶ä¸”ä¸‹æ ‡içš„é¢œè‰²ä¹Ÿä¸å®ƒä»¬ç›¸åŒ  vector\u0026lt;vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;\u0026gt; dp(len+1,vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;(len+1,vector\u0026lt;int\u0026gt;(len+1,0))); return removeBoxes(boxes,0,len-1,0,dp); } };   5490. åƒæ‰ N ä¸ªæ©˜å­çš„æœ€å°‘å¤©æ•° å¨æˆ¿é‡Œæ€»å…±æœ‰ n ä¸ªæ©˜å­ï¼Œä½ å†³å®šæ¯ä¸€å¤©é€‰æ‹©å¦‚ä¸‹æ–¹å¼ä¹‹ä¸€åƒè¿™äº›æ©˜å­ï¼š\n åƒæ‰ä¸€ä¸ªæ©˜å­ã€‚ å¦‚æœå‰©ä½™æ©˜å­æ•° n èƒ½è¢« 2 æ•´é™¤ï¼Œé‚£ä¹ˆä½ å¯ä»¥åƒæ‰ n/2 ä¸ªæ©˜å­ã€‚ å¦‚æœå‰©ä½™æ©˜å­æ•° n èƒ½è¢« 3 æ•´é™¤ï¼Œé‚£ä¹ˆä½ å¯ä»¥åƒæ‰ 2*(n/3) ä¸ªæ©˜å­ã€‚  æ¯å¤©ä½ åªèƒ½ä»ä»¥ä¸Š 3 ç§æ–¹æ¡ˆä¸­é€‰æ‹©ä¸€ç§æ–¹æ¡ˆã€‚\nè¯·ä½ è¿”å›åƒæ‰æ‰€æœ‰ n ä¸ªæ©˜å­çš„æœ€å°‘å¤©æ•°ã€‚\nç¤ºä¾‹ 1ï¼š\nè¾“å…¥ï¼šn = 10 è¾“å‡ºï¼š4 è§£é‡Šï¼šä½ æ€»å…±æœ‰ 10 ä¸ªæ©˜å­ã€‚ ç¬¬ 1 å¤©ï¼šåƒ 1 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 10 - 1 = 9ã€‚ ç¬¬ 2 å¤©ï¼šåƒ 6 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 9 - 2*(9/3) = 9 - 6 = 3ã€‚ï¼ˆ9 å¯ä»¥è¢« 3 æ•´é™¤ï¼‰ ç¬¬ 3 å¤©ï¼šåƒ 2 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 3 - 2*(3/3) = 3 - 2 = 1ã€‚ ç¬¬ 4 å¤©ï¼šåƒæ‰æœ€å 1 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 1 - 1 = 0ã€‚ ä½ éœ€è¦è‡³å°‘ 4 å¤©åƒæ‰ 10 ä¸ªæ©˜å­ã€‚ ç¤ºä¾‹ 2ï¼š\nè¾“å…¥ï¼šn = 6 è¾“å‡ºï¼š3 è§£é‡Šï¼šä½ æ€»å…±æœ‰ 6 ä¸ªæ©˜å­ã€‚ ç¬¬ 1 å¤©ï¼šåƒ 3 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 6 - 6/2 = 6 - 3 = 3ã€‚ï¼ˆ6 å¯ä»¥è¢« 2 æ•´é™¤ï¼‰ ç¬¬ 2 å¤©ï¼šåƒ 2 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 3 - 2*(3/3) = 3 - 2 = 1ã€‚ï¼ˆ3 å¯ä»¥è¢« 3 æ•´é™¤ï¼‰ ç¬¬ 3 å¤©ï¼šåƒæ‰å‰©ä½™ 1 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 1 - 1 = 0ã€‚ ä½ è‡³å°‘éœ€è¦ 3 å¤©åƒæ‰ 6 ä¸ªæ©˜å­ã€‚ ç¤ºä¾‹ 3ï¼š\nè¾“å…¥ï¼šn = 1 è¾“å‡ºï¼š1 ç¤ºä¾‹ 4ï¼š\nè¾“å…¥ï¼šn = 56 è¾“å‡ºï¼š6 æç¤ºï¼š\n 1 \u0026lt;= n \u0026lt;= 2*10^9  åˆ†æ æ•´ä¸ªé—®é¢˜å°±æ˜¯ä¸€ä¸ªæ±‚æœ€å€¼çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨é€’å½’è¿›è¡Œæ·±åº¦ä¼˜å…ˆåˆ¤æ–­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’å»ºç«‹ä¸€ä¸ªdpæ•°ç»„è¿›è¡Œæ±‚è§£ï¼š\nä»£ç  é€’å½’æ±‚è§£(è¶…æ—¶)ï¼š\n1 2 3 4 5 6 7 8 9  int solve(int n) { if(n == 0) return 0; if(n == 1) return 1; int r1 = minDays(n - 1); int r2 = n%2==0? minDays(n - n/2):INT_MAX; int r3 = n%3==0? minDays(n -2*(n/3)):INT_MAX; return min(min(r1,r2),r3) + 1; }   åŠ ä¸Šå“ˆå¸Œè¡¨(å †æ ˆæº¢å‡º)ï¼š\n1 2 3 4 5 6 7 8 9 10 11  unordered_map\u0026lt;int,int\u0026gt; table; int solve(int n) { if(n == 0) return 0; if(n == 1) return 1; if(table.find(n) != table.end()) return table[n]; int r1 = minDays(n - 1); int r2 = n%2==0? minDays(n - n/2):INT_MAX; int r3 = n%3==0? minDays(n -2*(n/3)):INT_MAX; return table[n] = min(min(r1,r2),r3) + 1; }   åŠ¨æ€è§„åˆ’(è¶…å‡ºæ—¶é—´é™åˆ¶)ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  int minDays(int n) { vector\u0026lt;int\u0026gt; dp(n+1,0); for(int i = 1;i \u0026lt;= n;++i) { if(i % 6 == 0) { dp[i] = min(min(dp[i - 2*(i/3)],dp[i-1]),dp[i - i/2]) + 1; } else if(i % 2 == 0) dp[i] = min(dp[i - i/2],dp[i-1]) + 1; else if(i % 3 == 0) dp[i] = min(dp[i - 2*(i/3)],dp[i-1]) + 1; else dp[i] = dp[i-1] + 1; } return dp[n]; }   ç¦»æ•£åŒ–é€’å½’ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  class Solution { unordered_map\u0026lt;int,int\u0026gt; table; int solve(int n) { if(n == 0 || n == 1) return n; if(table.find(n) != table.end()) return table[n]; table[n] = min((n\u0026amp;1) + solve(n/2),(n%3) + solve(n/3))+1; return table[n]; } public: int minDays(int n) { return solve(n); } };   743. ç½‘ç»œå»¶è¿Ÿæ—¶é—´ æœ‰ N ä¸ªç½‘ç»œèŠ‚ç‚¹ï¼Œæ ‡è®°ä¸º 1 åˆ° Nã€‚\nç»™å®šä¸€ä¸ªåˆ—è¡¨ timesï¼Œè¡¨ç¤ºä¿¡å·ç»è¿‡æœ‰å‘è¾¹çš„ä¼ é€’æ—¶é—´ã€‚ times[i] = (u, v, w)ï¼Œå…¶ä¸­ u æ˜¯æºèŠ‚ç‚¹ï¼Œv æ˜¯ç›®æ ‡èŠ‚ç‚¹ï¼Œ w æ˜¯ä¸€ä¸ªä¿¡å·ä»æºèŠ‚ç‚¹ä¼ é€’åˆ°ç›®æ ‡èŠ‚ç‚¹çš„æ—¶é—´ã€‚\nç°åœ¨ï¼Œæˆ‘ä»¬ä»æŸä¸ªèŠ‚ç‚¹ K å‘å‡ºä¸€ä¸ªä¿¡å·ã€‚éœ€è¦å¤šä¹…æ‰èƒ½ä½¿æ‰€æœ‰èŠ‚ç‚¹éƒ½æ”¶åˆ°ä¿¡å·ï¼Ÿå¦‚æœä¸èƒ½ä½¿æ‰€æœ‰èŠ‚ç‚¹æ”¶åˆ°ä¿¡å·ï¼Œè¿”å› -1ã€‚\nç¤ºä¾‹ï¼š\nè¾“å…¥ï¼štimes = [[2,1,1],[2,3,1],[3,4,1]], N = 4, K = 2 è¾“å‡ºï¼š2 æ³¨æ„:\n N çš„èŒƒå›´åœ¨ [1, 100] ä¹‹é—´ã€‚ K çš„èŒƒå›´åœ¨ [1, N] ä¹‹é—´ã€‚ times çš„é•¿åº¦åœ¨ [1, 6000] ä¹‹é—´ã€‚ æ‰€æœ‰çš„è¾¹ times[i] = (u, v, w) éƒ½æœ‰ 1 \u0026lt;= u, v \u0026lt;= N ä¸” 0 \u0026lt;= w \u0026lt;= 100ã€‚  åˆ†æ æœ¬é¢˜ä¸ºä¸€ä¸ªå›¾ç®—æ³•é¢˜ï¼Œä¸¤ç‚¹ä¹‹é—´çš„æ—¶é—´å¯ä»¥æŠ½è±¡æˆè·¯ç¨‹ï¼Œé‚£ä¹ˆæœ¬é¢˜ç›¸å½“äºæ±‚æŸä¸€ç‚¹åˆ°å…¶ä»–å„ç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œç„¶åæ±‚å‡ºå„ç‚¹æœ€çŸ­è·¯å¾„çš„æœ€å¤§å€¼ã€‚\nå¸¸è§çš„æœ€çŸ­è·¯é—®é¢˜åˆ†ä¸ºä¸¤ç±»ï¼šå•æºæœ€çŸ­è·¯å’Œå¤šæºæœ€çŸ­è·¯ã€‚å‰è€…åªéœ€è¦æ±‚ä¸€ä¸ªå›ºå®šçš„èµ·ç‚¹åˆ°å„ä¸ªé¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œåè€…åˆ™è¦æ±‚å¾—å‡ºä»»æ„ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ã€‚\nDijkstraç®—æ³• Dijkstra(è¿ªæ°æ–¯ç‰¹æ‹‰)ç®—æ³•æ˜¯å…¸å‹çš„å•æºæœ€çŸ­è·¯å¾„ç®—æ³•ï¼Œç”¨äºè®¡ç®—ä¸€ä¸ªèŠ‚ç‚¹åˆ°å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚ä¸»è¦ç‰¹ç‚¹æ˜¯ä»¥èµ·å§‹ç‚¹ä¸ºä¸­å¿ƒå‘å¤–å±‚å±‚æ‰©å±•ï¼Œç›´åˆ°æ‰©å±•åˆ°ç»ˆç‚¹ä¸ºæ­¢ã€‚ç®—æ³•ä¸»è¦çš„æ€æƒ³æ˜¯è´ªå¿ƒæ³•ã€‚\né€‚ç”¨èŒƒå›´\n 1ã€ä¸èƒ½å¤„ç†è´Ÿæƒè¾¹æˆ–ç¯ 2ã€å¯ä»¥å¤„ç†æ­£æƒè¾¹ 3ã€å¯ä»¥å¤„ç†æ— å‘å›¾å’Œæœ‰å‘å›¾  ä½¿ç”¨æ­¥éª¤\n åˆå§‹åŒ–é‚»æ¥çŸ©é˜µ åˆå§‹åŒ–è¿˜æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹åˆ—è¡¨ åŒé‡å¾ªç¯ï¼š\næœ€å¤–å±‚ä¸ºé™¤æºç‚¹ä¹‹å¤–çš„å…¶ä»–èŠ‚ç‚¹çš„éå†\né‡Œé¢ä¸ºéå†å’Œæ›´æ–°æœªç¡®å®šè·ç¦»çš„èŠ‚ç‚¹åˆ—è¡¨çš„éå†\n3.1ã€ä»è¿˜æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹åˆ—è¡¨ä¸­æ‰¾å‡ºè·ç¦»æºç‚¹æœ€è¿‘çš„èŠ‚ç‚¹\n3.2ã€æ›´æ–°è¿˜æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹åˆ—è¡¨\n3.3ã€æ ¹æ®æ‰¾åˆ°çš„è¿™ä¸ªæœ€çŸ­è·¯å¾„èŠ‚ç‚¹ï¼Œæ›´æ–°æ¯ä¸€ä¸ªè¿˜æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹åˆ°æºç‚¹çš„è·ç¦» æ ¹æ®é¢˜ç›®è¦æ±‚è®¡ç®—ç»“æœ  Floydç®—æ³• Floydç®—æ³•æ˜¯ä¸€ä¸ªç»å…¸çš„åŠ¨æ€è§„åˆ’ç®—æ³•ã€‚æ˜¯è§£å†³ä»»æ„ä¸¤ç‚¹é—´çš„æœ€çŸ­è·¯å¾„(ç§°ä¸ºå¤šæºæœ€çŸ­è·¯å¾„é—®é¢˜)çš„ä¸€ç§ç®—æ³•ï¼Œå¯ä»¥æ­£ç¡®å¤„ç†æœ‰å‘å›¾æˆ–è´Ÿæƒçš„æœ€çŸ­è·¯å¾„é—®é¢˜ã€‚\nå…¶æ ¸å¿ƒæ€æƒ³å°±æ˜¯ä»ä»»æ„èŠ‚ç‚¹uåˆ°ä»»æ„èŠ‚ç‚¹vçš„æœ€çŸ­è·¯å¾„æœ‰2ç§ï¼š\n æ˜¯ç›´æ¥ä»uåˆ°v æ˜¯ä»uç»è¿‡è‹¥å¹²ä¸ªèŠ‚ç‚¹kåˆ°v  æ‰€ä»¥ï¼Œæˆ‘ä»¬å‡è®¾graph(u,v)ä¸ºèŠ‚ç‚¹uåˆ°èŠ‚ç‚¹vçš„æœ€çŸ­è·¯å¾„çš„è·ç¦»(å½“ç„¶ï¼Œä¸åŒçš„é¢˜ç›®ä»£è¡¨çš„ä¸ä¸€æ ·ï¼Œæ¯”å¦‚æœ‰çš„å¯èƒ½æ˜¯èŠ±è´¹ï¼Œéœ€è¦çµæ´»å˜é€š)ï¼Œå¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹k(1~Nä¸ªèŠ‚ç‚¹)ï¼Œæˆ‘ä»¬æ£€æŸ¥graph(u,k) + graph(k,v) \u0026lt; graph(u,v)æ˜¯å¦æˆç«‹ï¼Œå¦‚æœæˆç«‹ï¼Œè¯æ˜ä»uåˆ°kå†åˆ°vçš„è·¯å¾„æ¯”uç›´æ¥åˆ°vçš„è·¯å¾„çŸ­ï¼Œæˆ‘ä»¬ä¾¿è®¾ç½®graph(u,v) = graph(u,k) + graph(k,v)ï¼Œå½“æˆ‘ä»¬éå†å®Œæ‰€æœ‰èŠ‚ç‚¹kï¼Œgraph(u,v)ä¸­è®°å½•çš„ä¾¿æ˜¯uåˆ°vçš„æœ€çŸ­è·¯å¾„çš„è·ç¦»ã€‚\né€‚ç”¨èŒƒå›´\n 1ã€å¯ä»¥å¤„ç†è´Ÿæƒè¾¹ 2ã€ä¸èƒ½å¤„ç†è´Ÿæƒç¯ 3ã€å¯ä»¥å¤„ç†æ— å‘å›¾å’Œæœ‰å‘å›¾  ä½¿ç”¨æ­¥éª¤\n  åˆå§‹åŒ–é‚»æ¥çŸ©é˜µ\n  ä¸‰é‡å¾ªç¯ï¼š\n æœ€å¤–å±‚ä¸ºä¸­é—´èŠ‚ç‚¹kçš„éå†\né‡Œé¢ä¸¤å±‚åˆ†åˆ«ä¸ºèŠ‚ç‚¹uå’ŒèŠ‚ç‚¹vçš„éå†\n 2.1ã€æ ¹æ®kä¸ºä¸­é—´è·³èŠ‚ç‚¹æ›´æ–°(u, v)çš„æœ€çŸ­è·ç¦»\n  æ ¹æ®é¢˜ç›®è¦æ±‚è®¡ç®—ç»“æœ\n  ä»£ç  Dijkstraç®—æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  class Solution { public: int networkDelayTime(vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;\u0026amp; times, int N, int K) { const int INF = 102; vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; graph(N+1,vector\u0026lt;int\u0026gt;(N+1,INF)); for(auto\u0026amp; v:times) graph[v[0]][v[1]] = v[2]; vector\u0026lt;int\u0026gt; dist(N + 1,INF); vector\u0026lt;bool\u0026gt; st(N + 1,false); // è®¾ç½®èµ·å§‹ç‚¹  dist[K] = 0; for(int i = 1;i \u0026lt; N;++i) // å¤–å±‚å¾ªç¯N-1æ¬¡  { int t = -1; int tmin = INF; for(int j = 1;j \u0026lt;= N;++j) { // ä»è¿˜æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹åˆ—è¡¨ä¸­æ‰¾å‡ºè·ç¦»æºç‚¹æœ€è¿‘çš„èŠ‚ç‚¹  if(!st[j] \u0026amp;\u0026amp; (dist[j] \u0026lt; tmin)) { t = j; tmin = dist[j]; } } st[t] = true; // æ ‡è®°ç¡®å®šæœ€çŸ­è·¯å¾„  // ç”¨tæ›´æ–°å…¶ä»–ç‚¹çš„è·ç¦»  for(int j = 1;j \u0026lt;= N;++j) dist[j] = min(dist[j],dist[t] + graph[t][j]); } int r = *max_element(dist.begin() + 1,dist.end()); return r == INF ? -1:r; } };   Floydç®—æ³•(ååˆ†æš´åŠ›)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  int Floyd(vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;\u0026amp; times, int N, int K) { const int INF = 102; vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; dist(N+1,vector\u0026lt;int\u0026gt;(N+1,INF)); for(int i = 1;i \u0026lt;= N;++i) dist[i][i] = 0; for(auto\u0026amp; v:times) dist[v[0]][v[1]] = min(dist[v[0]][v[1]],v[2]); for(int k = 1;k \u0026lt;= N;++k) for(int i = 1;i \u0026lt;= N;++i) for(int j = 1;j \u0026lt;= N;++j) if(i != j) dist[i][j] = min(dist[i][j],dist[i][k]+dist[k][j]); int r = 0; for(int i = 1;i \u0026lt;= N;++i) r = max(r,dist[K][i]); return r == INF?-1:r; }   å †ä¼˜åŒ–ç‰ˆçš„Dijkstraç®—æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  class Solution { public: int networkDelayTime(vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;\u0026amp; times, int N, int K) { const int INF = 0x3f3f3f3f; typedef pair\u0026lt;int, int\u0026gt; PII; // first:è·ç¦»; second: å‡ å·ç‚¹  vector\u0026lt;bool\u0026gt; st(N+1, false); // æ˜¯å¦å·²å¾—åˆ°æœ€çŸ­è·ç¦»  vector\u0026lt;int\u0026gt; dist(N+1, INF); // è·ç¦»èµ·å§‹ç‚¹çš„æœ€çŸ­è·ç¦»  unordered_map\u0026lt;int, vector\u0026lt;PII\u0026gt;\u0026gt; graph; // é‚»æ¥è¡¨ï¼›u-\u0026gt;v,æƒé‡w  priority_queue\u0026lt;PII, vector\u0026lt;PII\u0026gt;, greater\u0026lt;PII\u0026gt;\u0026gt; heap; // å°é¡¶å †ï¼›ç»´æŠ¤åˆ°èµ·å§‹ç‚¹çš„æœ€çŸ­è·ç¦»å’Œç‚¹  for (auto \u0026amp;t: times){ // åˆå§‹åŒ–é‚»æ¥è¡¨  graph[t[0]].push_back({t[2],t[1]}); } heap.push({0, K}); dist[K] = 0; while(heap.size()){ auto t = heap.top(); heap.pop(); int ver = t.second, distance = t.first; if (st[ver]) continue; // ä¹‹å‰æ›´æ–°è¿‡ï¼Œæ˜¯å†—ä½™å¤‡ä»½  st[ver] = true; for (auto \u0026amp;p: graph[ver]){ if (dist[p.second] \u0026gt; distance + p.first){ // ç”¨tå»æ›´æ–°å…¶ä»–ç‚¹åˆ°èµ·å§‹ç‚¹çš„æœ€çŸ­è·ç¦»  dist[p.second] = distance + p.first; heap.push({dist[p.second], p.second}); } } } int ans = *max_element(dist.begin()+1, dist.end()); return ans == INF ? -1: ans; } };   å‚è€ƒé“¾æ¥ï¼š\n å­¦å›¾è®ºï¼Œä½ çœŸçš„äº†è§£æœ€çŸ­è·¯å—ï¼Ÿ https://leetcode-cn.com/problems/network-delay-time/solution/csetban-dui-you-hua-dijkstra-by-ray-152/  109. æœ‰åºé“¾è¡¨è½¬æ¢äºŒå‰æœç´¢æ ‘ ç»™å®šä¸€ä¸ªå•é“¾è¡¨ï¼Œå…¶ä¸­çš„å…ƒç´ æŒ‰å‡åºæ’åºï¼Œå°†å…¶è½¬æ¢ä¸ºé«˜åº¦å¹³è¡¡çš„äºŒå‰æœç´¢æ ‘ã€‚\næœ¬é¢˜ä¸­ï¼Œä¸€ä¸ªé«˜åº¦å¹³è¡¡äºŒå‰æ ‘æ˜¯æŒ‡ä¸€ä¸ªäºŒå‰æ ‘æ¯ä¸ªèŠ‚ç‚¹ çš„å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡ 1ã€‚\nç¤ºä¾‹:\nç»™å®šçš„æœ‰åºé“¾è¡¨ï¼š [-10, -3, 0, 5, 9], ä¸€ä¸ªå¯èƒ½çš„ç­”æ¡ˆæ˜¯ï¼š[0, -3, 9, -10, null, 5], å®ƒå¯ä»¥è¡¨ç¤ºä¸‹é¢è¿™ä¸ªé«˜åº¦å¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼š 0 / \\ -3 9 / / -10 5 åˆ†æ æ„å»ºä¸€ä¸ªå¹³è¡¡äºŒå‰æ ‘çš„å…³é”®å°±æ˜¯å·¦å³å­æ ‘çš„é«˜åº¦å·®ä¸è¶…è¿‡1ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ¯æ¬¡å–é“¾è¡¨ä¸­é—´çš„èŠ‚ç‚¹ä½œä¸ºå½“å‰å­æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œç„¶åé€’å½’é“¾è¡¨å·¦è¾¹çš„å­é“¾è¡¨å’Œå³è¾¹çš„å­é“¾è¡¨è¿›è¡Œé€’å½’æ±‚è§£ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  class Solution { public: TreeNode* sortedListToBST(ListNode* head) { if(head == nullptr) return nullptr; // ç©ºé“¾è¡¨æƒ…å†µ  if(head-\u0026gt;next == nullptr) // é“¾è¡¨é•¿åº¦ä¸º1  { TreeNode *tt = new TreeNode(head-\u0026gt;val); return tt; } ListNode *slow = head; ListNode * fast = head; ListNode *slow_pre = nullptr; // ä¸‹é¢å¿«æ…¢æŒ‡é’ˆæ‰¾åˆ°é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹  while(fast-\u0026gt;next \u0026amp;\u0026amp; fast-\u0026gt;next-\u0026gt;next) { slow_pre = slow; slow = slow-\u0026gt;next; fast = fast-\u0026gt;next-\u0026gt;next; } TreeNode *t; // åˆ¤æ–­å¹¶ä¸”é€’å½’æ±‚è§£  if(slow_pre == nullptr) { t = new TreeNode(slow-\u0026gt;next-\u0026gt;val); slow-\u0026gt;next = nullptr; t-\u0026gt;left = sortedListToBST(head); t-\u0026gt;right = nullptr; } else { t = new TreeNode(slow-\u0026gt;val); slow_pre-\u0026gt;next = nullptr; t-\u0026gt;left = sortedListToBST(head); t-\u0026gt;right = sortedListToBST(slow-\u0026gt;next); } return t; } };   647. å›æ–‡å­ä¸² ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½ çš„ä»»åŠ¡æ˜¯è®¡ç®—è¿™ä¸ªå­—ç¬¦ä¸²ä¸­æœ‰å¤šå°‘ä¸ªå›æ–‡å­ä¸²ã€‚\nå…·æœ‰ä¸åŒå¼€å§‹ä½ç½®æˆ–ç»“æŸä½ç½®çš„å­ä¸²ï¼Œå³ä½¿æ˜¯ç”±ç›¸åŒçš„å­—ç¬¦ç»„æˆï¼Œä¹Ÿä¼šè¢«è§†ä½œä¸åŒçš„å­ä¸²ã€‚\nç¤ºä¾‹ 1ï¼š\nè¾“å…¥ï¼š\u0026quot;abc\u0026quot; è¾“å‡ºï¼š3 è§£é‡Šï¼šä¸‰ä¸ªå›æ–‡å­ä¸²: \u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;, \u0026quot;c\u0026quot; ç¤ºä¾‹ 2ï¼š\nè¾“å…¥ï¼š\u0026quot;aaa\u0026quot; è¾“å‡ºï¼š6 è§£é‡Šï¼š6ä¸ªå›æ–‡å­ä¸²: \u0026quot;a\u0026quot;, \u0026quot;a\u0026quot;, \u0026quot;a\u0026quot;, \u0026quot;aa\u0026quot;, \u0026quot;aa\u0026quot;, \u0026quot;aaa\u0026quot; æç¤ºï¼š\n è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ä¸ä¼šè¶…è¿‡ 1000 ã€‚  åˆ†æ ä¸­å¿ƒæ‹“å±•æ³•ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  class Solution { public: int countSubstrings(string s) { int r = 0; int len = s.length(); // å¥‡æ•°ç±»å‹  for(int i = 0;i \u0026lt; len;++i) { ++r; int left = i - 1; int right = i + 1; while(left \u0026gt;= 0 \u0026amp;\u0026amp; right \u0026lt; len \u0026amp;\u0026amp; s[left] == s[right]) { ++r; --left; ++right; } left = i; right = i + 1; // å¶æ•°ç±»å‹  while(left \u0026gt;= 0 \u0026amp;\u0026amp; right \u0026lt; len \u0026amp;\u0026amp; s[left] == s[right]) { ++r; --left; ++right; } } return r; } };   28. å®ç° strStr() å®ç° strStr() å‡½æ•°ã€‚\nç»™å®šä¸€ä¸ª haystack å­—ç¬¦ä¸²å’Œä¸€ä¸ª needle å­—ç¬¦ä¸²ï¼Œåœ¨ haystack å­—ç¬¦ä¸²ä¸­æ‰¾å‡º needle å­—ç¬¦ä¸²å‡ºç°çš„ç¬¬ä¸€ä¸ªä½ç½® (ä»0å¼€å§‹)ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å› -1ã€‚\nç¤ºä¾‹ 1:\nè¾“å…¥: haystack = \u0026quot;hello\u0026quot;, needle = \u0026quot;ll\u0026quot; è¾“å‡º: 2 ç¤ºä¾‹ 2:\nè¾“å…¥: haystack = \u0026quot;aaaaa\u0026quot;, needle = \u0026quot;bba\u0026quot; è¾“å‡º: -1 è¯´æ˜:\nå½“ needle æ˜¯ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œæˆ‘ä»¬åº”å½“è¿”å›ä»€ä¹ˆå€¼å‘¢ï¼Ÿè¿™æ˜¯ä¸€ä¸ªåœ¨é¢è¯•ä¸­å¾ˆå¥½çš„é—®é¢˜ã€‚\nå¯¹äºæœ¬é¢˜è€Œè¨€ï¼Œå½“ needle æ˜¯ç©ºå­—ç¬¦ä¸²æ—¶æˆ‘ä»¬åº”å½“è¿”å› 0 ã€‚è¿™ä¸Cè¯­è¨€çš„ strstr() ä»¥åŠ Javaçš„ indexOf() å®šä¹‰ç›¸ç¬¦ã€‚\nåˆ†æ ä½¿ç”¨KMPç®—æ³•ã€‚\nKMPç®—æ³•\nKMP æ˜¯ä¸€ç§æ¨¡å¼åŒ¹é…ç®—æ³•ï¼Œè¦è§£å†³çš„é—®é¢˜å¯ä»¥å½¢å¼åŒ–ä¸ºï¼šç»™å®šæ¨¡å¼ä¸² T ä¸ç›®æ ‡ä¸² Sï¼Œæˆ‘ä»¬è¦åœ¨ç›®æ ‡ä¸² S ä¸­å¯»æ‰¾ T çš„æ‰€æœ‰å‡ºç°ã€‚\nä½¿ç”¨KMPç®—æ³•æœ€å…³é”®çš„ä¸€æ­¥æ˜¯æ„å»ºnextæ•°ç»„ã€‚next[i]å‚¨å­˜çš„æ˜¯stringä¸­å‰i+1ä½å­—ç¬¦ä¸²å‰ç¼€å’Œåç¼€çš„æœ€é•¿é•¿åº¦ã€‚å¦‚abadefgï¼Œnext[2]å­˜çš„æ˜¯abaè¿™ä¸ªå­—ç¬¦ä¸²å‰ç¼€å’Œåç¼€çš„æœ€é•¿é•¿åº¦ã€‚ä½†æ˜¯è¿™é‡Œä¸ºäº†å’Œä»£ç ç›¸å¯¹åº”ï¼Œå°†nextæ•°ç»„çš„å¤§å°è®¾ç½®ä¸ºå­—ç¬¦ä¸²çš„é•¿åº¦åŠ 1ã€‚\nå‡å¦‚æˆ‘ä»¬ç°åœ¨æ±‚å­—ç¬¦ä¸²\u0026quot;abababac\u0026quot;çš„nextæ•°ç»„:\nåœ¨ä¸‹æ ‡ä¸º0çš„æ—¶å€™è®¾ç½®next[0] = -1;å¹¶ä¸”i = 0ï¼Œj = -1\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1            ä¸€ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²çš„æœ€é•¿ç›¸åŒå‰ç¼€å’Œåç¼€çš„é•¿åº¦ä¸º0ï¼Œæ­¤æ—¶i = 1,j = 0\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0           æ¥ä¸‹æ¥str[j] != str[i]ï¼Œjçš„å€¼åˆå˜ä¸ºnext[j] = next[0] = -1ï¼›ç„¶åç»§ç»­æ‰§è¡Œå¾—åˆ°next[++i] = ++jï¼Œå³next[2] = 0,æ­¤æ—¶i = 2,j = 0;\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0          æ¥ä¸‹æ¥str[j] == str[i] ,next[++i] = ++jï¼Œå³next[30] = 1ï¼Œæ­¤æ—¶i = 3,j = 1\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1         æ¥ä¸‹æ¥str[i] == str[j]ï¼Œåˆ™next[++i] = ++jï¼Œå³next[4] = 2ï¼Œæ­¤æ—¶i = 4,j = 2\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1 2        æ¥ä¸‹æ¥str[i] == str[j]ï¼Œåˆ™next[++i] = ++jï¼Œå³next[5] = 3ï¼Œæ­¤æ—¶i = 5,j = 3\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1 2 3       æ¥ä¸‹æ¥str[i] == str[j]ï¼Œåˆ™next[++i] = ++jï¼Œå³next[6] = 4ï¼Œæ­¤æ—¶i = 6,j = 4\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1 2 3 4      æ¥ä¸‹æ¥str[i] == str[j]ï¼Œåˆ™next[++i] = ++jï¼Œå³next[7] = 5ï¼Œæ­¤æ—¶i = 7,j = 5\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1 2 3 4 5     æ¥ä¸‹æ¥str[i] != str[j]ï¼Œj = next[j] = next[5] = 3;i = 7;æ­¤æ—¶str[3] != str[7],j = next[j] = next[3] = 1;æ­¤æ—¶str[1] != str[7],j = next[j] = next[1] = 0;æ­¤æ—¶str[0] != str[7],j = next[j] = next[0] = -1;æ¥ä¸‹æ¥next[++i] = next[8] = ++j = 0\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1 2 3 4 5 0    åŒ¹é…å­—ç¬¦ä¸²çš„æ€è·¯ä¸æ„å»ºnextæ•°ç»„çš„æ€è·¯ç±»ä¼¼ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  class Solution { public: int strStr(string haystack, string needle) { if(needle == \u0026#34;\u0026#34;) return 0; int n = haystack.length(); // æ„å»ºnextæ•°ç»„  int m = needle.length(); vector\u0026lt;int\u0026gt; next(m + 1,0); for(int i = 0,j = next[0] = -1;i \u0026lt; m;next[++i] = ++j) while(~j \u0026amp;\u0026amp; needle[j] != needle[i]) j = next[j]; // æœç´¢  for(int i = 0,j = 0;i \u0026lt; n;++i) { while(j \u0026gt; 0 \u0026amp;\u0026amp; haystack[i] != needle[j]) j = next[j]; if(haystack[i] == needle[j]) ++j; if(j == m) return (i - m + 1); } return -1; } };   å‚è€ƒé“¾æ¥ï¼š\n ã€ç®—æ³•ABCã€‘KMP ç®—æ³• åŠ¨æ€è§„åˆ’ä¹‹KMPå­—ç¬¦åŒ¹é…ç®—æ³• ä»å¤´åˆ°å°¾å½»åº•ç†è§£KMP  459. é‡å¤çš„å­å­—ç¬¦ä¸² ç»™å®šä¸€ä¸ªéç©ºçš„å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦å¯ä»¥ç”±å®ƒçš„ä¸€ä¸ªå­ä¸²é‡å¤å¤šæ¬¡æ„æˆã€‚ç»™å®šçš„å­—ç¬¦ä¸²åªå«æœ‰å°å†™è‹±æ–‡å­—æ¯ï¼Œå¹¶ä¸”é•¿åº¦ä¸è¶…è¿‡10000ã€‚\nç¤ºä¾‹ 1:\nè¾“å…¥: \u0026quot;abab\u0026quot; è¾“å‡º: True è§£é‡Š: å¯ç”±å­å­—ç¬¦ä¸² \u0026quot;ab\u0026quot; é‡å¤ä¸¤æ¬¡æ„æˆã€‚ ç¤ºä¾‹ 2:\nè¾“å…¥: \u0026quot;aba\u0026quot; è¾“å‡º: False ç¤ºä¾‹ 3:\nè¾“å…¥: \u0026quot;abcabcabcabc\u0026quot; è¾“å‡º: True è§£é‡Š: å¯ç”±å­å­—ç¬¦ä¸² \u0026quot;abc\u0026quot; é‡å¤å››æ¬¡æ„æˆã€‚ (æˆ–è€…å­å­—ç¬¦ä¸² \u0026quot;abcabc\u0026quot; é‡å¤ä¸¤æ¬¡æ„æˆã€‚) åˆ†æ å‡å¦‚æœ‰é‡å¤ï¼Œé‚£ä¹ˆè‡³å°‘é‡å¤ä¸¤ä¸ªç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œå‡å¦‚Aæ˜¯ç›¸åŒçš„å­—ç¬¦ä¸²ï¼ŒAAæ˜¯ä¸€ä¸ªæœ€å°é‡å¤çš„å­—ç¬¦ä¸²ï¼Œå³s = AAï¼Œå½“æˆ‘ä»¬æ‰§è¡Œs + sçš„æ—¶å€™ï¼Œå¾—åˆ°AAAAï¼Œæˆ‘ä»¬åœ¨ä¸­é—´ä¹Ÿå¯ä»¥æ‰¾åˆ°ä¸åŸæ¥å­—ç¬¦ä¸²ç›¸ç­‰çš„å­ä¸²AAï¼Œé‚£ä¹ˆä¹Ÿå°±è¯æ˜äº†sä¸­å­˜åœ¨é‡å¤çš„å­ä¸²ï¼Œå…¶ä¸­å­ä¸²åŒ¹é…çš„æ–¹æ³•å¯ä»¥ä½¿ç”¨KMPç®—æ³•ã€‚å‚è€ƒ\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  class Solution { public: bool repeatedSubstringPattern(string s) { string str = s.substr(1) + s.substr(0,s.length()-1); string pattern = s; int n = str.length(); int m = pattern.length(); vector\u0026lt;int\u0026gt; next(m+1); for(int i = 0,j = next[0] = -1;i \u0026lt; m;next[++i] = ++j) { while(~j \u0026amp;\u0026amp; pattern[i] != pattern[j]) j = next[j]; } for(int i = 0,j = 0;i \u0026lt; n;++i) { while(j \u0026gt; 0 \u0026amp;\u0026amp; str[i] != pattern[j]) j = next[j]; if(str[i] == pattern[j]) ++j; if(j == m) return true; } return false; } };   ","description":"","id":66,"section":"talks","tags":[""],"title":"Leetcode Problem Solve","uri":"https://hugo.jiahongw.com/zh/talks/leetcode/"},{"content":"å“ˆå¸Œè¡¨ ä»€ä¹ˆæ˜¯å“ˆå¸Œè¡¨ï¼Ÿ\nå“ˆå¸Œè¡¨ï¼ˆHash tableï¼Œä¹Ÿå«æ•£åˆ—è¡¨ï¼‰ï¼Œæ˜¯æ ¹æ®å…³é”®ç å€¼(Key value)è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡æŠŠå…³é”®ç å€¼æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®¿é—®è®°å½•ï¼Œä»¥åŠ å¿«æŸ¥æ‰¾çš„é€Ÿåº¦ã€‚è¿™ä¸ªæ˜ å°„å‡½æ•°å«åšæ•£åˆ—å‡½æ•°ï¼Œå­˜æ”¾è®°å½•çš„æ•°ç»„å«åšæ•£åˆ—è¡¨ã€‚\n å“ˆå¸Œè¡¨hashtable(keyï¼Œvalue) å°±æ˜¯æŠŠKeyé€šè¿‡ä¸€ä¸ªå›ºå®šçš„ç®—æ³•å‡½æ•°æ—¢æ‰€è°“çš„å“ˆå¸Œå‡½æ•°è½¬æ¢æˆä¸€ä¸ªæ•´å‹æ•°å­—ï¼Œç„¶åå°±å°†è¯¥æ•°å­—å¯¹æ•°ç»„é•¿åº¦è¿›è¡Œå–ä½™ï¼Œå–ä½™ç»“æœå°±å½“ä½œæ•°ç»„çš„ä¸‹æ ‡ï¼Œå°†valueå­˜å‚¨åœ¨ä»¥è¯¥æ•°å­—ä¸ºä¸‹æ ‡çš„æ•°ç»„ç©ºé—´é‡Œã€‚ï¼ˆæˆ–è€…ï¼šæŠŠä»»æ„é•¿åº¦çš„è¾“å…¥ï¼ˆåˆå«åšé¢„æ˜ å°„ï¼Œ pre-imageï¼‰ï¼Œé€šè¿‡æ•£åˆ—ç®—æ³•ï¼Œå˜æ¢æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ã€‚è¿™ç§è½¬æ¢æ˜¯ä¸€ç§å‹ç¼©æ˜ å°„ï¼Œä¹Ÿå°±æ˜¯ï¼Œæ•£åˆ—å€¼çš„ç©ºé—´é€šå¸¸è¿œå°äºè¾“å…¥çš„ç©ºé—´ï¼Œä¸åŒçš„è¾“å…¥å¯èƒ½ä¼šæ•£åˆ—æˆç›¸åŒçš„è¾“å‡ºï¼Œè€Œä¸å¯èƒ½ä»æ•£åˆ—å€¼æ¥å”¯ä¸€çš„ç¡®å®šè¾“å…¥å€¼ã€‚ç®€å•çš„è¯´å°±æ˜¯ä¸€ç§å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯å‹ç¼©åˆ°æŸä¸€å›ºå®šé•¿åº¦çš„æ¶ˆæ¯æ‘˜è¦çš„å‡½æ•°ã€‚ï¼‰\n å…¶ä¸­ï¼Œè®°å½•çš„ä½ç½® = H(å…³é”®å­—)ï¼ŒHç§°ä¸ºå“ˆå¸Œå‡½æ•°ã€‚\nå“ˆå¸Œæ„é€ æ–¹æ³•   ç›´æ¥å®šå€æ³•\nä¾‹å¦‚å¦‚æœæˆ‘ä»¬ç°åœ¨è¦å¯¹0-100å²çš„äººå£æ•°å­—ç»Ÿè®¡è¡¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹å¹´é¾„è¿™ä¸ªå…³é”®å­—å°±å¯ä»¥ç›´æ¥ç”¨å¹´é¾„çš„æ•°å­—ä½œä¸ºåœ°å€ã€‚æ­¤æ—¶f(key) = keyã€‚\n è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºè¿™ä¹ˆä¸ªå“ˆå¸Œå‡½æ•°ï¼šf(0) = 0ï¼Œf(1) = 1ï¼Œâ€¦â€¦ï¼Œf(20) = 20ã€‚è¿™ä¸ªæ˜¯æ ¹æ®æˆ‘ä»¬è‡ªå·±è®¾å®šçš„ç›´æ¥å®šå€æ¥çš„ã€‚äººæ•°æˆ‘ä»¬å¯ä»¥ä¸ç®¡ï¼Œæˆ‘ä»¬å…³å¿ƒçš„æ˜¯å¦‚ä½•é€šè¿‡å…³é”®å­—æ‰¾åˆ°åœ°å€ã€‚\n   é™¤ç•™ä½™æ•°æ³•\né™¤ç•™ä½™æ•°æ³•æ­¤æ–¹æ³•ä¸ºæœ€å¸¸ç”¨çš„æ„é€ æ•£åˆ—å‡½æ•°æ–¹æ³•ã€‚å¯¹äºæ•£åˆ—è¡¨é•¿ä¸ºmçš„æ•£åˆ—å‡½æ•°å…¬å¼ä¸ºï¼š\n$$\nf( key ) = key \\mod p ( p â‰¤ m )\n$$\n modæ˜¯å–æ¨¡ï¼ˆæ±‚ä½™æ•°ï¼‰çš„æ„æ€ã€‚äº‹å®ä¸Šï¼Œè¿™æ–¹æ³•ä¸ä»…å¯ä»¥å¯¹å…³é”®å­—ç›´æ¥å–æ¨¡ï¼Œä¹Ÿå¯åœ¨æŠ˜å ã€å¹³æ–¹å–ä¸­åå†å–æ¨¡ã€‚\n   æ•°å­—åˆ†ææ³•\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæœ‰80ä¸ªè®°å½•ï¼Œæ¯ä¸€è¡Œä¸ºä¸€ä¸ªè®°å½•ä¸­çš„é”®ï¼Œå‡è®¾è¡¨é•¿ä¸º100ï¼Œåˆ™å¯å–ä¸¤ä½åè¿›åˆ¶æ•°ç»„æˆå“ˆå¸Œåœ°å€ã€‚\n  æŠ˜å æ³•\nå°†å…³é”®å­—åˆ†æˆä½æ•°ç›¸åŒçš„å‡ éƒ¨åˆ†ï¼ˆæœ€åä¸€ä½å¯ä»¥ä¸åŒï¼‰ï¼Œç„¶åå–å åŠ å’Œä½œä¸ºå“ˆå¸Œåœ°å€ï¼Œè¿™ä¸€æ–¹æ³•è¢«ç§°ä¸ºæŠ˜å æ³•ã€‚å½“è¡¨çš„é”®ä½æ•°å¾ˆå¤šï¼Œè€Œä¸”æ¯ä¸€ä½ä¸Šæ•°å­—åˆ†å¸ƒæ¯”è¾ƒå‡åŒ€çš„æ—¶å€™ï¼Œ å¯ä»¥è€ƒè™‘é‡‡ç”¨è¿™ä¸€æ–¹æ³•ã€‚ æŠ˜å æ³•æœ‰ç§»ä½å åŠ å’Œé—´ä½å åŠ ä¸¤ç§æ–¹æ³•ä¾‹å¦‚å›½é™…æ ‡å‡†å›¾ä¹¦ç¼–å·0-442-20586-4çš„å“ˆå¸Œåœ°å€å¯ä»¥ç”¨è¿™ä¸¤ç§æ–¹æ³•è¡¨ç¤ºä¸º\n  å¹³æ–¹å–ä¸­æ³•\nå–å…³é”®å­—å¹³æ–¹åçš„ä¸­é—´å‡ ä½ä¸ºå“ˆå¸Œåœ°å€ï¼Œè¿™ç§æ–¹æ³•å«åšå¹³æ–¹å–ä¸­æ³•ã€‚å®ƒå¼¥è¡¥äº†æ•°å­—åˆ†ææ³•çš„ä¸€äº›ç¼ºé™·ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰æ—¶å¹¶ä¸èƒ½çŸ¥é“é”®çš„å…¨éƒ¨æƒ…å†µï¼Œå–å…¶ä¸­å‡ ä½ä¹Ÿä¸ä¸€å®šåˆé€‚ï¼Œè€Œä¸€ä¸ªæ•°å¹³æ–¹åçš„ä¸­é—´å‡ ä¸ªæ•°å’ŒåŸæ•°çš„æ¯ä¸€ä½éƒ½ç›¸å…³ï¼Œç”±æ­¤æˆ‘ä»¬å°±èƒ½å¾—åˆ°éšæœºæ€§æ›´å¼ºçš„å“ˆå¸Œåœ°å€å–çš„ä½æ•°ç”±è¡¨é•¿å†³å®šã€‚\n  å“ˆå¸Œè¡¨å¤„ç†å†²çªçš„æ–¹æ³•   é“¾åœ°å€æ³•\nå†²çªçš„å…³é”®å­—å­˜å‚¨åœ¨ä¸€ä¸ªé“¾è¡¨ä¸­ï¼ŒæŸ¥æ‰¾çš„æ—¶å€™å¯èƒ½éœ€è¦éå†é“¾è¡¨ã€‚ä¾‹å¦‚ä¸‹é¢ï¼š\n  å¼€æ”¾åœ°å€æ³•\nå¼€æ”¾å®šå€æ³•æ˜¯æŒ‡å¯å­˜æ”¾æ–°è¡¨é¡¹çš„ç©ºé—²åœ°å€ï¼Œæ—¢å‘å®ƒçš„åŒä¹‰è¯è¡¨é¡¹å¼€æ”¾ï¼Œåˆå‘å®ƒçš„éåŒä¹‰è¯è¡¨é¡¹å¼€æ”¾ã€‚\nä¸€èˆ¬æœ‰ä¸€ä¸ªé€’æ¨å…¬å¼:l\n$$H_i = (H(key) + d_i) % m$$\nå¼ä¸­ï¼Œi = 1ï¼Œ2ï¼Œâ€¦ï¼Œkï¼Œmä¸ºæ•£åˆ—è¡¨è¡¨é•¿ï¼Œ$d_i$ä¸ºå¢é‡åºåˆ—ã€‚$d_i$é€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§å–æ³•ï¼š\n å½“$d_i = 1ï¼Œ2ï¼Œâ€¦ï¼Œm - 1$æ—¶ï¼Œç§°ä¸º**çº¿æ€§æ¢æµ‹æ³•ã€‚**å…¶ç‰¹ç‚¹æ˜¯ï¼Œå†²çªå‘ç”Ÿæ—¶é¡ºåºæŸ¥çœ‹è¡¨ä¸­ä¸‹ä¸€ä¸ªå•å…ƒï¼Œç›´åˆ°æ‰¾å‡ºä¸€ä¸ªç©ºå•å…ƒæˆ–æŸ¥éå…¨è¡¨ã€‚ å½“$d_i = 1^2ï¼Œ-1^2ï¼Œ2^2ï¼Œ-2^2ï¼Œâ€¦ï¼Œk^2ï¼Œ-k2$æ—¶ï¼Œåˆç§°ä¸ºäºŒæ¬¡æ¢æµ‹æ³•ã€‚ å½“$d_i$ = ä¼ªéšæœºæ•°åºåˆ—æ—¶ï¼Œç§°ä¸ºä¼ªéšæœºæ¢æµ‹æ³•ã€‚    å†æ•£åˆ—æ³•\nå½“å‘ç”Ÿå†²çªæ—¶ï¼Œå†åˆ©ç”¨ä¸€ä¸ªæ–°çš„å“ˆå¸Œå‡½æ•°è®¡ç®—å¾—åˆ°ä¸€ä¸ªæ–°çš„åœ°å€ï¼Œç›´åˆ°ä¸å‘ç”Ÿå†²çªæ—¶è¿›è¡Œå­˜æ”¾ã€‚\n  å…¬å…±æº¢å‡ºåŒº\næ‰€æœ‰å‘ç”Ÿå†²çªçš„å…³é”®å­—éƒ½å­˜å‚¨åœ¨è¿™ä¸ªå…¬å…±æº¢å‡ºåŒºï¼Œå½“æŸ¥æ‰¾ä¸åˆ°çš„æ—¶å€™æ¥è¿™é‡ŒæŸ¥æ‰¾ã€‚\n  å“ˆå¸Œè¡¨çš„ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ï¼šä¸è®ºå“ˆå¸Œè¡¨ä¸­æœ‰å¤šå°‘æ•°æ®ï¼ŒæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤ï¼ˆæœ‰æ—¶åŒ…æ‹¬åˆ é™¤ï¼‰åªéœ€è¦æ¥è¿‘å¸¸é‡çš„æ—¶é—´å³0(1ï¼‰çš„æ—¶é—´çº§ã€‚å®é™…ä¸Šï¼Œè¿™åªéœ€è¦å‡ æ¡æœºå™¨æŒ‡ä»¤ã€‚\nå“ˆå¸Œè¡¨è¿ç®—å¾—éå¸¸å¿«ï¼Œåœ¨è®¡ç®—æœºç¨‹åºä¸­ï¼Œå¦‚æœéœ€è¦åœ¨ä¸€ç§’ç§å†…æŸ¥æ‰¾ä¸Šåƒæ¡è®°å½•é€šå¸¸ä½¿ç”¨å“ˆå¸Œè¡¨ï¼ˆä¾‹å¦‚æ‹¼å†™æ£€æŸ¥å™¨)å“ˆå¸Œè¡¨çš„é€Ÿåº¦æ˜æ˜¾æ¯”æ ‘å¿«ï¼Œæ ‘çš„æ“ä½œé€šå¸¸éœ€è¦O(N)çš„æ—¶é—´çº§ã€‚å“ˆå¸Œè¡¨ä¸ä»…é€Ÿåº¦å¿«ï¼Œç¼–ç¨‹å®ç°ä¹Ÿç›¸å¯¹å®¹æ˜“ã€‚\nå¦‚æœä¸éœ€è¦æœ‰åºéå†æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥æå‰é¢„æµ‹æ•°æ®é‡çš„å¤§å°ã€‚é‚£ä¹ˆå“ˆå¸Œè¡¨åœ¨é€Ÿåº¦å’Œæ˜“ç”¨æ€§æ–¹é¢æ˜¯æ— ä¸ä¼¦æ¯”çš„ã€‚\nç¼ºç‚¹ï¼šå®ƒæ˜¯åŸºäºæ•°ç»„çš„ï¼Œæ•°ç»„åˆ›å»ºåéš¾äºæ‰©å±•ï¼ŒæŸäº›å“ˆå¸Œè¡¨è¢«åŸºæœ¬å¡«æ»¡æ—¶ï¼Œæ€§èƒ½ä¸‹é™å¾—éå¸¸ä¸¥é‡ï¼Œæ‰€ä»¥ç¨‹åºå‘˜å¿…é¡»è¦æ¸…æ¥šè¡¨ä¸­å°†è¦å­˜å‚¨å¤šå°‘æ•°æ®ï¼ˆæˆ–è€…å‡†å¤‡å¥½å®šæœŸåœ°æŠŠæ•°æ®è½¬ç§»åˆ°æ›´å¤§çš„å“ˆå¸Œè¡¨ä¸­ï¼Œè¿™æ˜¯ä¸ªè´¹æ—¶çš„è¿‡ç¨‹ï¼‰ã€‚\næ•°æ®ç»“æ„åŠå›¾ç¤º çº¿æ€§æ¢æµ‹çš„å“ˆå¸Œè¡¨æ•°æ®ç»“æ„å’Œå›¾ç‰‡\n1 2 3 4 5 6 7 8 9 10 11 12  typedef char KeyType; typedef struct { KeyType key; }RcdType; typedef struct { RcdType *rcd; int size; int count; bool *tag; }HashTable;   å“ˆå¸Œè¡¨å®ç°ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177  #include\u0026lt;stdio.h\u0026gt;#include\u0026lt;stdlib.h\u0026gt; #define SUCCESS 1#define UNSUCCESS 0#define OVERFLOW -1#define OK 1#define ERROR -1#define MAXNUM 9999\t// ç”¨äºåˆå§‹åŒ–å“ˆå¸Œè¡¨çš„è®°å½• key  typedef int Status; typedef int KeyType; // å“ˆå¸Œè¡¨ä¸­çš„è®°å½•ç±»å‹ typedef struct { KeyType key; }RcdType; // å“ˆå¸Œè¡¨ç±»å‹ typedef struct { RcdType *rcd; int size; int count; int *tag; }HashTable; // å“ˆå¸Œè¡¨æ¯æ¬¡é‡å»ºå¢é•¿åçš„å¤§å° int hashsize[] = { 11, 31, 61, 127, 251, 503 }; int index = 0; // åˆå§‹å“ˆå¸Œè¡¨ Status InitHashTable(HashTable \u0026amp;H, int size) { int i; H.rcd = (RcdType *)malloc(sizeof(RcdType)*size); H.tag = (int *)malloc(sizeof(int)*size); if (NULL == H.rcd || NULL == H.tag) return OVERFLOW; KeyType maxNum = MAXNUM; for (i = 0; i \u0026lt; size; i++) { H.tag[i] = 0; H.rcd[i].key = maxNum; } H.size = size; H.count = 0; return OK; } // å“ˆå¸Œå‡½æ•°ï¼šé™¤ç•™ä½™æ•°æ³• int Hash(KeyType key, int m) { return (3 * key) % m; } // å¤„ç†å“ˆå¸Œå†²çªï¼šçº¿æ€§æ¢æµ‹ void collision(int \u0026amp;p, int m) { p = (p + 1) % m; } // åœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥è¯¢ Status SearchHash(HashTable H, KeyType key, int \u0026amp;p, int \u0026amp;c) { p = Hash(key, H.size); int h = p; c = 0; while ((1 == H.tag[p] \u0026amp;\u0026amp; H.rcd[p].key != key) || -1 == H.tag[p]) { collision(p, H.size); c++; } if (1 == H.tag[p] \u0026amp;\u0026amp; key == H.rcd[p].key) return SUCCESS; else return UNSUCCESS; } //æ‰“å°å“ˆå¸Œè¡¨ void printHash(HashTable H) { int i; printf(\u0026#34;key : \u0026#34;); for (i = 0; i \u0026lt; H.size; i++) printf(\u0026#34;%3d \u0026#34;, H.rcd[i].key); printf(\u0026#34;\\n\u0026#34;); printf(\u0026#34;tag : \u0026#34;); for (i = 0; i \u0026lt; H.size; i++) printf(\u0026#34;%3d \u0026#34;, H.tag[i]); printf(\u0026#34;\\n\\n\u0026#34;); } // å‡½æ•°å£°æ˜ï¼šæ’å…¥å“ˆå¸Œè¡¨ Status InsertHash(HashTable \u0026amp;H, KeyType key); // é‡å»ºå“ˆå¸Œè¡¨ Status recreateHash(HashTable \u0026amp;H) { RcdType *orcd; int *otag, osize, i; orcd = H.rcd; otag = H.tag; osize = H.size; InitHashTable(H, hashsize[index++]); //æŠŠæ‰€æœ‰å…ƒç´ ï¼ŒæŒ‰ç…§æ–°å“ˆå¸Œå‡½æ•°æ”¾åˆ°æ–°è¡¨ä¸­ \tfor (i = 0; i \u0026lt; osize; i++) { if (1 == otag[i]) { InsertHash(H, orcd[i].key); } } return OK; } // æ’å…¥å“ˆå¸Œè¡¨ Status InsertHash(HashTable \u0026amp;H, KeyType key) { int p, c; if (UNSUCCESS == SearchHash(H, key, p, c)) { //æ²¡æœ‰ç›¸åŒkey \tif (c*1.0 / H.size \u0026lt; 0.5) { //å†²çªæ¬¡æ•°æœªè¾¾åˆ°ä¸Šçº¿ \t//æ’å…¥ä»£ç  \tH.rcd[p].key = key; H.tag[p] = 1; H.count++; return SUCCESS; } else recreateHash(H); //é‡æ„å“ˆå¸Œè¡¨ \t} return UNSUCCESS; } // åˆ é™¤å“ˆå¸Œè¡¨ Status DeleteHash(HashTable \u0026amp;H, KeyType key) { int p, c; if (SUCCESS == SearchHash(H, key, p, c)) { //åˆ é™¤ä»£ç  \tH.tag[p] = -1; H.count--; return SUCCESS; } else return UNSUCCESS; } int main() { printf(\u0026#34;-----å“ˆå¸Œè¡¨-----\\n\u0026#34;); HashTable H; int i; int size = 11; KeyType array[8] = { 22, 41, 53, 46, 30, 13, 12, 67 }; KeyType key; //åˆå§‹åŒ–å“ˆå¸Œè¡¨ \tprintf(\u0026#34;åˆå§‹åŒ–å“ˆå¸Œè¡¨\\n\u0026#34;); if (SUCCESS == InitHashTable(H, hashsize[index++])) printf(\u0026#34;åˆå§‹åŒ–æˆåŠŸ\\n\u0026#34;); //æ’å…¥å“ˆå¸Œè¡¨ \tprintf(\u0026#34;æ’å…¥å“ˆå¸Œè¡¨\\n\u0026#34;); for (i = 0; i \u0026lt;= 7; i++) { key = array[i]; InsertHash(H, key); printHash(H); } //åˆ é™¤å“ˆå¸Œè¡¨ \tprintf(\u0026#34;åˆ é™¤å“ˆå¸Œè¡¨ä¸­keyä¸º12çš„å…ƒç´ \\n\u0026#34;); int p, c; if (SUCCESS == DeleteHash(H, 12)) { printf(\u0026#34;åˆ é™¤æˆåŠŸï¼Œæ­¤æ—¶å“ˆå¸Œè¡¨ä¸ºï¼š\\n\u0026#34;); printHash(H); } //æŸ¥è¯¢å“ˆå¸Œè¡¨ \tprintf(\u0026#34;æŸ¥è¯¢å“ˆå¸Œè¡¨ä¸­keyä¸º67çš„å…ƒç´ \\n\u0026#34;); if (SUCCESS == SearchHash(H, 67, p, c)) printf(\u0026#34;æŸ¥è¯¢æˆåŠŸ\\n\u0026#34;); //å†æ¬¡æ’å…¥ï¼Œæµ‹è¯•å“ˆå¸Œè¡¨çš„é‡å»º \tprintf(\u0026#34;å†æ¬¡æ’å…¥ï¼Œæµ‹è¯•å“ˆå¸Œè¡¨çš„é‡å»ºï¼š\\n\u0026#34;); KeyType array1[8] = { 27, 47, 57, 47, 37, 17, 93, 67 }; for (i = 0; i \u0026lt;= 7; i++) { key = array1[i]; InsertHash(H, key); printHash(H); } getchar(); return 0; }   å‚è€ƒé“¾æ¥ï¼š\n å“ˆå¸Œè¡¨ï¼ˆæ•£åˆ—è¡¨ï¼‰åŸç†è¯¦è§£ ã€ç®—æ³•ã€‘å“ˆå¸Œè¡¨çš„è¯ç”Ÿ  ","description":"å“ˆå¸Œè¡¨ï¼ˆHash tableï¼Œä¹Ÿå«æ•£åˆ—è¡¨ï¼‰ï¼Œæ˜¯æ ¹æ®å…³é”®ç å€¼(Key value)è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚ã€‚","id":67,"section":"posts","tags":["æ•°æ®ç»“æ„","å“ˆå¸Œè¡¨"],"title":"å“ˆå¸Œè¡¨","uri":"https://hugo.jiahongw.com/zh/posts/algorithmstructure/hash/"},{"content":"å…³äºç¨‹åºçš„è£…å…¥   ç»å¯¹è£…å…¥ï¼šç»å¯¹æ˜ å°„ï¼Œç¨‹åºä¸­é€»è¾‘åœ°å€ä¸å†…å­˜ç‰©ç†åœ°å€å®Œå…¨ç›¸åŒ ï¼ˆå•ç‰‡æœº)\n  å¯é‡å®šä½è£…å…¥ï¼šé™æ€æ˜ å°„ï¼Œåœ¨è£…å…¥æ—¶å¯¹é€»è¾‘åœ°å€è¿›è¡Œä¿®æ”¹\n  åŠ¨æ€è¿è¡Œæ—¶è£…å…¥ï¼šé€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰æ‰§è¡Œ (ç°ä»£PCæœº)\n  è€ŒåŠ¨æ€é‡å®šä½å¦‚ä¸‹ï¼š\n é™æ€é‡å®šä½çš„ç‰¹ç‚¹æ˜¯åœ¨ä¸€ä¸ªä½œä¸šè£…å…¥å†…å­˜æ—¶ï¼Œå¿…é¡»åˆ†é…å…¶è¦æ±‚çš„å…¨éƒ¨å†…å­˜ç©ºé—´ï¼Œå¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œå°±ä¸èƒ½è£…å…¥è¯¥ä½œä¸šã€‚æ­¤å¤–ï¼Œä½œä¸šä¸€æ—¦è¿›å…¥å†…å­˜åï¼Œåœ¨æ•´ä¸ªè¿è¡ŒæœŸé—´ä¸èƒ½åœ¨å†…å­˜ä¸­ç§»åŠ¨ï¼Œä¹Ÿä¸èƒ½å†ç”³è¯·å†…å­˜ç©ºé—´ã€‚\n å…³äºç¨‹åºçš„é“¾æ¥   é™æ€é“¾æ¥æ–¹å¼(Static Linking)\nåœ¨ç¨‹åºè¿è¡Œä¹‹å‰ï¼Œå…ˆå°†å„ç›®æ ‡æ¨¡å—åŠå®ƒä»¬æ‰€éœ€çš„åº“å‡½æ•°é“¾æ¥æˆä¸€ä¸ªå®Œæ•´çš„å¯æ‰§è¡Œç¨‹åºï¼Œä»¥åä¸å†æ‹†å¼€ã€‚\n  è£…å…¥æ—¶åŠ¨æ€é“¾æ¥(Load time Dynamic Linking)\nå°†ç”¨æˆ·æºç¨‹åºç¼–è¯‘åæ‰€å¾—åˆ°çš„ä¸€ç»„ç›®æ ‡æ¨¡å—ï¼Œåœ¨è£…å…¥å†…å­˜æ—¶ï¼Œé‡†ç”¨è¾¹è£…å…¥è¾¹é“¾æ¥çš„é“¾æ¥æ–¹å¼ã€‚\n  è¿è¡Œæ—¶åŠ¨æ€é“¾æ¥(Run-time Dynamic Linkingï¼‰\nå¯¹æŸäº›ç›®æ ‡æ¨¡å—çš„é“¾æ¥ï¼Œæ˜¯åœ¨ç¨‹åºæ‰§è¡Œä¸­éœ€è¦è¯¥ç›®æ ‡æ¨¡å—æ—¶ï¼Œæ‰å¯¹å®ƒè¿›è¡Œçš„é“¾æ¥ã€‚å…¶ä¼˜ç‚¹æ˜¯ä¾¿äºä¿®æ”¹å’Œæ›´æ–°ï¼Œä¾¿äºå®ç°å¯¹ç›®æ ‡æ¨¡å—çš„å…±äº«ã€‚\n  è¿ç»­åˆ†é…æ–¹å¼ å•ä¸€è¿ç»­åˆ†é… åªèƒ½ç”¨äºå•ç”¨æˆ·ã€å•ä»»åŠ¡çš„æ“ä½œç³»ç»Ÿä¸­ã€‚é‡‡ç”¨è¿™ç§å­˜å‚¨ç®¡ç†æ–¹å¼æ—¶ï¼Œå¯æŠŠå†…å­˜åˆ†ä¸ºç³»ç»ŸåŒºå’Œç”¨æˆ·åŒºä¸¤éƒ¨åˆ†ï¼Œç³»ç»ŸåŒºä»…æä¾›ç»™ OS ä½¿ç”¨ï¼Œé€šå¸¸æ˜¯æ”¾åœ¨å†…å­˜çš„ä½å€éƒ¨åˆ†ï¼›ç”¨æˆ·åŒºæ˜¯æŒ‡é™¤ç³»ç»ŸåŒºä»¥å¤–çš„å…¨éƒ¨å†…å­˜ç©ºé—´ï¼Œæä¾›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚\nå›ºå®šåˆ†åŒºè¿ç»­åˆ†é… å°†å†…å­˜ç”¨æˆ·ç©ºé—´åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªå›ºå®šå¤§å°çš„åŒºåŸŸï¼Œåœ¨æ¯ä¸ªåˆ†åŒºä¸­åªè£…å…¥ä¸€é“ä½œä¸šï¼Œè¿™æ ·ï¼ŒæŠŠç”¨æˆ·ç©ºé—´åˆ’åˆ†ä¸ºå‡ ä¸ªåˆ†åŒºï¼Œä¾¿å…è®¸æœ‰å‡ é“ä½œä¸šå¹¶å‘è¿è¡Œã€‚å½“æœ‰ä¸€ç©ºé—²åˆ†åŒºæ—¶ï¼Œä¾¿å¯ä»¥å†ä»å¤–å­˜çš„åå¤‡ä½œä¸šé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªé€‚å½“å¤§å°çš„ä½œä¸šè£…å…¥è¯¥åˆ†åŒºï¼Œå½“è¯¥ä½œä¸šç»“æŸæ—¶ï¼Œåˆå¯å†ä»åå¤‡ä½œä¸šé˜Ÿåˆ—ä¸­æ‰¾å‡ºå¦ä¸€ä½œä¸šè°ƒå…¥è¯¥åˆ†åŒºã€‚\nåˆ’åˆ†åˆ†åŒºçš„æ–¹æ³•ï¼š\n åˆ†åŒºå¤§å°ç›¸ç­‰ åˆ†åŒºå¤§å°ä¸ç›¸ç­‰  å¦å¤–å¯ä»¥è®¾ç½®åˆ†åŒºå¤§å°ä¸ç­‰çš„ä¸€äº›åˆ†åŒºï¼Œå¦‚ä¸‹ï¼š\nå›ºå®šåˆ†åŒºåˆ†é…çš„ç¼ºç‚¹ï¼š\n é€ æˆå­˜å‚¨ç©ºé—´çš„æµªè´¹ æ‹“å±•æ€§å·®  åŠ¨æ€åˆ†åŒºåˆ†é… åŠ¨æ€åˆ†åŒºåˆ†é…æ•°æ®ç»“æ„ï¼š\n  ç©ºé—²åˆ†åŒºè¡¨\nåœ¨ç³»ç»Ÿä¸­è®¾ç½®ä¸€å¼ ç©ºé—²åˆ†åŒºè¡¨ï¼Œç”¨äºè®°å½•æ¯ä¸ªç©ºé—²åˆ†åŒºçš„æƒ…å†µã€‚æ¯ä¸ªç©ºé—²åˆ†åŒºå ä¸€ä¸ªè¡¨ç›®ï¼Œè¡¨ç›®ä¸­åŒ…æ‹¬åˆ†åŒºåºå·ã€åˆ†åŒºå§‹å€åŠåˆ†åŒºçš„å¤§å°ç­‰æ•°æ®é¡¹ã€‚\n  ç©ºé—²åˆ†åŒºé“¾\nä¸ºäº†å®ç°å¯¹ç©ºé—²åˆ†åŒºçš„åˆ†é…å’Œé“¾æ¥ï¼Œåœ¨æ¯ä¸ªåˆ†åŒºçš„èµ·å§‹éƒ¨åˆ†ï¼Œè®¾ç½®ä¸€äº›ç”¨äºæ§åˆ¶åˆ†åŒºåˆ†é…çš„ä¿¡æ¯ï¼Œä»¥åŠç”¨äºé“¾æ¥å„åˆ†åŒºæ‰€ç”¨çš„å‰å‘æŒ‡é’ˆï¼›åœ¨åˆ†åŒºå°¾éƒ¨åˆ™è®¾ç½®ä¸€åå‘æŒ‡é’ˆï¼Œé€šè¿‡å‰ã€åå‘é“¾æ¥æŒ‡é’ˆï¼Œå¯å°†æ‰€æœ‰çš„ç©ºé—²åˆ†åŒºé“¾æ¥æˆä¸€ä¸ªåŒå‘é“¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n  å†…å­˜åˆ†é…åˆ†é…ç®—æ³• åŸºäºé¡ºåºæœç´¢ï¼š(é€‚åˆä¸å¤ªå¤§çš„ç³»ç»Ÿ)   é¦–æ¬¡é€‚åº”ç®—æ³•(FF)\nåœ¨åˆ†é…å†…å­˜æ—¶ï¼Œä»é“¾é¦–å¼€å§‹é¡ºåºæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå¤§å°èƒ½æ»¡è¶³çš„ç©ºé—²åˆ†åŒºå³å¯ã€‚ç„¶åå†å†æŒ‰ç…§ä½œä¸šçš„å¤§å°ï¼Œä»ç©ºé—´åˆ†åŒºä¸­åˆ’åˆ†å‡ºä¸ä½œä¸šå¤§å°ç›¸åŒçš„ç©ºé—´ç»™ä½œä¸šä½¿ç”¨ï¼Œä½™ä¸‹çš„ç©ºé—´ç•™åœ¨ç©ºé—²åˆ†åŒºé“¾ä¸­ã€‚\n é¦–æ¬¡é€‚åº”ç®—æ³•è¦æ±‚ç©ºé—²åˆ†åŒºé“¾ä»¥åœ°å€é€’å¢çš„æ¬¡åºé“¾æ¥ã€‚\n ç¼ºç‚¹ï¼šç©ºé—²åˆ†åŒºé“¾çš„ä½åœ°å€éƒ¨åˆ†ä¸æ–­è¢«åˆ’åˆ†ï¼Œä¼šæœ‰è®¸å¤šç»†å°çš„ç¢ç‰‡ç©ºé—´éš¾ä»¥åˆ©ç”¨ã€‚æ¯æ¬¡éƒ½æ˜¯ä»ä½åœ°å€å¼€å§‹æ‰¾ç©ºé—²åˆ†åŒºï¼ŒæŸ¥æ‰¾çš„æ•ˆç‡ä½ã€‚\n  å¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•(NF)\nå¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•åœ¨ä¸ºè¿›ç¨‹åˆ†é…å†…å­˜ç©ºé—´æ—¶ï¼Œä¸å†æ˜¯æ¯æ¬¡éƒ½ä»é“¾é¦–å¼€å§‹æŸ¥æ‰¾ï¼Œè€Œæ˜¯ä»ä¸Šæ¬¡æ‰¾åˆ°çš„ç©ºé—²åˆ†åŒºçš„ä¸‹ä¸€ä¸ªç©ºé—²åˆ†åŒºå¼€å§‹æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªèƒ½å¤Ÿæ»¡è¶³è¿›ç¨‹çš„ç©ºé—²åˆ†åŒºä¸ºæ­¢ï¼Œæœ€åä»ç©ºé—²åˆ†åŒºåˆ’åˆ†å‡ºä¸è¯·æ±‚å¤§å°ç›¸ç­‰çš„ç©ºé—´ç»™ä½œä¸šã€‚\n å¾ªç¯åˆ°é“¾è¡¨æœ«å°¾åˆä»æ–°ä»é“¾é¦–å¼€å§‹æŸ¥æ‰¾ã€‚\n ç¼ºç‚¹ï¼šç¼ºå°‘å¯ç”¨çš„å¤§ç©ºé—´ç©ºé—²åˆ†åŒºã€‚\n  æœ€ä½³é€‚åº”ç®—æ³•(BF)\næœ€ä½³é€‚åº”ç®—æ³•åœ¨åˆ†é…å†…å­˜çš„æ—¶å€™ï¼ŒæŠŠæ»¡è¶³è¦æ±‚å¹¶ä¸”åˆæ˜¯æœ€å°çš„ç©ºé—²åˆ†åŒºç»™ä½œä¸šã€‚ä¸ºäº†åŠ é€Ÿå¯»æ‰¾ï¼Œè¯¥ç®—æ³•éœ€è¦å¯¹ç©ºé—²åˆ†åŒºé“¾æŒ‰ç…§ç©ºé—²åˆ†åŒºå¤§å°è¿›è¡Œä»å°åˆ°å¤§æ’åºã€‚\nç¼ºç‚¹ï¼šä¼šäº§ç”Ÿè®¸å¤šç»†å°çš„ç¢ç‰‡\n  æœ€å·®é€‚åº”ç®—æ³•(WF)\næœ€å·®é€‚åº”ç®—æ³•æ¯æ¬¡åˆ†é…å†…å­˜çš„æ—¶å€™ï¼ŒæŠŠæ»¡è¶³è¦æ±‚çš„æœ€å¤§çš„ç©ºé—²åˆ†åŒºç»™ä½œä¸šï¼Œå°†ä¸ä½œä¸šç”³è¯·å¤§å°çš„ç©ºé—´åˆ’åˆ†å‡ºæ¥ï¼Œå‰©ä½™çš„ç©ºé—´ç•™åœ¨ç©ºé—²åˆ†åŒºä¸­ï¼Œå¹¶ä¸”æ›´æ–°ç©ºé—²åˆ†åŒºé“¾ã€‚è¯¥ç®—æ³•éœ€è¦å¯¹ç©ºé—²åˆ†åŒºé“¾æŒ‰ç…§ç©ºé—²åˆ†åŒºå¤§å°è¿›è¡Œä»å¤§åˆ°å°æ’åºã€‚\nä¼˜ç‚¹ï¼šæŸ¥æ‰¾æ•ˆç‡å—ï¼Œäº§ç”Ÿç¢ç‰‡å°‘ã€‚\nç¼ºç‚¹ï¼šç¼ºå°‘å¤§çš„ç©ºé—²åˆ†åŒº\n  ä¾‹å­ï¼š\nå‡è®¾æœ‰æ–°ç¨‹åºFè£…å…¥ï¼Œå¤§å°ä¸º32Kï¼Œå½“å‰å·²æœ‰ç¨‹åºBå’ŒDï¼Œæœ€è¿‘ä¸€æ¬¡ç©ºé—´åˆ†é…æ˜¯Dï¼š\nåŸºäºç´¢å¼•æœç´¢ï¼š(é€‚åˆæ¯”è¾ƒå¤§çš„ç³»ç»Ÿ)   å¿«é€Ÿé€‚åº”ç®—æ³•(QF)\nè¯¥ç®—æ³•åˆå«åšåˆ†ç±»æœç´¢æ³•ï¼Œæ˜¯å°†ç©ºé—²åˆ†åŒºæ ¹æ®å…¶å®¹é‡å¤§å°è¿›è¡Œåˆ†ç±»ï¼Œå¯¹äºæ¯ä¸€ç±»å…·æœ‰ç›¸åŒå®¹é‡çš„æ‰€æœ‰ç©ºé—²åˆ†åŒºï¼Œå•ç‹¬è®¾ç½®ä¸€ä¸ªç©ºé—²åˆ†åŒºé“¾ï¼Œè¿™æ ·ç³»ç»Ÿå­˜åœ¨å¤šä¸ªç©ºé—²åˆ†åŒºé“¾ã€‚åŒæ—¶ï¼Œè¿˜éœ€è¦åœ¨å†…å­˜ä¸­è®¾ç«‹ä¸€å¼ ç®¡ç†ç´¢å¼•è¡¨ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªç´¢å¼•è¡¨é¡¹å¯¹åº”äº†ä¸€ç§ç©ºé—²åˆ†åŒºç±»å‹ï¼Œå¹¶è®°å½•äº†è¯¥ç±»å‹ç©ºé—²åˆ†åŒºé“¾è¡¨è¡¨å¤´æŒ‡é’ˆã€‚\n ç©ºé—²åˆ†åŒºçš„åˆ†ç±»æ˜¯æ ¹æ®è¿›ç¨‹å¸¸ç”¨çš„ç©ºé—²å¤§å°è¿›è¡Œåˆ’åˆ†çš„ï¼Œå¦‚2KBã€4KBã€8KBç­‰ï¼Œå¯¹äºå…¶ä»–å¤§å°çš„ç©ºé—²åˆ†åŒºåƒ7KBçš„ç©ºé—²åˆ†åŒºï¼Œæ—¢å¯ä»¥æ”¾åœ¨8KBçš„é“¾è¡¨ä¸­ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨ä¸€ä¸ªç‰¹æ®Šçš„ç©ºé—²é“¾è¡¨ä¸­ã€‚\n   ä¼™ä¼´ç³»ç»Ÿ\nè¯¥ç®—æ³•è§„å®šï¼Œæ— è®ºæ˜¯åˆ†é…åˆ†åŒºè¿˜æ˜¯ç©ºé—²åˆ†åŒºï¼Œå…¶å¤§å°å‡ä¸º2çš„kæ¬¡å¹‚(kä¸ºæ•´æ•°ä¸”1\u0026lt;=k\u0026lt;=m)ã€‚é€šå¸¸$2^m$æ˜¯æ•´ä¸ªå¯åˆ†é…å†…å­˜çš„å¤§å°ã€‚\n  å“ˆå¸Œç®—æ³•\nå“ˆå¸Œç®—æ³•æ˜¯åˆ©ç”¨å“ˆå¸Œå¿«é€ŸæŸ¥æ‰¾çš„ä¼˜ç‚¹ï¼Œä»¥åŠç©ºé—²åˆ†åŒºåœ¨å¯åˆ©ç”¨ç©ºé—²åˆ†åŒºè¡¨ä¸­çš„åˆ†å¸ƒè§„å¾‹ï¼Œå»ºç«‹å“ˆå¸Œå‡½æ•°ï¼Œæ„é€ ä¸€å¼ ä»¥ç©ºé—²åˆ†åŒºå¤§å°ä¸ºå…³é”®å­—çš„å“ˆå¸Œè¡¨ï¼Œè¯¥è¡¨çš„æ¯ä¸€ä¸ªè¡¨é¡¹è®°å½•äº†ä¸€ä¸ªå¯¹åº”çš„ç©ºé—²åˆ†åŒºé“¾è¡¨è¡¨å¤´æŒ‡é’ˆã€‚\n  åŠ¨æ€é‡å®šä½åˆ†åŒºåˆ†é… ç´§å‡‘\nå¯¹å†…å­˜ä¸­æ­£åœ¨ä½¿ç”¨çš„åˆ†åŒºè¿›è¡Œæ¬è¿ï¼Œä½¿å¤šä¸ªå°çš„ç©ºé—²åˆ†åŒºï¼ˆç¢ç‰‡ï¼‰åˆå¹¶ä¸ºä¸€ä¸ªå¤§çš„ç©ºé—²åˆ†åŒº\nåŠ¨æ€é‡å®šä½\nç®—æ³•ï¼š\nä»€ä¹ˆæ˜¯å†…å­˜ç¢ç‰‡ï¼Ÿ\nå†…éƒ¨ç¢ç‰‡æ˜¯æŒ‡å·²ç»åˆ†é…ç»™ä½œä¸šä½†ä¸èƒ½è¢«åˆ©ç”¨çš„å†…å­˜ç©ºé—´ï¼Œå¤–éƒ¨ç¢ç‰‡æ˜¯æŒ‡ç³»ç»Ÿä¸­è¿˜æ²¡æœ‰åˆ†é…ç»™ä½œä¸šï¼Œä½†ç”±äºç¢ç‰‡å¤ªå°è€Œæ— æ³•åˆ†é…ç»™ç”³è¯·å†…å­˜ç©ºé—´çš„æ–°è¿›ç¨‹çš„å­˜å‚¨å—ã€‚é€šä¿—ç‚¹çš„ç†è§£å°±æ˜¯ï¼ŒæŸä¸ªä½œä¸šæ‰€å ç”¨çš„å†…å­˜åŒºåŸŸå¦‚æœæ²¡æœ‰è£…æ»¡ï¼Œå°±æ˜¯å†…éƒ¨ç¢ç‰‡ï¼Œè€Œä½œä¸šä¸ä½œä¸šä¹‹é—´ï¼Œå¦‚æœæœ‰å†…å­˜åŒºåŸŸæ²¡æœ‰åˆ†é…ç»™æŸä¸ªä½œä¸šï¼Œä½†åˆä¸èƒ½åˆ†é…ç»™ä»»ä½•ä½œä¸šï¼Œå°±æ˜¯å¤–éƒ¨ç¢ç‰‡ã€‚\n è¿ç»­åˆ†é…: ä¸ºç”¨æˆ·è¿›ç¨‹åˆ†é…çš„å¿…é¡»æ˜¯ä¸€ä¸ªè¿ç»­çš„å†…å­˜ç©ºé—´ã€‚\néè¿ç»­åˆ†é…: ä¸ºç”¨æˆ·è¿›ç¨‹åˆ†é…çš„å¯ä»¥æ˜¯ä¸€äº›åˆ†æ•£çš„å†…å­˜ç©ºé—´ã€‚\n éè¿ç»­åˆ†é…æ–¹å¼(ç¦»æ•£åˆ†é…æ–¹å¼) æ€æƒ³\nå‡è®¾è¿›ç¨‹Aå¤§å°ä¸º23MB,ä½†æ˜¯æ¯ä¸ªåˆ†åŒºå¤§å°åªæœ‰10MB,å¦‚æœè¿›ç¨‹åªèƒ½å ç”¨ä¸€ä¸ªåˆ†åŒº,é‚£æ˜¾ç„¶æ”¾ä¸ä¸‹ã€‚\nè§£å†³æ€è·¯:\nå¦‚æœå…è®¸è¿›ç¨‹å ç”¨å¤šä¸ªåˆ†åŒº,é‚£ä¹ˆå¯ä»¥æŠŠè¿›ç¨‹æ‹†åˆ†æˆ10MB+10MB+3MBä¸‰ä¸ªéƒ¨å¤–,å†æŠŠè¿™ä¸‰ä¸ªéƒ¨åˆ†åˆ†åˆ«æ”¾åˆ°ä¸‰ä¸ªåˆ†åŒºä¸­(è¿™äº›åˆ†åŒºä¸è¦æ±‚è¿ç»­)\u0026hellip;\nè¿›ç¨‹Açš„æœ€åä¸€ä¸ªéƒ¨åˆ†æ˜¯3MB,æ”¾å…¥åˆ†åŒºåä¼šäº§ç”Ÿ7MBçš„å†…éƒ¨ç¢ç‰‡ï¼Œå¦‚æœæ¯ä¸ªåˆ†åŒºå¤§å°ä¸º2MB,é‚£ä¹ˆè¿›ç¨‹Aå¯ä»¥æ‹†åˆ†æˆ11*2MB +1MBå…±12ä¸ªéƒ¨åˆ†,åªæœ‰æœ€åä¸€éƒ¨åˆ†1MBå ä¸æ»¡åˆ†åŒº,å…±äº§ç”Ÿ1MBçš„å†…éƒ¨ç¢ç‰‡.\næ˜¾ç„¶,å¦‚æœæŠŠå¤–åŒºå¤§å°è®¾ç½®çš„æ›´å°ä¸€äº›,å†…éƒ¨ç¢ç‰‡ä¼šæ›´å°,å†…å­¦åˆ©ç”¨ç‡ä¼šæ›´é«˜.\nå…·æœ‰å¿«è¡¨çš„åœ°å€å˜æ¢æœºæ„ï¼šï¼ˆæ—¶é—´å±€éƒ¨æ€§ä¸ç©ºé—´å±€éƒ¨æ€§åŸç†ï¼‰\nå¿«è¡¨,åˆç§°è”æƒ³å¯„å­˜å™¨(TLB) ,æ˜¯ä¸€ç§è®¿é—®é€Ÿåº¦æ¯”å†…å­˜å¿«å¾ˆå¤šçš„é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨,ç”¨æ¥å­˜æ”¾å½“\u0026quot;å‰è®¿é—´çš„è‹¥å¹²é¡µè¡¨é¡¹,ä»¥åŠ é€Ÿåœ°å€å˜æ¢çš„è¿‡ç¨‹ã€‚ä¸æ­¤å¯¹åº”,å†…å­˜ä¸­çš„é¡µè¡¨å¸¸ç§°ä¸ºæ…¢è¡¨ã€‚\nå¤šçº§é¡µè¡¨\né—®é¢˜\nåŠ è½½ä¸€ä¸ªå¤§çš„é¡µè¡¨éœ€è¦å ç”¨å¾ˆå¤§çš„å†…å­˜\nè§£å†³\nå°†å¤§è¡¨åˆ†ä¸ºå‡ ä¸ªå°è¡¨ã€‚ç±»ä¼¼CIDRã€‚\nå¯å°†é•¿é•¿çš„é¡µè¡¨è¿›è¡Œåˆ†ç»„,ä½¿æ¯ä¸ªå†…å­˜å—åˆšå¥½å¯ä»¥æ”¾å…¥ä¸€ä¸ªåˆ†ç»„(æ¯”å¦‚ä¸Šä¸ªä¾§å­ä¸­,é¡µé¢å¤§å°4KB,æ¯ä¸ªé¡µè¡¨é¡¹48,æ¯ä¸ªé¡µé¢å¯å­˜æ”¾1Kä¸ªé¡µè¡¨é¡¹,å› æ­¤æ¯1Kä¸ªè¿ç»­çš„é¡µè¡¨é¡¹ä¸ºä¸€ç»„,æ¯ç»„åˆšå¥½å ä¸€ä¸ªå†…å­˜å—,å†è®²å„ç»„ç¦»æ•£åœ°æ”¾åˆ°å„ä¸ªå†…å­˜å—ä¸­)å¦å¤–,è¦ä¸ºç¦»æ•£åˆ†é…çš„é¡µè¡¨å†å»ºç«‹ä¸€å¼ é¡µè¡¨,ç§°ä¸ºé¡µç›®å½•è¡¨,æˆ–ç§°å¤–å±‚é¡µè¡¨,æˆ–ç§°é¡¶å±‚é¡µè¡¨\nå­˜å‚¨ç®¡ç†æ–¹å¼  æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å†…å­˜çš„åˆ’åˆ†æ–¹æ³•\n åˆ†é¡µå­˜å‚¨ç®¡ç† è¿™ç§æ–¹å¼ä¸­ï¼Œå°†ç”¨æˆ·ç¨‹åºçš„åœ°å€ç©ºé—´ï¼Œæ³¨æ„ï¼Œæ˜¯ç”¨æˆ·ç¨‹åºçš„åœ°å€ç©ºé—´åˆ†ä¸ºè‹¥å¹²ä¸ªå›ºå®šå¤§å°çš„åŒºåŸŸï¼Œæˆä¸ºâ€œé¡µâ€æˆ–â€œé¡µé¢â€ã€‚æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿™ä¹Ÿé¡µå…¶å®æ˜¯ä¸å­˜åœ¨çš„ï¼Œåªæ˜¯ä¸€ç§åˆ’åˆ†å†…å­˜ç©ºé—´çš„æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§æ–¹å¼å°†ç”¨æˆ·çš„ç¨‹åº**â€œè‚¢è§£â€**äº†ï¼Œåˆ†æˆå¾ˆå¤šä¸ªå°çš„éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†ç§°ä¸ºä¸€ä¸ªâ€œé¡µâ€ã€‚\né€»è¾‘åœ°å€ å°†é€»è¾‘åœ°å€çš„å‰nä½ä½œä¸ºé¡µå·ï¼Œåé¢32-nä½ä½œä¸ºé¡µå†…åç§»é‡ã€‚\né¡µå†…ç¢ç‰‡ ç”±äºè¿›ç¨‹çš„æœ€åä¸€é¡µç»å¸¸è£…ä¸æ»¡ä¸€ä¸ªå—ï¼Œä»è€Œå½¢æˆäº†ä¸å¯åˆ©ç”¨çš„ç¢ç‰‡ï¼Œç§°ä¹‹ä¸º**â€œé¡µå†…ç¢ç‰‡â€**ã€‚\né¡µè¡¨ ä½œç”¨ï¼šå®ç°é¡µå·åˆ°ç‰©ç†å·çš„åœ°å€æ˜ å°„ã€‚\né¡µè¡¨æ˜¯è®°å½•é€»è¾‘ç©ºé—´ï¼ˆè™šæ‹Ÿå†…å­˜ï¼‰ä¸­æ¯ä¸€é¡µåœ¨å†…å­˜ä¸­å¯¹åº”çš„ç‰©ç†å—å·ã€‚ä½†å¹¶éæ¯ä¸€é¡µé€»è¾‘ç©ºé—´éƒ½ä¼šå®é™…å¯¹åº”ç€ä¸€ä¸ªç‰©ç†å—ï¼Œåªæœ‰å®é™…é©»ç•™åœ¨ç‰©ç†å†…å­˜ç©ºé—´ä¸­çš„é¡µæ‰ä¼šå¯¹åº”ç€ç‰©ç†å—ã€‚\nç³»ç»Ÿä¼šä¸ºæ¯ä¸€ä¸ªè¿›ç¨‹å»ºç«‹ä¸€å¼ é¡µè¡¨ï¼Œé¡µè¡¨æ˜¯éœ€è¦ä¸€ç›´é©»ç•™åœ¨ç‰©ç†å†…å­˜ä¸­çš„ï¼ˆå¤šçº§é¡µè¡¨é™¤å¤–ï¼‰ï¼Œå¦å¤–é¡µè¡¨çš„èµ·å€å’Œé•¿åº¦å­˜æ”¾åœ¨ PCBï¼ˆProcess Control Blockï¼‰è¿›ç¨‹æ§åˆ¶ç»“æ„ä½“ä¸­ã€‚\nå¯ä»¥åœ¨é¡µè¡¨çš„è¡¨é¡¹ä¸­è®¾ç½®ç›¸å…³çš„æƒé™æ§åˆ¶å­—æ®µï¼Œä¾‹å¦‚è®¾ç½®å­˜å–æ§åˆ¶å­—æ®µï¼Œç”¨äºä¿æŠ¤è¯¥å­˜å‚¨å—çš„è¯»å†™ï¼›è‹¥å­˜å–æ§åˆ¶å­—æ®µä¸º2ä½ï¼Œåˆ™å¯ä»¥è®¾ç½®è¯»/å†™ã€åªè¯»å’Œåªæ‰§è¡Œç­‰å­˜å–æ–¹å¼ã€‚\nç‰©ç†å— ç‰©ç†å—æ˜¯å®å®åœ¨åœ¨å­˜åœ¨äºå†…å­˜ä¸­çš„ï¼š\nåœ°å€å˜æ¢æœºæ„ ç”±äºæ‰§è¡Œé¢‘ç‡é«˜ï¼Œè¦æ±‚æ•ˆç‡æ¯”è¾ƒé«˜ï¼Œéœ€è¦ä½¿ç”¨ç¡¬ä»¶å®ç°ã€‚\nåœ¨ç³»ç»Ÿä¸­è®¾ç½®ä¸€ä¸ªé¡µè¡¨å¯„å­˜å™¨(PTR),å…¶ä¸­å­˜æ”¾é¡µè¡¨åœ¨å†…å­˜çš„èµ·å§‹åœ°å€å’Œé¡µè¡¨çš„é•¿åº¦ã€‚å¹³æ—¶è¿›ç¨‹æœªæ‰§è¡Œçš„æ—¶å€™ï¼Œé¡µè¡¨çš„èµ·å§‹åœ°å€å’Œé¡µè¡¨é•¿åº¦æ”¾åœ¨æœ¬è¿›ç¨‹çš„PCBä¸­ã€‚å½“è°ƒåº¦ç¨‹åºè°ƒåº¦åˆ°æŸä¸ªè¿›ç¨‹çš„æ—¶å€™ï¼Œæ‰å°†è¿™ä¸¤ä¸ªæ•°æ®è£…å…¥é¡µè¡¨å¯„å­˜å™¨ã€‚\n æ³¨æ„ï¼Œå½“åˆ›å»ºä¸€ä¸ªè¿›ç¨‹çš„æ—¶å€™ï¼Œå®ƒçš„é¡µè¡¨ä¹ŸåŒæ—¶åˆ›å»ºäº†ï¼Œåªä¸è¿‡åªåœ¨PCBå­˜å‚¨äº†é¡µè¡¨çš„èµ·å§‹åœ°å€å’Œé•¿åº¦ã€‚\n å˜æ¢è¿‡ç¨‹ï¼š\n è¿›ç¨‹è®¿é—®æŸä¸ªé€»è¾‘åœ°å€æ—¶ï¼Œåˆ†é¡µåœ°å€æœºæ„è‡ªåŠ¨å°†é€»è¾‘åœ°å€åˆ†ä¸ºé¡µå·å’Œé¡µå†…åœ°å€ é¡µå·å¤§äºé¡µè¡¨é•¿åº¦ï¼Œè¶Šç•Œé”™è¯¯;å¦åˆ™ç»§ç»­ä¸‹é¢çš„æ­¥éª¤ é¡µè¡¨é¡¹çš„åœ°å€ p = é¡µè¡¨èµ·å§‹åœ°å€ F + é¡µå· P * è¡¨é¡¹å¤§å° Sï¼Œä»è€Œå¾—åˆ°å¯¹åº”çš„ç‰©ç†å—å· B é¡µå’Œç‰©ç†å—çš„å¤§å°æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥ é¡µå†…åœ°å€=å—å†…åœ°å€ ç„¶å ç‰©ç†åœ°å€ = ç‰©ç†å—å· B * é¡µå¤§å° L + é¡µå†…åœ°å€ æ ¹æ®ç‰©ç†åœ°å€è¯»å–æ•°æ®  å¿«è¡¨çš„å˜æ¢æœºæ„\n åŸºç¡€çš„åœ°å€å˜æ¢æœºæ„çš„ç¼ºç‚¹ï¼š\nç”±äºé¡µè¡¨æ˜¯å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè¿™ä½¿å¾—CPUåœ¨æ¯å­˜å–ä¸€ä¸ªæ•°æ®æ—¶ï¼Œéƒ½éœ€è¦ä¸¤æ¬¡è®¿é—®å†…å­˜ã€‚ç¬¬ä¸€æ¬¡æ—¶è®¿é—®å†…å­˜ä¸­çš„é¡µè¡¨ï¼Œè·å–ç‰©ç†å—å·ï¼Œäºåç§»å€¼æ‹¼æ¥å¾—åˆ°ç‰©ç†åœ°å€ï¼Œç¬¬äºŒæ¬¡æ˜¯ä»ç¬¬ä¸€æ¬¡æ‰€å¾—ç‰©ç†åœ°å€è·å–æ‰€éœ€æ•°æ®(æˆ–è€…å‘è¯¥åœ°å€å†™å…¥æ•°æ®)ã€‚è¿™æ ·è®¡ç®—æœºçš„å¤„ç†é€Ÿåº¦å‡ ä¹é™ä½äº†1/2ï¼›\n ä¸ºäº†æé«˜åœ°å€å˜æ¢é€Ÿåº¦ï¼Œå¯åœ¨åœ°å€å˜æ¢æœºæ„ä¸­å¢è®¾ä¸€ä¸ªå…·æœ‰å¹¶è¡ŒæŸ¥è¯¢èƒ½åŠ›çš„ç‰¹æ®Šé«˜é€Ÿç¼“å†²å¯„å­˜å™¨ï¼Œåˆç§°ä¸º\u0026quot;è”æƒ³å¯„å­˜å™¨\u0026quot;æˆ–è€…â€œå¿«è¡¨â€ã€‚ä¿—ç§°TLBã€‚\nå¿«è¡¨ä¸é¡µè¡¨çš„åŠŸèƒ½ç±»ä¼¼ï¼Œå…¶å®å°±æ˜¯å°†ä¸€éƒ¨åˆ†é¡µè¡¨å­˜åˆ° CPU å†…éƒ¨çš„é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨ Cacheã€‚CPU å¯»å€æ—¶å…ˆåˆ°å¿«è¡¨æŸ¥è¯¢ç›¸åº”çš„é¡µè¡¨é¡¹å½¢æˆç‰©ç†åœ°å€ï¼Œå¦‚æœæŸ¥è¯¢ä¸åˆ°ï¼Œåˆ™åˆ°å†…å­˜ä¸­æŸ¥è¯¢ï¼Œå¹¶å°†å¯¹åº”é¡µè¡¨é¡¹è°ƒå…¥åˆ°å¿«è¡¨ä¸­ã€‚ä½†ï¼Œå¦‚æœå¿«è¡¨çš„å­˜å‚¨ç©ºé—´å·²æ»¡ï¼Œåˆ™éœ€è¦é€šè¿‡ç®—æ³•æ‰¾åˆ°ä¸€ä¸ªæš‚æ—¶ä¸å†éœ€è¦çš„é¡µè¡¨é¡¹ï¼Œå°†å®ƒæ¢å‡ºå†…å­˜ã€‚\nç”±äºæˆæœ¬çš„å…³ç³»ï¼Œå¿«è¡¨ä¸å¯èƒ½åšå¾—å¾ˆå¤§ï¼Œé€šå¸¸åªå­˜æ”¾ 16~512 ä¸ªé¡µè¡¨é¡¹ï¼Œè¿™å¯¹ä¸­ã€å°å‹ä½œä¸šæ¥è¯´ï¼Œå·²æœ‰å¯èƒ½æŠŠå…¨éƒ¨é¡µè¡¨é¡¹æ”¾åœ¨å¿«è¡¨ä¸­ï¼›ä½†å¯¹äºå¤§å‹ä½œä¸šè€Œè¨€ï¼Œåˆ™åªèƒ½å°†å…¶ä¸€éƒ¨åˆ†é¡µè¡¨é¡¹æ”¾å…¥å…¶ä¸­ã€‚ç”±äºå¯¹ç¨‹åºå’Œæ•°æ®çš„è®¿é—®å¾€å¾€å¸¦æœ‰å±€é™æ€§ï¼Œå› æ­¤ï¼Œæ®ç»Ÿè®¡ï¼Œä»å¿«è¡¨ä¸­èƒ½æ‰¾åˆ°æ‰€éœ€é¡µè¡¨é¡¹çš„æ¦‚ç‡å¯è¾¾ 90% ä»¥ä¸Šã€‚è¿™æ ·ï¼Œç”±äºå¢åŠ äº†åœ°å€å˜æ¢æœºæ„è€Œé€ æˆçš„é€Ÿåº¦æŸå¤±å¯å‡å°‘åˆ° 10% ä»¥ä¸‹ï¼Œè¾¾åˆ°äº†å¯æ¥å—çš„ç¨‹åº¦ã€‚\nä¸¤çº§é¡µè¡¨  ä¸€çº§é¡µè¡¨çš„ç¼ºé™·ï¼šç”±äºé¡µè¡¨å¿…é¡»è¿ç»­å­˜æ”¾ï¼Œå¹¶ä¸”éœ€è¦å¸¸é©»ç‰©ç†å†…å­˜ï¼Œå½“é€»è¾‘åœ°å€ç©ºé—´å¾ˆå¤§æ—¶ï¼Œå¯¼è‡´é¡µè¡¨å ç”¨å†…å­˜ç©ºé—´å¾ˆå¤§ã€‚\n æˆ‘ä»¬å¯ä»¥é‡‡ç”¨è¿™æ ·ä¸¤ä¸ªæ–¹æ³•æ¥è§£å†³è¿™ä¸€é—®é¢˜ï¼š\nâ‘  å¯¹äºé¡µè¡¨æ‰€éœ€çš„å†…å­˜ç©ºé—´ï¼Œå¯é‡‡ç”¨ç¦»æ•£åˆ†é…æ–¹å¼ï¼Œä»¥è§£å†³éš¾ä»¥æ‰¾åˆ°ä¸€å—è¿ç»­çš„å¤§å†…å­˜ç©ºé—´çš„é—®é¢˜ï¼›\nâ‘¡ åªå°†å½“å‰éœ€è¦çš„éƒ¨åˆ†é¡µè¡¨é¡¹è°ƒå…¥å†…å­˜ï¼Œå…¶ä½™çš„é¡µè¡¨é¡¹ä»é©»ç•™åœ¨ç£ç›˜ä¸Šï¼Œéœ€è¦æ—¶å†è°ƒå…¥ã€‚\näºŒçº§é¡µè¡¨çš„é¡µè¡¨é¡¹ï¼š\nè¿‡ç¨‹ï¼š\n å¤–å±‚é¡µè¡¨å¯„å­˜å™¨ä¸­ä¿å­˜äº†å¤–å±‚é¡µè¡¨çš„å§‹å€ï¼Œæ ¹æ®å¤–å±‚é¡µå·æŸ¥æ‰¾åˆ°å†…å±‚é¡µå·ã€‚ æ‰¾åˆ°æŒ‡å®šé¡µè¡¨åˆ†é¡µçš„å§‹å€ï¼Œæ ¹æ®å†…å±‚é¡µå·æ‰¾åˆ°ç‰©ç†å—å·ã€‚ ç‰©ç†å—å·På’Œé¡µå†…åœ°å€dç»„è£…æˆä¸€ä¸ªå®é™…çš„ç‰©ç†åœ°å€ã€‚  åœ¨é‡‡ç”¨ä¸¤çº§é¡µè¡¨ç»“æ„çš„æƒ…å†µä¸‹ï¼Œå¯¹äºæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œå¿…é¡»å°†å…¶å¤–å±‚é¡µè¡¨è°ƒå…¥å†…å­˜ï¼Œè€Œå¯¹äºå†…é¡µè¡¨åˆ™åªéœ€è°ƒå…¥ä¸€é¡µæˆ–å‡ é¡µã€‚ä¸ºäº†è¡¨å¾æŸé¡µçš„é¡µè¡¨æ˜¯å¦å·²ç»è°ƒå…¥å†…å­˜ï¼Œè¿˜åº”åœ¨å¤–å±‚é¡µè¡¨é¡¹ä¸­å¢è®¾ä¸€ä¸ªçŠ¶æ€ä½ Sï¼Œå…¶å€¼è‹¥ä¸º 0ï¼Œè¡¨ç¤ºè¯¥é¡µè¡¨åˆ†é¡µä¸åœ¨å†…å­˜ä¸­ï¼Œå¦åˆ™è¯´æ˜å…¶åˆ†é¡µå·²è°ƒå…¥å†…å­˜ã€‚è¿›ç¨‹è¿è¡Œæ—¶ï¼Œåœ°å€å˜æ¢æœºæ„æ ¹æ®é€»è¾‘åœ°å€ä¸­çš„ P1å»æŸ¥æ‰¾å¤–å±‚é¡µè¡¨ï¼›è‹¥æ‰€æ‰¾åˆ°çš„é¡µè¡¨é¡¹ä¸­çš„çŠ¶æ€ä½ä¸º 0ï¼Œåˆ™äº§ç”Ÿä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œè¯·æ±‚ OS å°†è¯¥é¡µè¡¨åˆ†é¡µè°ƒå…¥å†…å­˜ã€‚\nå¤šçº§é¡µè¡¨ å¤šçº§é¡µè¡¨å’ŒäºŒçº§é¡µè¡¨ç±»ä¼¼ã€‚å¤šçº§é¡µè¡¨å’ŒäºŒçº§é¡µè¡¨æ˜¯ä¸ºäº†èŠ‚çœç‰©ç†å†…å­˜ç©ºé—´ã€‚ä½¿å¾—é¡µè¡¨å¯ä»¥åœ¨å†…å­˜ä¸­ç¦»æ•£å­˜å‚¨ã€‚ï¼ˆå•çº§é¡µè¡¨ä¸ºäº†éšæœºè®¿é—®å¿…é¡»è¿ç»­å­˜å‚¨ï¼Œå¦‚æœè™šæ‹Ÿå†…å­˜ç©ºé—´å¾ˆå¤§ï¼Œå°±éœ€è¦å¾ˆå¤šé¡µè¡¨é¡¹ï¼Œå°±éœ€è¦å¾ˆå¤§çš„è¿ç»­å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯å¤šçº§é¡µè¡¨ä¸éœ€è¦ã€‚ï¼‰\n åˆ†é¡µå¼ç®¡ç†å¾ˆå¥½çš„é¿å…äº†å¤–éƒ¨ç¢ç‰‡ï¼Œä½†æ˜¯è¿˜æ˜¯å­˜åœ¨å†…éƒ¨ç¢ç‰‡ï¼Œå› ä¸ºç¨‹åºå¤§å°ä¸å¯èƒ½æ€»æ˜¯2çš„næ¬¡å¹‚ã€‚å¤šçº§é¡µè¡¨ä½¿å¾—é¡µè¡¨æ•°æ®å¯ä»¥ä¸éœ€è¦è¿ç»­å­˜å‚¨ï¼Œå³å®ç°äº†é¡µè¡¨çš„ç¦»æ•£å¼å­˜å‚¨ã€‚å¹¶ä¸”åœ¨å½“å¯¹åº”ç¨‹åºè¿è¡Œæ‰å°†å†…é¡µè¡¨æ•°æ®è°ƒå…¥å†…å­˜ä¹Ÿå‡å°‘äº†é¡µè¡¨æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ã€‚æœ¬è´¨ä¸Šæ˜¯æé«˜å†…å­˜åˆ©ç”¨ç‡ã€‚\n åˆ†æ®µå­˜å‚¨ç®¡ç†  ä¸ºäº†æ»¡è¶³ç”¨æˆ·è¦æ±‚çš„ä¸€ç§å­˜å‚¨ç®¡ç†çš„æ–¹å¼\n ä¸ºä»€ä¹ˆå¼•å…¥åˆ†æ®µå­˜å‚¨ç®¡ç†ï¼Ÿ\n é€šå¸¸çš„ç¨‹åºéƒ½å¯ä»¥åˆ†ä¸ºè‹¥å¹²ä¸ªæ®µï¼Œå¦‚ä¸»ç¨‹åºæ®µã€å­ç¨‹åºæ®µAã€å­ç¨‹åºæ®µBã€\u0026hellip;ã€æ•°æ®æ®µå’Œæ ˆæ®µç­‰ç­‰ã€‚ å®ç°å’Œæ»¡è¶³ä¿¡æ¯å…±äº«ã€ä¿¡æ¯ä¿æŠ¤ã€åŠ¨æ€é“¾æ¥ä»¥åŠä¿¡æ¯çš„åŠ¨æ€å¢é•¿  å¼•å…¥æ•ˆæœï¼š\n  æ–¹ä¾¿ç¼–ç¨‹\nä½¿ç”¨ç¬¦å·ä½œä¸ºæ®µåœ°å€è¿›è¡Œä½¿ç”¨ã€‚(æ¯ä¸ªæ®µéƒ½æ˜¯ä» 0 å¼€å§‹çš„ç‹¬ç«‹é€»è¾‘åœ°å€ç©ºé—´ï¼›)\n  ä¿¡æ¯å…±äº«\nåœ¨å®ç°å¯¹ç¨‹åºå’Œæ•°æ®çš„å…±äº«æ—¶ï¼Œæ˜¯ä»¥ä¿¡æ¯çš„é€»è¾‘å•ä½ä¸ºåŸºç¡€çš„ã€‚æ¯”å¦‚ï¼Œä¸ºäº†å…±äº«æŸä¸ªè¿‡ç¨‹ã€å‡½æ•°æˆ–æ–‡ä»¶ã€‚åˆ†é¡µç³»ç»Ÿä¸­çš„â€œé¡µâ€åªæ˜¯å­˜æ”¾ä¿¡æ¯çš„ç‰©ç†å•ä½(å—)ï¼Œå¹¶æ— å®Œæ•´çš„é€»è¾‘æ„ä¹‰ï¼Œè¿™æ ·ï¼Œä¸€ä¸ªå¯è¢«å…±äº«çš„è¿‡ç¨‹å¾€å¾€å¯èƒ½éœ€è¦å ç”¨æ•°åä¸ªé¡µé¢ï¼Œè¿™ä¸ºå®ç°å…±äº«å¢åŠ äº†å›°éš¾ã€‚æ®µå¯ä»¥æ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºè¯¥è¢«å…±äº«è¿‡ç¨‹å»ºç«‹ä¸€ä¸ªç‹¬ç«‹çš„æ®µï¼Œè¿™å°±æå¤§åœ°ç®€åŒ–äº†å…±äº«çš„å®ç°ã€‚\n  ä¿¡æ¯ä¿æŠ¤\nä¿¡æ¯ä¿æŠ¤åŒæ ·æ˜¯ä»¥ä¿¡æ¯çš„é€»è¾‘å•ä½ä¸ºåŸºç¡€çš„ï¼Œè€Œä¸”ç»å¸¸æ˜¯ä»¥ä¸€ä¸ªè¿‡ç¨‹ã€å‡½æ•°æˆ–æ–‡ä»¶ä¸ºåŸºæœ¬å•ä½è¿›è¡Œä¿æŠ¤çš„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¸Œæœ›å‡½æ•° A ä»…å…è®¸è¿›ç¨‹æ‰§è¡Œï¼Œè€Œä¸å…è®¸è¯»ï¼Œæ›´ä¸å…è®¸å†™ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬åªé¡»åœ¨åŒ…å«äº†å‡½æ•° A çš„è¿™ä¸ªæ®µä¸Šæ ‡ä¸Šåªæ‰§è¡Œæ ‡å¿—å³å¯ã€‚ä½†æ˜¯åœ¨åˆ†é¡µç³»ç»Ÿä¸­ï¼Œå‡½æ•° A å¯èƒ½è¦å ç”¨è‹¥å¹²ä¸ªé¡µé¢ï¼Œè€Œä¸”å…¶ä¸­çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªé¡µé¢è¿˜ä¼šè£…æœ‰å…¶å®ƒç¨‹åºæ®µçš„æ•°æ®ï¼Œå®ƒä»¬å¯èƒ½æœ‰ç€ä¸åŒçš„ä¿æŠ¤å±æ€§ï¼Œå¦‚å¯ä»¥å…è®¸è¿›ç¨‹è¯»å†™ï¼Œè¿™æ ·å°±å¾ˆéš¾å¯¹è¿™äº›é¡µé¢å®æ–½ç»Ÿä¸€çš„ä¿æŠ¤ï¼Œå› æ­¤ï¼Œåˆ†æ®µç®¡ç†æ–¹å¼èƒ½æ›´æœ‰æ•ˆå’Œæ–¹ä¾¿åœ°å®ç°å¯¹ä¿¡æ¯çš„ä¿æŠ¤åŠŸèƒ½ã€‚\n  åŠ¨æ€å¢é•¿\nåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¾€å¾€å­˜åœ¨ç€ä¸€äº›æ®µï¼Œå°¤å…¶æ˜¯æ•°æ®æ®µï¼Œåœ¨å®ƒä»¬çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œç”±äºæ•°æ®é‡çš„ä¸æ–­å¢åŠ ï¼Œè€Œä½¿æ•°æ®æ®µåŠ¨æ€å¢é•¿ï¼Œç›¸åº”åœ°å®ƒæ‰€éœ€è¦çš„å­˜å‚¨ç©ºé—´ä¹Ÿä¼šåŠ¨æ€å¢åŠ ã€‚ç„¶è€Œï¼Œå¯¹äºæ•°æ®æ®µç©¶ç«Ÿä¼šå¢é•¿åˆ°å¤šå¤§ï¼Œäº‹å…ˆåˆå¾ˆéš¾ç¡®åˆ‡åœ°çŸ¥é“ã€‚å¯¹æ­¤ï¼Œå¾ˆéš¾é‡‡å–é¢„å…ˆå¤šåˆ†é…çš„æ–¹æ³•è¿›è¡Œè§£å†³ã€‚å‰è¿°çš„å…¶å®ƒå‡ ç§å­˜å‚¨ç®¡ç†æ–¹å¼éƒ½éš¾ä»¥åº”ä»˜è¿™ç§åŠ¨æ€å¢é•¿çš„æƒ…å†µï¼Œè€Œåˆ†æ®µå­˜å‚¨ç®¡ç†æ–¹å¼å´èƒ½è¾ƒå¥½åœ°è§£å†³è¿™ä¸€é—®é¢˜ã€‚\n  åŠ¨æ€é“¾æ¥\nåŠ¨æ€é“¾æ¥åœ¨ä½œä¸šè¿è¡Œä¹‹å‰ï¼Œå¹¶ä¸æ˜¯æŠŠæ‰€æœ‰çš„ç›®æ ‡ç¨‹åºæ®µéƒ½é“¾æ¥èµ·æ¥ã€‚å½“ç¨‹åºè¦è¿è¡Œæ—¶ï¼Œé¦–å…ˆå°†ä¸»ç¨‹åºå’Œå®ƒç«‹å³éœ€è¦ç”¨åˆ°çš„ç›®æ ‡ç¨‹åºè£…å…¥å†…å­˜ï¼Œå³å¯åŠ¨è¿è¡Œã€‚è€Œåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“éœ€è¦è°ƒç”¨æŸä¸ªç›®æ ‡ç¨‹åºæ—¶ï¼Œæ‰å°†è¯¥æ®µ(ç›®æ ‡ç¨‹åº)è°ƒå…¥å†…å­˜å¹¶è¿›è¡Œé“¾æ¥ã€‚å¯è§ï¼ŒåŠ¨æ€é“¾æ¥è¦æ±‚çš„æ˜¯ä»¥ç›®æ ‡ç¨‹åº(å³æ®µ)ä½œä¸ºé“¾æ¥çš„åŸºæœ¬å•ä½,å› æ­¤ï¼Œåˆ†æ®µå­˜å‚¨ç®¡ç†æ–¹å¼éå¸¸é€‚åˆäºåŠ¨æ€é“¾æ¥ã€‚\n  å®ƒå°†ç”¨æˆ·ç¨‹åºçš„åœ°å€ç©ºé—´åˆ†ä¸ºè‹¥å¹²ä¸ªå¤§å°ä¸åŒçš„çš„æ®µï¼Œæ¯ä¸ªæ®µå¯ä»¥å®šä¹‰ä¸€ç»„å®Œæ•´çš„ä¿¡æ¯ã€‚\nåˆ†æ®µåœ°å€ æ®µå·è¡¨ç¤ºæ®µåï¼Œæ¯ä¸ªæ®µéƒ½ä»0å¼€å§‹ç¼–å€ï¼Œå¹¶ä¸”é‡‡ç”¨ä¸€æ®µè¿ç»­çš„åœ°å€ç©ºé—´ã€‚\nåœ¨è¯¥åœ°å€ç»“æ„ä¸­ï¼Œå…è®¸ä¸€ä¸ªä½œä¸šæœ€é•¿æœ‰64Kä¸ªæ®µï¼Œæ¯ä¸ªæ®µçš„æœ€å¤§é•¿åº¦ä¸º64KBã€‚\nåœ¨åˆ†æ®µå¼å­˜å‚¨ç®¡ç†ç³»ç»Ÿä¸­ï¼Œä¸ºæ¯ä¸€ä¸ªåˆ†æ®µåˆ†é…ä¸€ä¸ªè¿ç»­çš„åˆ†åŒºã€‚è¿›ç¨‹çš„å„ä¸ªæ®µï¼Œå¯ä»¥ç¦»æ•£åœ°è£…å…¥å†…å­˜ä¸­ä¸åŒçš„åˆ†åŒºä¸­ã€‚\næ®µè¡¨ ä½œç”¨ï¼šå®ç°ä»é€»è¾‘åœ°å€åˆ°ç‰©ç†å†…å­˜åŒºçš„æ˜ å°„ã€‚\nä¸ºäº†ä¿è¯ç¨‹åºèƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼Œå°±å¿…é¡»èƒ½å¤Ÿä»ç‰©ç†å†…å­˜ä¸­æ‰¾å‡ºæ¯ä¸ªé€»è¾‘æ®µæ‰€å¯¹åº”çš„ä½ç½®ã€‚ä¸ºæ­¤åœ¨ç³»ç»Ÿä¸­ä¼šä¸ºæ¯ä¸€ä¸ªè¿›ç¨‹å»ºç«‹ä¸€å¼ æ®µè¡¨ã€‚æ¯ä¸ªæ®µåœ¨è¡¨ä¸­æœ‰ä¸€ä¸ªè¡¨é¡¹ï¼Œå…¶ä¸­è®°å½•äº†è¯¥æ®µåœ¨å†…å­˜ä¸­çš„èµ·å§‹åœ°å€å’Œæ®µçš„é•¿åº¦ã€‚ä¸€èˆ¬å°†æ®µè¡¨ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚\nåœ¨é…ç½®äº†æ®µè¡¨ä¹‹åï¼Œæ‰§è¡Œçš„è¿‡ç¨‹å¯ä»¥é€šè¿‡æŸ¥æ‰¾æ®µè¡¨ï¼Œæ‰¾åˆ°æ¯ä¸€ä¸ªæ®µæ‰€å¯¹åº”çš„å†…å­˜åŒºã€‚\nåœ°å€å˜æ¢æœºæ„ ä¸ºäº†å®ç°è¿›ç¨‹ä»é€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„å˜æ¢åŠŸèƒ½ï¼Œåœ¨ç³»ç»Ÿè®¾ç½®äº†æ®µè¡¨å¯„å­˜å™¨ï¼Œç”¨äºå­˜æ”¾æ®µè¡¨çš„èµ·å§‹åœ°å€å’Œæ®µè¡¨é•¿åº¦TLã€‚\nåœ¨è¿›è¡Œåœ°å€å˜æ¢æ—¶ï¼Œç³»ç»Ÿå°†é€»è¾‘åœ°å€ä¸­çš„æ®µå·ä¸æ®µè¡¨é•¿åº¦TL è¿›è¡Œæ¯”è¾ƒã€‚è‹¥ S \u0026gt; TLï¼Œè¡¨ç¤ºæ®µå·å¤ªå¤§ï¼Œæ˜¯è®¿é—®è¶Šç•Œï¼Œäºæ˜¯äº§ç”Ÿè¶Šç•Œä¸­æ–­ä¿¡å·ã€‚è‹¥æœªè¶Šç•Œï¼Œåˆ™æ ¹æ®æ®µè¡¨çš„å§‹å€å’Œè¯¥æ®µçš„æ®µå·ï¼Œè®¡ç®—å‡ºè¯¥æ®µå¯¹åº”æ®µè¡¨é¡¹çš„ä½ç½®ï¼Œä»ä¸­è¯»å‡ºè¯¥æ®µåœ¨å†…å­˜çš„èµ·å§‹åœ°å€ã€‚ç„¶åï¼Œå†æ£€æŸ¥æ®µå†…åœ°å€ d æ˜¯å¦è¶…è¿‡è¯¥æ®µçš„æ®µé•¿ SLã€‚è‹¥è¶…è¿‡ï¼Œå³ d\u0026gt;SLï¼ŒåŒæ ·å‘å‡ºè¶Šç•Œä¸­æ–­ä¿¡å·ã€‚è‹¥æœªè¶Šç•Œï¼Œåˆ™å°†è¯¥æ®µçš„åŸºå€ d ä¸æ®µå†…åœ°å€ç›¸åŠ ï¼Œå³å¯å¾—åˆ°è¦è®¿é—®çš„å†…å­˜ã€‚\n åƒåˆ†é¡µç³»ç»Ÿä¸€æ ·ï¼Œå½“æ®µè¡¨æ”¾åœ¨å†…å­˜ä¸­æ—¶ï¼Œæ¯è¦è®¿é—®ä¸€ä¸ªæ•°æ®ï¼Œéƒ½é¡»è®¿é—®ä¸¤æ¬¡å†…å­˜ï¼Œä»è€Œæˆå€åœ°é™ä½äº†è®¡ç®—æœºçš„é€Ÿç‡ã€‚è§£å†³çš„æ–¹æ³•å’Œåˆ†é¡µç³»ç»Ÿç±»ä¼¼ï¼Œä¹Ÿå¢è®¾ä¸€ä¸ªè”ç›¸å­˜å‚¨å™¨ï¼Œç”¨äºä¿å­˜æœ€è¿‘å¸¸ç”¨çš„æ®µè¡¨é¡¹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”±äºæ˜¯æ®µæ¯”é¡µå¤§ï¼Œå› è€Œæ®µè¡¨é¡¹çš„æ•°ç›®æ¯”é¡µè¡¨é¡¹çš„æ•°ç›®å°‘ï¼Œå…¶æ‰€éœ€çš„è”æƒ³å­˜å‚¨å™¨ä¹Ÿç›¸å¯¹è¾ƒå°ï¼Œæ‰€ä»¥å¯ä»¥æ˜¾è‘—åœ°å‡å°‘å­˜å–æ•°æ®çš„æ—¶é—´ï¼Œä¸æ²¡æœ‰åœ°å€å˜æ¢çš„å¸¸è§„å­˜å‚¨å™¨ç›¸æ¯”è€Œè¨€ï¼Œå…¶å­˜å–é€Ÿåº¦çº¦æ…¢ 10%~15%ã€‚\n æ®µé¡µå¼å­˜å‚¨ç®¡ç† åˆ†é¡µå’Œåˆ†æ®µçš„åŒºåˆ« åˆ†é¡µå’Œåˆ†æ®µç³»ç»Ÿç›¸ä¼¼ä¹‹å¤„ï¼šä¸¤è€…éƒ½é‡‡ç”¨ç¦»æ•£åˆ†é…æ–¹å¼ï¼Œä¸”éƒ½æ˜¯é€šè¿‡åœ°å€æ˜ å°„æœºæ„å®ç°åœ°å€å˜æ¢ã€‚\nä½†åœ¨æ¦‚å¿µä¸Šä¸¤è€…å®Œå…¨ä¸åŒï¼Œä¸»è¦è¡¨ç°åœ¨ä¸‹è¿°ä¸‰ä¸ªæ–¹é¢ï¼š\n é¡µæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ï¼Œæ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ã€‚ é¡µçš„å¤§å°ç¡®å®šä¸”åˆç³»ç»Ÿå†³å®šï¼›æ®µçš„é•¿åº¦ä¸å›ºå®šï¼Œå†³å®šäºç”¨æˆ·æ‰€ç¼–å†™çš„ç¨‹åºã€‚ åˆ†é¡µçš„ç”¨æˆ·ç¨‹åºåœ°å€ç©ºé—´æ˜¯ä¸€ç»´çš„ï¼Œåªéœ€è¦ä¸€ä¸ªè®°å¿†ç¬¦å°±èƒ½å¤Ÿè¡¨ç¤ºä¸€ä¸ªåœ°å€ï¼›åˆ†æ®µçš„ç”¨æˆ·ç¨‹åºåœ°å€ç©ºé—´æ˜¯äºŒç»´çš„ï¼Œæ—¢éœ€è¦æ®µåï¼Œåˆéœ€è¦æ®µå†…åœ°å€ã€‚  æ®µé¡µå¼ åˆ†é¡µç³»ç»Ÿä»¥é¡µé¢ä½œä¸ºå†…å­˜åˆ†é…çš„åŸºæœ¬å•ä½ï¼Œèƒ½æœ‰æ•ˆåœ°æé«˜å†…å­˜åˆ©ç”¨ç‡ï¼Œè€Œåˆ†æ®µç³»ç»Ÿä»¥æ®µä½œä¸ºå†…å­˜åˆ†é…çš„åŸºæœ¬å•ä½ï¼Œå®ƒèƒ½å¤Ÿæ›´å¥½åœ°æ»¡è¶³ç”¨æˆ·å¤šæ–¹é¢çš„éœ€è¦ã€‚\næ®µé¡µå¼åœ°å€ç»“æ„ æ®µé¡µå¼åœ°å€ç»“æ„ç”±æ®µå·ã€æ®µå†…é¡µå·åŠé¡µå†…åœ°å€ä¸‰éƒ¨åˆ†æ‰€ç»„æˆ\næ®µé¡µå¼ç³»ç»Ÿçš„åŸºæœ¬åŸç†æ˜¯åˆ†æ®µå’Œåˆ†é¡µåŸç†çš„ç»“åˆï¼Œå³å…ˆå°†ç”¨æˆ·ç¨‹åºåˆ†æˆè‹¥å¹²ä¸ªæ®µï¼Œå†æŠŠæ¯ä¸ªæ®µåˆ†æˆè‹¥å¹²ä¸ªé¡µï¼Œå¹¶ä¸ºæ¯ä¸€ä¸ªæ®µèµ‹äºˆä¸€ä¸ªæ®µåã€‚å¦‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªä½œä¸šåœ°å€ç©ºé—´çš„ç»“æ„ã€‚è¯¥ä½œä¸šæœ‰ä¸‰ä¸ªæ®µï¼šä¸»ç¨‹åºæ®µã€å­ç¨‹åºæ®µå’Œæ•°æ®æ®µï¼›é¡µé¢å¤§å°ä¸º 4 KBï¼š\nåœ¨æ®µé¡µå¼ç³»ç»Ÿä¸­ï¼Œä¸ºäº†å®ç°ä»é€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„å˜æ¢ï¼Œç³»ç»Ÿä¸­éœ€è¦åŒæ—¶é…ç½®æ®µè¡¨å’Œé¡µè¡¨ã€‚æ®µè¡¨çš„å†…å®¹ä¸åˆ†æ®µç³»ç»Ÿç•¥æœ‰ä¸åŒï¼Œå®ƒä¸å†æ˜¯å†…å­˜å§‹å€å’Œæ®µé•¿ï¼Œè€Œæ˜¯é¡µè¡¨å§‹å€å’Œé¡µè¡¨é•¿åº¦ã€‚ä¸‹å›¾å±•ç¤ºå‡ºäº†åˆ©ç”¨æ®µè¡¨å’Œé¡µè¡¨è¿›è¡Œä»ç”¨æˆ·åœ°å€ç©ºé—´åˆ°ç‰©ç†(å†…å­˜)ç©ºé—´çš„æ˜ å°„ã€‚\nåœ°å€å˜æ¢è¿‡ç¨‹ åœ¨æ®µé¡µå¼ç³»ç»Ÿä¸­ï¼Œä¸ºäº†ä¾¿äºå®ç°åœ°å€å˜æ¢ï¼Œé¡»é…ç½®ä¸€ä¸ªæ®µè¡¨å¯„å­˜å™¨ï¼Œå…¶ä¸­å­˜æ”¾æ®µè¡¨å§‹å€å’Œæ®µé•¿ TLã€‚è¿›è¡Œåœ°å€å˜æ¢æ—¶ï¼Œé¦–å…ˆåˆ©ç”¨æ®µå· Sï¼Œå°†å®ƒä¸æ®µé•¿ TL è¿›è¡Œæ¯”è¾ƒã€‚è‹¥ S \u0026lt; TLï¼Œè¡¨ç¤ºæœªè¶Šç•Œï¼Œäºæ˜¯åˆ©ç”¨æ®µè¡¨å§‹å€å’Œæ®µå·æ¥æ±‚å‡ºè¯¥æ®µæ‰€å¯¹åº”çš„æ®µè¡¨é¡¹åœ¨æ®µè¡¨ä¸­çš„ä½ç½®ï¼Œä»ä¸­å¾—åˆ°è¯¥æ®µçš„é¡µè¡¨å§‹å€ï¼Œå¹¶åˆ©ç”¨é€»è¾‘åœ°å€ä¸­çš„æ®µå†…é¡µå· P æ¥è·å¾—å¯¹åº”é¡µçš„é¡µè¡¨é¡¹ä½ç½®ï¼Œä»ä¸­è¯»å‡ºè¯¥è´æ‰€åœ¨çš„ç‰©ç†å—å· bï¼Œå†åˆ©ç”¨å—å· b å’Œé¡µå†…åœ°å€æ¥æ„æˆç‰©ç†åœ°å€ã€‚\nåœ¨æ®µé¡µå¼ç³»ç»Ÿä¸­ï¼Œä¸ºäº†è·å¾—ä¸€æ¡æŒ‡ä»¤æˆ–æ•°æ®ï¼Œé¡»ä¸‰æ¬¡è®¿é—®å†…å­˜ã€‚ç¬¬ä¸€æ¬¡è®¿é—®æ˜¯è®¿é—®å†…å­˜ä¸­çš„æ®µè¡¨ï¼Œä»ä¸­å–å¾—é¡µè¡¨å§‹å€ï¼›ç¬¬äºŒæ¬¡è®¿é—®æ˜¯è®¿é—®å†…å­˜ä¸­çš„é¡µè¡¨ï¼Œä»ä¸­å–å‡ºè¯¥é¡µæ‰€åœ¨çš„ç‰©ç†å—å·ï¼Œå¹¶å°†è¯¥å—å·ä¸é¡µå†…åœ°å€ä¸€èµ·å½¢æˆæŒ‡ä»¤æˆ–æ•°æ®çš„ç‰©ç†åœ°å€ï¼›ç¬¬ä¸‰æ¬¡è®¿é—®æ‰æ˜¯çœŸæ­£ä»ç¬¬äºŒæ¬¡è®¿é—®æ‰€å¾—çš„åœ°å€ä¸­å–å‡ºæŒ‡ä»¤æˆ–æ•°æ®ã€‚\næ˜¾ç„¶ï¼Œè¿™ä½¿è®¿é—®å†…å­˜çš„æ¬¡æ•°å¢åŠ äº†è¿‘ä¸¤å€ã€‚ä¸ºäº†æé«˜æ‰§è¡Œé€Ÿåº¦ï¼Œåœ¨åœ°å€å˜æ¢æœºæ„ä¸­å¢è®¾ä¸€ä¸ªé«˜é€Ÿç¼“å†²å¯„å­˜å™¨ã€‚æ¯æ¬¡è®¿é—®å®ƒæ—¶ï¼Œéƒ½é¡»åŒæ—¶åˆ©ç”¨æ®µå·å’Œé¡µå·å»æ£€ç´¢é«˜é€Ÿç¼“å­˜ï¼Œè‹¥æ‰¾åˆ°åŒ¹é…çš„è¡¨é¡¹ï¼Œä¾¿å¯ä»ä¸­å¾—åˆ°ç›¸åº”é¡µçš„ç‰©ç†å—å·ï¼Œç”¨æ¥ä¸é¡µå†…åœ°å€ä¸€èµ·å½¢æˆç‰©ç†åœ°å€ï¼šè‹¥æœªæ‰¾åˆ°åŒ¹é…è¡¨é¡¹ï¼Œåˆ™ä»éœ€ç¬¬ä¸‰æ¬¡è®¿é—®å†…å­˜ã€‚\nå‚è€ƒé“¾æ¥ï¼š\n ã€æ“ä½œç³»ç»Ÿ - 4ã€‘åŠ¨æ€åˆ†åŒºåˆ†é…ç®—æ³• ç¨‹åºçš„é“¾æ¥çš„ä¸‰ç§æ–¹å¼ è¿ç»­åˆ†é…ç®¡ç†æ–¹å¼ æ·±å…¥ç†è§£æ“ä½œç³»ç»Ÿä¹‹â€”â€”åˆ†é¡µå¼å­˜å‚¨ç®¡ç† ã€Šè®¡ç®—æœºæ“ä½œç³»ç»Ÿã€‹(ç¬¬å››ç‰ˆ)  ","description":"","id":69,"section":"posts","tags":["Linux"],"title":"Linuxå†…å­˜ç®¡ç†","uri":"https://hugo.jiahongw.com/zh/posts/linux/memory-control/"},{"content":"ç½‘ç»œå±‚ ç½‘é™…åè®®IPæ˜¯TCP/IPä½“ç³»ä¸­ä¸¤ä¸ªæœ€ä¸»è¦çš„åè®®ä¹‹ä¸€[STEV94][COME06][FORO10]ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„å› ç‰¹ç½‘æ ‡å‡†åè®®ä¹‹ä¸€ã€‚\nä¸IPåè®®é…å¥—ä½¿ç”¨çš„è¿˜æœ‰ä¸‰ä¸ªåè®®ï¼š\n åœ°å€è§£æåè®®ARP (Address Resolution Protocol) ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP (Internet Control Message Protocol) ç½‘é™…ç»„ç®¡ç†åè®®IGMP (Internet Group Management Protocol)  åœ¨è¿™ä¸€å±‚ä¸­ï¼ŒARPç”»åœ¨æœ€ä¸‹é¢ï¼Œå› ä¸ºIPç»å¸¸è¦ä½¿ç”¨è¿™ä¸ªåè®®ã€‚ICMPå’ŒIGMPç”»åœ¨è¿™ä¸€å±‚çš„ä¸Šéƒ¨ï¼Œå› ä¸ºå®ƒä»¬è¦ä½¿ç”¨IPåè®®ã€‚ç”±äºç½‘é™…åè®®IPæ˜¯ç”¨æ¥ä½¿äº’è¿èµ·æ¥çš„è®¸å¤šè®¡ç®—æœºç½‘ç»œèƒ½å¤Ÿè¿›è¡Œé€šä¿¡ï¼Œå› æ­¤TCP/IPä½“ç³»ä¸­çš„ç½‘ç»œå±‚å¸¸å¸¸ç§°ä¸ºç½‘é™…å±‚(internet layer)ï¼Œæˆ–IPå±‚ã€‚\nè™šæ‹Ÿäº’è¿ç½‘ç»œ  ä»ä¸€èˆ¬çš„æ¦‚å¿µæ¥è®²ï¼Œå°†ç½‘ç»œäº’ç›¸è¿æ¥èµ·æ¥è¦ä½¿ç”¨ä¸€äº›ä¸­é—´è®¾å¤‡ã€‚æ ¹æ®ä¸­é—´è®¾å¤‡æ‰€åœ¨çš„å±‚æ¬¡ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹å››ç§ä¸åŒçš„ä¸­é—´è®¾å¤‡ï¼š\n(1) ç‰©ç†å±‚ä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšè½¬å‘å™¨(repeater)ã€‚\n(2) æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšç½‘æ¡¥æˆ–æ¡¥æ¥å™¨(bridge)ã€‚\n(3) ç½‘ç»œå±‚ä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšè·¯ç”±å™¨(router)[æ’å›¾]ã€‚\n(4) åœ¨ç½‘ç»œå±‚ä»¥ä¸Šä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšç½‘å…³(gateway)ã€‚\nç”¨ç½‘å…³è¿æ¥ä¸¤ä¸ªä¸å…¼å®¹çš„ç³»ç»Ÿéœ€è¦åœ¨é«˜å±‚è¿›è¡Œåè®®çš„è½¬æ¢ã€‚\n IPç½‘ï¼š\nå¼‚æ„çš„äº’è”ç½‘é“¾è·¯\nH1â†’R1â†’R2â†’R3â†’R4â†’R5â†’H2\nARPåè®®  å·²ç»çŸ¥é“äº†ä¸€ä¸ªæœºå™¨ï¼ˆä¸»æœºæˆ–è·¯ç”±å™¨ï¼‰çš„IPåœ°å€ï¼Œéœ€è¦æ‰¾å‡ºå…¶ç›¸åº”çš„ç¡¬ä»¶åœ°å€\n ARPåè®®å·¥ä½œåŸç†ï¼š\nå½“ä¸»æœºAè¦å‘æœ¬å±€åŸŸç½‘ä¸Šçš„æŸä¸ªä¸»æœºBå‘é€IPæ•°æ®æŠ¥æ—¶ï¼Œå°±å…ˆåœ¨å…¶ARPé«˜é€Ÿç¼“å­˜ä¸­æŸ¥çœ‹æœ‰æ— ä¸»æœºBçš„IPåœ°å€ã€‚å¦‚æœ‰ï¼Œå°±åœ¨ARPé«˜é€Ÿç¼“å­˜ä¸­æŸ¥å‡ºå…¶å¯¹åº”çš„ç¡¬ä»¶åœ°å€ï¼Œå†æŠŠè¿™ä¸ªç¡¬ä»¶åœ°å€å†™å…¥MACå¸§ï¼Œç„¶åé€šè¿‡å±€åŸŸç½‘æŠŠè¯¥MACå¸§å‘å¾€æ­¤ç¡¬ä»¶åœ°å€ã€‚\nå½“æ‰¾ä¸åˆ°æ—¶ï¼Œæ‰§è¡Œä¸‹é¢çš„æ“ä½œï¼š\n ARPè¿›ç¨‹åœ¨æœ¬å±€åŸŸç½‘ä¸Šå¹¿æ’­å‘é€ä¸€ä¸ªARPè¯·æ±‚åˆ†ç»„ åœ¨æœ¬å±€åŸŸç½‘ä¸Šçš„æ‰€æœ‰ä¸»æœºä¸Šè¿è¡Œçš„ARPè¿›ç¨‹éƒ½æ”¶åˆ°æ­¤ARPè¯·æ±‚åˆ†ç»„ ä¸»æœºBçš„IPåœ°å€ä¸ARPè¯·æ±‚åˆ†ç»„ä¸­è¦æŸ¥è¯¢çš„IPåœ°å€ä¸€è‡´ï¼Œå°±æ”¶ä¸‹è¿™ä¸ªARPè¯·æ±‚åˆ†ç»„ï¼Œå¹¶å‘ä¸»æœºAå‘é€ARPå“åº”åˆ†ç»„ï¼Œå¹¶åœ¨è¿™ä¸ªARPå“åº”åˆ†ç»„ä¸­å†™å…¥è‡ªå·±çš„ç¡¬ä»¶åœ°å€ã€‚  åœ¨ç½‘ç»œé“¾è·¯ä¸Šä¼ é€çš„å¸§æœ€ç»ˆæ˜¯æŒ‰ç…§ç¡¬ä»¶åœ°å€æ‰¾åˆ°ç›®çš„ä¸»æœºçš„ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ç›´æ¥ä½¿ç”¨ç¡¬ä»¶åœ°å€è¿›è¡Œé€šä¿¡ï¼Œè€Œæ˜¯è¦ä½¿ç”¨æŠ½è±¡çš„IPåœ°å€å¹¶è°ƒç”¨ARPæ¥å¯»æ‰¾å‡ºç›¸åº”çš„ç¡¬ä»¶åœ°å€å‘¢ï¼Ÿ\nç”±äºå…¨ä¸–ç•Œå­˜åœ¨ç€å„å¼å„æ ·çš„ç½‘ç»œï¼Œå®ƒä»¬ä½¿ç”¨ä¸åŒçš„ç¡¬ä»¶åœ°å€ã€‚è¦ä½¿è¿™äº›å¼‚æ„ç½‘ç»œèƒ½å¤Ÿäº’ç›¸é€šä¿¡å°±å¿…é¡»è¿›è¡Œéå¸¸å¤æ‚çš„ç¡¬ä»¶åœ°å€è½¬æ¢å·¥ä½œï¼Œå› æ­¤ç”±ç”¨æˆ·æˆ–ç”¨æˆ·ä¸»æœºæ¥å®Œæˆè¿™é¡¹å·¥ä½œå‡ ä¹æ˜¯ä¸å¯èƒ½çš„äº‹ã€‚ä½†ç»Ÿä¸€çš„IPåœ°å€æŠŠè¿™ä¸ªå¤æ‚é—®é¢˜è§£å†³äº†ã€‚è¿æ¥åˆ°å› ç‰¹ç½‘çš„ä¸»æœºåªéœ€æ‹¥æœ‰ç»Ÿä¸€çš„IPåœ°å€ï¼Œå®ƒä»¬ä¹‹é—´çš„é€šä¿¡å°±åƒè¿æ¥åœ¨åŒä¸€ä¸ªç½‘ç»œä¸Šé‚£æ ·ç®€å•æ–¹ä¾¿ï¼Œå› ä¸ºä¸Šè¿°çš„è°ƒç”¨ARPçš„å¤æ‚è¿‡ç¨‹éƒ½æ˜¯ç”±è®¡ç®—æœºè½¯ä»¶è‡ªåŠ¨è¿›è¡Œçš„ï¼Œå¯¹ç”¨æˆ·æ¥è¯´æ˜¯çœ‹ä¸è§è¿™ç§è°ƒç”¨è¿‡ç¨‹çš„ã€‚\nIPæ•°æ®æŠ¥ IPæŠ¥æ–‡æ ¼å¼ï¼š\nç‰‡åç§»çš„åˆ—å­ï¼š\nä¸€æ•°æ®æŠ¥çš„æ€»é•¿åº¦ä¸º3 820å­—èŠ‚ï¼Œå…¶æ•°æ®éƒ¨åˆ†ä¸º3 800å­—èŠ‚é•¿ï¼ˆä½¿ç”¨å›ºå®šé¦–éƒ¨ï¼‰ï¼Œéœ€è¦åˆ†ç‰‡ä¸ºé•¿åº¦ä¸è¶…è¿‡1 420å­—èŠ‚çš„æ•°æ®æŠ¥ç‰‡ã€‚å› å›ºå®šé¦–éƒ¨é•¿åº¦ä¸º20å­—èŠ‚ï¼Œå› æ­¤æ¯ä¸ªæ•°æ®æŠ¥ç‰‡çš„æ•°æ®éƒ¨åˆ†é•¿åº¦ä¸èƒ½è¶…è¿‡1 400å­—èŠ‚ã€‚äºæ˜¯åˆ†ä¸º3ä¸ªæ•°æ®æŠ¥ç‰‡ï¼Œå…¶æ•°æ®éƒ¨åˆ†çš„é•¿åº¦åˆ†åˆ«ä¸º1 400ï¼Œ1 400å’Œ1000å­—èŠ‚ã€‚åŸå§‹æ•°æ®æŠ¥é¦–éƒ¨è¢«å¤åˆ¶ä¸ºå„æ•°æ®æŠ¥ç‰‡çš„é¦–éƒ¨ï¼Œä½†å¿…é¡»ä¿®æ”¹æœ‰å…³å­—æ®µçš„å€¼ã€‚ä¸‹å¦‚ç»™å‡ºåˆ†ç‰‡åå¾—å‡ºçš„ç»“æœï¼ˆè¯·æ³¨æ„ç‰‡åç§»çš„æ•°å€¼ï¼‰\nä¸‹é¢æ˜¯æ•°æ®æŠ¥é¦–éƒ¨ä¸åˆ†ç‰‡æœ‰å…³çš„å­—æ®µä¸­çš„æ•°å€¼ï¼Œå…¶ä¸­æ ‡è¯†å­—æ®µçš„å€¼æ˜¯ä»»æ„ç»™å®šçš„ï¼ˆ12345ï¼‰ã€‚å…·æœ‰ç›¸åŒæ ‡è¯†çš„æ•°æ®æŠ¥ç‰‡åœ¨ç›®çš„ç«™å°±å¯æ— è¯¯åœ°é‡è£…æˆåŸæ¥çš„æ•°æ®æŠ¥ã€‚\né¦–éƒ¨æ£€éªŒå’Œ å 16ä½ã€‚è¿™ä¸ªå­—æ®µåªæ£€éªŒæ•°æ®æŠ¥çš„é¦–éƒ¨ï¼Œä½†ä¸åŒ…æ‹¬æ•°æ®éƒ¨åˆ†\nè¿™æ˜¯å› ä¸ºæ•°æ®æŠ¥æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨ï¼Œè·¯ç”±å™¨éƒ½è¦é‡æ–°è®¡ç®—ä¸€ä¸‹é¦–éƒ¨æ£€éªŒå’Œï¼ˆä¸€äº›å­—æ®µï¼Œå¦‚ç”Ÿå­˜æ—¶é—´ã€æ ‡å¿—ã€ç‰‡åç§»ç­‰éƒ½å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼‰ã€‚ä¸æ£€éªŒæ•°æ®éƒ¨åˆ†å¯å‡å°‘è®¡ç®—çš„å·¥ä½œé‡ã€‚ä¸ºäº†è¿›ä¸€æ­¥å‡å°è®¡ç®—æ£€éªŒå’Œçš„å·¥ä½œé‡ï¼ŒIPé¦–éƒ¨çš„æ£€éªŒå’Œä¸é‡‡ç”¨å¤æ‚çš„CRCæ£€éªŒç è€Œé‡‡ç”¨ä¸‹é¢çš„ç®€å•è®¡ç®—æ–¹æ³•ï¼šåœ¨å‘é€æ–¹ï¼Œå…ˆæŠŠIPæ•°æ®æŠ¥é¦–éƒ¨åˆ’åˆ†ä¸ºè®¸å¤š16ä½å­—çš„åºåˆ—ï¼Œå¹¶æŠŠæ£€éªŒå’Œå­—æ®µç½®é›¶ã€‚ç”¨åç ç®—æœ¯è¿ç®—[æ’å›¾]æŠŠæ‰€æœ‰16ä½å­—ç›¸åŠ åï¼Œå°†å¾—åˆ°çš„å’Œçš„åç å†™å…¥æ£€éªŒå’Œå­—æ®µã€‚æ¥æ”¶æ–¹æ”¶åˆ°æ•°æ®æŠ¥åï¼Œå°†é¦–éƒ¨çš„æ‰€æœ‰16ä½å­—å†ä½¿ç”¨åç ç®—æœ¯è¿ç®—ç›¸åŠ ä¸€æ¬¡ã€‚å°†å¾—åˆ°çš„å’Œå–åç ï¼Œå³å¾—å‡ºæ¥æ”¶æ–¹æ£€éªŒå’Œçš„è®¡ç®—ç»“æœã€‚è‹¥é¦–éƒ¨æœªå‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œåˆ™æ­¤ç»“æœå¿…ä¸º0ï¼Œäºæ˜¯å°±ä¿ç•™è¿™ä¸ªæ•°æ®æŠ¥ã€‚å¦åˆ™å³è®¤ä¸ºå‡ºå·®é”™ï¼Œå¹¶å°†æ­¤æ•°æ®æŠ¥ä¸¢å¼ƒã€‚\nIPå±‚è½¬å‘åˆ†ç»„ ç½‘ç»œæ‹“æ‰‘å›¾ï¼š\nåœ¨ç®€åŒ–å›¾ä¸­ï¼Œç½‘ç»œå˜æˆäº†ä¸€æ¡é“¾è·¯ï¼Œä½†æ¯ä¸€ä¸ªè·¯ç”±å™¨æ—è¾¹éƒ½æ³¨æ˜å…¶IPåœ°å€ã€‚ä½¿ç”¨è¿™æ ·çš„ç®€åŒ–å›¾ï¼Œå¯ä»¥ä½¿æˆ‘ä»¬ä¸ç”¨å…³å¿ƒæŸä¸ªç½‘ç»œå†…éƒ¨çš„å…·ä½“æ‹“æ‰‘ä»¥åŠè¿æ¥åœ¨è¯¥ç½‘ç»œä¸Šæœ‰å¤šå°‘å°è®¡ç®—æœºï¼Œå› ä¸ºè¿™äº›å¯¹äºç ”ç©¶åˆ†ç»„è½¬å‘é—®é¢˜å¹¶æ²¡æœ‰ä»€ä¹ˆå…³ç³»ã€‚è¿™æ ·çš„ç®€åŒ–å›¾å¼ºè°ƒäº†åœ¨äº’è”ç½‘ä¸Šè½¬å‘åˆ†ç»„æ—¶ï¼Œæ˜¯ä»ä¸€ä¸ªè·¯ç”±å™¨è½¬å‘åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ã€‚\næ€»ä¹‹ï¼Œåœ¨è·¯ç”±è¡¨ä¸­ï¼Œå¯¹æ¯ä¸€æ¡è·¯ç”±æœ€ä¸»è¦çš„æ˜¯ä»¥ä¸‹ä¸¤ä¸ªä¿¡æ¯ï¼š\nï¼ˆç›®çš„ç½‘ç»œåœ°å€ï¼Œä¸‹ä¸€è·³åœ°å€ï¼‰\näºæ˜¯ï¼Œæˆ‘ä»¬å°±æ ¹æ®ç›®çš„ç½‘ç»œåœ°å€æ¥ç¡®å®šä¸‹ä¸€è·³è·¯ç”±å™¨ï¼Œè¿™æ ·åšå¾—å‡ºä»¥ä¸‹çš„ç»“æœã€‚\n(1) IPæ•°æ®æŠ¥æœ€ç»ˆä¸€å®šå¯ä»¥æ‰¾åˆ°ç›®çš„ä¸»æœºæ‰€åœ¨ç›®çš„ç½‘ç»œä¸Šçš„è·¯ç”±å™¨ï¼ˆå¯èƒ½è¦é€šè¿‡å¤šæ¬¡çš„é—´æ¥äº¤ä»˜ï¼‰ã€‚\n(2) åªæœ‰åˆ°è¾¾æœ€åä¸€ä¸ªè·¯ç”±å™¨æ—¶ï¼Œæ‰è¯•å›¾å‘ç›®çš„ä¸»æœºè¿›è¡Œç›´æ¥äº¤ä»˜ã€‚\nç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP ä¸ºäº†æ›´æœ‰æ•ˆåœ°è½¬å‘IPæ•°æ®æŠ¥å’Œæé«˜äº¤ä»˜æˆåŠŸçš„æœºä¼šï¼Œåœ¨ç½‘é™…å±‚ä½¿ç”¨äº†ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMPã€‚\n ICMPå…è®¸ä¸»æœºæˆ–è·¯ç”±å™¨æŠ¥å‘Šå·®é”™æƒ…å†µå’Œæä¾›æœ‰å…³å¼‚å¸¸æƒ…å†µçš„æŠ¥å‘Š.ä¸€ä¸ªæ–°æ­å»ºå¥½çš„ç½‘ç»œï¼Œå¾€å¾€éœ€è¦å…ˆè¿›è¡Œä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼Œæ¥éªŒè¯ç½‘ç»œæ˜¯å¦ç•…é€šï¼›ä½†æ˜¯IPåè®®å¹¶ä¸æä¾›å¯é ä¼ è¾“ã€‚å¦‚æœä¸¢åŒ…äº†ï¼ŒIPåè®®å¹¶ä¸èƒ½é€šçŸ¥ä¼ è¾“å±‚æ˜¯å¦ä¸¢åŒ…ä»¥åŠä¸¢åŒ…çš„åŸå› ã€‚æ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦ä¸€ç§åè®®æ¥å®Œæˆè¿™æ ·çš„åŠŸèƒ½â€“ICMPåè®®ã€‚\n ICMPæŠ¥æ–‡æ ¼å¼\nICMPæŠ¥æ–‡çš„ç§ç±»æœ‰ä¸¤ç§ï¼Œå³ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡å’ŒICMPè¯¢é—®æŠ¥æ–‡ã€‚\nå‡ ç§å¸¸ç”¨çš„ICMPæŠ¥æ–‡ç±»å‹\nICMPæŠ¥æ–‡çš„ä»£ç å­—æ®µæ˜¯ä¸ºäº†è¿›ä¸€æ­¥åŒºåˆ†æŸç§ç±»å‹ä¸­çš„å‡ ç§ä¸åŒçš„æƒ…å†µã€‚æ£€éªŒå’Œå­—æ®µç”¨æ¥æ£€éªŒæ•´ä¸ªICMPæŠ¥æ–‡ã€‚æˆ‘ä»¬åº”å½“è¿˜è®°å¾—ï¼ŒIPæ•°æ®æŠ¥é¦–éƒ¨çš„æ£€éªŒå’Œå¹¶ä¸æ£€éªŒIPæ•°æ®æŠ¥çš„å†…å®¹ï¼Œå› æ­¤ä¸èƒ½ä¿è¯ç»è¿‡ä¼ è¾“çš„ICMPæŠ¥æ–‡ä¸äº§ç”Ÿå·®é”™ã€‚\nICMPå·®é”™æŠ¥å‘Š ICMPå·®é”™æŠ¥æ–‡å…±æœ‰äº”ç§ï¼Œå³ï¼š\n  ç»ˆç‚¹ä¸å¯è¾¾ å½“è·¯ç”±å™¨æˆ–ä¸»æœºä¸èƒ½äº¤ä»˜æ•°æ®æŠ¥æ—¶å°±å‘æºç‚¹å‘é€ç»ˆç‚¹ä¸å¯è¾¾æŠ¥æ–‡ã€‚\n  æºç‚¹æŠ‘åˆ¶ å½“è·¯ç”±å™¨æˆ–ä¸»æœºç”±äºæ‹¥å¡è€Œä¸¢å¼ƒæ•°æ®æŠ¥æ—¶ï¼Œå°±å‘æºç‚¹å‘é€æºç‚¹æŠ‘åˆ¶æŠ¥æ–‡ï¼Œä½¿æºç‚¹çŸ¥é“åº”å½“æŠŠæ•°æ®æŠ¥çš„å‘é€é€Ÿç‡æ”¾æ…¢ã€‚\n  æ—¶é—´è¶…è¿‡ å½“è·¯ç”±å™¨æ”¶åˆ°ç”Ÿå­˜æ—¶é—´ä¸ºé›¶çš„æ•°æ®æŠ¥æ—¶ï¼Œé™¤ä¸¢å¼ƒè¯¥æ•°æ®æŠ¥å¤–ï¼Œè¿˜è¦å‘æºç‚¹å‘é€æ—¶é—´è¶…è¿‡æŠ¥æ–‡ã€‚å½“ç»ˆç‚¹åœ¨é¢„å…ˆè§„å®šçš„æ—¶é—´å†…ä¸èƒ½æ”¶åˆ°ä¸€ä¸ªæ•°æ®æŠ¥çš„å…¨éƒ¨æ•°æ®æŠ¥ç‰‡æ—¶ï¼Œå°±æŠŠå·²æ”¶åˆ°çš„æ•°æ®æŠ¥ç‰‡éƒ½ä¸¢å¼ƒï¼Œå¹¶å‘æºç‚¹å‘é€æ—¶é—´è¶…è¿‡æŠ¥æ–‡ã€‚\n  å‚æ•°é—®é¢˜ å½“è·¯ç”±å™¨æˆ–ç›®çš„ä¸»æœºæ”¶åˆ°çš„æ•°æ®æŠ¥çš„é¦–éƒ¨ä¸­æœ‰çš„å­—æ®µçš„å€¼ä¸æ­£ç¡®æ—¶ï¼Œå°±ä¸¢å¼ƒè¯¥æ•°æ®æŠ¥ï¼Œå¹¶å‘æºç‚¹å‘é€å‚æ•°é—®é¢˜æŠ¥æ–‡ã€‚\n  æ”¹å˜è·¯ç”±ï¼ˆé‡å®šå‘ï¼‰ è·¯ç”±å™¨æŠŠæ”¹å˜è·¯ç”±æŠ¥æ–‡å‘é€ç»™ä¸»æœºï¼Œè®©ä¸»æœºçŸ¥é“ä¸‹æ¬¡åº”å°†æ•°æ®æŠ¥å‘é€ç»™å¦å¤–çš„è·¯ç”±å™¨ï¼ˆå¯é€šè¿‡æ›´å¥½çš„è·¯ç”±ï¼‰ã€‚\nå¦‚æœé»˜è®¤è·¯ç”±å™¨å‘ç°ä¸»æœºå‘å¾€æŸä¸ªç›®çš„åœ°å€çš„æ•°æ®æŠ¥çš„æœ€ä½³è·¯ç”±ä¸åº”å½“ç»è¿‡é»˜è®¤è·¯ç”±å™¨è€Œæ˜¯åº”å½“ç»è¿‡ç½‘ç»œä¸Šçš„å¦ä¸€ä¸ªè·¯ç”±å™¨Ræ—¶ï¼Œå°±ç”¨æ”¹å˜è·¯ç”±æŠ¥æ–‡æŠŠè¿™æƒ…å†µå‘Šè¯‰ä¸»æœºã€‚äºæ˜¯ï¼Œè¯¥ä¸»æœºå°±åœ¨å…¶è·¯ç”±è¡¨ä¸­å¢åŠ ä¸€ä¸ªé¡¹ç›®ï¼šåˆ°æŸæŸç›®çš„åœ°å€åº”ç»è¿‡è·¯ç”±å™¨R ï¼ˆè€Œä¸æ˜¯é»˜è®¤è·¯ç”±å™¨ï¼‰ã€‚\n  æ‰€æœ‰çš„ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ä¸­çš„æ•°æ®å­—æ®µéƒ½å…·æœ‰åŒæ ·çš„æ ¼å¼ï¼š\nä¸‹é¢æ˜¯ä¸åº”å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡çš„å‡ ç§æƒ…å†µã€‚\nâ— å¯¹ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ä¸å†å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚\nâ— å¯¹ç¬¬ä¸€ä¸ªåˆ†ç‰‡çš„æ•°æ®æŠ¥ç‰‡çš„æ‰€æœ‰åç»­æ•°æ®æŠ¥ç‰‡éƒ½ä¸å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚\nâ— å¯¹å…·æœ‰å¤šæ’­åœ°å€çš„æ•°æ®æŠ¥éƒ½ä¸å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚\nâ— å¯¹å…·æœ‰ç‰¹æ®Šåœ°å€ï¼ˆå¦‚127.0.0.0æˆ–0.0.0.0ï¼‰çš„æ•°æ®æŠ¥ä¸å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚\nICMPè¯¢é—®æŠ¥æ–‡ å¸¸ç”¨çš„ICMPè¯¢é—®æŠ¥æ–‡æœ‰ä¸¤ç§ï¼Œå³:\n å›é€è¯·æ±‚å’Œå›ç­” ICMPå›é€è¯·æ±‚æŠ¥æ–‡æ˜¯ç”±ä¸»æœºæˆ–è·¯ç”±å™¨å‘ä¸€ä¸ªç‰¹å®šçš„ç›®çš„ä¸»æœºå‘å‡ºçš„è¯¢é—®ã€‚æ”¶åˆ°æ­¤æŠ¥æ–‡çš„ä¸»æœºå¿…é¡»ç»™æºä¸»æœºæˆ–è·¯ç”±å™¨å‘é€ICMPå›é€å›ç­”æŠ¥æ–‡ã€‚è¿™ç§è¯¢é—®æŠ¥æ–‡ç”¨æ¥æµ‹è¯•ç›®çš„ç«™æ˜¯å¦å¯è¾¾ä»¥åŠäº†è§£å…¶æœ‰å…³çŠ¶æ€ã€‚ æ—¶é—´æˆ³è¯·æ±‚å’Œå›ç­” ICMPæ—¶é—´æˆ³è¯·æ±‚æŠ¥æ–‡æ˜¯è¯·æŸä¸ªä¸»æœºæˆ–è·¯ç”±å™¨å›ç­”å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ã€‚åœ¨ICMPæ—¶é—´æˆ³å›ç­”æŠ¥æ–‡ä¸­æœ‰ä¸€ä¸ª32ä½çš„å­—æ®µï¼Œå…¶ä¸­å†™å…¥çš„æ•´æ•°ä»£è¡¨ä»1900å¹´1æœˆ1æ—¥èµ·åˆ°å½“å‰æ—¶åˆ»ä¸€å…±æœ‰å¤šå°‘ç§’ã€‚æ—¶é—´æˆ³è¯·æ±‚ä¸å›ç­”å¯ç”¨æ¥è¿›è¡Œæ—¶é’ŸåŒæ­¥å’Œæµ‹é‡æ—¶é—´ã€‚  åº”ç”¨ ping ICMPæŠ¥æ–‡çš„ä¸€ä¸ªæœ€å¤§ç”¨é€”å°±æ˜¯pingå‘½ä»¤ï¼Œç”¨æ¥æµ‹è¯•ä¸¤ä¸ªä¸»æœºä¹‹é—´çš„è¿é€šæ€§ï¼š\ntracert Tracerouteä»æºä¸»æœºå‘ç›®çš„ä¸»æœºå‘é€ä¸€è¿ä¸²çš„IPæ•°æ®æŠ¥ï¼Œæ•°æ®æŠ¥ä¸­å°è£…çš„æ˜¯æ— æ³•äº¤ä»˜çš„UDPç”¨æˆ·æ•°æ®æŠ¥[æ’å›¾]ã€‚ç¬¬ä¸€ä¸ªæ•°æ®æŠ¥P1çš„ç”Ÿå­˜æ—¶é—´TTLè®¾ç½®ä¸º1ã€‚å½“P1åˆ°è¾¾è·¯å¾„ä¸Šçš„ç¬¬ä¸€ä¸ªè·¯ç”±å™¨R1æ—¶ï¼Œè·¯ç”±å™¨R1å…ˆæ”¶ä¸‹å®ƒï¼Œæ¥ç€æŠŠTTLçš„å€¼å‡1ã€‚ç”±äºTTLç­‰äºé›¶äº†ï¼ŒR1å°±æŠŠP1ä¸¢å¼ƒäº†ï¼Œå¹¶å‘æºä¸»æœºå‘é€ä¸€ä¸ªICMPæ—¶é—´è¶…è¿‡å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚æºä¸»æœºæ¥ç€å‘é€ç¬¬äºŒä¸ªæ•°æ®æŠ¥P2ï¼Œå¹¶æŠŠTTLè®¾ç½®ä¸º2ã€‚P2å…ˆåˆ°è¾¾è·¯ç”±å™¨R1ï¼ŒR1æ”¶ä¸‹åæŠŠTTLå‡1å†è½¬å‘ç»™è·¯ç”±å™¨R2ã€‚R2æ”¶åˆ°P2æ—¶TTLä¸º1ï¼Œä½†å‡1åTTLå˜ä¸ºé›¶äº†ã€‚R2å°±ä¸¢å¼ƒP2ï¼Œå¹¶å‘æºä¸»æœºå‘é€ä¸€ä¸ªICMPæ—¶é—´è¶…è¿‡å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚è¿™æ ·ä¸€ç›´ç»§ç»­ä¸‹å»ã€‚å½“æœ€åä¸€ä¸ªæ•°æ®æŠ¥åˆšåˆšåˆ°è¾¾ç›®çš„ä¸»æœºæ—¶ï¼Œæ•°æ®æŠ¥çš„TTLæ˜¯1ã€‚ä¸»æœºä¸è½¬å‘æ•°æ®æŠ¥ï¼Œä¹Ÿä¸æŠŠTTLå€¼å‡1ã€‚ä½†å› IPæ•°æ®æŠ¥ä¸­å°è£…çš„æ˜¯æ— æ³•äº¤ä»˜çš„è¿è¾“å±‚çš„UDPç”¨æˆ·æ•°æ®æŠ¥ï¼Œå› æ­¤ç›®çš„ä¸»æœºè¦å‘æºä¸»æœºå‘é€ICMPç»ˆç‚¹ä¸å¯è¾¾å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚\nè¿™æ ·ï¼Œæºä¸»æœºè¾¾åˆ°äº†è‡ªå·±çš„ç›®çš„ï¼Œå› ä¸ºè¿™äº›è·¯ç”±å™¨å’Œæœ€åç›®çš„ä¸»æœºå‘æ¥çš„ICMPæŠ¥æ–‡æ­£å¥½ç»™å‡ºäº†æºä¸»æœºæƒ³çŸ¥é“çš„è·¯ç”±ä¿¡æ¯â€”â€”åˆ°è¾¾ç›®çš„ä¸»æœºæ‰€ç»è¿‡çš„è·¯ç”±å™¨çš„IPåœ°å€ï¼Œä»¥åŠåˆ°è¾¾å…¶ä¸­çš„æ¯ä¸€ä¸ªè·¯ç”±å™¨çš„å¾€è¿”æ—¶é—´\n","description":"ç½‘ç»œå±‚æµ…æ","id":70,"section":"posts","tags":["è®¡ç®—æœºç½‘ç»œ","ç½‘ç»œå±‚"],"title":"ç½‘ç»œå±‚","uri":"https://hugo.jiahongw.com/zh/posts/network/net-level/"},{"content":" å…¬å¸\tå²—ä½\té¢˜ç›®\tå¸–å­æ—¶é—´\n==å­—èŠ‚è·³åŠ¨\tjava\tå‰‘æŒ‡ Offer 53 - II. 0ï½n-1ä¸­ç¼ºå¤±çš„æ•°å­—\t2020.07.18== ï¼ˆåŒæŒ‡é’ˆï¼‰\n==å­—èŠ‚è·³åŠ¨\tjava\tå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå•é“¾è¡¨æ˜¯ä¸æ˜¯æœ‰ç¯\t2020.07.18== ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰\n==å­—èŠ‚è·³åŠ¨\tjava\tç»™ä½ ä¸€ä¸ªæ•°ç»„ï¼Œæ±‚ä¸‰ä¸ªæ•°å­—ä¹‹å’Œä¸º100.\t2020.07.18== ï¼ˆè°ƒç”¨ä¸¤æ•°ä¹‹å’Œï¼Œå“ˆå¸Œï¼‰\n==å­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tç®—æ³•é¢˜ï¼ˆåˆå¹¶é“¾è¡¨\t2020.07.18==\n==å­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ±‚å²›å±¿ä¸ªæ•°\t2020.07.18==\n==å­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ ‘æ‰¾ä¸¤èŠ‚ç‚¹æœ€é•¿è·ç¦»\t2020.07.18==\nå­—èŠ‚è·³åŠ¨\tjava\t1243534543634äº¤æ¢å„ä½çš„æ•°å­—ï¼Œæ‰¾å‡ºå¤§äºç›®å‰è¿™ä¸ªæ•°çš„æœ€å°çš„ä¸€ä¸ªæ•°ã€‚\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå¯¹ä¸€ä¸ªå¥‡æ•°ä½å‡åºï¼Œå¶æ•°ä½é™åºçš„é“¾è¡¨ï¼Œè¿›è¡Œæ’åºï¼Œä¾‹å¦‚ 1-\u0026gt;100-\u0026gt;20-\u0026gt;80-\u0026gt;40-\u0026gt;30\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼š(1)è®¾è®¡sqtr(x)\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2ã€ç®—æ³•é¢˜ï¼š(1)åˆ¤æ–­å›æ–‡é“¾è¡¨\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\t(2)å¯¹äºç»™å®šçš„æ•°æ®ï¼Œæ‰¾å‡ºæ¯”è¿™ä¸ªæ•°å¤§çš„æœ€å°å›æ–‡æ•°ï¼ˆæ­£åè¯»éƒ½ä¸€æ ·çš„æ•°ï¼‰ï¼Œå¦‚ 12310 -\u0026gt; 12321\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç¬¬ä¸€é“ä»£ç ï¼šæ•°ç»„åªäº¤æ¢ä¸€æ¬¡æ±‚æœ€å¤§\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç¬¬äºŒé“ä»£ç ï¼š å•é“¾è¡¨åˆ¤æ–­æ˜¯å¦æœ‰ç¯\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tleetcodeåŸé¢˜ ä»ä¸€ä¸ªæ•° l ä¸€ç›´ ä¸ æ“ä½œåˆ° r ï¼Œæ€ä¹ˆåšæœ€å¿«ï¼Œå¤æ‚åº¦æœ€å°\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tkä¸ªä¸€ç»„åè½¬é“¾è¡¨\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\täºŒå‰æ ‘çš„éé€’å½’ååºéå†\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæ‹¬å·åŒ¹é…\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæŒ‰å­—å…¸åºå…¨æ’åˆ—è¾“å‡º\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tè·³å°é˜¶\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tå›¾å½¢/å›¾åƒå²—\tä¸€æ£µå®Œå…¨äºŒå‰æ ‘çš„æœ€åº•å±‚çš„æœ€å³èŠ‚ç‚¹\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæ±‚å­é›†\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\täºŒç»´æœ‰åºæ•°ç»„ï¼ˆä»å·¦åˆ°å³é€’å¢ï¼Œä»ä¸Šåˆ°ä¸‹ä¹Ÿé€’å¢ï¼‰ï¼Œæ‰¾ç›®æ ‡æ•°ï¼ˆæˆ‘å†™çš„äºŒåˆ†æ³•ï¼‰\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t1.åˆ¤æ–­å·¦å³æ‹¬å·æ˜¯å¦åˆç†\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t2.æœ´ç´ è´å¶æ–¯çš„ç®—æ³•å®ç°\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t3.ä¸¤ä¸ªå¾ˆå¤§çš„æ•°æ®é›†å­˜ç€url æ‰¾åˆ°ä¸¤ä¸ªæ•°æ®é›†å…±æœ‰çš„url\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t4.ä¸€ä¸ªäºŒç»´çŸ©é˜µç”±å°åˆ°å¤§æ’åˆ— æ‰¾targetæ•°å­—\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t5.äºŒå‰æ ‘æŒ‰è¡Œè¾“å‡º\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t1.ç»™äºŒå‰æ ‘å‰åºéå†å’Œä¸­åºéå† è¾“å‡ºè¿™ä¸ªæ ‘\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t2.ç¿»è½¬é“¾è¡¨\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t3. æŠŠåªåŒ…å«è´¨å› å­2ã€3å’Œ5çš„æ•°ç§°ä½œä¸‘æ•°ã€‚ä¾‹å¦‚6ã€8éƒ½æ˜¯ä¸‘æ•°ï¼Œä½†14ä¸æ˜¯ï¼Œå› ä¸ºå®ƒåŒ…å«è´¨å› å­7ã€‚ ä¹ æƒ¯ä¸Šæˆ‘ä»¬æŠŠ1å½“åšæ˜¯ç¬¬ä¸€ä¸ªä¸‘æ•°ã€‚æ±‚æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºçš„ç¬¬Nä¸ªä¸‘æ•°ã€‚\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tç»™ä¸€ä¸ªç±»ä¼¼æ ‘çš„ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥æœ‰å¤šä¸ªèŠ‚ç‚¹ï¼ˆä¸æ­¢ä¸¤ä¸ªæ ‘ï¼‰ç„¶åæ¯ä¸ªæ ¹èŠ‚ç‚¹å’Œå­—èŠ‚ç‚¹é—´çš„è·¯å¾„ä¸ä¸€æ ·ï¼Œæ±‚å¶å­ç»“ç‚¹åˆ°å¶å­ç»“ç‚¹çš„æœ€å¤§è·¯å¾„\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåç«¯\té“¾è¡¨æ¯kä¸ªç¿»è½¬\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåç«¯\tåˆ¤æ–­å•é“¾è¡¨æœ‰æ²¡æœ‰ç¯ï¼Œæœ‰çš„è¯æ‰¾å…¥å£\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tå®‰å“\t. ç®—æ³•é¢˜ï¼šæ ¹æ®å‰ä¸­åºé‡æ„äºŒå‰æ ‘\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tå®‰å“\tç®—æ³•ï¼šèºæ—‹çŸ©é˜µ\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tç»™å®šmå’Œnï¼Œè¾“å‡ºä»1~nä¸­ä»»æ„å¤šä¸ªæ•°å­—ï¼Œä¸”å’Œä¸ºmuçš„ç»„åˆ(æ•°å­—ä¸èƒ½é‡å¤ä½¿ç”¨)\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•é¢˜(æ±‚ç¬¬nä¸ªä¸‘æ•°,leetcodeåŸé¢˜,éš¾åº¦mid)\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tç¬¬ä¸€é¢˜æ˜¯æ±‚å¼€æ ¹å·nçš„å€¼\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tç¬¬äºŒé¢˜æ˜¯è¾“å‡ºäº¤é”™åçš„é“¾è¡¨(æ¯”å¦‚é“¾è¡¨a-b-c-d-e,äº¤é”™åè¾“å‡ºä¸ºa-e-b-d-c)\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tåè½¬é“¾è¡¨\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tæ‰¾å³°å€¼\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t1. æœ‰ä¸¤ä¸ªå•é“¾è¡¨ï¼Œå…¶æœ‰äº¤å‰èŠ‚ç‚¹ï¼Œæ±‚äº¤å‰èŠ‚ç‚¹ã€‚\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2. LRUç®—æ³•ï¼Œç»™ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œè‹¥LRUçš„çª—å£å¤§å°æ˜¯4ï¼Œæ±‚ä¸‹ä¸€ä¸ªå…ƒç´ è¿›æ¥åå‰”é™¤å“ªä¸ªå…ƒç´ ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t3. æ±‚æœ€å°å­æ•°ç»„ï¼Œleetcode209é¢˜ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2Nçš„æ ¼å­ 12çš„æ ¼å­å¡«æ»¡å®ƒæœ‰å¤šå°‘ç§æ–¹æ³•ï¼Œ ç»™ä¸ªæ•°ç»„ï¼Œæ‰¾å‡ºå³è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå¤§çš„å…ƒç´ ï¼Œ é“¾è¡¨ä¸¤ä¸¤åè½¬\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tåˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬nä¸ª\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå¤§æ•°æ®\tç®—æ³•é¢˜1: è¯·å¯¹3ä¸ªæœ‰åºæ•°ç»„è¿›è¡Œå½’å¹¶æ’åº\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå¤§æ•°æ®\tç®—æ³•é¢˜2: æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ€é•¿ä¸é‡å¤å­ä¸²çš„é•¿åº¦\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\tç»™å®šä¸€ä¸ªintæ•°ç»„Aï¼Œæ•°ç»„ä¸­å…ƒç´ äº’ä¸é‡å¤ï¼Œç»™å®šä¸€ä¸ªæ•°xï¼Œæ±‚æ‰€æœ‰æ±‚å’Œèƒ½å¾—åˆ°xçš„æ•°å­—ç»„åˆï¼Œç»„åˆä¸­çš„å…ƒç´ æ¥è‡ªAï¼Œå¯é‡å¤ä½¿ç”¨ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæ‰‹æ’•ä»£ç :Zå­—å‹éå†äºŒå‰æ ‘ï¼ˆå‰‘æŒ‡offeråŸé¢˜ï¼ŒLeetCodeç¬¬1553é¢˜ï¼‰\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\ttopk\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tjava\tæ‰‹æ’•å¹³æ–¹æ ¹\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tåè½¬é“¾è¡¨ï¼Ÿ\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ ä¸¤ä¸ª æ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜1ï¼šå¾ˆå¤§é‡çš„intå‹æ•°ï¼Œè¾“å‡ºå‰100æœ€å¤§çš„æ•°ï¼ˆä¸­ç­‰ï¼‰\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜2ï¼šå•å‘é“¾è¡¨ï¼Œå¤´å°¾å¥‡å¶äº¤æ›¿è¾“å‡ºï¼ˆä¸­ç­‰ï¼‰\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå•é“¾è¡¨åè½¬\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå¹³è¡¡äºŒå‰æœç´¢æ ‘æ’å…¥ç®—æ³•\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2. ä¸€ä¸ªäºŒå‰æ ‘ï¼Œ æ±‚è·¯å¾„ä¹‹å’Œã€‚ã€‚ã€‚ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•ï¼šæ·éª°å­èµ°è·¯ï¼Œ1ï½6ï¼Œç»™å®šçš„è¾“å…¥nï¼Œèµ°åˆ°ç¬¬nä¸ªæ ¼å­æœ‰å¤šå°‘ç§èµ°æ³•\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•ï¼šé’è›™è·³æ ¼å­ï¼Œæ•°ç»„é‡Œå…ƒç´ è¡¨ç¤ºè¯¥ä½ç½®çŸ³å¤´ä¸ªæ•°ï¼Œæ¯æ¬¡è·³3-5æ ¼ï¼Œé—®è·³å‡ºæ•°ç»„æœ€å°‘è¸©å¤šå°‘çŸ³å¤´ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•ï¼šç»™å®šé“¾è¡¨å’Œkï¼Œè¦æ±‚æ¯kä¸ªå…ƒç´ ç¿»è½¬ä¸€æ¬¡\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tè®¡ç®—æœºè§†è§‰å·¥ç¨‹å¸ˆ\tåšé“é¢˜å§ï¼ŒLeetCode4ï¼šä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ä¸­ä½æ•°\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•ï¼šæ‰¾å‡ºæ•°ç»„é‡Œå‡ºç°æ¬¡æ•°å¤§äºn/kçš„æ•°\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•åˆ¤æ–­æ ‘æ˜¯å¦å¯¹ç§°ï¼Œç”¨bfsåšäº†\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t11.æ‰‹æ’•ä»£ç ï¼š1ï¼‰ç»™å®šæ•°ç»„ï¼Œæ±‚è¿ç»­å­ä¸²çš„æœ€å¤§å’Œ\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2ï¼‰ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t10.æ‰‹æ’•ä»£ç ï¼š1ï¼‰ç»™å®šä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹éƒ½æ˜¯é€’å¢çš„ï¼ŒæŸ¥æ‰¾æŸä¸ªå…ƒç´ \t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2ï¼‰ç»™å®šä¸€ä¸ªçŸ©é˜µï¼Œæ¯æ¬¡åªèƒ½å‘å³æˆ–å‘ä¸‹èµ°ï¼Œä»å·¦ä¸Šè§’å¼€å§‹åˆ°å³ä¸‹è§’ä¸€å…±æœ‰å¤šå°‘ç§èµ°æ³•\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tï¼Œç¬¬ä¸€é¢˜å°±æ˜¯ç»™ä¸€ä¸ªçŸ©é˜µï¼Œä»å³ä¸Šè§’å¾€å·¦ä¸‹è§’ä¸€å±‚ä¸€å±‚æ–œç€éå†ï¼Œç±»ä¼¼äºè¿™æ ·ï¼š\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tå±‚æ¬¡éå†äºŒå‰æ ‘\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tleetcode 236\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tleetcode 62ï¼Œ\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\t1.ç»™ä¸€ä¸ªæ­£æ•´æ•°ï¼Œè¡¨ç¤ºæˆä¸€ä¸ªæˆ–å¤šä¸ªä¸åŒçš„æ­£æ•´æ•°çš„å’Œï¼Œè¾“å‡ºæ‰€æœ‰çš„è§£å†³æ–¹æ¡ˆï¼ˆæ·±æœï¼Œä½†æ˜¯æˆ‘å®ç°çš„æ—¶å€™å†™çš„ä¸å¥½ï¼‰\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\t2.ç»™ä¸€ä¸ªn*nçš„æ–¹é˜µï¼Œèºæ—‹å¡«å…¥æ•°å­—\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tandroid\tï¼ˆæ‰‹æ’•ï¼‰1ï¼š[2,3] è¡¨ç¤º å­©å­å’Œçˆ¶æ¯ã€‚è¾“å…¥ä¸€ç»„è¿™æ ·çš„æ•°æ®ï¼Œ ç»™ä¸¤ä¸ªæ•°ï¼Œé—®æ˜¯å¦æœ‰å…±åŒç¥–å…ˆã€‚\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\tåŠ›æ‰£ 124.\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç¬¬äºŒé¢˜ï¼šäºŒå‰æ ‘çš„å·¦è§†å›¾\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåå°\tç¬¬ä¸€é¢˜ï¼Œä¸€ä¸ªintæ•°ç»„ï¼Œæ‰¾å‡ºä¸¤ä¸ªå¼‚æˆ–æœ€å¤§çš„æ•°å­—ï¼Œæ—¶é—´è¦æ±‚O(n)\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåå°\tç¬¬äºŒé¢˜ï¼Œå››ä¸ªintæ•°ç»„ï¼Œä»æ¯ä¸ªæ•°ç»„é‡Œè¾¹æŒ‘ä¸€ä¸ªæ•°ï¼ŒåŠ èµ·æ¥ç­‰äºæŒ‡å®šæ•°ï¼Œè¦æ±‚æ‰“å°å‡ºæ‰€æœ‰éé‡å¤çš„ç»„åˆï¼Œè¦æ±‚æœ€å¤§n2ã€‚\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tjava\tä»£ç é¢˜ï¼šä¸å«é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²ï¼ˆleetcodeåŸé¢˜ï¼‰\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2.æœ€é•¿ä¸Šå‡å­åºåˆ—çš„çŠ¶æ€è½¬ç§»,æ—¶é—´å¤æ‚åº¦\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç»™å‡ºå‰åºå’Œä¸­åºæ•°ç»„,ç”Ÿæˆååºæ•°ç»„\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\t11.ç®—æ³•é¢˜ï¼šç»™ä¸€æ£µäºŒå‰æ ‘å’Œä¸€ä¸ªæ•´æ•°ï¼Œè¦æ±‚è¾“å‡ºäºŒå‰æ ‘ä¸­è·¯å¾„å’Œç­‰äºè¿™ä¸ªæ•´æ•°çš„è·¯å¾„ï¼Œå¦‚\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1ã€‚ç®—æ³•é¢˜ï¼Œä¸¤ä¸ªé“¾è¡¨äº†ç±»å‹çš„æ•´æ•°æ±‚å’Œï¼Œå¦‚1-\u0026gt;2-\u0026gt;5ä¸3-\u0026gt;6æ±‚å’Œå¾—åˆ°1-\u0026gt;4-\u0026gt;1ã€‚ç”¨æ ˆæˆ–è€…åè½¬é“¾è¡¨\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼šæ‰¾æ³¢è°·æ•°ï¼›\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼šå¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„å•å‘é“¾è¡¨ï¼›\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\t14. ç®—æ³•é¢˜ï¼šæ‰¾åˆ°ä¸¤ä¸ªé“¾è¡¨çš„å…¬å…±èŠ‚ç‚¹\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1. ç»™å®šä¸¤ä¸ªå•é“¾è¡¨ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å…¬å…±èŠ‚ç‚¹\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\t3. æ±‚å­—ç¬¦æ•°ç»„çš„å…¨æ’åˆ—ï¼ˆç”¨çš„äº¤æ¢çš„æ–¹å¼ï¼Œä½†æ˜¯é¢è¯•å®˜é—®æ€è·¯å´æœ‰ç‚¹ç´§å¼ ï¼Œæ²¡å›ç­”å¥½ï¼Œç„¶åä»–é—®æˆ‘leetcodeåˆ·äº†å¤šå°‘é“é¢˜ï¼Œå…«æˆè®¤ä¸ºæˆ‘æ˜¯ç›´æ¥èƒŒçš„é¢˜äº†ï¼Œéš¾å—ï¼‰\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæŸ¥æ‰¾æœ‰åºæ•°ç»„ä¸­ä¸€ä¸ªç›®æ ‡å€¼å‡ºç°çš„ç¬¬ä¸€æ¬¡ä½ç½®ï¼Œæ²¡æœ‰æ‰¾åˆ°è¿”å› -1\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\t5. ç®—æ³•ï¼šæ»‘åŠ¨çª—å£å¯»æ‰¾æ»¡è¶³çš„å­—ç¬¦ä¸²\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tçˆ¬æ¥¼æ¢¯\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tleetcode 93 æ²¡å†™å‡ºæ¥ã€‚ã€‚é¢è¯•å®˜è¯´æˆ‘æ€ç»ªæ··ä¹± å¯¼è‡´åé¢è„‘å­ç©ºç™½\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\täºŒå‰æ ‘å±‚åºéå†\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tè¯´æ€è·¯ï¼šå®ç°ä¸€ä¸ªæ ˆï¼Œo(1)æ—¶é—´æ‰¾æœ€å¤§å€¼\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå†™ä»£ç ï¼šçŸ©é˜µä»å·¦ä¸Šåˆ°å³ä¸‹æ‰¾æœ€å°è·¯å¾„\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tè¯´æ€è·¯ï¼šåˆ é™¤å•é“¾è¡¨çš„å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tç¼–ç¨‹ï¼šåˆ¤æ–­ä¸¤ä¸ªé“¾è¡¨æ˜¯å¦ç›¸äº¤å¹¶è¿”å›äº¤ç‚¹ï¼›\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tä»£ç ï¼šæ— é‡å¤æœ€é•¿å­—ä¸²\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t10ã€ç®—æ³•ï¼šæ±‚æ•°ç»„ä¸­å‡åºçš„å­åºåˆ—\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t11ã€ç®—æ³•ï¼šä¸¤ä¸ªé“¾è¡¨æ‰¾å…¬å…±èŠ‚ç‚¹\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tMerge ä¸¤ä¸ªæœ‰åºçš„é“¾è¡¨\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\t1. å¦‚ä½•ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ï¼Ÿå¦‚ä½•ä¼˜åŒ–å‰é¢è¯´çš„é‚£ç§æ€è·¯ï¼Ÿ\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\t2. ç¼–ç¨‹é¢˜ï¼šä¸Šå°é˜¶(é‚£ä¸ªç®€å•çš„fabonacci)ç„¶åå°±åˆæ¥äº†ä¸€é“\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\t3. ç¼–ç¨‹é¢˜ï¼šåŒºé—´åˆå¹¶æ±‚å¹¶é›†\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\tç®—æ³•é¢˜ï¼šè¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\t1. äºŒåˆ†æŸ¥æ‰¾åœ¨å‡åºæ•°ç»„ä¸­æ‰¾å‡ºç»å¯¹å€¼æœ€å°çš„é‚£ä¸ªæ•°\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\t2. 8ä¸ªæ¡¶(æ¯ä¸ªæ¡¶åªèƒ½æ”¾ä¸€ä¸ªçƒ)ï¼Œ5ä¸ªçƒï¼Œä¸‰ä¸ªè¿ç»­çš„æƒ…å†µæœ‰å‡ ç§ã€‚ä¸€èˆ¬æƒ…å†µä¸‹å‘¢\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tmerge k list\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tLeetCode 25. Kä¸ªä¸€ç»„åè½¬é“¾è¡¨\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tLeetCode 53.æœ€å¤§å­åºå’Œ\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tç»™å®šä¸€ä¸ªåŒ…å«å¤§å†™è‹±æ–‡å­—æ¯å’Œæ•°å­—çš„å¥å­ï¼Œæ‰¾å‡ºè¿™ä¸ªå¥å­æ‰€åŒ…å«çš„æœ€å¤§çš„åå…­è¿›åˆ¶æ•´æ•°ï¼Œè¿”å›è¿™ä¸ªæ•´æ•°çš„å€¼ã€‚æ•°æ®ä¿è¯è¯¥æ•´æ•°åœ¨intè¡¨ç¤ºèŒƒå›´å†…ã€‚\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\t01çŸ©é˜µæœ€å¤§æ­£æ–¹å½¢,ç»å…¸é¢˜äº†,dpé€‰å·¦ä¸Šæœ€å°+1,éšä¾¿å†™äº†ä¸€ä¸‹,æ²¡è®©è·‘test.\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\täºŒå‰æ ‘æ‰¾targetè·¯å¾„\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\täºŒå‰æ ‘è½¬å•é“¾è¡¨,å¸¸è§„é¢˜,é€’å½’ä¸€ä¸‹å®Œäº‹äº†.\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼šä»å·¦ä¸Šè§’èµ°åˆ°å³ä¸‹è§’æœ‰å¤šå°‘ç§ä¸åŒçš„è·¯çº¿\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\t10.leetcode å¥‡å¶é“¾è¡¨\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\täºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\tåè½¬å­—ç¬¦ä¸²\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæ¸¸æˆå®¢æˆ·ç«¯\tå­—ç¬¦ä¸²æ•°ç»„ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€å°è·ç¦»ï¼ˆeasyï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæ¸¸æˆå®¢æˆ·ç«¯\tåšé¢˜ï¼Œæ•°ç»„ä¸­å’Œæœ€å¤§çš„è¿ç»­å­æ•°ç»„ï¼ˆmidï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t189. æ—‹è½¬æ•°ç»„\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæ¸¸æˆå®¢æˆ·ç«¯\tæ‰‹æ’• æ— åºæ•°ç»„ä¸¤æ•°ä¹‹å’Œ\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæ¸¸æˆå®¢æˆ·ç«¯\tæ‰‹æ’•ä»£ç  ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæ¸¸æˆå®¢æˆ·ç«¯\tæ‰‹æ’•ä»£ç  å®ç°æ´—ç‰Œç®—æ³•\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\täºŒå‰æ ‘å­è·¯å¾„å’Œä¸ºkçš„è·¯å¾„ä¸ªæ•°\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t1. æ±‚å’Œä¸ºkçš„å­æ•°ç»„ä¸ªæ•°\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t2. åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸ªæ•°è¶…è¿‡æ•°ç»„é•¿åº¦ä¸€åŠçš„æ•°\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t10ã€ç®€åŒ–è·¯å¾„ï¼ˆç®—æ³•æï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t11ã€äºŒå‰æ ‘çš„å³è§†å›¾ï¼ˆç®—æ³•é¢˜ï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tandriod\tä»£ç é¢˜ï¼šæ—‹è½¬æ•°ç»„\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tandriod\tä»£ç é¢˜ï¼šä¸¤æ•°ç›¸åŠ ï¼ˆé“¾è¡¨ï¼Œè¦æ±‚åŸåœ°å®ç°ï¼Œç©ºé—´å¤æ‚åº¦O(1)ï¼Œè¿™ä¸ªçŠ¯è ¢æ’•äº†å¥½ä¹…ç»“æœè¿˜æ˜¯é å¼ºè¡Œæ‰“å°å‘ç°çš„é—®é¢˜ï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tandriod\tä»£ç é¢˜ï¼ša) èºæ—‹éå†çŸ©é˜µ\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tandriod\tï¼›b)ï¼ˆå˜ç§ï¼‰åŸåœ°æ—‹è½¬å›¾åƒ\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\tç®—æ³•é¢˜ åè½¬é“¾è¡¨ï¼ˆç™½ç»™ï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\tä¸¤ä¸ªæœ‰åºé“¾è¡¨åˆå¹¶\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç»™å®š2DçŸ©é˜µï¼Œæ±‚é‡Œé¢1æ„æˆçš„æ­£æ–¹å½¢çš„æœ€å¤§é¢ç§¯ã€‚\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼šæ¥é›¨æ°´\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t14.æ‰¾å‡ºä¸¤ä¸ªé“¾è¡¨çš„äº¤å‰ç‚¹ï¼ˆ\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t10.æ‰‹æ’•ä»£ç ï¼šä»æ— åºæ•°ç»„ä¸­æ‰¾åˆ°å³è¾¹ç¬¬ä¸€ä¸ªå¤§çš„æ•°ï¼ˆä¸leetcode 739 æ¯æ—¥ä½“æ¸©ç±»ä¼¼ï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t22.æŠ›ç¡¬å¸ï¼ˆä¸€ä¸ª0.3 ä¸€ä¸ª0.7 å¦‚ä½•ä¿è¯å…¬å¹³ï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t23 zå­—å½¢æ‰“å°äºŒå‰æ ‘\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t- ä¸€é¢—æœç´¢äºŒå‰æ ‘æœ‰ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯é¢ å€’çš„ï¼Œæ¢å¤æˆæ­£ç¡®çš„\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t- å•é“¾è¡¨é«˜ä½åœ¨å‰ã€ä½ä½åœ¨åï¼Œå¤§æ•°è®¡ç®—\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t- é˜¶ä¹˜\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t- ä¸€ä¸ªæœ‰åºã€æœ‰é‡å¤å…ƒç´ æ•°ç»„æ‰¾åˆ°æœ‰å¤šå°‘æ»¡è¶³ a + b = targetçš„\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t1.æ–æ³¢é‚£å¥‘ é€’å½’å®ç°/dpå®ç°/ç©ºé—´ä¼˜åŒ–\t2020.07.11\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t. ç®—æ³•é¢˜ æ‰¾å‡ºsumå¤§äºç­‰äºtargetçš„æœ€çŸ­è¿ç»­æ•°ç»„çš„é•¿åº¦ è¦é€šè¿‡æ‰€æœ‰æµ‹è¯•æ•°æ® ï¼ˆæ‰¾bugæ‰¾åŠå¤©ï¼Œé¢è¯•å®˜ä¸€ç›´æ¸©æŸ”çš„è¯´åˆ«ç€æ€¥å“ˆå“ˆï¼‰\t2020.07.11\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t10.ä»£ç :é“¾è¡¨çš„é€†åºè¾“å‡º\t2020.07.11\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t11.ä»£ç :åˆ¤æ–­å›æ–‡\t2020.07.11\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\tä¸¤ä¸¤åè½¬é“¾è¡¨\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\tç®—æ³•ï¼šåˆ¤æ–­ä¸¤ä¸ªé“¾è¡¨æ˜¯å¦ç›¸äº¤\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\tç®—æ³•ï¼šæŸ¥æ‰¾äºŒå‰æ ‘ä¸­ä¸¤ä¸ªèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t7.ç®—æ³•ï¼šåˆå¹¶æœ‰åºæ•°ç»„\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t12 ç®—æ³•ï¼šé€†åºè¾“å‡ºæ•°å­—ã€‚\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæ‰‹æ’•ï¼šå±‚åºéå†\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\täºŒå‰æ ‘ä¸­åºéå†\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæ‰‹æ’• lru\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tç¬¬Kå¤§ä¸ªæ•°\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\té“¾è¡¨æ‰¾ç¯\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tåˆå¹¶æ•°ç»„\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç¼–ç¨‹é¢˜ï¼šå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°ï¼Œleetcodeç¬¬67é¢˜\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\t3 sum\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tå­—ç¬¦ä¸²åè½¬\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå…ˆé—®ä¸¤ä¸ªæ— åºæ•°ç»„æ€ä¹ˆæ‰¾äº¤é›†ã€‚\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰‹æ’•æ•°ç»„A-æ•°ç»„B\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰‹æ’•æ—‹è½¬çŸ©é˜µ90åº¦\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tc++ã€\tæ‰‹æ’•ä»£ç  æ±‚mä¸ªæ•°ä¸­æœ€å¤§çš„nä¸ªæ•°\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\t7.æ‰‹æ’•ä»£ç ï¼Œä¸€é“æ—‹è½¬é“¾è¡¨çš„é¢˜ç›®ï¼Œleetcode easyæ°´å¹³\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\t8.æ‰‹æ’•ä»£ç ï¼Œä¸€é“çŸ©é˜µç›¸ä¹˜ï¼Œä¹Ÿå¾ˆç®€å•ã€‚\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œæ±‚è¿ç»­å­åºåˆ—ä¹˜ç§¯ä¸ºå®Œå…¨å¹³æ–¹æ•°çš„æœ€å¤§é•¿åº¦\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tåˆ¤æ–­ç»™å®šåºåˆ—æ˜¯å¦ä¸ºäºŒå‰æœç´¢æ ‘çš„å‰åºéå†\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tç®—æ³•é¢˜ï¼šæ•°ç»„å»é‡\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tçˆ¬æ¥¼æ¢¯\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼Œæœ€é•¿è¿ç»­ç›¸åŒå­—ç¬¦çš„å­ä¸²\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå†™ä¸ªé¢˜ï¼Œæ¯Kä¸ªèŠ‚ç‚¹ç¿»è½¬é“¾è¡¨\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1.åŸé¢˜ï¼Œå­—ç¬¦ä¸²å…¨æ’åˆ—\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2.åŸé¢˜ï¼ŒäºŒå‰æ ‘çš„æœ€å¤§è·¯å¾„å’Œ\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1ã€ç±»ä¼¼äºå¹¶æŸ¥é›†çš„é—®é¢˜ï¼Œæœ€ç»ˆæ±‚è¿é€šåˆ†é‡çš„æ•°é‡\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tç®—æ³•é¢˜ é•œåƒäºŒå‰æ ‘\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tç®—æ³•é¢˜ï¼š leetcode1636\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæˆ‘ä¸€é“leetcode 32\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæˆ‘ä¸€é“leetcode 1\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tLeetCode 20 æœ‰æ•ˆçš„æ‹¬å·\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tå¹³è¡¡äºŒå‰æ ‘\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tï¼ŒäºŒå‰æ ‘éå†\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tå›æ–‡ä¸²åˆ¤æ–­\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\täºŒå‰æœç´¢æ ‘è½¬é“¾è¡¨\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\täºŒå‰æ ‘æ±‚å’Œleetcode129-è®²ä¸€ä¸‹æ—¶é—´å¤æ‚åº¦\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\t1ï¼‰æ±‚é“¾è¡¨çš„å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tï¼ˆ2ï¼‰åºåˆ—åŒ–å’Œååºåˆ—åŒ–äºŒå‰æ ‘\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tï¼ˆ3ï¼‰æ±‚æ•°ç»„çš„æå€¼ç‚¹ï¼Œæ‰¾å‡ºä¸€ä¸ªæ»¡è¶³çš„å°±è¡Œï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tå‰åºéå†å’Œä¸­åºéå†é‡æ„äºŒå‰æ ‘ ï¼ˆä¸ç»™ç”¨HashMap å¥½åœ¨åšå‡ºæ¥äº†ï¼‰\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•é¢˜ï¼šåˆ¤æ–­å›æ–‡é“¾è¡¨ï¼ˆä¸­é—´æ‹†åˆ†ä¸¤æ¡é“¾è¡¨ åé¢çš„åè½¬é“¾è¡¨ å¯¹æ¯”æ•°å€¼æ˜¯å¦ç›¸ç­‰ï¼‰\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•é¢˜ï¼šå¥‡æ•°ä½å‡åºå¶æ•°ä½é™åºçš„é“¾è¡¨è¦æ±‚æ—¶é—´O(n)ç©ºé—´O(1)çš„æ’åºï¼Ÿï¼ˆå¥‡å¶æ‹†åˆ† å¶é“¾åè½¬ å½’å¹¶mergeï¼‰\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæ‰‹æ’•ä»£ç ï¼šæ±‚ä¸€ä¸ªæ•°ç»„çš„æ‰€æœ‰å­é›†\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæ‰‹æ’•ä»£ç ï¼šé©¼å³°æ•°ç»„æœ€å¤§å€¼\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\té—®äº†ä¸€é“é“¾è¡¨åè½¬ï¼›\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t1ã€åŠ›æ‰£åŸé¢˜113 è·¯å¾„ç»¼åˆ\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2ã€ç»™å®šä¸€ä¸ªå‡åºæ•°ç»„ï¼Œå¯èƒ½ä¼šæœ‰é‡å¤çš„æ•°å­—ï¼Œå°†æ•°ç»„é‡Œçš„æ•°å¹³æ–¹åï¼Œæœ‰å¤šå°‘ä¸åŒçš„æ•°ã€‚\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\täºŒå‰æ ‘æ‰€æœ‰æ ¹åˆ°å¶å­èŠ‚ç‚¹è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹ï¼Œç»„æˆçš„æ•°å­—ä¹‹å’Œ\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæ‰‹æ’•ä»£ç ï¼šé“¾è¡¨åŠ æ³•\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰‹å†™ç®—æ³•ï¼šé“¾è¡¨åˆå¹¶\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰‹å†™ç®—æ³•ï¼šåˆ¤æ–­ä¸€æ£µæ ‘æ˜¯å¦æ˜¯é•œåƒæ ‘\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t8ã€ ç®—æ³•é¢˜ï¼šåˆ¤æ–­ç»™å®šçš„ä¸€é¢—æ ‘æ˜¯å¦æ˜¯ äºŒå‰æŸ¥æ‰¾æ ‘\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t9ã€ç®—æ³•é¢˜ï¼šç»™å®šä¸€ä¸ªæ•°å­—æ•°ç»„ï¼ŒåŠæ•°å­—å‡ºç°æ¬¡æ•°ï¼Œ\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tå¦‚ä½•åˆ¤æ–­ä¸€é¢—æ ‘æ˜¯å¦æ˜¯å®Œå…¨äºŒå‰æ ‘\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tlru\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tios\tç®—æ³•é¢˜ï¼šæ±‚kå¤§æ•°\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tios\tleetcode1 ä¸¤æ•°ä¹‹å’Œ\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tios\tå‰‘æŒ‡offer 62 åœ†åœˆä¸­å‰©ä¸‹çš„æ•°å­—ï¼ˆçº¦ç‘Ÿå¤«ç¯é—®é¢˜ï¼‰\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tios\tleetcode 41 ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tè¾“å‡ºæ•°ç»„ç¬¬kå¤§å…ƒç´ \t2020.07.08\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\tæ‹¬å·åŒ¹é…\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tåç«¯\té“¾è¡¨çš„ä¸¤ä¸¤ç¿»è½¬\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tåç«¯\tLRu\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tç®—æ³•ï¼šè¿”å›ä¸€æ£µæ ‘çš„æœ€å¤§å¶èŠ‚ç‚¹è·ç¦»\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tå¯¹å«æœ‰é‡å¤æ•°å­—çš„æ•°ç»„å»é‡å¹¶æ’åºï¼Œæ‰‹æ’•å¿«æ’\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tç®—æ³•:ä¸¤ä¸ªå¤§æ•°å­—ç¬¦ä¸²æ±‚å’Œè¾“å‡ºå­—ç¬¦ä¸²\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tlru\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\tä¸€é¢ï¼šæœ€å¤§è¿ç»­å­åºåˆ—å’Œå’Œå›æ–‡é“¾è¡¨\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\täºŒé¢ï¼šä¸€ä¸ªå¥‡æ•°ä½å‡åºã€å¶æ•°ä½é™åºçš„å•å‘æ— ç¯é“¾è¡¨ï¼Œæ’æˆä¸€ä¸ªæœ‰åºé“¾è¡¨\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\tä¸‰é¢ï¼šSå‹æ‰“å°äºŒå‰æ ‘ï¼Œä¸¤æ¡å•å‘é“¾è¡¨çš„ç›¸äº¤èŠ‚ç‚¹ï¼Œä»»æ„æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªç¼ºå¤±çš„æ­£æ•´æ•°\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tå­—ç¬¦ä¸²åè½¬\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæ¥ä¸ªç®€å•çš„â€”ç¬¬ä¸€é¢˜ï¼šæ±‚äºŒå‰æ ‘æœ€å¤§é•¿åº¦\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tç¬¬äºŒé¢˜ï¼šç”¨Stringå­˜ä¸¤ä¸ªå¾ˆé•¿çš„æ•°ï¼Œæ±‚å’Œ\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1. ç¬¬ä¸€é¢˜ åˆ¤æ–­æ˜¯å¦å›æ–‡é“¾è¡¨\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2. ç¬¬äºŒé¢˜ æ±‚é€†æ•°å¯¹\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t3.ç¬¬ä¸‰é¢˜ åŠ¨æ€è§„åˆ’\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1.ç¬¬ä¸€é¢˜ æœ€å¤§åŒ–è‚¡ç¥¨äº¤æ˜“\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2.ç¬¬äºŒé¢˜ æœ€å¤§åŒ–è‚¡ç¥¨äº¤æ˜“ï¼ˆæœ‰é™äº¤æ˜“ï¼‰\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰‹æ’•ä»£ç  åè½¬é“¾è¡¨ã€‚\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t7.ä»£ç ï¼šé©¼å³°å­—ç¬¦ä¸²é—®é¢˜\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•é¢˜ï¼šæ»‘åŠ¨çª—å£åŒ¹é…å­—ç¬¦ä¸²\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t1. å®ç°æ–æ³¢çº³è¥¿æ•°åˆ—ï¼ˆ\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tä¸€ä¸ªlistï¼Œä¸€ä¸ªtargetï¼Œæ±‚listä¸­ä¸¤æ•°ä¹‹å’Œç­‰äºtargetçš„æ‰€æœ‰ç»„åˆï¼Œlistä¸­æœ‰é‡å¤çš„ï¼Œç®—mediumå§ã€‚\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t1. Leetcode124\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\tè¡¥å……ï¼š8. å¤§æ•°é—®é¢˜ä¸­çš„topKé—®é¢˜\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\tè¡¥å……ï¼š9. ç»™æ•´æ•°æ•°ç»„åšæ•°å­—æ¬¡æ•°ç»Ÿè®¡ï¼Œç­”unordered_mapï¼Œè®©æˆ‘å†æƒ³å…¶ä»–æ–¹æ³•ï¼Œä¸ä¼šã€‚\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1.ç»™ä½ ä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ªtargetï¼Œæ‰¾å‡ºå’Œæ˜¯targetæ•´æ•°å€çš„è¿ç»­å­ä¸²\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2.ä¸€ä¸ªæ‹¬å·å­—ç¬¦ä¸²ï¼Œæ‰¾å‡ºæœ€é•¿åˆæ³•é•¿åº¦ï¼ˆå†™å®Œäº†ï¼Œä¼˜åŒ–ä¸€ä¸‹ï¼Œä¼˜åŒ–äº†ï¼‰\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tå­åºæœ€å¤§å’Œï¼ˆè¦æ±‚å­åºåˆ—é•¿åº¦å¤§äºç­‰äºkï¼‰\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\tLC128\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰¾é“¾è¡¨äº¤ç‚¹ï¼Œ\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t1. åˆ¤æ–­äºŒå‰æ ‘æ˜¯å¦é•œåƒ\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2. ç»™ä¸€ä¸ªåˆ†æ•°n/mï¼Œå¦‚æœè¿™ä¸ªåˆ†æ•°æ˜¯æ— çº¿å¾ªç¯å°æ•°ï¼Œæ‰¾å‡ºå¾ªç¯ä½ã€‚\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t3. I am student è¿”å› student am I\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t6.å…ˆå‡åé™æ•°ç»„ï¼Œæ‰¾å³°å€¼çš„åæ ‡ï¼ŒäºŒåˆ†æ³•\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t5. æ’•ä»£ç ç¯èŠ‚ï¼šé¢˜ç›®ä¸ºleetcodeç¬¬ä¸‰é¢˜ï¼Œæ±‚æœ€é•¿è¿ç»­ä¸å«é‡å¤å­—ç¬¦å­ä¸²\t2020.07.07\n","description":"","id":71,"section":"talks","tags":[""],"title":"Leetcodeé«˜é¢‘","uri":"https://hugo.jiahongw.com/zh/talks/leetcode-hot/"},{"content":"æè¿°ç¬¦çš„å°±ç»ªçŠ¶æ€æœ‰ä¸¤ç§åˆ¤æ–­æ–¹æ³•: è¾¹æ²¿è§¦å‘å’Œæ°´å¹³è§¦å‘ã€‚\næ°´å¹³è§¦å‘\næˆ‘è®¤ä¸ºè¿™æ˜¯â€œæ‹‰â€æ¨¡å¼æˆ–â€œæ°‘æ„è°ƒæŸ¥â€æ¨¡å¼ã€‚ä¸ºäº†ç¡®å®šæè¿°ç¬¦æ˜¯å¦å°±ç»ªï¼Œè¿›ç¨‹å°è¯•æ‰§è¡Œéé˜»å¡ I/O æ“ä½œã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥å¤šæ¬¡æ‰§è¡Œè¿™æ ·çš„æ“ä½œã€‚è¿™å…è®¸åœ¨å¤„ç†ä»»ä½•åç»­ I/O æ“ä½œæ–¹é¢æœ‰æ›´å¤§çš„çµæ´»æ€§ãƒ¼ä¾‹å¦‚ï¼Œå¦‚æœæè¿°ç¬¦å·²ç»å‡†å¤‡å¥½ï¼Œè¿›ç¨‹å¯ä»¥é€‰æ‹©è¯»å–æ‰€æœ‰å¯ç”¨çš„æ•°æ®æˆ–è€…æ ¹æœ¬ä¸æ‰§è¡Œä»»ä½• I/O æ“ä½œï¼Œæˆ–è€…é€‰æ‹©ä¸è¯»å–ç¼“å†²åŒºä¸­æ‰€æœ‰å¯ç”¨çš„è¾“å…¥æ•°æ®ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚\nåœ¨ t0æ—¶ï¼Œè¿›ç¨‹å¯ä»¥åœ¨éé˜»å¡æè¿°ç¬¦ä¸Šå°è¯• I/O æ“ä½œã€‚å¦‚æœ I/O æ“ä½œé˜»å¡ï¼Œç³»ç»Ÿè°ƒç”¨å°†è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚\nç„¶ååœ¨ t1æ—¶ï¼Œè¿›ç¨‹å¯ä»¥å†æ¬¡å°è¯•åœ¨æè¿°ç¬¦ä¸Šè¿›è¡Œ I/Oã€‚å‡è®¾è°ƒç”¨å†æ¬¡é˜»å¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚\nç„¶ååœ¨æ—¶é—´ t2ï¼Œè¿›ç¨‹å†æ¬¡å°è¯•æè¿°ç¬¦ä¸Šçš„ I/Oã€‚å‡è®¾è°ƒç”¨å†æ¬¡é˜»å¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚\nå‡è®¾åœ¨ t3æ—¶ï¼Œè¿›ç¨‹è½®è¯¢æè¿°ç¬¦çš„çŠ¶æ€ï¼Œæè¿°ç¬¦å°±ç»ªã€‚ç„¶åè¿›ç¨‹å¯ä»¥é€‰æ‹©å®é™…æ‰§è¡Œæ•´ä¸ª I/O æ“ä½œ(ä¾‹å¦‚ï¼Œè¯»å–å¥—æ¥å­—ä¸Šçš„æ‰€æœ‰å¯ç”¨æ•°æ®)ã€‚\nè®©æˆ‘ä»¬å‡è®¾åœ¨ t4æ—¶è¿›ç¨‹è½®è¯¢æè¿°ç¬¦çš„çŠ¶æ€ï¼Œè€Œæè¿°ç¬¦æ²¡æœ‰å‡†å¤‡å¥½ã€‚è°ƒç”¨å†æ¬¡é˜»å¡ï¼Œå¹¶ä¸” I/O æ“ä½œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚\nå‡è®¾åœ¨ t5æ—¶ï¼Œè¿›ç¨‹è½®è¯¢æè¿°ç¬¦çš„çŠ¶æ€ï¼Œæè¿°ç¬¦å°±ç»ªã€‚è¿›ç¨‹éšåå¯ä»¥é€‰æ‹©åªæ‰§è¡Œéƒ¨åˆ† I/O æ“ä½œ(ä¾‹å¦‚ï¼Œåªè¯»å–æ‰€æœ‰å¯ç”¨æ•°æ®çš„ä¸€åŠ)ã€‚\nâ€‹\tå‡è®¾åœ¨ t6æ—¶ï¼Œè¿›ç¨‹è½®è¯¢æè¿°ç¬¦çš„çŠ¶æ€ï¼Œæè¿°ç¬¦å°±ç»ªã€‚è¿™ä¸€æ¬¡ï¼Œè¿›ç¨‹å¯ä»¥é€‰æ‹©æ ¹æœ¬ä¸æ‰§è¡Œåç»­çš„ I/Oã€‚\nè¾¹ç¼˜è§¦å‘ æµç¨‹åªæœ‰åœ¨æ–‡ä»¶æè¿°ç¬¦â€œå°±ç»ªâ€æ—¶æ‰ä¼šæ”¶åˆ°é€šçŸ¥(é€šå¸¸æ˜¯åœ¨æ–‡ä»¶æè¿°ç¬¦ä¸Šæœ‰ä»»ä½•æ–°æ´»åŠ¨æ—¶ï¼Œå› ä¸ºå®ƒæ˜¯ä¸Šæ¬¡è¢«ç›‘è§†çš„)ã€‚æˆ‘è®¤ä¸ºè¿™å°±æ˜¯â€œæ¨é€â€æ¨¡å‹ï¼Œå› ä¸ºé€šçŸ¥è¢«æ¨é€åˆ°è¿›ç¨‹ä¸­ï¼Œè¯´æ˜æ–‡ä»¶æè¿°ç¬¦çš„å‡†å¤‡å°±ç»ªæƒ…å†µã€‚æ­¤å¤–ï¼Œå¯¹äº push æ¨¡å‹ï¼Œåªé€šçŸ¥è¿›ç¨‹è¯´æè¿°ç¬¦å·²ç»ä¸º I/O å‡†å¤‡å¥½äº†ï¼Œè€Œä¸æä¾›å…¶ä»–ä¿¡æ¯ï¼Œä¾‹å¦‚åˆ°è¾¾ socket ç¼“å†²åŒºçš„å­—èŠ‚æ•°ã€‚\nå› æ­¤ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹è¯•å›¾æ‰§è¡Œä»»ä½•åç»­ I/O æ“ä½œæ—¶ï¼Œå®ƒåªé…å¤‡äº†ä¸å®Œæ•´çš„æ•°æ®ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿›ç¨‹å¯ä»¥åœ¨æ¯æ¬¡è·å¾—æè¿°ç¬¦å‡†å¤‡å°±ç»ªé€šçŸ¥æ—¶ï¼Œå°è¯•æ‰§è¡Œå°½å¯èƒ½å¤§çš„ I/Oï¼Œå› ä¸ºå¦‚æœä¸è¿™æ ·åšï¼Œå°±æ„å‘³ç€è¿›ç¨‹å¿…é¡»ç­‰å¾…ä¸‹ä¸€ä¸ªé€šçŸ¥åˆ°æ¥ï¼Œå³ä½¿åœ¨ä¸‹ä¸€ä¸ªé€šçŸ¥åˆ°æ¥ä¹‹å‰ï¼Œåœ¨æè¿°ç¬¦ä¸Šå¯ä»¥è¿›è¡Œ I/Oã€‚\nå¼€å§‹ï¼š\nåœ¨ t2æ—¶ï¼Œè¿›ç¨‹å¾—åˆ°ä¸€ä¸ªå…³äºæè¿°ç¬¦å·²ç»å‡†å¤‡å¥½çš„é€šçŸ¥ã€‚\nå¯ç”¨äº I/O çš„å­—èŠ‚æµå­˜å‚¨åœ¨ç¼“å†²åŒºä¸­ã€‚å‡è®¾å½“è¿›ç¨‹åœ¨æ—¶é—´ t2è·å¾—é€šçŸ¥æ—¶ï¼Œæœ‰1024ä¸ªå­—èŠ‚å¯ä¾›è¯»å–ã€‚\nå‡è®¾è¯¥è¿›ç¨‹åªè¯»å–1024ä¸ªå­—èŠ‚ä¸­çš„500ä¸ªå­—èŠ‚ã€‚\nè¿™æ„å‘³ç€åœ¨ t3ã€ t4å’Œ t5æ—¶ï¼Œç¼“å†²åŒºä¸­ä»ç„¶æœ‰524ä¸ªå­—èŠ‚å¯ä¾›è¿›ç¨‹è¯»å–è€Œä¸ä¼šé˜»å¡ã€‚ä½†æ˜¯ï¼Œç”±äºè¿›ç¨‹åªèƒ½åœ¨è·å¾—ä¸‹ä¸€ä¸ªé€šçŸ¥åæ‰§è¡Œ I/Oï¼Œå› æ­¤åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œè¿™524ä¸ªå­—èŠ‚å°†ä¿ç•™åœ¨ç¼“å†²åŒºä¸­ã€‚\nå‡è®¾è¿›ç¨‹åœ¨æ—¶é—´ t6è·å¾—ä¸‹ä¸€ä¸ªé€šçŸ¥ï¼Œå½“é¢å¤–çš„1024ä¸ªå­—èŠ‚åˆ°è¾¾ç¼“å†²åŒºæ—¶ã€‚ç¼“å†²åŒºä¸Šå¯ç”¨çš„æ•°æ®æ€»é‡ç°åœ¨æ˜¯1548å­—èŠ‚ãƒ¼524å­—èŠ‚ï¼Œä»¥å‰æ²¡æœ‰è¯»è¿‡ï¼Œ1024å­—èŠ‚æ˜¯æ–°åˆ°çš„ã€‚\nå‡è®¾è¿›ç¨‹ç°åœ¨è¯»å–1024ä¸ªå­—èŠ‚ã€‚\nè¿™æ„å‘³ç€åœ¨ç¬¬äºŒæ¬¡ I/O æ“ä½œç»“æŸæ—¶ï¼Œ524ä¸ªå­—èŠ‚ä»ç„¶ä¿ç•™åœ¨ç¼“å†²åŒºä¸­ï¼Œåœ¨ä¸‹ä¸€ä¸ªé€šçŸ¥åˆ°è¾¾ä¹‹å‰ï¼Œè¿›ç¨‹å°†æ— æ³•è¯»å–è¿™ä¸ªç¼“å†²åŒºã€‚\nè™½ç„¶åœ¨é€šçŸ¥åˆ°è¾¾åç«‹å³æ‰§è¡Œæ‰€æœ‰ I/O å¯èƒ½æ˜¯ä¸´æ—¶çš„ï¼Œä½†è¿™æ ·åšä¼šäº§ç”Ÿä¸€äº›åæœã€‚å•ä¸ªæè¿°ç¬¦ä¸Šçš„å¤§å‹ I/O æ“ä½œå¯èƒ½ä¼šé¥¿æ­»å…¶ä»–æè¿°ç¬¦ã€‚æ­¤å¤–ï¼Œå³ä½¿åœ¨çº§åˆ«è§¦å‘é€šçŸ¥çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªéå¸¸å¤§çš„å†™æˆ–å‘é€è°ƒç”¨ä¹Ÿæœ‰å¯èƒ½é˜»å¡ã€‚\nMultiplexing I/O on descriptors æœ‰å‡ ç§åœ¨æè¿°ç¬¦ä¸Šå¤šè·¯ I/O çš„æ–¹æ³•:\nâ€” non-blocking I/O (the descriptor itself is marked as non-blocking, operations may finish partially)\nâ€” signal driven I/O (the process owning the descriptor is notified when the I/O state of the descriptor changes)\nâ€” polling I/O (with *select* or *poll* system calls, both of which provide level triggered notifications about the readiness of descriptors)\nâ€” BSD specific kernel event polling (with the *kevent* system call).\nå‚è€ƒï¼š\n https://medium.com/@copyconstruct/the-method-to-epolls-madness-d9d2d6378642  ","description":"","id":72,"section":"posts","tags":["Linux","epoll"],"title":"epollçš„æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘","uri":"https://hugo.jiahongw.com/zh/posts/linux/epoll-lt-et/"},{"content":"HTTPæ˜¯ä¸€ä¸ªå±äºåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ï¼Œç”±äºå…¶ç®€æ·ã€å¿«é€Ÿçš„æ–¹å¼ï¼Œé€‚ç”¨äºåˆ†å¸ƒå¼è¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿã€‚\nHTTP/0.9 HTTP æ˜¯åŸºäº TCP/IP åè®®çš„åº”ç”¨å±‚åè®®ã€‚å®ƒä¸æ¶‰åŠæ•°æ®åŒ…ï¼ˆpacketï¼‰ä¼ è¾“ï¼Œä¸»è¦è§„å®šäº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡æ ¼å¼ï¼Œé»˜è®¤ä½¿ç”¨80ç«¯å£ã€‚\n åè®®è§„å®šï¼ŒæœåŠ¡å™¨åªèƒ½å›åº”HTMLæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä¸èƒ½å›åº”åˆ«çš„æ ¼å¼ã€‚\n HTTP/1.x  åœ¨æ—©æœŸï¼ŒHTTP ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ¨¡å‹æ¥å¤„ç†è¿™æ ·çš„è¿æ¥ã€‚è¿™äº›è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸæ˜¯çŸ­æš‚çš„ï¼šæ¯å‘èµ·ä¸€ä¸ªè¯·æ±‚æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œå¹¶åœ¨æ”¶åˆ°åº”ç­”æ—¶ç«‹å³å…³é—­ã€‚è¿æ¥çš„æˆæœ¬è¾ƒé«˜ã€‚\n å½“è¯·æ±‚å‘èµ·æ—¶ï¼Œç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½éƒ½ä¼šå¯¹æ€§èƒ½é€ æˆå½±å“ã€‚ç°ä»£æµè§ˆå™¨å¾€å¾€è¦å‘èµ·å¾ˆå¤šæ¬¡è¯·æ±‚(åå‡ ä¸ªæˆ–è€…æ›´å¤š)æ‰èƒ½æ‹¿åˆ°æ‰€éœ€çš„å®Œæ•´ä¿¡æ¯ï¼Œè¯æ˜äº†è¿™ä¸ªæ—©æœŸæ¨¡å‹çš„æ•ˆç‡ä½ä¸‹ã€‚\nåœ¨ HTTP/1.x é‡Œæœ‰å¤šç§æ¨¡å‹ï¼šçŸ­è¿æ¥, é•¿è¿æ¥, å’Œ HTTP æµæ°´çº¿ã€‚\nçŸ­é“¾æ¥æ¨¡å‹ HTTP/1.0 çš„é»˜è®¤æ¨¡å‹ã€‚æ¯ä¸€ä¸ª HTTP è¯·æ±‚éƒ½ç”±å®ƒè‡ªå·±ç‹¬ç«‹çš„è¿æ¥å®Œæˆï¼›è¿™æ„å‘³ç€å‘èµ·æ¯ä¸€ä¸ª HTTP è¯·æ±‚ä¹‹å‰éƒ½ä¼šæœ‰ä¸€æ¬¡ TCP æ¡æ‰‹ï¼Œè€Œä¸”æ˜¯è¿ç»­ä¸æ–­çš„ã€‚\n åœ¨ HTTP/1.1 ä¸­ï¼Œåªæœ‰å½“ Connection è¢«è®¾ç½®ä¸º close æ—¶æ‰ä¼šç”¨åˆ°è¿™ä¸ªæ¨¡å‹\n é•¿è¿æ¥æ¨¡å‹ ä¿æŒè¿æ¥å»å®Œæˆå¤šæ¬¡è¿ç»­çš„è¯·æ±‚ï¼Œå‡å°‘äº†ä¸æ–­é‡æ–°æ‰“å¼€è¿æ¥çš„æ—¶é—´ã€‚åœ¨ HTTP/1.1 é‡Œï¼Œé»˜è®¤å°±æ˜¯é•¿è¿æ¥çš„ã€‚\n çŸ­è¿æ¥æœ‰ä¸¤ä¸ªæ¯”è¾ƒå¤§çš„é—®é¢˜ï¼šåˆ›å»ºæ–°è¿æ¥è€—è´¹çš„æ—¶é—´å°¤ä¸ºæ˜æ˜¾ï¼Œå¦å¤– TCP è¿æ¥çš„æ€§èƒ½åªæœ‰åœ¨è¯¥è¿æ¥è¢«ä½¿ç”¨ä¸€æ®µæ—¶é—´å(çƒ­è¿æ¥)æ‰èƒ½å¾—åˆ°æ”¹å–„ã€‚å¦å¤–æˆ‘ä»¬çŸ¥é“ï¼ŒTCPåè®®æœ‰ä¸ªæ»‘åŠ¨çª—å£ï¼Œæœ‰æ…¢å¯åŠ¨è¿™å›äº‹ï¼Œå°±æ˜¯è¯´æ¯æ¬¡å»ºç«‹æ–°è¿æ¥åï¼Œæ•°æ®å…ˆæ˜¯æ…¢æ…¢åœ°ä¼ ï¼Œç„¶åæ»‘åŠ¨çª—å£æ…¢æ…¢å˜å¤§ï¼Œæ‰èƒ½è¾ƒé«˜é€Ÿåº¦åœ°ä¼ ã€‚\n å…·ä½“æµç¨‹ï¼š\nä¸€ä¸ªé•¿è¿æ¥ä¼šä¿æŒä¸€æ®µæ—¶é—´ï¼Œé‡å¤ç”¨äºå‘é€ä¸€ç³»åˆ—è¯·æ±‚ï¼ŒèŠ‚çœäº†æ–°å»º TCP è¿æ¥æ¡æ‰‹çš„æ—¶é—´ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ TCP çš„æ€§èƒ½å¢å¼ºèƒ½åŠ›ã€‚å½“ç„¶è¿™ä¸ªè¿æ¥ä¹Ÿä¸ä¼šä¸€ç›´ä¿ç•™ç€ï¼šè¿æ¥åœ¨ç©ºé—²ä¸€æ®µæ—¶é—´åä¼šè¢«å…³é—­(æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ Keep-Alive åè®®å¤´æ¥æŒ‡å®šä¸€ä¸ªæœ€å°çš„è¿æ¥ä¿æŒæ—¶é—´)ã€‚\nç¼ºç‚¹ï¼š\nå°±ç®—æ˜¯åœ¨ç©ºé—²çŠ¶æ€ï¼Œå®ƒè¿˜æ˜¯ä¼šæ¶ˆè€—æœåŠ¡å™¨èµ„æºï¼Œè€Œä¸”åœ¨é‡è´Ÿè½½æ—¶ï¼Œè¿˜æœ‰å¯èƒ½é­å— DoS attacks æ”»å‡»ã€‚è¿™ç§åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨éé•¿è¿æ¥ï¼Œå³å°½å¿«å…³é—­é‚£äº›ç©ºé—²çš„è¿æ¥ï¼Œä¹Ÿèƒ½å¯¹æ€§èƒ½æœ‰æ‰€æå‡ã€‚\n é•¿è¿æ¥ä¸€ä¸ªä¼˜åŒ–çš„æ–¹æ³•å°±æ˜¯è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œä½†æ˜¯å…·ä½“è¿™ä¸ªæ—¶é—´æ˜¯å¤šå°‘ï¼Œåº”è¯¥é€šè¿‡æµ‹è¯•ä¹‹åå¾—å‡ºä¸€ä¸ªè¾ƒä¸ºå‡è¡¡çš„æ—¶é—´ã€‚\n æµæ°´çº¿æ¨¡å‹(ç®¡çº¿åŒ–) å¤šä¸ªè¿ç»­çš„è¯·æ±‚ç”šè‡³éƒ½ä¸ç”¨ç­‰å¾…ç«‹å³è¿”å›å°±å¯ä»¥è¢«å‘é€ã€‚HTTP æµæ°´çº¿åœ¨ç°ä»£æµè§ˆå™¨ä¸­å¹¶ä¸æ˜¯é»˜è®¤è¢«å¯ç”¨çš„ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼ŒHTTP è¯·æ±‚æ˜¯æŒ‰é¡ºåºå‘å‡ºçš„ã€‚ä¸‹ä¸€ä¸ªè¯·æ±‚åªæœ‰åœ¨å½“å‰è¯·æ±‚æ”¶åˆ°åº”ç­”è¿‡åæ‰ä¼šè¢«å‘å‡ºã€‚ç”±äºä¼šå—åˆ°ç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½çš„é™åˆ¶ï¼Œåœ¨ä¸‹ä¸€ä¸ªè¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´ã€‚\n**æµæ°´çº¿æ˜¯åœ¨åŒä¸€æ¡é•¿è¿æ¥ä¸Šå‘å‡ºè¿ç»­çš„è¯·æ±‚ï¼Œè€Œä¸ç”¨ç­‰å¾…åº”ç­”è¿”å›ã€‚è¿™æ ·å¯ä»¥é¿å…è¿æ¥å»¶è¿Ÿã€‚ç†è®ºä¸Šè®²ï¼Œæ€§èƒ½è¿˜ä¼šå› ä¸ºä¸¤ä¸ª HTTP è¯·æ±‚æœ‰å¯èƒ½è¢«æ‰“åŒ…åˆ°ä¸€ä¸ª TCP æ¶ˆæ¯åŒ…ä¸­è€Œå¾—åˆ°æå‡ã€‚**å°±ç®— HTTP è¯·æ±‚ä¸æ–­çš„ç»§ç»­ï¼Œå°ºå¯¸ä¼šå¢åŠ ï¼Œä½†è®¾ç½® TCP çš„ MSS(Maximum Segment Size) é€‰é¡¹ï¼Œä»ç„¶è¶³å¤ŸåŒ…å«ä¸€ç³»åˆ—ç®€å•çš„è¯·æ±‚ã€‚\n æ¯”å¦‚ï¼Œå½“è¯·æ±‚ä¸€ä¸ªåŒ…å«10å¼ å›¾ç‰‡çš„HTML Webé¡µé¢ï¼Œä¸æŒ¨ä¸ªè¿æ¥ç›¸æ¯”ï¼Œç”¨æŒä¹…è¿æ¥å¯ä»¥è®©è¯·æ±‚æ›´å¿«ç»“æŸã€‚è€Œç®¡çº¿åŒ–æŠ€æœ¯åˆ™æ¯”æŒä¹…è¿æ¥è¿˜è¦å¿«ã€‚è¯·æ±‚æ•°è¶Šå¤šï¼Œæ—¶é—´å·®å°±è¶Šæ˜æ˜¾ã€‚\n é˜Ÿå¤´é˜»å¡ åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒHTTPéµå®ˆâ€œè¯·æ±‚-å“åº”â€çš„æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯æ¯æ¬¡å‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯è¿”å›å“åº”ï¼Œè¿™ç§æ¨¡å¼å¾ˆç®€å•ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªè‡´å‘½ç¼ºé™·é‚£å°±æ˜¯é¡µé¢ä¸­æœ‰å¤šä¸ªè¯·æ±‚ï¼Œæ¯ä¸ªè¯·æ±‚å¿…é¡»ç­‰åˆ°å‰ä¸€ä¸ªè¯·æ±‚å“åº”ä¹‹åæ‰èƒ½å‘é€ï¼Œå¹¶ä¸”å½“å‰è¯·æ±‚çš„å“åº”è¿”å›ä¹‹åï¼Œå½“å‰è¯·æ±‚çš„ä¸‹ä¸€ä¸ªè¯·æ±‚æ‰èƒ½å‘é€ï¼Œæµç¨‹å¦‚ä¸‹å›¾\nåœ¨TCPé“¾æ¥ä¸­ï¼Œhttpè¯·æ±‚å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªè¯·æ±‚å“åº”ä¹‹åï¼Œæ‰èƒ½å‘é€ï¼Œåé¢çš„ä¾æ¬¡ç±»æ¨ï¼Œç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœåœ¨ä¸€ä¸ªtcpé€šé“ä¸­å¦‚æœæŸä¸ªhttpè¯·æ±‚çš„å“åº”å› ä¸ºæŸä¸ªåŸå› æ²¡æœ‰åŠæ—¶è¿”å›ï¼Œåé¢çš„å“åº”ä¼šè¢«é˜»å¡ï¼Œè¿™å°±æ˜¯é˜Ÿå¤´é˜»å¡ã€‚\n æ³¨æ„è¿™é‡Œè¯´çš„æ˜¯å“åº”ä¹‹åï¼Œå¹¶ä¸æ˜¯è¯·ä¹‹å!\n ä¸ºäº†æé«˜é€Ÿåº¦å’Œæ•ˆç‡ï¼Œåœ¨æŒä¹…è¿æ¥çš„åŸºç¡€ä¸Šï¼ŒHTTP1.1è¿›ä¸€æ­¥åœ°æ”¯æŒåœ¨æŒä¹…è¿æ¥ä¸Šä½¿ç”¨ç®¡é“åŒ–ï¼ˆpipeliningï¼‰ç‰¹æ€§ã€‚ç®¡é“åŒ–å…è®¸å®¢æˆ·ç«¯åœ¨å·²å‘é€çš„è¯·æ±‚æ”¶åˆ°æœåŠ¡ç«¯çš„å“åº”ä¹‹å‰å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œå€Ÿæ­¤æ¥å‡å°‘ç­‰å¾…æ—¶é—´æé«˜ååï¼Œå¦‚æœå¤šä¸ªè¯·æ±‚èƒ½åœ¨åŒä¸€ä¸ªTCPåˆ†èŠ‚å‘é€çš„è¯ï¼Œè¿˜èƒ½æé«˜ç½‘ç»œåˆ©ç”¨ç‡ï¼Œæµç¨‹å¦‚å›¾ï¼š\nåŒä¸€ä¸ªtcpè¿æ¥ä¸­å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªhttpè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯å¹¶å‘ï¼Œä½†æ˜¯åœ¨å“åº”çš„æ—¶å€™ï¼Œå¿…é¡»æ’é˜Ÿå“åº”ï¼Œè°å…ˆåˆ°è¾¾çš„è°å…ˆå“åº”ï¼Œç›¸æ¯”ä¸æ”¯æŒç®¡é“åŒ–çš„httpè¯·æ±‚ç¡®å®æé«˜äº†æ•ˆç‡ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å±€é™æ€§ï¼Œå‡å¦‚å…¶ä¸­æŸä¸ªå“åº”å› ä¸ºæŸç§åŸå› å»¶è¿Ÿäº†å‡ ç§’ï¼Œåé¢çš„å“åº”éƒ½ä¼šè¢«é˜»å¡ã€‚ä¸Šé¢ç®­å¤´æ‰€æŒ‡çš„å“åº”å¦‚æœé˜»å¡äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªä¹Ÿæ˜¯é˜Ÿå¤´é˜»å¡ã€‚\nå¹¶ä¸”ä½¿ç”¨HTTPç®¡é“åŒ–è¿˜æœ‰ä¸€äº›é™åˆ¶:\n1ã€ç®¡é“åŒ–è¦æ±‚æœåŠ¡ç«¯æŒ‰ç…§è¯·æ±‚å‘é€çš„é¡ºåºè¿”å›å“åº”ï¼ˆFIFOï¼‰ï¼ŒåŸå› å¾ˆç®€å•ï¼ŒHTTPè¯·æ±‚å’Œå“åº”å¹¶æ²¡æœ‰åºå·æ ‡è¯†ï¼Œæ— æ³•å°†ä¹±åºçš„å“åº”ä¸è¯·æ±‚å…³è”èµ·æ¥ã€‚\n2ã€å½“å®¢æˆ·ç«¯åœ¨æ”¯æŒç®¡é“åŒ–æ—¶éœ€è¦ä¿æŒæœªæ”¶åˆ°å“åº”çš„è¯·æ±‚ï¼Œå½“è¿æ¥æ„å¤–ä¸­æ–­æ—¶ï¼Œéœ€è¦é‡æ–°å‘é€è¿™éƒ¨åˆ†è¯·æ±‚ã€‚å¦‚æœè¿™ä¸ªè¯·æ±‚åªæ˜¯ä»æœåŠ¡å™¨è·å–æ•°æ®ï¼Œé‚£ä¹ˆå¹¶ä¸ä¼šå¯¹èµ„æºé€ æˆä»»ä½•å½±å“ï¼Œè€Œå¦‚æœæ˜¯ä¸€ä¸ªæäº¤ä¿¡æ¯çš„è¯·æ±‚å¦‚postè¯·æ±‚ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šé€ æˆèµ„æºå¤šæ¬¡æäº¤ä»è€Œæ”¹å˜èµ„æºï¼Œè¿™æ˜¯ä¸å…è®¸çš„ã€‚è€Œä¸ä¼šå¯¹æœåŠ¡å™¨èµ„æºäº§ç”Ÿå½±å“çš„è¯·æ±‚æœ‰ä¸ªä¸“ä¸šåè¯å«åšå¹‚ç­‰è¯·æ±‚ã€‚å®¢æˆ·ç«¯åœ¨ä½¿ç”¨ç®¡é“åŒ–çš„æ—¶å€™è¯·æ±‚æ–¹å¼å¿…é¡»æ˜¯å¹‚ç­‰è¯·æ±‚ã€‚\næ¯”è¾ƒï¼š\nä¸Šé¢çš„ç®¡çº¿åŒ–çš„æ¨¡å‹å°±æ˜¯åŠ é€Ÿäº†è¯·æ±‚çš„è¿‡ç¨‹ï¼Œä½†æ˜¯å“åº”çš„è¿‡ç¨‹è¿˜æ˜¯å­˜åœ¨é˜Ÿå¤´é˜»å¡ã€‚\n å› ä¸ºHTTPç®¡é“åŒ–æœ¬èº«å¯èƒ½ä¼šå¯¼è‡´é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ï¼Œä»¥åŠä¸Šé¢æåˆ°çš„ä¸€äº›é™åˆ¶ï¼Œç°ä»£æµè§ˆå™¨é»˜è®¤éƒ½å…³é—­äº†ç®¡é“åŒ–ï¼Œå¹¶ä¸”å¤§éƒ¨åˆ†æœåŠ¡å™¨ä¹Ÿæ˜¯é»˜è®¤ä¸æ”¯æŒç®¡é“åŒ–çš„ã€‚\n å¦‚ä½•è§£å†³é˜Ÿå¤´é˜»å¡ï¼Ÿ\nå®¢æˆ·ç«¯ä½¿ç”¨å¹¶å‘é•¿è¿æ¥ï¼Œæ³¨æ„è¿™ä¸ªå¹¶å‘æŒ‡çš„æ˜¯tcpå¹¶å‘è¿æ¥ã€‚\n å¹¶å‘é•¿è¿æ¥è™½ç„¶åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†httpçš„é˜Ÿå¤´é˜»å¡ï¼Œä½†æ˜¯ä¼šå¯¹æœåŠ¡å™¨çš„æ€§èƒ½æœ‰è¾ƒé«˜çš„è¦æ±‚\n HTTP/2  HTTP/1.1 ç‰ˆçš„å¤´ä¿¡æ¯è‚¯å®šæ˜¯æ–‡æœ¬ï¼ˆASCIIç¼–ç ï¼‰ï¼Œæ•°æ®ä½“å¯ä»¥æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯äºŒè¿›åˆ¶ã€‚HTTP/2 åˆ™æ˜¯ä¸€ä¸ªå½»åº•çš„äºŒè¿›åˆ¶åè®®ï¼Œå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”ç»Ÿç§°ä¸º\u0026quot;å¸§\u0026rdquo;ï¼ˆframeï¼‰ï¼šå¤´ä¿¡æ¯å¸§å’Œæ•°æ®å¸§ã€‚\n ğŸ˜† HTTP/2 æ²¡æœ‰æ”¹åŠ¨ HTTP çš„åº”ç”¨è¯­ä¹‰ã€‚ HTTP æ–¹æ³•ã€çŠ¶æ€ä»£ç ã€URI å’Œæ ‡å¤´å­—æ®µç­‰æ ¸å¿ƒæ¦‚å¿µä¸€å¦‚å¾€å¸¸ã€‚ ä¸è¿‡ï¼ŒHTTP/2 ä¿®æ”¹äº†æ•°æ®æ ¼å¼åŒ–ï¼ˆåˆ†å¸§ï¼‰ä»¥åŠåœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é—´ä¼ è¾“çš„æ–¹å¼ã€‚è¿™ä¸¤ç‚¹ç»Ÿå¸…å…¨å±€ï¼Œé€šè¿‡æ–°çš„åˆ†å¸§å±‚å‘æˆ‘ä»¬çš„åº”ç”¨éšè—äº†æ‰€æœ‰å¤æ‚æ€§ã€‚ å› æ­¤ï¼Œæ‰€æœ‰ç°æœ‰çš„åº”ç”¨éƒ½å¯ä»¥ä¸å¿…ä¿®æ”¹è€Œåœ¨æ–°åè®®ä¸‹è¿è¡Œã€‚\n ä¸ºä»€ä¹ˆä¸æ˜¯ HTTP/1.2ï¼Ÿ\nä¸ºäº†å®ç° HTTP å·¥ä½œç»„è®¾å®šçš„æ€§èƒ½ç›®æ ‡ï¼ŒHTTP/2 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚ï¼Œè¯¥å±‚æ— æ³•ä¸ä¹‹å‰çš„ HTTP/1.x æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å‘åå…¼å®¹ï¼Œå› æ­¤åè®®çš„ä¸»ç‰ˆæœ¬æå‡åˆ° HTTP/2ã€‚\n äºŒè¿›åˆ¶åˆ†å¸§å±‚ HTTP/2 æ‰€æœ‰æ€§èƒ½å¢å¼ºçš„æ ¸å¿ƒåœ¨äºæ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•å°è£… HTTP æ¶ˆæ¯å¹¶åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“ã€‚\nè¿™é‡Œæ‰€è°“çš„â€œå±‚â€ï¼ŒæŒ‡çš„æ˜¯ä½äºå¥—æ¥å­—æ¥å£ä¸åº”ç”¨å¯è§çš„é«˜çº§ HTTP API ä¹‹é—´ä¸€ä¸ªç»è¿‡ä¼˜åŒ–çš„æ–°ç¼–ç æœºåˆ¶ï¼šHTTP çš„è¯­ä¹‰ï¼ˆåŒ…æ‹¬å„ç§åŠ¨è¯ã€æ–¹æ³•ã€æ ‡å¤´ï¼‰éƒ½ä¸å—å½±å“ï¼Œä¸åŒçš„æ˜¯ä¼ è¾“æœŸé—´å¯¹å®ƒä»¬çš„ç¼–ç æ–¹å¼å˜äº†ã€‚ HTTP/1.x åè®®ä»¥æ¢è¡Œç¬¦ä½œä¸ºçº¯æ–‡æœ¬çš„åˆ†éš”ç¬¦ï¼Œè€Œ HTTP/2 å°†æ‰€æœ‰ä¼ è¾“çš„ä¿¡æ¯åˆ†å‰²ä¸ºæ›´å°çš„æ¶ˆæ¯å’Œå¸§ï¼Œå¹¶é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼å¯¹å®ƒä»¬ç¼–ç ã€‚\næ•°æ®æµã€æ¶ˆæ¯å’Œå¸§  æ•°æ®æµï¼šå·²å»ºç«‹çš„è¿æ¥å†…çš„åŒå‘å­—èŠ‚æµï¼Œå¯ä»¥æ‰¿è½½ä¸€æ¡æˆ–å¤šæ¡æ¶ˆæ¯ã€‚ æ¶ˆæ¯ï¼šä¸é€»è¾‘è¯·æ±‚æˆ–å“åº”æ¶ˆæ¯å¯¹åº”çš„å®Œæ•´çš„ä¸€ç³»åˆ—å¸§ã€‚ å¸§ï¼šHTTP/2 é€šä¿¡çš„æœ€å°å•ä½ï¼Œæ¯ä¸ªå¸§éƒ½åŒ…å«å¸§å¤´ï¼Œè‡³å°‘ä¹Ÿä¼šæ ‡è¯†å‡ºå½“å‰å¸§æ‰€å±çš„æ•°æ®æµã€‚  å…³ç³»ï¼š\n æ‰€æœ‰é€šä¿¡éƒ½åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸Šå®Œæˆï¼Œæ­¤è¿æ¥å¯ä»¥æ‰¿è½½ä»»æ„æ•°é‡çš„åŒå‘æ•°æ®æµã€‚(å¤šå·¥) æ¯ä¸ªæ•°æ®æµéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦å’Œå¯é€‰çš„ä¼˜å…ˆçº§ä¿¡æ¯ï¼Œç”¨äºæ‰¿è½½åŒå‘æ¶ˆæ¯ã€‚ æ¯æ¡æ¶ˆæ¯éƒ½æ˜¯ä¸€æ¡é€»è¾‘ HTTP æ¶ˆæ¯ï¼ˆä¾‹å¦‚è¯·æ±‚æˆ–å“åº”ï¼‰ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå¸§ã€‚ å¸§æ˜¯æœ€å°çš„é€šä¿¡å•ä½ï¼Œæ‰¿è½½ç€ç‰¹å®šç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚ HTTP æ ‡å¤´ã€æ¶ˆæ¯è´Ÿè½½ç­‰ç­‰ã€‚ æ¥è‡ªä¸åŒæ•°æ®æµçš„å¸§å¯ä»¥äº¤é”™å‘é€ï¼Œç„¶åå†æ ¹æ®æ¯ä¸ªå¸§å¤´çš„æ•°æ®æµæ ‡è¯†ç¬¦é‡æ–°ç»„è£…ã€‚  ç®€è¨€ä¹‹ï¼ŒHTTP/2 å°† HTTP åè®®é€šä¿¡åˆ†è§£ä¸ºäºŒè¿›åˆ¶ç¼–ç å¸§çš„äº¤æ¢ï¼Œè¿™äº›å¸§å¯¹åº”ç€ç‰¹å®šæ•°æ®æµä¸­çš„æ¶ˆæ¯ã€‚æ‰€æœ‰è¿™äº›éƒ½åœ¨ä¸€ä¸ª TCP è¿æ¥å†…å¤ç”¨ã€‚ è¿™æ˜¯ HTTP/2 åè®®æ‰€æœ‰å…¶ä»–åŠŸèƒ½å’Œæ€§èƒ½ä¼˜åŒ–çš„åŸºç¡€ã€‚\nHTTP/2 å¸§ç»“æ„å¦‚ä¸‹ï¼š\nå®é™…çš„ä¼ è¾“è¿‡ç¨‹å¯èƒ½æ˜¯ä¸‹é¢è¿™æ ·(ååé‡å¢å¤§)ï¼š\nè¯·æ±‚ä¸å“åº”å¤ç”¨ HTTP/2 ä¸­æ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚å®ç°äº†å®Œæ•´çš„è¯·æ±‚å’Œå“åº”å¤ç”¨ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥å°† HTTP æ¶ˆæ¯åˆ†è§£ä¸ºäº’ä¸ä¾èµ–çš„å¸§ï¼Œç„¶åäº¤é”™å‘é€ï¼Œæœ€åå†åœ¨å¦ä¸€ç«¯æŠŠå®ƒä»¬é‡æ–°ç»„è£…èµ·æ¥ã€‚\næ•°æ®æµä¼˜å…ˆçº§ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸Šå›¾ä¸­çš„å‡ ä¸ªæ“ä½œç¤ºä¾‹ã€‚ ä»å·¦åˆ°å³ä¾æ¬¡ä¸ºï¼š\n æ•°æ®æµ A å’Œæ•°æ®æµ B éƒ½æ²¡æœ‰æŒ‡å®šçˆ¶ä¾èµ–é¡¹ï¼Œä¾èµ–äºéšå¼â€œæ ¹æ•°æ®æµâ€ï¼›A çš„æƒé‡ä¸º 12ï¼ŒB çš„æƒé‡ä¸º 4ã€‚å› æ­¤ï¼Œæ ¹æ®æ¯”ä¾‹æƒé‡ï¼šæ•°æ®æµ B è·å¾—çš„èµ„æºæ˜¯ A æ‰€è·èµ„æºçš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ æ•°æ®æµ D ä¾èµ–äºæ ¹æ•°æ®æµï¼›C ä¾èµ–äº Dã€‚ å› æ­¤ï¼ŒD åº”å…ˆäº C è·å¾—å®Œæ•´èµ„æºåˆ†é…ã€‚ æƒé‡ä¸é‡è¦ï¼Œå› ä¸º C çš„ä¾èµ–å…³ç³»æ‹¥æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚ æ•°æ®æµ D åº”å…ˆäº C è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›C åº”å…ˆäº A å’Œ B è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›æ•°æ®æµ B è·å¾—çš„èµ„æºæ˜¯ A æ‰€è·èµ„æºçš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ æ•°æ®æµ D åº”å…ˆäº E å’Œ C è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›E å’Œ C åº”å…ˆäº A å’Œ B è·å¾—ç›¸åŒçš„èµ„æºåˆ†é…ï¼›A å’Œ B åº”åŸºäºå…¶æƒé‡è·å¾—æ¯”ä¾‹åˆ†é…ã€‚  æµæ§åˆ¶ æµæ§åˆ¶æ˜¯ä¸€ç§é˜»æ­¢å‘é€æ–¹å‘æ¥æ”¶æ–¹å‘é€å¤§é‡æ•°æ®çš„æœºåˆ¶ï¼Œä»¥å…è¶…å‡ºåè€…çš„éœ€æ±‚æˆ–å¤„ç†èƒ½åŠ›ï¼šå‘é€æ–¹å¯èƒ½éå¸¸ç¹å¿™ã€å¤„äºè¾ƒé«˜çš„è´Ÿè½½ä¹‹ä¸‹ï¼Œä¹Ÿå¯èƒ½ä»…ä»…å¸Œæœ›ä¸ºç‰¹å®šæ•°æ®æµåˆ†é…å›ºå®šé‡çš„èµ„æºã€‚ ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯å¯èƒ½è¯·æ±‚äº†ä¸€ä¸ªå…·æœ‰è¾ƒé«˜ä¼˜å…ˆçº§çš„å¤§å‹è§†é¢‘æµï¼Œä½†æ˜¯ç”¨æˆ·å·²ç»æš‚åœè§†é¢‘ï¼Œå®¢æˆ·ç«¯ç°åœ¨å¸Œæœ›æš‚åœæˆ–é™åˆ¶ä»æœåŠ¡å™¨çš„ä¼ è¾“ï¼Œä»¥å…æå–å’Œç¼“å†²ä¸å¿…è¦çš„æ•°æ®ã€‚ å†æ¯”å¦‚ï¼Œä¸€ä¸ªä»£ç†æœåŠ¡å™¨å¯èƒ½å…·æœ‰è¾ƒå¿«çš„ä¸‹æ¸¸è¿æ¥å’Œè¾ƒæ…¢çš„ä¸Šæ¸¸è¿æ¥ï¼Œå¹¶ä¸”ä¹Ÿå¸Œæœ›è°ƒèŠ‚ä¸‹æ¸¸è¿æ¥ä¼ è¾“æ•°æ®çš„é€Ÿåº¦ä»¥åŒ¹é…ä¸Šæ¸¸è¿æ¥çš„é€Ÿåº¦æ¥æ§åˆ¶å…¶èµ„æºåˆ©ç”¨ç‡ï¼›ç­‰ç­‰ã€‚ç±»ä¼¼TCPæµé‡æ§åˆ¶ã€‚\næœåŠ¡å™¨æ¨é€ HTTP/2 æ–°å¢çš„å¦ä¸€ä¸ªå¼ºå¤§çš„æ–°åŠŸèƒ½æ˜¯ï¼ŒæœåŠ¡å™¨å¯ä»¥å¯¹ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚å‘é€å¤šä¸ªå“åº”ã€‚ æ¢å¥è¯è¯´ï¼Œé™¤äº†å¯¹æœ€åˆè¯·æ±‚çš„å“åº”å¤–ï¼ŒæœåŠ¡å™¨è¿˜å¯ä»¥å‘å®¢æˆ·ç«¯æ¨é€é¢å¤–èµ„æºï¼ˆå›¾ 12-5ï¼‰ï¼Œè€Œæ— éœ€å®¢æˆ·ç«¯æ˜ç¡®åœ°è¯·æ±‚ã€‚\næ ‡å¤´å‹ç¼© æ¯ä¸ª HTTP ä¼ è¾“éƒ½æ‰¿è½½ä¸€ç»„æ ‡å¤´ï¼Œè¿™äº›æ ‡å¤´è¯´æ˜äº†ä¼ è¾“çš„èµ„æºåŠå…¶å±æ€§ã€‚ åœ¨ HTTP/1.x ä¸­ï¼Œæ­¤å…ƒæ•°æ®å§‹ç»ˆä»¥çº¯æ–‡æœ¬å½¢å¼ï¼Œé€šå¸¸ä¼šç»™æ¯ä¸ªä¼ è¾“å¢åŠ  500â€“800 å­—èŠ‚çš„å¼€é”€ã€‚å¦‚æœä½¿ç”¨ HTTP Cookieï¼Œå¢åŠ çš„å¼€é”€æœ‰æ—¶ä¼šè¾¾åˆ°ä¸Šåƒå­—èŠ‚ã€‚ä¸ºäº†å‡å°‘æ­¤å¼€é”€å’Œæå‡æ€§èƒ½ï¼ŒHTTP/2 ä½¿ç”¨ HPACK å‹ç¼©æ ¼å¼å‹ç¼©è¯·æ±‚å’Œå“åº”æ ‡å¤´å…ƒæ•°æ®ï¼Œè¿™ç§æ ¼å¼é‡‡ç”¨ä¸¤ç§ç®€å•ä½†æ˜¯å¼ºå¤§çš„æŠ€æœ¯ï¼š\n è¿™ç§æ ¼å¼æ”¯æŒé€šè¿‡é™æ€éœå¤«æ›¼ä»£ç å¯¹ä¼ è¾“çš„æ ‡å¤´å­—æ®µè¿›è¡Œç¼–ç ï¼Œä»è€Œå‡å°äº†å„ä¸ªä¼ è¾“çš„å¤§å°ã€‚ è¿™ç§æ ¼å¼è¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ—¶ç»´æŠ¤å’Œæ›´æ–°ä¸€ä¸ªåŒ…å«ä¹‹å‰è§è¿‡çš„æ ‡å¤´å­—æ®µçš„ç´¢å¼•åˆ—è¡¨ï¼ˆæ¢å¥è¯è¯´ï¼Œå®ƒå¯ä»¥å»ºç«‹ä¸€ä¸ªå…±äº«çš„å‹ç¼©ä¸Šä¸‹æ–‡ï¼‰ï¼Œæ­¤åˆ—è¡¨éšåä¼šç”¨ä½œå‚è€ƒï¼Œå¯¹ä¹‹å‰ä¼ è¾“çš„å€¼è¿›è¡Œæœ‰æ•ˆç¼–ç ã€‚  åˆ©ç”¨éœå¤«æ›¼ç¼–ç ï¼Œå¯ä»¥åœ¨ä¼ è¾“æ—¶å¯¹å„ä¸ªå€¼è¿›è¡Œå‹ç¼©ï¼Œè€Œåˆ©ç”¨ä¹‹å‰ä¼ è¾“å€¼çš„ç´¢å¼•åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ è¾“ç´¢å¼•å€¼çš„æ–¹å¼å¯¹é‡å¤å€¼è¿›è¡Œç¼–ç ï¼Œç´¢å¼•å€¼å¯ç”¨äºæœ‰æ•ˆæŸ¥è¯¢å’Œé‡æ„å®Œæ•´çš„æ ‡å¤´é”®å€¼å¯¹ã€‚\nå“ˆå¤«æ›¼æ ‘å¦‚ä½•å‹ç¼© æ–‡ä»¶å‹ç¼©çš„ä¸»è¦æ€æƒ³æ˜¯åˆ©ç”¨å“ˆå¤«æ›¼ç¼–ç æ¥å®ç°çš„ï¼Œä½†æ˜¯å¾—åˆ°ç¼–ç ä¹‹å‰æˆ‘ä»¬éœ€è¦æ„å»ºè¿™æ£µæ ‘ã€‚é‚£ä¹ˆåˆ©ç”¨ä»€ä¹ˆæ¥æ„å»ºæ ‘å‘¢ï¼Ÿï¼è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°ï¼Œç”¨æ¬¡æ•°æ¥æ„å»ºHuffmanTreeã€‚å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ª.txtçš„å°æ–‡ä»¶ï¼Œå†…å®¹æ˜¯\u0026quot;aaaabbbccd\u0026quot;ã€‚å­—ç¬¦å­˜åœ¨è®¡ç®—æœºä¸­æ—¶ä»¥å­—èŠ‚ä¸ºå•ä½çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†è¿™äº›å­—ç¬¦å‹ç¼©æˆ0ã€1è¡¨ç¤ºçš„ç¼–ç ï¼Œ0å’Œ1è¡¨ç¤ºå­—èŠ‚ä¸­çš„â€œä½â€ï¼Œè¿™æ ·èƒ½å¤§å¤§é™ä½æ–‡ä»¶çš„å¤§å°ã€‚\nä½“éªŒHTTP2 https://http2.akamai.com/demo\nå‚è€ƒé“¾æ¥ï¼š\n HTTP è¿æ¥ç®¡ç†è¿›åŒ–è®º https://developers.google.com/web/fundamentals/performance/http2?hl=zh-cn ç™½è¯httpé˜Ÿå¤´é˜»å¡  ","description":"httpåè®®è¿­ä»£äº†å¥½å‡ ä¸ªç‰ˆæœ¬ï¼Œä»ä¸€å¼€å§‹çš„çŸ­é“¾æ¥æ¨¡å‹åˆ°é•¿è¿æ¥æ¨¡å‹ï¼Œæœ€åè¿˜è¡ç”Ÿå‡ºäºŒè¿›åˆ¶å¸§å±‚......","id":73,"section":"posts","tags":["network","http","https"],"title":"Httpåè®®æµ…æ","uri":"https://hugo.jiahongw.com/zh/posts/network/http/"},{"content":"C/C++ â­•é¢å‘å¯¹è±¡ä¸é¢å‘è¿‡ç¨‹ Leetcodeå¯¹é¢å‘å¯¹è±¡çš„ç†è§£ï¼šé¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ–¹å¼ä½¿å¾—æ¯ä¸€ä¸ªç±»éƒ½åªåšä¸€ä»¶äº‹ã€‚é¢å‘è¿‡ç¨‹ä¼šè®©ä¸€ä¸ªç±»è¶Šæ¥è¶Šå…¨èƒ½ï¼Œå°±åƒä¸€ä¸ªç®¡å®¶ä¸€æ ·åšäº†æ‰€æœ‰çš„äº‹ã€‚è€Œé¢å‘å¯¹è±¡åƒæ˜¯é›‡ä½£äº†ä¸€ç¾¤èŒå‘˜ï¼Œæ¯ä¸ªäººåšä¸€ä»¶å°äº‹ï¼Œå„å¸å…¶èŒï¼Œæœ€ç»ˆåˆä½œå…±èµ¢ï¼\né¢å‘å¯¹è±¡çš„ç‰¹ç‚¹æ˜¯å¯ç»´æŠ¤ã€å¯å¤ç”¨ã€å¯æ‰©å±•ã€çµæ´»æ€§å¥½ï¼Œå®ƒçœŸæ­£å¼ºå¤§çš„åœ°æ–¹åœ¨äºï¼šéšç€ä¸šåŠ¡å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œé¢å‘å¯¹è±¡ä¾ç„¶èƒ½å¤Ÿä½¿å¾—ç¨‹åºç»“æ„è‰¯å¥½ï¼Œè€Œé¢å‘è¿‡ç¨‹å´ä¼šå¯¼è‡´ç¨‹åºè¶Šæ¥è¶Šè‡ƒè‚¿ã€‚\nè®©é¢å‘å¯¹è±¡ä¿æŒç»“æ„è‰¯å¥½çš„ç§˜è¯€å°±æ˜¯ è®¾è®¡æ¨¡å¼ã€‚\nâ•C++ç¨‹åºè®¾è®¡æ¨¡å‹ ç¨‹åºæ¨¡å‹(procedural model)\næŠ½è±¡æ•°æ®æ¨¡å‹(abstract data type model)\nä¾‹å¦‚std::string\né¢å‘å¯¹è±¡æ¨¡å‹(object-oriented model)\nâœ–å¤šæ€ å¤šæ€å¦‚ä½•å®ç°ï¼Ÿ\nè¦å®ç°C++ä¸­OOç¨‹åºè®¾è®¡çš„å¤šæ€æ€§è´¨ï¼Œåªæœ‰é€šè¿‡pointæˆ–è€…referenceçš„é—´æ¥å¤„ç†ã€‚\nå¤šæ€ç”¨é€”ï¼Ÿ\nç»ç”±ä¸€ä¸ªå…±åŒçš„æ¥å£æ¥å½±å“ç±»å‹çš„å°è£…ï¼Œè¿™ä¸ªæ¥å£é€šå¸¸è¢«å®šä¹‰åœ¨ä¸€ä¸ªæŠ½è±¡çš„base classä¸­ã€‚\nè™šå‡½æ•°ä¸çº¯è™šå‡½æ•°\nå¼•å…¥è™šå‡½æ•°æ˜¯ä¸ºäº†åŠ¨æ€ç»‘å®š,å¼•å…¥è™šå‡½æ•°æ˜¯ä¸ºäº†åŠ¨æ€ç»‘å®šã€‚\nåŸºç±»éœ€è¦è™šææ„å‡½æ•°çš„åŸå› \nå½“derived classç»ç”±ä¸€ä¸ªbase classæŒ‡é’ˆè¢«åˆ é™¤è€Œè¯¥base classçš„ææ„å‡½æ•°ä¸ºnon-virtualæ—¶ï¼Œå°†å‘ç”Ÿæœªå®šä¹‰è¡Œä¸ºã€‚é€šå¸¸å°†å‘ç”Ÿèµ„æºæ³„æ¼ã€‚\nè§£å†³æ–¹æ³•å³ä¸ºï¼šä¸ºå¤šæ€åŸºç±»å£°æ˜ä¸€ä¸ªvirtual ææ„å‡½æ•°ã€‚\nğŸ– C++11æ–°ç‰¹æ€§  è‡ªåŠ¨ç±»å‹æ¨æ–­ auto åŒ¿åå‡½æ•° Lambda æ™ºèƒ½æŒ‡é’ˆ æ˜¾ç¤ºé‡å†™(è¦†ç›–)overrideå’Œfinal  ğŸ“‡const å…³é”®å­—constå‡ºç°åœ¨æ˜Ÿå·å·¦è¾¹ï¼Œè¡¨ç¤ºè¢«æŒ‡ç‰©æ˜¯å¸¸é‡ï¼›å¦‚æœå‡ºç°åœ¨æ˜Ÿå·å³è¾¹ï¼Œè¡¨ç¤ºæŒ‡é’ˆæœ¬èº«æ˜¯å¸¸é‡ï¼›å¦‚æœå‡ºç°åœ¨ä¸¤è¾¹ï¼Œè¡¨ç¤ºè¢«æŒ‡ç‰©å’ŒæŒ‡é’ˆéƒ½æ˜¯å¸¸é‡ã€‚\nä½œç”¨ï¼š\n ä¿®é¥°å˜é‡ï¼Œè¯´æ˜è¯¥å˜é‡ä¸å¯ä»¥è¢«æ”¹å˜ï¼› ä¿®é¥°æŒ‡é’ˆï¼Œåˆ†ä¸ºæŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆï¼ˆpointer to constï¼‰å’Œè‡ªèº«æ˜¯å¸¸é‡çš„æŒ‡é’ˆï¼ˆå¸¸é‡æŒ‡é’ˆï¼Œconst pointerï¼‰ï¼› ä¿®é¥°å¼•ç”¨ï¼ŒæŒ‡å‘å¸¸é‡çš„å¼•ç”¨ï¼ˆreference to constï¼‰ï¼Œç”¨äºå½¢å‚ç±»å‹ï¼Œå³é¿å…äº†æ‹·è´ï¼Œåˆé¿å…äº†å‡½æ•°å¯¹å€¼çš„ä¿®æ”¹ï¼› ä¿®é¥°æˆå‘˜å‡½æ•°ï¼Œè¯´æ˜è¯¥æˆå‘˜å‡½æ•°å†…ä¸èƒ½ä¿®æ”¹æˆå‘˜å˜é‡ã€‚  ğŸ—½Static   é™æ€å¸¸é‡æ•´æ•°æˆå‘˜å¯ä»¥åœ¨ç±»å†…è¿›è¡Œåˆå§‹åŒ–ï¼Œå…¶ä»–éœ€è¦åœ¨ç±»å¤–é¢è¿›è¡Œåˆå§‹åŒ–\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  #include \u0026lt;iostream\u0026gt;using namespace std; class A{ public: static const int val = 5; static int GG; }; int A::GG = 6; int main() { cout \u0026lt;\u0026lt; A::val \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; A::GG \u0026lt;\u0026lt; endl; return 0; }   5 6   C++æ”¯æŒé‡è½½ï¼ŒCä¸æ”¯æŒé‡è½½\nğŸ“¤ extern \u0026ldquo;C\u0026quot;ä½œç”¨ extern \u0026ldquo;C\u0026quot;çš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¸ºäº†èƒ½å¤Ÿæ­£ç¡®å®ç°C++ä»£ç è°ƒç”¨å…¶ä»–Cè¯­è¨€ä»£ç ã€‚åŠ ä¸Šextern \u0026ldquo;C\u0026quot;åï¼Œä¼šæŒ‡ç¤ºç¼–è¯‘å™¨è¿™éƒ¨åˆ†ä»£ç æŒ‰Cè¯­è¨€ï¼ˆè€Œä¸æ˜¯C++ï¼‰çš„æ–¹å¼è¿›è¡Œç¼–è¯‘ã€‚ç”±äºC++æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘å™¨ç¼–è¯‘å‡½æ•°çš„è¿‡ç¨‹ä¸­ä¼šå°†å‡½æ•°çš„å‚æ•°ç±»å‹ä¹ŸåŠ åˆ°ç¼–è¯‘åçš„ä»£ç ä¸­ï¼Œè€Œä¸ä»…ä»…æ˜¯å‡½æ•°åï¼›è€ŒCè¯­è¨€å¹¶ä¸æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘Cè¯­è¨€ä»£ç çš„å‡½æ•°æ—¶ä¸ä¼šå¸¦ä¸Šå‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œä¸€èˆ¬åªåŒ…æ‹¬å‡½æ•°åã€‚\nè¿™ä¸ªåŠŸèƒ½ååˆ†æœ‰ç”¨å¤„ï¼Œå› ä¸ºåœ¨C++å‡ºç°ä»¥å‰ï¼Œå¾ˆå¤šä»£ç éƒ½æ˜¯Cè¯­è¨€å†™çš„ï¼Œè€Œä¸”å¾ˆåº•å±‚çš„åº“ä¹Ÿæ˜¯Cè¯­è¨€å†™çš„ï¼Œä¸ºäº†æ›´å¥½çš„æ”¯æŒåŸæ¥çš„Cä»£ç å’Œå·²ç»å†™å¥½çš„Cè¯­è¨€åº“ï¼Œéœ€è¦åœ¨C++ä¸­å°½å¯èƒ½çš„æ”¯æŒCï¼Œè€Œextern \u0026ldquo;C\u0026quot;å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªç­–ç•¥ã€‚\n å¦‚æœC++è°ƒç”¨ä¸€ä¸ªCè¯­è¨€ç¼–å†™çš„.DLLæ—¶ï¼Œå½“åŒ…æ‹¬.DLLçš„å¤´æ–‡ä»¶æˆ–å£°æ˜æ¥å£å‡½æ•°æ—¶ï¼Œåº”åŠ extern \u0026ldquo;C\u0026rdquo; {ã€€}ã€‚  ğŸ“Œinlineå†…è”å‡½æ•° staticé™æ€å‡½æ•° æ™®é€šå‡½æ•°åŒºåˆ« é¢è¯•æ—¶å€™ä¸€èˆ¬åªä¼šé—®ä½ åŒºåˆ«ï¼Œæ‰€æœ‰æœ¬æ–‡åªè¯´åŒºåˆ«ã€‚\nå†…è”å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«ï¼š\nå†…è”å‡½æ•°å’Œæ™®é€šå‡½æ•°æœ€å¤§çš„åŒºåˆ«åœ¨äºå†…éƒ¨çš„å®ç°æ–¹é¢ï¼Œå½“æ™®é€šå‡½æ•°åœ¨è¢«è°ƒç”¨æ—¶ï¼Œç³»ç»Ÿé¦–å…ˆè·³è·ƒåˆ°è¯¥å‡½æ•°çš„å…¥å£åœ°å€ï¼Œæ‰§è¡Œå‡½æ•°ä½“ï¼Œæ‰§è¡Œå®Œæˆåï¼Œå†è¿”å›åˆ°å‡½æ•°è°ƒç”¨çš„åœ°æ–¹ï¼Œå‡½æ•°å§‹ç»ˆåªæœ‰ä¸€ä¸ªæ‹·è´ï¼› è€Œå†…è”å‡½æ•°åˆ™ä¸éœ€è¦è¿›è¡Œä¸€ä¸ªå¯»å€çš„è¿‡ç¨‹ï¼Œå½“æ‰§è¡Œåˆ°å†…è”å‡½æ•°æ—¶ï¼Œæ­¤å‡½æ•°å±•å¼€ï¼ˆå¾ˆç±»ä¼¼å®çš„ä½¿ç”¨ï¼‰ï¼Œå¦‚æœåœ¨ Nå¤„è°ƒç”¨äº†æ­¤å†…è”å‡½æ•°ï¼Œåˆ™æ­¤å‡½æ•°å°±ä¼šæœ‰Nä¸ªä»£ç æ®µçš„æ‹·è´ã€‚\né™æ€å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«ï¼š\nstaticå‡½æ•°å’Œæ™®é€šå‡½æ•°çš„æœ€å¤§çš„åŒºåˆ«åœ¨äºä½œç”¨åŸŸæ–¹é¢ï¼Œstaticå‡½æ•°é™å®šåœ¨æœ¬æºç æ–‡ä»¶ä¸­ï¼Œä¸èƒ½è¢«æœ¬æºç æ–‡ä»¶ä»¥å¤–çš„ä»£ç æ–‡ä»¶è°ƒç”¨ã€‚è€Œæ™®é€šçš„å‡½æ•°ï¼Œé»˜è®¤æ˜¯externçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥è¢«å…¶å®ƒä»£ç æ–‡ä»¶è°ƒç”¨è¯¥å‡½æ•°ã€‚åŒæ—¶staticå‡½æ•°åœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä»½ï¼Œæ™®é€šå‡½æ•°åœ¨æ¯ä¸ªè¢«è°ƒç”¨ä¸­ç»´æŒä¸€ä»½æ‹·è´ã€‚\ninlineä¸defineçš„åŒºåˆ«ï¼š\nå†…è”å‡½æ•°å’Œå®çš„åŒºåˆ«åœ¨äºï¼Œå®æ˜¯ç”±é¢„å¤„ç†å™¨å¯¹å®è¿›è¡Œæ›¿ä»£ï¼Œè€Œå†…è”å‡½æ•°æ˜¯é€šè¿‡ç¼–è¯‘å™¨æ§åˆ¶æ¥å®ç°çš„ã€‚è€Œä¸”å†…è”å‡½æ•°æ˜¯çœŸæ­£çš„å‡½æ•°ï¼Œåªæ˜¯åœ¨éœ€è¦ç”¨åˆ°çš„æ—¶å€™ï¼Œå†…è”å‡½æ•°åƒå®ä¸€æ ·çš„å±•å¼€ï¼Œæ‰€ä»¥å–æ¶ˆäº†å‡½æ•°çš„å‚æ•°å‹æ ˆï¼Œå‡å°‘äº†è°ƒç”¨çš„å¼€é”€ã€‚ä½ å¯ä»¥è±¡è°ƒç”¨å‡½æ•°ä¸€æ ·æ¥è°ƒç”¨å†…è”å‡½æ•°ï¼Œè€Œä¸å¿…æ‹…å¿ƒä¼šäº§ç”Ÿäºå¤„ç†å®çš„ä¸€äº›é—®é¢˜ã€‚å†…è”å‡½æ•°ä¸å¸¦å‚æ•°çš„å®å®šä¹‰è¿›è¡Œä¸‹æ¯”è¾ƒï¼Œå®ƒä»¬çš„ä»£ç æ•ˆç‡æ˜¯ä¸€æ ·ï¼Œä½†æ˜¯å†…è”æ¬¢å‡½æ•°è¦ä¼˜äºå®å®šä¹‰ï¼Œå› ä¸ºå†…è”å‡½æ•°éµå¾ªçš„ç±»å‹å’Œä½œç”¨åŸŸè§„åˆ™ï¼Œå®ƒä¸ä¸€èˆ¬å‡½æ•°æ›´ç›¸è¿‘ï¼Œåœ¨ä¸€äº›ç¼–è¯‘å™¨ä¸­ï¼Œä¸€æ—¦å…³ä¸Šå†…è”æ‰©å±•ï¼Œå°†ä¸ä¸€èˆ¬å‡½æ•°ä¸€æ ·è¿›è¡Œè°ƒç”¨ï¼Œæ¯”è¾ƒæ–¹ä¾¿ã€‚\ninlineä½¿ç”¨ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  // å£°æ˜1ï¼ˆåŠ  inlineï¼Œå»ºè®®ä½¿ç”¨ï¼‰ inline int functionName(int first, int second,...); // å£°æ˜2ï¼ˆä¸åŠ  inlineï¼‰ int functionName(int first, int second,...); // å®šä¹‰ inline int functionName(int first, int second,...) {/****/}; // ç±»å†…å®šä¹‰ï¼Œéšå¼å†…è” class A { int doA() { return 0; } // éšå¼å†…è” } // ç±»å¤–å®šä¹‰ï¼Œéœ€è¦æ˜¾å¼å†…è” class A { int doA(); } inline int A::doA() { return 0; } // éœ€è¦æ˜¾å¼å†…è”   ä¼˜ç¼ºç‚¹ï¼š\nä¼˜ç‚¹\n å†…è”å‡½æ•°åŒå®å‡½æ•°ä¸€æ ·å°†åœ¨è¢«è°ƒç”¨å¤„è¿›è¡Œä»£ç å±•å¼€ï¼Œçœå»äº†å‚æ•°å‹æ ˆã€æ ˆå¸§å¼€è¾Ÿä¸å›æ”¶ï¼Œç»“æœè¿”å›ç­‰ï¼Œä»è€Œæé«˜ç¨‹åºè¿è¡Œé€Ÿåº¦ã€‚ å†…è”å‡½æ•°ç›¸æ¯”å®å‡½æ•°æ¥è¯´ï¼Œåœ¨ä»£ç å±•å¼€æ—¶ï¼Œä¼šåšå®‰å…¨æ£€æŸ¥æˆ–è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆåŒæ™®é€šå‡½æ•°ï¼‰ï¼Œè€Œå®å®šä¹‰åˆ™ä¸ä¼šã€‚ åœ¨ç±»ä¸­å£°æ˜åŒæ—¶å®šä¹‰çš„æˆå‘˜å‡½æ•°ï¼Œè‡ªåŠ¨è½¬åŒ–ä¸ºå†…è”å‡½æ•°ï¼Œå› æ­¤å†…è”å‡½æ•°å¯ä»¥è®¿é—®ç±»çš„æˆå‘˜å˜é‡ï¼Œå®å®šä¹‰åˆ™ä¸èƒ½ã€‚ å†…è”å‡½æ•°åœ¨è¿è¡Œæ—¶å¯è°ƒè¯•ï¼Œè€Œå®å®šä¹‰ä¸å¯ä»¥ã€‚  ç¼ºç‚¹\n ä»£ç è†¨èƒ€ã€‚å†…è”æ˜¯ä»¥ä»£ç è†¨èƒ€ï¼ˆå¤åˆ¶ï¼‰ä¸ºä»£ä»·ï¼Œæ¶ˆé™¤å‡½æ•°è°ƒç”¨å¸¦æ¥çš„å¼€é”€ã€‚å¦‚æœæ‰§è¡Œå‡½æ•°ä½“å†…ä»£ç çš„æ—¶é—´ï¼Œç›¸æ¯”äºå‡½æ•°è°ƒç”¨çš„å¼€é”€è¾ƒå¤§ï¼Œé‚£ä¹ˆæ•ˆç‡çš„æ”¶è·ä¼šå¾ˆå°‘ã€‚å¦ä¸€æ–¹é¢ï¼Œæ¯ä¸€å¤„å†…è”å‡½æ•°çš„è°ƒç”¨éƒ½è¦å¤åˆ¶ä»£ç ï¼Œå°†ä½¿ç¨‹åºçš„æ€»ä»£ç é‡å¢å¤§ï¼Œæ¶ˆè€—æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚ inline å‡½æ•°æ— æ³•éšç€å‡½æ•°åº“å‡çº§è€Œå‡çº§ã€‚inlineå‡½æ•°çš„æ”¹å˜éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œä¸åƒ non-inline å¯ä»¥ç›´æ¥é“¾æ¥ã€‚ æ˜¯å¦å†…è”ï¼Œç¨‹åºå‘˜ä¸å¯æ§ã€‚å†…è”å‡½æ•°åªæ˜¯å¯¹ç¼–è¯‘å™¨çš„å»ºè®®ï¼Œæ˜¯å¦å¯¹å‡½æ•°å†…è”ï¼Œå†³å®šæƒåœ¨äºç¼–è¯‘å™¨ã€‚  å‚è€ƒï¼š\n inlineå†…è”å‡½æ•° staticé™æ€å‡½æ•° æ™®é€šå‡½æ•°åŒºåˆ« C++ inlineå’Œ#defineå®çš„åŒºåˆ«  ğŸ’ŸC++å†…å­˜å¸ƒå±€   å†…æ ¸ç©ºé—´\n  æ ˆ\n1ã€stackå­˜æ”¾å‡½æ•°çš„ä¸´æ—¶å˜é‡ã€å±€éƒ¨å˜é‡ã€å‡½æ•°å‚æ•°å’Œè¿”å›å€¼\n2ã€ç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾ã€‚\n  åŠ¨æ€é“¾æ¥åº“(å…±äº«æ˜ å°„åŒº)\nè°ƒç”¨çš„åº“æ–‡ä»¶ï¼Œä½äºå †å’Œæ ˆä¹‹é—´\n  å †\nheapç”¨æ¥åŠ¨æ€åˆ†é…å†…å­˜ï¼Œç”±ç¨‹åºå‘˜æ§åˆ¶ï¼Œäº¤ç”±ç¨‹åºè‡ªèº«å†³å®šå¼€è¾Ÿå’Œé‡Šæ”¾ã€‚\n  å…¨å±€æ•°æ®åŒº\n.bss\nbssæ®µç”¨æ¥å­˜æ”¾æ²¡æœ‰è¢«åˆå§‹åŒ–å’Œå·²ç»è¢«åˆå§‹åŒ–ä¸º0çš„å…¨å±€å˜é‡\n.data\ndataæ®µç”¨æ¥å­˜æ”¾å·²ç»è¢«åˆå§‹åŒ–ä¸ºé0çš„å…¨å±€å˜é‡\n  å¸¸é‡åŒº\n.rodata\nrodataæ®µç”¨æ¥å­˜æ”¾å¸¸é‡æ•°æ®ã€è¢«ç¼–è¯‘å™¨è‡ªåŠ¨å­˜æ”¾æ¥çš„å­—ç¬¦ä¸²å’ŒåŠ constå…³é”®å­—çš„å¸¸é‡æ•°æ®ã€‚\n  ä»£ç åŒº\n.text\ntextæ®µç”¨æ¥å­˜æ”¾ä»£ç å’Œéƒ¨åˆ†æ•´æ•°å¸¸é‡ï¼Œè¯¥æ®µæ˜¯å¯æ‰§è¡Œçš„ã€‚\n  ğŸ’± C++ç©ºç±»äº§ç”Ÿå“ªäº›æˆå‘˜å‡½æ•° æ„é€ ã€æ‹·è´æ„é€ ã€èµ‹å€¼ã€ææ„ã€å–åœ°å€ã€å–åœ°å€constï¼Œ\nC++ ç©ºç±»é»˜è®¤äº§ç”Ÿçš„ç±»æˆå‘˜å‡½æ•°\nâœˆ æŒ‡é’ˆå¸¸è§é”™è¯¯ é¢è¯•é¢˜Getmemory\nğŸš™ Cçš„å†…å­˜ç»“æ„ Cè¯­è¨€å†…å­˜å¸ƒå±€\nğŸ—¡ç¨‹åºè¿è¡Œæ—¶å†…å­˜åˆ†é… å˜é‡å’Œå‡½æ•°å ç”¨çš„å†…å­˜æ˜¯ç³»ç»Ÿåœ¨ç¨‹åºè¿è¡Œæ—¶ä¸ºç¨‹åºåˆ†é…çš„ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„å˜é‡å’Œå‡½æ•°éƒ½è¢«åˆ†é…åœ¨åŒä¸€å—å†…å­˜åŒºåŸŸä¸­ã€‚å¯¹äºä¸€ä¸ªC++ç¨‹åºæ¥è¯´ï¼Œç³»ç»Ÿä¸€èˆ¬é‡‡ç”¨3ç§æ–¹å¼ä¸ºç¨‹åºåˆ†é…å†…å­˜ï¼Œä¸‹é¢å°†åˆ†åˆ«ä»‹ç»è¿™3ç§æ–¹å¼ã€‚\n  ä»é™æ€å­˜å‚¨åŒºåŸŸåˆ†é…\n**è¿™éƒ¨åˆ†å†…å­˜åœ¨ç¨‹åºç¼–è¯‘çš„æ—¶å€™å°±å·²ç»åˆ†é…å¥½ï¼Œå¹¶ä¸”è¿™å—å†…å­˜åœ¨ç¨‹åºçš„æ•´ä¸ªè¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ã€‚ä¾‹å¦‚åœ¨å‡½æ•°å¤–å®šä¹‰çš„å…¨å±€å˜é‡ï¼Œä»¥åŠåœ¨åˆ›å»ºæ—¶ä½¿ç”¨staticä¿®é¥°ç¬¦çš„å˜é‡ã€‚**åœ¨è¯¥åŒºåŸŸå­˜å‚¨çš„å†…å®¹ä¸€èˆ¬æ˜¯å…¨å±€å˜é‡ï¼Œå…¶ä¸­å­˜å‚¨åœ¨æ•°æ®æ®µä¸­çš„å…¨å±€å˜é‡é€šå¸¸å·²ç»è¢«åˆå§‹åŒ–ã€‚\n  åœ¨æ ˆä¸Šè¿›è¡Œå†…å­˜åˆ†é…\nè¿™éƒ¨åˆ†åŒºåŸŸè¢«ç§°ä¸ºå †æ ˆï¼Œä½†è¿™åªæ˜¯ä¸€ç§ä¹ æƒ¯æ€§è¯´æ³•ï¼Œå¹¶ä¸æ˜¯å †å’Œæ ˆçš„ç»Ÿç§°ã€‚è¯¥éƒ¨åˆ†å­˜å‚¨çš„å˜é‡ä¸€èˆ¬æ˜¯åœ¨å‡½æ•°ä½“ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡ï¼ˆä¸åŒ…æ‹¬staticå£°æ˜çš„å˜é‡ï¼Œstaticæ„å‘³ç€å˜é‡å­˜æ”¾åœ¨æ•°æ®æ®µä¸­ï¼‰ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œç»å¸¸åœ¨æ ˆåŒºå‡ºç°çš„è¿˜æœ‰ä¼ é€’ç»™å‡½æ•°çš„å‚æ•°å’Œå‡½æ•°çš„è¿”å›å€¼ç­‰ã€‚æ ˆåŒºå˜é‡çš„ç”Ÿå­˜å‘¨æœŸæ˜¯åœ¨å…¥æ ˆå‰ï¼ˆå‡½æ•°å¼€å§‹è¢«è°ƒç”¨ï¼‰è·å¾—å†…å­˜ç©ºé—´ï¼Œè€Œåœ¨å‡ºæ ˆæ—¶ï¼ˆå‡½æ•°ç»“æŸè°ƒç”¨ï¼‰é‡Šæ”¾å†…å­˜ç©ºé—´ã€‚å› æ­¤å°½é‡ä¸è¦å°†å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ï¼Œå› ä¸ºåœ¨å‡½æ•°è°ƒç”¨ç»“æŸåï¼Œå±€éƒ¨å˜é‡å°±ä¸å­˜åœ¨äº†ï¼Œå†ä½¿ç”¨æ­¤å˜é‡çš„å€¼ä½œä¸ºè¿”å›å€¼ï¼Œä¼šä½¿ç¨‹åºè·å–çš„è¿”å›å€¼æœ‰å¯èƒ½ä¸ºéšæœºæ•°ã€‚åœ¨æ‰§è¡Œå‡½æ•°æ—¶ï¼Œå‡½æ•°ä½“å†…çš„å±€éƒ¨å˜é‡åœ¨æ ˆä¸Šè¢«è‡ªåŠ¨åˆ›å»ºï¼Œè€Œåœ¨å‡½æ•°æ‰§è¡Œç»“æŸæ—¶ï¼Œè¿™äº›å­˜å‚¨å•å…ƒè‡ªåŠ¨è¢«é‡Šæ”¾ã€‚æ ˆå†…å­˜åˆ†é…ç”±æ“ä½œç³»ç»Ÿå®Œæˆè€Œä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨å‚ä¸ã€‚å› æ­¤å…¶æ‰§è¡Œæ•ˆç‡éå¸¸é«˜ã€‚ä½†æ˜¯æ•´ä¸ªæ ˆåŒºå¯ä»¥è¢«åˆ†é…çš„å†…å­˜å®¹é‡æœ‰é™ã€‚å› æ­¤å®šä¹‰è¿‡å¤šçš„æœªä½¿ç”¨çš„å±€éƒ¨å˜é‡ä¼šä½¿ç¨‹åºæ‰§è¡Œå˜æ…¢ã€‚\n  ä»å †ä¸Šåˆ†é…\né€šå¸¸ç§°ä¸ºåŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œè¯¥éƒ¨åˆ†å†…å­˜åŒºåŸŸçš„å¤§å°å¹¶ä¸å›ºå®šï¼Œå½“ç¨‹åºè¿è¡Œæ—¶æœ‰ç¨‹åºå‘˜ç”¨ malloc() å‡½æ•°ç­‰å†…å­˜åˆ†é…å‡½æ•°æ¥åˆ†é…ï¼Œæˆ–ä½¿ç”¨ new æ“ä½œç¬¦ç­‰ç³»ç»Ÿæä¾›çš„å‡½æ•°æ¥åˆ†é…ã€‚è¯¥å†…å­˜çš„å¤§å°å¯ä»¥æ ¹æ®ç¨‹åºä¸­çš„å®é™…éœ€è¦æ¥æŒ‡å®šã€‚è¯¥éƒ¨åˆ†å†…å­˜ç©ºé—´ä¸ä¼šéšç€å‡½æ•°è¿è¡Œçš„ç»“æŸè€Œè¢«è‡ªåŠ¨å›æ”¶ï¼Œä¹Ÿä¸ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾ï¼Œéœ€è¦ç¨‹åºå‘˜è‡ªå·±ç”¨ free() å‡½æ•°æˆ– delete æ“ä½œç¬¦è¿›è¡Œå†…å­˜çš„å›æ”¶ã€‚åŠ¨æ€å†…å­˜çš„ç”Ÿå­˜æœŸç”±ç¨‹åºå‘˜è‡ªè¡Œå†³å®šï¼Œä½†å¦‚æœåˆ†é…äº†ç©ºé—´ï¼Œå°±å¿…é¡»å¯¹å…¶å›æ”¶ï¼Œå¦åˆ™è¿è¡Œçš„ç¨‹åºä¼šå‡ºç°å†…å­˜æ³„æ¼ï¼Œå¹¶ä¸”é¢‘ç¹åœ°åˆ†é…å’Œé‡Šæ”¾ä¸åŒå¤§å°çš„å †ç©ºé—´å°†ä¼šäº§ç”Ÿå †å†…ç¢å—ï¼Œé—´æ¥é™ä½å†…å­˜ç©ºé—´çš„ä½¿ç”¨ç‡ï¼Œä¸¥é‡æ—¶ä¼šäº§ç”Ÿå¤§é‡å†…å­˜ç¢ç‰‡ã€‚\n  ã€€ï¼ˆå†…å­˜ç¢ç‰‡æ˜¯ä¸€äº›åˆ†æ•£çš„å†…å­˜åŒºåŸŸï¼Œå¤§é‡å†…å­˜ç¢ç‰‡çš„å­˜åœ¨ä¼šé™ä½å†…å­˜çš„ä½¿ç”¨ç‡ã€‚ï¼‰\nğŸ‘½structå­—èŠ‚å¯¹é½é—®é¢˜ 1 2 3 4 5 6 7  typedef struct { char c1; short s; char c2; int i; } T_FOO;   ä¸Šé¢çš„ç»“æ„ä½“ä½¿ç”¨sizeofè¾“å‡ºå¤§å°ä¸º12ã€‚ï¼ˆå‡è®¾è¿™ä¸ªç»“æ„ä½“çš„æˆå‘˜åœ¨å†…å­˜ä¸­æ˜¯ç´§å‡‘æ’åˆ—çš„ï¼Œä¸”c1çš„èµ·å§‹åœ°å€æ˜¯0ï¼Œåˆ™sçš„åœ°å€å°±æ˜¯1ï¼Œc2çš„åœ°å€æ˜¯3ï¼Œiçš„åœ°å€æ˜¯4ï¼‰\nå­—èŠ‚å¯¹é½\nç°ä»£è®¡ç®—æœºä¸­ï¼Œå†…å­˜ç©ºé—´æŒ‰ç…§å­—èŠ‚åˆ’åˆ†ï¼Œç†è®ºä¸Šå¯ä»¥ä»ä»»ä½•èµ·å§‹åœ°å€è®¿é—®ä»»æ„ç±»å‹çš„å˜é‡ã€‚ä½†å®é™…ä¸­åœ¨è®¿é—®ç‰¹å®šç±»å‹å˜é‡æ—¶ç»å¸¸åœ¨ç‰¹å®šçš„å†…å­˜åœ°å€è®¿é—®ï¼Œè¿™å°±éœ€è¦å„ç§ç±»å‹æ•°æ®æŒ‰ç…§ä¸€å®šçš„è§„åˆ™åœ¨ç©ºé—´ä¸Šæ’åˆ—ï¼Œè€Œä¸æ˜¯é¡ºåºä¸€ä¸ªæ¥ä¸€ä¸ªåœ°å­˜æ”¾ï¼Œè¿™å°±æ˜¯å¯¹é½ã€‚\nå¯¹é½çš„åŸå› å’Œä½œç”¨\n  ä¸åŒç¡¬ä»¶å¹³å°å¯¹å­˜å‚¨ç©ºé—´çš„å¤„ç†ä¸Šå­˜åœ¨å¾ˆå¤§çš„ä¸åŒã€‚æŸäº›å¹³å°å¯¹ç‰¹å®šç±»å‹çš„æ•°æ®åªèƒ½ä»ç‰¹å®šåœ°å€å¼€å§‹å­˜å–ï¼Œè€Œä¸å…è®¸å…¶åœ¨å†…å­˜ä¸­ä»»æ„å­˜æ”¾ã€‚ä¾‹å¦‚Motorola 68000 å¤„ç†å™¨ä¸å…è®¸16ä½çš„å­—å­˜æ”¾åœ¨å¥‡åœ°å€ï¼Œå¦åˆ™ä¼šè§¦å‘å¼‚å¸¸ï¼Œå› æ­¤åœ¨è¿™ç§æ¶æ„ä¸‹ç¼–ç¨‹å¿…é¡»ä¿è¯å­—èŠ‚å¯¹é½ã€‚\n  ä½†æœ€å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œå¦‚æœä¸æŒ‰ç…§å¹³å°è¦æ±‚å¯¹æ•°æ®å­˜æ”¾è¿›è¡Œå¯¹é½ï¼Œä¼šå¸¦æ¥å­˜å–æ•ˆç‡ä¸Šçš„æŸå¤±ã€‚æ¯”å¦‚32ä½çš„Intelå¤„ç†å™¨é€šè¿‡æ€»çº¿è®¿é—®(åŒ…æ‹¬è¯»å’Œå†™)å†…å­˜æ•°æ®ã€‚æ¯ä¸ªæ€»çº¿å‘¨æœŸä»å¶åœ°å€å¼€å§‹è®¿é—®32ä½å†…å­˜æ•°æ®ï¼Œå†…å­˜æ•°æ®ä»¥å­—èŠ‚ä¸ºå•ä½å­˜æ”¾ã€‚å¦‚æœä¸€ä¸ª32ä½çš„æ•°æ®æ²¡æœ‰å­˜æ”¾åœ¨4å­—èŠ‚æ•´é™¤çš„å†…å­˜åœ°å€å¤„ï¼Œé‚£ä¹ˆå¤„ç†å™¨å°±éœ€è¦2ä¸ªæ€»çº¿å‘¨æœŸå¯¹å…¶è¿›è¡Œè®¿é—®ï¼Œæ˜¾ç„¶è®¿é—®æ•ˆç‡ä¸‹é™å¾ˆå¤šã€‚\nå› æ­¤ï¼Œé€šè¿‡åˆç†çš„å†…å­˜å¯¹é½å¯ä»¥æé«˜è®¿é—®æ•ˆç‡ã€‚ä¸ºä½¿CPUèƒ½å¤Ÿå¯¹æ•°æ®è¿›è¡Œå¿«é€Ÿè®¿é—®ï¼Œæ•°æ®çš„èµ·å§‹åœ°å€åº”å…·æœ‰â€œå¯¹é½â€ç‰¹æ€§ã€‚æ¯”å¦‚4å­—èŠ‚æ•°æ®çš„èµ·å§‹åœ°å€åº”ä½äº4å­—èŠ‚è¾¹ç•Œä¸Šï¼Œå³èµ·å§‹åœ°å€èƒ½å¤Ÿè¢«4æ•´é™¤\n  æ­¤å¤–ï¼Œåˆç†åˆ©ç”¨å­—èŠ‚å¯¹é½è¿˜å¯ä»¥æœ‰æ•ˆåœ°èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚ä½†è¦æ³¨æ„ï¼Œåœ¨32ä½æœºä¸­ä½¿ç”¨1å­—èŠ‚æˆ–2å­—èŠ‚å¯¹é½ï¼Œåè€Œä¼šé™ä½å˜é‡è®¿é—®é€Ÿåº¦ã€‚å› æ­¤éœ€è¦è€ƒè™‘å¤„ç†å™¨ç±»å‹ã€‚è¿˜åº”è€ƒè™‘ç¼–è¯‘å™¨çš„ç±»å‹ã€‚åœ¨VC/C++å’ŒGNU GCCä¸­éƒ½æ˜¯é»˜è®¤æ˜¯4å­—èŠ‚å¯¹é½ã€‚\n  å¯¹é½å‡†åˆ™\n  sizeofçš„æœ€ç»ˆç»“æœå¿…ç„¶æ˜¯ç»“æ„å†…éƒ¨æœ€å¤§æˆå‘˜çš„æ•´æ•°å€ï¼Œä¸å¤Ÿè¡¥é½ã€‚\n  ç»“æ„å†…éƒ¨å„ä¸ªæˆå‘˜çš„é¦–åœ°å€å¿…ç„¶æ˜¯è‡ªèº«å¤§å°çš„æ•´æ•°å€ã€‚\nå¦‚æœå®šä¹‰äº†#pragma pack(n)ï¼Œåˆ™ä¸Šè¿°ä¿©æ¡è§„åˆ™å¯å®šä¹‰ä¸ºï¼š\n1ã€æ•´ä¸ªsizeofçš„æœ€ç»ˆç»“æœå¿…ç„¶æ˜¯ min[n,ç»“æ„å†…éƒ¨æœ€å¤§æˆå‘˜] çš„æ•´æ•°å€ï¼Œä¸å¤Ÿè¡¥é½ã€‚\n2ã€ç»“æ„å†…éƒ¨å„ä¸ªæˆå‘˜çš„é¦–åœ°å€å¿…ç„¶æ˜¯min[n,è‡ªèº«å¤§å°]çš„æ•´æ•°å€ã€‚\n ç”±ä¸Šè¿°åŸåˆ™å¯çŸ¥ï¼Œåœ¨å†™ç»“æ„ä½“æ—¶ï¼Œæˆå‘˜å…ˆåä¸è¦éšæ„å†™å“¦ï¼Œåº”éµå¾ªä»å¤§åˆ°å°çš„åŸåˆ™ï¼Œè¿™æ ·æœ‰åŠ©äºèŠ‚çœç©ºé—´ã€‚\n   ä½¿ç”¨å››å­—èŠ‚å¯¹é½ï¼š\n1 2 3 4 5 6 7 8 9 10  #pragma pack(push)#pragma pack(4)typedef struct { char c1; short s; char c2; int i; } T_FOO; #pragma pack(pop)  å¯¹å…¶ä½¿ç”¨sizeofå¾—åˆ°çš„å¤§å°ä¸º12\nä¸ä½¿ç”¨å­—èŠ‚å¯¹é½ï¼Œå³ä½¿ç”¨1å­—èŠ‚å¯¹é½ï¼š\n1 2 3 4 5 6 7 8 9 10  #pragma pack(push)#pragma pack(1)typedef struct { char c1; short s; char c2; int i; } T_FOO; #pragma pack(pop)  å¤§å°ä¸º8\nå‚è€ƒï¼šCè¯­è¨€å­—èŠ‚å¯¹é½é—®é¢˜è¯¦è§£\nâ“œmallocä¸€æ¬¡æ€§æœ€å¤§èƒ½ç”³è¯·å¤šå¤§å†…å­˜ç©ºé—´ï¼Ÿ å…·ä½“æƒ…å†µåˆ†æ\nğŸ”¶å­—èŠ‚åºäº†è§£å—ï¼Ÿè®²ä¸€ä¸‹å¤§ç«¯å¯¹é½å’Œå°ç«¯å¯¹é½ ä¸»æœºå­—èŠ‚åºåˆå« CPU å­—èŠ‚åºï¼Œå…¶ä¸æ˜¯ç”±æ“ä½œç³»ç»Ÿå†³å®šçš„ï¼Œè€Œæ˜¯ç”± CPU æŒ‡ä»¤é›†æ¶æ„å†³å®šçš„ã€‚ä¸»æœºå­—èŠ‚åºåˆ†ä¸ºä¸¤ç§ï¼š\n å¤§ç«¯å­—èŠ‚åºï¼ˆBig Endianï¼‰ï¼šé«˜åºå­—èŠ‚å­˜å‚¨åœ¨ä½ä½åœ°å€ï¼Œä½åºå­—èŠ‚å­˜å‚¨åœ¨é«˜ä½åœ°å€ å°ç«¯å­—èŠ‚åºï¼ˆLittle Endianï¼‰ï¼šé«˜åºå­—èŠ‚å­˜å‚¨åœ¨é«˜ä½åœ°å€ï¼Œä½åºå­—èŠ‚å­˜å‚¨åœ¨ä½ä½åœ°å€  32 ä½æ•´æ•° 0x12345678 æ˜¯ä»èµ·å§‹ä½ç½®ä¸º 0x00 çš„åœ°å€å¼€å§‹å­˜æ”¾ï¼Œåˆ™ï¼š\n   å†…å­˜åœ°å€ 0x00 0x01 0x02 0x03     å¤§ç«¯ 12 34 56 78   å°ç«¯ 78 56 34 12    åˆ¤æ–­å¤§ç«¯å°ç«¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  #include \u0026lt;iostream\u0026gt;using namespace std; int main() { int i = 0x12345678; if (*((char*)\u0026amp;i) == 0x12) cout \u0026lt;\u0026lt; \u0026#34;å¤§ç«¯\u0026#34; \u0026lt;\u0026lt; endl; else cout \u0026lt;\u0026lt; \u0026#34;å°ç«¯\u0026#34; \u0026lt;\u0026lt; endl; return 0; }   ç½‘ç»œå­—èŠ‚é¡ºåºæ˜¯ TCP/IP ä¸­è§„å®šå¥½çš„ä¸€ç§æ•°æ®è¡¨ç¤ºæ ¼å¼ï¼Œå®ƒä¸å…·ä½“çš„ CPU ç±»å‹ã€æ“ä½œç³»ç»Ÿç­‰æ— å…³ï¼Œä»è€Œå¯ä»¥ä¿è¯æ•°æ®åœ¨ä¸åŒä¸»æœºä¹‹é—´ä¼ è¾“æ—¶èƒ½å¤Ÿè¢«æ­£ç¡®è§£é‡Šã€‚\nç½‘ç»œå­—èŠ‚é¡ºåºé‡‡ç”¨ï¼šå¤§ç«¯ï¼ˆBig Endianï¼‰æ’åˆ—æ–¹å¼ã€‚\nğŸ“å­—ç¬¦ä¸²ä¸å­—ç¬¦ä¸²æŒ‡é’ˆçš„å¤§å°  sizeof å¯¹æ•°ç»„ï¼Œå¾—åˆ°æ•´ä¸ªæ•°ç»„æ‰€å ç©ºé—´å¤§å°ã€‚ sizeof å¯¹æŒ‡é’ˆï¼Œå¾—åˆ°æŒ‡é’ˆæœ¬èº«æ‰€å ç©ºé—´å¤§å°ã€‚  å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9  char *a = \u0026#34;abcd\u0026#34;; cout \u0026lt;\u0026lt; \u0026#34;sizeof a = \u0026#34; \u0026lt;\u0026lt; sizeof(a) \u0026lt;\u0026lt; \u0026#34;\u0026#34; \u0026lt;\u0026lt; \u0026#34;strlen(a) = \u0026#34; \u0026lt;\u0026lt; strlen(a) \u0026lt;\u0026lt; endl; char b[] = \u0026#34;abcd\u0026#34;; cout \u0026lt;\u0026lt; \u0026#34;sizeof b = \u0026#34; \u0026lt;\u0026lt; sizeof(b) \u0026lt;\u0026lt; \u0026#34;\u0026#34; \u0026lt;\u0026lt; \u0026#34;strlen(b) = \u0026#34; \u0026lt;\u0026lt; strlen(b) \u0026lt;\u0026lt; endl; char c[10] = \u0026#34;abcd\u0026#34;; cout \u0026lt;\u0026lt; \u0026#34;sizeof c = \u0026#34; \u0026lt;\u0026lt; sizeof(c) \u0026lt;\u0026lt; \u0026#34;\u0026#34; \u0026lt;\u0026lt; \u0026#34;strlen(c) = \u0026#34; \u0026lt;\u0026lt; strlen(c) \u0026lt;\u0026lt; endl;   è¾“å‡ºä¸ºï¼š\nsizeof a = 8 strlen(a) = 4 sizeof b = 5 strlen(b) = 4 sizeof c = 10 strlen(c) = 4 strlen()çš„ç»“æœéƒ½ä¸€æ ·ï¼Œè¿”å›çš„æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦(ä¸è®¡\\0);ä½†æ˜¯sizeof()æ˜¯è¿”å›ç±»å‹çš„å¤§å°ï¼Œå‡å¦‚æ˜¯æŒ‡é’ˆï¼Œè¿”å›å½“å‰æ“ä½œç³»ç»Ÿåœ°å€æŒ‡é’ˆçš„å¤§å°ï¼›å‡å¦‚æ˜¯æ˜¾ç¤ºæ•°ç»„åˆå§‹åŒ–çš„æ•°ç»„ï¼Œå°±è¿”å›æ•°ç»„å®é™…å¤§å°çš„å­—èŠ‚æ•°ã€‚\nğŸ’ƒåŠ¨æ€é“¾æ¥å’Œé™æ€é“¾æ¥çš„åŒºåˆ« https://www.cnblogs.com/tracylee/archive/2012/10/15/2723816.html\né™æ€é“¾æ¥æ–¹å¼ï¼šåœ¨ç¨‹åºæ‰§è¡Œä¹‹å‰å®Œæˆæ‰€æœ‰çš„ç»„è£…å·¥ä½œï¼Œç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œçš„ç›®æ ‡æ–‡ä»¶ï¼ˆEXEæ–‡ä»¶ï¼‰ã€‚\nåŠ¨æ€é“¾æ¥æ–¹å¼ï¼šåœ¨ç¨‹åºå·²ç»ä¸ºäº†æ‰§è¡Œè¢«è£…å…¥å†…å­˜ä¹‹åå®Œæˆé“¾æ¥å·¥ä½œï¼Œå¹¶ä¸”åœ¨å†…å­˜ä¸­ä¸€èˆ¬åªä¿ç•™è¯¥ç¼–è¯‘å•å…ƒçš„ä¸€ä»½æ‹·è´ã€‚\nğŸ›©æ™ºèƒ½æŒ‡é’ˆçš„å¤šçº¿ç¨‹é—®é¢˜ ğŸª å…³äºtemplateçš„ä¸‰ä¸ªé—®é¢˜  templateçš„å£°æ˜ã€‚ å¦‚ä½•â€œå®ä¾‹åŒ–ï¼ˆinstantiatesï¼‰â€class objectã€inline nonmemberä»¥åŠ member templatefunctionsã€‚è¿™äº›æ˜¯â€œæ¯ä¸€ä¸ªç¼–è¯‘å•ä½éƒ½ä¼šæ‹¥æœ‰ä¸€ä»½å®ä¾‹â€çš„ä¸œè¥¿ã€‚ å¦‚ä½•â€œå®ä¾‹åŒ–ï¼ˆinstantiatesï¼‰â€nonmemberã€member template functionsä»¥åŠ static template class membersã€‚è¿™äº›éƒ½æ˜¯â€œæ¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­åªéœ€è¦ä¸€ä»½å®ä¾‹â€çš„ä¸œè¥¿ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸€èˆ¬è€Œè¨€ templateæ‰€å¸¦æ¥çš„é—®é¢˜ã€‚  ä»£ç æ ·ä¾‹ï¼š\né¦–å…ˆï¼Œå½“ç¼–è¯‘å™¨çœ‹åˆ°template class å£°æ˜æ—¶ï¼Œå®ƒä¼šåšå‡ºä»€ä¹ˆååº”ï¼Ÿåœ¨å®é™…ç¨‹åºä¸­ï¼Œä»€ä¹ˆååº”ä¹Ÿæ²¡æœ‰ï¼\né™æ€æˆå‘˜å˜é‡\nå¯¹äºæ¨¡æ¿ç±»é‡Œé¢çš„é™æ€æˆå‘˜å˜é‡ï¼Œå½“åˆå§‹åŒ–å®ƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢ä¸€æ¡è¯­å¥æ‰èƒ½ä½¿ç”¨ï¼š\n1  Point\u0026lt; float \u0026gt;::freeList;   ä¸èƒ½ä½¿ç”¨Point::freeList;ï¼Œæ­¤æ—¶ä¼šä½¿å…¶ä¸€ä»½å®ä¾‹ä¸ Point class çš„ float instantiationåœ¨ç¨‹åºä¸­äº§ç”Ÿå…³è”ã€‚\nå½“æˆ‘ä»¬å†è°ƒç”¨ä¸‹é¢çš„è¯­å¥æ—¶ï¼š\n1  Point\u0026lt; double \u0026gt;::freeList;   å°±ä¼šå‡ºç°ç¬¬äºŒä¸ªfreeListå®ä¾‹ï¼Œä¸Point classçš„double instantiationäº§ç”Ÿå…³è”ã€‚\nç±»å¯¹è±¡å®ä¾‹\næ‰€ä»¥ï¼Œä¸€ä¸ªclass object çš„å®šä¹‰ï¼Œä¸è®ºæ˜¯ç”±ç¼–è¯‘å™¨æš—ä¸­åœ°åšï¼ˆåƒç¨æ—©ç¨‹åºä»£ç ä¸­å‡ºç°è¿‡çš„temporaryï¼‰ï¼Œæˆ–æ˜¯ç”±ç¨‹åºå‘˜åƒä¸‹é¢è¿™æ ·æ˜¾å¼åœ°åšï¼š\n1  const Point\u0026lt; float \u0026gt; origin;   éƒ½ä¼šå¯¼è‡´template classçš„â€œå®ä¾‹åŒ–â€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œfloat instantiationçš„çœŸæ­£å¯¹è±¡å¸ƒå±€ä¼šè¢«äº§ç”Ÿå‡ºæ¥ã€‚\n å›é¡¾å…ˆå‰çš„ template å£°æ˜ï¼Œæˆ‘ä»¬çœ‹åˆ° Point æœ‰ä¸‰ä¸ª nonstatic membersï¼Œæ¯ä¸€ä¸ªçš„ç±»å‹éƒ½æ˜¯Typeã€‚Typeç°åœ¨è¢«ç»‘å®šä¸ºfloatï¼Œæ‰€ä»¥originçš„é…ç½®ç©ºé—´å¿…é¡»è¶³å¤Ÿå®¹çº³ä¸‰ä¸ªfloatæˆå‘˜ã€‚\n æˆå‘˜å‡½æ•°\nç„¶è€Œï¼Œmember functionsï¼ˆè‡³å°‘å¯¹äºé‚£äº›æœªè¢«ä½¿ç”¨è¿‡çš„ï¼‰ä¸åº”è¯¥è¢«â€œå®ä¾‹åŒ–â€ã€‚åªæœ‰åœ¨memberfunctionsè¢«ä½¿ç”¨çš„æ—¶å€™ï¼ŒC++Standardæ‰è¦æ±‚å®ƒä»¬è¢«â€œå®ä¾‹åŒ–â€ã€‚\nè¿™äº›å‡½æ•°åœ¨ä»€ä¹ˆæ—¶å€™â€œå®ä¾‹åŒ–â€ï¼Ÿç›®å‰æµè¡Œä¸¤ç§ç­–ç•¥ï¼š\n åœ¨ç¼–è¯‘çš„æ—¶å€™ã€‚é‚£ä¹ˆå‡½æ•°å°†â€œå®ä¾‹åŒ–â€äº originå’Œ på­˜åœ¨çš„é‚£ä¸ªæ–‡ä»¶ä¸­ã€‚ åœ¨é“¾æ¥çš„æ—¶å€™ã€‚é‚£ä¹ˆç¼–è¯‘å™¨ä¼šè¢«ä¸€äº›è¾…åŠ©å·¥å…·é‡æ–°æ¿€æ´»ã€‚template å‡½æ•°å®ä¾‹å¯èƒ½è¢«æ”¾åœ¨è¿™ä¸€æ–‡ä»¶ä¸­ã€åˆ«çš„æ–‡ä»¶ä¸­æˆ–ä¸€ä¸ªåˆ†ç¦»çš„å­˜å‚¨ä½ç½®ã€‚  æ¨¡æ¿é”™è¯¯æŠ¥å‘Šï¼š\ncfrontå¯¹templateçš„å¤„ç†æ˜¯å®Œå…¨è§£æï¼ˆparseï¼‰ä½†ä¸åšç±»å‹æ£€éªŒï¼›åªæœ‰åœ¨æ¯ä¸€ä¸ªå®ä¾‹åŒ–æ“ä½œï¼ˆinstantiationï¼‰å‘ç”Ÿæ—¶æ‰åšç±»å‹æ£€éªŒã€‚æ‰€ä»¥åœ¨ä¸€ä¸ªparsingç­–ç•¥ä¹‹ä¸‹ï¼Œæ‰€æœ‰è¯­æ±‡ï¼ˆlexingï¼‰é”™è¯¯å’Œè§£æï¼ˆparsingï¼‰é”™è¯¯éƒ½ä¼šåœ¨å¤„ç†templateå£°æ˜çš„è¿‡ç¨‹ä¸­è¢«æ ‡ç¤ºå‡ºæ¥ã€‚\nâ—c++çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ æ¬²æ”¯æŒexception handlingï¼Œç¼–è¯‘å™¨çš„ä¸»è¦å·¥ä½œå°±æ˜¯æ‰¾å‡ºcatchå­å¥ï¼Œä»¥å¤„ç†è¢«æŠ›å‡ºæ¥çš„exceptionã€‚\nä¸€èˆ¬è€Œè¨€ï¼Œexception handlingæœºåˆ¶éœ€è¦ä¸ç¼–è¯‘å™¨æ‰€äº§ç”Ÿçš„æ•°æ®ç»“æ„ä»¥åŠæ‰§è¡ŒæœŸçš„ä¸€ä¸ªexception libraryç´§å¯†åˆä½œã€‚åœ¨ç¨‹åºå¤§å°å’Œæ‰§è¡Œé€Ÿåº¦ä¹‹é—´ï¼Œç¼–è¯‘å™¨å¿…é¡»æœ‰æ‰€æŠ‰æ‹©ï¼š\n ä¸ºäº†ç»´æŠ¤æ‰§è¡Œé€Ÿåº¦ï¼Œç¼–è¯‘å™¨å¯ä»¥åœ¨ç¼–è¯‘æ—¶æœŸå»ºç«‹èµ·ç”¨äºæ”¯æŒçš„æ•°æ®ç»“æ„ã€‚è¿™ä¼šä½¿ç¨‹åºçš„å¤§å°å‘ç”Ÿè†¨èƒ€ï¼Œä½†ç¼–è¯‘å™¨å¯ä»¥å‡ ä¹å¿½ç•¥è¿™äº›ç»“æ„ï¼Œç›´åˆ°æœ‰ä¸ª exceptionè¢«æŠ›å‡ºæ¥ã€‚ ä¸ºäº†ç»´æŠ¤ç¨‹åºå¤§å°ï¼Œç¼–è¯‘å™¨å¯ä»¥åœ¨æ‰§è¡ŒæœŸå»ºç«‹èµ·ç”¨äºæ”¯æŒçš„æ•°æ®ç»“æ„ã€‚è¿™ä¼šå½±å“ç¨‹åºçš„æ‰§è¡Œé€Ÿåº¦ï¼Œä½†æ„å‘³ç€ç¼–è¯‘å™¨åªæœ‰åœ¨å¿…è¦çš„æ—¶å€™æ‰å»ºç«‹é‚£äº›æ•°æ®ç»“æ„ï¼ˆå¹¶ä¸”å¯ä»¥æŠ›å¼ƒä¹‹ï¼‰ã€‚  C++çš„exception handlingç”±ä¸‰ä¸ªä¸»è¦çš„è¯­æ±‡ç»„ä»¶æ„æˆï¼š\n ä¸€ä¸ª throw å­å¥ã€‚å®ƒåœ¨ç¨‹åºæŸå¤„å‘å‡ºä¸€ä¸ª exceptionã€‚è¢«æŠ›å‡ºå»çš„exceptionå¯ä»¥æ˜¯å†…å»ºç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä½¿ç”¨è€…è‡ªå®šç±»å‹ã€‚ ä¸€ä¸ªæˆ–å¤šä¸ª catchå­å¥ã€‚æ¯ä¸€ä¸ª catchå­å¥éƒ½æ˜¯ä¸€ä¸ª exception handlerã€‚å®ƒç”¨æ¥è¡¨ç¤ºè¯´ï¼Œè¿™ä¸ªå­å¥å‡†å¤‡å¤„ç†æŸç§ç±»å‹çš„ exceptionï¼Œå¹¶ä¸”åœ¨å°é—­çš„å¤§æ‹¬å·åŒºæ®µä¸­æä¾›å®é™…çš„å¤„ç†ç¨‹åºã€‚ ä¸€ä¸ª tryåŒºæ®µã€‚å®ƒè¢«å›´ç»•ä»¥ä¸€ç³»åˆ—çš„å™è¿°å¥ï¼ˆstatementsï¼‰ï¼Œè¿™äº›å™è¿°å¥å¯èƒ½ä¼šå¼•å‘ catchå­å¥èµ·ä½œç”¨ã€‚  å½“ä¸€ä¸ªexception è¢«æŠ›å‡ºå»æ—¶ï¼Œæ§åˆ¶æƒä¼šä»å‡½æ•°è°ƒç”¨ä¸­è¢«é‡Šæ”¾å‡ºæ¥ï¼Œå¹¶å¯»æ‰¾ä¸€ä¸ªå»åˆçš„catchå­å¥ã€‚å¦‚æœéƒ½æ²¡æœ‰å»åˆè€…ï¼Œé‚£ä¹ˆé»˜è®¤çš„å¤„ç†ä¾‹ç¨‹terminateï¼ˆï¼‰ä¼šè¢«è°ƒç”¨ã€‚å½“æ§åˆ¶æƒè¢«æ”¾å¼ƒåï¼Œå †æ ˆä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¹Ÿå°±è¢«æ¨ç¦»ï¼ˆpopped upï¼‰ã€‚è¿™ä¸ªç¨‹åºç§°ä¸ºunwinding the stackã€‚åœ¨æ¯ä¸€ä¸ªå‡½æ•°è¢«æ¨ç¦»å †æ ˆä¹‹å‰ï¼Œå‡½æ•°çš„local class objectsçš„destructorä¼šè¢«è°ƒç”¨ã€‚\nğŸƒæ‰§è¡ŒæœŸç±»å‹è¯†åˆ«ï¼ˆRuntime Type Identificationï¼ŒRTTIï¼‰  ç±»å‹å®‰å…¨çš„å‘ä¸‹è½¬å‹ï¼Œä¸€ä¸ªå®‰å…¨çš„å‘ä¸‹è½¬å‹éœ€è¦åœ¨æ‰§è¡ŒæœŸå¯ä»¥å¯¹æŒ‡é’ˆè¿›è¡ŒæŸ¥è¯¢ï¼Œç¡®å®šå¯ä»¥æ­£ç¡®ä¸”å®‰å…¨çš„å‘ä¸‹è½¬å‹ã€‚å› ä¸ºéœ€è¦æ”¯æŒæŸ¥è¯¢ï¼Œåˆ™éœ€è¦åœ¨è½¬å‹æ—¶çš„ç©ºé—´å’Œæ‰§è¡Œæ—¶é—´ä¸Šçš„é¢å¤–è´Ÿæ‹…ã€‚é¢å¤–è´Ÿæ‹…æœ‰ï¼š  ã€€1) é¢å¤–ç©ºé—´ä»¥å­˜å‚¨ç±»å‹ä¿¡æ¯ï¼Œé€šå¸¸ä¸ºä¸€ä¸ªæŒ‡å‘æŸç±»å‹ä¿¡æ¯èŠ‚ç‚¹çš„æŒ‡é’ˆï¼›\nã€€2) é¢å¤–æ—¶é—´ä»¥å†³å®šæ‰§è¡ŒæœŸçš„ç±»å‹ã€‚\nã€€C++åˆ©ç”¨è™šè¡¨ï¼Œå°†ç±»ç›¸å…³çš„RTTIå¯¹è±¡åœ°å€(å³type_infoå¯¹è±¡åœ°å€)æ”¾åœ¨è™šè¡¨ä¸­(ä¸€èˆ¬ä¸ºç¬¬ä¸€ä¸ªslot)ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™è®¾å®švtprå’Œè™šè¡¨å³å¯ï¼Œå½“éœ€è¦å‘ä¸‹è½¬å‹æ—¶åˆ©ç”¨RTTIå†³å®šæ‰§è¡ŒæœŸç±»å‹ç­‰ä¿¡æ¯ã€‚\n ç±»å‹å®‰å…¨çš„åŠ¨æ€è½¬æ¢dynamic_castå¯ä»¥ç¡®ä¿è½¬åŒ–åˆé€‚çš„ç±»å‹å¯¹è±¡ï¼Œè‹¥å¤±è´¥åˆ™è¿”å›ç©ºæŒ‡é’ˆ(å½“è½¬åŒ–ä¸ºæŒ‡é’ˆç±»å‹æ—¶)æˆ–è€…æŠ›å‡ºå¼‚å¸¸(å½“è½¬åŒ–ä¸ºå¼•ç”¨ç±»å‹æ—¶)ã€‚dynamic_castçš„æˆæœ¬åœ¨äºè¿è¡ŒæœŸçš„ç±»å‹è¯†åˆ«åˆ¤æ–­ã€‚\n  ä½¿ç”¨typeidè¿ç®—ç¬¦è·å–å¯¹è±¡çš„ç±»å‹ï¼Œå³type_infoï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡typeidæ¥ç¡®å®šæ˜¯å¦æ»¡è¶³æŸä¸ªç±»å‹ï¼Œç„¶åè°ƒç”¨static_castè½¬åŒ–å³å¯ã€‚å³if(typeid(someObj) == typeid(someType) ) {someType \u0026amp;rf = static_cast\u0026lt;someType\u0026amp;\u0026gt;(someObj);}ã€‚æ­¤å¤–RTTIä¸ä»…å¯ç”¨äºå¤šæ€ç±»ï¼Œä¹Ÿå¯ä»¥ç”¨äºå†…ç½®ç±»å‹å’Œéå¤šæ€çš„ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ã€‚\n  ğŸš§C++æ„é€ å‡½æ•°  å››ç§æƒ…å†µï¼Œé€ æˆâ€œç¼–è¯‘å™¨ä¼šä¸ºæœªå£°æ˜çš„constructorçš„classesåˆæˆä¸€ä¸ªdefault constructor\n   å¸¦æœ‰Default Constructor çš„Member Class Object\nå¦‚æœä¸€ä¸ªclassæ²¡æœ‰ä»»ä½•constructorï¼Œä½†å®ƒå†…å«ä¸€ä¸ªmember objectï¼Œè€Œåè€… æœ‰default constructorï¼Œé‚£ä¹ˆè¿™ä¸ªclassçš„implicit default constructor å°±æ˜¯ â€œnontrivialâ€,ç¼–è¯‘å™¨éœ€è¦ä¸ºæ­¤classåˆæˆå‡ºä¸€ä¸ªdefault constructorã€‚ä¸è¿‡è¿™ä¸ª åˆæˆæ“ä½œåªæœ‰åœ¨constructorçœŸæ­£éœ€è¦è¢«è°ƒç”¨æ—¶æ‰ä¼šå‘ç”Ÿã€‚\nä¾‹å­ï¼šBarä¼šç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„æ„é€ å‡½æ•°\n æç¤ºï¼šè¢«åˆæˆçš„é»˜è®¤æ„é€ å‡½æ•°åªæ˜¯æ»¡è¶³ç¼–è¯‘å™¨çš„éœ€è¦ï¼Œè€Œä¸æ˜¯ç¨‹åºçš„éœ€è¦ã€‚\n   â€œå¸¦æœ‰ Default Constructorâ€çš„ Base Class\nå¦‚æœä¸€ä¸ªæ²¡æœ‰ä»»ä½•constructorsçš„classæ´¾ç”Ÿè‡ªä¸€ä¸ªâ€œå¸¦æœ‰default constructorâ€çš„base class,é‚£ä¹ˆè¿™ä¸ªderived classçš„default constructorä¼šè¢«è§†ä¸ºnontrivialï¼Œå¹¶å› æ­¤éœ€è¦è¢«åˆæˆå‡ºæ¥ã€‚å®ƒå°†è°ƒç”¨ä¸Šä¸€å±‚base classesçš„default constructor(æ ¹æ®å®ƒä»¬çš„å£°æ˜æ¬¡åºï¼‰ã€‚å¯¹ä¸€ä¸ªåç»§æ´¾ç”Ÿçš„classè€Œè¨€ï¼Œè¿™ä¸ªåˆæˆçš„constructorå’Œä¸€ä¸ªâ€œè¢«æ˜ç¡®æä¾›çš„default constructorâ€æ²¡æœ‰ä»€ä¹ˆå·®å¼‚ã€‚\n  â€œå¸¦æœ‰ä¸€ä¸ª Virtual Functionâ€çš„Class\næ„é€ å‡½æ•°çš„æ„å»ºä¸»è¦æ˜¯ä¸ºäº†åˆå§‹åŒ–æˆ–è€…æ›´æ–°è™šå‡½æ•°æŒ‡é’ˆ\nä¾‹å­\n  â€œå¸¦æœ‰ä¸€ä¸ªVirtual Base Classâ€çš„Class\nä¾‹å­ï¼š\n  åœ¨åˆæˆçš„default constructorä¸­ï¼Œåªæœ‰base class subobjectså’Œmember classobjectsä¼šè¢«åˆå§‹åŒ–ã€‚æ‰€æœ‰å…¶å®ƒçš„ nonstatic data memberï¼Œå¦‚æ•´æ•°ã€æ•´æ•°æŒ‡é’ˆã€æ•´æ•°æ•°ç»„ç­‰ç­‰éƒ½ä¸ä¼šè¢«åˆå§‹åŒ–ã€‚è¿™äº›åˆå§‹åŒ–æ“ä½œå¯¹ç¨‹åºè€Œè¨€æˆ–è®¸æœ‰éœ€è¦ï¼Œä½†å¯¹ç¼–è¯‘å™¨åˆ™å¹¶éå¿…è¦ã€‚å¦‚æœç¨‹åºéœ€è¦ä¸€ä¸ªâ€œæŠŠæŸæŒ‡é’ˆè®¾ä¸º0â€çš„default constructor,é‚£ä¹ˆæä¾›å®ƒçš„äººåº”è¯¥æ˜¯ç¨‹åºå‘˜ã€‚\nğŸ‘®C++æ‹·è´æ„é€ å‡½æ•° æœ‰ä¸‰ç§æƒ…å†µï¼Œä¼šä»¥ä¸€ä¸ªobjectçš„å†…å®¹ä½œä¸ºå¦ä¸€ä¸ªclass objectçš„åˆå€¼:\n  å¯¹ä¸€ä¸ªobjectåšæ˜ç¡®çš„åˆå§‹åŒ–æ“ä½œï¼Œåƒè¿™æ ·ï¼š\n1 2 3 4  class X{...}; X x; //æ˜ç¡®åœ°ä»¥ä¸€ä¸ªobjectçš„å†…å®¹ä½œä¸ºå¦ä¸€ä¸ªclass objectçš„åˆå€¼ X xx = x;     å½“object è¢«å½“ä½œå‚æ•°äº¤ç»™æŸä¸ªå‡½æ•°æ—¶,ä¾‹å¦‚ï¼š\n1 2 3 4 5 6  extern void foo(X x); void test(){ X xx; foo(xx);\t//ä»¥xxä½œä¸ºfooï¼ˆï¼‰ç¬¬ä¸€ä¸ªå‚æ•°çš„åˆå€¼ï¼ˆä¸æ˜æ˜¾çš„åˆå§‹åŒ–æ“ä½œï¼‰ }     å½“å‡½æ•°ä¼ å›ä¸€ä¸ªclass objectæ—¶ï¼Œä¾‹å¦‚ï¼š\n1 2 3 4  X foo_bar(){ X xx; return xx; }     Default Memberwise Initialization å¦‚æœå‡½æ•°å¹¶æ²¡æœ‰æä¾›ä¸€ä¸ªexplicit copy constructorï¼Œé‚£ä¹ˆå…¶æ‹·è´åŒç±»å‹å¯¹è±¡çš„æ“ä½œç”±default memberwise initializationå®Œæˆï¼Œå…¶æ‰§è¡Œç­–ç•¥ä¸ºï¼šå¯¹æ¯ä¸€ä¸ªå†…å»ºæˆ–æ´¾ç”Ÿçš„data memberçš„å€¼ï¼Œä»æŸä¸€ä¸ªobjectæ‹·è´åˆ°å¦ä¸€ä¸ªobjectã€‚ä¸è¿‡å®ƒä¸ä¼šæ‹·è´å…¶ä¸­çš„member class objectï¼Œè€Œæ˜¯å®æ–½é€’å½’å¼çš„memberwise initialization(å¯¹æ¯ä¸€ä¸ªå¯¹è±¡ä¾æ¬¡æ‰§è¡Œdefault memberwise initializationï¼‰ã€‚\n Default constructors å’Œ copy constructorsåœ¨å¿…è¦çš„æ—¶å€™æ‰ç”±ç¼–è¯‘å™¨äº§ç”Ÿå‡ºæ¥ã€‚\n Bitwise Copy Semantics(ä½é€æ¬¡æ‹·è´ï¼‰ çœ‹çœ‹ä¸‹é¢çš„ç¨‹åºæ®µï¼š\n1 2 3 4 5 6  #include\u0026#34;Word.h\u0026#34;Word noun(\u0026#34;book\u0026#34;); void foo() { Word verb = noun; //... }   æˆ‘ä»¬ä¸å¯èƒ½é¢„æµ‹è¿™ä¸ªåˆå§‹åŒ–æ“ä½œçš„ç¨‹åºè¡Œä¸ºã€‚å¦‚æœclass Wordçš„è®¾è®¡è€…å®šä¹‰äº†ä¸€ä¸ªcopy constructorï¼Œverbçš„åˆå§‹åŒ–æ“ä½œä¼šè°ƒç”¨å®ƒã€‚ä½†å¦‚æœè¯¥class æ²¡æœ‰å®šä¹‰explicit copy constructor,é‚£ä¹ˆæ˜¯å¦ä¼šæœ‰ä¸€ä¸ªç¼–è¯‘å™¨åˆæˆçš„å®ä½“è¢«è°ƒç”¨å‘¢ï¼Ÿè¿™å°±å¾—è§†è¯¥class æ˜¯å¦å±•ç°\u0026quot;bitwise copy semanticsâ€è€Œå®šã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œå·²çŸ¥ä¸‹é¢çš„class Word å£°æ˜ï¼š\n1 2 3 4 5 6 7 8 9  //ä»¥ä¸‹å£°æ˜å±•ç°äº†bitwise copy semantics class Word{ public: Word(const char*); ~Word(){ delete []str;} //.. private: int cnt; char *str; }ï¼›   è¿™ç§æƒ…å†µä¸‹å¹¶ä¸éœ€è¦åˆæˆå‡ºä¸€ä¸ªdefault copy constructorï¼Œå› ä¸ºä¸Šè¿°å£°æ˜å±•ç°äº†â€œdefault copy semanticsâ€ã€‚\nå†å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9  //ä»¥ä¸‹å£°æ˜å¹¶æœªå±•ç°å‡ºbitwise copy semantics class Word{ public: Word(const String\u0026amp;); ~Word(){ delete []str;} //.. private: int cnt; String str; }ï¼›   å…¶ä¸­Stringå£°æ˜äº†ä¸€ä¸ªæ˜¾ç¤ºçš„æ‹·è´æ„é€ å‡½æ•°\n1 2 3 4 5 6  class String{ public: String(const char*); ~String(); //... };   åœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨å¿…é¡»åˆæˆå‡ºä¸€ä¸ªcopy constructor ä»¥ä¾¿è°ƒç”¨member class String objectçš„ copy constructor:\nä»€ä¹ˆæ—¶å€™ä¸€ä¸ªclassä¸å±•ç°å‡ºâ€œbitwise copy semanticsâ€å‘¢?æœ‰å››ç§æƒ…å†µï¼š\n å½“classå†…å«ä¸€ä¸ªmember objectè€Œåè€…çš„classå£°æ˜æœ‰ä¸€ä¸ªcopy constructoræ—¶ï¼ˆä¸è®ºæ˜¯è¢«class è®¾è®¡è€…æ˜ç¡®åœ°å£°æ˜ï¼Œå°±åƒå‰é¢çš„Stringé‚£æ ·ï¼›æˆ–æ˜¯è¢«ç¼–è¯‘å™¨åˆæˆï¼Œåƒclass Wordé‚£æ ·ï¼‰ã€‚ å½“classç»§æ‰¿è‡ªä¸€ä¸ªbase classè€Œåè€…å­˜åœ¨æœ‰ä¸€ä¸ªcopy constructoræ—¶ï¼ˆå†æ¬¡å¼ºè°ƒï¼Œä¸è®ºæ˜¯è¢«æ˜ç¡®å£°æ˜æˆ–æ˜¯è¢«åˆæˆè€Œå¾—ï¼‰ã€‚ å½“classå£°æ˜äº†ä¸€ä¸ªæˆ–å¤šä¸ªvirtual functionsæ—¶ã€‚ å½“classæ´¾ç”Ÿè‡ªä¸€ä¸ªç»§æ‰¿ä¸²é“¾ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªvirtual base classesæ—¶ã€‚  å‰ä¸¤ç¥æƒ…å†µä¸­ï¼Œç¼–è¯‘å™¨å¿…é¡»å°†memberæˆ–base classçš„â€œcopy constructorsè°ƒç”¨æ“ä½œâ€å®‰æ’åˆ°è¢«åˆæˆçš„copy constructorä¸­ã€‚\nè™šå‡½æ•°æŒ‡é’ˆ\nç¼–è¯‘æ—¶æœŸæœ‰ä¸¤ä¸ªç¨‹åºçš„æ‰©å¼ æ“ä½œï¼š\nâ–  å¢åŠ ä¸€ä¸ªvirtual function tableï¼ˆvtbl)ï¼Œå†…å«æ¯ä¸€ä¸ªæœ‰ä½œç”¨çš„ virtual functionçš„åœ°å€ã€‚\nâ–  å°†ä¸€ä¸ªæŒ‡å‘virtual function tableçš„æŒ‡é’ˆï¼ˆvptr)ï¼Œå®‰æ’åœ¨æ¯ä¸€ä¸ªclass objectå†…ã€‚\nå¾ˆæ˜¾ç„¶ï¼Œå¦‚æœç¼–è¯‘å™¨å¯¹äºæ¯ä¸€ä¸ªæ–°äº§ç”Ÿçš„class objectçš„vpträ¸èƒ½æˆåŠŸè€Œæ­£ç¡®åœ°è®¾å¥½å…¶åˆå€¼ï¼Œå°†å¯¼è‡´å¯æ€•çš„åæœã€‚å› æ­¤ï¼Œå½“ç¼–è¯‘å™¨å¯¼å…¥ä¸€ä¸ªvptråˆ°classä¹‹ä¸­æ—¶ï¼Œè¯¥classå°±ä¸å†å±•ç°bitwise semanticsäº†ã€‚ç°åœ¨ï¼Œç¼–è¯‘å™¨éœ€è¦åˆæˆå‡ºä¸€ä¸ªcopy constructorï¼Œä»¥æ±‚å°†vptré€‚å½“åœ°åˆå§‹åŒ–ï¼Œä¸‹é¢æ˜¯ä¸ªä¾‹å­ã€‚\nä»¥ä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡ä½œä¸ºå…¶çˆ¶ç±»å¯¹è±¡çš„åˆå§‹å€¼ï¼Œç¼–è¯‘å™¨éœ€è¦**â€åˆ¤æ–­â€œ**\nç¨‹åºè½¬åŒ–è¯­ä¹‰ ä¸‹é¢çš„ç¨‹åºï¼š\n1 2 3 4 5 6 7  #include \u0026lt;iostream\u0026gt; X foo(){ X xx; // ... \treturn xx; }   å¯èƒ½ä¼šåšå‡ºä»¥ä¸‹å‡è®¾ï¼š\n æ¯æ¬¡foo0è¢«è°ƒç”¨ï¼Œå°±ä¼ å›xxçš„å€¼ã€‚ å¦‚æœclass Xå®šä¹‰äº†ä¸€ä¸ªcopy constructorï¼Œé‚£ä¹ˆå½“foo0è¢«è°ƒç”¨æ—¶ï¼Œä¿è¯è¯¥copy constructor ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚   ç¬¬ä¸€ä¸ªå‡è®¾çš„çœŸå®æ€§ï¼Œå¿…é¡»è§†class Xå¦‚ä½•å®šä¹‰è€Œå®šã€‚ç¬¬äºŒä¸ªå‡è®¾çš„çœŸå®æ€§ï¼Œè™½ç„¶ä¹Ÿæœ‰éƒ¨åˆ†å¿…é¡»è§†class Xå¦‚ä½•å®šä¹‰è€Œå®šï¼Œä½†æœ€ä¸»è¦è¿˜æ˜¯è§†ä½ çš„C++ç¼–è¯‘å™¨æ‰€æä¾›çš„è¿›å–æ€§ä¼˜åŒ–ç¨‹åº¦ï¼ˆdegree of aggressive optimization)è€Œå®šã€‚ä½ ç”šè‡³å¯ä»¥å‡è®¾åœ¨ä¸€ä¸ªé«˜å“è´¨çš„C++ç¼–è¯‘å™¨ä¸­ï¼Œä¸Šè¿°ä¸¤ç‚¹å¯¹äºclass Xçš„nontrivial definitionséƒ½ä¸æ­£ç¡®ã€‚\n æ˜¾å¼åˆå§‹åŒ–æ“ä½œ(Explicit Initialization)\nä¸‹é¢çš„ä¾‹å­æ˜¯ä¸‰ç§æ˜¾ç¤ºçš„æ‹·è´æ„é€ æ“ä½œï¼š\n1 2 3 4 5 6  void test() { X x0; X x1(x0); // ç¬¬ä¸€ç§æ˜¾ç¤ºæ‹·è´æ„é€   X x2 = x0; // ç¬¬äºŒç§æ˜¾ç¤ºæ‹·è´æ„é€   X x3 = X(x0); // ç¬¬ä¸‰ç§æ˜¾ç¤ºæ‹·è´æ„é€  }   ä¸Šé¢çš„ç¨‹åºè½¬åŒ–å¯èƒ½ä¼šæœ‰ä¸¤ä¸ªé˜¶æ®µï¼š\n é‡å†™æ¯ä¸€ä¸ªå®šä¹‰ï¼Œå…¶ä¸­çš„åˆå§‹åŒ–æ“ä½œä¼šè¢«å‰¥é™¤ã€‚ classçš„copy constructor è°ƒç”¨æ“ä½œä¼šè¢«å®‰æ’è¿›å»ã€‚  å¯èƒ½ä¼šå˜æˆä¸‹é¢è¿™æ ·\n1 2 3 4 5 6 7 8 9 10  void test_Cpp() { // ... x0çš„æ„é€ å‡½æ•°  // ä¸‰ä¸ªå£°æ˜  X x1,x2,x3; // ä¸‰ä¸ªå®šä¹‰  x1.X::X(x0); x2.X::X(x0); x3.X::X(x0); }   å‚æ•°çš„åˆå§‹åŒ–ï¼ˆArgument Initialization)\nC++æ ‡å‡†è¯´ï¼ŒæŠŠä¸€ä¸ªclass object å½“åšå‚æ•°ä¼ ç»™ä¸€ä¸ªå‡½æ•°ï¼Œç›¸å½“äºä¸€ä¸‹å½¢å¼çš„åˆå§‹åŒ–æ“ä½œï¼š\n(å®šä¹‰ä¸€ä¸ªç±»Xï¼Œä½œä¸ºtestå‡½æ•°çš„å‚æ•°)\n1 2  X xx; test(xx);   å…¶ä¸­testå‡½æ•°çš„å£°æ˜å¦‚ä¸‹ï¼š\n1  void test(X x0);   ä¸Šé¢çš„å‚æ•°xxè¿™ä¸ªå˜é‡ä½œä¸ºå‚æ•°ä¼ åˆ°å‡½æ•°testä¸­ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œå¹¶ä¸”ä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°å°†è¿™ä¸ªä¸´æ—¶å¯¹è±¡åˆå§‹åŒ–ï¼Œç»è¿‡è¿™äº›æ­¥éª¤è¿™ä¸ªå‚æ•°æ‰çœŸæ­£ä¼ å…¥å‡½æ•°ä¸­è¿›è¡Œä½¿ç”¨ã€‚\næ‰€ä»¥ä¸Šé¢çš„ä»£ç å¯èƒ½ä¼šè½¬æ¢ä¸ºï¼š\n1 2 3  X __temp;\t// ä¸´æ—¶å¯¹è±¡äº§ç”Ÿ __temp.X::X(xx);\t//ç¼–è¯‘å™¨å¯¹æ‹·è´æ„é€ å‡½æ•°çš„è°ƒç”¨ test(__temp);\t//é‡æ–°æ”¹å†™å‡½æ•°çš„è°ƒç”¨æ“ä½œ   ç„¶è€Œä¸Šé¢çš„åšæ³•åªå®Œæˆäº†ä¸€èˆ¬ï¼Œå› ä¸ºå‡½æ•°xxçš„å£°æ˜è¿˜æ˜¯ä¸€ä¸ªä¼ å€¼çš„å‚æ•°ï¼Œtestçš„å£°æ˜ä¹Ÿä¹Ÿé¡»è¢«è½¬åŒ–ï¼Œå½¢å¼å‚æ•°å¿…é¡»ä»åŸå…ˆçš„ä¸€ä¸ªclass X objectæ”¹å˜ä¸ºä¸€ä¸ªclass X reference,åƒè¿™æ ·ï¼š\n1  void test(X\u0026amp; x0)ï¼›   è¿”å›å€¼çš„åˆå§‹åŒ–ï¼ˆReturn Value Initialization)\nä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š\n1 2 3 4 5  X test() { X xx; return xx; }   ç¼–è¯‘å™¨å¯èƒ½ä¼šåšå¦‚ä¸‹NRVä¼˜åŒ–ï¼š\n1 2 3 4 5 6  X __result; void test(X\u0026amp; __result) { __result.X::X()ï¼› return; }   å½“ç±»æ˜¾ç¤ºBitwiseçš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ä¸å»å®šä¹‰ä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°ï¼Œä½¿ç”¨ç¼–è¯‘å™¨åˆæˆå°±éå¸¸é«˜æ•ˆå’Œå®‰å…¨ï¼\nDataè¯­ä¹‰å­¦\nğŸ’½C++â€”â€”dataè¯­ä¹‰ æ¯ä¸€ä¸ªclass object å› æ­¤å¿…é¡»æœ‰è¶³å¤Ÿçš„å¤§å°ä»¥å®¹çº³å®ƒæ‰€æœ‰çš„ nonstatic datamembersã€‚æœ‰æ—¶å€™å…¶å€¼å¯èƒ½ä»¤ä½ åƒæƒŠï¼ˆæ­£å¦‚é‚£ä½æ³•å›½æ¥ä¿¡è€…ï¼‰ï¼Œå› ä¸ºå®ƒå¯èƒ½æ¯”ä½ æƒ³è±¡çš„è¿˜å¤§ï¼ŒåŸå› æ˜¯ï¼š\n ç”±ç¼–è¯‘å™¨è‡ªåŠ¨åŠ ä¸Šçš„é¢å¤–data membersï¼Œç”¨ä»¥æ”¯æŒæŸäº›è¯­è¨€ç‰¹æ€§ï¼ˆä¸»è¦æ˜¯å„ç§virtualç‰¹æ€§ï¼‰. å› ä¸ºalignmentï¼ˆè¾¹ç•Œè°ƒæ•´ï¼‰çš„éœ€è¦ã€‚  Data Memberçš„ç»‘å®š\nçœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12  //æŸä¸ªfoo.hå¤´æ–‡ä»¶ï¼Œä»æŸå¤„å«å…¥ extern float x; //ç¨‹åºå‘˜çš„Point3d.hæ–‡ä»¶ class Point3d{ public: Point3d(float,float,float); //é—®é¢˜ï¼šè¢«ä¼ å›å’Œè¢«è®¾å®šçš„xæ˜¯å“ªä¸€ä¸ªxå‘¢  float X() const { return x;} void X( float new x) const{x=new_x;} //..â€¦ private: float x,y,z; };   å¦‚æœæˆ‘é—®ä½ Point3d::X()ä¼ å›å“ªä¸€ä¸ªxï¼Ÿæ˜¯classå†…éƒ¨çš„é‚£ä¸ªxï¼Œè¿˜æ˜¯å¤–éƒ¨ï¼ˆextern)çš„é‚£ä¸ªxï¼Ÿä»Šå¤©æ¯ä¸ªäººéƒ½ä¼šå›ç­”æˆ‘æ˜¯å†…éƒ¨é‚£ä¸€ä¸ªã€‚è¿™ä¸ªç­”æ¡ˆæ˜¯æ­£ç¡®çš„ï¼Œä½†å¹¶ä¸æ˜¯ä»è¿‡å»ä»¥æ¥ä¸€ç›´éƒ½æ­£ç¡®ï¼\næ—©æœŸC++çš„ä¸¤ç§é˜²å¾¡æ€§ç¨‹åºè®¾è®¡é£æ ¼ï¼š\n æŠŠæ‰€æœ‰çš„data membersæ”¾åœ¨classå£°æ˜èµ·å¤´å¤„ï¼Œä»¥ç¡®ä¿æ­£ç¡®çš„ç»‘å®šï¼š æŠŠæ‰€æœ‰çš„inline functionsï¼Œä¸ç®¡å¤§å°éƒ½æ”¾åœ¨classå£°æ˜ä¹‹å¤–ï¼š  è¿™ä¸ªè¯­è¨€è§„åˆ™è¢«ç§°ä¸ºâ€œmember rewriting ruleâ€ï¼Œå¤§æ„æ˜¯â€œä¸€ä¸ªinlineå‡½æ•°å®ä½“ï¼Œåœ¨æ•´ä¸ª classå£°æ˜æœªè¢«å®Œå…¨çœ‹è§ä¹‹å‰ï¼Œæ˜¯ä¸ä¼šè¢«è¯„ä¼°æ±‚å€¼ï¼ˆevaluatedï¼‰çš„â€ã€‚C++Standard ä»¥â€œmember scope resolution rulesâ€æ¥ç²¾ç‚¼è¿™ä¸ªâ€œrewriting ruleâ€ï¼Œå…¶æ•ˆæœæ˜¯ï¼Œå¦‚æœä¸€ä¸ªinlineå‡½æ•°åœ¨classå£°æ˜ä¹‹åç«‹åˆ»è¢«å®šä¹‰çš„è¯ï¼Œé‚£ä¹ˆå°±è¿˜æ˜¯å¯¹å…¶è¯„ä¼°æ±‚å€¼ï¼ˆevaluate)ã€‚\nç„¶è€Œï¼Œè¿™å¯¹äºmember functionçš„argument list å¹¶ä¸ä¸ºçœŸã€‚Argument listä¸­çš„åç§°è¿˜æ˜¯ä¼šåœ¨å®ƒä»¬ç¬¬ä¸€æ¬¡é­é‡æ—¶è¢«é€‚å½“åœ°å†³è®®ï¼ˆresolvedï¼‰å®Œæˆã€‚å› æ­¤åœ¨externå’Œnested type namesä¹‹é—´çš„éç›´è§‰ç»‘å®šæ“ä½œè¿˜æ˜¯ä¼šå‘ç”Ÿã€‚ä¾‹å¦‚åœ¨ä¸‹é¢çš„ç¨‹åºç‰‡æ®µä¸­ï¼Œlengthçš„ç±»å‹åœ¨ä¸¤ä¸ªmember function signaturesä¸­éƒ½å†³è®®ï¼ˆresolve)ä¸ºglobal typedef,ä¹Ÿå°±æ˜¯int.å½“åç»­å†æœ‰lengthçš„nested typedef å£°æ˜å‡ºç°æ—¶ï¼ŒC+Standard å°±æŠŠç¨æ—©çš„ç»‘å®šæ ‡ç¤ºä¸ºéæ³•ï¼š\n1 2 3 4 5 6 7 8 9 10 11  typedef int length; class Point3D{ public: // 1ength è¢«å†³è®®(resolvedï¼‰ä¸ºglobal  void mumble(length val){_val = val;} length mumble() {return _val;} private: typedef float length; // 1ength è¢«å†³è®®(resolvedï¼‰ä¸ºlocal  length _val; };   ä¸Šè¿°è¿™ç§è¯­è¨€çŠ¶å†µï¼Œä»ç„¶éœ€è¦æŸç§é˜²å¾¡æ€§ç¨‹åºé£æ ¼ï¼šè¯·å§‹ç»ˆæŠŠâ€œnested typeå£°æ˜â€æ”¾åœ¨classçš„èµ·å§‹å¤„ã€‚åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå¦‚æœæŠŠlengthçš„nested typedefå®šä¹‰äºâ€œåœ¨classä¸­è¢«å‚è€ƒâ€ä¹‹å‰ï¼Œå°±å¯ä»¥ç¡®ä¿éç›´è§‰ç»‘å®šçš„æ­£ç¡®æ€§ã€‚\nData Memberçš„å¸ƒå±€ï¼ˆData Member Layout)\nData Memberçš„å­˜å–\næˆ‘ç”¨å®ƒä»¬æ¥å­˜å–data membersï¼Œåƒè¿™æ ·ï¼š\n1 2  origin.x=0.0; pt-\u0026gt;x=0.0;   é€šè¿‡originå­˜å–å’Œé€šè¿‡ptå­˜å–ï¼Œæœ‰ä»€ä¹ˆé‡å¤§å·®å¼‚å—ï¼Ÿ\nâ€œä»originå­˜å–â€å’Œâ€œä»ptå­˜å–â€æœ‰ä»€ä¹ˆé‡å¤§çš„å·®å¼‚ï¼Ÿç­”æ¡ˆæ˜¯â€œå½“Point3dæ˜¯ä¸€ä¸ªderived classï¼Œè€Œåœ¨å…¶ç»§æ‰¿ç»“æ„ä¸­æœ‰ä¸€ä¸ªvirtual base classï¼Œå¹¶ä¸”è¢«å­˜å–çš„member(å¦‚æœ¬ä¾‹çš„xï¼‰æ˜¯ä¸€ä¸ªä»è¯¥virtual base classç»§æ‰¿è€Œæ¥çš„memberæ—¶ï¼Œå°±ä¼šæœ‰é‡å¤§çš„å·®å¼‚â€ã€‚è¿™æ—¶å€™æˆ‘ä»¬ä¸èƒ½å¤Ÿè¯´ptå¿…ç„¶æŒ‡å‘å“ªä¸€ç§ class typeï¼ˆå› æ­¤æˆ‘ä»¬ä¹Ÿå°±ä¸çŸ¥é“ç¼–è¯‘æ—¶æœŸè¿™ä¸ªmemberçœŸæ­£çš„offsetä½ç½®ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªå­˜å–æ“ä½œå¿…é¡»å»¶è¿Ÿè‡³æ‰§è¡ŒæœŸï¼Œç»ç”±ä¸€ä¸ªé¢å¤–çš„é—´æ¥å¯¼å¼•ï¼Œæ‰èƒ½å¤Ÿè§£å†³ã€‚ä½†å¦‚æœä½¿ç”¨originï¼Œå°±ä¸ä¼šæœ‰è¿™äº›é—®é¢˜ï¼Œå…¶ç±»å‹æ— ç–‘æ˜¯Point3d classï¼Œè€Œå³ä½¿å®ƒç»§æ‰¿è‡ª virtual baseclassï¼Œmembersçš„offsetä½ç½®ä¹Ÿåœ¨ç¼–è¯‘æ—¶æœŸå°±å›ºå®šäº†ã€‚ä¸€ä¸ªç§¯æè¿›å–çš„ç¼–è¯‘å™¨ç”šè‡³å¯ä»¥é™æ€åœ°ç»ç”± originå°±è§£å†³æ‰å¯¹xçš„å­˜å–ã€‚â€œä»originå­˜å–â€å’Œâ€œä»ptå­˜å–â€æœ‰ä»€ä¹ˆé‡å¤§çš„å·®å¼‚ï¼Ÿç­”æ¡ˆæ˜¯â€œå½“Point3dæ˜¯ä¸€ä¸ªderived classï¼Œè€Œåœ¨å…¶ç»§æ‰¿ç»“æ„ä¸­æœ‰ä¸€ä¸ªvirtual base classï¼Œå¹¶ä¸”è¢«å­˜å–çš„member(å¦‚æœ¬ä¾‹çš„xï¼‰æ˜¯ä¸€ä¸ªä»è¯¥virtual base classç»§æ‰¿è€Œæ¥çš„memberæ—¶ï¼Œå°±ä¼šæœ‰é‡å¤§çš„å·®å¼‚â€ã€‚è¿™æ—¶å€™æˆ‘ä»¬ä¸èƒ½å¤Ÿè¯´ptå¿…ç„¶æŒ‡å‘å“ªä¸€ç§ class typeï¼ˆå› æ­¤æˆ‘ä»¬ä¹Ÿå°±ä¸çŸ¥é“ç¼–è¯‘æ—¶æœŸè¿™ä¸ªmemberçœŸæ­£çš„offsetä½ç½®ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªå­˜å–æ“ä½œå¿…é¡»å»¶è¿Ÿè‡³æ‰§è¡ŒæœŸï¼Œç»ç”±ä¸€ä¸ªé¢å¤–çš„é—´æ¥å¯¼å¼•ï¼Œæ‰èƒ½å¤Ÿè§£å†³ã€‚ä½†å¦‚æœä½¿ç”¨originï¼Œå°±ä¸ä¼šæœ‰è¿™äº›é—®é¢˜ï¼Œå…¶ç±»å‹æ— ç–‘æ˜¯Point3d classï¼Œè€Œå³ä½¿å®ƒç»§æ‰¿è‡ª virtual baseclassï¼Œmembersçš„offsetä½ç½®ä¹Ÿåœ¨ç¼–è¯‘æ—¶æœŸå°±å›ºå®šäº†ã€‚ä¸€ä¸ªç§¯æè¿›å–çš„ç¼–è¯‘å™¨ç”šè‡³å¯ä»¥é™æ€åœ°ç»ç”± originå°±è§£å†³æ‰å¯¹xçš„å­˜å–ã€‚\né™æ€æ•°æ®æˆå‘˜\nã€‚ã€‚ã€‚\néé™æ€æ•°æ®æˆå‘˜\nã€‚ã€‚ã€‚\nç»§æ‰¿ä¸æ•°æ®æˆå‘˜\næŒ‡å‘Data Membersçš„æŒ‡é’ˆï¼ˆPointer to Data Membersï¼‰\nå¦‚æœvptræ”¾åœ¨å¯¹è±¡çš„å°¾ç«¯ï¼Œä¸‰ä¸ªåæ ‡å€¼åœ¨å¯¹è±¡å¸ƒå±€ä¸­çš„offsetåˆ†åˆ«æ˜¯0ï¼Œ4ï¼Œ8ã€‚å¦‚æœvptræ”¾åœ¨å¯¹è±¡çš„èµ·å¤´ï¼Œä¸‰ä¸ªåæ ‡å€¼åœ¨å¯¹è±¡å¸ƒå±€ä¸­çš„offsetåˆ†åˆ«æ˜¯4ï¼Œ8ï¼Œ12ã€‚ç„¶è€Œä½ è‹¥å»å–data membersçš„åœ°å€ï¼Œä¼ å›çš„å€¼æ€»æ˜¯å¤š1ï¼Œä¹Ÿå°±æ˜¯1ï¼Œ5ï¼Œ9æˆ–5ï¼Œ9ï¼Œ13ç­‰ç­‰ã€‚ä½ çŸ¥é“ä¸ºä»€ä¹ˆBjarneå†³å®šè¦è¿™ä¹ˆåšå—ï¼Ÿ\nä¸ºäº†åŒºåˆ†ç¬¬ä¸€ä¸ªæ•°æ®æˆå‘˜ä¸æŒ‡å‘ç±»å¯¹è±¡çš„åœ°å€ã€‚\nğŸ–• Functionè¯­ä¹‰å­¦\nå¦‚æœæˆ‘æœ‰ä¸€ä¸ªPoint3dçš„æŒ‡é’ˆå’Œå¯¹è±¡ï¼š\n1 2  Point3d obj; Point3d *ptr = \u0026amp;obj;   å½“æˆ‘è¿™æ ·åšï¼š\n1 2  obj.normalize(); ptr-\u0026gt;normalize();   æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆäº‹ï¼Ÿå…¶ä¸­çš„Point3dï¼šï¼šnormalizeï¼ˆï¼‰å®šä¹‰å¦‚ä¸‹ï¼š\nMemberçš„å„ç§è°ƒç”¨æ–¹å¼\néé™æ€æˆå‘˜å‡½æ•°\nC++çš„è®¾è®¡å‡†åˆ™ä¹‹ä¸€å°±æ˜¯ï¼šnonstatic member function è‡³å°‘å¿…é¡»å’Œä¸€èˆ¬çš„nonmember functionæœ‰ç›¸åŒçš„æ•ˆç‡ã€‚\nä¾‹å¦‚ä¸‹é¢çš„ä¸¤ä¸ªå‡½æ•°ï¼š\n1 2  float magnitude(const Point3d *_this){...} float Point3d::magnitude(){...}   é€‰æ‹©member functionä¸åº”è¯¥å¸¦æ¥ä»€ä¹ˆé¢å¤–è´Ÿæ‹…ã€‚è¿™æ˜¯å› ä¸ºç¼–è¯‘å™¨å†…éƒ¨å·²å°†â€œmemberå‡½æ•°å®ä¾‹â€è½¬æ¢ä¸ºå¯¹ç­‰çš„â€œnonmemberå‡½æ•°å®ä¾‹â€ã€‚\nä¸‹é¢æ˜¯è½¬åŒ–æ­¥éª¤ï¼š\n  æ”¹å†™å‡½æ•°çš„ signatureï¼ˆè¯‘æ³¨ï¼šæ„æŒ‡å‡½æ•°åŸå‹ï¼‰ä»¥å®‰æ’ä¸€ä¸ªé¢å¤–çš„å‚æ•°åˆ°member functionä¸­ï¼Œç”¨ä»¥æä¾›ä¸€ä¸ªå­˜å–ç®¡é“ï¼Œä½¿ class objectå¾—ä»¥å°†æ­¤å‡½æ•°è°ƒç”¨ã€‚è¯¥é¢å¤–å‚æ•°è¢«ç§°ä¸º thisæŒ‡é’ˆï¼š\n1 2  //non-const nonstatic memberçš„æ‰©å¼ è¿‡ç¨‹ Point3d Point3d::magnitude(Point3d *const this)   å¦‚æœmember functionæ˜¯constï¼Œåˆ™å˜æˆ\n1 2  //non-const nonstatic memberçš„æ‰©å¼ è¿‡ç¨‹ Point3d Point3d::magnitude(const Point3d *const this)     å°†æ¯ä¸€ä¸ªâ€œå¯¹ nonstatic data member çš„å­˜å–æ“ä½œâ€æ”¹ä¸ºç»ç”± thisæŒ‡é’ˆæ¥å­˜å–ï¼š\n1 2 3 4 5 6  { return sqrt( this-\u0026gt;_x * this-\u0026gt;_x + this-\u0026gt;_y * this-\u0026gt;_y + this-\u0026gt;_z * this-\u0026gt;_z); }     å°† member functioné‡æ–°å†™æˆä¸€ä¸ªå¤–éƒ¨å‡½æ•°ã€‚å°†å‡½æ•°åç§°ç»è¿‡â€œmanglingâ€å¤„ç†ï¼Œä½¿å®ƒåœ¨ç¨‹åºä¸­æˆä¸ºç‹¬ä¸€æ— äºŒçš„è¯­æ±‡ï¼š\n1  extern magnitude_7Point3dFv( register Point3d *const this );     åç§°çš„ç‰¹æ®Šå¤„ç†\nä¸€èˆ¬è€Œè¨€ï¼Œmemberçš„åç§°å‰é¢ä¼šè¢«åŠ ä¸Šclassåç§°ï¼Œå½¢æˆç‹¬ä¸€æ— äºŒçš„å‘½åã€‚ä¾‹å¦‚ä¸‹é¢çš„å£°æ˜ï¼š\n1  class Bar {public:int ival;...};   å…¶ä¸­çš„ivalæœ‰å¯èƒ½å˜æˆè¿™æ ·ï¼š\n1 2  //member ç»è¿‡name-manglingä¹‹åçš„å¯èƒ½ç»“æœä¹‹ä¸€ ival__3Bar   é™æ€æˆå‘˜å‡½æ•°\nå…³äºtypedefçš„ç”¨æ³•æ€»ç»“ https://www.cnblogs.com/csyisong/archive/2009/01/09/1372363.html\nâœ’ æ™ºèƒ½æŒ‡é’ˆ unique_ptr std::unique_ptr æ˜¯é€šè¿‡æŒ‡é’ˆå æœ‰å¹¶ç®¡ç†å¦ä¸€å¯¹è±¡ï¼Œå¹¶åœ¨ unique_ptr ç¦»å¼€ä½œç”¨åŸŸæ—¶é‡Šæ”¾è¯¥å¯¹è±¡çš„æ™ºèƒ½æŒ‡é’ˆã€‚åœ¨ä¸‹åˆ—ä¸¤è€…ä¹‹ä¸€å‘ç”Ÿæ—¶ç”¨å…³è”çš„åˆ é™¤å™¨é‡Šæ”¾å¯¹è±¡ï¼š\n é”€æ¯äº†ç®¡ç†çš„ unique_ptr å¯¹è±¡ é€šè¿‡ operator= æˆ– reset() èµ‹å€¼å¦ä¸€æŒ‡é’ˆç»™ç®¡ç†çš„ unique_ptr å¯¹è±¡ã€‚  shared_ptr std::shared_ptr æ˜¯é€šè¿‡æŒ‡é’ˆä¿æŒå¯¹è±¡å…±äº«æ‰€æœ‰æƒçš„æ™ºèƒ½æŒ‡é’ˆã€‚å¤šä¸ª shared_ptr å¯¹è±¡å¯å æœ‰åŒä¸€å¯¹è±¡ã€‚ä¸‹åˆ—æƒ…å†µä¹‹ä¸€å‡ºç°æ—¶é”€æ¯å¯¹è±¡å¹¶è§£åˆ†é…å…¶å†…å­˜ï¼š\n æœ€åå‰©ä¸‹çš„å æœ‰å¯¹è±¡çš„ shared_ptr è¢«é”€æ¯ï¼› æœ€åå‰©ä¸‹çš„å æœ‰å¯¹è±¡çš„ shared_ptr è¢«é€šè¿‡ operator= æˆ– reset() èµ‹å€¼ä¸ºå¦ä¸€æŒ‡é’ˆã€‚  æ¯æ¬¡åˆ›å»ºç±»çš„æ–°å¯¹è±¡æ—¶ï¼Œåˆå§‹åŒ–æŒ‡é’ˆå¹¶å°†å¼•ç”¨è®¡æ•°ç½®ä¸º1ï¼›å½“å¯¹è±¡ä½œä¸ºå¦ä¸€å¯¹è±¡çš„å‰¯æœ¬è€Œåˆ›å»ºæ—¶ï¼Œå¼•ç”¨è®¡æ•°åŠ 1ï¼›å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œèµ‹å€¼æ—¶ï¼Œèµ‹å€¼æ“ä½œç¬¦å‡å°‘å·¦æ“ä½œæ•°æ‰€æŒ‡å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼ˆå¦‚æœå¼•ç”¨è®¡æ•°ä¸ºå‡è‡³0ï¼Œåˆ™åˆ é™¤å¯¹è±¡ï¼‰ï¼Œå¹¶å¢åŠ å³æ“ä½œæ•°æ‰€æŒ‡å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼›è°ƒç”¨ææ„å‡½æ•°æ—¶ï¼Œæ„é€ å‡½æ•°å‡å°‘å¼•ç”¨è®¡æ•°ï¼ˆå¦‚æœå¼•ç”¨è®¡æ•°å‡è‡³0ï¼Œåˆ™åˆ é™¤åŸºç¡€å¯¹è±¡ï¼‰ã€‚\nshared_ptrçš„å†…å­˜æ¨¡å‹ï¼š\nä¸‹é¢æ˜¯ç”¨ç±»æ¨¡æ¿ç®€å•å®ç°shared_ptr.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62  #include \u0026lt;iostream\u0026gt;using namespace std; template\u0026lt;typename T\u0026gt; class SmartPointer { private: T* p_; size_t* count_; public: SmartPointer(T* ptr = nullptr) : p_(ptr) { if (p_) { count_ = new size_t(1); } else { count_ = new size_t(0); } } SmartPointer(const SmartPointer\u0026amp; ptr) { p_ = ptr.p_; count_ = ptr.count_; (*count_)++; } SmartPointer\u0026amp; operator=(const SmartPointer\u0026amp; ptr) { if (p_ == ptr.p_) { return *this; } if (p_) { if (--(*count_) == 0) { delete p_; delete count_; } } p_ = ptr.p_; count_ = ptr.count_; (*count_)++; return *this; } ~SmartPointer() { if (--(*count_) == 0) { delete p_; delete count_; } } size_t use_count() { return *count_; } }; int main() { SmartPointer\u0026lt;int\u0026gt; sp1(new int(10)); SmartPointer\u0026lt;int\u0026gt; sp2(sp1); SmartPointer\u0026lt;int\u0026gt; sp3(new int(20)); sp2 = sp3; std::cout \u0026lt;\u0026lt; sp1.use_count() \u0026lt;\u0026lt; std::endl; std::cout \u0026lt;\u0026lt; sp3.use_count() \u0026lt;\u0026lt; std::endl; }   æ™ºèƒ½æŒ‡é’ˆå¸¦æ¥çš„æ€§èƒ½å½±å“:\n1ï¼‰shared_ptrçš„å°ºå¯¸æ˜¯è£¸æŒ‡é’ˆçš„ä¸¤å€ã€‚\n2ï¼‰ä¼šå¸¦æ¥æ§åˆ¶å—çš„å¼€é”€ã€‚\n3ï¼‰å¼•ç”¨è®¡æ•°çš„é€’å¢å’Œé€’å‡æ˜¯åŸå­æ“ä½œï¼ŒåŸå­æ“ä½œä¸€èˆ¬éƒ½æ¯”éåŸå­æ“ä½œæ…¢ã€‚\nweak_ptr weak_ptr æ˜¯ä¸€ç§ä¸æ§åˆ¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„æ™ºèƒ½æŒ‡é’ˆ, å®ƒæŒ‡å‘ä¸€ä¸ª shared_ptr ç®¡ç†çš„å¯¹è±¡. è¿›è¡Œè¯¥å¯¹è±¡çš„å†…å­˜ç®¡ç†çš„æ˜¯é‚£ä¸ªå¼ºå¼•ç”¨çš„ shared_ptr. weak_ptråªæ˜¯æä¾›äº†å¯¹ç®¡ç†å¯¹è±¡çš„ä¸€ä¸ªè®¿é—®æ‰‹æ®µã€‚weak_ptr è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºé…åˆ shared_ptr è€Œå¼•å…¥çš„ä¸€ç§æ™ºèƒ½æŒ‡é’ˆæ¥ååŠ© shared_ptr å·¥ä½œ, å®ƒåªå¯ä»¥ä»ä¸€ä¸ª shared_ptr æˆ–å¦ä¸€ä¸ª weak_ptr å¯¹è±¡æ„é€ , å®ƒçš„æ„é€ å’Œææ„ä¸ä¼šå¼•èµ·å¼•ç”¨è®°æ•°çš„å¢åŠ æˆ–å‡å°‘ã€‚weak_ptræ˜¯ç”¨æ¥è§£å†³shared_ptrç›¸äº’å¼•ç”¨æ—¶çš„æ­»é”é—®é¢˜,å¦‚æœè¯´ä¸¤ä¸ªshared_ptrç›¸äº’å¼•ç”¨,é‚£ä¹ˆè¿™ä¸¤ä¸ªæŒ‡é’ˆçš„å¼•ç”¨è®¡æ•°æ°¸è¿œä¸å¯èƒ½ä¸‹é™ä¸º0,èµ„æºæ°¸è¿œä¸ä¼šé‡Šæ”¾ã€‚å®ƒæ˜¯å¯¹å¯¹è±¡çš„ä¸€ç§å¼±å¼•ç”¨ï¼Œä¸ä¼šå¢åŠ å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼Œå’Œshared_pträ¹‹é—´å¯ä»¥ç›¸äº’è½¬åŒ–ï¼Œshared_ptrå¯ä»¥ç›´æ¥èµ‹å€¼ç»™å®ƒï¼Œå®ƒå¯ä»¥é€šè¿‡è°ƒç”¨lockå‡½æ•°æ¥è·å¾—shared_ptrã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39  #include \u0026lt;iostream\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;memory\u0026gt;using namespace std; class B; class A { public: weak_ptr\u0026lt;B\u0026gt; pb_; ~A() { cout \u0026lt;\u0026lt; \u0026#34;A delete\\n\u0026#34;; } }; class B { public: shared_ptr\u0026lt;A\u0026gt; pa_; ~B() { cout \u0026lt;\u0026lt; \u0026#34;B delete\\n\u0026#34;; } }; void fun() { shared_ptr\u0026lt;B\u0026gt; pb(new B()); shared_ptr\u0026lt;A\u0026gt; pa(new A()); pb-\u0026gt;pa_ = pa; pa-\u0026gt;pb_ = pb; cout \u0026lt;\u0026lt; pb.use_count() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; pa.use_count() \u0026lt;\u0026lt; endl; } int main() { fun(); return 0; }    æ³¨æ„çš„æ˜¯æˆ‘ä»¬ä¸èƒ½é€šè¿‡weak_ptrç›´æ¥è®¿é—®å¯¹è±¡çš„æ–¹æ³•ï¼Œæ¯”å¦‚Bå¯¹è±¡ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•print(),æˆ‘ä»¬ä¸èƒ½è¿™æ ·è®¿é—®ï¼Œpa-\u0026gt;pb_-\u0026gt;print(); è‹±æ–‡pb_æ˜¯ä¸€ä¸ªweak_ptrï¼Œåº”è¯¥å…ˆæŠŠå®ƒè½¬åŒ–ä¸ºshared_ptr,å¦‚ï¼šshared_ptr p = pa-\u0026gt;pb_.lock(); p-\u0026gt;print();\n å¤šçº¿ç¨‹è¯»å†™shared_ptréœ€è¦åŠ é” åœ¨ç°ä»£C++ä¸­ï¼Œé€šè¿‡ä½¿ç”¨shared_ptrè¿™æ ·çš„æ™ºèƒ½æŒ‡é’ˆèƒ½å¤Ÿå¾ˆå¥½çš„é™ä½å†…å­˜æ³„æ¼çš„å¯èƒ½æ€§ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ä¸­æ— ä¿æŠ¤çš„è¯»å†™shared_ptråˆ™æœ‰å¯èƒ½å¸¦æ¥race conditionçš„æƒ…å†µã€‚\n ç«äº‰å±å®³ (race hazard) åˆåç«æ€æ¡ä»¶ (race condition)ã€‚æ—¨åœ¨æè¿°ä¸€ä¸ªç³»ç»Ÿæˆ–è€…è¿›ç¨‹çš„è¾“å‡ºå±•ç°æ— æ³•é¢„æµ‹çš„ã€å¯¹äº‹ä»¶é—´ç›¸å¯¹æ—¶é—´çš„æ’åˆ—é¡ºåºçš„è‡´å‘½ç›¸ä¾æ€§ã€‚\n å‚è€ƒï¼š\n C++11\u0026ndash;æ™ºèƒ½æŒ‡é’ˆè¯¦è§£åŠå®ç° å¤šçº¿ç¨‹è¯»å†™shared_ptréœ€è¦åŠ é”  é‡æŒ‡é’ˆ\né‡æŒ‡é’ˆå°±æ˜¯æŒ‡å‘ä¸€ä¸ªå·²åˆ é™¤çš„å¯¹è±¡æˆ–è€…æœªç”³è¯·è®¿é—®å—é™å†…å­˜åŒºåŸŸçš„æŒ‡é’ˆ\nC++å†…å­˜ç®¡ç†ä¸ç¨‹åºå†…å­˜åˆ†åŒº C++å†…å­˜åˆ†åŒº C++å­˜åœ¨å¦‚ä¸‹çš„å†…å­˜åˆ†åŒº\n1ï¼‰æ ˆåŒºï¼ˆstackï¼‰ï¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…é‡Šæ”¾ ï¼Œå­˜æ”¾å‡½æ•°çš„ å‚æ•°å€¼ï¼Œå±€éƒ¨å˜é‡çš„å€¼ç­‰ã€‚å…¶æ“ä½œæ–¹å¼ç±»ä¼¼äºæ•°æ®ç»“ æ„ä¸­çš„æ ˆã€‚\n2ï¼‰å †åŒºï¼ˆheapï¼‰ï¼šä¸€èˆ¬ç”±ç¨‹åºå‘˜åˆ†é…é‡Šæ”¾ï¼Œè‹¥ç¨‹åºå‘˜ä¸ é‡Šæ”¾ï¼Œç¨‹åºç»“æŸæ—¶å¯èƒ½ç”±OSå›æ”¶ã€‚æ³¨æ„å®ƒä¸æ•°æ®ç»“æ„ ä¸­çš„å †æ˜¯ä¸¤å›äº‹ï¼Œåˆ†é…æ–¹å¼å€’æ˜¯ç±»ä¼¼äºé“¾è¡¨ã€‚\n3ï¼‰å…¨å±€/é™æ€åŒº(staticï¼‰ï¼šå…¨å±€å˜é‡å’Œé™æ€å˜é‡çš„å­˜å‚¨æ˜¯ æ”¾åœ¨ä¸€å—çš„ï¼Œåœ¨ç¨‹åºç¼–è¯‘æ—¶åˆ†é…\n4ï¼‰æ–‡å­—å¸¸é‡åŒºï¼šå­˜æ”¾å¸¸é‡å­—ç¬¦ä¸²\n5ï¼‰ç¨‹åºä»£ç åŒºï¼šå­˜æ”¾å‡½æ•°ä½“ï¼ˆç±»çš„æˆå‘˜å‡½æ•°ã€å…¨å±€å‡½æ•°ï¼‰ çš„äºŒè¿›åˆ¶ä»£ç \nCè¯­è¨€ä¸­ï¼Œå†…å­˜åˆ†é…æœ‰ä¸‰ç§ï¼š\n é™æ€åŒºåŸŸåˆ†é…ï¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…ä¸é‡Šæ”¾ï¼Œå†…å­˜åœ¨ç¼–è¯‘çš„æ—¶å€™å·²ç»åˆ†é…å¥½ï¼Œè¿™å—å†…å­˜åœ¨æ•´ä¸ªç¨‹åºçš„è¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ç›´åˆ°ç¨‹åºç»“æŸæ—¶æ‰è¢«é‡Šæ”¾ï¼Œå¦‚å…¨å±€å˜é‡ä¸staticå˜é‡ã€‚ æ ˆåˆ†é…ï¼šç”±ç¼–è¯‘å™¨åœ¨ç¨‹åºè¿è¡Œæ—¶ä»æ ˆä¸Šåˆ†é…ï¼Œå‡½æ•°æ ˆé€€å‡ºæ—¶è‡ªåŠ¨é‡Šæ”¾ã€‚æ ˆåˆ†é…çš„è¿ç®—åœ¨å¤„ç†å™¨çš„æŒ‡ä»¤é›†ä¸­ï¼Œæ‰€ä»¥å®ƒçš„è¿è¡Œæ•ˆç‡å¾ˆé«˜ï¼Œä½†èƒ½åˆ†é…çš„å†…å®¹æ˜¯æœ‰é™çš„ã€‚ å †åˆ†é…ï¼šæœ‰ç¨‹åºå‘˜ä¸»åŠ¨è°ƒç”¨å†…å­˜åˆ†é…å‡½æ•°æ¥ç”³è¯·å†…å­˜ï¼Œä¸”ä½¿ç”¨å®Œæ¯•åç”±ç¨‹åºå‘˜è‡ªå·±é‡Šæ”¾ï¼Œå…¶ä½¿ç”¨éå¸¸çµæ´»ï¼Œä½†å…¶åˆ†é…æ–¹å¼æ˜¯é€šè¿‡è°ƒç”¨å‡½æ•°æ¥å®ç°ï¼Œæ•ˆç‡æ²¡æ ˆé«˜ã€‚malloc,allocç­‰  ç¨‹åºåœ¨å†…å­˜ä¸­çš„åˆ†å¸ƒ ä¸­æ–‡ç‰ˆ\n  å†…æ ¸ç©ºé—´\n  æ ˆ\n1ã€stackå­˜æ”¾å‡½æ•°çš„ä¸´æ—¶å˜é‡ã€å±€éƒ¨å˜é‡ã€å‡½æ•°å‚æ•°å’Œè¿”å›å€¼\n2ã€ç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾ã€‚\n  åŠ¨æ€é“¾æ¥åº“(å…±äº«æ˜ å°„åŒº)\nè°ƒç”¨çš„åº“æ–‡ä»¶ï¼Œä½äºå †å’Œæ ˆä¹‹é—´\n  å †\nheapç”¨æ¥åŠ¨æ€åˆ†é…å†…å­˜ï¼Œç”±ç¨‹åºå‘˜æ§åˆ¶ï¼Œäº¤ç”±ç¨‹åºè‡ªèº«å†³å®šå¼€è¾Ÿå’Œé‡Šæ”¾ã€‚\n  å…¨å±€æ•°æ®åŒº\n.bss\nbssæ®µç”¨æ¥å­˜æ”¾æ²¡æœ‰è¢«åˆå§‹åŒ–å’Œå·²ç»è¢«åˆå§‹åŒ–ä¸º0çš„å…¨å±€å˜é‡\n.data\ndataæ®µç”¨æ¥å­˜æ”¾å·²ç»è¢«åˆå§‹åŒ–ä¸ºé0çš„å…¨å±€å˜é‡\n  å¸¸é‡åŒº\n.rodata\nrodataæ®µç”¨æ¥å­˜æ”¾å¸¸é‡æ•°æ®ã€è¢«ç¼–è¯‘å™¨è‡ªåŠ¨å­˜æ”¾æ¥çš„å­—ç¬¦ä¸²å’ŒåŠ constå…³é”®å­—çš„å¸¸é‡æ•°æ®ã€‚\n  ä»£ç åŒº\n.text\ntextæ®µç”¨æ¥å­˜æ”¾ä»£ç å’Œéƒ¨åˆ†æ•´æ•°å¸¸é‡ï¼Œè¯¥æ®µæ˜¯å¯æ‰§è¡Œçš„ã€‚\n  å †ä¸æ ˆ æ ˆæ˜¯ä¸€ç§çš„â€œå…ˆè¿›åå‡ºâ€çš„å­˜å‚¨ç»“æ„ã€‚\nå †æ˜¯ä¸€ç§å®Œå…¨äºŒå‰æ ‘ã€‚èŠ‚ç‚¹ä»å·¦åˆ°å³å¡«æ»¡ï¼Œæœ€åä¸€å±‚çš„æ ‘å¶éƒ½åœ¨æœ€å·¦è¾¹ã€‚ï¼ˆå³å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ²¡æœ‰å·¦è¾¹å„¿å­ï¼Œé‚£ä¹ˆå®ƒä¸€å®šæ²¡æœ‰å³è¾¹å„¿å­ï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å°äºï¼ˆæˆ–è€…å¤§äºï¼‰å…¶å­èŠ‚ç‚¹çš„å€¼ï¼ˆå¤§é¡¶å †ã€å°é¡¶å †ï¼‰ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯å¯ä»¥ä½¿ç”¨ä¸€ç»´æ•°ç»„æ¥è¡¨ç¤ºã€‚å †çš„æ“ä½œä¹Ÿå¯é€šè¿‡æ•°æ®å…ƒç´ äº¤æ¢çš„å½¢å¼è§£å†³ï¼Œéå¸¸é€‚åˆå†…å­˜ç©ºé—´çº¿æ€§çš„ç‰¹ç‚¹ã€‚\nå‚è€ƒåœ°å€\n ç¨‹åºåœ¨å†…å­˜ä¸­çš„åˆ†å¸ƒ http://baijiahao.baidu.com/s?id=1664957369973450228\u0026amp;wfr=spider\u0026amp;for=pc  C++å†…å­˜æ³„æ¼  ç³»ç»Ÿèµ„æºæ³„éœ²ï¼ˆResource Leakï¼‰ã€‚ä¸»è¦æŒ‡ç¨‹åºä½¿ç”¨ç³»ç»Ÿåˆ†é…çš„èµ„æºæ¯”å¦‚ Bitmap,handle ,SOCKETç­‰æ²¡æœ‰ä½¿ç”¨ç›¸åº”çš„å‡½æ•°é‡Šæ”¾æ‰ï¼Œå¯¼è‡´ç³»ç»Ÿèµ„æºçš„æµªè´¹ï¼Œä¸¥é‡å¯å¯¼è‡´ç³»ç»Ÿæ•ˆèƒ½é™ä½ï¼Œç³»ç»Ÿè¿è¡Œä¸ç¨³å®šã€‚\n å†…å­˜æ³„æ¼ å†…å­˜æ³„æ¼æŒ‡ç”±äºç–å¿½æˆ–é”™è¯¯é€ æˆç¨‹åºæœªèƒ½é‡Šæ”¾å·²ç»ä¸å†ä½¿ç”¨çš„å†…å­˜çš„æƒ…å†µ\næ£€æµ‹å†…å­˜æ³„æ¼çš„åŸç† ä¸»è¦è¿˜æ˜¯è¿ç”¨äºŒè¿›åˆ¶æ’æ¡©ï¼Œè®°å½•èµ„æºçš„ç”³è¯·å’Œé‡Šæ”¾æ“ä½œï¼Œç„¶åå¯¹è®°å½•è¿›è¡ŒåŒ¹é…å‰”é™¤ï¼Œæœ€åå°±æ˜¯å‰©ä¸‹çš„æ³„æ¼çš„äº†ã€‚\næ£€æµ‹æ–¹æ³• æœ€ç®€å•çš„ åœ¨æ¯ä¸€å¤„ç”³è¯·/é‡Šæ”¾å†…å­˜çš„åœ°æ–¹è¿›è¡Œæ‰“ç‚¹ï¼Œç„¶ååŒ¹å¯¹ä¸€ä¸‹å°±çŸ¥é“å“ªé‡Œå†…å­˜æ³„éœ²äº†ã€‚\nWindowså¹³å°ä¸‹çš„å†…å­˜æ³„æ¼æ£€æµ‹ Windowså¹³å°ä¸‹é¢Visual Studio è°ƒè¯•å™¨å’Œ C è¿è¡Œæ—¶ (CRT) åº“ä¸ºæˆ‘ä»¬æä¾›äº†æ£€æµ‹å’Œè¯†åˆ«å†…å­˜æ³„æ¼çš„æœ‰æ•ˆæ–¹æ³•ï¼ŒåŸç†å¤§è‡´å¦‚ä¸‹ï¼šå†…å­˜åˆ†é…è¦é€šè¿‡CRTåœ¨è¿è¡Œæ—¶å®ç°ï¼Œåªè¦åœ¨åˆ†é…å†…å­˜å’Œé‡Šæ”¾å†…å­˜æ—¶åˆ†åˆ«åšå¥½è®°å½•ï¼Œç¨‹åºç»“æŸæ—¶å¯¹æ¯”åˆ†é…å†…å­˜å’Œé‡Šæ”¾å†…å­˜çš„è®°å½•å°±å¯ä»¥ç¡®å®šæ˜¯ä¸æ˜¯æœ‰å†…å­˜æ³„æ¼ã€‚åœ¨vsä¸­å¯ç”¨å†…å­˜æ£€æµ‹çš„æ–¹æ³•å¦‚ä¸‹ï¼š\n  åœ¨ç¨‹åºä¸­åŒ…æ‹¬ä»¥ä¸‹è¯­å¥ï¼š ï¼ˆ#include è¯­å¥å¿…é¡»é‡‡ç”¨ä¸Šæ–‡æ‰€ç¤ºé¡ºåºã€‚ å¦‚æœæ›´æ”¹äº†é¡ºåºï¼Œæ‰€ä½¿ç”¨çš„å‡½æ•°å¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œã€‚ï¼‰\n1 2 3  #define _CRTDBG_MAP_ALLOC#include \u0026lt;stdlib.h\u0026gt;#include \u0026lt;crtdbg.h\u0026gt;   é€šè¿‡åŒ…æ‹¬ crtdbg.hï¼Œå°† malloc å’Œ free å‡½æ•°æ˜ å°„åˆ°å®ƒä»¬çš„è°ƒè¯•ç‰ˆæœ¬ï¼Œå³ _malloc_dbg å’Œ _free_dbgï¼Œè¿™ä¸¤ä¸ªå‡½æ•°å°†è·Ÿè¸ªå†…å­˜åˆ†é…å’Œé‡Šæ”¾ã€‚ æ­¤æ˜ å°„åªåœ¨è°ƒè¯•ç‰ˆæœ¬ï¼ˆåœ¨å…¶ä¸­å®šä¹‰äº†**_DEBUG**ï¼‰ä¸­å‘ç”Ÿã€‚ å‘å¸ƒç‰ˆæœ¬ä½¿ç”¨æ™®é€šçš„ **malloc** å’Œ **free** å‡½æ•°ã€‚\n #define è¯­å¥å°† CRT å †å‡½æ•°çš„åŸºç‰ˆæœ¬æ˜ å°„åˆ°å¯¹åº”çš„â€œDebugâ€ç‰ˆæœ¬ã€‚ å¹¶éç»å¯¹éœ€è¦è¯¥è¯­å¥ï¼›ä½†å¦‚æœæ²¡æœ‰è¯¥è¯­å¥ï¼Œå†…å­˜æ³„æ¼è½¬å‚¨åŒ…å«çš„æœ‰ç”¨ä¿¡æ¯å°†è¾ƒå°‘ã€‚\n  åœ¨æ·»åŠ äº†ä¸Šè¿°è¯­å¥ä¹‹åï¼Œå¯ä»¥é€šè¿‡åœ¨ç¨‹åºä¸­åŒ…æ‹¬ä»¥ä¸‹è¯­å¥ï¼ˆé€šå¸¸åº”æ°å¥½æ”¾åœ¨ç¨‹åºé€€å‡ºä½ç½®ä¹‹å‰ï¼‰æ¥è½¬å‚¨å†…å­˜æ³„æ¼ä¿¡æ¯ï¼š\n1  _CrtDumpMemoryLeaks();   å¦‚æœæ²¡æœ‰ä½¿ç”¨ #define _CRTDBG_MAP_ALLOC è¯­å¥ï¼Œå†…å­˜æ³„æ¼è½¬å‚¨å°†å¦‚ä¸‹æ‰€ç¤º\n æœªå®šä¹‰ _CRTDBG_MAP_ALLOC æ—¶ï¼Œæ‰€æ˜¾ç¤ºçš„ä¼šæ˜¯ï¼š\n å†…å­˜åˆ†é…ç¼–å·ï¼ˆåœ¨å¤§æ‹¬å·å†…ï¼‰ã€‚ å—ç±»å‹ï¼ˆæ™®é€šã€å®¢æˆ·ç«¯æˆ– CRTï¼‰ã€‚     å®šä½åˆ°å…·ä½“çš„ä½ç½®\n  æœ€ç»ˆå®šä½ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  #define _CRTDBG_MAP_ALLOC#include \u0026lt;stdlib.h\u0026gt;#include \u0026lt;crtdbg.h\u0026gt; #include \u0026lt;iostream\u0026gt;using namespace std; _CrtMemState s1, s2, s3; void GetMemory(char *p, int num) { p = (char*)malloc(sizeof(char) * num); } int main(int argc,char** argv) { _CrtMemCheckpoint( \u0026amp;s1 ); char *str = NULL; GetMemory(str, 100); _CrtMemCheckpoint( \u0026amp;s2 ); if ( _CrtMemDifference( \u0026amp;s3, \u0026amp;s1, \u0026amp;s2) ) _CrtMemDumpStatistics( \u0026amp;s3 ); cout\u0026lt;\u0026lt;\u0026#34;Memory leak test!\u0026#34;\u0026lt;\u0026lt;endl; _CrtDumpMemoryLeaks(); return 0; }   Linuxå¹³å°ä¸‹çš„å†…å­˜æ³„æ¼æ£€æµ‹ Valgrindæ˜¯ä¸€å¥—Linuxä¸‹ï¼Œå¼€æ”¾æºä»£ç ï¼ˆGPL V2ï¼‰çš„ä»¿çœŸè°ƒè¯•å·¥å…·çš„é›†åˆã€‚Valgrindç”±å†…æ ¸ï¼ˆcoreï¼‰ä»¥åŠåŸºäºå†…æ ¸çš„å…¶ä»–è°ƒè¯•å·¥å…·ç»„æˆã€‚å†…æ ¸ç±»ä¼¼äºä¸€ä¸ªæ¡†æ¶ï¼ˆframeworkï¼‰ï¼Œå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªCPUç¯å¢ƒï¼Œå¹¶æä¾›æœåŠ¡ç»™å…¶ä»–å·¥å…·ï¼›è€Œå…¶ä»–å·¥å…·åˆ™ç±»ä¼¼äºæ’ä»¶ (plug-in)ï¼Œåˆ©ç”¨å†…æ ¸æä¾›çš„æœåŠ¡å®Œæˆå„ç§ç‰¹å®šçš„å†…å­˜è°ƒè¯•ä»»åŠ¡ã€‚Valgrindçš„ä½“ç³»ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nå‚è€ƒé“¾æ¥ï¼š\n C/C++å†…å­˜æ³„æ¼åŠæ£€æµ‹   C++å‡½æ•°æŒ‡é’ˆ å‡½æ•°æŒ‡é’ˆæ˜¯æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡ã€‚\næŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡çš„ä¸€èˆ¬å®šä¹‰å½¢å¼ä¸ºï¼š æ•°æ®ç±»å‹ (*æŒ‡é’ˆå˜é‡å)(å‚æ•°è¡¨);\nå‚è€ƒï¼šC++å‡½æ•°æŒ‡é’ˆè¯¦è§£\nmallocçš„åŸç† Mallocå‡½æ•°ç”¨äºåŠ¨æ€åˆ†é…å†…å­˜ã€‚ä¸ºäº†å‡å°‘å†…å­˜ç¢ç‰‡å’Œç³»ç»Ÿè°ƒç”¨çš„å¼€é”€ï¼Œmallocå…¶é‡‡ç”¨å†…å­˜æ± çš„æ–¹å¼ï¼Œå…ˆç”³è¯·å¤§å—å†…å­˜ä½œä¸ºå †åŒºï¼Œç„¶åå°†å †åŒºåˆ†ä¸ºå¤šä¸ªå†…å­˜å—ï¼Œä»¥å—ä½œä¸ºå†…å­˜ç®¡ç†çš„åŸºæœ¬å•ä½ã€‚å½“ç”¨æˆ·ç”³è¯·å†…å­˜æ—¶ï¼Œç›´æ¥ä»å †åŒºåˆ†é…ä¸€å—åˆé€‚çš„ç©ºé—²å—ã€‚Mallocé‡‡ç”¨éšå¼é“¾è¡¨ç»“æ„å°†å †åŒºåˆ†æˆè¿ç»­çš„ã€å¤§å°ä¸ä¸€çš„å—ï¼ŒåŒ…å«å·²åˆ†é…å—å’Œæœªåˆ†é…å—ï¼›åŒæ—¶mallocé‡‡ç”¨æ˜¾ç¤ºé“¾è¡¨ç»“æ„æ¥ç®¡ç†æ‰€æœ‰çš„ç©ºé—²å—ï¼Œå³ä½¿ç”¨ä¸€ä¸ªåŒå‘é“¾è¡¨å°†ç©ºé—²å—è¿æ¥èµ·æ¥ï¼Œæ¯ä¸€ä¸ªç©ºé—²å—è®°å½•äº†ä¸€ä¸ªè¿ç»­çš„ã€æœªåˆ†é…çš„åœ°å€ã€‚å½“è¿›è¡Œå†…å­˜åˆ†é…æ—¶ï¼ŒMallocä¼šé€šè¿‡éšå¼é“¾è¡¨éå†æ‰€æœ‰çš„ç©ºé—²å—ï¼Œé€‰æ‹©æ»¡è¶³è¦æ±‚çš„å—è¿›è¡Œåˆ†é…ï¼›å½“è¿›è¡Œå†…å­˜åˆå¹¶æ—¶ï¼Œmallocé‡‡ç”¨è¾¹ç•Œæ ‡è®°æ³•ï¼Œæ ¹æ®æ¯ä¸ªå—çš„å‰åå—æ˜¯å¦å·²ç»åˆ†é…æ¥å†³å®šæ˜¯å¦è¿›è¡Œå—åˆå¹¶ã€‚\nMallocåœ¨ç”³è¯·å†…å­˜æ—¶ï¼Œä¸€èˆ¬ä¼šé€šè¿‡brkæˆ–è€…mmapç³»ç»Ÿè°ƒç”¨è¿›è¡Œç”³è¯·ã€‚å…¶ä¸­å½“ç”³è¯·å†…å­˜å°äº128Kæ—¶ï¼Œä¼šä½¿ç”¨ç³»ç»Ÿå‡½æ•°brkåœ¨å †åŒºä¸­åˆ†é…ï¼›è€Œå½“ç”³è¯·å†…å­˜å¤§äº128Kæ—¶ï¼Œä¼šä½¿ç”¨ç³»ç»Ÿå‡½æ•°mmapåœ¨æ˜ å°„åŒºåˆ†é…ã€‚\nC++æ¨¡æ¿ https://www.cnblogs.com/gw811/archive/2012/10/25/2738929.html\næ¨¡æ¿æ˜¯ä¸€ç§å¯¹ç±»å‹è¿›è¡Œå‚æ•°åŒ–çš„å·¥å…·ï¼›é€šå¸¸æœ‰ä¸¤ç§å½¢å¼ï¼šå‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿ï¼›å‡½æ•°æ¨¡æ¿é’ˆå¯¹ä»…å‚æ•°ç±»å‹ä¸åŒçš„å‡½æ•°ï¼›ç±»æ¨¡æ¿é’ˆå¯¹ä»…æ•°æ®æˆå‘˜å’Œæˆå‘˜å‡½æ•°ç±»å‹ä¸åŒçš„ç±»ã€‚\nå‡½æ•°æ¨¡æ¿ å‡½æ•°æ¨¡æ¿æ ¼å¼ 1 2 3 4  template \u0026lt;class å½¢å‚åï¼Œclass å½¢å‚åï¼Œ......\u0026gt; è¿”å›ç±»å‹ å‡½æ•°å(å‚æ•°åˆ—è¡¨) { å‡½æ•°ä½“ }    å…¶ä¸­templateå’Œclassæ˜¯å…³è§å­—ï¼Œclasså¯ä»¥ç”¨typename å…³è§å­—ä»£æ›¿ï¼Œåœ¨è¿™é‡Œtypename å’Œclassæ²¡åŒºåˆ«\n ç±»æ¨¡æ¿ ç±»æ¨¡æ¿æ ¼å¼ 1 2  template\u0026lt;class å½¢å‚åï¼Œclass å½¢å‚åï¼Œâ€¦\u0026gt; class ç±»å { ... };   ç±»æ¨¡æ¿å¯¹è±¡çš„åˆ›å»º\næ¯”å¦‚ä¸€ä¸ªæ¨¡æ¿ç±»Aï¼Œåˆ™ä½¿ç”¨ç±»æ¨¡æ¿åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ä¸ºA m;åœ¨ç±»Aåé¢è·Ÿä¸Šä¸€ä¸ª\u0026lt;\u0026gt;å°–æ‹¬å·å¹¶åœ¨é‡Œé¢å¡«ä¸Šç›¸åº”çš„ç±»å‹ï¼Œè¿™æ ·çš„è¯ç±»Aä¸­å‡¡æ˜¯ç”¨åˆ°æ¨¡æ¿å½¢å‚çš„åœ°æ–¹éƒ½ä¼šè¢«int æ‰€ä»£æ›¿ã€‚å½“ç±»æ¨¡æ¿æœ‰ä¸¤ä¸ªæ¨¡æ¿å½¢å‚æ—¶åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ä¸ºA\u0026lt;int, double\u0026gt; m;ç±»å‹ä¹‹é—´ç”¨é€—å·éš”å¼€ã€‚\nåœ¨ç±»æ¨¡æ¿å¤–éƒ¨å®šä¹‰æˆå‘˜å‡½æ•°çš„æ–¹æ³•ä¸ºï¼š\n1  template\u0026lt;æ¨¡æ¿å½¢å‚åˆ—è¡¨\u0026gt; å‡½æ•°è¿”å›ç±»å‹ ç±»å\u0026lt;æ¨¡æ¿å½¢å‚å\u0026gt;::å‡½æ•°å(å‚æ•°åˆ—è¡¨){å‡½æ•°ä½“}ï¼Œ   ä¾‹å¦‚ï¼š\n1  template\u0026lt;class T1,class T2\u0026gt; void A\u0026lt;T1,T2\u0026gt;::h(){}ã€‚   C++å¼•ç”¨ å¼•ç”¨é™å®šç¬¦ï¼š \u0026amp; ä¸ \u0026amp;\u0026amp; ï¼Œæœ‰constçš„è¯ä¸¤ä¸ªé™å®šç¬¦å‡éœ€è¦åœ¨conståé¢\nç§»åŠ¨\nstd::move()\nè½¬å‘\nstd::forward()\nä¿æŒå®å‚çš„æºç±»å‹ä»¥åŠå€¼\næ ˆæˆ–è€…å †ä¸Šé¢åˆ›å»ºç±» åœ¨å †ä¸Šåˆ›å»ºç±»å¯¹è±¡ è®¾ç½®ææ„å‡½æ•°ä¸ºç§æœ‰ï¼š\n1 2 3 4 5 6 7  class HeapClass{ public: HeapClass(){} private: ~HeapClass(){} };   åœ¨æ ˆä¸Šåˆ›å»ºç±»å¯¹è±¡ é‡è½½newå’Œdeleteè¿ç®—ç¬¦ä¸ºç§æœ‰\n1 2 3 4 5 6 7 8 9  class StackClass{ public: StackClass(){} ~StackClass(){} private: void* operator new(size_t t){} void operator delete(void *ptr){} };   ä¸ä½¿ç”¨ç¬¬ä¸‰ä¸ªæ•°äº¤æ¢ä¸¤ä¸ªæ•° åŠ æ³• 1 2 3 4 5 6  void swap1(int \u0026amp;x,int \u0026amp;y) { x = x + y; y = x - y; x = x - y; }   å¼‚æˆ– 1 2 3 4 5 6  void swap2(int \u0026amp;x,int \u0026amp;y) { x = x ^ y; y = y ^ x; x = x ^ y; }   å›è°ƒå‡½æ•°ä¸ä»¿å‡½æ•° ä¸ºä»€ä¹ˆä½¿ç”¨ä»¿å‡½æ•°ï¼Ÿ\n è¿­ä»£å’Œè®¡ç®—é€»è¾‘åˆ†ç¦» å‚æ•°å¯è®¾ç½® æœ‰çŠ¶æ€ æ€§èƒ½(ç¼–è¯‘æ—¶æœŸå°±èƒ½å¤Ÿç¡®å®šè°ƒç”¨çš„å‡½æ•°)  å‡½æ•°æŒ‡é’ˆæœ‰ç¼ºç‚¹,æœ€é‡è¦çš„æ˜¯å®ƒæ— æ³•æŒæœ‰è‡ªå·±çš„çŠ¶æ€(æ‰€è°“å±€éƒ¨çŠ¶æ€,localstatesï¼‰ï¼Œä¹Ÿæ— æ³•è¾¾åˆ°ç»„ä»¶æŠ€æœ¯ä¸­çš„å¯é€‚é…æ€§ï¼ˆadaptabilityï¼‰â€”â€”ä¹Ÿå°±æ˜¯æ— æ³•å†å°†æŸäº›ä¿®é¥°æ¡ä»¶åŠ è¯¸äºå…¶ä¸Šè€Œæ”¹å˜å…¶çŠ¶æ€ã€‚\nä¸ºæ­¤ï¼ŒSTL ç®—æ³•çš„ç‰¹æ®Šç‰ˆæœ¬æ‰€æ¥å—çš„æ‰€è°“â€œæ¡ä»¶â€æˆ– â€œç­–ç•¥â€æˆ– â€œä¸€æ•´ç»„æ“ä½œâ€ï¼Œéƒ½ä»¥ä»¿å‡½æ•°å½¢å¼å‘ˆç°ã€‚æ‰€è°“ä»¿å‡½æ•°ï¼ˆfunctorï¼‰å°±æ˜¯ä½¿ç”¨èµ·æ¥åƒå‡½æ•°ä¸€æ ·çš„ä¸œè¥¿ã€‚å¦‚æœä½ é’ˆå¯¹æŸä¸ª class è¿›è¡Œ operator(ï¼‰é‡è½½ï¼Œå®ƒå°±æˆä¸ºä¸€ä¸ªä»¿å‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  #include \u0026lt;iostream\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; //å›è°ƒå‡½æ•° void call_back(char elem) { cout \u0026lt;\u0026lt; elem \u0026lt;\u0026lt; endl; } //ä»¿å‡½æ•° struct Functor { void operator() (char elem) { cout \u0026lt;\u0026lt; elem \u0026lt;\u0026lt; endl; } }; int main() { string strA = \u0026#34;hello\u0026#34;; string strB = \u0026#34;world\u0026#34;; for_each(strA.begin(),strA.end(),Functor()); cout\u0026lt;\u0026lt;\u0026#34;===========GAP===============\u0026#34;\u0026lt;\u0026lt;endl; for_each(strB.begin(),strB.end(),call_back); getchar(); return 0; }    ä»¿å‡½æ•°éœ€è¦ç»è¿‡3æ¬¡çš„æ„é€ å’Œææ„ã€‚\n ä»¿å‡½æ•°å’Œå›è°ƒå‡½æ•°åŒºåˆ«åœ¨äº:\n ä½¿ç”¨ä»¿å‡½æ•°å¯ä»¥å£°æ˜åœ¨ä¸šåŠ¡ç›¸å…³çš„ç±»å†…éƒ¨ ç¼©å°ä½œç”¨åŸŸ ä½¿ç”¨ä»¿å‡½æ•°å¯ä»¥ä½¿ç”¨ç±»çš„æˆå‘˜å±æ€§å’Œæˆå‘˜å‡½æ•° ä»¿å‡½æ•°æ˜¯ä¸€ä¸ªç±» å¯ä»¥ä½¿ç”¨é¢å‘å¯¹è±¡çš„å„ç§æœºåˆ¶(å°è£… ç»§æ‰¿ å¤šæ€) è‹¥ä½¿ç”¨å›è°ƒå‡½æ•° é‚£ä¹ˆåªèƒ½å£°æ˜ä¸ºæŸä¸ªç±»çš„é™æ€æˆå‘˜å‡½æ•°æˆ–å…¨å±€å‡½æ•°ï¼Œä½¿ç”¨ç±»å†…éƒ¨çš„èµ„æºéœ€è¦ç”¨ä¸€äº›æ‰‹æ®µä¼ å‚,æ²¡æœ‰ç›´æ¥ä½¿ç”¨æˆå‘˜å‡½æ•°ä¾¿æ·  å‚è€ƒï¼š\nhttps://my.oschina.net/mlgb/blog/290350\nC++ä»¿å‡½æ•°ï¼ˆfunctorï¼‰\nC++ææ„å‡½æ•°ä¸ºä»€ä¹ˆæ˜¯è™šå‡½æ•° åŸå› ï¼šåŸºç±»å¯¹è±¡çš„æŒ‡é’ˆæ“ä½œæ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œé˜²æ­¢ææ„å‡½æ•°åªè°ƒç”¨åŸºç±»çš„ï¼Œè€Œä¸è°ƒç”¨æ´¾ç”Ÿç±»çš„\nå‚è€ƒï¼š\n https://blog.csdn.net/zkangaroo/article/details/57000397  +++++++++++++++++\nå®ç°memcpyğŸ“ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  void *my_memcpy(void *dst, void *src, int n) { char *d = (char *)(dst); char *s = (char *)(src); if (d \u0026gt; s \u0026amp;\u0026amp; d \u0026lt; s + n) { for(int i = n-1;i \u0026gt;= 0;--i) *(d + i) = *(s + i); } else { for(int i = 0;i \u0026lt; n;++i) *(d + i) = *(s + i); } return dst; }   memmoveä¸memcpyçš„åŒºåˆ«ï¼Ÿ strcpyä¸mencpyçš„åŒºåˆ«? å¿«é€Ÿæ’åºâ² 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  int partition(vector\u0026lt;int\u0026gt; \u0026amp;nums, int start, int end) { int p = nums[start]; while (start \u0026lt; end) { while (nums[end] \u0026gt;= p \u0026amp;\u0026amp; start \u0026lt; end) --end; nums[start] = nums[end]; while (nums[start] \u0026lt;= p \u0026amp;\u0026amp; start \u0026lt; end) ++start; nums[end] = nums[start]; } nums[start] = p; return start; } void quick_sort(vector\u0026lt;int\u0026gt; \u0026amp;nums, int left, int right) { if (left \u0026lt; right) { int p = partition(nums, left, right); quick_sort(nums, left, p - 1); quick_sort(nums, p + 1, right); } }   å †æ’åºğŸ³ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  void heap_sort(vector\u0026lt;int\u0026gt; \u0026amp;nums, int n) { if (n == 1) return; for (int i = n / 2 - 1; i \u0026gt;= 0; --i) { int left = 2 * i + 1, right = 2 * i + 2; int imax = i; if (left \u0026lt; n \u0026amp;\u0026amp; nums[left] \u0026gt; nums[imax]) imax = left; if (right \u0026lt; n \u0026amp;\u0026amp; nums[right] \u0026gt; nums[imax]) imax = right; if (imax != i) swap(nums[i], nums[imax]); } swap(nums[0], nums[n - 1]); heap_sort(nums, n - 1); }   ğŸ‘ å †TopK C++å®ç°æœ€å¤§å †å’Œæœ€å°å †\næœ€å°å † æ„å»ºã€æ’å…¥ã€åˆ é™¤çš„è¿‡ç¨‹å›¾è§£\n#Network\nå‚è€ƒï¼š\n æå®šè®¡ç®—æœºç½‘ç»œé¢è¯•ï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº†ï¼ˆè¡¥å……ç‰ˆï¼‰  å¤šé—®ä¸ºä»€ä¹ˆï¼ ğŸš ç½‘ç»œåˆ†å±‚ OSIä¸TCP/IPåˆ†å±‚æ¨¡å‹\nä¸ºä»€ä¹ˆç½‘ç»œéœ€è¦åˆ†å±‚ï¼Ÿ\n  å¤§éƒ¨åˆ†è½¯ä»¶ç³»ç»Ÿéƒ½æ˜¯åˆ†å±‚æ¶æ„çš„ï¼Œä¸ºäº†å·¥ç¨‹ä¸Šå®ç°/è°ƒè¯•/ç»´æŠ¤æ–¹ä¾¿ã€‚ç½‘ç»œç³»ç»Ÿåˆ†å¾—æ›´æ˜æ˜¾ä¸€ç‚¹ï¼Œå› ä¸ºå…¶ç³»ç»Ÿè®¾è®¡å†™æˆäº†åè®®ã€‚\n  æŠŠTCP/IPå±‚æ¬¡åŒ–æ˜¯æœ‰å¥½å¤„çš„ã€‚æ¯”å¦‚ï¼Œå¦‚æœäº’è”ç½‘åªç”±ä¸€ä¸ªåè®®ç»Ÿç­¹ï¼ŒæŸä¸ªåœ°æ–¹éœ€è¦æ”¹å˜è®¾è®¡æ—¶ï¼Œå°±å¿…é¡»æŠŠæ‰€æœ‰éƒ¨åˆ†æ•´ä½“æ›¿æ¢æ‰ã€‚è€Œåˆ†å±‚ä¹‹ååªéœ€æŠŠå˜åŠ¨çš„å±‚æ›¿æ¢æ‰å³å¯ã€‚æŠŠå„å±‚ä¹‹é—´çš„æ¥å£éƒ¨åˆ†è§„åˆ’å¥½ä¹‹åï¼Œæ¯ä¸ªå±‚æ¬¡å†…éƒ¨çš„è®¾è®¡å°±èƒ½å¤Ÿè‡ªç”±æ”¹åŠ¨äº†ã€‚\n  åˆ†å±‚æ¨¡å‹ä¼ è¾“è¿‡ç¨‹\nå‘é€ç«¯åœ¨å±‚ä¸å±‚ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶å¿…å®šä¼šè¢«æ‰“ä¸Šä¸€ä¸ªè¯¥å±‚æ‰€å±çš„é¦–éƒ¨ä¿¡æ¯ã€‚åä¹‹ï¼Œæ¥æ”¶ç«¯åœ¨å±‚ä¸å±‚ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶ä¼šæŠŠå¯¹åº”çš„é¦–éƒ¨æ¶ˆå»ã€‚\nå‚è€ƒï¼šä¸ºä»€ä¹ˆç½‘ç»œåè®®é€‰æ‹©åˆ†å±‚è®¾è®¡ï¼Ÿè¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ\nğŸ¥‰ ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ ä¸ºä»€ä¹ˆTCPå®¢æˆ·ç«¯æœ€åè¿˜è¦å‘é€ä¸€æ¬¡ç¡®è®¤å‘¢ï¼Ÿ\n  ä¸ºäº†é˜²æ­¢ å·²å¤±æ•ˆçš„é“¾æ¥è¯·æ±‚æŠ¥æ–‡çªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚\nå®¢æˆ·ç«¯å‘å‡ºçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡å¹¶æœªä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œèŠ‚ç‚¹é•¿æ—¶é—´æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°é“¾æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾Serverã€‚è¿™æ˜¯ï¼ŒServerè¯¯ä»¥ä¸ºè¿™æ˜¯Clientå‘å‡ºçš„ä¸€ä¸ªæ–°çš„é“¾æ¥è¯·æ±‚ï¼Œäºæ˜¯å°±å‘å®¢æˆ·ç«¯å‘é€ç¡®è®¤æ•°æ®åŒ…ï¼ŒåŒæ„å»ºç«‹é“¾æ¥ã€‚è‹¥ä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦Serverå‘å‡ºç¡®è®¤æ•°æ®åŒ…ï¼Œæ–°çš„é“¾æ¥å°±å»ºç«‹äº†ã€‚ç”±äºclientæ­¤æ—¶å¹¶æœªå‘å‡ºå»ºç«‹é“¾æ¥çš„è¯·æ±‚ï¼Œæ‰€ä»¥å…¶ä¸ä¼šç†ç¬Serverçš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¸Serveré€šä¿¡ï¼›è€Œè¿™æ—¶Serverä¸€ç›´åœ¨ç­‰å¾…Clientçš„è¯·æ±‚ï¼Œè¿™æ ·Serverå°±ç™½ç™½æµªè´¹äº†ä¸€å®šçš„èµ„æºã€‚è‹¥é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºServerç«¯æ²¡æœ‰æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„ç¡®è®¤ï¼Œåˆ™å°±ä¼šçŸ¥é“Clientå¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¯·æ±‚ï¼Œå°±ä¸ä¼šå»ºç«‹é“¾æ¥ã€‚\nå¦‚æœé‡‡ç”¨çš„æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå°±ç®—æ˜¯é‚£ä¸€æ¬¡å¤±æ•ˆçš„æŠ¥æ–‡ä¼ é€è¿‡æ¥äº†ï¼ŒæœåŠ¡ç«¯æ¥å—åˆ°äº†é‚£æ¡å¤±æ•ˆæŠ¥æ–‡å¹¶ä¸”å›å¤äº†ç¡®è®¤æŠ¥æ–‡ï¼Œä½†æ˜¯å®¢æˆ·ç«¯ä¸ä¼šå†æ¬¡å‘å‡ºç¡®è®¤ã€‚ç”±äºæœåŠ¡å™¨æ”¶ä¸åˆ°ç¡®è®¤ï¼Œå°±çŸ¥é“å®¢æˆ·ç«¯å¹¶æ²¡æœ‰è¯·æ±‚è¿æ¥ã€‚\n  å› ä¸ºåŒæ–¹éƒ½éœ€è¦ç¡®è®¤å¯¹æ–¹æ”¶åˆ°äº†è‡ªå·±å‘é€çš„åºåˆ—å·ï¼Œç¡®è®¤è¿‡ç¨‹æœ€å°‘è¦è¿›è¡Œä¸‰æ¬¡é€šä¿¡ã€‚\nå‚è€ƒï¼šçŸ¥ä¹ . TCP ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œä¸æ˜¯ä¸¤æ¬¡æˆ–å››æ¬¡ï¼Ÿ\n  å› ä¸ºä¿¡é“ä¸å¯é ï¼Œè€Œ TCP æƒ³åœ¨ä¸å¯é ä¿¡é“ä¸Šå»ºç«‹å¯é åœ°ä¼ è¾“ï¼Œé‚£ä¹ˆä¸‰æ¬¡é€šä¿¡æ˜¯ç†è®ºä¸Šçš„æœ€å°å€¼ã€‚ï¼ˆè€Œ UDP åˆ™ä¸éœ€å»ºç«‹å¯é ä¼ è¾“ï¼Œå› æ­¤ UDPä¸éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ã€‚ï¼‰\nå‚è€ƒï¼šGoogle Groups . TCP å»ºç«‹è¿æ¥ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ{æŠ€æœ¯}{ç½‘ç»œé€šä¿¡}\n   TCPä¼ äº† SYN,ä¸ºå•¥è¿˜è¦ä¼  ACKï¼Ÿ\nåŒæ–¹é€šä¿¡æ— è¯¯å¿…é¡»æ˜¯ä¸¤è€…äº’ç›¸å‘é€ä¿¡æ¯éƒ½æ— è¯¯ã€‚ä¼ äº† SYNï¼Œè¯æ˜å‘é€æ–¹åˆ°æ¥æ”¶æ–¹çš„é€šé“æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æ¥æ”¶æ–¹åˆ°å‘é€æ–¹çš„é€šé“è¿˜éœ€è¦ ACK ä¿¡å·æ¥è¿›è¡ŒéªŒè¯ã€‚\n âœ‹ ä¸ºä»€ä¹ˆæ˜¯å››æ¬¡æŒ¥æ‰‹ï¼Ÿ   è¿™ä¸ªæ˜¯ä¸€ä¸ªå…¨åŒå·¥çš„è¿æ¥ï¼Œä¸¤è¾¹éƒ½éœ€è¦æ–­å¼€ï¼Œæ¯æ¬¡çš„æ–­å¼€éƒ½éœ€è¦ä¸¤æ¬¡çš„æ¡æ‰‹ã€‚\nå»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œ æœåŠ¡å™¨åœ¨LISTENçŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°å»ºç«‹è¿æ¥è¯·æ±‚çš„SYNæŠ¥æ–‡åï¼ŒæŠŠACKå’ŒSYNæ”¾åœ¨ä¸€ä¸ªæŠ¥æ–‡é‡Œå‘é€ç»™å®¢æˆ·ç«¯ã€‚\nè€Œå…³é—­è¿æ¥æ—¶ï¼ŒæœåŠ¡å™¨æ”¶åˆ°å¯¹æ–¹çš„FINæŠ¥æ–‡æ—¶ï¼Œä»…ä»…è¡¨ç¤ºå¯¹æ–¹ä¸å†å‘é€æ•°æ®äº†ä½†æ˜¯è¿˜èƒ½æ¥æ”¶æ•°æ®ï¼Œè€Œè‡ªå·±ä¹Ÿæœªå¿…å…¨éƒ¨æ•°æ®éƒ½å‘é€ç»™å¯¹æ–¹äº†ï¼Œæ‰€ä»¥å·±æ–¹å¯ä»¥ç«‹å³å…³é—­ï¼Œä¹Ÿå¯ä»¥å‘é€ä¸€äº›æ•°æ®ç»™å¯¹æ–¹åï¼Œå†å‘é€FINæŠ¥æ–‡ç»™å¯¹æ–¹æ¥è¡¨ç¤ºåŒæ„ç°åœ¨å…³é—­è¿æ¥ï¼Œå› æ­¤ï¼Œå·±æ–¹ACKå’ŒFINä¸€èˆ¬éƒ½ä¼šåˆ†å¼€å‘é€ï¼Œä»è€Œå¯¼è‡´å¤šäº†ä¸€æ¬¡ã€‚å³å¦ä¸€æ–¹å¹¶ä¸éœ€è¦ä¹Ÿæ€¥ç€æ–­å¼€ï¼Œè¿˜å¯ä»¥ç»§ç»­å‘é€æ¶ˆæ¯ã€‚\n  æœåŠ¡å™¨å¯èƒ½è¿˜æœ‰æ•°æ®éœ€è¦ä¼ è¾“ç»™å®¢æˆ·ç«¯\nå› ä¸ºå®¢æˆ·ç«¯è¯·æ±‚é‡Šæ”¾æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½è¿˜æœ‰æ•°æ®éœ€è¦ä¼ è¾“ç»™å®¢æˆ·ç«¯ï¼Œå› æ­¤æœåŠ¡ç«¯è¦å…ˆå“åº”å®¢æˆ·ç«¯ FIN è¯·æ±‚ï¼ˆæœåŠ¡ç«¯å‘é€ ACKï¼‰ï¼Œç„¶åæ•°æ®ä¼ è¾“ï¼Œä¼ è¾“å®Œæˆåï¼ŒæœåŠ¡ç«¯å†æå‡º FIN è¯·æ±‚ï¼ˆæœåŠ¡ç«¯å‘é€ FINï¼‰ï¼›è€Œè¿æ¥æ—¶åˆ™æ²¡æœ‰ä¸­é—´çš„æ•°æ®ä¼ è¾“ï¼Œå› æ­¤è¿æ¥æ—¶å¯ä»¥ ACK å’Œ SYN ä¸€èµ·å‘é€ã€‚\n  ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯æœ€åè¿˜è¦ç­‰å¾…2MSLï¼Ÿ\nMSLï¼ˆMaximum Segment Lifetimeï¼‰ï¼ŒTCPå…è®¸ä¸åŒçš„å®ç°å¯ä»¥è®¾ç½®ä¸åŒçš„MSLå€¼ã€‚\nç¬¬ä¸€ï¼Œä¿è¯å®¢æˆ·ç«¯å‘é€çš„æœ€åä¸€ä¸ªACKæŠ¥æ–‡èƒ½å¤Ÿåˆ°è¾¾æœåŠ¡å™¨ï¼Œå› ä¸ºè¿™ä¸ªACKæŠ¥æ–‡å¯èƒ½ä¸¢å¤±ï¼Œç«™åœ¨æœåŠ¡å™¨çš„è§’åº¦çœ‹æ¥ï¼Œæˆ‘å·²ç»å‘é€äº†FIN+ACKæŠ¥æ–‡è¯·æ±‚æ–­å¼€äº†ï¼Œå®¢æˆ·ç«¯è¿˜æ²¡æœ‰ç»™æˆ‘å›åº”ï¼Œåº”è¯¥æ˜¯æˆ‘å‘é€çš„è¯·æ±‚æ–­å¼€æŠ¥æ–‡å®ƒæ²¡æœ‰æ”¶åˆ°ï¼Œäºæ˜¯æœåŠ¡å™¨åˆä¼šé‡æ–°å‘é€ä¸€æ¬¡ï¼Œè€Œå®¢æˆ·ç«¯å°±èƒ½åœ¨è¿™ä¸ª2MSLæ—¶é—´æ®µå†…æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„æŠ¥æ–‡ï¼Œæ¥ç€ç»™å‡ºå›åº”æŠ¥æ–‡ï¼Œå¹¶ä¸”ä¼šé‡å¯2MSLè®¡æ—¶å™¨ã€‚\nç¬¬äºŒï¼Œé˜²æ­¢ç±»ä¼¼ä¸â€œä¸‰æ¬¡æ¡æ‰‹â€ä¸­æåˆ°äº†çš„â€œå·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€å‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚å®¢æˆ·ç«¯å‘é€å®Œæœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡åï¼Œåœ¨è¿™ä¸ª2MSLæ—¶é—´ä¸­ï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·æ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°æ—§è¿æ¥çš„è¯·æ±‚æŠ¥æ–‡ã€‚\nå‚è€ƒï¼š\n ä¸¤å¼ åŠ¨å›¾-å½»åº•æ˜ç™½TCPçš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹  ğŸ‘ å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ TCPè¿˜è®¾æœ‰ä¸€ä¸ªä¿æ´»è®¡æ—¶å™¨ï¼Œæ˜¾ç„¶ï¼Œå®¢æˆ·ç«¯å¦‚æœå‡ºç°æ•…éšœï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¸€ç›´ç­‰ä¸‹å»ï¼Œç™½ç™½æµªè´¹èµ„æºã€‚æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·ç«¯çš„è¯·æ±‚åéƒ½ä¼šé‡æ–°å¤ä½è¿™ä¸ªè®¡æ—¶å™¨ï¼Œæ—¶é—´é€šå¸¸æ˜¯è®¾ç½®ä¸º2å°æ—¶ï¼Œè‹¥ä¸¤å°æ—¶è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ä»»ä½•æ•°æ®ï¼ŒæœåŠ¡å™¨å°±ä¼šå‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µï¼Œä»¥åæ¯éš”75ç§’å‘é€ä¸€æ¬¡ã€‚è‹¥ä¸€è¿å‘é€10ä¸ªæ¢æµ‹æŠ¥æ–‡ä»ç„¶æ²¡ååº”ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºäº†æ•…éšœï¼Œæ¥ç€å°±å…³é—­è¿æ¥ã€‚\nğŸ“‰ â€‹GET å’Œ POSTçš„åŒºåˆ«  GETç”¨æ¥è·å–æ•°æ®ï¼ŒPOSTç”¨æ¥æäº¤æ•°æ® GETè¯·æ±‚é€šè¿‡URLï¼ˆè¯·æ±‚è¡Œï¼‰æäº¤æ•°æ®ï¼Œåœ¨URLä¸­å¯ä»¥çœ‹åˆ°æ‰€ä¼ å‚æ•°ã€‚POSTé€šè¿‡â€œè¯·æ±‚ä½“â€ä¼ é€’æ•°æ®ï¼Œå‚æ•°ä¸ä¼šåœ¨urlä¸­æ˜¾ç¤º GETè¯·æ±‚æäº¤çš„æ•°æ®æœ‰é•¿åº¦é™åˆ¶ï¼ŒPOSTè¯·æ±‚æ²¡æœ‰é™åˆ¶ã€‚ GETè¯·æ±‚è¿”å›çš„å†…å®¹å¯ä»¥è¢«æµè§ˆå™¨ç¼“å­˜èµ·æ¥ã€‚è€Œæ¯æ¬¡æäº¤çš„POSTï¼Œæµè§ˆå™¨åœ¨ä½ æŒ‰ä¸‹F5çš„æ—¶å€™ä¼šè·³å‡ºç¡®è®¤æ¡†ï¼Œæµè§ˆå™¨ä¸ä¼šç¼“å­˜POSTè¯·æ±‚è¿”å›çš„å†…å®¹ã€‚ GETå¯¹æ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼ŒPOSTä¸»è¦å¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹ï¼ç®€å•è¯´ï¼ŒGETæ˜¯åªè¯»ï¼ŒPOSTæ˜¯å†™ã€‚ get è¯·æ±‚çš„urlæ˜¯åœ¨æœåŠ¡å™¨ä¸Šæœ‰æ—¥å¿—è®°å½•ï¼Œåœ¨æµè§ˆå™¨ä¹Ÿèƒ½æŸ¥åˆ°å†å²è®°å½•ï¼Œä½†æ˜¯postè¯·æ±‚çš„å‚æ•°éƒ½åœ¨bodyé‡Œé¢ï¼Œæµè§ˆå™¨å†å²è®°å½•ä¸åˆ°   å¦‚æœæ˜¯æŒ‡ç½‘ç»œå®‰å…¨ï¼Œé‚£ä¸¤è€…ä¸€æ ·ã€‚\nå¦‚æœè€ƒè™‘åˆ°æŸäº›æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„é»˜è®¤é…ç½®å’Œé»˜è®¤ä½¿ç”¨æ–¹å¼ï¼Œé‚£ä¹ˆPOSTåœ¨å¾ˆå¤šæ—¶å€™æ¯”GETå®‰å…¨ã€‚\nè€Œåœ¨HTTPçš„å®šä¹‰ä¸­ï¼ŒGETè¢«ç§°ä¸ºå®‰å…¨æ–¹æ³•ï¼ŒPOSTå´ä¸æ˜¯.\n æ„Ÿè§‰å¯¹äºæœåŠ¡å™¨æ›´å®‰å…¨çš„æ˜¯Getï¼Œå¯¹äºå®¢æˆ·ç«¯æ›´å®‰å…¨çš„æ˜¯Postã€‚\næœ¬è´¨ä¸Šï¼š\né¦–å…ˆgetå’Œpoståœ¨æœ¬è´¨ä¸Šéƒ½æ˜¯tcpé“¾æ¥ï¼Œä½†ç”±äºhttpåè®®å’Œæµè§ˆå™¨æˆ–è€…æœåŠ¡å™¨çš„é™åˆ¶ï¼Œä»è€Œä½¿å®ƒä»¬åœ¨åº”ç”¨è¿‡ç¨‹ä¸­äº§ç”Ÿäº†å·®åˆ«ï¼Œä½†æ˜¯å®ƒä»¬ä¸­è¿˜æœ‰ä¸€ä¸ªè¾ƒå¤§çš„åŒºåˆ«ï¼šgetåœ¨è¯·æ±‚æ—¶å‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œä¼šå°†headerå’Œdataä¸€èµ·å‘é€è¿‡å»ï¼Œè€Œpostä¼šäº§ç”Ÿä¸¤ä¸ªæ•°æ®åŒ…å…ˆå‘é€headerï¼ŒæœåŠ¡å™¨è¿”å›100ï¼Œç„¶ååœ¨å‘é€dataï¼ŒæœåŠ¡å™¨è¿”å›200\n æ‰€ä»¥å½“ä½ ä¸€å±‚ä¸€å±‚çš„æŠŠgetå’Œpostå‰–æåˆ°åº•ï¼Œä½ ä¼šå‘ç°ä»–ä»¬çš„æœ¬è´¨å°±æ˜¯tcpè¿æ¥ï¼Œæ²¡æœ‰å•¥åŒºåˆ«ï¼Œåªæ˜¯ç”±äºhttpåè®®è§„å®šå’Œæµè§ˆå™¨æˆ–è€…æœåŠ¡å™¨çš„é™åˆ¶ï¼Œå¯¼è‡´ä»–ä»¬åœ¨åº”ç”¨è¿‡ç¨‹ä¸­ä½“ç°å½¢å¼ä¸åŒã€‚\n RFCï¼š\n1.safeï¼ˆå®‰å…¨ï¼‰\n è¿™é‡Œçš„å®‰å…¨å’Œé€šå¸¸æ‰€ç†è§£çš„å®‰å…¨æ„ä¹‰ä¸åŒï¼Œå°±å¥½æ¯”å¦‚æœä¸€ä¸ªè¯·æ±‚çš„è¯­ä¹‰æœ¬è´¨ä¸Šå°±æ˜¯è·å–æ•°æ®ï¼ˆåªè¯»ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯·æ±‚å°±æ˜¯å®‰å…¨çš„ã€‚å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·çš„è¯·æ±‚å¦‚æœæ²¡æœ‰å¼•èµ·æœåŠ¡å™¨ç«¯ä»»ä½•çš„çŠ¶æ€å˜åŒ–ï¼Œé‚£ä¹ˆä»–å°±æ˜¯å®‰å…¨çš„è€Œpostè¯·æ±‚æ¥æäº¤æ•°æ®å¿…ç„¶ä¼šæ˜¯æœåŠ¡å™¨å‘ç”Ÿç›¸åº”çš„å˜åŒ–ã€‚ä»è¿™ä¸ªç»´åº¦æ¥çœ‹ï¼Œgetè¯·æ±‚ç›¸å¯¹æœåŠ¡å™¨è€Œè¨€ï¼Œæ˜¯å®‰å…¨çš„ï¼Œpoståˆ™ä¸å®‰å…¨çš„ã€‚\n ldempotendï¼ˆå¹‚ç­‰ï¼‰\n **å¹‚ç­‰é€šä¿—çš„æ¥è®²å°±æ˜¯æŒ‡åŒä¸€ä¸ªè¯·æ±‚æ‰§è¡Œå¤šæ¬¡å’Œä»…æ‰§è¡Œä¸€æ¬¡çš„æ•ˆæœå®Œå…¨ç›¸ç­‰ã€‚**è¿™é‡Œæ¥æ‰¯å‡ºå¹‚ç­‰ä¸»è¦æ˜¯ä¸ºäº†å¤„ç†åŒä¸€ä¸ªè¯·æ±‚é‡å¤å‘é€çš„æƒ…å†µï¼Œå‡å¦‚åœ¨è¯·æ±‚å“åº”ä¹‹å‰å¤±å»è¿æ¥ï¼Œå¦‚æœè¿™ä¸ªè¯·æ±‚æ—¶å¹‚ç­‰çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ”¾å¿ƒçš„é‡å‘ä¸€æ¬¡è¯·æ±‚ã€‚æ‰€ä»¥å¯ä»¥å¾—å‡ºgetè¯·æ±‚æ—¶å¹‚ç­‰çš„ï¼Œå¯ä»¥é‡å¤å‘é€è¯·æ±‚ï¼Œpostè¯·æ±‚æ—¶ä¸å¹‚ç­‰çš„ï¼Œé‡å¤è¯·æ±‚å¯èƒ½ä¼šå‘ç”Ÿæ— æ³•é¢„çŸ¥çš„åæœã€‚\n cacheableï¼ˆå¯ç¼“å­˜æ€§ï¼‰\n é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸€ä¸ªè¯·æ±‚æ˜¯å¦å¯ä»¥è¢«ç¼“å­˜ï¼Œç»å¤§å¤šæ•°éƒ¨åˆ†ï¼Œpostéƒ½æ˜¯ä¸å¯ç¼“å­˜çš„ï¼ˆæŸäº›æµè§ˆå™¨å¯èƒ½æ”¯æŒpostç¼“å­˜ï¼‰ï¼Œä½†getæ˜¯å¯ä»¥ç¼“å­˜çš„ã€‚\n å‹‰å¼ºç†è§£ä¸€ä¸‹å¤§æ¦‚å°±æ˜¯ï¼š\n getæ˜¯è¯·æ±‚è·å–æŒ‡å®šèµ„æºï¼Œgetæ–¹æ³•æ—¶å®‰å…¨ã€å¹‚ç­‰ã€å¯ç¼“å­˜çš„ï¼Œgetæ–¹æ³•çš„æŠ¥æ–‡ä¸»ä½“æ²¡æœ‰ä»»ä½•è¯­ä¹‰ã€‚\n  postæ˜¯æ ¹æ®æŠ¥æ–‡ä¸»ä½“æ¥å¯¹æŒ‡å®šèµ„æºåšå‡ºå¤„ç†ï¼Œpostä¸å®‰å…¨ï¼Œä¸å¹‚ç­‰ï¼Œä¸å¯ç¼“å­˜ï¼ˆå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼‰ã€‚\n å‚è€ƒï¼š\n éƒ½ 2019 å¹´äº†ï¼Œè¿˜é—® GET å’Œ POST çš„åŒºåˆ« POST æ–¹æ³•æ¯” GET æ–¹æ³•æ›´å®‰å…¨å—? ä¸ºä»€ä¹ˆ? getå’Œpostçš„åŒºåˆ«ï¼Ÿ  ğŸ‚ HTTPæŠ¥æ–‡ è¯·æ±‚æŠ¥æ–‡ HTTP è¯·æ±‚æŠ¥æ–‡ç”±3éƒ¨åˆ†ç»„æˆ(è¯·æ±‚è¡Œ+è¯·æ±‚å¤´+è¯·æ±‚ä½“)\nè¯·æ±‚è¡ŒåŒ…æ‹¬ï¼šè¯·æ±‚æ–¹æ³•ã€è¯·æ±‚URLã€HTTPåè®®åŠç‰ˆæœ¬ï¼š\nGETå’ŒPOSTæ˜¯æœ€å¸¸è§çš„HTTPæ–¹æ³•,åˆæ¬¡ä»¥å¤–è¿˜åŒ…æ‹¬ DELETEã€HEADã€OPTIONSã€PUTã€TRACEï¼Œä¸è¿‡ç°åœ¨å¤§éƒ¨åˆ†çš„æµè§ˆå™¨åªæ”¯æŒGETå’ŒPOST\nè¯·æ±‚å¯¹åº”çš„URLåœ°å€,ä»–å’ŒæŠ¥æ–‡å¤´çš„Hostå±æ€§,ç»„åˆèµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚URL\næŠ¥æ–‡å¤´æ˜¯ä¸€äº›å‚æ•°ä¿¡æ¯ï¼š\næœ‰è‹¥å¹²ä¸ªå±æ€§,å½¢å¼ä¸ºkey:val,æœåŠ¡ç«¯æ®æ­¤è·å–å®¢æˆ·ç«¯ä¿¡æ¯\næŠ¥æ–‡ä½“æ˜¯å…·ä½“ä¼ è¾“çš„å†…å®¹ã€‚\nå“åº”æŠ¥æ–‡ å“åº”æŠ¥æ–‡ä¸è¯·æ±‚æŠ¥æ–‡ä¸€æ ·,ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ(å“åº”è¡Œ,å“åº”å¤´,å“åº”ä½“)\nå‚è€ƒï¼šHTTPè¯·æ±‚å¤´å’Œå“åº”å¤´è¯¦è§£\nğŸš‰ HTTPçŠ¶æ€ç ï¼š  1xxï¼šè¡¨ç¤ºé€šçŸ¥ä¿¡æ¯ï¼Œå¦‚è¯·æ±‚æ”¶åˆ°äº†æˆ–æ­£åœ¨è¿›è¡Œå¤„ç†  100 Continueï¼šç»§ç»­ï¼Œå®¢æˆ·ç«¯åº”ç»§ç»­å…¶è¯·æ±‚ 101 Switching Protocols åˆ‡æ¢åè®®ã€‚æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ‡æ¢åè®®ã€‚åªèƒ½åˆ‡æ¢åˆ°æ›´é«˜çº§çš„åè®®ï¼Œä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ° HTTP çš„æ–°ç‰ˆæœ¬åè®®   2xxï¼šè¡¨ç¤ºæˆåŠŸï¼Œå¦‚æ¥æ”¶æˆ–çŸ¥é“äº†  200 OK: è¯·æ±‚æˆåŠŸ   3xxï¼šè¡¨ç¤ºé‡å®šå‘ï¼Œå¦‚è¦å®Œæˆè¯·æ±‚è¿˜å¿…é¡»é‡‡å–è¿›ä¸€æ­¥çš„è¡ŒåŠ¨  301 Moved Permanently: æ°¸ä¹…ç§»åŠ¨ã€‚è¯·æ±‚çš„èµ„æºå·²è¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°æ–° URLï¼Œè¿”å›ä¿¡æ¯ä¼šåŒ…æ‹¬æ–°çš„ URLï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®šå‘åˆ°æ–° URLã€‚ä»Šåä»»ä½•æ–°çš„è¯·æ±‚éƒ½åº”ä½¿ç”¨æ–°çš„ URL ä»£æ›¿   4xxï¼šè¡¨ç¤ºå®¢æˆ·çš„å·®é”™ï¼Œå¦‚è¯·æ±‚ä¸­æœ‰é”™è¯¯çš„è¯­æ³•æˆ–ä¸èƒ½å®Œæˆ  400 Bad Request: å®¢æˆ·ç«¯è¯·æ±‚çš„è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£ 401 Unauthorized: è¯·æ±‚è¦æ±‚ç”¨æˆ·çš„èº«ä»½è®¤è¯ 403 Forbidden: æœåŠ¡å™¨ç†è§£è¯·æ±‚å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œæ­¤è¯·æ±‚ï¼ˆæƒé™ä¸å¤Ÿï¼‰ 404 Not Found: æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚é€šè¿‡æ­¤ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯è®¾ç½® â€œæ‚¨æ‰€è¯·æ±‚çš„èµ„æºæ— æ³•æ‰¾åˆ°â€ çš„ä¸ªæ€§é¡µé¢ 408 Request Timeout: æœåŠ¡å™¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ—¶é—´è¿‡é•¿ï¼Œè¶…æ—¶   5xxï¼šè¡¨ç¤ºæœåŠ¡å™¨çš„å·®é”™ï¼Œå¦‚æœåŠ¡å™¨å¤±æ•ˆæ— æ³•å®Œæˆè¯·æ±‚  500 Internal Server Error: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ 503 Service Unavailable: ç”±äºè¶…è½½æˆ–ç³»ç»Ÿç»´æŠ¤ï¼ŒæœåŠ¡å™¨æš‚æ—¶çš„æ— æ³•å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å»¶æ—¶çš„é•¿åº¦å¯åŒ…å«åœ¨æœåŠ¡å™¨çš„ Retry-After å¤´ä¿¡æ¯ä¸­ 504 Gateway Timeout: å……å½“ç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼ŒæœªåŠæ—¶ä»è¿œç«¯æœåŠ¡å™¨è·å–è¯·æ±‚    âœ‹ HTTPçš„ä¸»è¦æ–¹æ³•    æ–¹æ³• æ„ä¹‰     OPTIONS è¯·æ±‚ä¸€äº›é€‰é¡¹ä¿¡æ¯ï¼Œå…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½   GET è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“   HEAD ç±»ä¼¼äº get è¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´   POST å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POSTè¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹   PUT ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹   DELETE è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢   TRACE å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­      ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯æŸ¥è¯¢HTTPæœåŠ¡å™¨ç«¯æ”¯æŒçš„HTTPæ–¹æ³•ç§ç±»ã€‚\n  ğŸ’« HTTP2.0ä¸HTTP1.0çš„åŒºåˆ« ğŸ“¥ ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ SQLæ³¨å…¥å°±æ˜¯é€šè¿‡æŠŠSQLå‘½ä»¤æ’å…¥åˆ°Webè¡¨å•æäº¤æˆ–è¾“å…¥åŸŸåæˆ–é¡µé¢è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆè¾¾åˆ°æ¬ºéª—æœåŠ¡å™¨æ‰§è¡Œæ¶æ„çš„SQLå‘½ä»¤ã€‚\nSQLæ³¨å…¥çš„æ€è·¯ï¼š\n SQLæ³¨å…¥çš„ä½ç½® åˆ¤æ–­æœåŠ¡å™¨ç±»å‹å’Œåå°æ•°æ®ç±»å‹ é’ˆå¯¹ä¸é€šçš„æœåŠ¡å™¨å’Œæ•°æ®åº“ç‰¹ç‚¹è¿›è¡ŒSQLæ³¨å…¥æ”»å‡»  åº”å¯¹çš„æ–¹æ³•ï¼š\n å‚æ•°ç»‘å®šä½¿ç”¨é¢„ç¼–è¯‘æ‰‹æ®µï¼Œç»‘å®šå‚æ•°æ˜¯æœ€å¥½çš„é˜²SQLæ³¨å…¥çš„æ–¹æ³•ã€‚ç›®å‰è®¸å¤šçš„ORMæ¡†æ¶åŠJDBCç­‰éƒ½å®ç°äº†SQLé¢„ç¼–è¯‘å’Œå‚æ•°ç»‘å®šåŠŸèƒ½ï¼Œæ”»å‡»è€…çš„æ¶æ„SQLä¼šè¢«å½“åšSQLçš„å‚æ•°è€Œä¸æ˜¯SQLå‘½ä»¤è¢«æ‰§è¡Œã€‚åœ¨mybatisçš„mapperæ–‡ä»¶ä¸­ï¼Œå¯¹äºä¼ é€’çš„å‚æ•°æˆ‘ä»¬ä¸€èˆ¬æ˜¯ä½¿ç”¨#å’Œ$æ¥è·å–å‚æ•°å€¼ã€‚å½“ä½¿ç”¨#æ—¶ï¼Œå˜é‡æ˜¯å ä½ç¬¦ï¼Œå°±æ˜¯ä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨javajdbcçš„PrepareStatementæ—¶çš„å ä½ç¬¦ï¼Œæ‰€æœ‰å¯ä»¥é˜²æ­¢sqlæ³¨å…¥ï¼›å½“ä½¿ç”¨â€‹$æ—¶ï¼Œå˜é‡å°±æ˜¯ç›´æ¥è¿½åŠ åœ¨sqlä¸­ï¼Œä¸€èˆ¬ä¼šæœ‰sqlæ³¨å…¥é—®é¢˜ã€‚ ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ä¼ å…¥çš„å‚æ•°  ğŸª CookieæŠ€æœ¯ Cookie é€šè¿‡åœ¨è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å†™å…¥ Cookie ä¿¡æ¯æ¥æ§åˆ¶å®¢æˆ·ç«¯çš„çŠ¶æ€ã€‚\nç›¸å½“äºï¼Œåœ¨å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¼šä¸‹å‘ä¸€ä¸ªè£…æœ‰å®¢æˆ·ä¿¡æ¯çš„ã€Œå°è´´çº¸ã€ï¼Œåç»­å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ï¼Œå¸¦ä¸Šã€Œå°è´´çº¸ã€ï¼ŒæœåŠ¡å™¨å°±èƒ½è®¤å¾—äº†äº†ã€‚\n  æ²¡æœ‰Cookieä¿¡æ¯çŠ¶æ€ä¸‹çš„è¯·æ±‚\n  ç¬¬2æ¬¡ä»¥åï¼ˆå­˜æœ‰Cookieä¿¡æ¯çŠ¶æ€ï¼‰çš„è¯·æ±‚\n  åº•å±‚åŸç†\n  WEBæœåŠ¡å™¨é€šè¿‡åœ¨HTTPå“åº”æ¶ˆæ¯ä¸­å¢åŠ Set-Cookieå“åº”å¤´å­—æ®µå°†Cookieä¿¡æ¯å‘é€ç»™æµè§ˆå™¨ï¼Œ\n  æµè§ˆå™¨åˆ™é€šè¿‡åœ¨HTTPè¯·æ±‚æ¶ˆæ¯ä¸­å¢åŠ Cookieè¯·æ±‚å¤´å­—æ®µå°†Cookieå›ä¼ ç»™WEBæœåŠ¡å™¨ã€‚\n  Cookieçš„ä¼ é€è¿‡ç¨‹ç¤ºæ„å›¾\nCookieçš„ç¼ºé™·\n(1) cookieä¼šè¢«é™„åŠ åœ¨æ¯ä¸ªHTTPè¯·æ±‚ä¸­ï¼Œæ‰€ä»¥æ— å½¢ä¸­å¢åŠ äº†æµé‡ã€‚\n(2) ç”±äºåœ¨HTTPè¯·æ±‚ä¸­çš„cookieæ˜¯æ˜æ–‡ä¼ é€’çš„ï¼Œæ‰€ä»¥å®‰å…¨æ€§æˆé—®é¢˜ã€‚ï¼ˆé™¤éç”¨HTTPS)\n(3) Cookieçš„å¤§å°é™åˆ¶åœ¨4KBå·¦å³ã€‚å¯¹äºå¤æ‚çš„å­˜å‚¨éœ€æ±‚æ¥è¯´æ˜¯ä¸å¤Ÿç”¨çš„ã€‚\nå‚è€ƒï¼š\n ä¼šè¯æŠ€æœ¯â€”â€”Cookieså’ŒSessionè¯¦è§£  ğŸ’¬ SessionæŠ€æœ¯ ä»€ä¹ˆæ˜¯ä¼šè¯ï¼Ÿ\nä¼šè¯æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„å¤šæ¬¡è¯·æ±‚å’Œå“åº”ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨å¼€å§‹ï¼Œåˆ°è®¿é—®æœåŠ¡å™¨ç»“æŸï¼Œæµè§ˆå™¨å…³é—­ä¸ºæ­¢çš„è¿™æ®µæ—¶é—´å†…å®¹äº§ç”Ÿçš„å¤šæ¬¡è¯·æ±‚å’Œå“åº”ï¼Œåˆèµ·æ¥å«åšæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ä¸€æ¬¡ä¼šè¯ã€‚\nä¸ºä»€ä¹ˆä½¿ç”¨ä¼šè¯æŠ€æœ¯ï¼Ÿ\nå®é™…ä¸Šä¼šè¯é—®é¢˜è§£å†³çš„è¿˜æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡é—®é¢˜ï¼Œé€šè¿‡ä¸€äº›ä¼šè¯æŠ€æœ¯ï¼Œå¯ä»¥å°†æ¯ä¸ªç”¨æˆ·çš„æ•°æ®ä»¥ä¾‹å¦‚cookie/sessionçš„å½¢å¼å­˜å‚¨ï¼Œæ–¹ä¾¿ä»¥åç”¨æˆ·è®¿é—®webèµ„æºçš„æ—¶å€™ä½¿ç”¨\n å‡å®šåœºæ™¯ï¼šAå’ŒBä¸¤äººåœ¨æŸä¸ªç½‘ä¸Šè´­ç‰©å•†åœºç™»é™†è´¦å·åï¼ŒAä¹°äº†ä¸€ä¸ªHHKBçš„é”®ç›˜ï¼Œè€ŒBåˆ™è´­ä¹°äº†ä¸€æŠŠæ°‘è°£å‰ä»–ï¼Œè¿™äº›ä¿¡æ¯éƒ½ä¼šè¢«ä¿å­˜ä¸‹æ¥\nç”¨é€”æ˜¯ï¼šä¿å­˜è´¦æˆ·ä¿¡æ¯ï¼Œç™»å½•æ—¶è¯¢é—®æ—¥åæ˜¯å¦è‡ªåŠ¨ç™»å½•ï¼Œæˆ–è€…æ ¹æ®ä¹‹å‰æµè§ˆï¼Œè´­ä¹°è¿‡çš„å•†å“ï¼Œåˆ†æç”¨æˆ·å–œæ¬¢ä»€ä¹ˆç±»å‹çš„å•†å“ï¼Œåšå‡ºç²¾å‡†æ¨é€\n æœåŠ¡å™¨ä½¿ç”¨sessionæŠŠç”¨æˆ·çš„ä¿¡æ¯ä¸´æ—¶ä¿å­˜åœ¨äº†æœåŠ¡å™¨ä¸Šï¼Œç”¨æˆ·ç¦»å¼€ç½‘ç«™åsessionä¼šè¢«é”€æ¯ã€‚è¿™ç§ç”¨æˆ·ä¿¡æ¯å­˜å‚¨æ–¹å¼ç›¸å¯¹cookieæ¥è¯´æ›´å®‰å…¨ï¼Œå¯æ˜¯sessionæœ‰ä¸€ä¸ªç¼ºé™·ï¼šå¦‚æœwebæœåŠ¡å™¨åšäº†è´Ÿè½½å‡è¡¡ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæ“ä½œè¯·æ±‚åˆ°äº†å¦ä¸€å°æœåŠ¡å™¨çš„æ—¶å€™sessionä¼šä¸¢å¤±ã€‚\nå‚è€ƒï¼š\n ä¼šè¯æŠ€æœ¯â€”â€”Cookieså’ŒSessionè¯¦è§£ å½»åº•ç†è§£cookieï¼Œsessionï¼Œtoken è®¤è¯†HTTP\u0026mdash;-Cookieå’ŒSessionç¯‡  ğŸ“¸ Sessionå’ŒCookieçš„åŒºåˆ« ä»å­˜å‚¨æ–¹å¼ä¸Šæ¯”è¾ƒ\nCookieåªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ï¼Œå¦‚æœè¦å­˜å‚¨éASCIIå­—ç¬¦ä¸²è¿˜è¦å¯¹å…¶ç¼–ç ã€‚\nSessionå¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œå¯ä»¥æŠŠSessionçœ‹æˆæ˜¯ä¸€ä¸ªå®¹å™¨\nä»éšç§å®‰å…¨ä¸Šæ¯”è¾ƒ\nCookieå­˜å‚¨åœ¨æµè§ˆå™¨ä¸­ï¼Œå¯¹å®¢æˆ·ç«¯æ˜¯å¯è§çš„ã€‚ä¿¡æ¯å®¹æ˜“æ³„éœ²å‡ºå»ã€‚å¦‚æœä½¿ç”¨Cookieï¼Œæœ€å¥½å°†CookieåŠ å¯†\nSessionå­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¯¹å®¢æˆ·ç«¯æ˜¯é€æ˜çš„ã€‚ä¸å­˜åœ¨æ•æ„Ÿä¿¡æ¯æ³„éœ²é—®é¢˜ã€‚\nä»æœ‰æ•ˆæœŸä¸Šæ¯”è¾ƒ\nCookieä¿å­˜åœ¨ç¡¬ç›˜ä¸­ï¼Œåªéœ€è¦è®¾ç½®maxAgeå±æ€§ä¸ºæ¯”è¾ƒå¤§çš„æ­£æ•´æ•°ï¼Œå³ä½¿å…³é—­æµè§ˆå™¨ï¼ŒCookieè¿˜æ˜¯å­˜åœ¨çš„\nSessionçš„ä¿å­˜åœ¨æœåŠ¡å™¨ä¸­ï¼Œè®¾ç½®maxInactiveIntervalå±æ€§å€¼æ¥ç¡®å®šSessionçš„æœ‰æ•ˆæœŸã€‚å¹¶ä¸”Sessionä¾èµ–äºåä¸ºJSESSIONIDçš„Cookieï¼Œè¯¥Cookieé»˜è®¤çš„maxAgeå±æ€§ä¸º-1ã€‚å¦‚æœå…³é—­äº†æµè§ˆå™¨ï¼Œè¯¥Sessionè™½ç„¶æ²¡æœ‰ä»æœåŠ¡å™¨ä¸­æ¶ˆäº¡ï¼Œä½†ä¹Ÿå°±å¤±æ•ˆäº†ã€‚\nä»å¯¹æœåŠ¡å™¨çš„è´Ÿæ‹…æ¯”è¾ƒ\nSessionæ˜¯ä¿å­˜åœ¨æœåŠ¡å™¨çš„ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªSessionï¼Œå¦‚æœæ˜¯å¹¶å‘è®¿é—®çš„ç”¨æˆ·éå¸¸å¤šï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨Sessionçš„ï¼ŒSessionä¼šæ¶ˆè€—å¤§é‡çš„å†…å­˜ã€‚\nCookieæ˜¯ä¿å­˜åœ¨å®¢æˆ·ç«¯çš„ã€‚ä¸å ç”¨æœåŠ¡å™¨çš„èµ„æºã€‚åƒbaiduã€Sinaè¿™æ ·çš„å¤§å‹ç½‘ç«™ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨Cookieæ¥è¿›è¡Œä¼šè¯è·Ÿè¸ªã€‚\nä»æµè§ˆå™¨çš„æ”¯æŒä¸Šæ¯”è¾ƒ\nå¦‚æœæµè§ˆå™¨ç¦ç”¨äº†Cookieï¼Œé‚£ä¹ˆCookieæ˜¯æ— ç”¨çš„äº†ï¼\nå¦‚æœæµè§ˆå™¨ç¦ç”¨äº†Cookieï¼ŒSessionå¯ä»¥é€šè¿‡URLåœ°å€é‡å†™æ¥è¿›è¡Œä¼šè¯è·Ÿè¸ªã€‚\nä»è·¨åŸŸåä¸Šæ¯”è¾ƒ\nCookieå¯ä»¥è®¾ç½®domainå±æ€§æ¥å®ç°è·¨åŸŸå\nSessionåªåœ¨å½“å‰çš„åŸŸåå†…æœ‰æ•ˆï¼Œä¸å¯è·¨åŸŸå\nÂ© IPåè®® IPåè®®çš„ä½œç”¨æ˜¯æŠŠå„ç§æ•°æ®åŒ…ä¼ é€ç»™å¯¹æ–¹ã€‚è€Œè¦ä¿è¯ç¡®å®ä¼ é€åˆ°å¯¹æ–¹é‚£é‡Œï¼Œåˆ™éœ€è¦æ»¡è¶³å„ç±»æ¡ä»¶ã€‚å…¶ä¸­ä¸¤ä¸ªé‡è¦çš„æ¡ä»¶æ˜¯IPåœ°å€å’ŒMACåœ°å€ï¼ˆMedia Access Control Addressï¼‰ã€‚IPåœ°å€æŒ‡æ˜äº†èŠ‚ç‚¹è¢«åˆ†é…åˆ°çš„åœ°å€ï¼ŒMACåœ°å€æ˜¯æŒ‡ç½‘å¡æ‰€å±çš„å›ºå®šåœ°å€ã€‚IPåœ°å€å¯ä»¥å’ŒMACåœ°å€è¿›è¡Œé…å¯¹ã€‚IPåœ°å€å¯å˜æ¢ï¼Œä½†MACåœ°å€åŸºæœ¬ä¸Šä¸ä¼šæ›´æ”¹ã€‚\nä»€ä¹ˆæ˜¯MACåœ°å€ï¼Ÿ\nMACåœ°å€ä¹Ÿå«ç‰©ç†åœ°å€ã€ç¡¬ä»¶åœ°å€ï¼Œç”±ç½‘ç»œè®¾å¤‡åˆ¶é€ å•†ç”Ÿäº§æ—¶çƒ§å½•åœ¨ç½‘å¡çš„EPROM(ä¸€ç§é—ªå­˜èŠ¯ç‰‡ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡ç¨‹åºæ“¦å†™)ã€‚IPåœ°å€ä¸MACåœ°å€åœ¨è®¡ç®—æœºé‡Œéƒ½æ˜¯ä»¥äºŒè¿›åˆ¶è¡¨ç¤ºçš„ï¼ŒIPåœ°å€æ˜¯32ä½çš„ï¼Œè€ŒMACåœ°å€åˆ™æ˜¯48ä½çš„ ã€‚\næœ‰äº† IP åœ°å€ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨ MAC åœ°å€ IPåœ°å€å±äºç½‘ç»œå±‚ï¼Œè€ŒMACåœ°å€å±äºæ•°æ®é“¾è·¯å±‚ã€‚ ç½‘ç»œå±‚åè®®ä½¿æ•°æ®å¯ä»¥ä»ä¸€ä¸ªç½‘ç»œä¼ é€’åˆ°å¦ä¸€ä¸ªç½‘ç»œä¸Šï¼ˆARPæ ¹æ®ç›®çš„IPåœ°å€ï¼Œæ‰¾åˆ°ä¸­é—´èŠ‚ç‚¹çš„MACåœ°å€ï¼Œé€šè¿‡ä¸­é—´èŠ‚ç‚¹ä¼ é€ï¼Œä»è€Œæœ€ç»ˆåˆ°è¾¾ç›®çš„ç½‘ç»œï¼‰ï¼›æ•°æ®é“¾è·¯å±‚åè®®å¯ä»¥ä½¿æ•°æ®ä»ä¸€ä¸ªèŠ‚ç‚¹ä¼ é€’åˆ°ç›¸åŒé“¾è·¯çš„å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼ˆé€šè¿‡MACåœ°å€ï¼‰ã€‚\n  MACåœ°å€å¯»å€çš„æ—¶é—´å¤æ‚åº¦å¤ªå¤§\nå¦‚æœåªæœ‰MACåœ°å€ï¼Œæ˜¯æ— æ³•æ”¯æ’‘èµ·è¿™ä¹ˆå¤§çš„ç½‘ç»œçš„ï¼Œä½ è§‰å¾—ç›´æ¥è®¿é—®åˆ°MACåœ°å€å°±è¡Œäº†ï¼Œé—®é¢˜æ˜¯ä½ è®©è·¯ç”±å™¨æ€ä¹ˆç»™ä½ æ‰¾åˆ°è·¯çº¿å‘¢ï¼Ÿ\n  æ²¡æœ‰ç»Ÿä¸€çš„ç¡¬ä»¶åœ°å€\nç”±äºå…¨ä¸–ç•Œå­˜åœ¨ç€å„å¼å„æ ·çš„ç½‘ç»œï¼Œä»–ä»¬ä½¿ç”¨ä¸åŒçš„ç¡¬ä»¶åœ°å€ã€‚è¦ä½¿è¿™äº›å¼‚æ„ç½‘ç»œèƒ½å¤Ÿäº’ç›¸é€šä¿¡å°±å¿…é¡»è¿›è¡Œéå¸¸å¤æ‚çš„ç¡¬ä»¶åœ°å€è½¬åŒ–å·¥ä½œï¼Œå› æ­¤ç”±ç”¨æˆ·æˆ–ç”¨æˆ·ä¸»æœºæ¥å®Œæˆè¿™é¡¹å·¥ä½œå‡ ä¹æ˜¯ä¸å¯èƒ½çš„çš„äº‹ã€‚ä½†IPç¼–å€å°±æŠŠè¿™ä¸ªå¤æ‚çš„é—®é¢˜è§£å†³äº†ã€‚è¿æ¥åˆ°äº’è”ç½‘çš„ä¸»æœºåªéœ€è¦å„è‡ªæ‹¥æœ‰ä¸€ä¸ªå”¯ä¸€çš„IPåœ°å€ï¼Œä»–ä»¬ä¹‹é—´çš„é€šä¿¡å°±åƒè¿æ¥åœ¨åŒä¸€ä¸ªç½‘ç»œé‚£ä¹ˆç®€å•æ–¹ä¾¿ã€‚å› ä¸ºARPæ˜¯ç”±è®¡ç®—æœºè½¯ä»¶è‡ªåŠ¨è¿›è¡Œçš„ï¼Œå¯¹ç”¨æˆ·æ¥è¯´æ˜¯çœ‹ä¸è§è¿™ç§è°ƒç”¨è¿‡ç¨‹çš„ã€‚\n   IPåœ°å€æ˜¯é€»è¾‘åœ°å€ï¼Œéœ€è¦æ˜ å°„åˆ°ç‰©ç†åœ°å€MACåœ°å€æ‰èƒ½å°†æ•°æ®å†™å…¥å¯¹æ–¹çš„ç½‘å¡ã€‚\n å‚è€ƒï¼š\n æœ‰äº† IP åœ°å€ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨ MAC åœ°å€ ä¸ºä»€ä¹ˆæœ‰äº†Macåœ°å€ï¼Œè¿˜è¦IPåœ°å€  ğŸ›° DNSåè®® DNSï¼ˆDomain Name Systemï¼‰æœåŠ¡æ˜¯å’ŒHTTPåè®®ä¸€æ ·ä½äºåº”ç”¨å±‚çš„åè®®ã€‚å®ƒæä¾›åŸŸååˆ°IPåœ°å€ä¹‹é—´çš„è§£ææœåŠ¡ã€‚\nç®€å•çš„è¿‡ç¨‹ï¼š\nå¤æ‚è§£æè¿‡ç¨‹ï¼š\nå½“ä¸€ä¸ªåº”ç”¨è¿›ç¨‹éœ€è¦æŠŠä¸»æœºåè§£æä¸ºipåœ°å€æ—¶ï¼Œè¯¥åº”ç”¨è¿›ç¨‹å°±è°ƒç”¨è§£æç¨‹åºï¼Œå¹¶æˆä¸ºdnsçš„ä¸€ä¸ªå®¢æˆ·ï¼ŒæŠŠå¾…è§£æçš„åŸŸååœ¨dnsè¯·æ±‚æŠ¥æ–‡ä¸­ï¼Œä»¥udpç”¨æˆ·æ•°æ®æŠ¥æ–¹å¼å‘é€ç»™æœ¬åœ°åŸŸåæœåŠ¡å™¨ã€‚æœ¬åœ°åŸŸåæœåŠ¡å™¨åœ¨æŸ¥æ‰¾åŸŸååï¼ŒæŠŠå¯¹åº”çš„ipåœ°å€æ”¾åœ¨å›ç­”æŠ¥æ–‡ä¸­è¿”å›ã€‚åº”ç”¨è¿›ç¨‹è·å¾—ç›®çš„ä¸»æœºçš„ipåœ°å€åå³å¯è¿›è¡Œé€šä¿¡ã€‚\nè‹¥æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸èƒ½å›ç­”è¯¥è¯·æ±‚ï¼Œåˆ™æ­¤åŸŸåæœåŠ¡å™¨å°±æš‚æ—¶æˆä¸ºäº†dnsä¸­çš„å¦ä¸€ä¸ªå®¢æˆ·ï¼Œå¹¶å‘å…¶å®ƒåŸŸåæœåŠ¡å™¨å‘é€æŸ¥è¯¢è¯·æ±‚ã€‚è¿™ç§è¿‡ç¨‹ç›´è‡³æ‰¾åˆ°èƒ½å¤Ÿå›ç­”è¯¥è¯·æ±‚çš„åŸŸåæœåŠ¡å™¨ä¸ºæ­¢ã€‚\nåŸŸåæœåŠ¡è§£æçš„ä¸¤ç§æ–¹å¼ï¼š\nå®¢æˆ·ç«¯å‘å‡ºçš„æŸ¥è¯¢éƒ½æ˜¯é€’å½’æŸ¥è¯¢ï¼ŒDNSæœåŠ¡å™¨å‘å¤–å‘å‡ºçš„æŸ¥è¯¢ä¸€èˆ¬éƒ½æ˜¯è¿­ä»£æŸ¥è¯¢\n ğŸ—ƒ FTPåè®® æ–‡ä»¶ä¼ è¾“åè®®FTP(File Transfer Protocol)æ˜¯å› ç‰¹ç½‘ä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„æ–‡ä»¶ä¼ è¾“åè®®ã€‚FTPä½¿ç”¨äº¤äº’å¼çš„è®¿é—®ï¼Œå…è®¸å®¢æˆ·æŒ‡å®šæ–‡ä»¶çš„ç±»å‹å’Œæ ¼å¼(å¦‚æŒ‡æ˜æ˜¯å¦ä½¿ç”¨ASCIIç )ï¼Œå¹¶å…è®¸æ–‡ä»¶å…·æœ‰å­˜å–æƒé™(å¦‚è®¿é—®æ–‡ä»¶çš„ç”¨æˆ·å¿…é¡»ç»è¿‡æˆæƒï¼Œå¹¶è¾“å…¥æœ‰æ•ˆçš„å£ä»¤)ã€‚\næ–‡ä»¶ä¼ è¾“åè®®æœ‰åŸºäºTCPçš„FTPå’ŒåŸºäºUDPçš„ç®€å•æ–‡ä»¶ä¼ è¾“åè®®TFTPï¼Œå®ƒä»¬éƒ½æ˜¯æ–‡ä»¶å…±äº«åè®®ä¸­çš„ä¸€å¤§ç±»ï¼Œå³å¤åˆ¶æ•´ä¸ªæ–‡ä»¶ï¼Œå…¶ç‰¹ç‚¹æ˜¯ï¼šè‹¥è¦å­˜å–ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±å¿…é¡»å…ˆè·å¾—ä¸€ä¸ªæœ¬åœ°çš„æ–‡ä»¶å‰¯æœ¬ã€‚å¦‚æœè¦ä¿®æ”¹æ–‡ä»¶ï¼Œåªèƒ½å¯¹æ–‡ä»¶çš„å‰¯æœ¬è¿›è¡Œä¿®æ”¹ï¼Œç„¶åå†å°†ä¿®æ”¹åçš„æ–‡ä»¶ä¼ å›åˆ°åŸèŠ‚ç‚¹ã€‚\nä¸Telnetç±»ä¼¼ï¼ŒFTPæœ€æ—©çš„è®¾è®¡æ˜¯ç”¨äºä¸¤å°ä¸åŒçš„ä¸»æœºï¼Œè¿™ä¸¤ä¸ªä¸»æœºå¯èƒ½è¿è¡Œåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸‹ã€ä½¿ç”¨ä¸åŒçš„æ–‡ä»¶ç»“æ„ã€å¹¶å¯èƒ½ä½¿ç”¨ä¸åŒå­—ç¬¦é›†ã€‚ä½†ä¸åŒçš„æ˜¯ï¼ŒTelnetè·å¾—å¼‚æ„æ€§æ˜¯å¼ºåˆ¶ä¸¤ç«¯éƒ½é‡‡ç”¨åŒä¸€ä¸ªæ ‡å‡†ï¼šä½¿ç”¨7æ¯”ç‰¹ASCIIç çš„NVTã€‚è€ŒFTPæ˜¯é‡‡ç”¨å¦ä¸€ç§æ–¹æ³•æ¥å¤„ç†ä¸åŒç³»ç»Ÿé—´çš„å·®å¼‚ã€‚FTPæ”¯æŒæœ‰é™æ•°é‡çš„æ–‡ä»¶ç±»å‹ï¼ˆASCIIï¼ŒäºŒè¿›åˆ¶ï¼Œç­‰ç­‰ï¼‰å’Œæ–‡ä»¶ç»“æ„ï¼ˆé¢å‘å­—èŠ‚æµæˆ–è®°å½•ï¼‰\nFTPä¸æˆ‘ä»¬å·²æè¿°çš„å¦ä¸€ç§åº”ç”¨ä¸åŒï¼Œå®ƒé‡‡ç”¨ä¸¤ä¸ªTCPè¿æ¥æ¥ä¼ è¾“ä¸€ä¸ªæ–‡ä»¶ã€‚\n æ§åˆ¶è¿æ¥ä»¥é€šå¸¸çš„å®¢æˆ·æœåŠ¡å™¨æ–¹å¼å»ºç«‹ã€‚æœåŠ¡å™¨ä»¥è¢«åŠ¨æ–¹å¼æ‰“å¼€ä¼—æ‰€å‘¨çŸ¥çš„ç”¨äºFTPçš„ç«¯å£ï¼ˆ21ï¼‰ï¼Œç­‰å¾…å®¢æˆ·çš„è¿æ¥ã€‚å®¢æˆ·åˆ™ä»¥ä¸»åŠ¨æ–¹å¼æ‰“å¼€TCPç«¯å£21ï¼Œæ¥å»ºç«‹è¿æ¥ã€‚æ§åˆ¶è¿æ¥å§‹ç»ˆç­‰å¾…å®¢æˆ·ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚è¯¥è¿æ¥å°†å‘½ä»¤ä»å®¢æˆ·ä¼ ç»™æœåŠ¡å™¨ï¼Œå¹¶ä¼ å›æœåŠ¡å™¨çš„åº”ç­”ã€‚\nç”±äºå‘½ä»¤é€šå¸¸æ˜¯ç”±ç”¨æˆ·é”®å…¥çš„ï¼Œæ‰€ä»¥IPå¯¹æ§åˆ¶è¿æ¥çš„æœåŠ¡ç±»å‹å°±æ˜¯â€œæœ€å¤§é™åº¦åœ°å‡å°è¿Ÿå»¶â€ã€‚ æ¯å½“ä¸€ä¸ªæ–‡ä»¶åœ¨å®¢æˆ·ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ—¶ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ•°æ®è¿æ¥ã€‚ï¼ˆå…¶ä»–æ—¶é—´ä¹Ÿå¯ä»¥åˆ›å»ºï¼Œåé¢æˆ‘ä»¬å°†è¯´åˆ°ï¼‰ã€‚\nç”±äºè¯¥è¿æ¥ç”¨äºä¼ è¾“ç›®çš„ï¼Œæ‰€ä»¥IPå¯¹æ•°æ®è¿æ¥çš„æœåŠ¡ç‰¹ç‚¹å°±æ˜¯â€œæœ€å¤§é™åº¦æé«˜ååé‡â€ã€‚  è¿æ¥æƒ…å†µï¼š\nä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œäº¤äº’å¼ç”¨æˆ·é€šå¸¸ä¸å¤„ç†åœ¨æ§åˆ¶è¿æ¥ä¸­è½¬æ¢çš„å‘½ä»¤å’Œåº”ç­”ã€‚è¿™äº›ç»†èŠ‚å‡ç”±ä¸¤ä¸ªåè®®è§£é‡Šå™¨æ¥å®Œæˆã€‚æ ‡æœ‰â€œç”¨æˆ·æ¥å£â€çš„æ–¹æ¡†åŠŸèƒ½æ˜¯æŒ‰ç”¨æˆ·æ‰€éœ€æä¾›å„ç§äº¤äº’ç•Œé¢ï¼ˆå…¨å±å¹•èœå•é€‰æ‹©ï¼Œé€è¡Œè¾“å…¥å‘½ä»¤ï¼Œç­‰ç­‰ï¼‰ï¼Œå¹¶æŠŠå®ƒä»¬è½¬æ¢æˆåœ¨æ§åˆ¶è¿æ¥ä¸Šå‘é€çš„FTPå‘½ä»¤ã€‚ç±»ä¼¼åœ°ï¼Œä»æ§åˆ¶è¿æ¥ä¸Šä¼ å›çš„æœåŠ¡å™¨åº”ç­”ä¹Ÿè¢«è½¬æ¢æˆç”¨æˆ·æ‰€éœ€çš„äº¤äº’æ ¼å¼ã€‚\nå‚è€ƒï¼š\n æ·±å…¥ç†è§£FTPåè®® ç¬¬27ç«  FTP:æ–‡ä»¶ä¼ é€åè®®  X.509 æ•°å­—è¯ä¹¦ ç®€å•æ¥è¯´ï¼Œæ•°å­—è¯ä¹¦å°±æ˜¯ä¸€å¼ é™„å¸¦äº†æ•°å­—ç­¾åçš„ä¿¡æ¯è¡¨ã€‚\næ•°å­—è¯ä¹¦çš„ç­¾ç½² æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯å¯¹å…¬é’¥å’Œä¿¡æ¯è¿›è¡Œhashå¾—åˆ°æ‘˜è¦ï¼Œç„¶åä½¿ç”¨ç§é’¥å¯¹æ‘˜è¦è¿›è¡ŒåŠ å¯†å¾—åˆ°åŠ å¯†åçš„æ‘˜è¦ã€‚åŠ åŠ å¯†åçš„æ‘˜è¦å’Œå…¬é’¥ä»¥åŠä¿¡æ¯åŒ…è£…æˆä¸€ä¸ªè¯ä¹¦ã€‚\næ ¹è®¤è¯æœºæ„çš„æ„å»º ç®€è¦æµç¨‹\n æ ¹è®¤è¯æœºæ„ã€ŒCAã€ç”Ÿæˆå…¬é’¥ ca_KeyPub å’Œç§é’¥ ca_KeyPriï¼Œä»¥åŠåŸºæœ¬ä¿¡æ¯è¡¨ ca_Infoã€‚ca_Info ä¸­ä¸€èˆ¬åŒ…å«äº†ã€ŒCAã€çš„åç§°ã€è¯ä¹¦çš„æœ‰æ•ˆæœŸç­‰ä¿¡æ¯ã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€å¯¹ï¼ˆca_KeyPub + ca_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ ca_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€ä½¿ç”¨å…¶ç§é’¥ ca_KeyPri å¯¹ ca_Hash è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†çš„æ•£åˆ—å€¼ enc_ca_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€å°†ï¼ˆca_KeyPub + ca_Info + enc_ca_Hashï¼‰ç»„åˆç”Ÿæˆè‡ªç­¾åçš„æ•°å­—è¯ä¹¦**ã€Œca_Certã€**ã€‚è¿™å¼ è¯ä¹¦ç§°ä¹‹ä¸ºæ ¹è¯ä¹¦ã€‚  æ ¹è¯ä¹¦**ã€Œca_Certã€**åŒ…å«çš„å†…å®¹ï¼šca_KeyPub + ca_Info + enc_ca_Hashã€‚\n**ã€Œca_Certã€**å¯ç”¨äºç­¾ç½²ä¸‹ä¸€çº§çš„è¯ä¹¦ã€‚\nå•çº§è®¤è¯æœºæ„çš„è¯ä¹¦ç­¾ç½² ç®€è¦æµç¨‹\n æœåŠ¡å™¨ã€ŒSã€ç”Ÿæˆå…¬é’¥ s_KeyPub å’Œç§é’¥ s_KeyPriï¼Œä»¥åŠåŸºæœ¬ä¿¡æ¯è¡¨ s_Infoã€‚s_Info ä¸­ä¸€èˆ¬åŒ…å«äº†ã€ŒSã€çš„åç§°ã€è¯ä¹¦è¦æ±‚çš„æœ‰æ•ˆæœŸç­‰ä¿¡æ¯ã€‚ æœåŠ¡å™¨ã€ŒSã€å°† s_KeyPubã€s_Info é€ç»™æ ¹è®¤è¯æœºæ„ã€ŒCAã€ã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€é€šè¿‡æŸç§æ–¹å¼éªŒè¯ã€ŒSã€çš„èº«ä»½ä¹‹åï¼Œå†åŠ ä¸Šæ ¹è®¤è¯æœºæ„è‡ªå·±çš„ä¸€äº›ä¿¡æ¯ ca_Infoï¼Œç„¶åå¯¹å®ƒä»¬ï¼ˆs_KeyPub + s_Info + ca_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ s_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€ä½¿ç”¨å…¶ç§é’¥ ca_KeyPri å¯¹ s_Hash è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†çš„æ•£åˆ—å€¼ enc_s_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€å°†ï¼ˆs_KeyPub + s_Info + ca_Info + enc_s_Hashï¼‰ç»„åˆç­¾ç½²æˆæ•°å­—è¯ä¹¦**ã€Œs_Certã€**å¹¶å›é€ç»™ã€ŒSã€ã€‚  æœåŠ¡å™¨è¯ä¹¦**ã€Œs_Certã€**åŒ…å«çš„å†…å®¹ï¼šs_KeyPub + s_Info + ca_Info + enc_s_Hashã€‚\n**ã€Œs_Certã€**ä¸å¯ç”¨äºç­¾ç½²ä¸‹ä¸€çº§çš„è¯ä¹¦ã€‚\näºŒçº§ï¼ˆæˆ–ä»¥ä¸Šï¼‰è®¤è¯æœºæ„çš„æ„å»º  åœ¨ç°å®ä¸­ï¼Œä»…ä»…é ä¸€ä¸ªè®¤è¯æœºæ„æ˜¯æ»¡è¶³ä¸äº†æµ·é‡è¯ä¹¦ç­¾ç½²éœ€æ±‚çš„ï¼Œå› æ­¤éœ€è¦æ„å»ºåˆ†æ”¯è®¤è¯æœºæ„ã€‚\n ç®€è¦æµç¨‹\n äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€ç”Ÿæˆå…¬é’¥ ca2_KeyPub å’Œç§é’¥ ca2_KeyPriï¼Œä»¥åŠåŸºæœ¬ä¿¡æ¯è¡¨ ca2_Infoã€‚ca2_Info ä¸­ä¸€èˆ¬åŒ…å«äº†ã€ŒCA2ã€çš„åç§°ã€è¯ä¹¦è¦æ±‚çš„æœ‰æ•ˆæœŸç­‰ä¿¡æ¯ã€‚ äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€å°† ca2_KeyPubã€ca2_Info é€ç»™æ ¹è®¤è¯æœºæ„ã€ŒCAã€ã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€é€šè¿‡æŸç§æ–¹å¼éªŒè¯ã€ŒCA2ã€çš„èº«ä»½ä¹‹åï¼Œå†åŠ ä¸Šæ ¹è®¤è¯æœºæ„è‡ªå·±çš„ä¸€äº›ä¿¡æ¯ ca_Infoï¼Œç„¶åå¯¹å®ƒä»¬ï¼ˆca2_KeyPub + ca2_Info + ca_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ ca2_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€ä½¿ç”¨å…¶ç§é’¥ ca_KeyPri å¯¹ ca2_Hash è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†çš„æ•£åˆ—å€¼ enc_ca2_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€å°†ï¼ˆca2_KeyPub + ca2_Info + ca_Info + enc_ca2_Hashï¼‰ç»„åˆç­¾ç½²æˆæ•°å­—è¯ä¹¦**ã€Œca2_Certã€**å¹¶å›é€ç»™ã€ŒCA2ã€ã€‚  äºŒçº§è®¤è¯æœºæ„è¯ä¹¦**ã€Œca2_Certã€**åŒ…å«çš„å†…å®¹ï¼šca2_KeyPub + ca2_Info + ca_Info + enc_ca2_Hashã€‚\n**ã€Œca2_Certã€**å¯ç”¨äºç­¾ç½²ä¸‹ä¸€çº§çš„è¯ä¹¦ã€‚\nä¸‰çº§æˆ–æ›´å¤šçº§è®¤è¯æœºæ„çš„æ„å»ºæµç¨‹è·Ÿè¿™ä¸ªæµç¨‹å·®ä¸å¤šï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚\näºŒçº§ï¼ˆæˆ–ä»¥ä¸Šï¼‰è®¤è¯æœºæ„çš„è¯ä¹¦ç­¾ç½² ç®€è¦æµç¨‹\n æœåŠ¡å™¨ã€ŒS2ã€ç”Ÿæˆå…¬é’¥ s2_KeyPub å’Œç§é’¥ s2_KeyPriï¼Œä»¥åŠåŸºæœ¬ä¿¡æ¯è¡¨ s2_Infoã€‚s2_Info ä¸­ä¸€èˆ¬åŒ…å«äº†ã€ŒS2ã€çš„åç§°ã€è¯ä¹¦è¦æ±‚çš„æœ‰æ•ˆæœŸç­‰ä¿¡æ¯ã€‚ æœåŠ¡å™¨ã€ŒS2ã€å°† s2_KeyPubã€s2_Info é€ç»™äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€ã€‚ äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€é€šè¿‡æŸç§æ–¹å¼éªŒè¯ã€ŒS2ã€çš„èº«ä»½ä¹‹åï¼Œå†åŠ ä¸Šæ ¹è®¤è¯æœºæ„è‡ªå·±çš„ä¸€äº›ä¿¡æ¯ ca2_Infoï¼Œç„¶åå¯¹å®ƒä»¬ï¼ˆs2_KeyPub + s2_Info + ca2_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ s2_Hashã€‚ äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€ä½¿ç”¨å…¶ç§é’¥ ca2_KeyPri å¯¹ s2_Hash è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†çš„æ•£åˆ—å€¼ enc_s2_Hashã€‚ äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€å°†ï¼ˆs2_KeyPub + s2_Info + ca2_Info + enc_s2_Hashï¼‰ç»„åˆç­¾ç½²æˆæ•°å­—è¯ä¹¦**ã€Œs2_Certã€**å¹¶å›é€ç»™ã€ŒS2ã€ã€‚  æœåŠ¡å™¨è¯ä¹¦**ã€Œs2_Certã€**åŒ…å«çš„å†…å®¹ï¼šs2_KeyPub + s2_Info + ca2_Info + enc_s2_Hashã€‚\n**ã€Œs2_Certã€**ä¸å¯ç”¨äºç­¾ç½²ä¸‹ä¸€çº§çš„è¯ä¹¦ã€‚\nä¸‰çº§æˆ–æ›´å¤šçº§è®¤è¯æœºæ„è¯ä¹¦ç­¾ç½²æµç¨‹è·Ÿè¿™ä¸ªæµç¨‹å·®ä¸å¤šï¼Œä¹Ÿä¸å†èµ˜è¿°äº†ã€‚\nä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œè¯ä¹¦ç­¾ç½²çš„æµç¨‹æ˜¯ï¼šã€Œca_Certã€-\u0026gt; ã€Œca2_Certã€-\u0026gt;**ã€Œs2_Certã€**ã€‚å®ƒæ˜¯ä¸€æ¡å®Œæ•´çš„é“¾æ¡ï¼Œæˆ‘ä»¬æŠŠå®ƒç§°ä¹‹ä¸ºã€Œè¯ä¹¦é“¾ã€ã€‚\nç°å®ä¸­çš„è¯ä¹¦ç­¾ç½² ç°å®ä¸­çš„è¯ä¹¦å¤§å¤šæ•°æ˜¯ç”±äºŒçº§è®¤è¯æœºæ„ç­¾ç½²çš„ã€‚\nå¹¶ä¸”ï¼Œä»¥æŸç§æ–¹å¼ï¼ˆå¦‚ DNSï¼‰å¯¹æœåŠ¡å™¨çš„èº«ä»½è¿›è¡ŒéªŒè¯ä¹‹åï¼Œä¸€èˆ¬æ— éœ€è®©æœåŠ¡å™¨æä¾›ä»»ä½•ä¿¡æ¯ï¼ˆCSR æ–‡ä»¶ï¼‰ã€‚\nè®¤è¯æœºæ„ä¼šæä¾›è¯ä¹¦ã€è¯ä¹¦é“¾ä»¥åŠç§é’¥ï¼ŒæœåŠ¡å™¨ç›´æ¥ä½¿ç”¨å°±å¥½äº†ã€‚\næœåŠ¡å™¨çš„é…ç½® å¦‚æœæœåŠ¡å™¨ã€ŒSã€ä½¿ç”¨çš„è¯ä¹¦æ˜¯ç”±æ ¹è®¤è¯æœºæ„ã€ŒCAã€ç›´æ¥ç­¾ç½²çš„ï¼Œé‚£ä¹ˆåªéœ€è¦å‘å®¢æˆ·ç«¯æä¾›**ã€Œs_Certã€**ï¼Œç„¶åè‡ªå·±ä½¿ç”¨ç§é’¥ s_KeyPri å³å¯å®ç°éå¯¹ç§°åŠ å¯†ã€‚\nå¦‚æœæœåŠ¡å™¨ã€ŒS2ã€ä½¿ç”¨çš„è¯ä¹¦ä¸æ˜¯ç”±æ ¹è®¤è¯æœºæ„ã€ŒCAã€ç›´æ¥ç­¾ç½²çš„ï¼Œåˆ™ä¸ä»…éœ€è¦å‘å®¢æˆ·ç«¯æä¾›**ã€Œs2_Certã€**ï¼Œè€Œä¸”è¿˜è¦æä¾›é™¤æ ¹è®¤è¯æœºæ„ã€ŒCAã€ä¹‹å¤–æ‰€æœ‰è®¤è¯æœºæ„çš„è¯ä¹¦ï¼ˆè¿™é‡Œè¿˜è¦æä¾›**ã€Œca2_Certã€**ï¼‰ï¼Œå¦åˆ™å®¢æˆ·ç«¯å¯èƒ½ä¼šæç¤ºè¯ä¹¦é“¾ä¸å®Œæ•´è€Œæ— æ³•é€šè¿‡éªŒè¯ã€‚æœåŠ¡å™¨è‡ªå·±ä½¿ç”¨ç§é’¥ s2_KeyPri å³å¯å®ç°éå¯¹ç§°åŠ å¯†ã€‚\nå®¢æˆ·ç«¯éªŒè¯æœåŠ¡å™¨çš„èº«ä»½ å•çº§è®¤è¯æœºæ„çš„éªŒè¯ ç®€è¦æµç¨‹\nï¼ˆå‡è®¾æ ¹è®¤è¯æœºæ„ã€ŒCAã€çš„æ ¹è¯ä¹¦**ã€Œca_Certã€**å·²ç»å®‰è£…åˆ°æ“ä½œç³»ç»Ÿä¸­ä¸”è¢«ä¿¡ä»»ã€‚ä¸‹åŒã€‚ï¼‰\n æœåŠ¡å™¨ã€ŒSã€ä¸‹å‘è¯ä¹¦**ã€Œs_Certã€**ç»™å®¢æˆ·ç«¯ã€ŒCã€ã€‚ å®¢æˆ·ç«¯ã€ŒCã€æ£€æŸ¥åˆ°**ã€Œs_Certã€**ä¸­çš„ ca_Infoï¼Œå‘ç°å®ƒæ˜¯ç”±ã€ŒCAã€ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€å–å‡º**ã€Œca_Certã€**ä¸­çš„ ca_KeyPubï¼Œå¯¹**ã€Œs_Certã€**ä¸­çš„ enc_s_Hash è¿›è¡Œè§£å¯†å¾—åˆ° s_Hashã€‚ å®¢æˆ·ç«¯ã€ŒCã€å¯¹**ã€Œs_Certã€**ä¸­çš„ï¼ˆs_KeyPub + s_Info + ca_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ s_Hash_tmpã€‚ å®¢æˆ·ç«¯ã€ŒCã€åˆ¤æ–­ s_Hash å’Œ s_Hash_tmp æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œåˆ™è¯æ˜**ã€Œs_Certã€**æ˜¯ç”±**ã€Œca_Certã€**ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€æ£€æŸ¥**ã€Œca_Certã€**ï¼Œå‘ç°è¯¥è¯ä¹¦æ˜¯æ ¹è¯ä¹¦ï¼Œä¸”å·²ç»è¢«ç³»ç»Ÿä¿¡ä»»ï¼Œèº«ä»½éªŒè¯é€šè¿‡ã€‚   å¦‚æœ**ã€Œca_Certã€**æ²¡æœ‰å®‰è£…åˆ°ç³»ç»Ÿä¸­ï¼Œé‚£ä¹ˆå°†æ— æ³•å¯¹ enc_s_Hash è¿›è¡Œè§£å¯†ï¼Œä¹Ÿå°±æ— æ³•éªŒè¯**ã€Œs_Certã€**çš„çœŸå®æ€§äº†ã€‚ä¸‹åŒã€‚\n äºŒçº§ï¼ˆæˆ–ä»¥ä¸Šï¼‰è®¤è¯æœºæ„çš„éªŒè¯ ç®€è¦æµç¨‹\n æœåŠ¡å™¨ã€ŒS2ã€ä¸‹å‘è¯ä¹¦**ã€Œs2_Certã€**ã€**ã€Œca2_Certã€**ç»™å®¢æˆ·ç«¯ã€ŒCã€ã€‚ å®¢æˆ·ç«¯ã€ŒCã€æ£€æŸ¥åˆ°**ã€Œs2_Certã€**ä¸­çš„ ca2_Infoï¼Œå‘ç°å®ƒæ˜¯ç”±ã€ŒCA2ã€ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€å–å‡º**ã€Œca2_Certã€**ä¸­çš„ ca2_KeyPubï¼Œå¯¹**ã€Œs2_Certã€**ä¸­çš„ enc_s2_Hash è¿›è¡Œè§£å¯†å¾—åˆ° s2_Hashã€‚ å®¢æˆ·ç«¯ã€ŒCã€å¯¹**ã€Œs2_Certã€**ä¸­çš„ï¼ˆs2_KeyPub + s2_Info + ca2_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ s2_Hash_tmpã€‚ å®¢æˆ·ç«¯ã€ŒCã€åˆ¤æ–­ s2_Hash å’Œ s2_Hash_tmp æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œåˆ™è¯æ˜**ã€Œs2_Certã€**æ˜¯ç”±**ã€Œca2_Certã€**ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€æ£€æŸ¥åˆ°**ã€Œca2_Certã€**ä¸­çš„ ca_Infoï¼Œå‘ç°å®ƒæ˜¯ç”±ã€ŒCAã€ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€å–å‡º**ã€Œca_Certã€**ä¸­çš„ ca_KeyPubï¼Œå¯¹**ã€Œca2_Certã€**ä¸­çš„ enc_ca2_Hash è¿›è¡Œè§£å¯†å¾—åˆ° ca2_Hashã€‚ å®¢æˆ·ç«¯ã€ŒCã€å¯¹**ã€Œca2_Certã€**ä¸­çš„ï¼ˆca2_KeyPub + ca2_Info + ca_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ ca2_Hash_tmpã€‚ å®¢æˆ·ç«¯ã€ŒCã€åˆ¤æ–­ ca2_Hash å’Œ ca2_Hash_tmp æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¯æ˜**ã€Œca2_Certã€**æ˜¯ç”±**ã€Œca_Certã€**ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€æ£€æŸ¥**ã€Œca_Certã€**ï¼Œå‘ç°è¯¥è¯ä¹¦æ˜¯æ ¹è¯ä¹¦ï¼Œä¸”å·²ç»è¢«ç³»ç»Ÿä¿¡ä»»ï¼Œèº«ä»½éªŒè¯é€šè¿‡ã€‚  ä¸‰çº§æˆ–æ›´å¤šçº§è®¤è¯æœºæ„è¯ä¹¦éªŒè¯æµç¨‹è·Ÿè¿™ä¸ªæµç¨‹å·®ä¸å¤šï¼Œå°±æ˜¯ä¸€ç¯æ‰£ä¸€ç¯åœ°éªŒè¯ä¸‹å»ã€‚\nåŠ å¯†ä¼ è¾“çš„æ•°æ® æœåŠ¡å™¨ã€ŒSã€çš„èº«ä»½å¾—åˆ°å®¢æˆ·ç«¯ã€ŒCã€çš„è®¤å¯ä¹‹åï¼ŒæœåŠ¡å™¨ã€ŒSã€å¯ä»¥ä½¿ç”¨ s_KeyPri å¯¹ä¼ å‡ºçš„æ•°æ®è¿›è¡ŒåŠ å¯†æˆ–è€…å¯¹ä¼ å…¥çš„æ•°æ®è¿›è¡Œè§£å¯†ã€‚\nåè¿‡æ¥ï¼Œå®¢æˆ·ç«¯ã€ŒCã€å¯ä»¥ä½¿ç”¨ s_KeyPub å¯¹ä¼ å‡ºçš„æ•°æ®è¿›è¡ŒåŠ å¯†æˆ–è€…å¯¹ä¼ å…¥çš„æ•°æ®è¿›è¡Œè§£å¯†ã€‚\nç”±äºéå¯¹ç§°åŠ å¯†çš„æ•ˆç‡è¾ƒä½ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨éå¯¹ç§°åŠ å¯†åå•†å¹¶äº¤æ¢ä¸€ä¸ªä¸´æ—¶çš„ä¼šè¯å¯†é’¥ä¹‹åï¼Œä½¿ç”¨ä¼šè¯å¯†é’¥è¿›è¡Œå¯¹ç§°åŠ å¯†ã€‚\nç°å®ä¸­çš„è¯ä¹¦éªŒè¯ ç°å®ä¸­ï¼Œä¸€äº›ä¼—æ‰€å‘¨çŸ¥ä¸”è¢«ä¿¡ä»»è¯ä¹¦è®¤è¯æœºæ„çš„æ ¹è¯ä¹¦éƒ½è¢«å†…ç½®åˆ°äº†æ“ä½œç³»ç»Ÿä¸­ã€‚\nè€Œå®¢æˆ·ç«¯åœ¨æ£€æŸ¥æœåŠ¡å™¨è¯ä¹¦çš„æ—¶å€™ï¼Œä¸€èˆ¬è¿˜ä¼šæ£€æŸ¥å®ƒçš„æœ‰æ•ˆæœŸä»¥åŠè¯¥è¯ä¹¦æ˜¯å¦åœ¨è®¤è¯æœºæ„çš„è¯ä¹¦åŠé”€åˆ—è¡¨ä¸­ã€‚è¯ä¹¦åŠé”€åˆ—è¡¨ä¸€èˆ¬æ˜¯åœ¨çº¿æ£€æŸ¥çš„ã€‚\nå‚è€ƒï¼š\n X.509æ•°å­—è¯ä¹¦çš„ç»“æ„ä¸è§£æ X.509 æ•°å­—è¯ä¹¦çš„åŸºæœ¬åŸç†åŠåº”ç”¨  HTTPæ¦‚è¿° HTTPæ˜¯ä¸€ä¸ªå±äºåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ï¼Œç”±äºå…¶ç®€æ·ã€å¿«é€Ÿçš„æ–¹å¼ï¼Œé€‚ç”¨äºåˆ†å¸ƒå¼è¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿã€‚\nHTTP/0.9 HTTP æ˜¯åŸºäº TCP/IP åè®®çš„åº”ç”¨å±‚åè®®ã€‚å®ƒä¸æ¶‰åŠæ•°æ®åŒ…ï¼ˆpacketï¼‰ä¼ è¾“ï¼Œä¸»è¦è§„å®šäº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡æ ¼å¼ï¼Œé»˜è®¤ä½¿ç”¨80ç«¯å£ã€‚\n åè®®è§„å®šï¼ŒæœåŠ¡å™¨åªèƒ½å›åº”HTMLæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä¸èƒ½å›åº”åˆ«çš„æ ¼å¼ã€‚\n HTTP/1.x  åœ¨æ—©æœŸï¼ŒHTTP ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ¨¡å‹æ¥å¤„ç†è¿™æ ·çš„è¿æ¥ã€‚è¿™äº›è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸæ˜¯çŸ­æš‚çš„ï¼šæ¯å‘èµ·ä¸€ä¸ªè¯·æ±‚æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œå¹¶åœ¨æ”¶åˆ°åº”ç­”æ—¶ç«‹å³å…³é—­ã€‚è¿æ¥çš„æˆæœ¬è¾ƒé«˜ã€‚\n å½“è¯·æ±‚å‘èµ·æ—¶ï¼Œç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½éƒ½ä¼šå¯¹æ€§èƒ½é€ æˆå½±å“ã€‚ç°ä»£æµè§ˆå™¨å¾€å¾€è¦å‘èµ·å¾ˆå¤šæ¬¡è¯·æ±‚(åå‡ ä¸ªæˆ–è€…æ›´å¤š)æ‰èƒ½æ‹¿åˆ°æ‰€éœ€çš„å®Œæ•´ä¿¡æ¯ï¼Œè¯æ˜äº†è¿™ä¸ªæ—©æœŸæ¨¡å‹çš„æ•ˆç‡ä½ä¸‹ã€‚\nåœ¨ HTTP/1.x é‡Œæœ‰å¤šç§æ¨¡å‹ï¼šçŸ­è¿æ¥, é•¿è¿æ¥, å’Œ HTTP æµæ°´çº¿ã€‚\nçŸ­é“¾æ¥æ¨¡å‹ HTTP/1.0 çš„é»˜è®¤æ¨¡å‹ã€‚æ¯ä¸€ä¸ª HTTP è¯·æ±‚éƒ½ç”±å®ƒè‡ªå·±ç‹¬ç«‹çš„è¿æ¥å®Œæˆï¼›è¿™æ„å‘³ç€å‘èµ·æ¯ä¸€ä¸ª HTTP è¯·æ±‚ä¹‹å‰éƒ½ä¼šæœ‰ä¸€æ¬¡ TCP æ¡æ‰‹ï¼Œè€Œä¸”æ˜¯è¿ç»­ä¸æ–­çš„ã€‚\n åœ¨ HTTP/1.1 ä¸­ï¼Œåªæœ‰å½“ Connection è¢«è®¾ç½®ä¸º close æ—¶æ‰ä¼šç”¨åˆ°è¿™ä¸ªæ¨¡å‹\n é•¿è¿æ¥æ¨¡å‹ ä¿æŒè¿æ¥å»å®Œæˆå¤šæ¬¡è¿ç»­çš„è¯·æ±‚ï¼Œå‡å°‘äº†ä¸æ–­é‡æ–°æ‰“å¼€è¿æ¥çš„æ—¶é—´ã€‚åœ¨ HTTP/1.1 é‡Œï¼Œé»˜è®¤å°±æ˜¯é•¿è¿æ¥çš„ã€‚\n çŸ­è¿æ¥æœ‰ä¸¤ä¸ªæ¯”è¾ƒå¤§çš„é—®é¢˜ï¼šåˆ›å»ºæ–°è¿æ¥è€—è´¹çš„æ—¶é—´å°¤ä¸ºæ˜æ˜¾ï¼Œå¦å¤– TCP è¿æ¥çš„æ€§èƒ½åªæœ‰åœ¨è¯¥è¿æ¥è¢«ä½¿ç”¨ä¸€æ®µæ—¶é—´å(çƒ­è¿æ¥)æ‰èƒ½å¾—åˆ°æ”¹å–„ã€‚å¦å¤–æˆ‘ä»¬çŸ¥é“ï¼ŒTCPåè®®æœ‰ä¸ªæ»‘åŠ¨çª—å£ï¼Œæœ‰æ…¢å¯åŠ¨è¿™å›äº‹ï¼Œå°±æ˜¯è¯´æ¯æ¬¡å»ºç«‹æ–°è¿æ¥åï¼Œæ•°æ®å…ˆæ˜¯æ…¢æ…¢åœ°ä¼ ï¼Œç„¶åæ»‘åŠ¨çª—å£æ…¢æ…¢å˜å¤§ï¼Œæ‰èƒ½è¾ƒé«˜é€Ÿåº¦åœ°ä¼ ã€‚\n å…·ä½“æµç¨‹ï¼š\nä¸€ä¸ªé•¿è¿æ¥ä¼šä¿æŒä¸€æ®µæ—¶é—´ï¼Œé‡å¤ç”¨äºå‘é€ä¸€ç³»åˆ—è¯·æ±‚ï¼ŒèŠ‚çœäº†æ–°å»º TCP è¿æ¥æ¡æ‰‹çš„æ—¶é—´ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ TCP çš„æ€§èƒ½å¢å¼ºèƒ½åŠ›ã€‚å½“ç„¶è¿™ä¸ªè¿æ¥ä¹Ÿä¸ä¼šä¸€ç›´ä¿ç•™ç€ï¼šè¿æ¥åœ¨ç©ºé—²ä¸€æ®µæ—¶é—´åä¼šè¢«å…³é—­(æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ Keep-Alive åè®®å¤´æ¥æŒ‡å®šä¸€ä¸ªæœ€å°çš„è¿æ¥ä¿æŒæ—¶é—´)ã€‚\nç¼ºç‚¹ï¼š\nå°±ç®—æ˜¯åœ¨ç©ºé—²çŠ¶æ€ï¼Œå®ƒè¿˜æ˜¯ä¼šæ¶ˆè€—æœåŠ¡å™¨èµ„æºï¼Œè€Œä¸”åœ¨é‡è´Ÿè½½æ—¶ï¼Œè¿˜æœ‰å¯èƒ½é­å— DoS attacks æ”»å‡»ã€‚è¿™ç§åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨éé•¿è¿æ¥ï¼Œå³å°½å¿«å…³é—­é‚£äº›ç©ºé—²çš„è¿æ¥ï¼Œä¹Ÿèƒ½å¯¹æ€§èƒ½æœ‰æ‰€æå‡ã€‚\n é•¿è¿æ¥ä¸€ä¸ªä¼˜åŒ–çš„æ–¹æ³•å°±æ˜¯è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œä½†æ˜¯å…·ä½“è¿™ä¸ªæ—¶é—´æ˜¯å¤šå°‘ï¼Œåº”è¯¥é€šè¿‡æµ‹è¯•ä¹‹åå¾—å‡ºä¸€ä¸ªè¾ƒä¸ºå‡è¡¡çš„æ—¶é—´ã€‚\n æµæ°´çº¿æ¨¡å‹(ç®¡çº¿åŒ–) å¤šä¸ªè¿ç»­çš„è¯·æ±‚ç”šè‡³éƒ½ä¸ç”¨ç­‰å¾…ç«‹å³è¿”å›å°±å¯ä»¥è¢«å‘é€ã€‚HTTP æµæ°´çº¿åœ¨ç°ä»£æµè§ˆå™¨ä¸­å¹¶ä¸æ˜¯é»˜è®¤è¢«å¯ç”¨çš„ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼ŒHTTP è¯·æ±‚æ˜¯æŒ‰é¡ºåºå‘å‡ºçš„ã€‚ä¸‹ä¸€ä¸ªè¯·æ±‚åªæœ‰åœ¨å½“å‰è¯·æ±‚æ”¶åˆ°åº”ç­”è¿‡åæ‰ä¼šè¢«å‘å‡ºã€‚ç”±äºä¼šå—åˆ°ç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½çš„é™åˆ¶ï¼Œåœ¨ä¸‹ä¸€ä¸ªè¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´ã€‚\n**æµæ°´çº¿æ˜¯åœ¨åŒä¸€æ¡é•¿è¿æ¥ä¸Šå‘å‡ºè¿ç»­çš„è¯·æ±‚ï¼Œè€Œä¸ç”¨ç­‰å¾…åº”ç­”è¿”å›ã€‚è¿™æ ·å¯ä»¥é¿å…è¿æ¥å»¶è¿Ÿã€‚ç†è®ºä¸Šè®²ï¼Œæ€§èƒ½è¿˜ä¼šå› ä¸ºä¸¤ä¸ª HTTP è¯·æ±‚æœ‰å¯èƒ½è¢«æ‰“åŒ…åˆ°ä¸€ä¸ª TCP æ¶ˆæ¯åŒ…ä¸­è€Œå¾—åˆ°æå‡ã€‚**å°±ç®— HTTP è¯·æ±‚ä¸æ–­çš„ç»§ç»­ï¼Œå°ºå¯¸ä¼šå¢åŠ ï¼Œä½†è®¾ç½® TCP çš„ MSS(Maximum Segment Size) é€‰é¡¹ï¼Œä»ç„¶è¶³å¤ŸåŒ…å«ä¸€ç³»åˆ—ç®€å•çš„è¯·æ±‚ã€‚\n æ¯”å¦‚ï¼Œå½“è¯·æ±‚ä¸€ä¸ªåŒ…å«10å¼ å›¾ç‰‡çš„HTML Webé¡µé¢ï¼Œä¸æŒ¨ä¸ªè¿æ¥ç›¸æ¯”ï¼Œç”¨æŒä¹…è¿æ¥å¯ä»¥è®©è¯·æ±‚æ›´å¿«ç»“æŸã€‚è€Œç®¡çº¿åŒ–æŠ€æœ¯åˆ™æ¯”æŒä¹…è¿æ¥è¿˜è¦å¿«ã€‚è¯·æ±‚æ•°è¶Šå¤šï¼Œæ—¶é—´å·®å°±è¶Šæ˜æ˜¾ã€‚\n é˜Ÿå¤´é˜»å¡ åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒHTTPéµå®ˆâ€œè¯·æ±‚-å“åº”â€çš„æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯æ¯æ¬¡å‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯è¿”å›å“åº”ï¼Œè¿™ç§æ¨¡å¼å¾ˆç®€å•ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªè‡´å‘½ç¼ºé™·é‚£å°±æ˜¯é¡µé¢ä¸­æœ‰å¤šä¸ªè¯·æ±‚ï¼Œæ¯ä¸ªè¯·æ±‚å¿…é¡»ç­‰åˆ°å‰ä¸€ä¸ªè¯·æ±‚å“åº”ä¹‹åæ‰èƒ½å‘é€ï¼Œå¹¶ä¸”å½“å‰è¯·æ±‚çš„å“åº”è¿”å›ä¹‹åï¼Œå½“å‰è¯·æ±‚çš„ä¸‹ä¸€ä¸ªè¯·æ±‚æ‰èƒ½å‘é€ï¼Œæµç¨‹å¦‚ä¸‹å›¾\nåœ¨TCPé“¾æ¥ä¸­ï¼Œhttpè¯·æ±‚å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªè¯·æ±‚å“åº”ä¹‹åï¼Œæ‰èƒ½å‘é€ï¼Œåé¢çš„ä¾æ¬¡ç±»æ¨ï¼Œç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœåœ¨ä¸€ä¸ªtcpé€šé“ä¸­å¦‚æœæŸä¸ªhttpè¯·æ±‚çš„å“åº”å› ä¸ºæŸä¸ªåŸå› æ²¡æœ‰åŠæ—¶è¿”å›ï¼Œåé¢çš„å“åº”ä¼šè¢«é˜»å¡ï¼Œè¿™å°±æ˜¯é˜Ÿå¤´é˜»å¡ã€‚\n æ³¨æ„è¿™é‡Œè¯´çš„æ˜¯å“åº”ä¹‹åï¼Œå¹¶ä¸æ˜¯è¯·ä¹‹å!\n ä¸ºäº†æé«˜é€Ÿåº¦å’Œæ•ˆç‡ï¼Œåœ¨æŒä¹…è¿æ¥çš„åŸºç¡€ä¸Šï¼ŒHTTP1.1è¿›ä¸€æ­¥åœ°æ”¯æŒåœ¨æŒä¹…è¿æ¥ä¸Šä½¿ç”¨ç®¡é“åŒ–ï¼ˆpipeliningï¼‰ç‰¹æ€§ã€‚ç®¡é“åŒ–å…è®¸å®¢æˆ·ç«¯åœ¨å·²å‘é€çš„è¯·æ±‚æ”¶åˆ°æœåŠ¡ç«¯çš„å“åº”ä¹‹å‰å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œå€Ÿæ­¤æ¥å‡å°‘ç­‰å¾…æ—¶é—´æé«˜ååï¼Œå¦‚æœå¤šä¸ªè¯·æ±‚èƒ½åœ¨åŒä¸€ä¸ªTCPåˆ†èŠ‚å‘é€çš„è¯ï¼Œè¿˜èƒ½æé«˜ç½‘ç»œåˆ©ç”¨ç‡ï¼Œæµç¨‹å¦‚å›¾ï¼š\nåŒä¸€ä¸ªtcpè¿æ¥ä¸­å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªhttpè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯å¹¶å‘ï¼Œä½†æ˜¯åœ¨å“åº”çš„æ—¶å€™ï¼Œå¿…é¡»æ’é˜Ÿå“åº”ï¼Œè°å…ˆåˆ°è¾¾çš„è°å…ˆå“åº”ï¼Œç›¸æ¯”ä¸æ”¯æŒç®¡é“åŒ–çš„httpè¯·æ±‚ç¡®å®æé«˜äº†æ•ˆç‡ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å±€é™æ€§ï¼Œå‡å¦‚å…¶ä¸­æŸä¸ªå“åº”å› ä¸ºæŸç§åŸå› å»¶è¿Ÿäº†å‡ ç§’ï¼Œåé¢çš„å“åº”éƒ½ä¼šè¢«é˜»å¡ã€‚ä¸Šé¢ç®­å¤´æ‰€æŒ‡çš„å“åº”å¦‚æœé˜»å¡äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªä¹Ÿæ˜¯é˜Ÿå¤´é˜»å¡ã€‚\nå¹¶ä¸”ä½¿ç”¨HTTPç®¡é“åŒ–è¿˜æœ‰ä¸€äº›é™åˆ¶:\n1ã€ç®¡é“åŒ–è¦æ±‚æœåŠ¡ç«¯æŒ‰ç…§è¯·æ±‚å‘é€çš„é¡ºåºè¿”å›å“åº”ï¼ˆFIFOï¼‰ï¼ŒåŸå› å¾ˆç®€å•ï¼ŒHTTPè¯·æ±‚å’Œå“åº”å¹¶æ²¡æœ‰åºå·æ ‡è¯†ï¼Œæ— æ³•å°†ä¹±åºçš„å“åº”ä¸è¯·æ±‚å…³è”èµ·æ¥ã€‚\n2ã€å½“å®¢æˆ·ç«¯åœ¨æ”¯æŒç®¡é“åŒ–æ—¶éœ€è¦ä¿æŒæœªæ”¶åˆ°å“åº”çš„è¯·æ±‚ï¼Œå½“è¿æ¥æ„å¤–ä¸­æ–­æ—¶ï¼Œéœ€è¦é‡æ–°å‘é€è¿™éƒ¨åˆ†è¯·æ±‚ã€‚å¦‚æœè¿™ä¸ªè¯·æ±‚åªæ˜¯ä»æœåŠ¡å™¨è·å–æ•°æ®ï¼Œé‚£ä¹ˆå¹¶ä¸ä¼šå¯¹èµ„æºé€ æˆä»»ä½•å½±å“ï¼Œè€Œå¦‚æœæ˜¯ä¸€ä¸ªæäº¤ä¿¡æ¯çš„è¯·æ±‚å¦‚postè¯·æ±‚ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šé€ æˆèµ„æºå¤šæ¬¡æäº¤ä»è€Œæ”¹å˜èµ„æºï¼Œè¿™æ˜¯ä¸å…è®¸çš„ã€‚è€Œä¸ä¼šå¯¹æœåŠ¡å™¨èµ„æºäº§ç”Ÿå½±å“çš„è¯·æ±‚æœ‰ä¸ªä¸“ä¸šåè¯å«åšå¹‚ç­‰è¯·æ±‚ã€‚å®¢æˆ·ç«¯åœ¨ä½¿ç”¨ç®¡é“åŒ–çš„æ—¶å€™è¯·æ±‚æ–¹å¼å¿…é¡»æ˜¯å¹‚ç­‰è¯·æ±‚ã€‚\næ¯”è¾ƒï¼š\nä¸Šé¢çš„ç®¡çº¿åŒ–çš„æ¨¡å‹å°±æ˜¯åŠ é€Ÿäº†è¯·æ±‚çš„è¿‡ç¨‹ï¼Œä½†æ˜¯å“åº”çš„è¿‡ç¨‹è¿˜æ˜¯å­˜åœ¨é˜Ÿå¤´é˜»å¡ã€‚\n å› ä¸ºHTTPç®¡é“åŒ–æœ¬èº«å¯èƒ½ä¼šå¯¼è‡´é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ï¼Œä»¥åŠä¸Šé¢æåˆ°çš„ä¸€äº›é™åˆ¶ï¼Œç°ä»£æµè§ˆå™¨é»˜è®¤éƒ½å…³é—­äº†ç®¡é“åŒ–ï¼Œå¹¶ä¸”å¤§éƒ¨åˆ†æœåŠ¡å™¨ä¹Ÿæ˜¯é»˜è®¤ä¸æ”¯æŒç®¡é“åŒ–çš„ã€‚\n å¦‚ä½•è§£å†³é˜Ÿå¤´é˜»å¡ï¼Ÿ\nå®¢æˆ·ç«¯ä½¿ç”¨å¹¶å‘é•¿è¿æ¥ï¼Œæ³¨æ„è¿™ä¸ªå¹¶å‘æŒ‡çš„æ˜¯tcpå¹¶å‘è¿æ¥ã€‚\n å¹¶å‘é•¿è¿æ¥è™½ç„¶åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†httpçš„é˜Ÿå¤´é˜»å¡ï¼Œä½†æ˜¯ä¼šå¯¹æœåŠ¡å™¨çš„æ€§èƒ½æœ‰è¾ƒé«˜çš„è¦æ±‚\n HTTP/2  HTTP/1.1 ç‰ˆçš„å¤´ä¿¡æ¯è‚¯å®šæ˜¯æ–‡æœ¬ï¼ˆASCIIç¼–ç ï¼‰ï¼Œæ•°æ®ä½“å¯ä»¥æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯äºŒè¿›åˆ¶ã€‚HTTP/2 åˆ™æ˜¯ä¸€ä¸ªå½»åº•çš„äºŒè¿›åˆ¶åè®®ï¼Œå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”ç»Ÿç§°ä¸º\u0026quot;å¸§\u0026rdquo;ï¼ˆframeï¼‰ï¼šå¤´ä¿¡æ¯å¸§å’Œæ•°æ®å¸§ã€‚\n ğŸ˜† HTTP/2 æ²¡æœ‰æ”¹åŠ¨ HTTP çš„åº”ç”¨è¯­ä¹‰ã€‚ HTTP æ–¹æ³•ã€çŠ¶æ€ä»£ç ã€URI å’Œæ ‡å¤´å­—æ®µç­‰æ ¸å¿ƒæ¦‚å¿µä¸€å¦‚å¾€å¸¸ã€‚ ä¸è¿‡ï¼ŒHTTP/2 ä¿®æ”¹äº†æ•°æ®æ ¼å¼åŒ–ï¼ˆåˆ†å¸§ï¼‰ä»¥åŠåœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é—´ä¼ è¾“çš„æ–¹å¼ã€‚è¿™ä¸¤ç‚¹ç»Ÿå¸…å…¨å±€ï¼Œé€šè¿‡æ–°çš„åˆ†å¸§å±‚å‘æˆ‘ä»¬çš„åº”ç”¨éšè—äº†æ‰€æœ‰å¤æ‚æ€§ã€‚ å› æ­¤ï¼Œæ‰€æœ‰ç°æœ‰çš„åº”ç”¨éƒ½å¯ä»¥ä¸å¿…ä¿®æ”¹è€Œåœ¨æ–°åè®®ä¸‹è¿è¡Œã€‚\n ä¸ºä»€ä¹ˆä¸æ˜¯ HTTP/1.2ï¼Ÿ\nä¸ºäº†å®ç° HTTP å·¥ä½œç»„è®¾å®šçš„æ€§èƒ½ç›®æ ‡ï¼ŒHTTP/2 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚ï¼Œè¯¥å±‚æ— æ³•ä¸ä¹‹å‰çš„ HTTP/1.x æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å‘åå…¼å®¹ï¼Œå› æ­¤åè®®çš„ä¸»ç‰ˆæœ¬æå‡åˆ° HTTP/2ã€‚\n äºŒè¿›åˆ¶åˆ†å¸§å±‚ HTTP/2 æ‰€æœ‰æ€§èƒ½å¢å¼ºçš„æ ¸å¿ƒåœ¨äºæ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•å°è£… HTTP æ¶ˆæ¯å¹¶åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“ã€‚\nè¿™é‡Œæ‰€è°“çš„â€œå±‚â€ï¼ŒæŒ‡çš„æ˜¯ä½äºå¥—æ¥å­—æ¥å£ä¸åº”ç”¨å¯è§çš„é«˜çº§ HTTP API ä¹‹é—´ä¸€ä¸ªç»è¿‡ä¼˜åŒ–çš„æ–°ç¼–ç æœºåˆ¶ï¼šHTTP çš„è¯­ä¹‰ï¼ˆåŒ…æ‹¬å„ç§åŠ¨è¯ã€æ–¹æ³•ã€æ ‡å¤´ï¼‰éƒ½ä¸å—å½±å“ï¼Œä¸åŒçš„æ˜¯ä¼ è¾“æœŸé—´å¯¹å®ƒä»¬çš„ç¼–ç æ–¹å¼å˜äº†ã€‚ HTTP/1.x åè®®ä»¥æ¢è¡Œç¬¦ä½œä¸ºçº¯æ–‡æœ¬çš„åˆ†éš”ç¬¦ï¼Œè€Œ HTTP/2 å°†æ‰€æœ‰ä¼ è¾“çš„ä¿¡æ¯åˆ†å‰²ä¸ºæ›´å°çš„æ¶ˆæ¯å’Œå¸§ï¼Œå¹¶é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼å¯¹å®ƒä»¬ç¼–ç ã€‚\næ•°æ®æµã€æ¶ˆæ¯å’Œå¸§  æ•°æ®æµï¼šå·²å»ºç«‹çš„è¿æ¥å†…çš„åŒå‘å­—èŠ‚æµï¼Œå¯ä»¥æ‰¿è½½ä¸€æ¡æˆ–å¤šæ¡æ¶ˆæ¯ã€‚ æ¶ˆæ¯ï¼šä¸é€»è¾‘è¯·æ±‚æˆ–å“åº”æ¶ˆæ¯å¯¹åº”çš„å®Œæ•´çš„ä¸€ç³»åˆ—å¸§ã€‚ å¸§ï¼šHTTP/2 é€šä¿¡çš„æœ€å°å•ä½ï¼Œæ¯ä¸ªå¸§éƒ½åŒ…å«å¸§å¤´ï¼Œè‡³å°‘ä¹Ÿä¼šæ ‡è¯†å‡ºå½“å‰å¸§æ‰€å±çš„æ•°æ®æµã€‚  å…³ç³»ï¼š\n æ‰€æœ‰é€šä¿¡éƒ½åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸Šå®Œæˆï¼Œæ­¤è¿æ¥å¯ä»¥æ‰¿è½½ä»»æ„æ•°é‡çš„åŒå‘æ•°æ®æµã€‚(å¤šå·¥) æ¯ä¸ªæ•°æ®æµéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦å’Œå¯é€‰çš„ä¼˜å…ˆçº§ä¿¡æ¯ï¼Œç”¨äºæ‰¿è½½åŒå‘æ¶ˆæ¯ã€‚ æ¯æ¡æ¶ˆæ¯éƒ½æ˜¯ä¸€æ¡é€»è¾‘ HTTP æ¶ˆæ¯ï¼ˆä¾‹å¦‚è¯·æ±‚æˆ–å“åº”ï¼‰ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå¸§ã€‚ å¸§æ˜¯æœ€å°çš„é€šä¿¡å•ä½ï¼Œæ‰¿è½½ç€ç‰¹å®šç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚ HTTP æ ‡å¤´ã€æ¶ˆæ¯è´Ÿè½½ç­‰ç­‰ã€‚ æ¥è‡ªä¸åŒæ•°æ®æµçš„å¸§å¯ä»¥äº¤é”™å‘é€ï¼Œç„¶åå†æ ¹æ®æ¯ä¸ªå¸§å¤´çš„æ•°æ®æµæ ‡è¯†ç¬¦é‡æ–°ç»„è£…ã€‚  ç®€è¨€ä¹‹ï¼ŒHTTP/2 å°† HTTP åè®®é€šä¿¡åˆ†è§£ä¸ºäºŒè¿›åˆ¶ç¼–ç å¸§çš„äº¤æ¢ï¼Œè¿™äº›å¸§å¯¹åº”ç€ç‰¹å®šæ•°æ®æµä¸­çš„æ¶ˆæ¯ã€‚æ‰€æœ‰è¿™äº›éƒ½åœ¨ä¸€ä¸ª TCP è¿æ¥å†…å¤ç”¨ã€‚ è¿™æ˜¯ HTTP/2 åè®®æ‰€æœ‰å…¶ä»–åŠŸèƒ½å’Œæ€§èƒ½ä¼˜åŒ–çš„åŸºç¡€ã€‚\nHTTP/2 å¸§ç»“æ„å¦‚ä¸‹ï¼š\nå®é™…çš„ä¼ è¾“è¿‡ç¨‹å¯èƒ½æ˜¯ä¸‹é¢è¿™æ ·(ååé‡å¢å¤§)ï¼š\nè¯·æ±‚ä¸å“åº”å¤ç”¨ HTTP/2 ä¸­æ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚å®ç°äº†å®Œæ•´çš„è¯·æ±‚å’Œå“åº”å¤ç”¨ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥å°† HTTP æ¶ˆæ¯åˆ†è§£ä¸ºäº’ä¸ä¾èµ–çš„å¸§ï¼Œç„¶åäº¤é”™å‘é€ï¼Œæœ€åå†åœ¨å¦ä¸€ç«¯æŠŠå®ƒä»¬é‡æ–°ç»„è£…èµ·æ¥ã€‚\næ•°æ®æµä¼˜å…ˆçº§ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸Šå›¾ä¸­çš„å‡ ä¸ªæ“ä½œç¤ºä¾‹ã€‚ ä»å·¦åˆ°å³ä¾æ¬¡ä¸ºï¼š\n æ•°æ®æµ A å’Œæ•°æ®æµ B éƒ½æ²¡æœ‰æŒ‡å®šçˆ¶ä¾èµ–é¡¹ï¼Œä¾èµ–äºéšå¼â€œæ ¹æ•°æ®æµâ€ï¼›A çš„æƒé‡ä¸º 12ï¼ŒB çš„æƒé‡ä¸º 4ã€‚å› æ­¤ï¼Œæ ¹æ®æ¯”ä¾‹æƒé‡ï¼šæ•°æ®æµ B è·å¾—çš„èµ„æºæ˜¯ A æ‰€è·èµ„æºçš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ æ•°æ®æµ D ä¾èµ–äºæ ¹æ•°æ®æµï¼›C ä¾èµ–äº Dã€‚ å› æ­¤ï¼ŒD åº”å…ˆäº C è·å¾—å®Œæ•´èµ„æºåˆ†é…ã€‚ æƒé‡ä¸é‡è¦ï¼Œå› ä¸º C çš„ä¾èµ–å…³ç³»æ‹¥æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚ æ•°æ®æµ D åº”å…ˆäº C è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›C åº”å…ˆäº A å’Œ B è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›æ•°æ®æµ B è·å¾—çš„èµ„æºæ˜¯ A æ‰€è·èµ„æºçš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ æ•°æ®æµ D åº”å…ˆäº E å’Œ C è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›E å’Œ C åº”å…ˆäº A å’Œ B è·å¾—ç›¸åŒçš„èµ„æºåˆ†é…ï¼›A å’Œ B åº”åŸºäºå…¶æƒé‡è·å¾—æ¯”ä¾‹åˆ†é…ã€‚  æµæ§åˆ¶ æµæ§åˆ¶æ˜¯ä¸€ç§é˜»æ­¢å‘é€æ–¹å‘æ¥æ”¶æ–¹å‘é€å¤§é‡æ•°æ®çš„æœºåˆ¶ï¼Œä»¥å…è¶…å‡ºåè€…çš„éœ€æ±‚æˆ–å¤„ç†èƒ½åŠ›ï¼šå‘é€æ–¹å¯èƒ½éå¸¸ç¹å¿™ã€å¤„äºè¾ƒé«˜çš„è´Ÿè½½ä¹‹ä¸‹ï¼Œä¹Ÿå¯èƒ½ä»…ä»…å¸Œæœ›ä¸ºç‰¹å®šæ•°æ®æµåˆ†é…å›ºå®šé‡çš„èµ„æºã€‚ ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯å¯èƒ½è¯·æ±‚äº†ä¸€ä¸ªå…·æœ‰è¾ƒé«˜ä¼˜å…ˆçº§çš„å¤§å‹è§†é¢‘æµï¼Œä½†æ˜¯ç”¨æˆ·å·²ç»æš‚åœè§†é¢‘ï¼Œå®¢æˆ·ç«¯ç°åœ¨å¸Œæœ›æš‚åœæˆ–é™åˆ¶ä»æœåŠ¡å™¨çš„ä¼ è¾“ï¼Œä»¥å…æå–å’Œç¼“å†²ä¸å¿…è¦çš„æ•°æ®ã€‚ å†æ¯”å¦‚ï¼Œä¸€ä¸ªä»£ç†æœåŠ¡å™¨å¯èƒ½å…·æœ‰è¾ƒå¿«çš„ä¸‹æ¸¸è¿æ¥å’Œè¾ƒæ…¢çš„ä¸Šæ¸¸è¿æ¥ï¼Œå¹¶ä¸”ä¹Ÿå¸Œæœ›è°ƒèŠ‚ä¸‹æ¸¸è¿æ¥ä¼ è¾“æ•°æ®çš„é€Ÿåº¦ä»¥åŒ¹é…ä¸Šæ¸¸è¿æ¥çš„é€Ÿåº¦æ¥æ§åˆ¶å…¶èµ„æºåˆ©ç”¨ç‡ï¼›ç­‰ç­‰ã€‚ç±»ä¼¼TCPæµé‡æ§åˆ¶ã€‚\næœåŠ¡å™¨æ¨é€ HTTP/2 æ–°å¢çš„å¦ä¸€ä¸ªå¼ºå¤§çš„æ–°åŠŸèƒ½æ˜¯ï¼ŒæœåŠ¡å™¨å¯ä»¥å¯¹ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚å‘é€å¤šä¸ªå“åº”ã€‚ æ¢å¥è¯è¯´ï¼Œé™¤äº†å¯¹æœ€åˆè¯·æ±‚çš„å“åº”å¤–ï¼ŒæœåŠ¡å™¨è¿˜å¯ä»¥å‘å®¢æˆ·ç«¯æ¨é€é¢å¤–èµ„æºï¼ˆå›¾ 12-5ï¼‰ï¼Œè€Œæ— éœ€å®¢æˆ·ç«¯æ˜ç¡®åœ°è¯·æ±‚ã€‚\næ ‡å¤´å‹ç¼© æ¯ä¸ª HTTP ä¼ è¾“éƒ½æ‰¿è½½ä¸€ç»„æ ‡å¤´ï¼Œè¿™äº›æ ‡å¤´è¯´æ˜äº†ä¼ è¾“çš„èµ„æºåŠå…¶å±æ€§ã€‚ åœ¨ HTTP/1.x ä¸­ï¼Œæ­¤å…ƒæ•°æ®å§‹ç»ˆä»¥çº¯æ–‡æœ¬å½¢å¼ï¼Œé€šå¸¸ä¼šç»™æ¯ä¸ªä¼ è¾“å¢åŠ  500â€“800 å­—èŠ‚çš„å¼€é”€ã€‚å¦‚æœä½¿ç”¨ HTTP Cookieï¼Œå¢åŠ çš„å¼€é”€æœ‰æ—¶ä¼šè¾¾åˆ°ä¸Šåƒå­—èŠ‚ã€‚ä¸ºäº†å‡å°‘æ­¤å¼€é”€å’Œæå‡æ€§èƒ½ï¼ŒHTTP/2 ä½¿ç”¨ HPACK å‹ç¼©æ ¼å¼å‹ç¼©è¯·æ±‚å’Œå“åº”æ ‡å¤´å…ƒæ•°æ®ï¼Œè¿™ç§æ ¼å¼é‡‡ç”¨ä¸¤ç§ç®€å•ä½†æ˜¯å¼ºå¤§çš„æŠ€æœ¯ï¼š\n è¿™ç§æ ¼å¼æ”¯æŒé€šè¿‡é™æ€éœå¤«æ›¼ä»£ç å¯¹ä¼ è¾“çš„æ ‡å¤´å­—æ®µè¿›è¡Œç¼–ç ï¼Œä»è€Œå‡å°äº†å„ä¸ªä¼ è¾“çš„å¤§å°ã€‚ è¿™ç§æ ¼å¼è¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ—¶ç»´æŠ¤å’Œæ›´æ–°ä¸€ä¸ªåŒ…å«ä¹‹å‰è§è¿‡çš„æ ‡å¤´å­—æ®µçš„ç´¢å¼•åˆ—è¡¨ï¼ˆæ¢å¥è¯è¯´ï¼Œå®ƒå¯ä»¥å»ºç«‹ä¸€ä¸ªå…±äº«çš„å‹ç¼©ä¸Šä¸‹æ–‡ï¼‰ï¼Œæ­¤åˆ—è¡¨éšåä¼šç”¨ä½œå‚è€ƒï¼Œå¯¹ä¹‹å‰ä¼ è¾“çš„å€¼è¿›è¡Œæœ‰æ•ˆç¼–ç ã€‚  åˆ©ç”¨éœå¤«æ›¼ç¼–ç ï¼Œå¯ä»¥åœ¨ä¼ è¾“æ—¶å¯¹å„ä¸ªå€¼è¿›è¡Œå‹ç¼©ï¼Œè€Œåˆ©ç”¨ä¹‹å‰ä¼ è¾“å€¼çš„ç´¢å¼•åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ è¾“ç´¢å¼•å€¼çš„æ–¹å¼å¯¹é‡å¤å€¼è¿›è¡Œç¼–ç ï¼Œç´¢å¼•å€¼å¯ç”¨äºæœ‰æ•ˆæŸ¥è¯¢å’Œé‡æ„å®Œæ•´çš„æ ‡å¤´é”®å€¼å¯¹ã€‚\nå“ˆå¤«æ›¼æ ‘å¦‚ä½•å‹ç¼© æ–‡ä»¶å‹ç¼©çš„ä¸»è¦æ€æƒ³æ˜¯åˆ©ç”¨å“ˆå¤«æ›¼ç¼–ç æ¥å®ç°çš„ï¼Œä½†æ˜¯å¾—åˆ°ç¼–ç ä¹‹å‰æˆ‘ä»¬éœ€è¦æ„å»ºè¿™æ£µæ ‘ã€‚é‚£ä¹ˆåˆ©ç”¨ä»€ä¹ˆæ¥æ„å»ºæ ‘å‘¢ï¼Ÿï¼è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°ï¼Œç”¨æ¬¡æ•°æ¥æ„å»ºHuffmanTreeã€‚å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ª.txtçš„å°æ–‡ä»¶ï¼Œå†…å®¹æ˜¯\u0026quot;aaaabbbccd\u0026rdquo;ã€‚å­—ç¬¦å­˜åœ¨è®¡ç®—æœºä¸­æ—¶ä»¥å­—èŠ‚ä¸ºå•ä½çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†è¿™äº›å­—ç¬¦å‹ç¼©æˆ0ã€1è¡¨ç¤ºçš„ç¼–ç ï¼Œ0å’Œ1è¡¨ç¤ºå­—èŠ‚ä¸­çš„â€œä½â€ï¼Œè¿™æ ·èƒ½å¤§å¤§é™ä½æ–‡ä»¶çš„å¤§å°ã€‚\nä½“éªŒHTTP2 https://http2.akamai.com/demo\nå‚è€ƒé“¾æ¥ï¼š\n HTTP è¿æ¥ç®¡ç†è¿›åŒ–è®º https://developers.google.com/web/fundamentals/performance/http2?hl=zh-cn ç™½è¯httpé˜Ÿå¤´é˜»å¡  HTTPSè¯¦è§£ ä»€ä¹ˆæ˜¯HTTPSï¼Ÿ HTTPSæ˜¯åœ¨HTTPä¸Šå»ºç«‹SSLåŠ å¯†å±‚ï¼Œå¹¶å¯¹ä¼ è¾“æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œæ˜¯HTTPåè®®çš„å®‰å…¨ç‰ˆã€‚ç°åœ¨å®ƒè¢«å¹¿æ³›ç”¨äºä¸‡ç»´ç½‘ä¸Šå®‰å…¨æ•æ„Ÿçš„é€šè®¯ï¼Œä¾‹å¦‚äº¤æ˜“æ”¯ä»˜æ–¹é¢ã€‚\nHTTPåè®®å­˜åœ¨çš„é—®é¢˜ï¼Ÿ  é€šä¿¡ä½¿ç”¨æ˜æ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½è¢«çªƒå¬ æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥å¯èƒ½é­ç¯¡æ”¹ ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡ä¼ªè£…  HTTPSçš„ä¼˜åŠ¿ï¼Ÿ  æ•°æ®éšç§æ€§ï¼šå†…å®¹ç»è¿‡å¯¹ç§°åŠ å¯†ï¼Œæ¯ä¸ªè¿æ¥ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„åŠ å¯†å¯†é’¥ æ•°æ®å®Œæ•´æ€§ï¼šå†…å®¹ä¼ è¾“ç»è¿‡å®Œæ•´æ€§æ ¡éªŒ èº«ä»½è®¤è¯ï¼šç¬¬ä¸‰æ–¹æ— æ³•ä¼ªé€ æœåŠ¡ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰èº«ä»½  HTTPSåè®® HTTPSå¹¶éæ˜¯åº”ç”¨å±‚çš„ä¸€ç§æ–°åè®®ã€‚åªæ˜¯HTTPé€šä¿¡æ¥å£éƒ¨åˆ†ç”¨SSLå’ŒTLSåè®®ä»£æ›¿è€Œå·²ã€‚\né€šå¸¸ï¼ŒHTTPç›´æ¥å’ŒTCPé€šä¿¡ã€‚å½“ä½¿ç”¨SSLæ—¶ï¼Œåˆ™æ¼”å˜æˆå…ˆå’ŒSSLé€šä¿¡ï¼Œå†ç”±SSLå’ŒTCPé€šä¿¡äº†ã€‚ç®€è¨€ä¹‹ï¼Œæ‰€è°“HTTPSï¼Œå…¶å®å°±æ˜¯èº«æŠ«SSLåè®®è¿™å±‚å¤–å£³çš„HTTPã€‚\nåœ¨é‡‡ç”¨SSLåï¼ŒHTTPå°±æ‹¥æœ‰äº†HTTPSçš„åŠ å¯†ã€è¯ä¹¦å’Œå®Œæ•´æ€§ä¿æŠ¤è¿™äº›åŠŸèƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´HTTPåŠ ä¸ŠåŠ å¯†å¤„ç†å’Œè®¤è¯ä»¥åŠå®Œæ•´æ€§ä¿æŠ¤åå³æ˜¯HTTPSã€‚\nHTTPS åè®®çš„ä¸»è¦åŠŸèƒ½åŸºæœ¬éƒ½ä¾èµ–äº TLS/SSL åè®®ï¼ŒTLS/SSL çš„åŠŸèƒ½å®ç°ä¸»è¦ä¾èµ–äºä¸‰ç±»åŸºæœ¬ç®—æ³•ï¼šæ•£åˆ—å‡½æ•° ã€å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Œå…¶åˆ©ç”¨éå¯¹ç§°åŠ å¯†å®ç°èº«ä»½è®¤è¯å’Œå¯†é’¥åå•†ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†çš„å¯†é’¥å¯¹æ•°æ®åŠ å¯†ï¼ŒåŸºäºæ•£åˆ—å‡½æ•°éªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§ã€‚\næ•°å­—è¯ä¹¦ æ•°å­—è¯ä¹¦è®¤è¯æœºæ„å¤„äºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨åŒæ–¹éƒ½å¯ä¿¡èµ–çš„ç¬¬ä¸‰æ–¹æœºæ„çš„ç«‹åœºä¸Šã€‚\næ•°å­—è¯ä¹¦è®¤è¯æœºæ„çš„ä¸šåŠ¡æµç¨‹ï¼š\n æœåŠ¡å™¨çš„è¿è¥äººå‘˜å‘ç¬¬ä¸‰æ–¹æœºæ„CAæäº¤å…¬é’¥ã€ç»„ç»‡ä¿¡æ¯ã€ä¸ªäººä¿¡æ¯(åŸŸå)ç­‰ä¿¡æ¯å¹¶ç”³è¯·è®¤è¯; CAé€šè¿‡çº¿ä¸Šã€çº¿ä¸‹ç­‰å¤šç§æ‰‹æ®µéªŒè¯ç”³è¯·è€…æä¾›ä¿¡æ¯çš„çœŸå®æ€§ï¼Œå¦‚ç»„ç»‡æ˜¯å¦å­˜åœ¨ã€ä¼ä¸šæ˜¯å¦åˆæ³•ï¼Œæ˜¯å¦æ‹¥æœ‰åŸŸåçš„æ‰€æœ‰æƒç­‰; å¦‚ä¿¡æ¯å®¡æ ¸é€šè¿‡ï¼ŒCAä¼šå‘ç”³è¯·è€…ç­¾å‘è®¤è¯æ–‡ä»¶-è¯ä¹¦ã€‚è¯ä¹¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼šç”³è¯·è€…å…¬é’¥ã€ç”³è¯·è€…çš„ç»„ç»‡ä¿¡æ¯å’Œä¸ªäººä¿¡æ¯ã€ç­¾å‘æœºæ„ CAçš„ä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ã€è¯ä¹¦åºåˆ—å·ç­‰ä¿¡æ¯çš„æ˜æ–‡ï¼ŒåŒæ—¶åŒ…å«ä¸€ä¸ªç­¾åã€‚ å…¶ä¸­ç­¾åçš„äº§ç”Ÿç®—æ³•ï¼šé¦–å…ˆï¼Œä½¿ç”¨æ•£åˆ—å‡½æ•°è®¡ç®—å…¬å¼€çš„æ˜æ–‡ä¿¡æ¯çš„ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œé‡‡ç”¨ CAçš„ç§é’¥å¯¹ä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼Œå¯†æ–‡å³ç­¾å; å®¢æˆ·ç«¯ Client å‘æœåŠ¡å™¨ Server å‘å‡ºè¯·æ±‚æ—¶ï¼ŒServer è¿”å›è¯ä¹¦æ–‡ä»¶; å®¢æˆ·ç«¯ Client è¯»å–è¯ä¹¦ä¸­çš„ç›¸å…³çš„æ˜æ–‡ä¿¡æ¯ï¼Œé‡‡ç”¨ç›¸åŒçš„æ•£åˆ—å‡½æ•°è®¡ç®—å¾—åˆ°ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œåˆ©ç”¨å¯¹åº” CAçš„å…¬é’¥è§£å¯†ç­¾åæ•°æ®ï¼Œå¯¹æ¯”è¯ä¹¦çš„ä¿¡æ¯æ‘˜è¦ï¼Œå¦‚æœä¸€è‡´ï¼Œåˆ™å¯ä»¥ç¡®è®¤è¯ä¹¦çš„åˆæ³•æ€§ï¼Œå³æœåŠ¡å™¨çš„å…¬å¼€å¯†é’¥æ˜¯å€¼å¾—ä¿¡èµ–çš„ã€‚ å®¢æˆ·ç«¯è¿˜ä¼šéªŒè¯è¯ä¹¦ç›¸å…³çš„åŸŸåä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ç­‰ä¿¡æ¯; å®¢æˆ·ç«¯ä¼šå†…ç½®ä¿¡ä»»CAçš„è¯ä¹¦ä¿¡æ¯(åŒ…å«å…¬é’¥)ï¼Œå¦‚æœCAä¸è¢«ä¿¡ä»»ï¼Œåˆ™æ‰¾ä¸åˆ°å¯¹åº” CAçš„è¯ä¹¦ï¼Œè¯ä¹¦ä¹Ÿä¼šè¢«åˆ¤å®šéæ³•ã€‚  HTTPSå·¥ä½œæµç¨‹   Clientå‘èµ·ä¸€ä¸ªHTTPSï¼ˆæ¯”å¦‚https://juejin.im/user/5a9a9cdcf265da238b7d771cï¼‰çš„è¯·æ±‚ï¼Œæ ¹æ®RFC2818çš„è§„å®šï¼ŒClientçŸ¥é“éœ€è¦è¿æ¥Serverçš„443ï¼ˆé»˜è®¤ï¼‰ç«¯å£ã€‚\n  ServeræŠŠäº‹å…ˆé…ç½®å¥½çš„å…¬é’¥è¯ä¹¦ï¼ˆpublic key certificateï¼‰è¿”å›ç»™å®¢æˆ·ç«¯ã€‚\n  ClientéªŒè¯å…¬é’¥è¯ä¹¦ï¼šæ¯”å¦‚æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…ï¼Œè¯ä¹¦çš„ç”¨é€”æ˜¯ä¸æ˜¯åŒ¹é…Clientè¯·æ±‚çš„ç«™ç‚¹ï¼Œæ˜¯ä¸æ˜¯åœ¨CRLåŠé”€åˆ—è¡¨é‡Œé¢ï¼Œå®ƒçš„ä¸Šä¸€çº§è¯ä¹¦æ˜¯å¦æœ‰æ•ˆï¼Œè¿™æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œç›´åˆ°éªŒè¯åˆ°æ ¹è¯ä¹¦ï¼ˆæ“ä½œç³»ç»Ÿå†…ç½®çš„Rootè¯ä¹¦æˆ–è€…Clientå†…ç½®çš„Rootè¯ä¹¦ï¼‰ã€‚å¦‚æœéªŒè¯é€šè¿‡åˆ™ç»§ç»­ï¼Œä¸é€šè¿‡åˆ™æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ã€‚\n  Clientä½¿ç”¨ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ç”ŸæˆåŠ å¯†æ‰€ä½¿ç”¨çš„å¯¹ç§°å¯†é’¥ï¼Œç„¶åç”¨è¯ä¹¦çš„å…¬é’¥åŠ å¯†è¿™ä¸ªå¯¹ç§°å¯†é’¥ï¼Œå‘ç»™Serverã€‚\n  Serverä½¿ç”¨è‡ªå·±çš„ç§é’¥ï¼ˆprivate keyï¼‰è§£å¯†è¿™ä¸ªæ¶ˆæ¯ï¼Œå¾—åˆ°å¯¹ç§°å¯†é’¥ã€‚è‡³æ­¤ï¼ŒClientå’ŒServeråŒæ–¹éƒ½æŒæœ‰äº†ç›¸åŒçš„å¯¹ç§°å¯†é’¥ã€‚\n  Serverä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†â€œæ˜æ–‡å†…å®¹Aâ€ï¼Œå‘é€ç»™Clientã€‚\n  Clientä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å“åº”çš„å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹Aâ€ã€‚\n  Clientå†æ¬¡å‘èµ·HTTPSçš„è¯·æ±‚ï¼Œä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†è¯·æ±‚çš„â€œæ˜æ–‡å†…å®¹Bâ€ï¼Œç„¶åServerä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹Bâ€ã€‚\n  å‚è€ƒï¼š\n HTTPSçš„å®‰å…¨åŸç†  è™šæ‹ŸIPåŸç† è™šæ‹ŸIPæŠ€æœ¯ã€‚è™šæ‹ŸIPï¼Œå°±æ˜¯ä¸€ä¸ªæœªåˆ†é…ç»™çœŸå®ä¸»æœºçš„IPï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹å¤–æä¾›æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºé™¤äº†æœ‰ä¸€ä¸ªçœŸå®IPå¤–è¿˜æœ‰ä¸€ä¸ªè™šIPï¼Œä½¿ç”¨è¿™ä¸¤ä¸ªIPä¸­çš„ä»»æ„ä¸€ä¸ªéƒ½å¯ä»¥è¿æ¥åˆ°è¿™å°ä¸»æœºï¼Œæ‰€æœ‰é¡¹ç›®ä¸­æ•°æ®åº“é“¾æ¥ä¸€é¡¹é…ç½®çš„éƒ½æ˜¯è¿™ä¸ªè™šIPï¼Œå½“æœåŠ¡å™¨å‘ç”Ÿæ•…éšœæ— æ³•å¯¹å¤–æä¾›æœåŠ¡æ—¶ï¼ŒåŠ¨æ€å°†è¿™ä¸ªè™šIPåˆ‡æ¢åˆ°å¤‡ç”¨ä¸»æœºã€‚\nå…¶å®ç°åŸç†ä¸»è¦æ˜¯é  TCP/IP çš„ ARP åè®®ã€‚å› ä¸ºIPåœ°å€åªæ˜¯ä¸€ä¸ªé€»è¾‘åœ°å€ï¼Œåœ¨ä»¥å¤ªç½‘ä¸­ MAC åœ°å€æ‰æ˜¯çœŸæ­£ç”¨æ¥è¿›è¡Œæ•°æ®ä¼ è¾“çš„ç‰©ç†åœ°å€ï¼Œæ¯å°ä¸»æœºä¸­éƒ½æœ‰ä¸€ä¸ª ARP é«˜é€Ÿç¼“å­˜ï¼Œå­˜å‚¨åŒä¸€ä¸ªç½‘ç»œå†…çš„ IP åœ°å€ä¸ MAC åœ°å€çš„å¯¹åº”å…³ç³»ï¼Œä»¥å¤ªç½‘ä¸­çš„ä¸»æœºå‘é€æ•°æ®æ—¶ä¼šå…ˆä»è¿™ä¸ªç¼“å­˜ä¸­æŸ¥è¯¢ç›®æ ‡ IP å¯¹åº”çš„ MAC åœ°å€ï¼Œä¼šå‘è¿™ä¸ª MAC åœ°å€å‘é€æ•°æ®ã€‚æ“ä½œç³»ç»Ÿä¼šè‡ªåŠ¨ç»´æŠ¤è¿™ä¸ªç¼“å­˜ã€‚è¿™å°±æ˜¯æ•´ä¸ªå®ç°çš„å…³é”®ã€‚\nå‚è€ƒï¼š\n è™šæ‹ŸIPæŠ€æœ¯  ä¼ è¾“å±‚ğŸš™ TCPã€° TCPä¸­æµçš„è§£é‡Š TCPä¸­çš„â€œæµâ€(stream)æŒ‡çš„æ˜¯æµå…¥åˆ°è¿›ç¨‹æˆ–ä»è¿›ç¨‹æµå‡ºçš„å­—èŠ‚åºåˆ—ã€‚â€œé¢å‘å­—èŠ‚æµâ€çš„å«ä¹‰æ˜¯ï¼šè™½ç„¶åº”ç”¨ç¨‹åºå’ŒTCPçš„äº¤äº’æ˜¯ä¸€æ¬¡ä¸€ä¸ªæ•°æ®å—ï¼ˆå¤§å°ä¸ç­‰ï¼‰ï¼Œä½†TCPæŠŠåº”ç”¨ç¨‹åºäº¤ä¸‹æ¥çš„æ•°æ®çœ‹æˆä»…ä»…æ˜¯ä¸€è¿ä¸²çš„æ— ç»“æ„çš„å­—èŠ‚æµã€‚TCPå¹¶ä¸çŸ¥é“æ‰€ä¼ é€çš„å­—èŠ‚æµçš„å«ä¹‰ã€‚TCPä¸ä¿è¯æ¥æ”¶æ–¹åº”ç”¨ç¨‹åºæ‰€æ”¶åˆ°çš„æ•°æ®å—å’Œå‘é€æ–¹åº”ç”¨ç¨‹åºæ‰€å‘å‡ºçš„æ•°æ®å—å…·æœ‰å¯¹åº”å¤§å°çš„å…³ç³»ï¼ˆä¾‹å¦‚ï¼Œå‘é€æ–¹åº”ç”¨ç¨‹åºäº¤ç»™å‘é€æ–¹çš„TCPå…±10ä¸ªæ•°æ®å—ï¼Œä½†æ¥æ”¶æ–¹çš„TCPå¯èƒ½åªç”¨äº†4ä¸ªæ•°æ®å—å°±æŠŠæ”¶åˆ°çš„å­—èŠ‚æµäº¤ä»˜ä¸Šå±‚çš„åº”ç”¨ç¨‹åºï¼‰ã€‚ä½†æ¥æ”¶æ–¹åº”ç”¨ç¨‹åºæ”¶åˆ°çš„å­—èŠ‚æµå¿…é¡»å’Œå‘é€æ–¹åº”ç”¨ç¨‹åºå‘å‡ºçš„å­—èŠ‚æµå®Œå…¨ä¸€æ ·ã€‚å½“ç„¶ï¼Œæ¥æ”¶æ–¹çš„åº”ç”¨ç¨‹åºå¿…é¡»æœ‰èƒ½åŠ›è¯†åˆ«æ”¶åˆ°çš„å­—èŠ‚æµï¼ŒæŠŠå®ƒè¿˜åŸæˆæœ‰æ„ä¹‰çš„åº”ç”¨å±‚æ•°æ®ã€‚\nä¸€ä¸ªç®€å•çš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š\n TCPå’ŒUDPåœ¨å‘é€æŠ¥æ–‡æ—¶æ‰€é‡‡ç”¨çš„æ–¹å¼å®Œå…¨ä¸åŒã€‚TCPå¹¶ä¸å…³å¿ƒåº”ç”¨è¿›ç¨‹ä¸€æ¬¡æŠŠå¤šé•¿çš„æŠ¥æ–‡å‘é€åˆ°TCPçš„ç¼“å­˜ä¸­ï¼Œè€Œæ˜¯æ ¹æ®å¯¹æ–¹ç»™å‡ºçš„çª—å£å€¼å’Œå½“å‰ç½‘ç»œæ‹¥å¡çš„ç¨‹åº¦æ¥å†³å®šä¸€ä¸ªæŠ¥æ–‡æ®µåº”åŒ…å«å¤šå°‘ä¸ªå­—èŠ‚ï¼ˆUDPå‘é€çš„æŠ¥æ–‡é•¿åº¦æ˜¯åº”ç”¨è¿›ç¨‹ç»™å‡ºçš„ï¼‰ã€‚å¦‚æœåº”ç”¨è¿›ç¨‹ä¼ é€åˆ°TCPç¼“å­˜çš„æ•°æ®å—å¤ªé•¿ï¼ŒTCPå°±å¯ä»¥æŠŠå®ƒåˆ’åˆ†çŸ­ä¸€äº›å†ä¼ é€ã€‚å¦‚æœåº”ç”¨è¿›ç¨‹ä¸€æ¬¡åªå‘æ¥ä¸€ä¸ªå­—èŠ‚ï¼ŒTCPä¹Ÿå¯ä»¥ç­‰å¾…ç§¯ç´¯æœ‰è¶³å¤Ÿå¤šçš„å­—èŠ‚åå†æ„æˆæŠ¥æ–‡æ®µå‘é€å‡ºå»\n TCPæŠ¥æ–‡æ ¼å¼ è‹±æ–‡ç‰ˆï¼š\nTCPçš„å›ºå®šåŒ…å¤´ä¸º20ä¸ªå­—èŠ‚ï¼Œä¸‹é¢æ˜¯å‡ ä¸ªå‚æ•°ï¼š\n åºå·ï¼šå³SEQåºå·ã€‚TCPè¿æ¥ä¸­ä¼ é€çš„æ•°æ®æµä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½ç¼–ä¸Šä¸€ä¸ªåºå·ã€‚åºå·å­—æ®µçš„å€¼åˆ™æŒ‡çš„æ˜¯æœ¬æŠ¥æ–‡æ®µæ‰€å‘é€çš„æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ã€‚ ç¡®è®¤å·ï¼šå³ç¡®è®¤åºå·ï¼Œä¹Ÿå«ACKåºå·ã€‚æ˜¯æœŸæœ›æ”¶åˆ°å¯¹æ–¹çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ã€‚åªæœ‰ACKæ ‡å¿—ä½ä¸º1æ—¶ï¼Œç¡®è®¤åºå·å­—æ®µæ‰æœ‰æ•ˆï¼ŒACK=SEQ+1ã€‚ æ•°æ®åç§»ï¼šå®ƒæŒ‡å‡ºTCPæŠ¥æ–‡æ®µçš„æ•°æ®èµ·å§‹å¤„è·ç¦»TCPæŠ¥æ–‡æ®µçš„èµ·å§‹å¤„æœ‰å¤šè¿œã€‚è¯¥å­—æ®µé•¿ 4 ä½ï¼Œå•ä½ä¸º 4 å­—èŠ‚ã€‚è¡¨ç¤ºä¸º TCP é¦–éƒ¨çš„é•¿åº¦ã€‚æ‰€ä»¥ TCP é¦–éƒ¨é•¿åº¦æœ€å¤šä¸º 60 å­—èŠ‚ã€‚ æ ‡å¿—ä½ï¼šå…±6ä¸ªï¼Œå³URG(ç´§æ€¥æ¯”ç‰¹)ã€ACK(ç¡®è®¤æ¯”ç‰¹)ã€PSH(æ¨é€æ¯”ç‰¹)ã€RST(å¤ä½æ¯”ç‰¹)ã€SYN(åŒæ­¥æ¯”ç‰¹)ã€FIN(ç»“æŸæ¯”ç‰¹)ç­‰ã€‚ çª—å£å¤§å°ï¼šçª—å£å­—æ®µç”¨æ¥æ§åˆ¶å¯¹æ–¹å‘é€çš„æ•°æ®é‡ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚TCPè¿æ¥çš„ä¸€ç«¯æ ¹æ®è®¾ç½®çš„ç¼“å­˜ç©ºé—´å¤§å°ç¡®å®šè‡ªå·±çš„æ¥æ”¶çª—å£å¤§å°ï¼Œç„¶åé€šçŸ¥å¯¹æ–¹ä»¥ç¡®å®šå¯¹æ–¹çš„å‘é€çª—å£çš„ä¸Šã€‚ æ ¡éªŒå’Œï¼šæ£€éªŒå’Œå­—æ®µæ£€éªŒçš„èŒƒå›´åŒ…æ‹¬é¦–éƒ¨å’Œæ•°æ®è¿™ä¸¤éƒ¨åˆ†ã€‚åœ¨è®¡ç®—æ£€éªŒå’Œæ—¶ï¼Œè¦åœ¨TCPæŠ¥æ–‡æ®µçš„å‰é¢åŠ ä¸Š12å­—èŠ‚çš„ä¼ªé¦–éƒ¨ã€‚ ç´§æ€¥æŒ‡é’ˆï¼šç´§æ€¥æŒ‡é’ˆæŒ‡å‡ºåœ¨æœ¬æŠ¥æ–‡æ®µä¸­çš„ç´§æ€¥æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·ã€‚ é€‰é¡¹ï¼šTCPåªè§„å®šäº†ä¸€ç§é€‰é¡¹ï¼Œå³æœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦MSSï¼ˆMaximumSegment Sizeï¼‰ã€‚MSSå‘Šè¯‰å¯¹æ–¹TCPï¼šâ€œæˆ‘çš„ç¼“å­˜æ‰€èƒ½æ¥æ”¶çš„æŠ¥æ–‡æ®µçš„æ•°æ®å­—æ®µçš„æœ€å¤§é•¿åº¦æ˜¯MSS ä¸ªå­—èŠ‚ã€‚â€  å‡ ä¸ªæ§åˆ¶ä½ï¼š\n1 2 3 4 5 6 7 8  CWRï¼šç”¨äº IP é¦–éƒ¨çš„ ECN å­—æ®µã€‚ECE ä¸º 1 æ—¶ï¼Œåˆ™é€šçŸ¥å¯¹æ–¹å·²å°†æ‹¥å¡çª—å£ç¼©å°ã€‚ ECEï¼šåœ¨æ”¶åˆ°æ•°æ®åŒ…çš„ IP é¦–éƒ¨ä¸­ ECN ä¸º 1 æ—¶å°† TCP é¦–éƒ¨ä¸­çš„ ECE è®¾ç½®ä¸º 1ï¼Œè¡¨ç¤ºä»å¯¹æ–¹åˆ°è¿™è¾¹çš„ç½‘ç»œæœ‰æ‹¥å¡ã€‚ URGï¼šç´§æ€¥æ¨¡å¼ ACKï¼šç¡®è®¤ PSHï¼šæ¨é€ï¼Œæ¥æ”¶æ–¹åº”å°½å¿«ç»™åº”ç”¨ç¨‹åºä¼ é€è¿™ä¸ªæ•°æ®ã€‚æ²¡ç”¨åˆ° RSTï¼šè¯¥ä½ä¸º 1 è¡¨ç¤º TCP è¿æ¥ä¸­å‡ºç°å¼‚å¸¸å¿…é¡»å¼ºåˆ¶æ–­å¼€è¿æ¥ã€‚ SYNï¼šåˆå§‹åŒ–ä¸€ä¸ªè¿æ¥çš„åŒæ­¥åºåˆ—å· FINï¼šè¯¥ä½ä¸º 1 è¡¨ç¤ºä»Šåä¸ä¼šæœ‰æ•°æ®å‘é€ï¼Œå¸Œæœ›æ–­å¼€è¿æ¥   é€‰é¡¹ï¼ˆOptionsï¼‰ï¼š\nå— Data Offset æ§åˆ¶ï¼Œé•¿åº¦æœ€å¤§ä¸º 40 å­—èŠ‚ã€‚ä¸€èˆ¬ Option çš„æ ¼å¼ä¸º TLV ç»“æ„ï¼š\nå¸¸è§çš„ TCP Options æœ‰ï¼ŒSACK å­—æ®µå°±ä½äºè¯¥é€‰é¡¹ä¸­:\nSACK çš„å·¥ä½œåŸç†\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ æ¥æ”¶æ–¹æ”¶åˆ° 500-699 çš„æ•°æ®åŒ…ï¼Œä½†æ²¡æœ‰æ”¶åˆ° 300-499 çš„æ•°æ®åŒ…å°±ä¼šå› SACK(500-700) ç»™å‘é€ç«¯ï¼Œè¡¨ç¤ºæ”¶åˆ° 500-699 çš„æ•°æ®ã€‚\nä¸‰æ¬¡æ¡æ‰‹ï¼š  ä¸‰æ¬¡æ¡æ‰‹æ˜¯å¿…é¡»çš„â€”â€”TCP éœ€è¦ seq åºåˆ—å·æ¥åšå¯é é‡ä¼ æˆ–æ¥æ”¶ï¼Œè€Œé¿å…è¿æ¥å¤ç”¨æ—¶æ— æ³•åˆ†è¾¨å‡º seq æ˜¯å»¶è¿Ÿæˆ–è€…æ˜¯æ—§é“¾æ¥çš„ seqï¼Œå› æ­¤éœ€è¦ä¸‰æ¬¡æ¡æ‰‹æ¥çº¦å®šç¡®å®šåŒæ–¹çš„ ISNï¼ˆåˆå§‹ seq åºåˆ—å·ï¼‰ã€‚\n å››æ¬¡æŒ¥æ‰‹ å…¶ä¸­Aå‘é€çš„Xä¸ºå‰é¢å·²ä¼ é€è¿‡çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ 1ã€‚\nç¬¬ä¸€æ¬¡Aåˆ°Bæ–¹å‘ç»“æŸï¼Œç¬¬äºŒæ¬¡Båˆ°Aæ–¹å‘ç»“æŸã€‚\nç¬¬äºŒæ¬¡Bå‘é€çš„SEQ=Z(åœ¨åŠå…³é—­çŠ¶æ€Bå¯èƒ½åˆå‘é€äº†ä¸€äº›æ•°æ®),Bè¿˜å¿…é¡»é‡å¤ä¸Šæ¬¡å·²å‘é€è¿‡çš„ç¡®è®¤å·ACK = X+1ã€‚\n è¯·æ³¨æ„ï¼ŒTCPè§„å®šï¼ŒFINæŠ¥æ–‡æ®µå³ä½¿ä¸æºå¸¦æ•°æ®ï¼Œå®ƒä¹Ÿæ¶ˆè€—æ‰ä¸€ä¸ªåºå·ã€‚\nè¯·æ³¨æ„ï¼Œç°åœ¨TCPè¿æ¥è¿˜æ²¡æœ‰é‡Šæ”¾æ‰ã€‚å¿…é¡»ç»è¿‡æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨(TIME-WAIT timer)è®¾ç½®çš„æ—¶é—´2MSLåï¼ŒAæ‰è¿›å…¥åˆ°CLOSEDçŠ¶æ€ã€‚æ—¶é—´MSLå«åšæœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½(Maximum Segment Lifetime)ï¼ŒRFC 793å»ºè®®è®¾ä¸º2åˆ†é’Ÿã€‚ä½†è¿™å®Œå…¨æ˜¯ä»å·¥ç¨‹ä¸Šæ¥è€ƒè™‘ï¼Œå¯¹äºç°åœ¨çš„ç½‘ç»œï¼ŒMSL = 2åˆ†é’Ÿå¯èƒ½å¤ªé•¿äº†ä¸€äº›ã€‚å› æ­¤TCPå…è®¸ä¸åŒçš„å®ç°å¯æ ¹æ®å…·ä½“æƒ…å†µä½¿ç”¨æ›´å°çš„MSLå€¼ã€‚å› æ­¤ï¼Œä»Aè¿›å…¥åˆ°TIME-WAITçŠ¶æ€åï¼Œè¦ç»è¿‡4åˆ†é’Ÿæ‰èƒ½è¿›å…¥åˆ°CLOSEDçŠ¶æ€ï¼Œæ‰èƒ½å¼€å§‹å»ºç«‹ä¸‹ä¸€ä¸ªæ–°çš„è¿æ¥ã€‚å½“Aæ’¤é”€ç›¸åº”çš„ä¼ è¾“æ§åˆ¶å—TCBåï¼Œå°±ç»“æŸäº†è¿™æ¬¡çš„TCPè¿æ¥ã€‚\n ä¸ºä»€ä¹ˆAåœ¨TIME-WAITçŠ¶æ€(å‘é€æœ€åä¸€ä¸ªæ•°æ®åŒ…ä¹‹å)å¿…é¡»ç­‰å¾…2MSLçš„æ—¶é—´å‘¢ï¼Ÿè¿™æœ‰ä¸¤ä¸ªç†ç”±ã€‚\n  ç¬¬ä¸€ï¼Œä¸ºäº†ä¿è¯Aå‘é€çš„æœ€åä¸€ä¸ªACKæŠ¥æ–‡æ®µèƒ½å¤Ÿåˆ°è¾¾Bã€‚è¿™ä¸ªACKæŠ¥æ–‡æ®µæœ‰å¯èƒ½ä¸¢å¤±ï¼Œå› è€Œä½¿å¤„åœ¨LAST-ACKçŠ¶æ€çš„Bæ”¶ä¸åˆ°å¯¹å·²å‘é€çš„FIN + ACKæŠ¥æ–‡æ®µçš„ç¡®è®¤ã€‚Bä¼šè¶…æ—¶é‡ä¼ è¿™ä¸ªFIN + ACKæŠ¥æ–‡æ®µï¼Œè€ŒAå°±èƒ½åœ¨2MSLæ—¶é—´å†…æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„FIN + ACKæŠ¥æ–‡æ®µã€‚æ¥ç€Aé‡ä¼ ä¸€æ¬¡ç¡®è®¤ï¼Œé‡æ–°å¯åŠ¨2MSLè®¡æ—¶å™¨ã€‚æœ€åï¼ŒAå’ŒBéƒ½æ­£å¸¸è¿›å…¥åˆ°CLOSEDçŠ¶æ€ã€‚å¦‚æœAåœ¨TIME-WAITçŠ¶æ€ä¸ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œè€Œæ˜¯åœ¨å‘é€å®ŒACKæŠ¥æ–‡æ®µåç«‹å³é‡Šæ”¾è¿æ¥ï¼Œé‚£ä¹ˆå°±æ— æ³•æ”¶åˆ°Bé‡ä¼ çš„FIN + ACKæŠ¥æ–‡æ®µï¼Œå› è€Œä¹Ÿä¸ä¼šå†å‘é€ä¸€æ¬¡ç¡®è®¤æŠ¥æ–‡æ®µã€‚è¿™æ ·ï¼ŒBå°±æ— æ³•æŒ‰ç…§æ­£å¸¸æ­¥éª¤è¿›å…¥CLOSEDçŠ¶æ€ã€‚\n  ç¬¬äºŒï¼Œé˜²æ­¢ä¸Šä¸€èŠ‚æåˆ°çš„â€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€å‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚Aåœ¨å‘é€å®Œæœ€åä¸€ä¸ªACKæŠ¥æ–‡æ®µåï¼Œå†ç»è¿‡æ—¶é—´2MSLï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·å°±å¯ä»¥ä½¿ä¸‹ä¸€ä¸ªæ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°è¿™ç§æ—§çš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚Båªè¦æ”¶åˆ°äº†Aå‘å‡ºçš„ç¡®è®¤ï¼Œå°±è¿›å…¥CLOSEDçŠ¶æ€ã€‚åŒæ ·ï¼ŒBåœ¨æ’¤é”€ç›¸åº”çš„ä¼ è¾“æ§åˆ¶å—TCBåï¼Œå°±ç»“æŸäº†è¿™æ¬¡çš„TCPè¿æ¥ã€‚æˆ‘ä»¬æ³¨æ„åˆ°ï¼ŒBç»“æŸTCPè¿æ¥çš„æ—¶é—´è¦æ¯”Aæ—©ä¸€äº›ã€‚\n  TCPçš„4ä¸ªå®šæ—¶å™¨  é‡ä¼ å®šæ—¶å™¨ã€åšæŒå®šæ—¶å™¨ã€ä¿æŒå®šæ—¶å™¨ã€æ—¶é—´ç­‰å¾…å®šæ—¶å™¨\n é‡ä¼ è®¡æ—¶å™¨ï¼š\nå½“TCPå‘é€æŠ¥æ–‡æ®µæ—¶ï¼Œå°±åˆ›å»ºè¯¥ç‰¹å®šæŠ¥æ–‡æ®µçš„é‡ä¼ è®¡æ—¶å™¨ã€‚\n è‹¥åœ¨è®¡æ—¶å™¨æˆªæ­¢æ—¶é—´åˆ°(é€šå¸¸60ç§’)ä¹‹å‰æ”¶åˆ°äº†å¯¹æ­¤ç‰¹å®šæŠ¥æ–‡æ®µçš„ç¡®è®¤ï¼Œåˆ™æ’¤é”€æ­¤è®¡æ—¶å™¨ã€‚ è‹¥åœ¨è®¡æ—¶å™¨æˆªæ­¢æ—¶é—´ä¹‹å‰æ²¡æœ‰æ”¶åˆ°å¯¹æ­¤ç‰¹å®šæŠ¥æ–‡çš„ç¡®è®¤ï¼Œåˆ™å°±è®¤ä¸ºè¯¥æŠ¥æ–‡ä¸¢å¤±ï¼Œéœ€è¦é‡ä¼ æ­¤æŠ¥æ–‡æ®µï¼Œå¹¶å°†è®¡æ—¶å™¨å¤ä½ã€‚  åšæŒè®¡æ—¶å™¨-é˜²æ­¢æ”¶ä¸åˆ°é0çª—å£å¤§å°çš„æŠ¥æ–‡\n å‡è®¾TCPæ”¶åˆ°äº†ä¸€ä¸ªçª—å£å¤§å°ä¸º0æŠ¥æ–‡æ®µï¼Œå‘é€TCPå°±åœæ­¢ä¼ é€æŠ¥æ–‡æ®µï¼Œç›´åˆ°æ¥æ”¶TCPå‘é€ä¸€ä¸ªéé›¶çš„çª—å£å¤§å°ã€‚ä½†æ˜¯è¿™ä¸ªç¡®è®¤æœ‰å¯èƒ½ä¸¢å¤±ï¼Œè‹¥ç¡®è®¤ä¸¢äº†ï¼Œæ¥æ”¶TCPå¹¶ä¸ä¼šçŸ¥é“ï¼Œè€Œæ˜¯è®¤ä¸ºä»–å·²ç»å®Œæˆä»»åŠ¡äº†ã€‚ä½†æ˜¯å‘é€TCPç”±äºæ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œå°±ä¼šä¸€ç›´ç­‰å¾…æ¥æ”¶æ–¹å‘é€ç¡®è®¤æ¥é€šçŸ¥çª—å£çš„å¤§å°ã€‚åŒæ–¹çš„TCPè¿™æ—¶å°±ä¼šé€ æˆæ­»é”ï¼Œæ‰€ä»¥è¦ä½¿ç”¨ä¸€ä¸ªè®¡æ—¶å™¨æ¥é¿å…æ­»é”çš„å‘é€ã€‚\n  å½“TCPæ”¶åˆ°ä¸€ä¸ªçª—å£å¤§å°ä¸º0çš„ç¡®è®¤æ—¶ï¼Œå°±è¦å¯åŠ¨åšæŒè®¡æ—¶å™¨ã€‚å½“åšæŒè®¡æ—¶å™¨æœŸé™åˆ°æ—¶ï¼Œå‘é€TCPå°±å‘é€ä¸€ä¸ªç‰¹æ®Šçš„æ¢æµ‹æŠ¥æ–‡ï¼Œè¿™ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µåªæœ‰ä¸€ä¸ªå­—èŠ‚æ•°æ®ï¼Œå®ƒæœ‰ä¸€ä¸ªåºå·ï¼Œä½†æ˜¯å®ƒçš„åºå·æ°¸è¿œä¸éœ€è¦ç¡®è®¤ã€‚æ¢æµ‹æŠ¥æ–‡æ®µæé†’å¯¹ç«¯ï¼Œç¡®è®¤å·²ä¸¢å¤±ï¼Œå¿…é¡»é‡ä¼ ã€‚ åšæŒè®¡æ—¶å™¨çš„å€¼è®¾ç½®ä¸ºé‡ä¼ æ—¶é—´çš„æ•°å€¼ã€‚è‹¥æ²¡æœ‰æ”¶åˆ°ä»æ¥æ”¶ç«¯æ¥çš„å“åº”ï¼Œéœ€è¦å‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡ï¼Œå¹¶å°†åšæŒè®¡æ—¶å™¨çš„å€¼åŠ å€å’Œå¤ä½ï¼Œç›´åˆ°è¿™ä¸ªå€¼å¢å¤§åˆ°é—¨é™å€¼(é€šå¸¸60ç§’)ä¸ºæ­¢ã€‚åœ¨è¿™ä»¥åï¼Œå‘é€ç«¯æ¯éš”60ç§’å‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡ï¼Œç›´åˆ°çª—å£é‡æ–°æ‰“å¼€ã€‚  ä¿æ´»è®¡æ—¶å™¨\nä¿æ´»è®¡æ—¶å™¨ç”¨æ¥é˜²æ­¢ä¸¤ä¸ªTCPä¹‹é—´çš„è¿ç»­å‡ºç°é•¿æ—¶é—´çš„ç©ºé—²ã€‚\n å‡å®šå®¢æˆ·å·²ä¸»åŠ¨ä¸æœåŠ¡å™¨å»ºç«‹äº†TCPé“¾æ¥ã€‚ç„¶åè¿™ä¸ªå®¢æˆ·ç«¯å‡ºç°æ•…éšœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé“¾æ¥å°±ä¼šæ°¸è¿œçš„å¤„äºæ‰“å¼€çŠ¶æ€ã€‚è€ŒæœåŠ¡å™¨ç»´æŠ¤ä¸€ä¸ªé“¾æ¥ï¼Œä¹Ÿæ˜¯è¦è€—è´¹ä¸€å®šçš„èµ„æºçš„ï¼Œæ‰€ä»¥å¿…é¡»é‡‡å–æªæ–½ï¼Œä½¿æœåŠ¡å™¨ä¸èƒ½ç™½ç™½ç­‰ä¸‹å»ã€‚ è¦è§£å†³è¿™ç§é—®é¢˜ï¼Œå°±è¦å¯¹æœåŠ¡å™¨è®¾ç½®ä¿æ´»è®¡æ—¶å™¨ã€‚æ¯å½“æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·çš„ä¿¡æ¯ï¼Œå°±å°†è®¡æ—¶å™¨å¤ä½ï¼Œä¿æ´»æ—¶é—´é€šå¸¸è®¾ç½®ä¸º2å°æ—¶ã€‚è‹¥æœåŠ¡å™¨è¿‡äº†ä¸¤å°æ—¶è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·çš„ä¿¡æ¯ï¼Œä»–å°±å‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡ï¼Œä»¥åæ¯éš”75ç§’å°±å‘ä¸€æ¬¡ï¼Œè¿ç»­å‘é€10ä¸ªæ¢æµ‹æŠ¥æ–‡åå®¢æˆ·ç«¯ä»ç„¶æ²¡æœ‰å“åº”ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºç°äº†æ•…éšœï¼Œæ¥ç€å°±å…³é—­è¿™ä¸ªé“¾æ¥ã€‚  æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨\nå½“å®¢æˆ·ç«¯è¿›å…¥TIME-WAITçŠ¶æ€çš„æ—¶å€™ï¼Œé“¾æ¥è¿˜æ²¡æœ‰é‡Šæ”¾æ‰ï¼Œå¿…é¡»ç­‰å¾…2å€çš„MSL(æœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½)åï¼Œå®¢æˆ·ç«¯æ‰èƒ½å…³é—­è¿æ¥ã€‚åœ¨æ—¶é—´ç­‰å¾…æœŸé—´ï¼Œé“¾æ¥è¿˜å¤„äºä¸€ç§è¿‡æ¸¡çŠ¶æ€ã€‚è¿™å°±å¯ä»¥ä½¿é‡å¤çš„FINæŠ¥æ–‡æ®µ(è‹¥æœæœ‰çš„è¯)å¯ä»¥åˆ°è¾¾ç›®çš„ç«™å› è€Œå¯å°†å…¶ä¸¢å¼ƒã€‚\nä¿è¯ä¼ è¾“å¯é  ç†æƒ³çš„ä¼ è¾“æ¡ä»¶æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹ï¼š\n ä¼ è¾“ä¿¡é“ä¸äº§ç”Ÿå·®é”™ã€‚ ä¸ç®¡å‘é€æ–¹ä»¥å¤šå¿«çš„é€Ÿåº¦å‘é€æ•°æ®ï¼Œæ¥æ”¶æ–¹æ€»æ˜¯æ¥å¾—åŠå¤„ç†æ”¶åˆ°çš„æ•°æ®ã€‚   æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›å¯é ä¼ è¾“åè®®ï¼Œå½“å‡ºç°å·®é”™æ—¶è®©å‘é€æ–¹é‡ä¼ å‡ºç°å·®é”™çš„æ•°æ®ï¼ŒåŒæ—¶åœ¨æ¥æ”¶æ–¹æ¥ä¸åŠå¤„ç†æ”¶åˆ°çš„æ•°æ®æ—¶ï¼ŒåŠæ—¶å‘Šè¯‰å‘é€æ–¹é€‚å½“é™ä½å‘é€æ•°æ®çš„é€Ÿåº¦ã€‚è¿™æ ·ä¸€æ¥ï¼Œæœ¬æ¥æ˜¯ä¸å¯é çš„ä¼ è¾“ä¿¡é“å°±èƒ½å¤Ÿå®ç°å¯é ä¼ è¾“äº†ã€‚\n åºå·ä¸ç¡®è®¤å·\næœ‰ä¸€ä¸ªé—®é¢˜ï¼šè¿™æ¡è¿æ¥çªç„¶æ–­å¼€é‡è¿åï¼ŒTCP æ€ä¹ˆæ ·è¯†åˆ«ä¹‹å‰æ—§é“¾æ¥é‡å‘çš„åŒ…ï¼Ÿâ€”â€”è¿™å°±éœ€è¦ç‹¬ä¸€æ— äºŒçš„ ISNï¼ˆåˆå§‹åºåˆ—å·ï¼‰æœºåˆ¶ã€‚\nè¶…æ—¶é‡ä¼ \nè¶…æ—¶é‡ä¼ ï¼šå¯é ä¼ è¾“åè®®æ˜¯è¿™æ ·è®¾è®¡çš„ï¼šAåªè¦è¶…è¿‡äº†ä¸€æ®µæ—¶é—´ä»ç„¶æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œå°±è®¤ä¸ºåˆšæ‰å‘é€çš„åˆ†ç»„ä¸¢å¤±äº†ï¼Œå› è€Œé‡ä¼ å‰é¢å‘é€è¿‡çš„åˆ†ç»„ã€‚è¿™å°±å«åšè¶…æ—¶é‡ä¼ ã€‚\n è¦å®ç°è¶…æ—¶é‡ä¼ ï¼Œå°±è¦åœ¨æ¯å‘é€å®Œä¸€ä¸ªåˆ†ç»„è®¾ç½®ä¸€ä¸ªè¶…æ—¶è®¡æ—¶å™¨ã€‚å¦‚æœåœ¨è¶…æ—¶è®¡æ—¶å™¨åˆ°æœŸä¹‹å‰æ”¶åˆ°äº†å¯¹æ–¹çš„ç¡®è®¤ï¼Œå°±æ’¤é”€å·²è®¾ç½®çš„è¶…æ—¶è®¡æ—¶å™¨\n ç¡®è®¤ä¸¢å¤±ä¸ç¡®è®¤è¿Ÿåˆ°ï¼š\nåœæ­¢ç­‰å¾…åè®® - ç®€å•çš„ä¿è¯ä¼ è¾“çš„å¯é æ€§- ARQåè®®\nåœæ­¢ç­‰å¾…åè®®ï¼šâ€œåœæ­¢ç­‰å¾…â€å°±æ˜¯æ¯å‘é€å®Œä¸€ä¸ªåˆ†ç»„å°±åœæ­¢å‘é€ï¼Œç­‰å¾…å¯¹æ–¹çš„ç¡®è®¤ã€‚åœ¨æ”¶åˆ°ç¡®è®¤åå†å‘é€ä¸‹ä¸€ä¸ªåˆ†ç»„ã€‚(ä¿¡é“åˆ©ç”¨ç‡ä½)\nè¿ç»­ARQåè®®\nè¿ç»­ARQåè®®ï¼šå‘é€æ–¹æ¯æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°±\tæŠŠå‘é€çª—å£å‘å‰æ»‘åŠ¨ä¸€ä¸ªåˆ†ç»„çš„ä½ç½®ã€‚\næ¥æ”¶æ–¹ä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨ç´¯ç§¯ç¡®è®¤çš„æ–¹å¼ã€‚è¿™å°±æ˜¯è¯´ï¼Œæ¥æ”¶æ–¹ä¸å¿…å¯¹æ”¶åˆ°çš„åˆ†ç»„é€ä¸ªå‘é€ç¡®è®¤ï¼Œè€Œæ˜¯åœ¨æ”¶åˆ°å‡ ä¸ªåˆ†ç»„åï¼Œå¯¹æŒ‰åºåˆ°è¾¾çš„æœ€åä¸€ä¸ªåˆ†ç»„å‘é€ç¡®è®¤ï¼Œè¿™å°±è¡¨ç¤ºï¼šåˆ°è¿™ä¸ªåˆ†ç»„ä¸ºæ­¢çš„æ‰€æœ‰åˆ†ç»„éƒ½å·²æ­£ç¡®æ”¶åˆ°äº†ã€‚\næ»‘åŠ¨çª—å£\nå‘é€çª—å£è¡¨ç¤ºï¼šåœ¨æ²¡æœ‰æ”¶åˆ°Bçš„ç¡®è®¤çš„æƒ…å†µä¸‹ï¼ŒAå¯ä»¥è¿ç»­æŠŠçª—å£å†…çš„æ•°æ®éƒ½å‘é€å‡ºå»ã€‚å‡¡æ˜¯å·²ç»å‘é€è¿‡çš„æ•°æ®ï¼Œåœ¨æœªæ”¶åˆ°ç¡®è®¤ä¹‹å‰éƒ½å¿…é¡»æš‚æ—¶ä¿ç•™ï¼Œä»¥ä¾¿åœ¨è¶…æ—¶é‡ä¼ æ—¶ä½¿ç”¨\nä»ä»¥ä¸Šæ‰€è¿°å¯ä»¥çœ‹å‡ºï¼Œè¦æè¿°ä¸€ä¸ªå‘é€çª—å£çš„çŠ¶æ€éœ€è¦ä¸‰ä¸ªæŒ‡é’ˆï¼šP1ï¼ŒP2å’ŒP3ã€‚æŒ‡é’ˆéƒ½æŒ‡å‘å­—èŠ‚çš„åºå·ã€‚è¿™ä¸‰ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å‡ ä¸ªéƒ¨åˆ†çš„æ„ä¹‰å¦‚ä¸‹ï¼šå°äºP1çš„æ˜¯å·²å‘é€å¹¶å·²æ”¶åˆ°ç¡®è®¤çš„éƒ¨åˆ†ï¼Œè€Œå¤§äºP3çš„æ˜¯ä¸å…è®¸å‘é€çš„éƒ¨åˆ†ã€‚P3 - P1 = Açš„å‘é€çª—å£ï¼ˆåˆç§°ä¸ºé€šçŸ¥çª—å£ï¼‰P2 - P1 = å·²å‘é€ä½†å°šæœªæ”¶åˆ°ç¡®è®¤çš„å­—èŠ‚æ•°P3 - P2 = å…è®¸å‘é€ä½†å°šæœªå‘é€çš„å­—èŠ‚æ•°ï¼ˆåˆç§°ä¸ºå¯ç”¨çª—å£æˆ–æœ‰æ•ˆçª—å£ï¼‰\nå‘é€æ–¹çš„åº”ç”¨è¿›ç¨‹æŠŠå­—èŠ‚æµå†™å…¥TCPçš„å‘é€ç¼“å­˜ï¼Œæ¥æ”¶æ–¹çš„åº”ç”¨è¿›ç¨‹ä»TCPçš„æ¥æ”¶ç¼“å­˜ä¸­è¯»å–å­—èŠ‚æµã€‚ä¸‹å›¾è¡¨ç¤ºäº†å‘é€æ–¹ç»´æŒçš„å‘é€ç¼“å­˜å’Œå‘é€çª—å£ï¼Œä»¥åŠæ¥æ”¶æ–¹ç»´æŒçš„æ¥æ”¶ç¼“å­˜å’Œæ¥æ”¶çª—å£ã€‚\næ€»ç»“ï¼š\nå‘é€ç¼“å­˜ç”¨æ¥æš‚æ—¶å­˜æ”¾ï¼š\n å‘é€åº”ç”¨ç¨‹åºä¼ é€ç»™å‘é€æ–¹TCPå‡†å¤‡å‘é€çš„æ•°æ® TCPå·²å‘é€å‡ºä½†å°šæœªæ”¶åˆ°ç¡®è®¤çš„æ•°æ®ã€‚   å‘é€çª—å£é€šå¸¸åªæ˜¯å‘é€ç¼“å­˜çš„ä¸€éƒ¨åˆ†ã€‚å·²è¢«ç¡®è®¤çš„æ•°æ®åº”å½“ä»å‘é€ç¼“å­˜ä¸­åˆ é™¤ï¼Œå› æ­¤å‘é€ç¼“å­˜å’Œå‘é€çª—å£çš„åæ²¿æ˜¯é‡åˆçš„ã€‚å‘é€åº”ç”¨ç¨‹åºæœ€åå†™å…¥å‘é€ç¼“å­˜çš„å­—èŠ‚å‡å»æœ€åè¢«ç¡®è®¤çš„å­—èŠ‚ï¼Œå°±æ˜¯è¿˜ä¿ç•™åœ¨å‘é€ç¼“å­˜ä¸­çš„è¢«å†™å…¥çš„å­—èŠ‚æ•°ã€‚å‘é€åº”ç”¨ç¨‹åºå¿…é¡»æ§åˆ¶å†™å…¥ç¼“å­˜çš„é€Ÿç‡ï¼Œä¸èƒ½å¤ªå¿«ï¼Œå¦åˆ™å‘é€ç¼“å­˜å°±ä¼šæ²¡æœ‰å­˜æ”¾æ•°æ®çš„ç©ºé—´ã€‚\n æ¥æ”¶ç¼“å­˜ç”¨æ¥æš‚æ—¶å­˜æ”¾ï¼š\n æŒ‰åºåˆ°è¾¾çš„ã€ä½†å°šæœªè¢«æ¥æ”¶åº”ç”¨ç¨‹åºè¯»å–çš„æ•°æ® æœªæŒ‰åºåˆ°è¾¾çš„æ•°æ®ã€‚   å¦‚æœæ”¶åˆ°çš„åˆ†ç»„è¢«æ£€æµ‹å‡ºæœ‰å·®é”™ï¼Œåˆ™è¦ä¸¢å¼ƒã€‚å¦‚æœæ¥æ”¶åº”ç”¨ç¨‹åºæ¥ä¸åŠè¯»å–æ”¶åˆ°çš„æ•°æ®ï¼Œæ¥æ”¶ç¼“å­˜æœ€ç»ˆå°±ä¼šè¢«å¡«æ»¡ï¼Œä½¿æ¥æ”¶çª—å£å‡å°åˆ°é›¶ã€‚åä¹‹ï¼Œå¦‚æœæ¥æ”¶åº”ç”¨ç¨‹åºèƒ½å¤ŸåŠæ—¶ä»æ¥æ”¶ç¼“å­˜ä¸­è¯»å–æ”¶åˆ°çš„æ•°æ®ï¼Œæ¥æ”¶çª—å£å°±å¯ä»¥å¢å¤§ï¼Œä½†æœ€å¤§ä¸èƒ½è¶…è¿‡æ¥æ”¶ç¼“å­˜çš„å¤§å°ã€‚\n è¶…æ—¶é‡ä¼ çš„é€‰æ‹©\nTCPé‡‡ç”¨äº†ä¸€ç§è‡ªé€‚åº”ç®—æ³•ï¼Œå®ƒè®°å½•ä¸€ä¸ªæŠ¥æ–‡æ®µå‘å‡ºçš„æ—¶é—´ï¼Œä»¥åŠæ”¶åˆ°ç›¸åº”çš„ç¡®è®¤çš„æ—¶é—´ã€‚è¿™ä¸¤ä¸ªæ—¶é—´ä¹‹å·®å°±æ˜¯æŠ¥æ–‡æ®µçš„å¾€è¿”æ—¶é—´RTTã€‚TCPä¿ç•™äº†RTTçš„ä¸€ä¸ªåŠ æƒå¹³å‡å¾€è¿”æ—¶é—´ $RTT_S$ï¼ˆè¿™åˆç§°ä¸ºå¹³æ»‘çš„å¾€è¿”æ—¶é—´ï¼ŒSè¡¨ç¤ºSmoothedã€‚å› ä¸ºè¿›è¡Œçš„æ˜¯åŠ æƒå¹³å‡ï¼Œå› æ­¤å¾—å‡ºçš„ç»“æœæ›´åŠ å¹³æ»‘ï¼‰ã€‚æ¯å½“ç¬¬ä¸€æ¬¡æµ‹é‡åˆ°RTTæ ·æœ¬æ—¶ï¼ŒRTTSå€¼å°±å–ä¸ºæ‰€æµ‹é‡åˆ°çš„RTTæ ·æœ¬å€¼ã€‚ä½†ä»¥åæ¯æµ‹é‡åˆ°ä¸€ä¸ªæ–°çš„RTTæ ·æœ¬ï¼Œå°±æŒ‰ä¸‹å¼é‡æ–°è®¡ç®—ä¸€æ¬¡$RTT_S$\n RFC2988æ¨èçš„Î±å€¼ä¸º1/8ï¼Œå³0.125ã€‚ç”¨è¿™ç§æ–¹æ³•å¾—å‡ºçš„åŠ æƒå¹³å‡å¾€è¿”æ—¶é—´RTTSå°±æ¯”æµ‹é‡å‡ºçš„RTTå€¼æ›´åŠ å¹³æ»‘\n è¶…æ—¶è®¡æ—¶å™¨è®¾ç½®çš„è¶…æ—¶é‡ä¼ æ—¶é—´ RTO (RetransmissionTime-Out)åº”ç•¥å¤§äºä¸Šé¢å¾—å‡ºçš„åŠ æƒå¹³å‡å¾€è¿”æ—¶é—´$RTT_S$ã€‚RFC 2988å»ºè®®ä½¿ç”¨ä¸‹å¼è®¡ç®—RTOï¼š\n$$\nRTO = RTT_{S} + 4 \\times RTT_{D}\n$$\nè€Œ$RTT_D$æ˜¯RTTçš„åå·®çš„åŠ æƒå¹³å‡å€¼ï¼Œå®ƒä¸$RTT_S$å’Œæ–°çš„RTTæ ·æœ¬ä¹‹å·®æœ‰å…³ã€‚å½“ç¬¬ä¸€æ¬¡æµ‹é‡æ—¶ï¼ŒRTTDå€¼å–ä¸ºæµ‹é‡åˆ°çš„RTTæ ·æœ¬å€¼çš„ä¸€åŠã€‚åœ¨ä»¥åçš„æµ‹é‡ä¸­ï¼Œåˆ™ä½¿ç”¨ä¸‹å¼è®¡ç®—åŠ æƒå¹³å‡çš„RTTDï¼š\n è¿™é‡Œ Î² æ˜¯ä¸ªå°äº1çš„ç³»æ•°ï¼Œå®ƒçš„æ¨èå€¼æ˜¯1/4ï¼Œå³0.25ã€‚\n æ¥å—æ–¹æœ‰ä¸€ä¸ªåˆ¤æ–­æ¥å—çš„æŠ¥æ–‡æ—¶ä¹‹å‰å‘é€çš„è¿˜æ˜¯ä¹‹åé‡ä¼ çš„æŠ¥æ–‡çš„é—®é¢˜ï¼Œè¿™é‡Œæ¥å—æ–¹å¦‚ä½•åˆ¤æ–­ç»™å“ªä¸€ä¸ªæŠ¥æ–‡å‘é€ç¡®è®¤ï¼Ÿ\né€‰æ‹©ç¡®è®¤SACK\nè¿™å°±æ˜¯è‹¥æ”¶åˆ°çš„æŠ¥æ–‡æ®µæ— å·®é”™ï¼Œåªæ˜¯æœªæŒ‰åºå·ï¼Œä¸­é—´è¿˜ç¼ºå°‘ä¸€äº›åºå·çš„æ•°æ®ï¼Œé‚£ä¹ˆèƒ½å¦è®¾æ³•åªä¼ é€ç¼ºå°‘çš„æ•°æ®è€Œä¸é‡ä¼ å·²ç»æ­£ç¡®åˆ°è¾¾æ¥æ”¶æ–¹çš„æ•°æ®ï¼Ÿ\næµé‡æ§åˆ¶  æ‰€è°“æµé‡æ§åˆ¶(flow control)å°±æ˜¯è®©å‘é€æ–¹çš„å‘é€é€Ÿç‡ä¸è¦å¤ªå¿«ï¼Œè¦è®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶\n æ»‘åŠ¨çª—å£æµé‡æ§åˆ¶ï¼š\nç°åœ¨æˆ‘ä»¬è€ƒè™‘ä¸€ç§æƒ…å†µã€‚ã€Bå‘Aå‘é€äº†é›¶çª—å£çš„æŠ¥æ–‡æ®µåä¸ä¹…ï¼ŒBçš„æ¥æ”¶ç¼“å­˜åˆæœ‰äº†ä¸€äº›å­˜å‚¨ç©ºé—´ã€‚äºæ˜¯Bå‘Aå‘é€äº†rwnd = 400çš„æŠ¥æ–‡æ®µã€‚ç„¶è€Œè¿™ä¸ªæŠ¥æ–‡æ®µåœ¨ä¼ é€è¿‡ç¨‹ä¸­ä¸¢å¤±äº†ã€‚Aä¸€ç›´ç­‰å¾…æ”¶åˆ°Bå‘é€çš„éé›¶çª—å£çš„é€šçŸ¥ï¼Œè€ŒBä¹Ÿä¸€ç›´ç­‰å¾…Aå‘é€çš„æ•°æ®ã€‚å¦‚æœæ²¡æœ‰å…¶ä»–æªæ–½ï¼Œè¿™ç§äº’ç›¸ç­‰å¾…çš„æ­»é”å±€é¢å°†ä¸€ç›´å»¶ç»­ä¸‹å»ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦åšæŒè®¡æ—¶å™¨æ¥ä¿è¯äº†ã€‚\næ§åˆ¶TCPå‘é€æŠ¥æ–‡æ®µçš„æ—¶æœº æœ‰ä¸‰ç§å‘é€æŠ¥æ–‡æ®µçš„æ–¹æ³•ï¼š\n ç¬¬ä¸€ç§æœºåˆ¶æ˜¯TCPç»´æŒä¸€ä¸ªå˜é‡ï¼Œå®ƒç­‰äºæœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦MSSã€‚åªè¦ç¼“å­˜ä¸­å­˜æ”¾çš„æ•°æ®è¾¾åˆ°MSSå­—èŠ‚æ—¶ï¼Œå°±ç»„è£…æˆä¸€ä¸ªTCPæŠ¥æ–‡æ®µå‘é€å‡ºå»ã€‚ ç¬¬äºŒç§æœºåˆ¶æ˜¯ç”±å‘é€æ–¹çš„åº”ç”¨è¿›ç¨‹æŒ‡æ˜è¦æ±‚å‘é€æŠ¥æ–‡æ®µï¼Œå³TCPæ”¯æŒçš„æ¨é€(push)æ“ä½œ ç¬¬ä¸‰ç§æœºåˆ¶æ˜¯å‘é€æ–¹çš„ä¸€ä¸ªè®¡æ—¶å™¨æœŸé™åˆ°äº†ï¼Œè¿™æ—¶å°±æŠŠå½“å‰å·²æœ‰çš„ç¼“å­˜æ•°æ®è£…å…¥æŠ¥æ–‡æ®µï¼ˆä½†é•¿åº¦ä¸èƒ½è¶…è¿‡MSSï¼‰å‘é€å‡ºå»ã€‚  åœ¨TCPçš„å®ç°ä¸­å¹¿æ³›ä½¿ç”¨Nagleç®—æ³•ã€‚ç®—æ³•å¦‚ä¸‹ï¼šè‹¥å‘é€åº”ç”¨è¿›ç¨‹æŠŠè¦å‘é€çš„æ•°æ®é€ä¸ªå­—èŠ‚åœ°é€åˆ°TCPçš„å‘é€ç¼“å­˜ï¼Œåˆ™å‘é€æ–¹å°±æŠŠç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚å…ˆå‘é€å‡ºå»ï¼ŒæŠŠåé¢åˆ°è¾¾çš„æ•°æ®å­—èŠ‚éƒ½ç¼“å­˜èµ·æ¥ã€‚å½“å‘é€æ–¹æ”¶åˆ°å¯¹ç¬¬ä¸€ä¸ªæ•°æ®å­—ç¬¦çš„ç¡®è®¤åï¼Œå†æŠŠå‘é€ç¼“å­˜ä¸­çš„æ‰€æœ‰æ•°æ®ç»„è£…æˆä¸€ä¸ªæŠ¥æ–‡æ®µå‘é€å‡ºå»ï¼ŒåŒæ—¶ç»§ç»­å¯¹éšååˆ°è¾¾çš„æ•°æ®è¿›è¡Œç¼“å­˜ã€‚åªæœ‰åœ¨æ”¶åˆ°å¯¹å‰ä¸€ä¸ªæŠ¥æ–‡æ®µçš„ç¡®è®¤åæ‰ç»§ç»­å‘é€ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µã€‚å½“æ•°æ®åˆ°è¾¾è¾ƒå¿«è€Œç½‘ç»œé€Ÿç‡è¾ƒæ…¢æ—¶ï¼Œç”¨è¿™æ ·çš„æ–¹æ³•å¯æ˜æ˜¾åœ°å‡å°‘æ‰€ç”¨çš„ç½‘ç»œå¸¦å®½ã€‚Nagleç®—æ³•è¿˜è§„å®šï¼Œå½“åˆ°è¾¾çš„æ•°æ®å·²è¾¾åˆ°å‘é€çª—å£å¤§å°çš„ä¸€åŠæˆ–å·²è¾¾åˆ°æŠ¥æ–‡æ®µçš„æœ€å¤§é•¿åº¦æ—¶ï¼Œå°±ç«‹å³å‘é€ä¸€ä¸ªæŠ¥æ–‡æ®µã€‚è¿™æ ·åšï¼Œå°±å¯ä»¥æœ‰æ•ˆåœ°æé«˜ç½‘ç»œçš„ååé‡ã€‚\nå¦ä¸€ä¸ªé—®é¢˜å«åšç³Šæ¶‚çª—å£ç»¼åˆç—‡ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥è®©æ¥æ”¶æ–¹ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œä½¿å¾—æˆ–è€…æ¥æ”¶ç¼“å­˜å·²æœ‰è¶³å¤Ÿç©ºé—´å®¹çº³ä¸€ä¸ªæœ€é•¿çš„æŠ¥æ–‡æ®µï¼Œæˆ–è€…ç­‰åˆ°æ¥æ”¶ç¼“å­˜å·²æœ‰ä¸€åŠç©ºé—²çš„ç©ºé—´ã€‚åªè¦å‡ºç°è¿™ä¸¤ç§æƒ…å†µä¹‹ä¸€ï¼Œæ¥æ”¶æ–¹å°±å‘å‡ºç¡®è®¤æŠ¥æ–‡ï¼Œå¹¶å‘å‘é€æ–¹é€šçŸ¥å½“å‰çš„çª—å£å¤§å°ã€‚æ­¤å¤–ï¼Œå‘é€æ–¹ä¹Ÿä¸è¦å‘é€å¤ªå°çš„æŠ¥æ–‡æ®µï¼Œè€Œæ˜¯æŠŠæ•°æ®ç§¯ç´¯æˆè¶³å¤Ÿå¤§çš„æŠ¥æ–‡æ®µï¼Œæˆ–è¾¾åˆ°æ¥æ”¶æ–¹ç¼“å­˜çš„ç©ºé—´çš„ä¸€åŠå¤§å°ã€‚\næ‹¥å¡æ§åˆ¶  æµé‡æ§åˆ¶ä¸æ‹¥å¡æ§åˆ¶çš„åŒºåˆ«ï¼š\næ‹¥å¡æ§åˆ¶ä¸æµé‡æ§åˆ¶çš„å…³ç³»å¯†åˆ‡ï¼Œå®ƒä»¬ä¹‹é—´ä¹Ÿå­˜åœ¨ç€ä¸€äº›å·®åˆ«ã€‚æ‰€è°“æ‹¥å¡æ§åˆ¶å°±æ˜¯é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚\nç›¸åï¼Œæµé‡æ§åˆ¶å¾€å¾€æŒ‡ç‚¹å¯¹ç‚¹é€šä¿¡é‡çš„æ§åˆ¶ï¼Œæ˜¯ä¸ªç«¯åˆ°ç«¯çš„é—®é¢˜ï¼ˆæ¥æ”¶ç«¯æ§åˆ¶å‘é€ç«¯ï¼‰ã€‚æµé‡æ§åˆ¶æ‰€è¦åšçš„å°±æ˜¯æŠ‘åˆ¶å‘é€ç«¯å‘é€æ•°æ®çš„é€Ÿç‡ï¼Œä»¥ä¾¿ä½¿æ¥æ”¶ç«¯æ¥å¾—åŠæ¥æ”¶ã€‚\n ä»€ä¹ˆæ˜¯ç½‘ç»œæ‹¥å¡ï¼Ÿ\nåœ¨è®¡ç®—æœºç½‘ç»œä¸­çš„é“¾è·¯å®¹é‡ï¼ˆå³å¸¦å®½ï¼‰ã€äº¤æ¢ç»“ç‚¹ä¸­çš„ç¼“å­˜å’Œå¤„ç†æœºç­‰ï¼Œéƒ½æ˜¯ç½‘ç»œçš„èµ„æºã€‚åœ¨æŸæ®µæ—¶é—´ï¼Œè‹¥å¯¹ç½‘ç»œä¸­æŸä¸€èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†è¯¥èµ„æºæ‰€èƒ½æä¾›çš„å¯ç”¨éƒ¨åˆ†ï¼Œç½‘ç»œçš„æ€§èƒ½å°±è¦å˜åã€‚è¿™ç§æƒ…å†µå°±å«åšæ‹¥å¡(congestion)ã€‚\n æ‰€è°“æ‹¥å¡æ§åˆ¶å°±æ˜¯é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚\n æ‹¥å¡æ§åˆ¶æ‰€è¦åšçš„éƒ½æœ‰ä¸€ä¸ªå‰æï¼Œå°±æ˜¯ç½‘ç»œèƒ½å¤Ÿæ‰¿å—ç°æœ‰çš„ç½‘ç»œè´Ÿè·ã€‚æ‹¥å¡æ§åˆ¶æ˜¯ä¸€ä¸ªå…¨å±€æ€§çš„è¿‡ç¨‹ï¼Œæ¶‰åŠåˆ°æ‰€æœ‰çš„ä¸»æœºã€æ‰€æœ‰çš„è·¯ç”±å™¨ï¼Œä»¥åŠä¸é™ä½ç½‘ç»œä¼ è¾“æ€§èƒ½æœ‰å…³çš„æ‰€æœ‰å› ç´ ã€‚ä½†TCPè¿æ¥çš„ç«¯ç‚¹åªè¦è¿Ÿè¿Ÿä¸èƒ½æ”¶åˆ°å¯¹æ–¹çš„ç¡®è®¤ä¿¡æ¯ï¼Œå°±çŒœæƒ³åœ¨å½“å‰ç½‘ç»œä¸­çš„æŸå¤„å¾ˆå¯èƒ½å‘ç”Ÿäº†æ‹¥å¡ï¼Œä½†è¿™æ—¶å´æ— æ³•çŸ¥é“æ‹¥å¡åˆ°åº•å‘ç”Ÿåœ¨ç½‘ç»œçš„ä½•å¤„ï¼Œä¹Ÿæ— æ³•çŸ¥é“å‘ç”Ÿæ‹¥å¡çš„å…·ä½“åŸå› ï¼ˆæ˜¯è®¿é—®æŸä¸ªæœåŠ¡å™¨çš„é€šä¿¡é‡è¿‡å¤§ï¼Ÿè¿˜æ˜¯åœ¨æŸä¸ªåœ°åŒºå‡ºç°äº†è‡ªç„¶ç¾å®³ï¼‰ã€‚\næ‹¥å¡æ§åˆ¶æ‰€èµ·çš„ä½œç”¨å¦‚ä¸‹ï¼š\nå›¾ä¸­éšç€æä¾›çš„è´Ÿè½½çš„å¢å¤§ï¼Œç½‘ç»œååé‡çš„å¢é•¿é€Ÿç‡é€æ¸å‡å°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç½‘ç»œååé‡è¿˜æœªè¾¾åˆ°é¥±å’Œæ—¶ï¼Œå°±å·²ç»æœ‰ä¸€éƒ¨åˆ†çš„è¾“å…¥åˆ†ç»„è¢«ä¸¢å¼ƒäº†ã€‚å½“ç½‘ç»œçš„ååé‡æ˜æ˜¾åœ°å°äºç†æƒ³çš„ååé‡æ—¶ï¼Œç½‘ç»œå°±è¿›å…¥äº†è½»åº¦æ‹¥å¡çš„çŠ¶æ€ã€‚æ›´å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“æä¾›çš„è´Ÿè½½è¾¾åˆ°æŸä¸€æ•°å€¼æ—¶ï¼Œç½‘ç»œçš„ååé‡åè€Œéšæä¾›çš„è´Ÿè½½çš„å¢å¤§è€Œä¸‹é™ï¼Œè¿™æ—¶ç½‘ç»œå°±è¿›å…¥äº†æ‹¥å¡çŠ¶æ€ã€‚å½“æä¾›çš„è´Ÿè½½ç»§ç»­å¢å¤§åˆ°æŸä¸€æ•°å€¼æ—¶ï¼Œç½‘ç»œçš„ååé‡å°±ä¸‹é™åˆ°é›¶ï¼Œç½‘ç»œå·²æ— æ³•å·¥ä½œã€‚è¿™å°±æ˜¯æ‰€è°“çš„æ­»é”(deadlock)ã€‚\nç”±äºè®¡ç®—æœºç½‘ç»œæ˜¯ä¸€ä¸ªå¾ˆå¤æ‚çš„ç³»ç»Ÿï¼Œå› æ­¤å¯ä»¥ä»æ§åˆ¶ç†è®ºçš„è§’åº¦æ¥çœ‹æ‹¥å¡æ§åˆ¶è¿™ä¸ªé—®é¢˜ã€‚è¿™æ ·ï¼Œä»å¤§çš„æ–¹é¢çœ‹ï¼Œå¯ä»¥åˆ†ä¸ºå¼€ç¯æ§åˆ¶å’Œé—­ç¯æ§åˆ¶ä¸¤ç§æ–¹æ³•ã€‚å¼€ç¯æ§åˆ¶æ–¹æ³•å°±æ˜¯åœ¨è®¾è®¡ç½‘ç»œæ—¶äº‹å…ˆå°†æœ‰å…³å‘ç”Ÿæ‹¥å¡çš„å› ç´ è€ƒè™‘å‘¨åˆ°ï¼ŒåŠ›æ±‚ç½‘ç»œåœ¨å·¥ä½œæ—¶ä¸äº§ç”Ÿæ‹¥å¡ã€‚ä½†ä¸€æ—¦æ•´ä¸ªç³»ç»Ÿè¿è¡Œèµ·æ¥ï¼Œå°±ä¸å†ä¸­é€”è¿›è¡Œæ”¹æ­£äº†ã€‚\né—­ç¯æ§åˆ¶æ˜¯åŸºäºåé¦ˆç¯è·¯çš„æ¦‚å¿µã€‚å±äºé—­ç¯æ§åˆ¶çš„æœ‰ä»¥ä¸‹å‡ ç§æªæ–½ï¼š\n ç›‘æµ‹ç½‘ç»œç³»ç»Ÿä»¥ä¾¿æ£€æµ‹åˆ°æ‹¥å¡åœ¨ä½•æ—¶ã€ä½•å¤„å‘ç”Ÿã€‚ æŠŠæ‹¥å¡å‘ç”Ÿçš„ä¿¡æ¯ä¼ é€åˆ°å¯é‡‡å–è¡ŒåŠ¨çš„åœ°æ–¹ã€‚ è°ƒæ•´ç½‘ç»œç³»ç»Ÿçš„è¿è¡Œä»¥è§£å†³å‡ºç°çš„é—®é¢˜ã€‚  å‡ ç§æ–¹æ³•  1999å¹´å…¬å¸ƒçš„å› ç‰¹ç½‘å»ºè®®æ ‡å‡†RFC 2581å®šä¹‰äº†è¿›è¡Œæ‹¥å¡æ§åˆ¶çš„å››ç§ç®—æ³•ï¼Œå³æ…¢å¼€å§‹(slow-start)ã€æ‹¥å¡é¿å…(congestion avoidance)ã€å¿«é‡ä¼ (fast retransmit)å’Œå¿«æ¢å¤(fast recovery)ã€‚\n   æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…\nå‘é€æ–¹ç»´æŒä¸€ä¸ªå«åšæ‹¥å¡çª—å£ cwnd (congestion window)çš„çŠ¶æ€å˜é‡ã€‚æ‹¥å¡çª—å£çš„å¤§å°å–å†³äºç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œå¹¶ä¸”åŠ¨æ€åœ°åœ¨å˜åŒ–ã€‚å‘é€æ–¹è®©è‡ªå·±çš„å‘é€çª—å£ç­‰äºæ‹¥å¡çª—å£ã€‚\né€æ–¹æ§åˆ¶æ‹¥å¡çª—å£çš„åŸåˆ™æ˜¯ï¼šåªè¦ç½‘ç»œæ²¡æœ‰å‡ºç°æ‹¥å¡ï¼Œæ‹¥å¡çª—å£å°±å†å¢å¤§ä¸€äº›ï¼Œä»¥ä¾¿æŠŠæ›´å¤šçš„åˆ†ç»„å‘é€å‡ºå»ã€‚ä½†åªè¦ç½‘ç»œå‡ºç°æ‹¥å¡ï¼Œæ‹¥å¡çª—å£å°±å‡å°ä¸€äº›ï¼Œä»¥å‡å°‘æ³¨å…¥åˆ°ç½‘ç»œä¸­çš„åˆ†ç»„æ•°ã€‚\n å‘é€æ–¹åˆæ˜¯å¦‚ä½•çŸ¥é“ç½‘ç»œå‘ç”Ÿäº†æ‹¥å¡å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œå½“ç½‘ç»œå‘ç”Ÿæ‹¥å¡æ—¶ï¼Œè·¯ç”±å™¨å°±è¦ä¸¢å¼ƒåˆ†ç»„ã€‚å› æ­¤åªè¦å‘é€æ–¹æ²¡æœ‰æŒ‰æ—¶æ”¶åˆ°åº”å½“åˆ°è¾¾çš„ç¡®è®¤æŠ¥æ–‡ï¼Œå°±å¯ä»¥çŒœæƒ³ç½‘ç»œå¯èƒ½å‡ºç°äº†æ‹¥å¡ã€‚ç°åœ¨é€šä¿¡çº¿è·¯çš„ä¼ è¾“è´¨é‡ä¸€èˆ¬éƒ½å¾ˆå¥½ï¼Œå› ä¼ è¾“å‡ºå·®é”™è€Œä¸¢å¼ƒåˆ†ç»„çš„æ¦‚ç‡æ˜¯å¾ˆå°çš„ï¼ˆè¿œå°äº1 %ï¼‰ã€‚\n æ…¢å¼€å§‹ç®—æ³•çš„æ€è·¯æ˜¯è¿™æ ·çš„ã€‚å½“ä¸»æœºå¼€å§‹å‘é€æ•°æ®æ—¶ï¼Œå¦‚æœç«‹å³æŠŠå¤§é‡æ•°æ®å­—èŠ‚æ³¨å…¥åˆ°ç½‘ç»œï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œå› ä¸ºç°åœ¨å¹¶ä¸æ¸…æ¥šç½‘ç»œçš„è´Ÿè·æƒ…å†µã€‚\nç»éªŒè¯æ˜ï¼Œè¾ƒå¥½çš„æ–¹æ³•æ˜¯å…ˆæ¢æµ‹ä¸€ä¸‹ï¼Œå³ç”±å°åˆ°å¤§é€æ¸å¢å¤§å‘é€çª—å£ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”±å°åˆ°å¤§é€æ¸å¢å¤§æ‹¥å¡çª—å£æ•°å€¼ã€‚é€šå¸¸åœ¨åˆšåˆšå¼€å§‹å‘é€æŠ¥æ–‡æ®µæ—¶ï¼Œå…ˆæŠŠæ‹¥å¡çª—å£cwndè®¾ç½®ä¸ºä¸€ä¸ªæœ€å¤§æŠ¥æ–‡æ®µMSSçš„æ•°å€¼[æ’å›¾]ã€‚è€Œåœ¨æ¯æ”¶åˆ°ä¸€ä¸ªå¯¹æ–°çš„æŠ¥æ–‡æ®µçš„ç¡®è®¤åï¼ŒæŠŠæ‹¥å¡çª—å£å¢åŠ è‡³å¤šä¸€ä¸ªMSSçš„æ•°å€¼ã€‚ç”¨è¿™æ ·çš„æ–¹æ³•é€æ­¥å¢å¤§å‘é€æ–¹çš„æ‹¥å¡çª—å£cwndï¼Œå¯ä»¥ä½¿åˆ†ç»„æ³¨å…¥åˆ°ç½‘ç»œçš„é€Ÿç‡æ›´åŠ åˆç†ã€‚\næ…¢å¼€å§‹æ‹¥å¡çª—å£å˜åŒ–ï¼š\nå›¾è§£ï¼š\næ‹¥å¡é¿å…ç®—æ³•å°±æ˜¯æŒ‡æ‹¥å¡çª—å£æŒ‰çº¿æ€§è§„å¾‹å¢é•¿ã€‚\nåœ¨TCPæ‹¥å¡æ§åˆ¶çš„æ–‡çŒ®ä¸­ç»å¸¸å¯çœ‹è§â€œä¹˜æ³•å‡å°â€(Multiplicative Decrease)å’Œâ€œåŠ æ³•å¢å¤§â€(Additive Increase)è¿™æ ·çš„ææ³•ã€‚â€œä¹˜æ³•å‡å°â€æ˜¯æŒ‡ä¸è®ºåœ¨æ…¢å¼€å§‹é˜¶æ®µè¿˜æ˜¯æ‹¥å¡é¿å…é˜¶æ®µï¼Œåªè¦å‡ºç°è¶…æ—¶ï¼ˆå³å¾ˆå¯èƒ½å‡ºç°äº†ç½‘ç»œæ‹¥å¡ï¼‰ï¼Œå°±æŠŠæ…¢å¼€å§‹é—¨é™å€¼ssthreshå‡åŠï¼Œå³è®¾ç½®ä¸ºå½“å‰çš„æ‹¥å¡çª—å£çš„ä¸€åŠï¼ˆä¸æ­¤åŒæ—¶ï¼Œæ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼‰ã€‚å½“ç½‘ç»œé¢‘ç¹å‡ºç°æ‹¥å¡æ—¶ï¼Œssthreshå€¼å°±ä¸‹é™å¾—å¾ˆå¿«ï¼Œä»¥å¤§å¤§å‡å°‘æ³¨å…¥åˆ°ç½‘ç»œä¸­çš„åˆ†ç»„æ•°ã€‚è€Œâ€œåŠ æ³•å¢å¤§â€æ˜¯æŒ‡æ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•åï¼Œä½¿æ‹¥å¡çª—å£ç¼“æ…¢å¢å¤§ï¼Œä»¥é˜²æ­¢ç½‘ç»œè¿‡æ—©å‡ºç°æ‹¥å¡ã€‚ä¸Šé¢ä¸¤ç§ç®—æ³•åˆèµ·æ¥å¸¸ç§°ä¸ºAIMDç®—æ³•ï¼ˆåŠ æ³•å¢å¤§ä¹˜æ³•å‡å°ï¼‰ã€‚å¯¹è¿™ç§ç®—æ³•è¿›è¡Œé€‚å½“ä¿®æ”¹åï¼Œåˆå‡ºç°äº†å…¶ä»–ä¸€äº›æ”¹è¿›çš„ç®—æ³•ã€‚ä½†ä½¿ç”¨æœ€å¹¿æ³›çš„è¿˜æ˜¯AIMDç®—æ³•ã€‚\n  å¿«é‡ä¼ å’Œå¿«æ¢å¤\nå¿«é‡ä¼ ç®—æ³•è§„å®šï¼Œå‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µM3ï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…ä¸ºM3è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨åˆ°æœŸã€‚ç”±äºå‘é€æ–¹èƒ½å°½æ—©é‡ä¼ æœªè¢«ç¡®è®¤çš„æŠ¥æ–‡æ®µï¼Œå› æ­¤é‡‡ç”¨å¿«é‡ä¼ åå¯ä»¥ä½¿æ•´ä¸ªç½‘ç»œçš„ååé‡æé«˜çº¦20%ã€‚\nç¤ºæ„å›¾ï¼š\nå¿«é‡ä¼ é…åˆä½¿ç”¨çš„è¿˜æœ‰å¿«æ¢å¤ç®—æ³•ï¼Œå…¶è¿‡ç¨‹æœ‰ä»¥ä¸‹ä¸¤ä¸ªè¦ç‚¹ï¼š\n å½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œâ€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠæ…¢å¼€å§‹é—¨é™ssthreshå‡åŠã€‚è¿™æ˜¯ä¸ºäº†é¢„é˜²ç½‘ç»œå‘ç”Ÿæ‹¥å¡ã€‚è¯·æ³¨æ„ï¼Œæ¥ä¸‹å»ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚ ç”±äºå‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¾ˆå¯èƒ½æ²¡æœ‰å‘ç”Ÿæ‹¥å¡ï¼ˆå¦‚æœç½‘ç»œå‘ç”Ÿäº†ä¸¥é‡çš„æ‹¥å¡ï¼Œå°±ä¸ä¼šä¸€è¿æœ‰å¥½å‡ ä¸ªæŠ¥æ–‡æ®µè¿ç»­åˆ°è¾¾æ¥æ”¶æ–¹ï¼Œä¹Ÿå°±ä¸ä¼šå¯¼è‡´æ¥æ”¶æ–¹è¿ç»­å‘é€é‡å¤ç¡®è®¤ï¼‰ï¼Œå› æ­¤ä¸æ…¢å¼€å§‹ä¸åŒä¹‹å¤„æ˜¯ç°åœ¨ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼ˆå³æ‹¥å¡çª—å£cwndç°åœ¨ä¸è®¾ç½®ä¸º1ï¼‰ï¼Œè€Œæ˜¯æŠŠcwndå€¼è®¾ç½®ä¸ºæ…¢å¼€å§‹é—¨é™ssthreshå‡åŠåçš„æ•°å€¼ï¼Œç„¶åå¼€å§‹æ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ï¼ˆâ€œåŠ æ³•å¢å¤§â€ï¼‰ï¼Œä½¿æ‹¥å¡çª—å£ç¼“æ…¢åœ°çº¿æ€§å¢å¤§ã€‚  ç¤ºæ„å›¾ï¼š\n  å¦‚æœæŠŠæ‹¥å¡æ§åˆ¶å’Œæ¥æ”¶æ–¹å¯¹å‘é€æ–¹çš„æµé‡æ§åˆ¶ä¸€èµ·è€ƒè™‘ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œå‘é€æ–¹çš„çª—å£çš„ä¸Šé™å€¼åº”å½“å–ä¸ºæ¥æ”¶æ–¹çª—å£rwndå’Œæ‹¥å¡çª—å£cwndè¿™ä¸¤ä¸ªå˜é‡ä¸­è¾ƒå°çš„ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š\næµé‡æ§åˆ¶ æ»‘åŠ¨çª—å£\næ‹¥å¡æ§åˆ¶ å¿«é‡ä¼ ã€å¿«æ¢å¤ã€è¶…æ—¶é‡ä¼ ï¼Œæ‹¥å¡é¿å…\nUDPğŸ“¦ UDPä¸€æ¬¡äº¤ä»˜ä¸€ä¸ªå®Œæ•´çš„æŠ¥æ–‡ï¼Œä¸ä¼šå¯¹æŠ¥æ–‡è¿›è¡Œæ‹†åˆ†ã€‚å› æ­¤ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»é€‰æ‹©åˆé€‚å¤§å°çš„æŠ¥æ–‡ã€‚è‹¥æŠ¥æ–‡å¤ªé•¿ï¼ŒUDPæŠŠå®ƒäº¤ç»™IPå±‚åï¼ŒIPå±‚åœ¨ä¼ é€æ—¶å¯èƒ½è¦è¿›è¡Œåˆ†ç‰‡ï¼Œè¿™ä¼šé™ä½IPå±‚çš„æ•ˆç‡ã€‚åä¹‹ï¼Œè‹¥æŠ¥æ–‡å¤ªçŸ­ï¼ŒUDPæŠŠå®ƒäº¤ç»™IPå±‚åï¼Œä¼šä½¿IPæ•°æ®æŠ¥çš„é¦–éƒ¨çš„ç›¸å¯¹é•¿åº¦å¤ªå¤§ï¼Œè¿™ä¹Ÿé™ä½äº†IPå±‚çš„æ•ˆç‡ã€‚\nUDPæ•°æ®æŠ¥æ ¼å¼ï¼š(é¦–éƒ¨8å­—èŠ‚)\nä¼ªæŠ¥å¤´æ ¼å¼ï¼š\n **æ ¡éªŒå’Œè®¡ç®—ï¼š**ä¼ªæŠ¥å¤´+UDPæ•°æ®æŠ¥\n ä¼ªæŠ¥å¤´çš„ä½œç”¨æ˜¯éªŒè¯UDPæ•°æ®æŠ¥æ˜¯å¦æ­£ç¡®ä¼ é€åˆ°ç›®çš„è¿›ç¨‹ã€‚\nè®¡ç®—æ ¡éªŒå’Œï¼š\nåœ¨å‘é€æ–¹ï¼Œé¦–å…ˆæ˜¯å…ˆæŠŠå…¨é›¶æ”¾å…¥æ£€éªŒå’Œå­—æ®µã€‚å†æŠŠä¼ªé¦–éƒ¨ä»¥åŠUDPç”¨æˆ·æ•°æ®æŠ¥çœ‹æˆæ˜¯ç”±è®¸å¤š16ä½çš„å­—ä¸²æ¥èµ·æ¥ã€‚è‹¥UDPç”¨æˆ·æ•°æ®æŠ¥çš„æ•°æ®éƒ¨åˆ†ä¸æ˜¯å¶æ•°ä¸ªå­—èŠ‚ï¼Œåˆ™è¦å¡«å…¥ä¸€ä¸ªå…¨é›¶å­—èŠ‚ï¼ˆä½†æ­¤å­—èŠ‚ä¸å‘é€ï¼‰ã€‚ç„¶åæŒ‰äºŒè¿›åˆ¶åç è®¡ç®—å‡ºè¿™äº›16ä½å­—çš„å’Œã€‚å°†æ­¤å’Œçš„äºŒè¿›åˆ¶åç å†™å…¥æ£€éªŒå’Œå­—æ®µåï¼Œå°±å‘é€è¿™æ ·çš„UDPç”¨æˆ·æ•°æ®æŠ¥ã€‚åœ¨æ¥æ”¶æ–¹ï¼ŒæŠŠæ”¶åˆ°çš„UDPç”¨æˆ·æ•°æ®æŠ¥è¿åŒä¼ªé¦–éƒ¨ï¼ˆä»¥åŠå¯èƒ½çš„å¡«å……å…¨é›¶å­—èŠ‚ï¼‰ä¸€èµ·ï¼ŒæŒ‰äºŒè¿›åˆ¶åç æ±‚è¿™äº›16ä½å­—çš„å’Œã€‚å½“æ— å·®é”™æ—¶å…¶ç»“æœåº”ä¸ºå…¨1ã€‚\n äºŒè¿›åˆ¶åç æ±‚å’Œï¼š0å’Œ0ç›¸åŠ æ˜¯0ï¼Œä½†è¦äº§ç”Ÿä¸€ä¸ªè¿›ä½1ï¼Œ0å’Œ1ç›¸åŠ æ˜¯1ï¼Œ1å’Œ1ç›¸åŠ æ˜¯0ã€‚è‹¥æœ€é«˜ä½ç›¸åŠ åäº§ç”Ÿè¿›ä½ï¼Œåˆ™æœ€åå¾—åˆ°çš„ç»“æœè¦åŠ 1ã€‚\nï¼ˆ0ï¼‰å + ï¼ˆ0ï¼‰å = 1 + 1 = 10\nï¼ˆ1ï¼‰å +ï¼ˆ0ï¼‰å=0+ 1 =1\nï¼ˆ1ï¼‰å + ï¼ˆ1ï¼‰å = 0 + 0 = 0\n\u0026ldquo;äºŒè¿›åˆ¶åç æ±‚å’Œ\u0026rdquo; ç­‰ä»·äº \u0026ldquo;äºŒè¿›åˆ¶æ±‚å’Œå†å–å\u0026rdquo;\näºŒè¿›åˆ¶æ±‚å‡ºçš„å’Œå¦‚æœå¤§äº16ä½æ—¶æ‰€åšçš„æ“ä½œ,ç”¨å’Œå€¼ä¸­é«˜16ä½åŠ ä¸Šä½16ä½çš„å€¼ä½œä¸ºæœ€ç»ˆçš„å’Œå€¼,ç„¶åå†åšå–åè¿ç®—.\n ä¸‹é¢æ˜¯è®¡ç®—æ ¡éªŒå’Œçš„ä¸€ä¸ªä¾‹å­ï¼š\n è¿™æ ·çš„æ£€éªŒå’Œï¼Œæ—¢æ£€æŸ¥äº†UDPç”¨æˆ·æ•°æ®æŠ¥çš„æºç«¯å£å·å’Œç›®çš„ç«¯å£å·ä»¥åŠUDPç”¨æˆ·æ•°æ®æŠ¥çš„æ•°æ®éƒ¨åˆ†ï¼Œåˆæ£€æŸ¥äº†IPæ•°æ®æŠ¥çš„æºIPåœ°å€å’Œç›®çš„åœ°å€ã€‚\n  ç½‘å¡æ”¶åˆ°ä¸€æ¡æ•°æ®åˆ°è¿›ç¨‹å¤„ç†æ•°æ®,è¿™ä¹‹é—´ç»å†äº†ä»€ä¹ˆ(ä¸­æ–­çš„ä¸ŠåŠéƒ¨ä¸‹åŠéƒ¨,ç½‘ç»œå±‚åè®®æ‹†åŒ…)ï¼Ÿ\næ‹¥å¡æ§åˆ¶ç®—æ³• TCPæ‹¥å¡æ§åˆ¶ç®—æ³•çš„ç›®çš„å¯ä»¥ç®€å•æ¦‚æ‹¬ä¸ºï¼šå…¬å¹³ç«äº‰ã€å……åˆ†åˆ©ç”¨ç½‘ç»œå¸¦å®½ã€é™ä½ç½‘ç»œå»¶æ—¶ã€ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œç„¶è€Œå°±ç›®å‰è€Œè¨€è¦å®ç°è¿™äº›ç›®æ ‡å°±éš¾å…æœ‰æƒè¡¡å’Œå–èˆã€‚\nç®—æ³•åˆ†ç±» åŸºäºä¸¢åŒ…ç­–ç•¥çš„ä¼ ç»Ÿæ‹¥å¡æ§åˆ¶ç®—æ³•çš„å‡ ä¸ªè¿­ä»£ç‰ˆæœ¬ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\nä¸æ­¤åŒæ—¶è¿˜æœ‰ä¸€ç±»ç®—æ³•æ˜¯åŸºäºRTTå»¶æ—¶ç­–ç•¥æ¥è¿›è¡Œæ§åˆ¶çš„ï¼Œä½†æ˜¯è¿™ç±»ç®—æ³•åœ¨å‘åŒ…é€Ÿç‡ä¸Šå¯èƒ½ä¸å¤Ÿæ¿€è¿›ï¼Œç«äº‰æ€§èƒ½ä¸å¦‚å…¶ä»–ç®—æ³•ï¼Œå› æ­¤åœ¨å…±äº«ç½‘ç»œå¸¦å®½æ—¶æœ‰å¤±å…¬å¹³æ€§ï¼Œä½†æ˜¯ç®—æ³•é€Ÿç‡æ›²çº¿å´æ˜¯å¾ˆå¹³æ»‘\nå¦‚ä½•æ„ŸçŸ¥æ‹¥å¡ åœ¨TCPè¿æ¥çš„å‘é€æ–¹ä¸€èˆ¬æ˜¯åŸºäºä¸¢åŒ…æ¥åˆ¤æ–­å½“å‰ç½‘ç»œæ˜¯å¦å‘ç”Ÿæ‹¥å¡ï¼Œä¸¢åŒ…å¯ä»¥ç”±é‡ä¼ è¶…æ—¶RTOå’Œé‡å¤ç¡®è®¤æ¥åšåˆ¤æ–­ã€‚\næ‹¥å¡æ§åˆ¶åŸºæœ¬ç­–ç•¥ æ‹¥å¡æ§åˆ¶æ˜¯ä¸€ä¸ªåŠ¨æ€çš„è¿‡ç¨‹ï¼Œå®ƒæ—¢è¦æé«˜å¸¦å®½åˆ©ç”¨ç‡å‘é€å°½é‡å¤šçš„æ•°æ®åˆè¦é¿å…ç½‘ç»œæ‹¥å µä¸¢åŒ…RTTå¢å¤§ç­‰é—®é¢˜ï¼ŒåŸºäºè¿™ç§é«˜è¦æ±‚å¹¶ä¸æ˜¯å•ä¸€ç­–ç•¥å¯ä»¥æå®šçš„ï¼Œå› æ­¤TCPçš„ æ‹¥å¡æ§åˆ¶ç­–ç•¥å®é™…ä¸Šæ˜¯åˆ†é˜¶æ®µåˆ†ç­–ç•¥çš„ç»¼åˆè¿‡ç¨‹ï¼š\nTCP Tahoe å’ŒTCP Reno\nè¿™ä¸¤ä¸ªç®—æ³•ä»£å·å–è‡ªå¤ªæµ©æ¹–Lakeå’ŒTahoeé‡Œè¯ºå¸‚ï¼Œä¸¤è€…ç®—æ³•å¤§è‡´ä¸€è‡´ï¼Œå¯¹äºä¸¢åŒ…äº‹ä»¶åˆ¤æ–­éƒ½æ˜¯ä»¥é‡ä¼ è¶…æ—¶retransmission timeoutå’Œé‡å¤ç¡®è®¤ä¸ºæ¡ä»¶ï¼Œä½†æ˜¯å¯¹äºé‡å¤ç¡®è®¤çš„å¤„ç†ä¸¤è€…æœ‰æ‰€ä¸åŒï¼Œå¯¹äºè¶…æ—¶é‡ä¼ RTOæƒ…å†µä¸¤ä¸ªç®—æ³•éƒ½æ˜¯å°†æ‹¥å¡çª—å£é™ä¸º1ä¸ªMSSï¼Œç„¶åè¿›å…¥æ…¢å¯åŠ¨é˜¶æ®µã€‚\nTCP Tahoeç®—æ³•ï¼šå¦‚æœæ”¶åˆ°ä¸‰æ¬¡é‡å¤ç¡®è®¤å³ç¬¬å››æ¬¡æ”¶åˆ°ç›¸åŒç¡®è®¤å·çš„åˆ†æ®µç¡®è®¤ï¼Œå¹¶ä¸”åˆ†æ®µå¯¹åº”åŒ…æ— è´Ÿè½½åˆ†æ®µå’Œæ— æ”¹å˜æ¥æ”¶çª—å£çš„è¯ï¼ŒTahoeç®—æ³•åˆ™è¿›å…¥å¿«é€Ÿé‡ä¼ ï¼Œå°†æ…¢å¯åŠ¨é˜ˆå€¼æ”¹ä¸ºå½“å‰æ‹¥å¡çª—å£çš„ä¸€åŠï¼Œå°†æ‹¥å¡çª—å£é™ä¸º1ä¸ªMSSï¼Œå¹¶é‡æ–°è¿›å…¥æ…¢å¯åŠ¨é˜¶æ®µã€‚\nTCP Renoç®—æ³•ï¼šå¦‚æœæ”¶åˆ°ä¸‰æ¬¡é‡å¤ç¡®è®¤ï¼ŒRenoç®—æ³•åˆ™è¿›å…¥å¿«é€Ÿé‡ä¼ åªå°†æ‹¥å¡çª—å£å‡åŠæ¥è·³è¿‡æ…¢å¯åŠ¨é˜¶æ®µï¼Œå°†æ…¢å¯åŠ¨é˜ˆå€¼è®¾ä¸ºå½“å‰æ–°çš„æ‹¥å¡çª—å£å€¼ï¼Œè¿›å…¥ä¸€ä¸ªç§°ä¸ºå¿«é€Ÿæ¢å¤çš„æ–°è®¾è®¡é˜¶æ®µã€‚TCP New Reno\nTCP New Renoæ˜¯å¯¹TCP Renoä¸­å¿«é€Ÿæ¢å¤é˜¶æ®µçš„é‡ä¼ è¿›è¡Œæ”¹å–„çš„ä¸€ç§æ”¹è¿›ç®—æ³•ï¼ŒNew Renoåœ¨ä½é”™è¯¯ç‡æ—¶è¿è¡Œæ•ˆç‡å’Œé€‰æ‹©ç¡®è®¤SACKç›¸å½“ï¼Œåœ¨é«˜é”™è¯¯ç‡ä»ä¼˜äºRenoã€‚\nTCP BIC å’ŒTCP CUBIC\nTCP BICæ—¨åœ¨ä¼˜åŒ–é«˜é€Ÿé«˜å»¶è¿Ÿç½‘ç»œçš„æ‹¥å¡æ§åˆ¶ï¼Œå…¶æ‹¥å¡çª—å£ç®—æ³•ä½¿ç”¨äºŒåˆ†æœç´¢ç®—æ³•å°è¯•æ‰¾åˆ°èƒ½é•¿æ—¶é—´ä¿æŒæ‹¥å¡çª—å£æœ€å¤§å€¼ï¼ŒLinuxå†…æ ¸åœ¨2.6.8è‡³2.6.18ä½¿ç”¨è¯¥ç®—æ³•ä½œä¸ºé»˜è®¤TCPæ‹¥å¡ç®—æ³•ã€‚\nCUBICåˆ™æ˜¯æ¯”BICæ›´æ¸©å’Œå’Œç³»ç»ŸåŒ–çš„åˆ†æ”¯ç‰ˆæœ¬ï¼Œå…¶ä½¿ç”¨ä¸‰æ¬¡å‡½æ•°ä»£æ›¿äºŒåˆ†ç®—æ³•ä½œä¸ºå…¶æ‹¥å¡çª—å£ç®—æ³•ï¼Œå¹¶ä¸”ä½¿ç”¨å‡½æ•°æ‹ç‚¹ä½œä¸ºæ‹¥å¡çª—å£çš„è®¾ç½®å€¼ï¼ŒLinuxå†…æ ¸åœ¨2.6.19åä½¿ç”¨è¯¥ç®—æ³•ä½œä¸ºé»˜è®¤TCPæ‹¥å¡ç®—æ³•ã€‚\nTCP PRR\nTCP PRRæ˜¯æ—¨åœ¨æ¢å¤æœŸé—´æé«˜å‘é€æ•°æ®çš„å‡†ç¡®æ€§ï¼Œè¯¥ç®—æ³•ç¡®ä¿æ¢å¤åçš„æ‹¥å¡çª—å£å¤§å°å°½å¯èƒ½æ¥è¿‘æ…¢å¯åŠ¨é˜ˆå€¼ã€‚åœ¨Googleè¿›è¡Œçš„æµ‹è¯•ä¸­ï¼Œèƒ½å°†å¹³å‡å»¶è¿Ÿé™ä½3~10%æ¢å¤è¶…æ—¶å‡å°‘5%ï¼ŒPRRç®—æ³•åä½œä¸ºLinuxå†…æ ¸3.2ç‰ˆæœ¬é»˜è®¤æ‹¥å¡ç®—æ³•ã€‚\nTCP BBRæ˜¯ç”±Googleè®¾è®¡äº2016å¹´å‘å¸ƒçš„æ‹¥å¡ç®—æ³•ï¼Œè¯¥ç®—æ³•è®¤ä¸ºéšç€ç½‘ç»œæ¥å£æ§åˆ¶å™¨é€æ¸è¿›å…¥åƒå…†é€Ÿåº¦æ—¶ï¼Œåˆ†ç»„ä¸¢å¤±ä¸åº”è¯¥è¢«è®¤ä¸ºæ˜¯è¯†åˆ«æ‹¥å¡çš„ä¸»è¦å†³å®šå› ç´ ï¼Œæ‰€ä»¥åŸºäºæ¨¡å‹çš„æ‹¥å¡æ§åˆ¶ç®—æ³•èƒ½æœ‰æ›´é«˜çš„ååé‡å’Œæ›´ä½çš„å»¶è¿Ÿï¼Œå¯ä»¥ç”¨BBRæ¥æ›¿ä»£å…¶ä»–æµè¡Œçš„æ‹¥å¡ç®—æ³•ã€‚\nGoogleåœ¨YouTubeä¸Šåº”ç”¨è¯¥ç®—æ³•ï¼Œå°†å…¨çƒå¹³å‡çš„YouTubeç½‘ç»œååé‡æé«˜äº†4%ï¼ŒBBRä¹‹åç§»æ¤å…¥Linuxå†…æ ¸4.9ç‰ˆæœ¬ã€‚\nå…¶ä¸­æ¯”è¾ƒæœ‰åçš„Vegasç®—æ³•æ˜¯å¤§çº¦åœ¨1995å¹´ç”±äºšåˆ©æ¡‘é‚£å¤§å­¦çš„ç ”ç©¶äººå‘˜æ‹‰é‡ŒÂ·å½¼å¾—æ£®å’ŒåŠ³ä¼¦æ–¯Â·å¸ƒæ‹‰ç§‘å¤«æå‡ºï¼Œè¿™ä¸ªæ–°çš„TCPæ‹¥å¡ç®—æ³•ä»¥å†…åè¾¾å·æœ€å¤§çš„åŸå¸‚æ‹‰æ–¯ç»´åŠ æ–¯å‘½åï¼Œåæˆä¸ºTCP Vegasç®—æ³•ã€‚\nå…³äºåŸºäºRTTçš„TCP Vegasç®—æ³•çš„è¯¦ç»†ä»‹ç»å¯ä»¥æŸ¥é˜…æ–‡æ¡£ï¼š\n http://www.cs.cmu.edu/~srini/15-744/F02/readings/BP95.pdf\n æ–‡æ¡£å¯¹Vegasç®—æ³•å’ŒNew Renoåšäº†ä¸€äº›å¯¹æ¯”ï¼Œæˆ‘ä»¬ä»ç›´è§‚å›¾å½¢ä¸Šå¯ä»¥çœ‹åˆ°Vegasç®—æ³•æ›´åŠ å¹³æ»‘ï¼Œç›¸åNew Renoåˆ™è¡¨ç°é™¤äº†è¾ƒå¤§çš„æ³¢åŠ¨å‘ˆé”¯é½¿çŠ¶ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\nå®é™…ä¸Šè¿˜æœ‰æ›´ç»†ç²’åº¦çš„åˆ†ç±»ï¼Œç”±äºä¸æ˜¯ä»Šå¤©çš„é‡ç‚¹ï¼Œå°±ä¸å†æ·±å…¥å±•å¼€äº†ï¼Œå½“å‰ä½¿ç”¨çš„æ‹¥å¡æ§åˆ¶ç®—æ³•è¿˜æ˜¯åŸºäºä¸¢åŒ…Loss-Basedä½œä¸ºä¸»æµã€‚\nå‚è€ƒï¼š\n ä¸‡å­—é•¿æ–‡|å…¨ç½‘æœ€å¼º TCP/IP æ‹¥å¡æ§åˆ¶æ€»ç»“\u0026hellip; ä¸‡å­—è¯¦æ–‡ï¼šTCP æ‹¥å¡æ§åˆ¶è¯¦è§£  ä¸€æ³¡å°¿çš„æ—¶é—´ï¼Œå¿«é€Ÿè¯»æ‡‚QUICåè®® å¦‚ä½•è®©ç½‘ç»œæ•°æ®ä¼ è¾“åœ°æ›´å¿«ï¼Ÿ(åˆå¹¶ä¸€äº›å±‚)\nä¸ºä»€ä¹ˆéœ€è¦QUICï¼Ÿ   ä¸­é—´è®¾å¤‡çš„åƒµåŒ–\nå¯èƒ½æ˜¯ TCP åè®®ä½¿ç”¨å¾—å¤ªä¹…ï¼Œä¹Ÿéå¸¸å¯é ã€‚æ‰€ä»¥æˆ‘ä»¬å¾ˆå¤šä¸­é—´è®¾å¤‡ï¼ŒåŒ…æ‹¬é˜²ç«å¢™ã€NAT ç½‘å…³ï¼Œæ•´æµå™¨ç­‰å‡ºç°äº†ä¸€äº›çº¦å®šä¿—æˆçš„åŠ¨ä½œã€‚\n  ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„å®ç°å¯¼è‡´åè®®åƒµåŒ–\nTCP æ˜¯ç”±æ“ä½œç³»ç»Ÿåœ¨å†…æ ¸è¥¿æ–¹æ ˆå±‚é¢å®ç°çš„ï¼Œåº”ç”¨ç¨‹åºåªèƒ½ä½¿ç”¨ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ã€‚è™½ç„¶åº”ç”¨ç¨‹åºçš„æ›´æ–°è¿­ä»£éå¸¸å¿«é€Ÿå’Œç®€å•ã€‚ä½†æ˜¯ TCP çš„è¿­ä»£å´éå¸¸ç¼“æ…¢ï¼ŒåŸå› å°±æ˜¯æ“ä½œç³»ç»Ÿå‡çº§å¾ˆéº»çƒ¦ã€‚\n  å»ºç«‹è¿æ¥çš„æ¡æ‰‹å»¶è¿Ÿå¤§\nä¸ç®¡æ˜¯ HTTP1.0/1.1 è¿˜æ˜¯ HTTPSï¼ŒHTTP2ï¼Œéƒ½ä½¿ç”¨äº† TCP è¿›è¡Œä¼ è¾“ã€‚HTTPS å’Œ HTTP2 è¿˜éœ€è¦ä½¿ç”¨ TLS åè®®æ¥è¿›è¡Œå®‰å…¨ä¼ è¾“ã€‚è¿™å°±å‡ºç°äº†ä¸¤ä¸ªæ¡æ‰‹å»¶è¿Ÿï¼š\n  TCP ä¸‰æ¬¡æ¡æ‰‹å¯¼è‡´çš„ TCP è¿æ¥å»ºç«‹çš„å»¶è¿Ÿã€‚\n  TLS å®Œå…¨æ¡æ‰‹éœ€è¦è‡³å°‘ 2 ä¸ª RTT æ‰èƒ½å»ºç«‹ï¼Œç®€åŒ–æ¡æ‰‹éœ€è¦ 1 ä¸ª RTT çš„æ¡æ‰‹å»¶è¿Ÿã€‚\n  å¯¹äºå¾ˆå¤šçŸ­è¿æ¥åœºæ™¯ï¼Œè¿™æ ·çš„æ¡æ‰‹å»¶è¿Ÿå½±å“å¾ˆå¤§ï¼Œä¸”æ— æ³•æ¶ˆé™¤ã€‚\n  é˜Ÿå¤´é˜»å¡\né˜Ÿå¤´é˜»å¡ä¸»è¦æ˜¯ TCP åè®®çš„å¯é æ€§æœºåˆ¶å¼•å…¥çš„ã€‚TCP ä½¿ç”¨åºåˆ—å·æ¥æ ‡è¯†æ•°æ®çš„é¡ºåºï¼Œæ•°æ®å¿…é¡»æŒ‰ç…§é¡ºåºå¤„ç†ï¼Œå¦‚æœå‰é¢çš„æ•°æ®ä¸¢å¤±ï¼Œåé¢çš„æ•°æ®å°±ç®—åˆ°è¾¾äº†ä¹Ÿä¸ä¼šé€šçŸ¥åº”ç”¨å±‚æ¥å¤„ç†ã€‚\nå¦å¤– TLS åè®®å±‚é¢ä¹Ÿæœ‰ä¸€ä¸ªé˜Ÿå¤´é˜»å¡ï¼Œå› ä¸º TLS åè®®éƒ½æ˜¯æŒ‰ç…§ record æ¥å¤„ç†æ•°æ®çš„ï¼Œå¦‚æœä¸€ä¸ª record ä¸­ä¸¢å¤±äº†æ•°æ®ï¼Œä¹Ÿä¼šå¯¼è‡´æ•´ä¸ª record æ— æ³•æ­£ç¡®å¤„ç†ã€‚\n  QUIC åè®®é€‰æ‹©äº† UDPï¼Œå› ä¸º UDP æœ¬èº«æ²¡æœ‰è¿æ¥çš„æ¦‚å¿µï¼Œä¸éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¼˜åŒ–äº†è¿æ¥å»ºç«‹çš„æ¡æ‰‹å»¶è¿Ÿï¼ŒåŒæ—¶åœ¨åº”ç”¨ç¨‹åºå±‚é¢å®ç°äº† TCP çš„å¯é æ€§ï¼ŒTLS çš„å®‰å…¨æ€§å’Œ HTTP2 çš„å¹¶å‘æ€§ï¼Œåªéœ€è¦ç”¨æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„åº”ç”¨ç¨‹åºæ”¯æŒ QUIC åè®®ï¼Œå®Œå…¨é¿å¼€äº†æ“ä½œç³»ç»Ÿå’Œä¸­é—´è®¾å¤‡çš„é™åˆ¶ã€‚\nQUIC æ˜¯ Quick UDP Internet Connections çš„ç¼©å†™ï¼Œè°·æ­Œå‘æ˜çš„æ–°ä¼ è¾“åè®®ã€‚\n ä¸ TCP ç›¸æ¯”ï¼ŒQUIC å¯ä»¥å‡å°‘å»¶è¿Ÿã€‚\n QUIC åè®®å¯ä»¥åœ¨ 1 åˆ° 2 ä¸ªæ•°æ®åŒ…ï¼ˆå–å†³äºè¿æ¥çš„æœåŠ¡å™¨æ˜¯æ–°çš„è¿˜æ˜¯å·²çŸ¥çš„ï¼‰å†…ï¼Œå®Œæˆè¿æ¥çš„åˆ›å»ºï¼ˆåŒ…æ‹¬ TLSï¼‰ã€‚\nQUIC ä¸ç°æœ‰ TCP + TLS + HTTP/2 æ–¹æ¡ˆç›¸æ¯”ï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹ä¸»è¦ç‰¹å¾ï¼š\n åˆ©ç”¨ç¼“å­˜ï¼Œæ˜¾è‘—å‡å°‘è¿æ¥å»ºç«‹æ—¶é—´ï¼›(å‡å°‘äº† TCP ä¸‰æ¬¡æ¡æ‰‹åŠ TLS æ¡æ‰‹æ—¶é—´) æ”¹å–„æ‹¥å¡æ§åˆ¶ï¼Œæ‹¥å¡æ§åˆ¶ä»å†…æ ¸ç©ºé—´åˆ°ç”¨æˆ·ç©ºé—´ï¼› æ²¡æœ‰ head of line é˜»å¡çš„å¤šè·¯å¤ç”¨ï¼› å‰å‘çº é”™ï¼Œå‡å°‘é‡ä¼ ï¼› è¿æ¥å¹³æ»‘è¿ç§»ï¼Œç½‘ç»œçŠ¶æ€çš„å˜æ›´ä¸ä¼šå½±å“è¿æ¥æ–­çº¿ã€‚  æ‹¥å¡æ§åˆ¶ã€åŠ å¯†å’Œä¸€äº›HTTP/2çš„ç‰¹æ€§éƒ½ç§»åŠ¨åˆ°QUICå±‚å»äº†\nä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼ŒQUIC åº•å±‚é€šè¿‡ UDP åè®®æ›¿ä»£äº† TCPï¼Œä¸Šå±‚åªéœ€è¦ä¸€å±‚ç”¨äºå’Œè¿œç¨‹æœåŠ¡å™¨äº¤äº’çš„ HTTP/2 APIã€‚è¿™æ˜¯å› ä¸º QUIC åè®®å·²ç»åŒ…å«äº†å¤šè·¯å¤ç”¨å’Œè¿æ¥ç®¡ç†ï¼ŒHTTP API åªéœ€è¦å®Œæˆ HTTP åè®®çš„è§£æå³å¯ã€‚\nQUICä¹Ÿåˆå¹¶äº†TLSæ¡æ‰‹è¿‡ç¨‹åˆ°å®ƒçš„è¿æ¥è¿‡ç¨‹ä¹‹ä¸­\nç›®æ ‡ QUIC åè®®çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯ä¸ºäº†æ•´åˆ TCP åè®®çš„å¯é æ€§å’Œ UDP åè®®çš„é€Ÿåº¦å’Œæ•ˆç‡ã€‚\nQUICè¿æ¥è¿‡ç¨‹ Step1ï¼šé¦–æ¬¡è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å‘é€ Inchoate Client Hello ç»™æœåŠ¡ç«¯ï¼Œç”¨äºè¯·æ±‚è¿æ¥ï¼›\nStep2ï¼šæœåŠ¡ç«¯ç”Ÿæˆ gã€pã€aï¼Œæ ¹æ® gã€p å’Œ a ç®—å‡º Aï¼Œç„¶åå°† gã€pã€A æ”¾åˆ° Server Config ä¸­å†å‘é€ Rejection æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼›\nStep3ï¼šå®¢æˆ·ç«¯æ¥æ”¶åˆ° gã€pã€A åï¼Œè‡ªå·±å†ç”Ÿæˆ bï¼Œæ ¹æ® gã€pã€b ç®—å‡º Bï¼Œæ ¹æ® Aã€pã€b ç®—å‡ºåˆå§‹å¯†é’¥ Kã€‚B å’Œ K ç®—å¥½åï¼Œå®¢æˆ·ç«¯ä¼šç”¨ K åŠ å¯† HTTP æ•°æ®ï¼Œè¿åŒ B ä¸€èµ·å‘é€ç»™æœåŠ¡ç«¯ï¼›\nStep4ï¼šæœåŠ¡ç«¯æ¥æ”¶åˆ° B åï¼Œæ ¹æ® aã€pã€B ç”Ÿæˆä¸å®¢æˆ·ç«¯åŒæ ·çš„å¯†é’¥ï¼Œå†ç”¨è¿™å¯†é’¥è§£å¯†æ”¶åˆ°çš„ HTTP æ•°æ®ã€‚ä¸ºäº†è¿›ä¸€æ­¥çš„å®‰å…¨ï¼ˆå‰å‘å®‰å…¨æ€§ï¼‰ï¼ŒæœåŠ¡ç«¯ä¼šæ›´æ–°è‡ªå·±çš„éšæœºæ•° a å’Œå…¬é’¥ï¼Œå†ç”Ÿæˆæ–°çš„å¯†é’¥ Sï¼Œç„¶åæŠŠå…¬é’¥é€šè¿‡ Server Hello å‘é€ç»™å®¢æˆ·ç«¯ã€‚è¿åŒ Server Hello æ¶ˆæ¯ï¼Œè¿˜æœ‰ HTTP è¿”å›æ•°æ®ï¼›\nStep5ï¼šå®¢æˆ·ç«¯æ”¶åˆ° Server Hello åï¼Œç”Ÿæˆä¸æœåŠ¡ç«¯ä¸€è‡´çš„æ–°å¯†é’¥ Sï¼Œåé¢çš„ä¼ è¾“éƒ½ä½¿ç”¨ S åŠ å¯†ã€‚\nè¿™æ ·ï¼ŒQUIC ä»è¯·æ±‚è¿æ¥åˆ°æ­£å¼æ¥å‘ HTTP æ•°æ®ä¸€å…±èŠ±äº† 1 RTTï¼Œè¿™ 1 ä¸ª RTT ä¸»è¦æ˜¯ä¸ºäº†è·å– Server Configï¼Œåé¢çš„è¿æ¥å¦‚æœå®¢æˆ·ç«¯ç¼“å­˜äº† Server Configï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥å‘é€ HTTP æ•°æ®ï¼Œå®ç° 0 RTT å»ºç«‹è¿æ¥ã€‚\nè¿™é‡Œä½¿ç”¨çš„æ˜¯ DH å¯†é’¥äº¤æ¢ç®—æ³•ï¼ŒDH ç®—æ³•çš„æ ¸å¿ƒå°±æ˜¯æœåŠ¡ç«¯ç”Ÿæˆ aã€gã€p 3 ä¸ªéšæœºæ•°ï¼Œa è‡ªå·±æŒæœ‰ï¼Œg å’Œ p è¦ä¼ è¾“ç»™å®¢æˆ·ç«¯ï¼Œè€Œå®¢æˆ·ç«¯ä¼šç”Ÿæˆ b è¿™ 1 ä¸ªéšæœºæ•°ï¼Œé€šè¿‡ DH ç®—æ³•å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯ä»¥ç®—å‡ºåŒæ ·çš„å¯†é’¥ã€‚åœ¨è¿™è¿‡ç¨‹ä¸­ a å’Œ b å¹¶ä¸å‚ä¸ç½‘ç»œä¼ è¾“ï¼Œå®‰å…¨æ€§å¤§å¤§æé«˜ã€‚å› ä¸º p å’Œ g æ˜¯å¤§æ•°ï¼Œæ‰€ä»¥å³ä½¿åœ¨ç½‘ç»œä¸­ä¼ è¾“çš„ pã€gã€Aã€B éƒ½è¢«åŠ«æŒï¼Œé‚£ä¹ˆé ç°åœ¨çš„è®¡ç®—æœºç®—åŠ›ä¹Ÿæ²¡æ³•ç ´è§£å¯†é’¥ã€‚\nQUICè¿æ¥è¿ç§»  å½“æ‰‹æœºä»æ•°æ®ä¿¡å·åˆ‡æ¢åˆ°WIFIä¿¡å·æ—¶éœ€è¦å¯ä»¥çµæ´»çš„è¿›è¡Œè¿æ¥çš„åˆ‡æ¢ã€‚\n TCP è¿æ¥åŸºäºå››å…ƒç»„ï¼ˆæº IPã€æºç«¯å£ã€ç›®çš„ IPã€ç›®çš„ç«¯å£ï¼‰ï¼Œåˆ‡æ¢ç½‘ç»œæ—¶è‡³å°‘ä¼šæœ‰ä¸€ä¸ªå› ç´ å‘ç”Ÿå˜åŒ–ï¼Œå¯¼è‡´è¿æ¥å‘ç”Ÿå˜åŒ–ã€‚å½“è¿æ¥å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¦‚æœè¿˜ä½¿ç”¨åŸæ¥çš„ TCP è¿æ¥ï¼Œåˆ™ä¼šå¯¼è‡´è¿æ¥å¤±è´¥ï¼Œå°±å¾—ç­‰åŸæ¥çš„è¿æ¥è¶…æ—¶åé‡æ–°å»ºç«‹è¿æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰æ—¶å€™å‘ç°åˆ‡æ¢åˆ°ä¸€ä¸ªæ–°ç½‘ç»œæ—¶ï¼Œå³ä½¿æ–°ç½‘ç»œçŠ¶å†µè‰¯å¥½ï¼Œä½†å†…å®¹è¿˜æ˜¯éœ€è¦åŠ è½½å¾ˆä¹…ã€‚å¦‚æœå®ç°å¾—å¥½ï¼Œå½“æ£€æµ‹åˆ°ç½‘ç»œå˜åŒ–æ—¶ç«‹åˆ»å»ºç«‹æ–°çš„ TCP è¿æ¥ï¼Œå³ä½¿è¿™æ ·ï¼Œå»ºç«‹æ–°çš„è¿æ¥è¿˜æ˜¯éœ€è¦å‡ ç™¾æ¯«ç§’çš„æ—¶é—´ã€‚\nQUIC çš„è¿æ¥ä¸å—å››å…ƒç»„çš„å½±å“ï¼Œå½“è¿™å››ä¸ªå…ƒç´ å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒåŸè¿æ¥ä¾ç„¶ç»´æŒã€‚é‚£è¿™æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿé“ç†å¾ˆç®€å•ï¼ŒQUIC è¿æ¥ä¸ä»¥å››å…ƒç»„ä½œä¸ºæ ‡è¯†ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ª 64 ä½çš„éšæœºæ•°ï¼Œè¿™ä¸ªéšæœºæ•°è¢«ç§°ä¸º Connection IDï¼Œå³ä½¿ IP æˆ–è€…ç«¯å£å‘ç”Ÿå˜åŒ–ï¼Œåªè¦ Connection ID æ²¡æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆè¿æ¥ä¾ç„¶å¯ä»¥ç»´æŒã€‚\næ˜¯ä¸æ˜¯å¾ˆå¼º~\nQUICè§£å†³é˜Ÿå¤´é˜»å¡é—®é¢˜ HTTP ä¸€èˆ¬åˆå…è®¸æ¯ä¸ªä¸»æœºå»ºç«‹ 6 ä¸ª TCP è¿æ¥ï¼Œè¿™æ ·å¯ä»¥æ›´åŠ å……åˆ†åœ°åˆ©ç”¨å¸¦å®½èµ„æºï¼Œä½†æ¯ä¸ªè¿æ¥ä¸­é˜Ÿå¤´é˜»å¡çš„é—®é¢˜è¿˜æ˜¯å­˜åœ¨ã€‚\nHTTP/2 çš„å¤šè·¯å¤ç”¨è§£å†³äº†ä¸Šè¿°çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚ä¸åƒ HTTP/1.1 ä¸­åªæœ‰ä¸Šä¸€ä¸ªè¯·æ±‚çš„æ‰€æœ‰æ•°æ®åŒ…è¢«ä¼ è¾“å®Œæ¯•ä¸‹ä¸€ä¸ªè¯·æ±‚çš„æ•°æ®åŒ…æ‰å¯ä»¥è¢«ä¼ è¾“ï¼ŒHTTP/2 ä¸­æ¯ä¸ªè¯·æ±‚éƒ½è¢«æ‹†åˆ†æˆå¤šä¸ª Frame é€šè¿‡ä¸€æ¡ TCP è¿æ¥åŒæ—¶è¢«ä¼ è¾“ï¼Œè¿™æ ·å³ä½¿ä¸€ä¸ªè¯·æ±‚è¢«é˜»å¡ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–çš„è¯·æ±‚ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸åŒé¢œè‰²ä»£è¡¨ä¸åŒçš„è¯·æ±‚ï¼Œç›¸åŒé¢œè‰²çš„è‰²å—ä»£è¡¨è¯·æ±‚è¢«åˆ‡åˆ†çš„ Frameã€‚\näº‹æƒ…è¿˜æ²¡å®Œï¼ŒHTTP/2 è™½ç„¶å¯ä»¥è§£å†³â€œè¯·æ±‚â€è¿™ä¸ªç²’åº¦çš„é˜»å¡ï¼Œä½† HTTP/2 çš„åŸºç¡€ TCP åè®®æœ¬èº«å´ä¹Ÿå­˜åœ¨ç€é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ã€‚HTTP/2 çš„æ¯ä¸ªè¯·æ±‚éƒ½ä¼šè¢«æ‹†åˆ†æˆå¤šä¸ª Frameï¼Œä¸åŒè¯·æ±‚çš„ Frame ç»„åˆæˆ Streamï¼ŒStream æ˜¯ TCP ä¸Šçš„é€»è¾‘ä¼ è¾“å•å…ƒï¼Œè¿™æ · HTTP/2 å°±è¾¾åˆ°äº†ä¸€æ¡è¿æ¥åŒæ—¶å‘é€å¤šæ¡è¯·æ±‚çš„ç›®æ ‡ï¼Œè¿™å°±æ˜¯å¤šè·¯å¤ç”¨çš„åŸç†ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼Œåœ¨ä¸€æ¡ TCP è¿æ¥ä¸ŠåŒæ—¶å‘é€ 4 ä¸ª Streamï¼Œå…¶ä¸­ Stream1 å·²æ­£ç¡®é€è¾¾ï¼ŒStream2 ä¸­çš„ç¬¬ 3 ä¸ª Frame ä¸¢å¤±ï¼ŒTCP å¤„ç†æ•°æ®æ—¶æœ‰ä¸¥æ ¼çš„å‰åé¡ºåºï¼Œå…ˆå‘é€çš„ Frame è¦å…ˆè¢«å¤„ç†ï¼Œè¿™æ ·å°±ä¼šè¦æ±‚å‘é€æ–¹é‡æ–°å‘é€ç¬¬ 3 ä¸ª Frameï¼ŒStream3 å’Œ Stream4 è™½ç„¶å·²åˆ°è¾¾ä½†å´ä¸èƒ½è¢«å¤„ç†ï¼Œé‚£ä¹ˆè¿™æ—¶æ•´æ¡è¿æ¥éƒ½è¢«é˜»å¡ã€‚\nä¸ä»…å¦‚æ­¤ï¼Œç”±äº HTTP/2 å¿…é¡»ä½¿ç”¨ HTTPSï¼Œè€Œ HTTPS ä½¿ç”¨çš„ TLS åè®®ä¹Ÿå­˜åœ¨é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚TLS åŸºäº Record ç»„ç»‡æ•°æ®ï¼Œå°†ä¸€å †æ•°æ®æ”¾åœ¨ä¸€èµ·ï¼ˆå³ä¸€ä¸ª Recordï¼‰åŠ å¯†ï¼ŒåŠ å¯†å®Œååˆæ‹†åˆ†æˆå¤šä¸ª TCP åŒ…ä¼ è¾“ã€‚ä¸€èˆ¬æ¯ä¸ª Record 16Kï¼ŒåŒ…å« 12 ä¸ª TCP åŒ…ï¼Œè¿™æ ·å¦‚æœ 12 ä¸ª TCP åŒ…ä¸­æœ‰ä»»ä½•ä¸€ä¸ªåŒ…ä¸¢å¤±ï¼Œé‚£ä¹ˆæ•´ä¸ª Record éƒ½æ— æ³•è§£å¯†ã€‚\né‚£ QUIC æ˜¯å¦‚ä½•è§£å†³é˜Ÿå¤´é˜»å¡é—®é¢˜çš„å‘¢ï¼Ÿä¸»è¦æœ‰ä¸¤ç‚¹ã€‚\n QUIC çš„ä¼ è¾“å•å…ƒæ˜¯ Packetï¼ŒåŠ å¯†å•å…ƒä¹Ÿæ˜¯ Packetï¼Œæ•´ä¸ªåŠ å¯†ã€ä¼ è¾“ã€è§£å¯†éƒ½åŸºäº Packetï¼Œè¿™æ ·å°±èƒ½é¿å… TLS çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ï¼› QUIC åŸºäº UDPï¼ŒUDP çš„æ•°æ®åŒ…åœ¨æ¥æ”¶ç«¯æ²¡æœ‰å¤„ç†é¡ºåºï¼Œå³ä½¿ä¸­é—´ä¸¢å¤±ä¸€ä¸ªåŒ…ï¼Œä¹Ÿä¸ä¼šé˜»å¡æ•´æ¡è¿æ¥ï¼Œå…¶ä»–çš„èµ„æºä¼šè¢«æ­£å¸¸å¤„ç†ã€‚  QUICçš„æ‹¥å¡æ§åˆ¶ æ‹¥å¡æ§åˆ¶çš„ç›®çš„æ˜¯é¿å…è¿‡å¤šçš„æ•°æ®ä¸€ä¸‹å­æ¶Œå…¥ç½‘ç»œï¼Œå¯¼è‡´ç½‘ç»œè¶…å‡ºæœ€å¤§è´Ÿè·ã€‚QUIC çš„æ‹¥å¡æ§åˆ¶ä¸ TCP ç±»ä¼¼ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šåšäº†æ”¹è¿›ã€‚\nQUIC é‡æ–°å®ç°äº† TCP åè®®çš„ Cubic ç®—æ³•è¿›è¡Œæ‹¥å¡æ§åˆ¶ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šåšäº†ä¸å°‘æ”¹è¿›ã€‚\nçƒ­æ‹”æ’\nTCP ä¸­å¦‚æœè¦ä¿®æ”¹æ‹¥å¡æ§åˆ¶ç­–ç•¥ï¼Œéœ€è¦åœ¨ç³»ç»Ÿå±‚é¢è¿›è¡Œæ“ä½œã€‚QUIC ä¿®æ”¹æ‹¥å¡æ§åˆ¶ç­–ç•¥åªéœ€è¦åœ¨åº”ç”¨å±‚æ“ä½œï¼Œå¹¶ä¸” QUIC ä¼šæ ¹æ®ä¸åŒçš„ç½‘ç»œç¯å¢ƒã€ç”¨æˆ·æ¥åŠ¨æ€é€‰æ‹©æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚\nQUICå‰å‘çº é”™FEC QUIC ä½¿ç”¨å‰å‘çº é”™(FECï¼ŒForward Error Correction)æŠ€æœ¯å¢åŠ åè®®çš„å®¹é”™æ€§ã€‚ä¸€æ®µæ•°æ®è¢«åˆ‡åˆ†ä¸º 10 ä¸ªåŒ…åï¼Œä¾æ¬¡å¯¹æ¯ä¸ªåŒ…è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œè¿ç®—ç»“æœä¼šä½œä¸º FEC åŒ…ä¸æ•°æ®åŒ…ä¸€èµ·è¢«ä¼ è¾“ï¼Œå¦‚æœä¸å¹¸åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªæ•°æ®åŒ…ä¸¢å¤±ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ ¹æ®å‰©ä½™ 9 ä¸ªåŒ…ä»¥åŠ FEC åŒ…æ¨ç®—å‡ºä¸¢å¤±çš„é‚£ä¸ªåŒ…çš„æ•°æ®ï¼Œè¿™æ ·å°±å¤§å¤§å¢åŠ äº†åè®®çš„å®¹é”™æ€§ã€‚\nè¿™æ˜¯ç¬¦åˆç°é˜¶æ®µç½‘ç»œæŠ€æœ¯çš„ä¸€ç§æ–¹æ¡ˆï¼Œç°é˜¶æ®µå¸¦å®½å·²ç»ä¸æ˜¯ç½‘ç»œä¼ è¾“çš„ç“¶é¢ˆï¼Œå¾€è¿”æ—¶é—´æ‰æ˜¯ï¼Œæ‰€ä»¥æ–°çš„ç½‘ç»œä¼ è¾“åè®®å¯ä»¥é€‚å½“å¢åŠ æ•°æ®å†—ä½™ï¼Œå‡å°‘é‡ä¼ æ“ä½œã€‚\nQUICé‡ä¼ åºåˆ—å·å•è°ƒé€’å¢ TCP ä¸ºäº†ä¿è¯å¯é æ€§ï¼Œä½¿ç”¨ Sequence Number å’Œ ACK æ¥ç¡®è®¤æ¶ˆæ¯æ˜¯å¦æœ‰åºåˆ°è¾¾ï¼Œä½†è¿™æ ·çš„è®¾è®¡å­˜åœ¨ç¼ºé™·ã€‚\nè¶…æ—¶å‘ç”Ÿåå®¢æˆ·ç«¯å‘èµ·é‡ä¼ ï¼Œåæ¥æ¥æ”¶åˆ°äº† ACK ç¡®è®¤æ¶ˆæ¯ï¼Œä½†å› ä¸ºåŸå§‹è¯·æ±‚å’Œé‡ä¼ è¯·æ±‚æ¥æ”¶åˆ°çš„ ACK æ¶ˆæ¯ä¸€æ ·ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯å°±éƒé—·äº†ï¼Œä¸çŸ¥é“è¿™ä¸ª ACK å¯¹åº”çš„æ˜¯åŸå§‹è¯·æ±‚è¿˜æ˜¯é‡ä¼ è¯·æ±‚ã€‚å¦‚æœå®¢æˆ·ç«¯è®¤ä¸ºæ˜¯åŸå§‹è¯·æ±‚çš„ ACKï¼Œä½†å®é™…ä¸Šæ˜¯å·¦å›¾çš„æƒ…å½¢ï¼Œåˆ™è®¡ç®—çš„é‡‡æ · RTT åå¤§ï¼›å¦‚æœå®¢æˆ·ç«¯è®¤ä¸ºæ˜¯é‡ä¼ è¯·æ±‚çš„ ACKï¼Œä½†å®é™…ä¸Šæ˜¯å³å›¾çš„æƒ…å½¢ï¼Œåˆä¼šå¯¼è‡´é‡‡æ · RTT åå°ã€‚å›¾ä¸­æœ‰å‡ ä¸ªæœ¯è¯­ï¼ŒRTO æ˜¯æŒ‡è¶…æ—¶é‡ä¼ æ—¶é—´ï¼ˆRetransmission TimeOutï¼‰ï¼Œè·Ÿæˆ‘ä»¬ç†Ÿæ‚‰çš„ RTTï¼ˆRound Trip Timeï¼Œå¾€è¿”æ—¶é—´ï¼‰å¾ˆé•¿å¾—å¾ˆåƒã€‚é‡‡æ · RTT ä¼šå½±å“ RTO è®¡ç®—ï¼Œè¶…æ—¶æ—¶é—´çš„å‡†ç¡®æŠŠæ¡å¾ˆé‡è¦ï¼Œé•¿äº†çŸ­äº†éƒ½ä¸åˆé€‚ã€‚\nQUIC è§£å†³äº†ä¸Šé¢çš„æ­§ä¹‰é—®é¢˜ã€‚ä¸ Sequence Number ä¸åŒçš„æ˜¯ï¼ŒPacket Number ä¸¥æ ¼å•è°ƒé€’å¢ï¼Œå¦‚æœ Packet N ä¸¢å¤±äº†ï¼Œé‚£ä¹ˆé‡ä¼ æ—¶ Packet çš„æ ‡è¯†ä¸ä¼šæ˜¯ Nï¼Œè€Œæ˜¯æ¯” N å¤§çš„æ•°å­—ï¼Œæ¯”å¦‚ N + Mï¼Œè¿™æ ·å‘é€æ–¹æ¥æ”¶åˆ°ç¡®è®¤æ¶ˆæ¯æ—¶å°±èƒ½æ–¹ä¾¿åœ°çŸ¥é“ ACK å¯¹åº”çš„æ˜¯åŸå§‹è¯·æ±‚è¿˜æ˜¯é‡ä¼ è¯·æ±‚ã€‚\nACK Delay TCP è®¡ç®— RTT æ—¶æ²¡æœ‰è€ƒè™‘æ¥æ”¶æ–¹æ¥æ”¶åˆ°æ•°æ®åˆ°å‘é€ç¡®è®¤æ¶ˆæ¯ä¹‹é—´çš„å»¶è¿Ÿï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™æ®µå»¶è¿Ÿå³ ACK Delayã€‚QUIC è€ƒè™‘äº†è¿™æ®µå»¶è¿Ÿï¼Œä½¿å¾— RTT çš„è®¡ç®—æ›´åŠ å‡†ç¡®ã€‚\næ›´å¤šçš„ ACK å— ä¸€èˆ¬æ¥è¯´ï¼Œæ¥æ”¶æ–¹æ”¶åˆ°å‘é€æ–¹çš„æ¶ˆæ¯åéƒ½åº”è¯¥å‘é€ä¸€ä¸ª ACK å›å¤ï¼Œè¡¨ç¤ºæ”¶åˆ°äº†æ•°æ®ã€‚ä½†æ¯æ”¶åˆ°ä¸€ä¸ªæ•°æ®å°±è¿”å›ä¸€ä¸ª ACK å›å¤å¤ªéº»çƒ¦ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šç«‹å³å›å¤ï¼Œè€Œæ˜¯æ¥æ”¶åˆ°å¤šä¸ªæ•°æ®åå†å›å¤ï¼ŒTCP SACK æœ€å¤šæä¾› 3 ä¸ª ACK blockã€‚ä½†æœ‰äº›åœºæ™¯ä¸‹ï¼Œæ¯”å¦‚ä¸‹è½½ï¼Œåªéœ€è¦æœåŠ¡å™¨è¿”å›æ•°æ®å°±å¥½ï¼Œä½†æŒ‰ç…§ TCP çš„è®¾è®¡ï¼Œæ¯æ”¶åˆ° 3 ä¸ªæ•°æ®åŒ…å°±è¦â€œç¤¼è²Œæ€§â€åœ°è¿”å›ä¸€ä¸ª ACKã€‚è€Œ QUIC æœ€å¤šå¯ä»¥æå¸¦ 256 ä¸ª ACK blockã€‚åœ¨ä¸¢åŒ…ç‡æ¯”è¾ƒä¸¥é‡çš„ç½‘ç»œä¸‹ï¼Œæ›´å¤šçš„ ACK block å¯ä»¥å‡å°‘é‡ä¼ é‡ï¼Œæå‡ç½‘ç»œæ•ˆç‡ã€‚\nQUICæµé‡æ§åˆ¶ ä¼¼ä¹ä¸€æ ·ã€‚\nå‚è€ƒï¼š\n The Road to QUIC ç§‘æ™®ï¼šQUICåè®®åŸç†åˆ†æ Quicåè®®ä»‹ç»å’Œæµ…æ  å‚è€ƒä¸æ›´å¤šâ•  è®¡ç®—æœºç½‘ç»œé¢è¯•æ€»ç»“      Interview OS é«˜é¢‘çŸ¥è¯†â€”â€”æ“ä½œç³»ç»Ÿé¢è¯•é—®é¢˜æ•´ç†\nå°ç™½å¦‚ä½•å­¦ä¹ æ“ä½œç³»ç»Ÿï¼Ÿ\nè¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹åŒºåˆ«ğŸ’  è¿›ç¨‹ä¸çº¿ç¨‹çš„æ¥ç”±â˜„ è¿›ç¨‹çš„ä½œç”¨ä¸å®šä¹‰ï¼šæ˜¯ä¸ºäº†æé«˜CPUçš„æ‰§è¡Œæ•ˆç‡ï¼Œä¸ºäº†é¿å…å› ç­‰å¾…è€Œé€ æˆCPUç©ºè½¬ä»¥åŠå…¶ä»–è®¡ç®—æœºç¡¬ä»¶èµ„æºçš„æµªè´¹è€Œæå‡ºæ¥çš„ã€‚\nçº¿ç¨‹çš„å¼•å…¥ï¼šä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ªWebæœåŠ¡å™¨è¦è¿›ç¨‹çš„æ–¹å¼å¹¶å‘åœ°å¤„ç†æ¥è‡ªä¸åŒç”¨æˆ·çš„ç½‘é¡µè®¿é—®è¯·æ±‚çš„è¯ï¼Œå¯ä»¥åˆ›å»ºçˆ¶è¿›ç¨‹å’Œå¤šä¸ªå­è¿›ç¨‹çš„æ–¹å¼æ¥è¿›è¡Œå¤„ç†ï¼Œä½†æ˜¯åˆ›å»ºä¸€ä¸ªè¿›ç¨‹è¦èŠ±è´¹è¾ƒå¤§çš„ç³»ç»Ÿå¼€é”€å’Œå ç”¨è¾ƒå¤šçš„èµ„æºã€‚é™¤å¤–ï¼Œè¿™äº›ä¸åŒçš„ç”¨æˆ·å­è¿›ç¨‹åœ¨æ‰§è¡Œçš„æ—¶å€™æ¶‰åŠåˆ°è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ã€‚æ‰€ä»¥ï¼Œä¸ºäº†å‡å°‘è¿›ç¨‹åˆ‡æ¢å’Œåˆ›å»ºçš„å¼€é”€ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡å’ŒèŠ‚çœèµ„æºï¼Œäººä»¬åœ¨æ“ä½œç³»ç»Ÿä¸­å¼•å…¥äº†\u0026quot;çº¿ç¨‹ï¼ˆthreadï¼‰\u0026ldquo;çš„æ¦‚å¿µã€‚\n(è¿›ç¨‹çš„æ¶ˆè€—å¤ªå¤§ï¼Œæ‰€ä»¥å¼•å…¥çº¿ç¨‹)\nè¿›ç¨‹ä¸çº¿ç¨‹çš„æ•°æ®ğŸ—¡ è¿›ç¨‹æ˜¯ç³»ç»Ÿèµ„æºåˆ†é…çš„æœ€å°å•ä½, ç³»ç»Ÿç”±ä¸€ä¸ªä¸ªè¿›ç¨‹(ç¨‹åº)ç»„æˆ ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒåŒ…æ‹¬æ–‡æœ¬åŒºåŸŸï¼ˆtext regionï¼‰ã€æ•°æ®åŒºåŸŸï¼ˆdata regionï¼‰å’Œå †æ ˆï¼ˆstack regionï¼‰ã€‚\n æ–‡æœ¬åŒºåŸŸå­˜å‚¨å¤„ç†å™¨æ‰§è¡Œçš„ä»£ç  æ•°æ®åŒºåŸŸå­˜å‚¨å˜é‡å’Œè¿›ç¨‹æ‰§è¡ŒæœŸé—´ä½¿ç”¨çš„åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼› å †æ ˆåŒºåŸŸå­˜å‚¨ç€æ´»åŠ¨è¿‡ç¨‹è°ƒç”¨çš„æŒ‡ä»¤å’Œæœ¬åœ°å˜é‡ã€‚   ä¸è¿›ç¨‹çš„æ§åˆ¶è¡¨PCBç›¸ä¼¼ï¼Œçº¿ç¨‹ä¹Ÿæœ‰è‡ªå·±çš„æ§åˆ¶è¡¨TCBï¼Œä½†æ˜¯TCBä¸­æ‰€ä¿å­˜çš„çº¿ç¨‹çŠ¶æ€æ¯”PCBè¡¨å°‘å¾—å¤šã€‚\n çº¿ç¨‹å±äºè¿›ç¨‹ï¼Œå¹¶ä¸”å…±äº«è¿›ç¨‹çš„å†…å­˜åœ°å€ç©ºé—´\nçº¿ç¨‹å‡ ä¹ä¸å æœ‰ç³»ç»Ÿèµ„æºé€šä¿¡é—®é¢˜: è¿›ç¨‹ç›¸å½“äºä¸€ä¸ªå®¹å™¨,è€Œçº¿ç¨‹è€Œæ˜¯è¿è¡Œåœ¨å®¹å™¨é‡Œé¢çš„,å› æ­¤å¯¹äºå®¹å™¨å†…çš„ä¸œè¥¿,çº¿ç¨‹æ˜¯å…±åŒäº«æœ‰çš„,å› æ­¤çº¿ç¨‹é—´çš„é€šä¿¡å¯ä»¥ç›´æ¥é€šè¿‡å…¨å±€å˜é‡è¿›è¡Œé€šä¿¡,ä½†æ˜¯ç”±æ­¤å¸¦æ¥çš„ä¾‹å¦‚å¤šä¸ªçº¿ç¨‹è¯»å†™åŒä¸€ä¸ªåœ°å€å˜é‡çš„æ—¶å€™åˆ™å°†å¸¦æ¥ä¸å¯é¢„æœŸçš„åæœ,å› æ­¤è¿™æ—¶å€™å¼•å…¥äº†å„ç§é”çš„ä½œç”¨,ä¾‹å¦‚äº’æ–¥é”ç­‰ã€‚\n åŒæ—¶å¤šçº¿ç¨‹æ˜¯ä¸å®‰å…¨çš„,å½“ä¸€ä¸ªçº¿ç¨‹å´©æºƒäº†,ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹ä¹Ÿå´©æºƒäº†,å³å…¶ä»–çº¿ç¨‹ä¹ŸæŒ‚äº†, ä½†å¤šè¿›ç¨‹è€Œä¸ä¼š,ä¸€ä¸ªè¿›ç¨‹æŒ‚äº†,å¦ä¸€ä¸ªè¿›ç¨‹ä¾ç„¶ç…§æ ·è¿è¡Œã€‚\n ä¸Šä¸‹æ–‡åˆ‡æ¢ğŸ“Š è¿›ç¨‹åˆ‡æ¢åˆ†3æ­¥:\n åˆ‡æ¢é¡µç›®å½•ä»¥ä½¿ç”¨æ–°çš„åœ°å€ç©ºé—´ åˆ‡æ¢å†…æ ¸æ ˆ åˆ‡æ¢ç¡¬ä»¶ä¸Šä¸‹æ–‡  è€Œçº¿ç¨‹åˆ‡æ¢åªéœ€è¦ç¬¬2ã€3æ­¥,å› æ­¤è¿›ç¨‹çš„åˆ‡æ¢ä»£ä»·æ¯”è¾ƒå¤§\n**åç¨‹ï¼Œè‹±æ–‡Coroutinesï¼Œæ˜¯ä¸€ç§æ¯”çº¿ç¨‹æ›´åŠ è½»é‡çº§çš„å­˜åœ¨ã€‚**æ­£å¦‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹ä¸€æ ·ï¼Œä¸€ä¸ªçº¿ç¨‹ä¹Ÿå¯ä»¥æ‹¥æœ‰å¤šä¸ªåç¨‹ã€‚\nåç¨‹æ˜¯å±äºçº¿ç¨‹çš„ã€‚åç¨‹ç¨‹åºæ˜¯åœ¨çº¿ç¨‹é‡Œé¢è·‘çš„ï¼Œå› æ­¤åç¨‹åˆç§°å¾®çº¿ç¨‹å’Œçº¤ç¨‹ç­‰\nåæ²¡æœ‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ¶ˆè€—ã€‚åç¨‹çš„è°ƒåº¦åˆ‡æ¢æ˜¯ç”¨æˆ·(ç¨‹åºå‘˜)æ‰‹åŠ¨åˆ‡æ¢çš„,å› æ­¤æ›´åŠ çµæ´»,å› æ­¤åˆå«ç”¨æˆ·ç©ºé—´çº¿ç¨‹.\nåŸå­æ“ä½œæ€§ã€‚ç”±äºåç¨‹æ˜¯ç”¨æˆ·è°ƒåº¦çš„ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°æ‰§è¡Œä¸€åŠçš„ä»£ç ç‰‡æ®µè¢«å¼ºåˆ¶ä¸­æ–­äº†ï¼Œå› æ­¤æ— éœ€åŸå­æ“ä½œé”ã€‚\n åç¨‹ä¸æ˜¯è¢«æ“ä½œç³»ç»Ÿå†…æ ¸æ‰€ç®¡ç†ï¼Œè€Œå®Œå…¨æ˜¯ç”±ç¨‹åºæ‰€æ§åˆ¶ï¼ˆä¹Ÿå°±æ˜¯åœ¨ç”¨æˆ·æ€æ‰§è¡Œï¼‰ã€‚åç¨‹çš„æš‚åœå®Œå…¨ç”±ç¨‹åºæ§åˆ¶ï¼Œçº¿ç¨‹çš„é˜»å¡çŠ¶æ€æ˜¯ç”±æ“ä½œç³»ç»Ÿå†…æ ¸æ¥è¿›è¡Œåˆ‡æ¢ã€‚\nå¥½å¤„ï¼š\nâ€‹\tæ€§èƒ½å¾—åˆ°äº†å¾ˆå¤§çš„æå‡ï¼Œä¸ä¼šåƒçº¿ç¨‹åˆ‡æ¢é‚£æ ·æ¶ˆè€—èµ„æºã€‚\n å¦‚æœè¯´æ“ä½œç³»ç»Ÿå¼•å…¥è¿›ç¨‹çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜ç¨‹åºå¹¶å‘æ‰§è¡Œï¼Œä»¥æé«˜èµ„æºåˆ©ç”¨ç‡å’Œç³»ç»Ÿååé‡ã€‚é‚£ä¹ˆæ“ä½œç³»ç»Ÿä¸­å¼•å…¥çº¿ç¨‹çš„ç›®çš„ï¼Œåˆ™æ˜¯ä¸ºäº†å‡å°‘è¿›ç¨‹å¹¶å‘æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€ä»˜å‡ºçš„æ—¶ç©ºå¼€é”€ï¼Œä½¿æ“ä½œç³»ç»Ÿèƒ½å¾ˆå¥½çš„å¹¶å‘æ‰§è¡Œã€‚\nã€€è¿›ç¨‹processå®šä¹‰äº†ä¸€ä¸ªæ‰§è¡Œç¯å¢ƒï¼ŒåŒ…æ‹¬å®ƒè‡ªå·±ç§æœ‰çš„åœ°å€ç©ºé—´ã€ä¸€ä¸ªå¥æŸ„è¡¨ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨ç¯å¢ƒï¼›çº¿ç¨‹åˆ™æ˜¯ä¸€ä¸ªæ§åˆ¶æµï¼Œæœ‰ä»–è‡ªå·±çš„è°ƒç”¨æ ˆcall stackï¼Œè®°å½•äº†å®ƒçš„æ‰§è¡Œå†å²ã€‚\nã€€çº¿ç¨‹ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š1ï¼‰çº¿ç¨‹çš„å†…æ ¸å¯¹è±¡ï¼Œæ“ä½œç³»ç»Ÿç”¨å®ƒæ¥å¯¹çº¿ç¨‹å®æ–½ç®¡ç†ã€‚å†…æ ¸å¯¹è±¡ä¹Ÿæ˜¯ç³»ç»Ÿç”¨æ¥å­˜æ”¾çº¿ç¨‹ç»Ÿè®¡ä¿¡æ¯çš„åœ°æ–¹ã€‚2ï¼‰çº¿ç¨‹å †æ ˆï¼Œå®ƒç”¨äºç»´æŠ¤çº¿ç¨‹åœ¨æ‰§è¡Œä»£ç æ—¶éœ€è¦çš„æ‰€æœ‰å‚æ•°å’Œå±€éƒ¨å˜é‡ã€‚å½“åˆ›å»ºçº¿ç¨‹æ—¶ï¼Œç³»ç»Ÿåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å†…æ ¸å¯¹è±¡ã€‚è¯¥çº¿ç¨‹å†…æ ¸å¯¹è±¡ä¸æ˜¯çº¿ç¨‹æœ¬èº«ï¼Œè€Œæ˜¯æ“ä½œç³»ç»Ÿç”¨æ¥ç®¡ç†çº¿ç¨‹çš„è¾ƒå°çš„æ•°æ®ç»“æ„ã€‚å¯ä»¥å°†çº¿ç¨‹å†…æ ¸å¯¹è±¡è§†ä¸ºç”±å…³äºçº¿ç¨‹çš„ç»Ÿè®¡ä¿¡æ¯ç»„æˆçš„ä¸€ä¸ªå°å‹æ•°æ®ç»“æ„ã€‚\nå‚è€ƒé“¾æ¥ï¼š\n çº¿ç¨‹ï¼Œè¿›ç¨‹ï¼Œåç¨‹è¯¦ç»†è§£é‡Š è¿›ç¨‹ã€çº¿ç¨‹å’Œåç¨‹çš„æ¦‚å¿µ  è¿›ç¨‹çš„å‡ ç§çŠ¶æ€   å°±ç»ª(Ready)çŠ¶æ€\nå½“è¿›ç¨‹å·²åˆ†é…åˆ°é™¤CPUä»¥å¤–çš„æ‰€æœ‰å¿…è¦èµ„æºåï¼Œåªè¦å†è·å¾—CPUï¼Œä¾¿å¯ç«‹å³æ‰§è¡Œï¼Œè¿›ç¨‹è¿™æ—¶çš„çŠ¶æ€ç§°ä¸ºå°±ç»ªçŠ¶æ€ã€‚åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­å¤„äºå°±ç»ªçŠ¶æ€çš„è¿›ç¨‹å¯èƒ½æœ‰å¤šä¸ªï¼Œé€šå¸¸å°†å®ƒä»¬æ’æˆä¸€ä¸ªé˜Ÿåˆ—ï¼Œç§°ä¸ºå°±ç»ªé˜Ÿåˆ—ã€‚\n  æ‰§è¡ŒçŠ¶æ€\nè¿›ç¨‹å·²è·å¾—CPUï¼Œå…¶ç¨‹åºæ­£åœ¨æ‰§è¡Œã€‚åœ¨å•å¤„ç†æœºç³»ç»Ÿä¸­ï¼Œåªæœ‰ä¸€ä¸ªè¿›ç¨‹å¤„äºæ‰§è¡ŒçŠ¶æ€ï¼› åœ¨å¤šå¤„ç†æœºç³»ç»Ÿä¸­ï¼Œåˆ™æœ‰å¤šä¸ªè¿›ç¨‹å¤„äºæ‰§è¡ŒçŠ¶æ€ã€‚\n  é˜»å¡çŠ¶æ€\næ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ç”±äºå‘ç”ŸæŸäº‹ä»¶è€Œæš‚æ—¶æ— æ³•ç»§ç»­æ‰§è¡Œæ—¶ï¼Œä¾¿æ”¾å¼ƒå¤„ç†æœºè€Œå¤„äºæš‚åœçŠ¶æ€ï¼Œäº¦å³è¿›ç¨‹çš„æ‰§è¡Œå—åˆ°é˜»å¡ï¼ŒæŠŠè¿™ç§æš‚åœçŠ¶æ€ç§°ä¸ºé˜»å¡çŠ¶æ€ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºç­‰å¾…çŠ¶æ€æˆ–å°é”çŠ¶æ€ã€‚è‡´ä½¿è¿›ç¨‹é˜»å¡çš„å…¸å‹äº‹ä»¶æœ‰ï¼šè¯·æ±‚I/Oï¼Œç”³è¯·ç¼“å†²ç©ºé—´ç­‰ã€‚é€šå¸¸å°†è¿™ç§å¤„äºé˜»å¡çŠ¶æ€çš„è¿›ç¨‹ä¹Ÿæ’æˆä¸€ä¸ªé˜Ÿåˆ—ã€‚æœ‰çš„ç³»ç»Ÿåˆ™æ ¹æ®é˜»å¡åŸå› çš„ä¸åŒè€ŒæŠŠå¤„äºé˜»å¡çŠ¶æ€çš„è¿›ç¨‹æ’æˆå¤šä¸ªé˜Ÿåˆ—ã€‚\n  æ­»é”ï¼Œæ´»é”å’Œé¥¥é¥¿ğŸ” æ­»é”ğŸ”ï¼šæ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”ï¼Œè¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰å¾…çš„è¿›ç¨‹ç§°ä¸ºæ­»é”è¿›ç¨‹ã€‚\næ­»é”çš„æ¡ä»¶:\n äº’æ–¥ è¯·æ±‚å’Œä¿æŒ ä¸å‰¥å¤ºåŸåˆ™ ç¯è·¯ç­‰å¾…  å¦‚ä½•é¿å…æ­»é”ï¼ŸğŸƒ\né¢„é˜²\n æ‰“ç ´äº’æ–¥æ¡ä»¶ï¼šæ”¹é€ ç‹¬å æ€§èµ„æºä¸ºè™šæ‹Ÿèµ„æºï¼Œå¤§éƒ¨åˆ†èµ„æºå·²æ— æ³•æ”¹é€ ã€‚ æ‰“ç ´ä¸å¯æŠ¢å æ¡ä»¶ï¼šå½“ä¸€è¿›ç¨‹å æœ‰ä¸€ç‹¬å æ€§èµ„æºååˆç”³è¯·ä¸€ç‹¬å æ€§èµ„æºè€Œæ— æ³•æ»¡è¶³ï¼Œåˆ™é€€å‡ºåŸå æœ‰çš„èµ„æºã€‚ æ‰“ç ´å æœ‰ä¸”ç”³è¯·æ¡ä»¶ï¼šé‡‡ç”¨èµ„æºé¢„å…ˆåˆ†é…ç­–ç•¥ï¼Œå³è¿›ç¨‹è¿è¡Œå‰ç”³è¯·å…¨éƒ¨èµ„æºï¼Œæ»¡è¶³åˆ™è¿è¡Œï¼Œä¸ç„¶å°±ç­‰å¾…ï¼Œè¿™æ ·å°±ä¸ä¼šå æœ‰ä¸”ç”³è¯·ã€‚ æ‰“ç ´å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå®ç°èµ„æºæœ‰åºåˆ†é…ç­–ç•¥ï¼Œå¯¹æ‰€æœ‰è®¾å¤‡å®ç°åˆ†ç±»ç¼–å·ï¼Œæ‰€æœ‰è¿›ç¨‹åªèƒ½é‡‡ç”¨æŒ‰åºå·é€’å¢çš„å½¢å¼ç”³è¯·èµ„æºã€‚ æœ‰åºèµ„æºåˆ†é…æ³• é“¶è¡Œå®¶ç®—æ³•  æ´»é”ğŸš›ï¼š**æ˜¯æŒ‡çº¿ç¨‹1å¯ä»¥ä½¿ç”¨èµ„æºï¼Œä½†å®ƒå¾ˆç¤¼è²Œï¼Œè®©å…¶ä»–çº¿ç¨‹å…ˆä½¿ç”¨èµ„æºï¼Œçº¿ç¨‹2ä¹Ÿå¯ä»¥ä½¿ç”¨èµ„æºï¼Œä½†å®ƒå¾ˆç»…å£«ï¼Œä¹Ÿè®©å…¶ä»–çº¿ç¨‹å…ˆä½¿ç”¨èµ„æºã€‚**è¿™æ ·ä½ è®©æˆ‘ï¼Œæˆ‘è®©ä½ ï¼Œæœ€åä¸¤ä¸ªçº¿ç¨‹éƒ½æ— æ³•ä½¿ç”¨èµ„æºã€‚\né¥¥é¥¿ğŸ‡­ğŸ‡º :æ˜¯æŒ‡å¦‚æœçº¿ç¨‹T1å ç”¨äº†èµ„æºRï¼Œçº¿ç¨‹T2åˆè¯·æ±‚å°é”Rï¼Œäºæ˜¯T2ç­‰å¾…ã€‚T3ä¹Ÿè¯·æ±‚èµ„æºRï¼Œå½“T1é‡Šæ”¾äº†Rä¸Šçš„å°é”åï¼Œç³»ç»Ÿé¦–å…ˆæ‰¹å‡†äº†T3çš„è¯·æ±‚ï¼ŒT2ä»ç„¶ç­‰å¾…ã€‚ç„¶åT4åˆè¯·æ±‚å°é”Rï¼Œå½“T3é‡Šæ”¾äº†Rä¸Šçš„å°é”ä¹‹åï¼Œç³»ç»Ÿåˆæ‰¹å‡†äº†T4çš„è¯·æ±‚\u0026hellip;\u0026hellip;ï¼ŒT2å¯èƒ½æ°¸è¿œç­‰å¾…ã€‚\nå¦‚ä½•æ£€æµ‹æ­»é” ä¸€èˆ¬æ¥è¯´ï¼Œç”±äºæ“ä½œç³»ç»Ÿæœ‰å¹¶å‘ï¼Œå…±äº«ä»¥åŠéšæœºæ€§ç­‰ç‰¹ç‚¹ï¼Œé€šè¿‡é¢„é˜²å’Œé¿å…çš„æ‰‹æ®µè¾¾åˆ°æ’é™¤æ­»é”çš„ç›®çš„æ˜¯å¾ˆå›°éš¾çš„ã€‚è¿™éœ€è¦è¾ƒå¤§çš„ç³»ç»Ÿå¼€é”€ï¼Œè€Œä¸”ä¸èƒ½å……åˆ†åˆ©ç”¨èµ„æºã€‚ä¸ºæ­¤ï¼Œä¸€ç§ç®€ä¾¿çš„æ–¹æ³•æ˜¯ç³»ç»Ÿä¸ºè¿›ç¨‹åˆ†é…èµ„æºæ—¶ï¼Œä¸é‡‡å–ä»»ä½•é™åˆ¶æ€§æªæ–½ï¼Œä½†æ˜¯æä¾›äº†æ£€æµ‹å’Œè§£è„±æ­»é”çš„æ‰‹æ®µï¼šèƒ½å‘ç°æ­»é”å¹¶ä»æ­»é”çŠ¶æ€ä¸­æ¢å¤å‡ºæ¥ã€‚å› æ­¤ï¼Œåœ¨å®é™…çš„æ“ä½œç³»ç»Ÿä¸­å¾€å¾€é‡‡ç”¨æ­»é”çš„æ£€æµ‹ä¸æ¢å¤æ–¹æ³•æ¥æ’é™¤æ­»é”ã€‚å¸¸åˆ©ç”¨èµ„æºåˆ†é…å›¾ã€è¿›ç¨‹ç­‰å¾…å›¾æ¥ååŠ©è¿™ç§æ£€æµ‹ã€‚\næ ¸å¿ƒæ˜¯ï¼šä¸è¯•å›¾é˜»æ­¢æ­»é”ï¼Œè€Œæ˜¯å½“æ£€æµ‹åˆ°æ­»é”å‘ç”Ÿæ—¶ï¼Œé‡‡å–æªæ–½è¿›è¡Œæ¢å¤ã€‚\nå¯ä»¥å¯¹è¿›ç¨‹ - èµ„æºåˆ†é…å›¾è¿›è¡Œæ£€æµ‹(æŒ‰å‘¨æœŸè¿›è¡Œæ£€æµ‹)ï¼š\n å¦‚æœè¿›ç¨‹ - èµ„æºåˆ†é…å›¾ä¸­æ— ç¯è·¯ï¼Œæ­¤æ—¶ç³»ç»Ÿæ²¡æœ‰å‘ç”Ÿæ­»é”ã€‚ å¦‚æœè¿›ç¨‹ - èµ„æºåˆ†é…å›¾ä¸­æœ‰ç¯è·¯ï¼Œåˆ™å¯åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š  æ¯ç§èµ„æºç±»ä¸­ä»…æœ‰ä¸€ä¸ªèµ„æºï¼Œåˆ™ç³»ç»Ÿå‘ç”Ÿäº†æ­»é”ã€‚æ­¤æ—¶ï¼Œç¯è·¯æ˜¯ç³»ç»Ÿå‘ç”Ÿæ­»é”çš„å……åˆ†å¿…è¦æ¡ä»¶ï¼Œç¯è·¯ä¸­çš„è¿›ç¨‹å°±æ˜¯æ­»é”è¿›ç¨‹ æ¯ç§èµ„æºç±»ä¸­æœ‰å¤šä¸ªèµ„æºï¼Œåˆ™ç¯è·¯çš„å­˜åœ¨åªæ˜¯äº§ç”Ÿæ­»é”çš„å¿…è¦ä¸å……åˆ†æ¡ä»¶ï¼Œç³»ç»Ÿæœªå¿…ä¼šå‘ç”Ÿæ­»é”ã€‚    æ­»é”æ¢å¤   èµ„æºå‰¥å¤ºæ³•\nå‰¥å¤ºé™·äºæ­»é”çš„è¿›ç¨‹æ‰€å ç”¨çš„èµ„æºï¼Œä½†å¹¶ä¸æ’¤é”€æ­¤è¿›ç¨‹ï¼Œç›´è‡³æ­»é”è§£é™¤ã€‚\n  è¿›ç¨‹å›é€€æ³•\næ ¹æ®ç³»ç»Ÿä¿å­˜çš„æ£€æŸ¥ç‚¹è®©æ‰€æœ‰çš„è¿›ç¨‹å›é€€ï¼Œç›´åˆ°è¶³ä»¥è§£é™¤æ­»é”ï¼Œè¿™ç§æªæ–½è¦æ±‚ç³»ç»Ÿå»ºç«‹ä¿å­˜æ£€æŸ¥ç‚¹ã€å›é€€åŠé‡å¯æœºåˆ¶ã€‚\n  è¿›ç¨‹æ’¤é”€æ³•\n   æ’¤é”€é™·å…¥æ­»é”çš„æ‰€æœ‰è¿›ç¨‹ï¼Œè§£é™¤æ­»é”ï¼Œç»§ç»­è¿è¡Œã€‚ é€ä¸ªæ’¤é”€é™·å…¥æ­»é”çš„è¿›ç¨‹ï¼Œå›æ”¶å…¶èµ„æºå¹¶é‡æ–°åˆ†é…ï¼Œç›´è‡³æ­»é”è§£é™¤ã€‚    å¯é€‰æ‹©ç¬¦åˆä¸‹é¢æ¡ä»¶ä¹‹ä¸€çš„å…ˆæ’¤é”€ï¼š 1.CPUæ¶ˆè€—æ—¶é—´æœ€å°‘è€… 2.äº§ç”Ÿçš„è¾“å‡ºé‡æœ€å°è€…\n3.é¢„è®¡å‰©ä½™æ‰§è¡Œæ—¶é—´æœ€é•¿è€… 4.åˆ†å¾—çš„èµ„æºæ•°é‡æœ€å°‘è€…åä¼˜å…ˆçº§æœ€ä½è€…\n ç³»ç»Ÿé‡å¯æ³•\nç»“æŸæ‰€æœ‰è¿›ç¨‹çš„æ‰§è¡Œå¹¶é‡æ–°å¯åŠ¨æ“ä½œç³»ç»Ÿã€‚è¿™ç§æ–¹æ³•å¾ˆç®€å•ï¼Œä½†å…ˆå‰çš„å·¥ä½œå…¨éƒ¨ä½œåºŸï¼ŒæŸå¤±å¾ˆå¤§ã€‚  å‚è€ƒï¼š\n æ“ä½œç³»ç»Ÿä¸­çš„æ­»é”æ£€æµ‹æ–¹æ³• æ­»é”çš„äº§ç”Ÿã€é˜²æ­¢ã€é¿å…ã€æ£€æµ‹å’Œè§£é™¤  ä»€ä¹ˆæ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼Ÿ å®ˆæŠ¤è¿›ç¨‹å°±æ˜¯åœ¨åå°è¿è¡Œ,ä¸ä¸ä»»ä½•ç»ˆç«¯å…³è”çš„è¿›ç¨‹,é€šå¸¸æƒ…å†µä¸‹å®ˆæŠ¤è¿›ç¨‹åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å°±åœ¨è¿è¡Œ,å®ƒä»¬ä»¥rootç”¨æˆ·æˆ–è€…å…¶ä»–ç‰¹æ®Šç”¨æˆ·(apacheå’Œpostfix)è¿è¡Œ,å¹¶èƒ½å¤„ç†ä¸€äº›ç³»ç»Ÿçº§çš„ä»»åŠ¡.ä¹ æƒ¯ä¸Šå®ˆæŠ¤è¿›ç¨‹çš„åå­—é€šå¸¸ä»¥dç»“å°¾(sshd),ä½†è¿™äº›ä¸æ˜¯å¿…é¡»çš„.\nå‚è€ƒï¼š\n ä»€ä¹ˆæ˜¯å®ˆæŠ¤è¿›ç¨‹  Linuxè¿è¡Œå†…å­˜åˆ†åŒºğŸš© è™šæ‹Ÿå†…å­˜æ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µ ï¼Œå®ƒä¸º æ¯ä¸ªè¿›ç¨‹æä¾›äº†ä¸€ä¸ªå‡è±¡ï¼Œ å³æ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç‹¬å åœ°ä½¿ç”¨ä¸»å­˜ ã€‚\nè™šæ‹Ÿåœ°å€ç©ºé—´(å’ŒCç¨‹åºç©ºé—´ä¸€è‡´)å¦‚ä¸‹ï¼š\nåœ¨ Linuxä¸­ ï¼Œåœ°å€ç©ºé—´æœ€ä¸Šé¢çš„åŒºåŸŸæ˜¯ä¿ç•™ç»™æ“ä½œç³»ç»Ÿä¸­çš„ä»£ç å’Œæ•°æ®çš„ ï¼Œè¿™å¯¹æ‰€æœ‰è¿›ç¨‹æ¥è¯´éƒ½æ˜¯ä¸€æ · ã€‚åœ°å€ç©ºé—´çš„åº•éƒ¨åŒºåŸŸå­˜æ”¾ç”¨æˆ·è¿›ç¨‹å®šä¹‰çš„ä»£ç å’Œæ•°æ® ã€‚\nè¿›ç¨‹é—´é€šä¿¡ğŸ¦…   ç®¡é“(PIPE) / FIFO(æœ‰åç®¡é“)\nç®¡é“å¯ç”¨äºå…·æœ‰äº²ç¼˜å…³ç³»è¿›ç¨‹é—´çš„é€šä¿¡ï¼Œæœ‰åç®¡é“å…‹æœäº†ç®¡é“æ²¡æœ‰åå­—çš„é™åˆ¶ï¼Œå› æ­¤ï¼Œé™¤å…·æœ‰ç®¡é“æ‰€å…·æœ‰çš„åŠŸèƒ½å¤–ï¼Œå®ƒè¿˜å…è®¸æ— äº²ç¼˜å…³ç³»è¿›ç¨‹é—´çš„é€šä¿¡ï¼›æ— åç®¡é“ä½¿ç”¨forkå®ç°ã€‚\n  æ¶ˆæ¯é˜Ÿåˆ—\næ¶ˆæ¯é˜Ÿåˆ—æ˜¯æ¶ˆæ¯çš„é“¾æ¥è¡¨ï¼ŒåŒ…æ‹¬Posixæ¶ˆæ¯é˜Ÿåˆ—system Væ¶ˆæ¯é˜Ÿåˆ—ã€‚æœ‰è¶³å¤Ÿæƒé™çš„è¿›ç¨‹å¯ä»¥å‘é˜Ÿåˆ—ä¸­æ·»åŠ æ¶ˆæ¯ï¼Œè¢«èµ‹äºˆè¯»æƒé™çš„è¿›ç¨‹åˆ™å¯ä»¥è¯»èµ°é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ã€‚æ¶ˆæ¯é˜Ÿåˆ—å…‹æœäº†ä¿¡å·æ‰¿è½½ä¿¡æ¯é‡å°‘ï¼Œç®¡é“åªèƒ½æ‰¿è½½æ— æ ¼å¼å­—èŠ‚æµä»¥åŠç¼“å†²åŒºå¤§å°å—é™ç­‰ç¼ºç‚¹ã€‚\n  ä¿¡å·é‡\nè¦ä½œä¸ºè¿›ç¨‹é—´ä»¥åŠåŒä¸€è¿›ç¨‹ä¸åŒçº¿ç¨‹ä¹‹é—´çš„åŒæ­¥æ‰‹æ®µã€‚\n  å…±äº«å†…å­˜\nä½¿å¾—å¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œæ˜¯æœ€å¿«çš„å¯ç”¨IPCå½¢å¼ã€‚æ˜¯é’ˆå¯¹å…¶ä»–é€šä¿¡æœºåˆ¶è¿è¡Œæ•ˆç‡è¾ƒä½è€Œè®¾è®¡çš„ã€‚å¾€å¾€ä¸å…¶å®ƒé€šä¿¡æœºåˆ¶ï¼Œå¦‚ä¿¡å·é‡ç»“åˆä½¿ç”¨ï¼Œæ¥è¾¾åˆ°è¿›ç¨‹é—´çš„åŒæ­¥åŠäº’æ–¥ã€‚\n ä¼˜ç‚¹ï¼šæ— é¡»å¤åˆ¶ï¼Œå¿«æ·ï¼Œä¿¡æ¯é‡å¤§ ç¼ºç‚¹ï¼š  é€šä¿¡æ˜¯é€šè¿‡å°†å…±äº«ç©ºé—´ç¼“å†²åŒºç›´æ¥é™„åŠ åˆ°è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­æ¥å®ç°çš„ï¼Œå› æ­¤è¿›ç¨‹é—´çš„è¯»å†™æ“ä½œçš„åŒæ­¥é—®é¢˜ åˆ©ç”¨å†…å­˜ç¼“å†²åŒºç›´æ¥äº¤æ¢ä¿¡æ¯ï¼Œå†…å­˜çš„å®ä½“å­˜åœ¨äºè®¡ç®—æœºä¸­ï¼Œåªèƒ½åŒä¸€ä¸ªè®¡ç®—æœºç³»ç»Ÿä¸­çš„è¯¸å¤šè¿›ç¨‹å…±äº«ï¼Œä¸æ–¹ä¾¿ç½‘ç»œé€šä¿¡      åŸŸå¥—æ¥å­—(Domain Socket)\næ›´ä¸ºä¸€èˆ¬çš„è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼Œå¯ç”¨äºä¸åŒæœºå™¨ä¹‹é—´çš„è¿›ç¨‹é—´é€šä¿¡ã€‚èµ·åˆæ˜¯ç”±Unixç³»ç»Ÿçš„BSDåˆ†æ”¯å¼€å‘å‡ºæ¥çš„ï¼Œä½†ç°åœ¨ä¸€èˆ¬å¯ä»¥ç§»æ¤åˆ°å…¶å®ƒç±»Unixç³»ç»Ÿä¸Šï¼šLinuxå’ŒSystem Vçš„å˜ç§éƒ½æ”¯æŒå¥—æ¥å­—ã€‚\n  ä¿¡å·(Signal)\nä¿¡å·æ˜¯æ¯”è¾ƒå¤æ‚çš„é€šä¿¡æ–¹å¼ï¼Œç”¨äºé€šçŸ¥æ¥å—è¿›ç¨‹æœ‰æŸç§äº‹ä»¶å‘ç”Ÿï¼Œé™¤äº†ç”¨äºè¿›ç¨‹é—´é€šä¿¡å¤–ï¼Œè¿›ç¨‹è¿˜å¯ä»¥å‘é€ä¿¡å·ç»™è¿›ç¨‹æœ¬èº«ï¼›Linuxé™¤äº†æ”¯æŒUnixæ—©æœŸä¿¡å·è¯­ä¹‰å‡½æ•°sigalå¤–ï¼Œè¿˜æ”¯æŒè¯­ä¹‰ç¬¦åˆPosix.1æ ‡å‡†çš„ä¿¡å·å‡½æ•°sigactionï¼ˆå®é™…ä¸Šï¼Œè¯¥å‡½æ•°æ˜¯åŸºäºBSDçš„ï¼ŒBSDä¸ºäº†å®ç°å¯é ä¿¡å·æœºåˆ¶ï¼Œåˆèƒ½å¤Ÿç»Ÿä¸€å¯¹å¤–æ¥å£ï¼Œç”¨sigactionå‡½æ•°é‡æ–°å®ç°äº†signalå‡½æ•°ï¼‰ï¼›\n ä¸€èˆ¬æ¥è¯´ï¼Œsignalæ˜¯å¯¹â€œä¸­æ–­\u0026quot;è¿™ç§æ¦‚å¿µåœ¨è½¯ä»¶å±‚é¢ä¸Šçš„æ¨¡æ‹Ÿï¼Œä¹Ÿç§°â€è½¯ä¸­æ–­â€œï¼Œå…¶ä¸­ä¿¡å·çš„å‘é€è€…ç›¸å½“äºä¸­æ–­æºï¼Œè€Œæ¥æ”¶è€…ç›¸å½“äºå¤„ç†å™¨ï¼Œæ‰€ä»¥å¿…é¡»æ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚\n   å¦‚æœè¯´â€œå‘½åç®¡é“â€æŠŠâ€œç®¡é“â€è¿™ç§åŸæ¥åªé€‚ç”¨è¿‘äº²çš„æ‰‹æ®µæ¨å¹¿åˆ°äº†åŒä¸€å°è®¡ç®—æœºä¸­çš„ä»»æ„è¿›ç¨‹ä¹‹é—´ï¼Œåˆ™Socketåˆè¿›ä¸€æ­¥å°†å…¶æ¨å¹¿è‡³è®¡ç®—æœºç½‘ç»œä¸­çš„ä»»æ„è¿›ç¨‹ä¹‹é—´ã€‚ä»è¿™ä¸ªæ„ä¹‰ä¸Šè®²ï¼ŒSocketæˆäº†æœ€ä¸€èˆ¬ã€æœ€æ™®éé€‚ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ‰‹æ®µå’Œæœºåˆ¶ã€‚äº‹å®ä¸Šï¼Œç°åœ¨æœ‰äº›Unixç³»ç»Ÿä¸­çš„ç®¡é“æœºåˆ¶ä¹Ÿåè¿‡æ¥æ”¹æˆé€šè¿‡Socketæ¥å®ç°ã€‚\nä¸ºä»€ä¹ˆå…±äº«å†…å­˜æ›´å¿«ï¼Ÿ æ‹·è´4æ¬¡(ä¸€èˆ¬è¿›ç¨‹é€šä¿¡æ–¹å¼)\n1ï¼Œç”±ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºä¸­å°†æ•°æ®æ‹·è´åˆ°å†…æ ¸ç©ºé—´ç¼“å†²åŒºä¸­\n2ï¼Œå†…æ ¸ç©ºé—´ç¼“å†²åŒºå°†æ•°æ®æ‹·è´åˆ°å†…å­˜ä¸­\n3ï¼Œå†…å­˜å°†æ•°æ®æ‹·è´åˆ°åˆ°å†…æ ¸ç¼“å†²åŒº\n4ï¼Œå†…æ ¸ç©ºé—´ç¼“å†²åŒºåˆ°ç”¨æˆ·ç©ºé—´ç¼“å†²åŒº.\næ‹·è´2æ¬¡(å…±äº«å†…å­˜é€šä¿¡)\n1ï¼Œç”¨æˆ·ç©ºé—´åˆ°å†…å­˜ã€‚\n2ï¼Œå†…å­˜åˆ°ç”¨æˆ·ç©ºé—´ã€‚\nçº¿ç¨‹é—´é€šä¿¡ğŸ‘‚  é”æœºåˆ¶ï¼šåŒ…æ‹¬äº’æ–¥é”/é‡ï¼ˆmutexï¼‰ã€è¯»å†™é”ï¼ˆreader-writer lockï¼‰ã€è‡ªæ—‹é”ï¼ˆspin lockï¼‰ã€æ¡ä»¶å˜é‡ï¼ˆconditionï¼‰  äº’æ–¥é”/é‡ï¼ˆmutexï¼‰ï¼šæä¾›äº†ä»¥æ’ä»–æ–¹å¼é˜²æ­¢æ•°æ®ç»“æ„è¢«å¹¶å‘ä¿®æ”¹çš„æ–¹æ³•ã€‚ è¯»å†™é”ï¼ˆreader-writer lockï¼‰ï¼šå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å…±äº«æ•°æ®ï¼Œè€Œå¯¹å†™æ“ä½œæ˜¯äº’æ–¥çš„ã€‚ è‡ªæ—‹é”ï¼ˆspin lockï¼‰ä¸äº’æ–¥é”ç±»ä¼¼ï¼Œéƒ½æ˜¯ä¸ºäº†ä¿æŠ¤å…±äº«èµ„æºã€‚äº’æ–¥é”æ˜¯å½“èµ„æºè¢«å ç”¨ï¼Œç”³è¯·è€…è¿›å…¥ç¡çœ çŠ¶æ€ï¼›è€Œè‡ªæ—‹é”åˆ™å¾ªç¯æ£€æµ‹ä¿æŒè€…æ˜¯å¦å·²ç»é‡Šæ”¾é”ã€‚ æ¡ä»¶å˜é‡ï¼ˆconditionï¼‰ï¼šå¯ä»¥ä»¥åŸå­çš„æ–¹å¼é˜»å¡è¿›ç¨‹ï¼Œç›´åˆ°æŸä¸ªç‰¹å®šæ¡ä»¶ä¸ºçœŸä¸ºæ­¢ã€‚å¯¹æ¡ä»¶çš„æµ‹è¯•æ˜¯åœ¨äº’æ–¥é”çš„ä¿æŠ¤ä¸‹è¿›è¡Œçš„ã€‚æ¡ä»¶å˜é‡å§‹ç»ˆä¸äº’æ–¥é”ä¸€èµ·ä½¿ç”¨ã€‚   ä¿¡å·é‡æœºåˆ¶(Semaphore)  æ— åçº¿ç¨‹ä¿¡å·é‡ å‘½åçº¿ç¨‹ä¿¡å·é‡   ä¿¡å·æœºåˆ¶(Signal)ï¼šç±»ä¼¼è¿›ç¨‹é—´çš„ä¿¡å·å¤„ç† å±éšœï¼ˆbarrierï¼‰ï¼šå±éšœå…è®¸æ¯ä¸ªçº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°æ‰€æœ‰çš„åˆä½œçº¿ç¨‹éƒ½è¾¾åˆ°æŸä¸€ç‚¹ï¼Œç„¶åä»è¯¥ç‚¹ç»§ç»­æ‰§è¡Œã€‚  çº¿ç¨‹é—´çš„é€šä¿¡ç›®çš„ä¸»è¦æ˜¯ç”¨äºçº¿ç¨‹åŒæ­¥ï¼Œæ‰€ä»¥çº¿ç¨‹æ²¡æœ‰åƒè¿›ç¨‹é€šä¿¡ä¸­çš„ç”¨äºæ•°æ®äº¤æ¢çš„é€šä¿¡æœºåˆ¶\nä»€ä¹ˆæ˜¯å­¤å„¿è¿›ç¨‹ã€åƒµå°¸è¿›ç¨‹ï¼Ÿ åœ¨unix/linuxä¸­ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œå­è¿›ç¨‹æ˜¯é€šè¿‡çˆ¶è¿›ç¨‹åˆ›å»ºçš„ï¼Œå­è¿›ç¨‹åœ¨åˆ›å»ºæ–°çš„è¿›ç¨‹ã€‚å­è¿›ç¨‹çš„ç»“æŸå’Œçˆ¶è¿›ç¨‹çš„è¿è¡Œæ˜¯ä¸€ä¸ªå¼‚æ­¥è¿‡ç¨‹,å³çˆ¶è¿›ç¨‹æ°¸è¿œæ— æ³•é¢„æµ‹å­è¿›ç¨‹ åˆ°åº•ä»€ä¹ˆæ—¶å€™ç»“æŸã€‚ å½“ä¸€ä¸ª è¿›ç¨‹å®Œæˆå®ƒçš„å·¥ä½œç»ˆæ­¢ä¹‹åï¼Œå®ƒçš„çˆ¶è¿›ç¨‹éœ€è¦è°ƒç”¨wait()æˆ–è€…waitpid()ç³»ç»Ÿè°ƒç”¨å–å¾—å­è¿›ç¨‹çš„ç»ˆæ­¢çŠ¶æ€ã€‚\nå­¤å„¿è¿›ç¨‹:\nä¸€ä¸ªçˆ¶è¿›ç¨‹é€€å‡ºï¼Œè€Œå®ƒçš„ä¸€ä¸ªæˆ–å¤šä¸ªå­è¿›ç¨‹è¿˜åœ¨è¿è¡Œï¼Œé‚£ä¹ˆé‚£äº›å­è¿›ç¨‹å°†æˆä¸ºå­¤å„¿è¿›ç¨‹ã€‚å­¤å„¿è¿›ç¨‹å°†è¢«initè¿›ç¨‹(è¿›ç¨‹å·ä¸º1)æ‰€æ”¶å…»ï¼Œå¹¶ç”±initè¿›ç¨‹å¯¹å®ƒä»¬å®ŒæˆçŠ¶æ€æ”¶é›†å·¥ä½œã€‚\nåƒµå°¸è¿›ç¨‹ï¼š\nä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨forkåˆ›å»ºå­è¿›ç¨‹ï¼Œå¦‚æœå­è¿›ç¨‹é€€å‡ºï¼Œè€Œçˆ¶è¿›ç¨‹å¹¶æ²¡æœ‰è°ƒç”¨waitæˆ–waitpidè·å–å­è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ï¼Œé‚£ä¹ˆå­è¿›ç¨‹çš„è¿›ç¨‹æè¿°ç¬¦ä»ç„¶ä¿å­˜åœ¨ç³»ç»Ÿä¸­ã€‚è¿™ç§è¿›ç¨‹ç§°ä¹‹ä¸ºåƒµæ­»è¿›ç¨‹ã€‚\nå¤„ç†åƒµå°¸è¿›ç¨‹ï¼š\n  å¹²æ‰çˆ¶è¿›ç¨‹ï»¿\nå¹²æ‰çˆ¶è¿›ç¨‹åï¼Œè®©å‰©ä¸‹çš„å­è¿›ç¨‹æˆä¸ºå­¤å„¿è¿›ç¨‹ï¼Œæˆä¸ºå­¤å„¿è¿›ç¨‹åå°±å’Œæˆ‘ä»¬ä¸Šé¢è¯´çš„ä¸€æ ·äº†ï¼Œç”±initè¿›ç¨‹æ¥é¢†å…»è¿™äº›è¿›ç¨‹ï¼Œå¹¶ä¸”æ¥å¤„ç†è¿™äº›è¿›ç¨‹çš„èµ„æºé‡Šæ”¾ç­‰å·¥ä½œã€‚\n  çˆ¶è¿›ç¨‹è°ƒç”¨waitæˆ–waitpid\nç­‰å‡½æ•°ç­‰å¾…å­è¿›ç¨‹ç»“æŸï¼Œè¿™ä¼šå¯¼è‡´çˆ¶è¿›ç¨‹æŒ‚èµ·ã€‚\næ‰§è¡Œwaitï¼ˆï¼‰æˆ– waitpidï¼ˆï¼‰ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ™å­è¿›ç¨‹åœ¨ç»ˆæ­¢åä¼šç«‹å³æŠŠå®ƒåœ¨è¿›ç¨‹è¡¨ä¸­çš„æ•°æ®è¿”å›ç»™çˆ¶è¿›ç¨‹ï¼Œæ­¤æ—¶ç³»ç»Ÿä¼šç«‹å³åˆ é™¤è¯¥è¿›å…¥ç‚¹ã€‚åœ¨è¿™ç§æƒ…å½¢ä¸‹å°±ä¸ä¼šäº§ç”Ÿdefunctè¿›ç¨‹ã€‚\n  forkä¸¤æ¬¡\nç¬¬ä¸€æ¬¡ fork : çˆ¶è¿›ç¨‹forkä¸€ä¸ªå­è¿›ç¨‹\nç¬¬äºŒæ¬¡ fork : å­è¿›ç¨‹forkä¸€ä¸ªå­™è¿›ç¨‹åé€€å‡º\né‚£ä¹ˆå­™è¿›ç¨‹è¢«initæ¥ç®¡ï¼Œå½“å­™è¿›ç¨‹ç»“æŸåï¼Œinitä¼šå›æ”¶ã€‚\nä½†å­è¿›ç¨‹çš„å›æ”¶è¿˜è¦è‡ªå·±åšã€‚\n  signalå‡½æ•°\nçˆ¶è¿›ç¨‹æ¥å¤„ç†ï¼šç”¨signalå‡½æ•°ä¸ºSIGCHLDå®‰è£…handlerï¼Œåœ¨å­è¿›ç¨‹ç»“æŸåï¼Œçˆ¶è¿›ç¨‹ä¼šæ”¶åˆ°è¯¥ä¿¡å·ï¼Œå¯ä»¥åœ¨handlerä¸­è°ƒç”¨waitå›æ”¶ã€‚\nå†…æ ¸æ¥å¤„ç†:\nå¦‚æœçˆ¶è¿›ç¨‹ä¸å…³å¿ƒå­è¿›ç¨‹ä»€ä¹ˆæ—¶å€™ç»“æŸï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°é€šçŸ¥å†…æ ¸è‡ªå·±ä¸æ„Ÿå…´è¶£å­è¿›ç¨‹çš„ç»“æŸï¼Œæ­¤æ—¶ï¼Œå­è¿›ç¨‹ç»“æŸåï¼Œå†…æ ¸ä¼šå›æ”¶å¹¶ä¸å†ç»™ä½ çˆ¶è¿›ç¨‹å‘ä¿¡å·ã€‚\n signalï¼ˆSIGCLD, SIG_IGNï¼‰ signalï¼ˆSIGCHLD, SIG_IGNï¼‰    ï»¿\nå‚è€ƒï¼šå­¤å„¿è¿›ç¨‹ä¸åƒµå°¸è¿›ç¨‹æ€»ç»“\nå†…æ ¸æ€å’Œç”¨æˆ·æ€ğŸ’ ä¸ºäº†å®‰å…¨ï¼Œç”¨æˆ·è¿›ç¨‹æ˜¯å—é™çš„ï¼Œå®ƒä¸èƒ½éšæ„è®¿é—®èµ„æºã€è·å–èµ„æºã€‚æ‰€ä»¥ï¼Œç”±å†…æ ¸è¿›ç¨‹è´Ÿè´£ç®¡ç†å’Œåˆ†é…èµ„æºï¼Œå®ƒå…·æœ‰æœ€é«˜æƒé™ï¼Œè€Œç”¨æˆ·è¿›ç¨‹ä½¿ç”¨è¢«åˆ†é…çš„èµ„æºã€‚ç”¨æˆ·æ€çš„ç¨‹åºä¸èƒ½ éšæ„æ“ä½œå†…æ ¸åœ°å€ç©ºé—´ï¼Œå…·æœ‰ä¸€å®šçš„å®‰å…¨ä¿æŠ¤ä½œç”¨ã€‚\nè€Œä¸”ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»èƒ½å¤Ÿåœ¨æœ‰éœ€è¦çš„æ—¶å€™èƒ½ç«‹å³åˆ‡æ¢å›å†…æ ¸è¿›ç¨‹(é€šè¿‡ä¸­æ–­)ï¼Œåªæœ‰è¿™æ ·ï¼Œæ“ä½œç³»ç»Ÿæ‰èƒ½æœ‰å®‰å…¨æ„Ÿã€‚\nç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€çš„3ç§æ–¹å¼   ç³»ç»Ÿè°ƒç”¨\nè¿™æ˜¯ç”¨æˆ·æ€è¿›ç¨‹ä¸»åŠ¨è¦æ±‚åˆ‡æ¢åˆ°å†…æ ¸æ€çš„ä¸€ç§æ–¹å¼ï¼Œç”¨æˆ·æ€è¿›ç¨‹é€šè¿‡ç³»ç»Ÿè°ƒç”¨ç”³è¯·ä½¿ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„æœåŠ¡ç¨‹åºå®Œæˆå·¥ä½œï¼Œæ¯”å¦‚fork()å®é™…ä¸Šå°±æ˜¯æ‰§è¡Œäº†ä¸€ä¸ªåˆ›å»ºæ–°è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ã€‚è€Œç³»ç»Ÿè°ƒç”¨çš„æœºåˆ¶å…¶æ ¸å¿ƒè¿˜æ˜¯ä½¿ç”¨äº†æ“ä½œç³»ç»Ÿä¸ºç”¨æˆ·ç‰¹åˆ«å¼€æ”¾çš„ä¸€ä¸ªä¸­æ–­æ¥å®ç°ï¼Œä¾‹å¦‚Linuxçš„int 80hä¸­æ–­ã€‚\n  ä¸­æ–­\nå½“å¤–å›´è®¾å¤‡å®Œæˆç”¨æˆ·è¯·æ±‚çš„æ“ä½œåï¼Œä¼šå‘CPUå‘å‡ºç›¸åº”çš„ä¸­æ–­ä¿¡å·ï¼Œè¿™æ—¶CPUä¼šæš‚åœæ‰§è¡Œä¸‹ä¸€æ¡å³å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤è½¬è€Œå»æ‰§è¡Œä¸ä¸­æ–­ä¿¡å·å¯¹åº”çš„å¤„ç†ç¨‹åºï¼Œå¦‚æœå…ˆå‰æ‰§è¡Œçš„æŒ‡ä»¤æ˜¯ç”¨æˆ·æ€ä¸‹çš„ç¨‹åºï¼Œé‚£ä¹ˆè¿™ä¸ªè½¬æ¢çš„è¿‡ç¨‹è‡ªç„¶ä¹Ÿå°±å‘ç”Ÿäº†ç”±ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢ã€‚æ¯”å¦‚ç¡¬ç›˜è¯»å†™æ“ä½œå®Œæˆï¼Œç³»ç»Ÿä¼šåˆ‡æ¢åˆ°ç¡¬ç›˜è¯»å†™çš„ä¸­æ–­å¤„ç†ç¨‹åºä¸­æ‰§è¡Œåç»­æ“ä½œç­‰ã€‚\n  å¼‚å¸¸\nå½“CPUåœ¨æ‰§è¡Œè¿è¡Œåœ¨ç”¨æˆ·æ€ä¸‹çš„ç¨‹åºæ—¶ï¼Œå‘ç”Ÿäº†æŸäº›äº‹å…ˆä¸å¯çŸ¥çš„å¼‚å¸¸ï¼Œè¿™æ—¶ä¼šè§¦å‘ç”±å½“å‰è¿è¡Œè¿›ç¨‹åˆ‡æ¢åˆ°å¤„ç†æ­¤å¼‚å¸¸çš„å†…æ ¸ç›¸å…³ç¨‹åºä¸­ï¼Œä¹Ÿå°±è½¬åˆ°äº†å†…æ ¸æ€ï¼Œæ¯”å¦‚ç¼ºé¡µå¼‚å¸¸ã€‚\n  free()å‡½æ•°å¦‚ä½•çŸ¥é“è¦é‡Šæ”¾çš„ç©ºé—´å¤§å°â“ mallocæœ‰å¤šç§å®ç°ï¼Œæœ‰ä½¿ç”¨é“¾è¡¨çš„ï¼Œä¹Ÿæœ‰æ˜¯ç”±åœ¨ç”³è¯·å†…å­˜å¤´éƒ¨è®°å½•ä¿¡æ¯çš„ï¼Œè¿˜æœ‰ä½¿ç”¨ä¼™ä¼´çš„ç®—æ³•ã€‚æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„mallocç®—æ³•ã€‚\nå‚è€ƒï¼šhttps://www.zhihu.com/question/302440083\nä¸­æ–­å’Œè½®è¯¢çš„ç‰¹ç‚¹ğŸ¥š å¯¹I/Oè®¾å¤‡çš„ç¨‹åºè½®è¯¢çš„æ–¹å¼ï¼Œæ˜¯æ—©æœŸçš„è®¡ç®—æœºç³»ç»Ÿå¯¹I/Oè®¾å¤‡çš„ä¸€ç§ç®¡ç†æ–¹å¼ã€‚å®ƒå®šæ—¶å¯¹å„ç§è®¾å¤‡è½®æµè¯¢é—®ä¸€éæœ‰æ— å¤„ç†è¦æ±‚ã€‚è½®æµè¯¢é—®ä¹‹åï¼Œæœ‰è¦æ±‚çš„ï¼Œåˆ™åŠ ä»¥å¤„ç†ã€‚åœ¨å¤„ç†I/Oè®¾å¤‡çš„è¦æ±‚ä¹‹åï¼Œå¤„ç†æœºè¿”å›ç»§ç»­å·¥ä½œã€‚å°½ç®¡è½®è¯¢éœ€è¦æ—¶é—´ï¼Œä½†è½®è¯¢è¦æ¯”I/Oè®¾å¤‡çš„é€Ÿåº¦è¦å¿«å¾—å¤šï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šå‘ç”Ÿä¸èƒ½åŠæ—¶å¤„ç†çš„é—®é¢˜ã€‚å½“ç„¶ï¼Œå†å¿«çš„å¤„ç†æœºï¼Œèƒ½å¤„ç†çš„è¾“å…¥è¾“å‡ºè®¾å¤‡çš„æ•°é‡ä¹Ÿæ˜¯æœ‰ä¸€å®šé™åº¦çš„ã€‚è€Œä¸”ï¼Œç¨‹åºè½®è¯¢æ¯•ç«Ÿå æ®äº†CPUç›¸å½“ä¸€éƒ¨åˆ†å¤„ç†æ—¶é—´ï¼Œå› æ­¤ï¼Œç¨‹åºè½®è¯¢æ˜¯ä¸€ç§æ•ˆç‡è¾ƒä½çš„æ–¹å¼ï¼Œåœ¨ç°ä»£è®¡ç®—æœºç³»ç»Ÿä¸­å·²å¾ˆå°‘åº”ç”¨ã€‚\nã€€ç¨‹åºä¸­æ–­é€šå¸¸ç®€ç§°ä¸­æ–­ï¼Œæ˜¯æŒ‡CPUåœ¨æ­£å¸¸è¿è¡Œç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œç”±äºé¢„å…ˆå®‰æ’æˆ–å‘ç”Ÿäº†å„ç§éšæœºçš„å†…éƒ¨æˆ–å¤–éƒ¨äº‹ä»¶ï¼Œä½¿CPUä¸­æ–­æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œè€Œè½¬åˆ°ä¸ºå“åº”çš„æœåŠ¡ç¨‹åºå»å¤„ç†ã€‚\nã€€è½®è¯¢â€”â€”æ•ˆç‡ä½ï¼Œç­‰å¾…æ—¶é—´å¾ˆé•¿ï¼ŒCPUåˆ©ç”¨ç‡ä¸é«˜ã€‚\nã€€ä¸­æ–­â€”â€”å®¹æ˜“é—æ¼ä¸€äº›é—®é¢˜ï¼ŒCPUåˆ©ç”¨ç‡é«˜ã€‚\n ä¸­æ–­æ˜¯æŒ‡åœ¨è®¡ç®—æœºæ‰§è¡ŒæœŸé—´ï¼Œç³»ç»Ÿå†…å‘ç”Ÿä»»ä½•éå¯»å¸¸çš„æˆ–éé¢„æœŸçš„æ€¥éœ€å¤„ç†äº‹ä»¶ï¼Œä½¿å¾—CPUæš‚æ—¶ä¸­æ–­å½“å‰æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºè€Œè½¬å»æ‰§è¡Œç›¸åº”çš„äº‹ä»¶å¤„ç†ç¨‹åºã€‚å¾…å¤„ç†å®Œæ¯•ååˆè¿”å›åŸæ¥è¢«ä¸­æ–­å¤„ç»§ç»­æ‰§è¡Œæˆ–è°ƒåº¦æ–°çš„è¿›ç¨‹æ‰§è¡Œçš„è¿‡ç¨‹ã€‚\n ä¸­æ–­å‘é‡è¡¨\nå¤–éƒ¨è®¾å¤‡çš„ä¸­æ–­å¸¸å¸¸å¯¹åº”å‘é‡è¡¨ä¸­çš„æŸä¸€é¡¹ï¼Œè¿™æ˜¯é€šç”¨æ¡†æ¶çš„å¤–éƒ¨ä¸­æ–­å¤„ç†å‡½æ•°å…¥å£ï¼Œå› æ­¤åœ¨è¿›å…¥é€šç”¨çš„ä¸­æ–­å¤„ç†å‡½æ•°ä¹‹åï¼Œç³»ç»Ÿå¿…é¡»çŸ¥é“æ­£åœ¨å¤„ç†çš„ä¸­æ–­æ˜¯å“ªä¸€ä¸ªè®¾å¤‡äº§ç”Ÿçš„ï¼Œè€Œè¿™æ­£æ˜¯ç”±è½¯ä»¶ä¸­æ–­å·irqå®šçš„å†³ã€‚ä¸­æ–­å‘é‡è¡¨çš„å†…å®¹æ˜¯ç”±æ“ä½œç³»ç»Ÿåœ¨åˆå§‹åŒ–é˜¶æ®µæ¥å¡«å†™ï¼Œå¯¹äºå¤–éƒ¨ä¸­æ–­ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£å®ç°ä¸€ä¸ªé€šç”¨çš„å¤–éƒ¨ä¸­æ–­å¤„ç†å‡½æ•°ï¼Œç„¶åæŠŠè¿™ä¸ªå‡½æ•°çš„å…¥å£åœ°å€æ”¾åˆ°ä¸­æ–­å‘é‡è¡¨ä¸­çš„å¯¹åº”ä½ç½®ã€‚ç”¨æˆ·æ³¨å†Œè®¾å¤‡é©±åŠ¨ISRï¼Œå®é™…ä¸Šå°±æ˜¯æŒ‚æ¥åˆ°ä¸­æ–­å‘é‡è¡¨ä¸­ï¼Œè¦†ç›–æŸä¸€é¡¹çš„é»˜è®¤å¤„ç†å®ç°ç‰¹åŒ–ã€‚\nåˆ†æ®µä¸åˆ†é¡µğŸ‘“ æ®µå¼å­˜å‚¨ç®¡ç†æ˜¯ä¸€ç§ç¬¦åˆç”¨æˆ·è§†è§’çš„å†…å­˜åˆ†é…ç®¡ç†æ–¹æ¡ˆã€‚åœ¨æ®µå¼å­˜å‚¨ç®¡ç†ä¸­ï¼Œå°†ç¨‹åºçš„åœ°å€ç©ºé—´åˆ’åˆ†ä¸ºè‹¥å¹²æ®µï¼ˆsegmentï¼‰ï¼Œå¦‚ä»£ç æ®µï¼Œæ•°æ®æ®µï¼Œå †æ ˆæ®µï¼›è¿™æ ·æ¯ä¸ªè¿›ç¨‹æœ‰ä¸€ä¸ªäºŒç»´åœ°å€ç©ºé—´ï¼Œç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ã€‚æ®µå¼ç®¡ç†çš„ä¼˜ç‚¹æ˜¯ï¼šæ²¡æœ‰å†…ç¢ç‰‡ï¼ˆå› ä¸ºæ®µå¤§å°å¯å˜ï¼Œæ”¹å˜æ®µå¤§å°æ¥æ¶ˆé™¤å†…ç¢ç‰‡ï¼‰ã€‚ä½†æ®µæ¢å…¥æ¢å‡ºæ—¶ï¼Œä¼šäº§ç”Ÿå¤–ç¢ç‰‡ï¼ˆæ¯”å¦‚4kçš„æ®µæ¢5kçš„æ®µï¼Œä¼šäº§ç”Ÿ1kçš„å¤–ç¢ç‰‡ï¼‰\né¡µå¼å­˜å‚¨ç®¡ç†æ–¹æ¡ˆæ˜¯ä¸€ç§ç”¨æˆ·è§†è§’å†…å­˜ä¸ç‰©ç†å†…å­˜ç›¸åˆ†ç¦»çš„å†…å­˜åˆ†é…ç®¡ç†æ–¹æ¡ˆã€‚åœ¨é¡µå¼å­˜å‚¨ç®¡ç†ä¸­ï¼Œå°†ç¨‹åºçš„é€»è¾‘åœ°å€åˆ’åˆ†ä¸ºå›ºå®šå¤§å°çš„é¡µï¼ˆpageï¼‰ï¼Œè€Œç‰©ç†å†…å­˜åˆ’åˆ†ä¸ºåŒæ ·å¤§å°çš„å¸§ï¼Œç¨‹åºåŠ è½½æ—¶ï¼Œå¯ä»¥å°†ä»»æ„ä¸€é¡µæ”¾å…¥å†…å­˜ä¸­ä»»æ„ä¸€ä¸ªå¸§ï¼Œè¿™äº›å¸§ä¸å¿…è¿ç»­ï¼Œä»è€Œå®ç°äº†ç¦»æ•£åˆ†ç¦»ã€‚é¡µå¼å­˜å‚¨ç®¡ç†çš„ä¼˜ç‚¹æ˜¯ï¼šæ²¡æœ‰å¤–ç¢ç‰‡ï¼ˆå› ä¸ºé¡µçš„å¤§å°å›ºå®šï¼‰ï¼Œä½†ä¼šäº§ç”Ÿå†…ç¢ç‰‡ï¼ˆä¸€ä¸ªé¡µå¯èƒ½å¡«å……ä¸æ»¡ï¼‰ã€‚\nä¸¤è€…çš„ä¸åŒç‚¹ï¼š\nç›®çš„ä¸åŒï¼šåˆ†é¡µæ˜¯ç”±äºç³»ç»Ÿç®¡ç†çš„éœ€è¦è€Œä¸æ˜¯ç”¨æˆ·çš„éœ€è¦ï¼Œå®ƒæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ï¼›åˆ†æ®µçš„ç›®çš„æ˜¯ä¸ºäº†èƒ½æ›´å¥½åœ°æ»¡è¶³ç”¨æˆ·çš„éœ€è¦ï¼Œå®ƒæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œå®ƒå«æœ‰ä¸€ç»„å…¶æ„ä¹‰ç›¸å¯¹å®Œæ•´çš„ä¿¡æ¯ï¼›\nå¤§å°ä¸åŒï¼šé¡µçš„å¤§å°å›ºå®šä¸”ç”±ç³»ç»Ÿå†³å®šï¼Œè€Œæ®µçš„é•¿åº¦å´ä¸å›ºå®šï¼Œç”±å…¶æ‰€å®Œæˆçš„åŠŸèƒ½å†³å®šï¼›\nåœ°å€ç©ºé—´ä¸åŒï¼š æ®µå‘ç”¨æˆ·æä¾›äºŒç»´åœ°å€ç©ºé—´ï¼›é¡µå‘ç”¨æˆ·æä¾›çš„æ˜¯ä¸€ç»´åœ°å€ç©ºé—´ï¼›\nä¿¡æ¯å…±äº«ï¼šæ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œä¾¿äºå­˜å‚¨ä¿æŠ¤å’Œä¿¡æ¯çš„å…±äº«ï¼Œé¡µçš„ä¿æŠ¤å’Œå…±äº«å—åˆ°é™åˆ¶ï¼›\nå†…å­˜ç¢ç‰‡ï¼šé¡µå¼å­˜å‚¨ç®¡ç†çš„ä¼˜ç‚¹æ˜¯æ²¡æœ‰å¤–ç¢ç‰‡ï¼ˆå› ä¸ºé¡µçš„å¤§å°å›ºå®šï¼‰ï¼Œä½†ä¼šäº§ç”Ÿå†…ç¢ç‰‡ï¼ˆä¸€ä¸ªé¡µå¯èƒ½å¡«å……ä¸æ»¡ï¼‰ï¼›è€Œæ®µå¼ç®¡ç†çš„ä¼˜ç‚¹æ˜¯æ²¡æœ‰å†…ç¢ç‰‡ï¼ˆå› ä¸ºæ®µå¤§å°å¯å˜ï¼Œæ”¹å˜æ®µå¤§å°æ¥æ¶ˆé™¤å†…ç¢ç‰‡ï¼‰ã€‚ä½†æ®µæ¢å…¥æ¢å‡ºæ—¶ï¼Œä¼šäº§ç”Ÿå¤–ç¢ç‰‡ï¼ˆæ¯”å¦‚4kçš„æ®µæ¢5kçš„æ®µï¼Œä¼šäº§ç”Ÿ1kçš„å¤–ç¢ç‰‡ï¼‰ã€‚\n æ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œå®ƒæ˜¯æ ¹æ®ç”¨æˆ·çš„éœ€è¦åˆ’åˆ†çš„ï¼Œå› æ­¤æ®µå¯¹ç”¨æˆ·æ˜¯å¯è§çš„ ï¼›é¡µæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ï¼Œæ˜¯ä¸ºäº†ç®¡ç†ä¸»å­˜çš„æ–¹ä¾¿è€Œåˆ’åˆ†çš„ï¼Œå¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ã€‚ æ®µçš„å¤§å°ä¸å›ºå®šï¼Œæœ‰å®ƒæ‰€å®Œæˆçš„åŠŸèƒ½å†³å®šï¼›é¡µå¤§å¤§å°å›ºå®šï¼Œç”±ç³»ç»Ÿå†³å®š æ®µå‘ç”¨æˆ·æä¾›äºŒç»´åœ°å€ç©ºé—´ï¼›é¡µå‘ç”¨æˆ·æä¾›çš„æ˜¯ä¸€ç»´åœ°å€ç©ºé—´ æ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œä¾¿äºå­˜å‚¨ä¿æŠ¤å’Œä¿¡æ¯çš„å…±äº«ï¼Œé¡µçš„ä¿æŠ¤å’Œå…±äº«å—åˆ°é™åˆ¶ã€‚  é¡µæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ï¼Œåˆ†é¡µæ˜¯ä¸ºå®ç°ç¦»æ•£åˆ†é…æ–¹å¼ï¼Œä»¥æ¶ˆå‡å†…å­˜çš„å¤–é›¶å¤´ï¼Œæé«˜å†…å­˜çš„åˆ©ç”¨ç‡ï¼›æˆ–è€…è¯´ï¼Œåˆ†é¡µä»…ä»…æ˜¯ç”±äºç³»ç»Ÿç®¡ç†çš„éœ€è¦ï¼Œè€Œä¸æ˜¯ç”¨æˆ·çš„éœ€è¦ã€‚\næ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œå®ƒå«æœ‰ä¸€ç»„å…¶æ„ä¹‰ç›¸å¯¹å®Œæ•´çš„ä¿¡æ¯ã€‚åˆ†æ®µçš„ç›®çš„æ˜¯ä¸ºäº†èƒ½æ›´å¥½çš„æ»¡è¶³ç”¨æˆ·çš„éœ€è¦ã€‚\né¡µçš„å¤§å°å›ºå®šä¸”ç”±ç³»ç»Ÿç¡®å®šï¼ŒæŠŠé€»è¾‘åœ°å€åˆ’åˆ†ä¸ºé¡µå·å’Œé¡µå†…åœ°å€ä¸¤éƒ¨åˆ†ï¼Œæ˜¯ç”±æœºå™¨ç¡¬ä»¶å®ç°çš„ï¼Œå› è€Œä¸€ä¸ªç³»ç»Ÿåªèƒ½æœ‰ä¸€ç§å¤§å°çš„é¡µé¢ã€‚æ®µçš„é•¿åº¦å´ä¸å›ºå®šï¼Œå†³å®šäºç”¨æˆ·æ‰€ç¼–å†™çš„ç¨‹åºï¼Œé€šå¸¸ç”±ç¼–è¾‘ç¨‹åºåœ¨å¯¹æºç¨‹åºè¿›è¡Œç¼–è¾‘æ—¶ï¼Œæ ¹æ®ä¿¡æ¯çš„æ€§è´¨æ¥åˆ’åˆ†ã€‚\nåˆ†é¡µçš„ä½œä¸šåœ°å€ç©ºé—´æ˜¯ä¸€ç»´çš„ï¼Œå³å•ä¸€çš„çº¿æ€§ç©ºé—´ï¼Œç¨‹åºå‘˜åªé¡»åˆ©ç”¨ä¸€ä¸ªè®°å¿†ç¬¦ï¼Œå³å¯è¡¨ç¤ºä¸€åœ°å€ã€‚åˆ†æ®µçš„ä½œä¸šåœ°å€ç©ºé—´æ˜¯äºŒç»´çš„ï¼Œç¨‹åºå‘˜åœ¨æ ‡è¯†ä¸€ä¸ªåœ°å€æ—¶ï¼Œæ—¢éœ€ç»™å‡ºæ®µåï¼Œåˆéœ€ç»™å‡ºæ®µå†…åœ°å€ã€‚\nå†…å­˜åˆ†æ®µ ç¨‹åºæ˜¯ç”±è‹¥å¹²ä¸ªé€»è¾‘åˆ†æ®µç»„æˆçš„ï¼Œå¦‚å¯ç”±ä»£ç åˆ†æ®µã€æ•°æ®åˆ†æ®µã€æ ˆæ®µã€å †æ®µç»„æˆã€‚ä¸åŒçš„æ®µæ˜¯æœ‰ä¸åŒçš„å±æ€§çš„ï¼Œæ‰€ä»¥å°±ç”¨åˆ†æ®µï¼ˆSegmentationï¼‰çš„å½¢å¼æŠŠè¿™äº›æ®µåˆ†ç¦»å‡ºæ¥ã€‚\n åˆ†æ®µæœºåˆ¶ä¸‹ï¼Œè™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€æ˜¯å¦‚ä½•æ˜ å°„çš„ï¼Ÿ\n åˆ†æ®µæœºåˆ¶ä¸‹çš„è™šæ‹Ÿåœ°å€ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œæ®µé€‰æ‹©å­å’Œæ®µå†…åç§»é‡ã€‚\n æ®µé€‰æ‹©å­å°±ä¿å­˜åœ¨æ®µå¯„å­˜å™¨é‡Œé¢ã€‚æ®µé€‰æ‹©å­é‡Œé¢æœ€é‡è¦çš„æ˜¯æ®µå·ï¼Œç”¨ä½œæ®µè¡¨çš„ç´¢å¼•ã€‚æ®µè¡¨é‡Œé¢ä¿å­˜çš„æ˜¯è¿™ä¸ªæ®µçš„åŸºåœ°å€ã€æ®µçš„ç•Œé™å’Œç‰¹æƒç­‰çº§ç­‰ã€‚ è™šæ‹Ÿåœ°å€ä¸­çš„æ®µå†…åç§»é‡åº”è¯¥ä½äº 0 å’Œæ®µç•Œé™ä¹‹é—´ï¼Œå¦‚æœæ®µå†…åç§»é‡æ˜¯åˆæ³•çš„ï¼Œå°±å°†æ®µåŸºåœ°å€åŠ ä¸Šæ®µå†…åç§»é‡å¾—åˆ°ç‰©ç†å†…å­˜åœ°å€ã€‚  ç”±ä¸Šé¢å¯ä»¥çŸ¥é“è™šæ‹Ÿåœ°å€æ˜¯é€šè¿‡æ®µè¡¨ä¸ç‰©ç†åœ°å€è¿›è¡Œæ˜ å°„çš„ï¼Œåˆ†æ®µæœºåˆ¶ä¼šæŠŠç¨‹åºçš„è™šæ‹Ÿåœ°å€åˆ†æˆ 4 ä¸ªæ®µï¼Œæ¯ä¸ªæ®µåœ¨æ®µè¡¨ä¸­æœ‰ä¸€ä¸ªé¡¹ï¼Œåœ¨è¿™ä¸€é¡¹æ‰¾åˆ°æ®µçš„åŸºåœ°å€ï¼Œå†åŠ ä¸Šåç§»é‡ï¼Œäºæ˜¯å°±èƒ½æ‰¾åˆ°ç‰©ç†å†…å­˜ä¸­çš„åœ°å€ï¼Œå¦‚ä¸‹å›¾ï¼š\nåˆ†æ®µçš„åŠæ³•å¾ˆå¥½ï¼Œè§£å†³äº†ç¨‹åºæœ¬èº«ä¸éœ€è¦å…³å¿ƒå…·ä½“çš„ç‰©ç†å†…å­˜åœ°å€çš„é—®é¢˜ï¼Œä½†å®ƒä¹Ÿæœ‰ä¸€äº›ä¸è¶³ä¹‹å¤„ï¼š\n ç¬¬ä¸€ä¸ªå°±æ˜¯å†…å­˜ç¢ç‰‡çš„é—®é¢˜ã€‚ ç¬¬äºŒä¸ªå°±æ˜¯å†…å­˜äº¤æ¢çš„æ•ˆç‡ä½çš„é—®é¢˜ã€‚  ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Ÿ\nå‡è®¾æˆ‘ä»¬æ‰§è¡Œäº†ä¸‹é¢å‡ ä¸ªç¨‹åºï¼š\n æ¸¸æˆå ç”¨äº† 512MB å†…å­˜ æµè§ˆå™¨å ç”¨äº† 128MB å†…å­˜ éŸ³ä¹å ç”¨äº† 256 MB å†…å­˜ã€‚  å‡è®¾æœ‰ 1G çš„ç‰©ç†å†…å­˜ï¼Œåˆ™ç©ºé—²å†…å­˜è¿˜æœ‰ 1024 - 512 - 256 = 256MBã€‚å¦‚æœè¿™ä¸ª 256MB ä¸æ˜¯è¿ç»­çš„ï¼Œè¢«åˆ†æˆäº†ä¸¤æ®µ 128 MB å†…å­˜ï¼Œè¿™å°±ä¼šå¯¼è‡´æ²¡æœ‰ç©ºé—´å†æ‰“å¼€ä¸€ä¸ª 200MB çš„ç¨‹åºã€‚\nè¿™é‡Œçš„å†…å­˜ç¢ç‰‡çš„é—®é¢˜å…±æœ‰ä¸¤å¤„åœ°æ–¹ï¼š\n å¤–éƒ¨å†…å­˜ç¢ç‰‡ï¼Œä¹Ÿå°±æ˜¯äº§ç”Ÿäº†å¤šä¸ªä¸è¿ç»­çš„å°ç‰©ç†å†…å­˜ï¼Œå¯¼è‡´æ–°çš„ç¨‹åºæ— æ³•è¢«è£…è½½ï¼› å†…éƒ¨å†…å­˜ç¢ç‰‡ï¼Œç¨‹åºæ‰€æœ‰çš„å†…å­˜éƒ½è¢«è£…è½½åˆ°äº†ç‰©ç†å†…å­˜ï¼Œä½†æ˜¯è¿™ä¸ªç¨‹åºæœ‰éƒ¨åˆ†çš„å†…å­˜å¯èƒ½å¹¶ä¸æ˜¯å¾ˆå¸¸ä½¿ç”¨ï¼Œè¿™ä¹Ÿä¼šå¯¼è‡´å†…å­˜çš„æµªè´¹ï¼›  è§£å†³å¤–éƒ¨å†…å­˜ç¢ç‰‡çš„é—®é¢˜å°±æ˜¯å†…å­˜äº¤æ¢ã€‚\nå¯ä»¥æŠŠéŸ³ä¹ç¨‹åºå ç”¨çš„é‚£ 256MB å†…å­˜å†™åˆ°ç¡¬ç›˜ä¸Šï¼Œç„¶åå†ä»ç¡¬ç›˜ä¸Šè¯»å›æ¥åˆ°å†…å­˜é‡Œã€‚ä¸è¿‡å†è¯»å›çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸èƒ½è£…è½½å›åŸæ¥çš„ä½ç½®ï¼Œè€Œæ˜¯ç´§ç´§è·Ÿç€é‚£å·²ç»è¢«å ç”¨äº†çš„ 512MB å†…å­˜åé¢ã€‚è¿™æ ·å°±èƒ½ç©ºç¼ºå‡ºè¿ç»­çš„ 256MB ç©ºé—´ï¼Œäºæ˜¯æ–°çš„ 200MB ç¨‹åºå°±å¯ä»¥è£…è½½è¿›æ¥ã€‚\nè¿™ä¸ªå†…å­˜äº¤æ¢ç©ºé—´ï¼Œåœ¨ Linux ç³»ç»Ÿé‡Œï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸çœ‹åˆ°çš„ Swap ç©ºé—´ï¼Œè¿™å—ç©ºé—´æ˜¯ä»ç¡¬ç›˜åˆ’åˆ†å‡ºæ¥çš„ï¼Œç”¨äºå†…å­˜ä¸ç¡¬ç›˜çš„ç©ºé—´äº¤æ¢ã€‚\nåˆ†æ®µä¸ºä»€ä¹ˆå¯¼è‡´æ•ˆç‡ä½ï¼Ÿ\nå¯¹äºå¤šè¿›ç¨‹çš„ç³»ç»Ÿæ¥è¯´ï¼Œç”¨åˆ†æ®µçš„æ–¹å¼ï¼Œå†…å­˜ç¢ç‰‡æ˜¯å¾ˆå®¹æ˜“äº§ç”Ÿçš„ï¼Œäº§ç”Ÿäº†å†…å­˜ç¢ç‰‡ï¼Œé‚£ä¸å¾—ä¸é‡æ–° Swap å†…å­˜åŒºåŸŸï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šäº§ç”Ÿæ€§èƒ½ç“¶é¢ˆã€‚\nå› ä¸ºç¡¬ç›˜çš„è®¿é—®é€Ÿåº¦è¦æ¯”å†…å­˜æ…¢å¤ªå¤šäº†ï¼Œæ¯ä¸€æ¬¡å†…å­˜äº¤æ¢ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æŠŠä¸€å¤§æ®µè¿ç»­çš„å†…å­˜æ•°æ®å†™åˆ°ç¡¬ç›˜ä¸Šã€‚\næ‰€ä»¥ï¼Œå¦‚æœå†…å­˜äº¤æ¢çš„æ—¶å€™ï¼Œäº¤æ¢çš„æ˜¯ä¸€ä¸ªå å†…å­˜ç©ºé—´å¾ˆå¤§çš„ç¨‹åºï¼Œè¿™æ ·æ•´ä¸ªæœºå™¨éƒ½ä¼šæ˜¾å¾—å¡é¡¿ã€‚\nå†…å­˜åˆ†é¡µ å†…å­˜åˆ†é¡µå°±æ˜¯ä¸ºäº†è§£å†³åˆ†æ®µçš„å†…å­˜ç¢ç‰‡ä»¥åŠæ•ˆç‡ä½è€Œæå‡ºæ¥çš„ã€‚\nåˆ†é¡µæ˜¯æŠŠæ•´ä¸ªè™šæ‹Ÿå’Œç‰©ç†å†…å­˜ç©ºé—´åˆ‡æˆä¸€æ®µæ®µå›ºå®šå°ºå¯¸çš„å¤§å°ã€‚è¿™æ ·ä¸€ä¸ªè¿ç»­å¹¶ä¸”å°ºå¯¸å›ºå®šçš„å†…å­˜ç©ºé—´ï¼Œæˆ‘ä»¬å«é¡µï¼ˆPageï¼‰ã€‚åœ¨ Linux ä¸‹ï¼Œæ¯ä¸€é¡µçš„å¤§å°ä¸º 4KBã€‚\nè™šæ‹Ÿåœ°å€ä¸ç‰©ç†åœ°å€ä¹‹é—´é€šè¿‡é¡µè¡¨æ¥æ˜ å°„ï¼š\nç”±äºå†…å­˜ç©ºé—´éƒ½æ˜¯é¢„å…ˆåˆ’åˆ†å¥½çš„ï¼Œä¹Ÿå°±ä¸ä¼šåƒåˆ†æ®µä¼šäº§ç”Ÿé—´éš™éå¸¸å°çš„å†…å­˜ï¼Œè¿™æ­£æ˜¯åˆ†æ®µä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡çš„åŸå› ã€‚è€Œé‡‡ç”¨äº†åˆ†é¡µï¼Œé‚£ä¹ˆé‡Šæ”¾çš„å†…å­˜éƒ½æ˜¯ä»¥é¡µä¸ºå•ä½é‡Šæ”¾çš„ï¼Œä¹Ÿå°±ä¸ä¼šäº§ç”Ÿæ— æ³•ç»™è¿›ç¨‹ä½¿ç”¨çš„å°å†…å­˜ã€‚\nå¦‚æœå†…å­˜ç©ºé—´ä¸å¤Ÿï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠå…¶ä»–æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ä¸­çš„ã€Œæœ€è¿‘æ²¡è¢«ä½¿ç”¨ã€çš„å†…å­˜é¡µé¢ç»™é‡Šæ”¾æ‰ï¼Œä¹Ÿå°±æ˜¯æš‚æ—¶å†™åœ¨ç¡¬ç›˜ä¸Šï¼Œç§°ä¸ºæ¢å‡ºï¼ˆSwap Outï¼‰ã€‚ä¸€æ—¦éœ€è¦çš„æ—¶å€™ï¼Œå†åŠ è½½è¿›æ¥ï¼Œç§°ä¸ºæ¢å…¥ï¼ˆSwap Inï¼‰ã€‚æ‰€ä»¥ï¼Œä¸€æ¬¡æ€§å†™å…¥ç£ç›˜çš„ä¹Ÿåªæœ‰å°‘æ•°çš„ä¸€ä¸ªé¡µæˆ–è€…å‡ ä¸ªé¡µï¼Œä¸ä¼šèŠ±å¤ªå¤šæ—¶é—´ï¼Œå†…å­˜äº¤æ¢çš„æ•ˆç‡å°±ç›¸å¯¹æ¯”è¾ƒé«˜ã€‚\nåœ¨åˆ†é¡µæœºåˆ¶ä¸‹ï¼Œè™šæ‹Ÿåœ°å€åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œé¡µå·å’Œé¡µå†…åç§»ã€‚é¡µå·ä½œä¸ºé¡µè¡¨çš„ç´¢å¼•ï¼Œé¡µè¡¨åŒ…å«ç‰©ç†é¡µæ¯é¡µæ‰€åœ¨ç‰©ç†å†…å­˜çš„åŸºåœ°å€ï¼Œè¿™ä¸ªåŸºåœ°å€ä¸é¡µå†…åç§»çš„ç»„åˆå°±å½¢æˆäº†ç‰©ç†å†…å­˜åœ°å€ï¼Œè§ä¸‹å›¾ã€‚\næ®µé¡µå¼ç®¡ç† å†…å­˜åˆ†æ®µå’Œå†…å­˜åˆ†é¡µå¹¶ä¸æ˜¯å¯¹ç«‹çš„ï¼Œå®ƒä»¬æ˜¯å¯ä»¥ç»„åˆèµ·æ¥åœ¨åŒä¸€ä¸ªç³»ç»Ÿä¸­ä½¿ç”¨çš„ï¼Œé‚£ä¹ˆç»„åˆèµ·æ¥åï¼Œé€šå¸¸ç§°ä¸ºæ®µé¡µå¼å†…å­˜ç®¡ç†ã€‚\næ®µé¡µå¼å†…å­˜ç®¡ç†å®ç°çš„æ–¹å¼ï¼š\n å…ˆå°†ç¨‹åºåˆ’åˆ†ä¸ºå¤šä¸ªæœ‰é€»è¾‘æ„ä¹‰çš„æ®µï¼Œä¹Ÿå°±æ˜¯å‰é¢æåˆ°çš„åˆ†æ®µæœºåˆ¶ï¼› æ¥ç€å†æŠŠæ¯ä¸ªæ®µåˆ’åˆ†ä¸ºå¤šä¸ªé¡µï¼Œä¹Ÿå°±æ˜¯å¯¹åˆ†æ®µåˆ’åˆ†å‡ºæ¥çš„è¿ç»­ç©ºé—´ï¼Œå†åˆ’åˆ†å›ºå®šå¤§å°çš„é¡µï¼›  è¿™æ ·ï¼Œåœ°å€ç»“æ„å°±ç”±æ®µå·ã€æ®µå†…é¡µå·å’Œé¡µå†…ä½ç§»ä¸‰éƒ¨åˆ†ç»„æˆã€‚\nç”¨äºæ®µé¡µå¼åœ°å€å˜æ¢çš„æ•°æ®ç»“æ„æ˜¯æ¯ä¸€ä¸ªç¨‹åºä¸€å¼ æ®µè¡¨ï¼Œæ¯ä¸ªæ®µåˆå»ºç«‹ä¸€å¼ é¡µè¡¨ï¼Œæ®µè¡¨ä¸­çš„åœ°å€æ˜¯é¡µè¡¨çš„èµ·å§‹åœ°å€ï¼Œè€Œé¡µè¡¨ä¸­çš„åœ°å€åˆ™ä¸ºæŸé¡µçš„ç‰©ç†é¡µå·ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\næ®µé¡µå¼åœ°å€å˜æ¢ä¸­è¦å¾—åˆ°ç‰©ç†åœ°å€é¡»ç»è¿‡ä¸‰æ¬¡å†…å­˜è®¿é—®ï¼š\n ç¬¬ä¸€æ¬¡è®¿é—®æ®µè¡¨ï¼Œå¾—åˆ°é¡µè¡¨èµ·å§‹åœ°å€ï¼› ç¬¬äºŒæ¬¡è®¿é—®é¡µè¡¨ï¼Œå¾—åˆ°ç‰©ç†é¡µå·ï¼› ç¬¬ä¸‰æ¬¡å°†ç‰©ç†é¡µå·ä¸é¡µå†…ä½ç§»ç»„åˆï¼Œå¾—åˆ°ç‰©ç†åœ°å€ã€‚  å¯ç”¨è½¯ã€ç¡¬ä»¶ç›¸ç»“åˆçš„æ–¹æ³•å®ç°æ®µé¡µå¼åœ°å€å˜æ¢ï¼Œè¿™æ ·è™½ç„¶å¢åŠ äº†ç¡¬ä»¶æˆæœ¬å’Œç³»ç»Ÿå¼€é”€ï¼Œä½†æé«˜äº†å†…å­˜çš„åˆ©ç”¨ç‡ã€‚\nå‚è€ƒï¼š\n 20 å¼ å›¾æ­å¼€ã€Œå†…å­˜ç®¡ç†ã€çš„è¿·é›¾  è¿›ç¨‹è°ƒåº¦ç®—æ³•ğŸ”Œ FCFS(å…ˆæ¥å…ˆæœåŠ¡)ï¼Œä¼˜å…ˆçº§ï¼Œæ—¶é—´ç‰‡è½®è½¬ï¼Œå¤šçº§åé¦ˆ\n  FCFS(å…ˆæ¥å…ˆæœåŠ¡ï¼Œé˜Ÿåˆ—å®ç°ï¼ŒéæŠ¢å çš„)\nå…ˆè¯·æ±‚CPUçš„è¿›ç¨‹å…ˆåˆ†é…åˆ°CPU\n  SJF(æœ€çŸ­ä½œä¸šä¼˜å…ˆè°ƒåº¦ç®—æ³•)\nå¹³å‡ç­‰å¾…æ—¶é—´æœ€çŸ­ï¼Œä½†éš¾ä»¥çŸ¥é“ä¸‹ä¸€ä¸ªCPUåŒºé—´é•¿åº¦\n  **ä¼˜å…ˆçº§è°ƒåº¦ç®—æ³•(**å¯ä»¥æ˜¯æŠ¢å çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯éæŠ¢å çš„)ï¼š\nä¼˜å…ˆçº§è¶Šé«˜è¶Šå…ˆåˆ†é…åˆ°CPUï¼Œç›¸åŒä¼˜å…ˆçº§å…ˆåˆ°å…ˆæœåŠ¡ï¼Œå­˜åœ¨çš„ä¸»è¦é—®é¢˜æ˜¯ï¼šä½ä¼˜å…ˆçº§è¿›ç¨‹æ— ç©·ç­‰å¾…CPUï¼Œä¼šå¯¼è‡´æ— ç©·é˜»å¡æˆ–é¥¥é¥¿ï¼›è§£å†³æ–¹æ¡ˆï¼šè€åŒ–\n  é«˜å“åº”æ¯”ä¼˜å…ˆè°ƒåº¦ç®—æ³•\næ ¹æ®â€œå“åº”æ¯”=ï¼ˆè¿›ç¨‹æ‰§è¡Œæ—¶é—´+è¿›ç¨‹ç­‰å¾…æ—¶é—´ï¼‰/ è¿›ç¨‹æ‰§è¡Œæ—¶é—´â€è¿™ä¸ªå…¬å¼å¾—åˆ°çš„å“åº”æ¯”æ¥è¿›è¡Œè°ƒåº¦ã€‚é«˜å“åº”æ¯”ä¼˜å…ˆç®—æ³•åœ¨ç­‰å¾…æ—¶é—´ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œä½œä¸šæ‰§è¡Œçš„æ—¶é—´è¶ŠçŸ­ï¼Œå“åº”æ¯”è¶Šé«˜ï¼Œæ»¡è¶³æ®µä»»åŠ¡ä¼˜å…ˆï¼ŒåŒæ—¶å“åº”æ¯”ä¼šéšç€ç­‰å¾…æ—¶é—´å¢åŠ è€Œå˜å¤§ï¼Œä¼˜å…ˆçº§ä¼šæé«˜ï¼Œèƒ½å¤Ÿé¿å…é¥¥é¥¿ç°è±¡ã€‚ä¼˜ç‚¹æ˜¯å…¼é¡¾é•¿çŸ­ä½œä¸šï¼Œç¼ºç‚¹æ˜¯è®¡ç®—å“åº”æ¯”å¼€é”€å¤§ï¼Œé€‚ç”¨äºæ‰¹å¤„ç†ç³»ç»Ÿã€‚\n  æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•(å¯æŠ¢å çš„)\né˜Ÿåˆ—ä¸­**æ²¡æœ‰è¿›ç¨‹è¢«åˆ†é…è¶…è¿‡ä¸€ä¸ªæ—¶é—´ç‰‡çš„CPUæ—¶é—´ï¼Œé™¤éå®ƒæ˜¯å”¯ä¸€å¯è¿è¡Œçš„è¿›ç¨‹ã€‚**å¦‚æœè¿›ç¨‹çš„CPUåŒºé—´è¶…è¿‡äº†ä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œé‚£ä¹ˆè¯¥è¿›ç¨‹å°±è¢«æŠ¢å å¹¶æ”¾å›å°±ç»ªé˜Ÿåˆ—ã€‚\n  å¤šçº§é˜Ÿåˆ—è°ƒåº¦ç®—æ³•\nå°†å°±ç»ªé˜Ÿåˆ—åˆ†æˆå¤šä¸ªç‹¬ç«‹çš„é˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½æœ‰è‡ªå·±çš„è°ƒåº¦ç®—æ³•ï¼Œé˜Ÿåˆ—ä¹‹é—´é‡‡ç”¨å›ºå®šä¼˜å…ˆçº§æŠ¢å è°ƒåº¦ã€‚å…¶ä¸­ï¼Œä¸€ä¸ªè¿›ç¨‹æ ¹æ®è‡ªèº«å±æ€§è¢«æ°¸ä¹…åœ°åˆ†é…åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ã€‚\n  å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•\nä¸å¤šçº§é˜Ÿåˆ—è°ƒåº¦ç®—æ³•ç›¸æ¯”ï¼Œå…¶å…è®¸è¿›ç¨‹åœ¨é˜Ÿåˆ—ä¹‹é—´ç§»åŠ¨ï¼šè‹¥è¿›ç¨‹ä½¿ç”¨è¿‡å¤šCPUæ—¶é—´ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«è½¬ç§»åˆ°æ›´ä½çš„ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼›åœ¨è¾ƒä½ä¼˜å…ˆçº§é˜Ÿåˆ—ç­‰å¾…æ—¶é—´è¿‡é•¿çš„è¿›ç¨‹ä¼šè¢«è½¬ç§»åˆ°æ›´é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œä»¥é˜²æ­¢é¥¥é¥¿å‘ç”Ÿã€‚\n  å‚è€ƒï¼š\n äº”ç§è¿›ç¨‹è°ƒåº¦ç®—æ³•çš„æ€»ç»“ å¤§å‚é¢è¯•çˆ±é—®çš„ã€Œè°ƒåº¦ç®—æ³•ã€ï¼Œ20 å¼ å›¾ä¸€ä¸¾æ‹¿ä¸‹  é¡µé¢ç½®æ¢ç®—æ³•ğŸ’± ä»€ä¹ˆæ˜¯é¡µé¢ç½®æ¢ç®—æ³•ï¼Ÿ è¿›ç¨‹è¿è¡Œæ—¶ï¼Œè‹¥å…¶è®¿é—®çš„é¡µé¢ä¸åœ¨å†…å­˜è€Œéœ€å°†å…¶è°ƒå…¥ï¼Œä½†å†…å­˜å·²æ— ç©ºé—²ç©ºé—´æ—¶ï¼Œå°±éœ€è¦ä»å†…å­˜ä¸­è°ƒå‡ºä¸€é¡µç¨‹åºæˆ–æ•°æ®ï¼Œé€å…¥ç£ç›˜çš„å¯¹æ¢åŒºï¼Œå…¶ä¸­é€‰æ‹©è°ƒå‡ºé¡µé¢çš„ç®—æ³•å°±ç§°ä¸ºé¡µé¢ç½®æ¢ç®—æ³•ã€‚\nå¸¸è§çš„é¡µé¢ç½®æ¢ç®—æ³•   FIFOå…ˆè¿›å…ˆå‡ºç®—æ³•\nï¼ˆä¼˜å…ˆæ·˜æ±°æœ€æ—©è¿›å…¥å†…å­˜çš„é¡µé¢ï¼‰\nåœ¨æ“ä½œç³»ç»Ÿä¸­ç»å¸¸è¢«ç”¨åˆ°ï¼Œæ¯”å¦‚ä½œä¸šè°ƒåº¦ï¼ˆä¸»è¦å®ç°ç®€å•ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ï¼‰ï¼›\n  OPTï¼ˆOptimal replacementï¼‰æœ€ä¼˜ç½®æ¢ç®—æ³•\nï¼ˆæ·˜æ±°ä»¥åä¸ä¼šä½¿ç”¨çš„é¡µé¢ï¼‰\nç†è®ºçš„æœ€ä¼˜ï¼Œç†è®ºï¼›å°±æ˜¯è¦ä¿è¯ç½®æ¢å‡ºå»çš„æ˜¯ä¸å†è¢«ä½¿ç”¨çš„é¡µï¼Œæˆ–è€…æ˜¯åœ¨å®é™…å†…å­˜ä¸­æœ€æ™šä½¿ç”¨çš„ç®—æ³•ã€‚\n FIFO å’Œ OPT ç®—æ³•çš„åŒºåˆ«åœ¨äºï¼šé™¤äº†åœ¨æ—¶é—´ä¸Šå‘åæˆ–å‘å‰çœ‹ä¹‹å¤–ï¼ŒFIFO ç®—æ³•ä½¿ç”¨çš„æ˜¯é¡µé¢è°ƒå…¥å†…å­˜çš„æ—¶é—´ï¼ŒOPT ç®—æ³•ä½¿ç”¨çš„æ˜¯é¡µé¢å°†æ¥ä½¿ç”¨çš„æ—¶é—´\n   LRUï¼ˆLeast recently useï¼‰æœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•\nï¼ˆæ·˜æ±°æœ€è¿‘æ²¡æœ‰ä½¿ç”¨çš„é¡µé¢ï¼‰\né€‰æ‹©æœ€è¿‘æœ€é•¿æ—¶é—´æœªè®¿é—®è¿‡çš„é¡µé¢äºˆä»¥æ·˜æ±°ï¼Œå®ƒè®¤ä¸ºè¿‡å»ä¸€æ®µæ—¶é—´å†…æœªè®¿é—®è¿‡çš„é¡µé¢ï¼Œåœ¨æœ€è¿‘çš„å°†æ¥å¯èƒ½ä¹Ÿä¸ä¼šè¢«è®¿é—®ã€‚è¯¥ç®—æ³•ä¸ºæ¯ä¸ªé¡µé¢è®¾ç½®ä¸€ä¸ªè®¿é—®å­—æ®µï¼Œæ¥è®°å½•é¡µé¢è‡ªä¸Šæ¬¡è¢«è®¿é—®ä»¥æ¥æ‰€ç»å†çš„æ—¶é—´ï¼Œæ·˜æ±°é¡µé¢æ—¶é€‰æ‹©ç°æœ‰é¡µé¢ä¸­å€¼æœ€å¤§çš„äºˆä»¥æ·˜æ±°ã€‚\n OPT å’Œ LRU ç®—æ³•çš„åŒºåˆ«åœ¨äºï¼šLRU ç®—æ³•æ ¹æ®å„é¡µä»¥å‰çš„æƒ…å†µï¼Œæ˜¯â€œå‘å‰çœ‹â€çš„ï¼Œè€Œæœ€ä½³ç½®æ¢ç®—æ³•åˆ™æ ¹æ®å„é¡µä»¥åçš„ä½¿ç”¨æƒ…å†µï¼Œæ˜¯â€œå‘åçœ‹â€çš„\nLRU æ€§èƒ½è¾ƒå¥½ï¼Œä½†éœ€è¦å¯„å­˜å™¨å’Œæ ˆçš„ç¡¬ä»¶æ”¯æŒ\n LRU æ˜¯å †æ ˆç±»çš„ç®—æ³•ï¼Œç†è®ºä¸Šå¯ä»¥è¯æ˜ï¼Œå †æ ˆç±»ç®—æ³•ä¸å¯èƒ½å‡ºç° Belady å¼‚å¸¸\n  LFUï¼ˆLeast frequently use**ï¼‰æœ€å°‘ä½¿ç”¨æ¬¡æ•°ç®—æ³•**\nï¼ˆæ ¹æ®ä½¿ç”¨æ¬¡æ•°æ¥åˆ¤æ–­ï¼‰\næœ€ä¸ç»å¸¸ä½¿ç”¨ï¼ˆLFUï¼‰é¡µé¢ç½®æ¢ç®—æ³•è¦æ±‚ç½®æ¢å…·æœ‰æœ€å°è®¡æ•°çš„é¡µé¢ã€‚\nè¿™ç§é€‰æ‹©çš„åŸå› æ˜¯ï¼Œç§¯æä½¿ç”¨çš„é¡µé¢åº”å½“å…·æœ‰å¤§çš„å¼•ç”¨è®¡æ•°ã€‚ç„¶è€Œï¼Œå½“ä¸€ä¸ªé¡µé¢åœ¨è¿›ç¨‹çš„åˆå§‹é˜¶æ®µå¤§é‡ä½¿ç”¨ä½†æ˜¯éšåä¸å†ä½¿ç”¨æ—¶ï¼Œä¼šå‡ºç°é—®é¢˜ã€‚ç”±äºè¢«å¤§é‡ä½¿ç”¨ï¼Œå®ƒæœ‰ä¸€ä¸ªå¤§çš„è®¡æ•°ï¼Œå³ä½¿ä¸å†éœ€è¦å´ä»ä¿ç•™åœ¨å†…å­˜ä¸­ã€‚ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå®šæœŸåœ°å°†è®¡æ•°å³ç§» 1 ä½ï¼Œä»¥å½¢æˆæŒ‡æ•°è¡°å‡çš„å¹³å‡ä½¿ç”¨è®¡æ•°ã€‚\n  Clockï¼ˆæ—¶é’Ÿç½®æ¢ç®—æ³•ï¼‰\nç®€å•çš„ CLOCK ç®—æ³•æ˜¯ç»™æ¯ä¸€å¸§å…³è”ä¸€ä¸ªé™„åŠ ä½ï¼Œç§°ä¸ºä½¿ç”¨ä½ã€‚\nå½“æŸä¸€é¡µé¦–æ¬¡è£…å…¥ä¸»å­˜æ—¶ï¼Œè¯¥å¸§çš„ä½¿ç”¨ä½è®¾ç½®ä¸º1;\nå½“è¯¥é¡µéšåå†è¢«è®¿é—®åˆ°æ—¶ï¼Œå®ƒçš„ä½¿ç”¨ä½ä¹Ÿè¢«ç½®ä¸º1ã€‚\nå¯¹äºé¡µæ›¿æ¢ç®—æ³•ï¼Œç”¨äºæ›¿æ¢çš„å€™é€‰å¸§é›†åˆçœ‹åšä¸€ä¸ªå¾ªç¯ç¼“å†²åŒºï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªæŒ‡é’ˆä¸ä¹‹ç›¸å…³è”ã€‚\nå½“æŸä¸€é¡µè¢«æ›¿æ¢æ—¶ï¼Œè¯¥æŒ‡é’ˆè¢«è®¾ç½®æˆæŒ‡å‘ç¼“å†²åŒºä¸­çš„ä¸‹ä¸€å¸§ã€‚\nå½“éœ€è¦æ›¿æ¢ä¸€é¡µæ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰«æç¼“å†²åŒºï¼Œä»¥æŸ¥æ‰¾ä½¿ç”¨ä½è¢«ç½®ä¸º0çš„ä¸€å¸§ã€‚\næ¯å½“é‡åˆ°ä¸€ä¸ªä½¿ç”¨ä½ä¸º1çš„å¸§æ—¶ï¼Œæ“ä½œç³»ç»Ÿå°±å°†è¯¥ä½é‡æ–°ç½®ä¸º0ï¼›\nå¦‚æœåœ¨è¿™ä¸ªè¿‡ç¨‹å¼€å§‹æ—¶ï¼Œç¼“å†²åŒºä¸­æ‰€æœ‰å¸§çš„ä½¿ç”¨ä½å‡ä¸º0ï¼Œåˆ™é€‰æ‹©é‡åˆ°çš„ç¬¬ä¸€ä¸ªå¸§æ›¿æ¢ï¼›\nå¦‚æœæ‰€æœ‰å¸§çš„ä½¿ç”¨ä½å‡ä¸º1,åˆ™æŒ‡é’ˆåœ¨ç¼“å†²åŒºä¸­å®Œæ•´åœ°å¾ªç¯ä¸€å‘¨ï¼ŒæŠŠæ‰€æœ‰ä½¿ç”¨ä½éƒ½ç½®ä¸º0ï¼Œå¹¶ä¸”åœç•™åœ¨æœ€åˆçš„ä½ç½®ä¸Šï¼Œæ›¿æ¢è¯¥å¸§ä¸­çš„é¡µã€‚\nç”±äºè¯¥ç®—æ³•å¾ªç¯åœ°æ£€æŸ¥å„é¡µé¢çš„æƒ…å†µï¼Œæ•…ç§°ä¸º CLOCK ç®—æ³•ï¼Œåˆç§°ä¸ºæœ€è¿‘æœªç”¨( Not Recently Used, NRU )ç®—æ³•ã€‚\n  å‚è€ƒï¼š\n é¡µé¢ç½®æ¢ç®—æ³•è¯¦è§£ å¤§å‚é¢è¯•çˆ±é—®çš„ã€Œè°ƒåº¦ç®—æ³•ã€ï¼Œ20 å¼ å›¾ä¸€ä¸¾æ‹¿ä¸‹  ç£ç›˜è°ƒåº¦ç®—æ³•ğŸ’¾ ç£ç›˜çš„ç»“æ„ï¼š\nç£ç›˜è°ƒåº¦ç®—æ³•çš„ç›®çš„å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸ºäº†æé«˜ç£ç›˜çš„è®¿é—®æ€§èƒ½ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ä¼˜åŒ–ç£ç›˜çš„è®¿é—®è¯·æ±‚é¡ºåºæ¥åšåˆ°çš„ã€‚\nå¯»é“çš„æ—¶é—´æ˜¯ç£ç›˜è®¿é—®æœ€è€—æ—¶çš„éƒ¨åˆ†ï¼Œå¦‚æœè¯·æ±‚é¡ºåºä¼˜åŒ–çš„å¾—å½“ï¼Œå¿…ç„¶å¯ä»¥èŠ‚çœä¸€äº›ä¸å¿…è¦çš„å¯»é“æ—¶é—´ï¼Œä»è€Œæé«˜ç£ç›˜çš„è®¿é—®æ€§èƒ½ã€‚\nå¸¸è§çš„ç£ç›˜è°ƒåº¦ç®—æ³•ï¼š\n  å…ˆæ¥å…ˆæœåŠ¡ç®—æ³•\n  æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆç®—æ³•\n  æ‰«æç®—æ³•ç®—æ³•\n  å¾ªç¯æ‰«æç®—æ³•\nåªæœ‰ç£å¤´æœæŸä¸ªç‰¹å®šæ–¹å‘ç§»åŠ¨æ—¶ï¼Œæ‰å¤„ç†ç£é“è®¿é—®è¯·æ±‚ï¼Œè€Œè¿”å›æ—¶ç›´æ¥å¿«é€Ÿç§»åŠ¨è‡³æœ€é è¾¹ç¼˜çš„ç£é“ï¼Œä¹Ÿå°±æ˜¯å¤ä½ç£å¤´ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¾ˆå¿«çš„ï¼Œå¹¶ä¸”è¿”å›ä¸­é€”ä¸å¤„ç†ä»»ä½•è¯·æ±‚ï¼Œè¯¥ç®—æ³•çš„ç‰¹ç‚¹ï¼Œå°±æ˜¯ç£é“åªå“åº”ä¸€ä¸ªæ–¹å‘ä¸Šçš„è¯·æ±‚ã€‚\n  LOOK ä¸ C-LOOK ç®—æ³•\næˆ‘ä»¬å‰é¢è¯´åˆ°çš„æ‰«æç®—æ³•å’Œå¾ªç¯æ‰«æç®—æ³•ï¼Œéƒ½æ˜¯ç£å¤´ç§»åŠ¨åˆ°ç£ç›˜ã€Œæœ€å§‹ç«¯æˆ–æœ€æœ«ç«¯ã€æ‰å¼€å§‹è°ƒæ¢æ–¹å‘ã€‚\né‚£è¿™å…¶å®æ˜¯å¯ä»¥ä¼˜åŒ–çš„ï¼Œä¼˜åŒ–çš„æ€è·¯å°±æ˜¯ç£å¤´åœ¨ç§»åŠ¨åˆ°ã€Œæœ€è¿œçš„è¯·æ±‚ã€ä½ç½®ï¼Œç„¶åç«‹å³åå‘ç§»åŠ¨ã€‚\né‚£é’ˆå¯¹ SCAN ç®—æ³•çš„ä¼˜åŒ–åˆ™å« LOOK ç®—æ³•ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼ï¼Œç£å¤´åœ¨æ¯ä¸ªæ–¹å‘ä¸Šä»…ä»…ç§»åŠ¨åˆ°æœ€è¿œçš„è¯·æ±‚ä½ç½®ï¼Œç„¶åç«‹å³åå‘ç§»åŠ¨ï¼Œè€Œä¸éœ€è¦ç§»åŠ¨åˆ°ç£ç›˜çš„æœ€å§‹ç«¯æˆ–æœ€æœ«ç«¯ï¼Œåå‘ç§»åŠ¨çš„é€”ä¸­ä¼šå“åº”è¯·æ±‚\nè€Œé’ˆ C-SCAN ç®—æ³•çš„ä¼˜åŒ–åˆ™å« C-LOOKï¼Œå®ƒçš„å·¥ä½œæ–¹å¼ï¼Œç£å¤´åœ¨æ¯ä¸ªæ–¹å‘ä¸Šä»…ä»…ç§»åŠ¨åˆ°æœ€è¿œçš„è¯·æ±‚ä½ç½®ï¼Œç„¶åç«‹å³åå‘ç§»åŠ¨ï¼Œè€Œä¸éœ€è¦ç§»åŠ¨åˆ°ç£ç›˜çš„æœ€å§‹ç«¯æˆ–æœ€æœ«ç«¯ï¼Œåå‘ç§»åŠ¨çš„é€”ä¸­ä¸ä¼šå“åº”è¯·æ±‚ã€‚\n  å‚è€ƒï¼š\n å¤§å‚é¢è¯•çˆ±é—®çš„ã€Œè°ƒåº¦ç®—æ³•ã€ï¼Œ20 å¼ å›¾ä¸€ä¸¾æ‹¿ä¸‹  å†…å­˜åˆ†é…ç®—æ³• é¦–æ¬¡é€‚åº”ç®—æ³•ï¼ˆFirst Fitï¼‰ ä»ç©ºé—²åˆ†åŒºè¡¨çš„ç¬¬ä¸€ä¸ªè¡¨ç›®èµ·æŸ¥æ‰¾è¯¥è¡¨ï¼ŒæŠŠæœ€å…ˆèƒ½å¤Ÿæ»¡è¶³è¦æ±‚çš„ç©ºé—²åŒºåˆ†é…ç»™ä½œä¸šï¼Œè¿™ç§æ–¹æ³•çš„ç›®çš„åœ¨äºå‡å°‘æŸ¥æ‰¾æ—¶é—´ã€‚ä¸ºé€‚åº”è¿™ç§ç®—æ³•ï¼Œç©ºé—²åˆ†åŒºè¡¨ï¼ˆç©ºé—²åŒºé“¾ï¼‰ä¸­çš„ç©ºé—²åˆ†åŒºè¦æŒ‰åœ°å€ç”±ä½åˆ°é«˜è¿›è¡Œæ’åºã€‚è¯¥ç®—æ³•ä¼˜å…ˆä½¿ç”¨ä½å€éƒ¨åˆ†ç©ºé—²åŒºï¼Œåœ¨ä½å€ç©ºé—´é€ æˆè®¸å¤šå°çš„ç©ºé—²åŒºï¼Œåœ¨é«˜åœ°å€ç©ºé—´ä¿ç•™å¤§çš„ç©ºé—²åŒºã€‚\næœ€ä½³é€‚åº”ç®—æ³•ï¼ˆBest Fit) ä»å…¨éƒ¨ç©ºé—²åŒºä¸­æ‰¾å‡ºèƒ½æ»¡è¶³ä½œä¸šè¦æ±‚çš„ã€ä¸”å¤§å°æœ€å°çš„ç©ºé—²åˆ†åŒºï¼Œè¿™ç§æ–¹æ³•èƒ½ä½¿ç¢ç‰‡å°½é‡å°ã€‚ä¸ºé€‚åº”æ­¤ç®—æ³•ï¼Œç©ºé—²åˆ†åŒºè¡¨ï¼ˆç©ºé—²åŒºé“¾ï¼‰ä¸­çš„ç©ºé—²åˆ†åŒºè¦æŒ‰ä»å°åˆ°å¤§è¿›è¡Œæ’åºï¼Œè‡ªè¡¨å¤´å¼€å§‹æŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„è‡ªç”±åˆ†åŒºåˆ†é…ã€‚è¯¥ç®—æ³•ä¿ç•™å¤§çš„ç©ºé—²åŒºï¼Œä½†é€ æˆè®¸å¤šå°çš„ç©ºé—²åŒºã€‚\næœ€å·®é€‚åº”ç®—æ³•ï¼ˆWorst Fit) ä»å…¨éƒ¨ç©ºé—²åŒºä¸­æ‰¾å‡ºèƒ½æ»¡è¶³ä½œä¸šè¦æ±‚çš„ã€ä¸”å¤§å°æœ€å¤§çš„ç©ºé—²åˆ†åŒºï¼Œä»è€Œä½¿é“¾è¡¨ä¸­çš„ç»“ç‚¹å¤§å°è¶‹äºå‡åŒ€ï¼Œé€‚ç”¨äºè¯·æ±‚åˆ†é…çš„å†…å­˜å¤§å°èŒƒå›´è¾ƒçª„çš„ç³»ç»Ÿã€‚ä¸ºé€‚åº”æ­¤ç®—æ³•ï¼Œç©ºé—²åˆ†åŒºè¡¨ï¼ˆç©ºé—²åŒºé“¾ï¼‰ä¸­çš„ç©ºé—²åˆ†åŒºæŒ‰å¤§å°ä»å¤§åˆ°å°è¿›è¡Œæ’åºï¼Œè‡ªè¡¨å¤´å¼€å§‹æŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„è‡ªç”±åˆ†åŒºåˆ†é…ã€‚è¯¥ç®—æ³•ä¿ç•™å°çš„ç©ºé—²åŒºï¼Œå°½é‡å‡å°‘å°çš„ç¢ç‰‡äº§ç”Ÿã€‚\nä¼™ä¼´ç®—æ³•ï¼ˆbuddyï¼‰ ä½¿ç”¨äºŒè¿›åˆ¶ä¼˜åŒ–çš„æ€æƒ³ï¼Œå°†å†…å­˜ä»¥2çš„å¹‚ä¸ºå•ä½è¿›è¡Œåˆ†é…ï¼Œåˆå¹¶æ—¶åªèƒ½åˆå¹¶æ˜¯ä¼™ä¼´çš„å†…å­˜å—ï¼Œä¸¤ä¸ªå†…å­˜å—æ˜¯ä¼™ä¼´çš„ä¸‰ä¸ªæ¡ä»¶æ˜¯ï¼š\n1.å¤§å°ç›¸ç­‰ï¼ˆå¾ˆå¥½åˆ¤æ–­ï¼‰\n2.åœ°å€è¿ç»­ï¼ˆä¹Ÿå¾ˆå¥½åˆ¤æ–­ï¼‰\n3.ä¸¤ä¸ªå†…å­˜å—åˆ†è£‚è‡ªåŒä¸€ä¸ªçˆ¶å—ï¼ˆå…¶å®åªè¦åˆ¤æ–­ä½åœ°å€çš„å†…å­˜å—é¦–åœ°å€æ˜¯å¦æ˜¯ä¸çˆ¶å—åœ°å€å¯¹é½ï¼Œå³åˆå¹¶åçš„é¦–åœ°å€ä¸ºçˆ¶å—å¤§å°çš„æ•´æ•°å€ï¼‰ä½¿ç”¨lowbitç­‰ä½è¿ç®—å¯ä»¥o(1)åˆ¤æ–­ã€‚\nä¼™ä¼´ç®—æ³•åœ¨å®ç°çš„æ—¶å€™å¯ä»¥ä½¿ç”¨æ•°ç»„+é“¾è¡¨çš„å½¢å¼ï¼ˆæœ‰ç‚¹åƒé‚»æ¥è¡¨é‚£ç§ï¼‰ï¼Œå› ä¸ºå†…å­˜ä¸Šé™æ˜¯å›ºå®šçš„ï¼Œæ¯”è¾ƒå®¹æ˜“ç¡®å®šã€‚ä¸‹åˆ—ä»£ç ä½¿ç”¨çš„æ˜¯äºŒç»´é“¾è¡¨ï¼ˆå†™èµ·æ¥å°±æ²¡æœ‰æ•°ç»„åŠ é“¾è¡¨ç®€æ´ï¼‰ã€‚åœ¨åˆ†é…è°ƒæ•´å†…å­˜å—æ—¶ä½¿ç”¨äº†é€’å½’ï¼Œå¦‚æœéœ€è¦æé«˜æ•ˆç‡å¯ä»¥æ”¹ä¸ºå¾ªç¯ï¼ˆé€’å½’æ›´èƒ½ä½“ç°å‡ºæ€æƒ³ä¸”ä»£ç ç®€å•ï¼Œå¾ªç¯æ•ˆç‡æ›´é«˜ä½†æ˜¯å¤æ‚ä¸€ä¸¢ä¸¢ï¼Œè‡ªè¡Œé€‰å–ï¼‰ã€‚\nSlabåˆ†é…ç®—æ³• CMAç®—æ³• åº”ç”¨ç¨‹åºä¸­ç”³è¯·ä¸€å—å†…å­˜ï¼Œåœ¨åº”ç”¨ç¨‹åºçœ‹æ¥æ˜¯è¿ç»­çš„ï¼Œå› ä¸ºè™šæ‹Ÿåœ°å€æœ¬èº«æ˜¯è¿ç»­çš„ï¼Œä½†å®é™…çš„å†…å­˜ç©ºé—´ä¸­ï¼Œæ‰€ç”³è¯·çš„è¿™ç‰‡å†…å­˜æœªå¿…æ˜¯è¿ç»­çš„ï¼Œä¸è¿‡è¿™å¯¹åº”ç”¨ç¨‹åºæ¥è¯´æ˜¯æ²¡å…³ç³»çš„ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºä¸éœ€è¦å…³å¿ƒå®é™…çš„å†…å­˜æƒ…å†µï¼Œåªè¦MMUæŠŠç‰©ç†åœ°å€æ˜ å°„æˆè™šæ‹Ÿåœ°å€å°±å¥½äº†ã€‚ä½†æ˜¯å¦‚æœæ²¡æœ‰MMUçš„æƒ…å†µå‘¢ï¼Œæˆ‘ä»¬åˆéœ€è¦ä¸€ç‰‡è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œæ¯”å¦‚è®¾å¤‡é€šè¿‡DMAç›´æ¥è®¿é—®å†…å­˜ï¼Œè¿™ç§æƒ…å†µä¸‹åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\nCMAæœºåˆ¶å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šé¢æåˆ°çš„é—®é¢˜è€Œäº§ç”Ÿçš„ã€‚DMA zoneå¹¶ä¸æ˜¯DMAä¸“å±ï¼Œå…¶å®ƒçš„ç¨‹åºä¹Ÿå¯ä»¥ç”³è¯·è¯¥zoneçš„å†…å­˜ï¼Œå¦‚æœå½“è®¾å¤‡è¦ç”³è¯·DMA zoneç©ºé—´çš„ä¸€å¤§ç‰‡è¿ç»­çš„å†…å­˜æ—¶å€™ï¼Œå·²ç»æ²¡æœ‰è¿ç»­çš„å¤§ç‰‡å†…å­˜äº†ï¼Œåªæœ‰1é¡µï¼Œ2é¡µï¼Œ4é¡µçš„è¿™ç§è¿ç»­çš„å°å†…å­˜ã€‚è§£å†³åŠæ³•å°±æ˜¯æˆ‘ä»¬æ ‡è®°æŸä¸€ç‰‡è¿ç»­åŒºåŸŸä¸ºCMAåŒºåŸŸï¼Œè¿™éƒ¨åˆ†åŒºåŸŸåœ¨æ²¡æœ‰å¤§ç‰‡è¿ç»­å†…å­˜ç”³è¯·çš„æ—¶å€™åªç»™moveableçš„ç¨‹åºä½¿ç”¨ï¼Œå½“å¤§ç‰‡è¿ç»­å†…å­˜è¯·æ±‚æ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬å»è¿™ç‰‡åŒºåŸŸï¼ŒæŠŠæ‰€æœ‰moveableçš„å°ç‰‡å†…å­˜ç§»åŠ¨åˆ°å…¶å®ƒçš„éCMAåŒºåŸŸï¼Œæ›´æ”¹å¯¹åº”çš„ç¨‹åºçš„é¡µè¡¨ï¼Œç„¶åå†æŠŠç©ºå‡ºæ¥çš„CMAåŒºåŸŸç»™è®¾å¤‡ï¼Œä»è€Œå®ç°äº†DMAå¤§ç‰‡è¿ç»­å†…å­˜çš„åˆ†é…ã€‚\nCMAæœºåˆ¶å¹¶ä¸æ˜¯å•ç‹¬å­˜åœ¨çš„ï¼Œå®ƒé€šå¸¸æœåŠ¡äºDMAè®¾å¤‡ï¼Œåœ¨è®¾å¤‡è°ƒç”¨dma_alloc_coherentå‡½æ•°ç”³è¯·ä¸€å—å†…å­˜åï¼Œä¸ºäº†å¾—åˆ°ä¸€ç‰‡è¿ç»­çš„å†…å­˜ï¼ŒCMAæœºåˆ¶è¢«è°ƒç”¨ï¼Œå®ƒä¿è¯äº†ç”³è¯·çš„å†…å­˜çš„è¿ç»­æ€§ã€‚\nå¦å¤–CMAåŒºåŸŸé€šå¸¸è¢«åˆ†é…åœ¨é«˜ç«¯å†…å­˜ã€‚\nå‚è€ƒï¼š\n å†…å­˜åˆ†é…ç®—æ³•â€”â€”FFã€BFã€WFã€buddyï¼ˆä¼™ä¼´ç®—æ³•ï¼‰ Linuxå­¦ä¹ -å†…å­˜ç®¡ç†ç¯‡ï¼ˆå››ï¼‰-å†…å­˜åˆ†é…ç®—æ³•  ä¼™ä¼´ç®—æ³•å’Œslabç®—æ³• ä¼™ä¼´ç®—æ³•(Buddyåˆ†é…ç®—æ³•) ä½œç”¨\nå®ƒè¦è§£å†³çš„é—®é¢˜æ˜¯é¢‘ç¹åœ°è¯·æ±‚å’Œé‡Šæ”¾ä¸åŒå¤§å°çš„ä¸€ç»„è¿ç»­é¡µæ¡†ï¼Œå¿…ç„¶å¯¼è‡´åœ¨å·²åˆ†é…é¡µæ¡†çš„å—å†…åˆ†æ•£äº†è®¸å¤šå°å—çš„ç©ºé—²é¡µé¢ï¼Œç”±æ­¤å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œå³ä½¿æœ‰è¶³å¤Ÿçš„ç©ºé—²é¡µæ¡†å¯ä»¥æ»¡è¶³è¯·æ±‚ï¼Œä½†è¦åˆ†é…ä¸€ä¸ªå¤§å—çš„è¿ç»­é¡µæ¡†å¯èƒ½æ— æ³•æ»¡è¶³è¯·æ±‚ã€‚(è§£å†³ç¢ç‰‡é—®é¢˜)\næµç¨‹\nä¼™ä¼´ç®—æ³•ï¼ˆBuddy systemï¼‰æŠŠæ‰€æœ‰çš„ç©ºé—²é¡µæ¡†åˆ†ä¸º11ä¸ªå—é“¾è¡¨ï¼Œæ¯å—é“¾è¡¨ä¸­åˆ†å¸ƒåŒ…å«ç‰¹å®šçš„è¿ç»­é¡µæ¡†åœ°å€ç©ºé—´ï¼Œæ¯”å¦‚ç¬¬0ä¸ªå—é“¾è¡¨åŒ…å«å¤§å°ä¸º2^0ä¸ªè¿ç»­çš„é¡µæ¡†ï¼Œç¬¬1ä¸ªå—é“¾è¡¨ä¸­ï¼Œæ¯ä¸ªé“¾è¡¨å…ƒç´ åŒ…å«2ä¸ªé¡µæ¡†å¤§å°çš„è¿ç»­åœ°å€ç©ºé—´ï¼Œâ€¦.ï¼Œç¬¬10ä¸ªå—é“¾è¡¨ä¸­ï¼Œæ¯ä¸ªé“¾è¡¨å…ƒç´ ä»£è¡¨4Mçš„è¿ç»­åœ°å€ç©ºé—´ã€‚æ¯ä¸ªé“¾è¡¨ä¸­å…ƒç´ çš„ä¸ªæ•°åœ¨ç³»ç»Ÿåˆå§‹åŒ–æ—¶å†³å®šï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒåŠ¨æ€å˜åŒ–ã€‚\nä¼™ä¼´ç®—æ³•æ¯æ¬¡åªèƒ½åˆ†é…2çš„å¹‚æ¬¡é¡µçš„ç©ºé—´ï¼Œæ¯”å¦‚ä¸€æ¬¡åˆ†é…1é¡µï¼Œ2é¡µï¼Œ4é¡µï¼Œ8é¡µï¼Œâ€¦ï¼Œ1024é¡µ(2^10)ç­‰ç­‰ï¼Œæ¯é¡µå¤§å°ä¸€èˆ¬ä¸º4Kï¼Œå› æ­¤ï¼Œä¼™ä¼´ç®—æ³•æœ€å¤šä¸€æ¬¡èƒ½å¤Ÿåˆ†é…4Mçš„å†…å­˜ç©ºé—´ã€‚\nç”³è¯·å’Œå›æ”¶è¿‡ç¨‹\næ¯”å¦‚ï¼Œæˆ‘è¦åˆ†é…4(2^2)é¡µï¼ˆ16kï¼‰çš„å†…å­˜ç©ºé—´ï¼Œç®—æ³•ä¼šå…ˆä»free_area[2]ä¸­æŸ¥çœ‹nr_freeæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœæœ‰ç©ºé—²å—ï¼Œåˆ™ä»ä¸­åˆ†é…ï¼Œå¦‚æœæ²¡æœ‰ç©ºé—²å—ï¼Œå°±ä»å®ƒçš„ä¸Šä¸€çº§free_area[3]ï¼ˆæ¯å—32Kï¼‰ä¸­åˆ†é…å‡º16Kï¼Œå¹¶å°†å¤šä½™çš„å†…å­˜ï¼ˆ16Kï¼‰åŠ å…¥åˆ°free_area[2]ä¸­å»ã€‚å¦‚æœfree_area[3]ä¹Ÿæ²¡æœ‰ç©ºé—²ï¼Œåˆ™ä»æ›´ä¸Šä¸€çº§ç”³è¯·ç©ºé—´ï¼Œä¾æ¬¡é€’æ¨ï¼Œç›´åˆ°free_area[max_order]ï¼Œå¦‚æœé¡¶çº§éƒ½æ²¡æœ‰ç©ºé—´ï¼Œé‚£ä¹ˆå°±æŠ¥å‘Šåˆ†é…å¤±è´¥ã€‚\né‡Šæ”¾æ˜¯ç”³è¯·çš„é€†è¿‡ç¨‹ï¼Œå½“é‡Šæ”¾ä¸€ä¸ªå†…å­˜å—æ—¶ï¼Œå…ˆåœ¨å…¶å¯¹äºçš„free_areaé“¾è¡¨ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰ä¼™ä¼´å­˜åœ¨ï¼Œå¦‚æœæ²¡æœ‰ä¼™ä¼´å—ï¼Œç›´æ¥å°†é‡Šæ”¾çš„å—æ’å…¥é“¾è¡¨å¤´ã€‚å¦‚æœæœ‰æˆ–æ¿å—çš„å­˜åœ¨ï¼Œåˆ™å°†å…¶ä»é“¾è¡¨æ‘˜ä¸‹ï¼Œåˆå¹¶æˆä¸€ä¸ªå¤§å—ï¼Œç„¶åç»§ç»­æŸ¥æ‰¾åˆå¹¶åçš„å—åœ¨æ›´å¤§ä¸€çº§é“¾è¡¨ä¸­æ˜¯å¦æœ‰ä¼™ä¼´çš„å­˜åœ¨ï¼Œç›´è‡³ä¸èƒ½åˆå¹¶æˆ–è€…å·²ç»åˆå¹¶è‡³æœ€å¤§å—2^10ä¸ºæ­¢ã€‚\nå†…æ ¸è¯•å›¾å°†å¤§å°ä¸ºbçš„ä¸€å¯¹ç©ºé—²å—ï¼ˆä¸€ä¸ªæ˜¯ç°æœ‰ç©ºé—²é“¾è¡¨ä¸Šçš„ï¼Œä¸€ä¸ªæ˜¯å¾…å›æ”¶çš„ï¼‰ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªå¤§å°ä¸º2Bçš„å•ç‹¬å—ï¼Œå¦‚æœå®ƒæˆåŠŸåˆå¹¶æ‰€é‡Šæ”¾çš„å—ï¼Œå®ƒä¼šè¯•å›¾åˆå¹¶2bå¤§å°çš„å—ï¼Œ\nä¼™ä¼´ç®—æ³•çš„ä¼˜ç¼ºç‚¹\nä¼˜ç‚¹ï¼š\n è¾ƒå¥½çš„è§£å†³å¤–éƒ¨ç¢ç‰‡é—®é¢˜ å½“éœ€è¦åˆ†é…è‹¥å¹²ä¸ªå†…å­˜é¡µé¢æ—¶ï¼Œç”¨äºDMAçš„å†…å­˜é¡µé¢å¿…é¡»è¿ç»­ï¼Œä¼™ä¼´ç®—æ³•å¾ˆå¥½çš„æ»¡è¶³äº†è¿™ä¸ªè¦æ±‚ åªè¦è¯·æ±‚çš„å—ä¸è¶…è¿‡512ä¸ªé¡µé¢(2K)ï¼Œå†…æ ¸å°±å°½é‡åˆ†é…è¿ç»­çš„é¡µé¢ã€‚ é’ˆå¯¹å¤§å†…å­˜åˆ†é…è®¾è®¡ã€‚  ç¼ºç‚¹ï¼š\n åˆå¹¶çš„è¦æ±‚å¤ªè¿‡ä¸¥æ ¼ï¼Œåªèƒ½æ˜¯æ»¡è¶³ä¼™ä¼´å…³ç³»çš„å—æ‰èƒ½åˆå¹¶ï¼Œæ¯”å¦‚ç¬¬1å—å’Œç¬¬2å—å°±ä¸èƒ½åˆå¹¶ã€‚ ç¢ç‰‡é—®é¢˜ï¼šä¸€ä¸ªè¿ç»­çš„å†…å­˜ä¸­ä»…ä»…ä¸€ä¸ªé¡µé¢è¢«å ç”¨ï¼Œå¯¼è‡´æ•´å—å†…å­˜åŒºéƒ½ä¸å…·å¤‡åˆå¹¶çš„æ¡ä»¶(å†…éƒ¨ç¢ç‰‡é—®é¢˜) æµªè´¹é—®é¢˜ï¼šä¼™ä¼´ç®—æ³•åªèƒ½åˆ†é…2çš„å¹‚æ¬¡æ–¹å†…å­˜åŒºï¼Œå½“éœ€è¦8Kï¼ˆ2é¡µï¼‰æ—¶ï¼Œå¥½è¯´ï¼Œå½“éœ€è¦9Kæ—¶ï¼Œé‚£å°±éœ€è¦åˆ†é…16Kï¼ˆ4é¡µï¼‰çš„å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯å®é™…åªç”¨åˆ°9Kç©ºé—´ï¼Œå¤šä½™çš„7Kç©ºé—´å°±è¢«æµªè´¹æ‰ã€‚ ç®—æ³•çš„æ•ˆç‡é—®é¢˜ï¼š ä¼™ä¼´ç®—æ³•æ¶‰åŠäº†æ¯”è¾ƒå¤šçš„è®¡ç®—è¿˜æœ‰é“¾è¡¨å’Œä½å›¾çš„æ“ä½œï¼Œå¼€é”€è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œå¦‚æœæ¯æ¬¡2^nå¤§å°çš„ä¼™ä¼´å—å°±ä¼šåˆå¹¶åˆ°2^(n+1)çš„é“¾è¡¨é˜Ÿåˆ—ä¸­ï¼Œé‚£ä¹ˆ2^nå¤§å°é“¾è¡¨ä¸­çš„å—å°±ä¼šå› ä¸ºåˆå¹¶æ“ä½œè€Œå‡å°‘ï¼Œä½†ç³»ç»Ÿéšåç«‹å³æœ‰å¯èƒ½åˆæœ‰å¯¹è¯¥å¤§å°å—çš„éœ€æ±‚ï¼Œä¸ºæ­¤å¿…é¡»å†ä»2^(n+1)å¤§å°çš„é“¾è¡¨ä¸­æ‹†åˆ†ï¼Œè¿™æ ·çš„åˆå¹¶åˆç«‹å³æ‹†åˆ†çš„è¿‡ç¨‹æ˜¯æ— æ•ˆç‡çš„ã€‚  Linuxé’ˆå¯¹å¤§å†…å­˜çš„ç‰©ç†åœ°å€åˆ†é…ï¼Œé‡‡ç”¨ä¼™ä¼´ç®—æ³•ï¼Œå¦‚æœæ˜¯é’ˆå¯¹å°äºä¸€ä¸ªpageçš„å†…å­˜ï¼Œé¢‘ç¹çš„åˆ†é…å’Œé‡Šæ”¾ï¼Œæœ‰æ›´åŠ é€‚å®œçš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚slabå’Œkmem_cacheç­‰ã€‚\nSlabåˆ†é…ç®—æ³• åœ¨Linuxä¸­ï¼Œä¼™ä¼´ç³»ç»Ÿï¼ˆbuddy systemï¼‰æ˜¯ä»¥é¡µä¸ºå•ä½ç®¡ç†å’Œåˆ†é…å†…å­˜ã€‚ä½†æ˜¯ç°å®çš„éœ€æ±‚å´ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œå‡å¦‚æˆ‘ä»¬éœ€è¦ç”³è¯·20Bytesï¼Œæ€»ä¸èƒ½åˆ†é…ä¸€é¡µå§ï¼é‚£å²‚ä¸æ˜¯ä¸¥é‡æµªè´¹å†…å­˜ã€‚é‚£ä¹ˆè¯¥å¦‚ä½•åˆ†é…å‘¢ï¼Ÿslabåˆ†é…å™¨å°±åº”è¿è€Œç”Ÿäº†ï¼Œä¸“ä¸ºå°å†…å­˜åˆ†é…è€Œç”Ÿã€‚slabåˆ†é…å™¨åˆ†é…å†…å­˜ä»¥Byteä¸ºå•ä½ã€‚ä½†æ˜¯slabåˆ†é…å™¨å¹¶æ²¡æœ‰è„±ç¦»ä¼™ä¼´ç³»ç»Ÿï¼Œè€Œæ˜¯åŸºäºä¼™ä¼´ç³»ç»Ÿåˆ†é…çš„å¤§å†…å­˜è¿›ä¸€æ­¥ç»†åˆ†æˆå°å†…å­˜åˆ†é…ã€‚\nlinux æ‰€ä½¿ç”¨çš„ slab åˆ†é…å™¨çš„åŸºç¡€æ˜¯ Jeff Bonwick ä¸ºSunOS æ“ä½œç³»ç»Ÿé¦–æ¬¡å¼•å…¥çš„ä¸€ç§ç®—æ³•ã€‚Jeffçš„åˆ†é…å™¨æ˜¯å›´ç»•å¯¹è±¡ç¼“å­˜è¿›è¡Œçš„ã€‚åœ¨å†…æ ¸ä¸­ï¼Œä¼šä¸ºæœ‰é™çš„å¯¹è±¡é›†ï¼ˆä¾‹å¦‚æ–‡ä»¶æè¿°ç¬¦å’Œå…¶ä»–å¸¸è§ç»“æ„ï¼‰åˆ†é…å¤§é‡å†…å­˜ã€‚Jeffå‘ç°å¯¹å†…æ ¸ä¸­**æ™®é€šå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–æ‰€éœ€çš„æ—¶é—´è¶…è¿‡äº†å¯¹å…¶è¿›è¡Œåˆ†é…å’Œé‡Šæ”¾æ‰€éœ€çš„æ—¶é—´ã€‚å› æ­¤ä»–çš„ç»“è®ºæ˜¯ä¸åº”è¯¥å°†å†…å­˜é‡Šæ”¾å›ä¸€ä¸ªå…¨å±€çš„å†…å­˜æ± ï¼Œè€Œæ˜¯å°†å†…å­˜ä¿æŒä¸ºé’ˆå¯¹ç‰¹å®šç›®è€Œåˆå§‹åŒ–çš„çŠ¶æ€ã€‚**ä¾‹å¦‚ï¼Œå¦‚æœå†…å­˜è¢«åˆ†é…ç»™äº†ä¸€ä¸ªäº’æ–¥é”ï¼Œé‚£ä¹ˆåªéœ€åœ¨ä¸ºäº’æ–¥é”é¦–æ¬¡åˆ†é…å†…å­˜æ—¶æ‰§è¡Œä¸€æ¬¡äº’æ–¥é”åˆå§‹åŒ–å‡½æ•°ï¼ˆmutex_initï¼‰å³å¯ã€‚åç»­çš„å†…å­˜åˆ†é…ä¸éœ€è¦æ‰§è¡Œè¿™ä¸ªåˆå§‹åŒ–å‡½æ•°ï¼Œå› ä¸ºä»ä¸Šæ¬¡é‡Šæ”¾å’Œè°ƒç”¨ææ„ä¹‹åï¼Œå®ƒå·²ç»å¤„äºæ‰€éœ€çš„çŠ¶æ€ä¸­äº†ã€‚\nslabå±‚ä¸»è¦èµ·åˆ°äº†ä¸¤ä¸ªæ–¹é¢çš„ä½œç”¨ï¼š\n  slabå¯ä»¥å¯¹å°å¯¹è±¡è¿›è¡Œåˆ†é…ï¼Œè¿™æ ·å°±ä¸ç”¨ä¸ºæ¯ä¸ªå°å¯¹è±¡åˆ†é…ä¸€ä¸ªé¡µæ¡†ï¼ŒèŠ‚çœäº†ç©ºé—´ã€‚\n  å†…æ ¸ä¸­çš„ä¸€äº›å°å¯¹è±¡åˆ›å»ºææ„å¾ˆé¢‘ç¹ï¼Œslabå¯¹è¿™äº›å°å¯¹è±¡åšäº†ç¼“å­˜ï¼Œå¯ä»¥é‡å¤åˆ©ç”¨ä¸€äº›ç›¸åŒçš„å¯¹è±¡ï¼Œå‡å°‘å†…å­˜åˆ†é…æ¬¡æ•°ã€‚\n  å›¾ä¸­ç»™å‡ºäº† slabç»“æ„çš„é«˜å±‚ç»„ç»‡ç»“æ„ã€‚åœ¨æœ€é«˜å±‚æ˜¯ cache_chainï¼Œè¿™æ˜¯ä¸€ä¸ª slab ç¼“å­˜çš„é“¾æ¥åˆ—è¡¨ã€‚cache_chain çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ª kmem_cache ç»“æ„çš„å¼•ç”¨ï¼ˆç§°ä¸ºä¸€ä¸ª cacheï¼‰ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªè¦ç®¡ç†çš„ç»™å®šå¤§å°çš„å¯¹è±¡æ± ã€‚\næ¯ä¸ªç¼“å­˜éƒ½åŒ…å«äº†ä¸€ä¸ª slabs åˆ—è¡¨ï¼Œè¿™æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜å—ï¼ˆé€šå¸¸éƒ½æ˜¯é¡µé¢ï¼‰ã€‚å­˜åœ¨3 ç§ slabï¼š\nslabs_full:å®Œå…¨åˆ†é…çš„slab\nslabs_partial:éƒ¨åˆ†åˆ†é…çš„slab\nslabs_empty:ç©ºslabï¼Œæˆ–è€…æ²¡æœ‰å¯¹è±¡è¢«åˆ†é…\nslab åˆ—è¡¨ä¸­çš„æ¯ä¸ª slabéƒ½æ˜¯ä¸€ä¸ªè¿ç»­çš„å†…å­˜å—ï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªè¿ç»­é¡µï¼‰ï¼Œå®ƒä»¬è¢«åˆ’åˆ†æˆä¸€ä¸ªä¸ªå¯¹è±¡ã€‚è¿™äº›å¯¹è±¡æ˜¯ä»ç‰¹å®šç¼“å­˜ä¸­è¿›è¡Œåˆ†é…å’Œé‡Šæ”¾çš„åŸºæœ¬å…ƒç´ ã€‚æ³¨æ„ slab æ˜¯ slabåˆ†é…å™¨è¿›è¡Œæ“ä½œçš„æœ€å°åˆ†é…å•ä½ï¼Œå› æ­¤å¦‚æœéœ€è¦å¯¹ slab è¿›è¡Œæ‰©å±•ï¼Œè¿™ä¹Ÿå°±æ˜¯æ‰€æ‰©å±•çš„æœ€å°å€¼ã€‚é€šå¸¸æ¥è¯´ï¼Œæ¯ä¸ª slab è¢«åˆ†é…ä¸ºå¤šä¸ªå¯¹è±¡ã€‚\nç”±äºå¯¹è±¡æ˜¯ä» slab ä¸­è¿›è¡Œåˆ†é…å’Œé‡Šæ”¾çš„ï¼Œå› æ­¤å•ä¸ª slab å¯ä»¥åœ¨ slabåˆ—è¡¨ä¹‹é—´è¿›è¡Œç§»åŠ¨ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ª slabä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½è¢«ä½¿ç”¨å®Œæ—¶ï¼Œå°±ä»slabs_partial åˆ—è¡¨ä¸­ç§»åŠ¨åˆ° slabs_full åˆ—è¡¨ä¸­ã€‚å½“ä¸€ä¸ª slabå®Œå…¨è¢«åˆ†é…å¹¶ä¸”æœ‰å¯¹è±¡è¢«é‡Šæ”¾åï¼Œå°±ä» slabs_full åˆ—è¡¨ä¸­ç§»åŠ¨åˆ°slabs_partial åˆ—è¡¨ä¸­ã€‚å½“æ‰€æœ‰å¯¹è±¡éƒ½è¢«é‡Šæ”¾ä¹‹åï¼Œå°±ä» slabs_partial åˆ—è¡¨ç§»åŠ¨åˆ° slabs_empty åˆ—è¡¨ä¸­ã€‚\nslabèƒŒåçš„åŠ¨æœº\nâ€‹\tä¸ä¼ ç»Ÿçš„å†…å­˜ç®¡ç†æ¨¡å¼ç›¸æ¯”ï¼Œ slabç¼“å­˜åˆ†é…å™¨æä¾›äº†å¾ˆå¤šä¼˜ç‚¹ã€‚é¦–å…ˆï¼Œå†…æ ¸é€šå¸¸ä¾èµ–äºå¯¹å°å¯¹è±¡çš„åˆ†é…ï¼Œå®ƒä»¬ä¼šåœ¨ç³»ç»Ÿç”Ÿå‘½å‘¨æœŸå†…è¿›è¡Œæ— æ•°æ¬¡åˆ†é…ã€‚slabç¼“å­˜åˆ†é…å™¨é€šè¿‡å¯¹ç±»ä¼¼å¤§å°çš„å¯¹è±¡è¿›è¡Œç¼“å­˜è€Œæä¾›è¿™ç§åŠŸèƒ½ï¼Œä»è€Œé¿å…äº†å¸¸è§çš„ç¢ç‰‡é—®é¢˜ã€‚slabåˆ†é…å™¨è¿˜æ”¯æŒé€šç”¨å¯¹è±¡çš„åˆå§‹åŒ–ï¼Œä»è€Œé¿å…äº†ä¸ºåŒä¸€ç›®è€Œå¯¹ä¸€ä¸ªå¯¹è±¡é‡å¤è¿›è¡Œåˆå§‹åŒ–ã€‚\nslabæè¿°ç¬¦\næ—¢ç„¶æ˜¯å¯¹å¯¹è±¡è¿›è¡Œç®¡ç†ï¼Œé‚£ä¹ˆå°±æœ‰ä¸€ä¸ªå†…å­˜çš„æŒ‡é’ˆæŒ‡å‘å®ƒæ‰€ç®¡ç†çš„å¯¹è±¡ï¼švoid* s_memã€‚å¹¶ä¸”å®ƒè¿˜éœ€è¦è®°å½•å“ªäº›å¯¹è±¡è¢«ä½¿ç”¨äº†ï¼Œå“ªäº›æ˜¯ç©ºé—²çš„ã€‚è¿™æ—¶å°±éœ€è¦æœ‰ä¸€ä¸ªæ•°ç»„è®°å½•è¿™ä¸ªä¸œè¥¿ï¼Œè¿™å°±æ˜¯freeå˜é‡ã€‚ä½ å¯èƒ½ä¼šå¥‡æ€ªå®ƒçš„ç±»å‹æ˜¯ä¸€ä¸ªunsigned intï¼š\nå®ƒæ˜¯å¦‚ä½•è®°å½•è¿™ä¸ªæ•°ç»„çš„å‘¢ï¼Ÿäº‹å®ä¸Šæ˜¯è®°å½•åœ¨slabæè¿°ç¬¦åé¢çš„æ•°ç»„ä¸­ï¼Œè¿™ä¸ªæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è®°å½•ç€ä¸‹ä¸€ä¸ªç©ºé—²çš„å†…å­˜å¯¹è±¡çš„ä½ç½®ã€‚è€Œfreeè®°å½•çš„å°±æ˜¯ç¬¬ä¸€ä¸ªç©ºé—²çš„å¯¹è±¡ã€‚è¿™æ ·å°±å¯ä»¥ä»freeå¼€å§‹éå†æ‰€æœ‰ç©ºé—²çš„å¯¹è±¡ã€‚\nä¸‹å›¾æ˜¾ç¤ºäº†slabå¯¹è±¡çš„å†…å­˜åˆ†å¸ƒï¼Œè¿™é‡Œéœ€è¦è§£é‡Šä¸€ä¸‹çš„æ˜¯slab descriptorä¼šæ ¹æ®æƒ…å†µè¢«å­˜æ”¾åœ¨å½“å‰slabçš„å†…å­˜ä¸­æˆ–è€…å­˜æ”¾åœ¨é€šç”¨çš„é«˜é€Ÿç¼“å­˜ä¸­ã€‚\nSlabä¸Buddyçš„å…³ç³»  slabä¸Buddyéƒ½æ˜¯å†…å­˜åˆ†é…å™¨ã€‚ slabçš„å†…å­˜æ¥è‡ªBuddy slabä¸Buddyåœ¨ç®—æ³•ä¸Šçº§åˆ«å¯¹ç­‰ã€‚BuddyæŠŠå†…å­˜æ¡å½“ä½œä¸€ä¸ªæ± å­æ¥ç®¡ç†ï¼Œslabæ˜¯æŠŠä»Buddyæ‹¿ åˆ°çš„å†…å­˜å½“ä½œä¸€ä¸ªæ± å­æ¥ç®¡ç†çš„  å‚è€ƒé“¾æ¥ï¼š\n Linux ä¼™ä¼´ç®—æ³•ç®€ä»‹ ä¼™ä¼´ç®—æ³•ä¸slabç®—æ³•  mmapå’Œbrkçš„åŒºåˆ« ä»æ“ä½œç³»ç»Ÿè§’åº¦æ¥çœ‹ï¼Œè¿›ç¨‹åˆ†é…å†…å­˜æœ‰ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«ç”±ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨å®Œæˆï¼šbrkå’Œmmapï¼ˆä¸è€ƒè™‘å…±äº«å†…å­˜ï¼‰ã€‚\n brkæ˜¯å°†æ•°æ®æ®µ(.data)çš„æœ€é«˜åœ°å€æŒ‡é’ˆ_edataå¾€é«˜åœ°å€æ¨ï¼›\nè¿™æ˜¯ brk çš„å†…å­˜åˆ†é…æ–¹å¼ï¼Œå¯ä»¥çœ‹åˆ°Aã€Bæ–°ç”³è¯·çš„å†…å­˜éƒ½ä»å †çš„åº•éƒ¨ï¼ˆå †çš„åœ°å€ç”Ÿé•¿æ˜¯ä»ä½åˆ°é«˜çš„ï¼‰å¼€å§‹å‘ä¸Šç”Ÿé•¿ã€‚\nå¦‚æœæ­¤æ—¶ free(A)ï¼ŒAçš„å†…å­˜å¹¶ä¸ä¼šè¢«é‡Šæ”¾ï¼Œè€Œæ˜¯ä¼šè¢«å›æ”¶ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡çš„åˆ©ç”¨ï¼Œæˆ–è€…è¯´æ˜¯ç­‰å¾…Bçš„å›æ”¶ã€‚\n mmapæ˜¯åœ¨è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ï¼ˆå †å’Œæ ˆä¸­é—´ï¼Œç§°ä¸ºæ–‡ä»¶æ˜ å°„åŒºåŸŸçš„åœ°æ–¹ï¼‰æ‰¾ä¸€å—ç©ºé—²çš„è™šæ‹Ÿå†…å­˜ã€‚\nmmapç›´æ¥ä»å †å’Œæ ˆä¹‹é—´çš„åŒºåŸŸå–å‡ºäº†ä¸€å—åŒºåŸŸï¼Œå½“å›æ”¶è¿™å—å†…å­˜æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¹Ÿä¼šç›´æ¥å°†è¿™å—å†…å­˜é‡Šæ”¾ã€‚\nä½†æ˜¯ç³»ç»Ÿè°ƒç”¨å’Œç¼ºé¡µä¸­æ–­æ¯”è¾ƒæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œä¸ºäº†CPUçš„æ‰§è¡Œæ•ˆç‡ï¼Œmallocåªåœ¨ç”³è¯·çš„å†…å­˜å¤§äº128Kæ—¶æ‰ä¼šè°ƒç”¨mmapè¿›è¡Œåˆ†é…å†…å­˜ã€‚\n  å¦‚æœå°† brk æ¯”å–»ä¸ºæ‰¹å‘çš„è¯ï¼Œé‚£ä¹ˆ mmap å°±æ˜¯é›¶å”®ã€‚\nè¿™ä¸¤ç§æ–¹å¼åˆ†é…çš„éƒ½æ˜¯è™šæ‹Ÿå†…å­˜ï¼Œæ²¡æœ‰åˆ†é…ç‰©ç†å†…å­˜ã€‚åœ¨ç¬¬ä¸€æ¬¡è®¿é—®å·²åˆ†é…çš„è™šæ‹Ÿåœ°å€ç©ºé—´çš„æ—¶å€™ï¼Œå‘ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£åˆ†é…ç‰©ç†å†…å­˜ï¼Œç„¶åå»ºç«‹è™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚\nå‚è€ƒï¼š\n æ“ä½œç³»ç»Ÿä¸­ brk å’Œ mmap çš„åŒºåˆ« linuxä¸‹brkã€mmapã€mallocå’Œnewçš„åŒºåˆ« è¿›ç¨‹åˆ†é…å†…å­˜çš„ä¸¤ç§æ–¹å¼\u0026ndash;brk() å’Œmmap()ï¼ˆä¸è®¾è®¡å…±äº«å†…å­˜ï¼‰  å¦‚ä½•æŸ¥çœ‹ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼Ÿ   ä½¿ç”¨netstat:\n1  netstat anp | grep 80     ä½¿ç”¨lsof:\n1  lsof -i:80     Linuxçš„forkå®ç° forkçš„ç®€å•ä¾‹å­å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  #include \u0026lt;unistd.h\u0026gt;#include \u0026lt;stdio.h\u0026gt; int main() { int pid = fork(); if (pid == -1) return -1; if (pid) { printf(\u0026#34;I am father, my pid is %d\\n\u0026#34;, getpid()); return 0; } else { printf(\u0026#34;I am child, my pid is %d\\n\u0026#34;, getpid()); return 0; } }   I am father, my pid is 466 I am child, my pid is 469 çœ‹åˆ°è¿™ä¸ªç»“æœæ˜¯ä¸æ˜¯å¾ˆå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆifçš„åˆ†æ”¯æ‰§è¡Œåˆ°äº†ï¼Œelseçš„åˆ†æ”¯ä¹Ÿæ‰§è¡Œåˆ°äº†â“\nå¯¹äºå‡½æ•°åŸå‹pid_t fork();ï¼Œå®ƒæœ‰ä¸‰ä¸ªè¿”å›å€¼\n è¯¥è¿›ç¨‹ä¸ºçˆ¶è¿›ç¨‹æ—¶ï¼Œè¿”å›å­è¿›ç¨‹çš„pid è¯¥è¿›ç¨‹ä¸ºå­è¿›ç¨‹æ—¶ï¼Œè¿”å› forkæ‰§è¡Œå¤±è´¥ï¼Œè¿”å›-1  forkå®ƒæ˜¯å¦‚ä½•çŸ¥é“ä¸€ä¸ªè¿›ç¨‹æ˜¯çˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹çš„â“\nforkæœ¬èº«çš„åŠŸèƒ½æ˜¯å…‹éš†è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯å°†åŸå…ˆçš„ä¸€ä¸ªè¿›ç¨‹å†å…‹éš†å‡ºä¸€ä¸ªæ¥ï¼Œå…‹éš†å‡ºçš„è¿™ä¸ªè¿›ç¨‹å°±æ˜¯åŸè¿›ç¨‹çš„å­è¿›ç¨‹ï¼Œè¿™ä¸ªå­è¿›ç¨‹å’Œå…¶ä»–çš„è¿›ç¨‹æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŒåŒæ ·æ‹¥æœ‰è‡ªå·±çš„ç‹¬ç«‹çš„åœ°å€ç©ºé—´ã€‚ä¸åŒçš„æ˜¯å­è¿›ç¨‹æ˜¯åœ¨forkè¿”å›ä¹‹åæ‰å¼€å§‹æ‰§è¡Œçš„ï¼Œå°±åƒä¸€æŠŠå‰å­ä¸€æ ·ï¼Œæ‰§è¡Œforkä¹‹åï¼Œçˆ¶å­è¿›ç¨‹å°±åˆ†é“æ‰¬é•³äº†ï¼Œæ‰€ä»¥forkè¿™ä¸ªåå­—å°±å¾ˆå½¢è±¡\nforkæœ¬è´¨(ä¸¤ä¸ªè¿›ç¨‹+æ—¶é—´ç‰‡è½®è½¬)\nforkåœ¨æ‰§è¡Œä¹‹åï¼Œä¼šåˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œè¿™ä¸ªæ–°çš„è¿›ç¨‹å†…éƒ¨çš„æ•°æ®æ˜¯åŸè¿›ç¨‹æ‰€æœ‰æ•°æ®çš„ä¸€ä»½æ‹·è´ã€‚å› æ­¤forkå°±ç›¸å½“äºæŠŠæŸä¸ªè¿›ç¨‹çš„å…¨éƒ¨èµ„æºå¤åˆ¶äº†ä¸€éï¼Œç„¶åè®©csï¼šeipæŒ‡å‘æ–°è¿›ç¨‹çš„æŒ‡ä»¤éƒ¨åˆ†ã€‚\nforkç»™çˆ¶è¿›ç¨‹è¿”å›å­è¿›ç¨‹pidï¼Œç»™å…¶æ‹·è´å‡ºæ¥çš„å­è¿›ç¨‹è¿”å›0ï¼Œè¿™ä¹Ÿæ˜¯ä»–çš„ç‰¹ç‚¹ä¹‹ä¸€ï¼Œä¸€æ¬¡è°ƒç”¨ï¼Œä¸¤æ¬¡è¿”å›ã€‚ä¸¤æ¬¡è¿”å›çœ‹ä¸Šå»æœ‰ç‚¹ç¥ç§˜ï¼Œå®è´¨æ˜¯åœ¨å­è¿›ç¨‹çš„æ ˆä¸­æ„é€ å¥½æ•°æ®åï¼Œå­è¿›ç¨‹ä»æ ˆä¸­è·å–åˆ°çš„è¿”å›å€¼ã€‚\nforkçš„å®ç°åˆ†ä¸ºä»¥ä¸‹ä¸¤æ­¥\n å¤åˆ¶è¿›ç¨‹èµ„æº æ‰§è¡Œè¯¥è¿›ç¨‹  å¤åˆ¶è¿›ç¨‹çš„èµ„æºåŒ…æ‹¬ä»¥ä¸‹å‡ æ­¥\n è¿›ç¨‹pcb ç¨‹åºä½“ï¼Œå³ä»£ç æ®µæ•°æ®æ®µç­‰ ç”¨æˆ·æ ˆ å†…æ ¸æ ˆ è™šæ‹Ÿå†…å­˜æ±  é¡µè¡¨  è¿›è¡Œè¿›ç¨‹çš„è¯å°±æ¯”è¾ƒç®€å•äº†ï¼Œåªéœ€è¦å°†å…¶åŠ å…¥åˆ°å°±ç»ªé˜Ÿåˆ—å³å¯ï¼Œæ¥ä¸‹æ¥å°±ç­‰å¾…cpuçš„è°ƒåº¦äº†ã€‚\n1  pid=fork();   æ“ä½œç³»ç»Ÿåˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹(å­è¿›ç¨‹)ï¼Œå¹¶ä¸”åœ¨è¿›ç¨‹è¡¨ä¸­ç›¸åº”ä¸ºå®ƒå»ºç«‹ä¸€ä¸ªæ–°çš„è¡¨é¡¹ã€‚æ–°è¿›ç¨‹å’ŒåŸæœ‰è¿›ç¨‹çš„å¯æ‰§è¡Œç¨‹åºæ˜¯åŒä¸€ä¸ªç¨‹åºï¼›ä¸Šä¸‹æ–‡å’Œæ•°æ®ï¼Œç»å¤§éƒ¨åˆ†å°±æ˜¯åŸè¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹ï¼‰çš„æ‹·è´ï¼Œä½†å®ƒä»¬æ˜¯ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„è¿›ç¨‹!æ­¤æ—¶ç¨‹åºå¯„å­˜å™¨pcï¼Œåœ¨çˆ¶ã€å­è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­éƒ½å£°ç§°ï¼Œè¿™ä¸ªè¿›ç¨‹ç›®å‰æ‰§è¡Œåˆ°forkè°ƒç”¨å³å°†è¿”å›(æ­¤æ—¶å­è¿›ç¨‹ä¸å æœ‰CPUï¼Œå­è¿›ç¨‹çš„pcä¸æ˜¯çœŸæ­£ä¿å­˜åœ¨å¯„å­˜å™¨ä¸­ï¼Œè€Œæ˜¯ä½œä¸ºè¿›ç¨‹ä¸Šä¸‹æ–‡ä¿å­˜åœ¨è¿›ç¨‹è¡¨ä¸­çš„å¯¹åº”è¡¨é¡¹å†…)ã€‚é—®é¢˜æ˜¯æ€ä¹ˆè¿”å›ï¼Œåœ¨çˆ¶å­è¿›ç¨‹ä¸­å°±åˆ†é“æ‰¬é•³ã€‚\nçˆ¶è¿›ç¨‹ç»§ç»­æ‰§è¡Œï¼Œæ“ä½œç³»ç»Ÿå¯¹forkçš„å®ç°ï¼Œä½¿è¿™ä¸ªè°ƒç”¨åœ¨çˆ¶è¿›ç¨‹ä¸­è¿”å›åˆšåˆšåˆ›å»ºçš„å­è¿›ç¨‹çš„pid(ä¸€ä¸ªæ­£æ•´æ•°)ï¼Œæ‰€ä»¥ä¸‹é¢çš„ifè¯­å¥ä¸­pid\u0026lt;0, pid==0çš„ä¸¤ä¸ªåˆ†æ”¯éƒ½ä¸ä¼šæ‰§è¡Œã€‚\nå­è¿›ç¨‹åœ¨ä¹‹åçš„æŸä¸ªæ—¶å€™å¾—åˆ°è°ƒåº¦ï¼Œå®ƒçš„ä¸Šä¸‹æ–‡è¢«æ¢å…¥ï¼Œå æ® CPUï¼Œæ“ä½œç³»ç»Ÿå¯¹forkçš„å®ç°ï¼Œä½¿å¾—å­è¿›ç¨‹ä¸­forkè°ƒç”¨è¿”å›0ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªè¿›ç¨‹ï¼ˆæ³¨æ„è¿™ä¸æ˜¯çˆ¶è¿›ç¨‹äº†ï¼Œè™½ç„¶æ˜¯åŒä¸€ä¸ªç¨‹åºï¼Œä½†æ˜¯è¿™æ˜¯åŒä¸€ä¸ªç¨‹åºçš„å¦å¤–ä¸€æ¬¡æ‰§è¡Œï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­è¿™æ¬¡æ‰§è¡Œæ˜¯ç”±å¦å¤–ä¸€ä¸ªè¿›ç¨‹è¡¨ç¤ºçš„ï¼Œä»æ‰§è¡Œçš„è§’åº¦è¯´å’Œçˆ¶è¿›ç¨‹ç›¸äº’ç‹¬ç«‹ï¼‰ä¸­pid=0ã€‚è¿™ä¸ªè¿›ç¨‹ç»§ç»­æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œifè¯­å¥ä¸­ pid\u0026lt;0ä¸æ»¡è¶³ï¼Œä½†æ˜¯pid==0æ˜¯trueã€‚\nç›¸å…³ä»£ç \nå°†çˆ¶è¿›ç¨‹çš„pcbã€è™šæ‹Ÿåœ°å€ä½å›¾æ‹·è´ç»™å­è¿›ç¨‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  static int32_t copy_pcb_vaddrbitmap_stack0(task_struct *child_thread, task_struct *parent_thread) { /* a å¤åˆ¶pcbæ‰€åœ¨çš„æ•´ä¸ªé¡µ,é‡Œé¢åŒ…å«è¿›ç¨‹pcbä¿¡æ¯åŠç‰¹çº§0æçš„æ ˆ,é‡Œé¢åŒ…å«äº†è¿”å›åœ°å€, ç„¶åå†å•ç‹¬ä¿®æ”¹ä¸ªåˆ«éƒ¨åˆ† */ memcpy(child_thread, parent_thread, PG_SIZE); child_thread-\u0026gt;pid = fork_pid(); child_thread-\u0026gt;elapsed_ticks = 0; child_thread-\u0026gt;status = TASK_READY; child_thread-\u0026gt;ticks = child_thread-\u0026gt;priority; // ä¸ºæ–°è¿›ç¨‹æŠŠæ—¶é—´ç‰‡å……æ»¡  child_thread-\u0026gt;parent_pid = parent_thread-\u0026gt;pid; child_thread-\u0026gt;general_tag.prev = child_thread-\u0026gt;general_tag.next = NULL; child_thread-\u0026gt;all_list_tag.prev = child_thread-\u0026gt;all_list_tag.next = NULL; block_desc_init(child_thread-\u0026gt;u_block_desc); /* b å¤åˆ¶çˆ¶è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€æ± çš„ä½å›¾ */ uint32_t bitmap_pg_cnt = DIV_ROUND_UP((0xc0000000 - USER_VADDR_START) / PG_SIZE / 8, PG_SIZE); void *vaddr_btmp = get_kernel_pages(bitmap_pg_cnt); if (vaddr_btmp == NULL) return -1; /* æ­¤æ—¶child_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.bitsè¿˜æ˜¯æŒ‡å‘çˆ¶è¿›ç¨‹è™šæ‹Ÿåœ°å€çš„ä½å›¾åœ°å€ * ä¸‹é¢å°†child_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.bitsæŒ‡å‘è‡ªå·±çš„ä½å›¾vaddr_btmp */ memcpy(vaddr_btmp, child_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.bits, bitmap_pg_cnt * PG_SIZE); child_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.bits = vaddr_btmp; ASSERT(strlen(child_thread-\u0026gt;name) \u0026lt; 11); // pcb.nameçš„é•¿åº¦æ˜¯16,ä¸ºé¿å…ä¸‹é¢strcatè¶Šç•Œ  strcat(child_thread-\u0026gt;name, \u0026#34;_fork\u0026#34;); return 0; }   å¤åˆ¶å­è¿›ç¨‹çš„è¿›ç¨‹ä½“(ä»£ç å’Œæ•°æ®)åŠç”¨æˆ·æ ˆ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  static void copy_body_stack3(task_struct *child_thread, task_struct *parent_thread, void *buf_page) { uint8_t *vaddr_btmp = parent_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.bits; uint32_t btmp_bytes_len = parent_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.btmp_bytes_len; uint32_t vaddr_start = parent_thread-\u0026gt;userprog_vaddr.vaddr_start; uint32_t idx_byte = 0; uint32_t idx_bit = 0; uint32_t prog_vaddr = 0; /* åœ¨çˆ¶è¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´ä¸­æŸ¥æ‰¾å·²æœ‰æ•°æ®çš„é¡µ */ while (idx_byte \u0026lt; btmp_bytes_len) { if (vaddr_btmp[idx_byte]) { idx_bit = 0; while (idx_bit \u0026lt; 8) { if ((BITMAP_MASK \u0026lt;\u0026lt; idx_bit) \u0026amp; vaddr_btmp[idx_byte]) { prog_vaddr = (idx_byte * 8 + idx_bit) * PG_SIZE + vaddr_start; /* ä¸‹é¢çš„æ“ä½œæ˜¯å°†çˆ¶è¿›ç¨‹ç”¨æˆ·ç©ºé—´ä¸­çš„æ•°æ®é€šè¿‡å†…æ ¸ç©ºé—´åšä¸­è½¬,æœ€ç»ˆå¤åˆ¶åˆ°å­è¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´ */ /* a å°†çˆ¶è¿›ç¨‹åœ¨ç”¨æˆ·ç©ºé—´ä¸­çš„æ•°æ®å¤åˆ¶åˆ°å†…æ ¸ç¼“å†²åŒºbuf_page, ç›®çš„æ˜¯ä¸‹é¢åˆ‡æ¢åˆ°å­è¿›ç¨‹çš„é¡µè¡¨å,è¿˜èƒ½è®¿é—®åˆ°çˆ¶è¿›ç¨‹çš„æ•°æ®*/ memcpy(buf_page, (void *)prog_vaddr, PG_SIZE); /* b å°†é¡µè¡¨åˆ‡æ¢åˆ°å­è¿›ç¨‹,ç›®çš„æ˜¯é¿å…ä¸‹é¢ç”³è¯·å†…å­˜çš„å‡½æ•°å°†pteåŠpdeå®‰è£…åœ¨çˆ¶è¿›ç¨‹çš„é¡µè¡¨ä¸­ */ page_dir_activate(child_thread); /* c ç”³è¯·è™šæ‹Ÿåœ°å€prog_vaddr */ get_a_page_without_opvaddrbitmap(PF_USER, prog_vaddr); /* d ä»å†…æ ¸ç¼“å†²åŒºä¸­å°†çˆ¶è¿›ç¨‹æ•°æ®å¤åˆ¶åˆ°å­è¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´ */ memcpy((void *)prog_vaddr, buf_page, PG_SIZE); /* e æ¢å¤çˆ¶è¿›ç¨‹é¡µè¡¨ */ page_dir_activate(parent_thread); } idx_bit++; } } idx_byte++; } }   ä¸ºå­è¿›ç¨‹æ„å»ºthread_stackå’Œä¿®æ”¹è¿”å›å€¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  static int32_t build_child_stack(task_struct *child_thread) { /* a ä½¿å­è¿›ç¨‹pidè¿”å›å€¼ä¸º0 */ /* è·å–å­è¿›ç¨‹0çº§æ ˆæ ˆé¡¶ */ intr_stack *intr_0_stack = (intr_stack *)((uint32_t)child_thread + PG_SIZE - sizeof(intr_stack)); /* ä¿®æ”¹å­è¿›ç¨‹çš„è¿”å›å€¼ä¸º0 */ intr_0_stack-\u0026gt;eax = 0; /* b ä¸ºswitch_to æ„å»º struct thread_stack,å°†å…¶æ„å»ºåœ¨ç´§ä¸´intr_stackä¹‹ä¸‹çš„ç©ºé—´*/ uint32_t *ret_addr_in_thread_stack = (uint32_t *)intr_0_stack - 1; /* ebpåœ¨thread_stackä¸­çš„åœ°å€ä¾¿æ˜¯å½“æ—¶çš„esp(0çº§æ ˆçš„æ ˆé¡¶), å³espä¸º\u0026#34;(uint32_t*)intr_0_stack - 5\u0026#34; */ uint32_t *ebp_ptr_in_thread_stack = (uint32_t *)intr_0_stack - 5; /* switch_toçš„è¿”å›åœ°å€æ›´æ–°ä¸ºintr_exit,ç›´æ¥ä»ä¸­æ–­è¿”å› */ *ret_addr_in_thread_stack = (uint32_t)intr_exit; /* æŠŠæ„å»ºçš„thread_stackçš„æ ˆé¡¶åšä¸ºswitch_toæ¢å¤æ•°æ®æ—¶çš„æ ˆé¡¶ */ child_thread-\u0026gt;self_kstack = ebp_ptr_in_thread_stack; return 0; }   æ‹·è´çˆ¶è¿›ç¨‹æœ¬èº«æ‰€å èµ„æºç»™å­è¿›ç¨‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  static int32_t copy_process(task_struct *child_thread, task_struct *parent_thread) { /* å†…æ ¸ç¼“å†²åŒº,ä½œä¸ºçˆ¶è¿›ç¨‹ç”¨æˆ·ç©ºé—´çš„æ•°æ®å¤åˆ¶åˆ°å­è¿›ç¨‹ç”¨æˆ·ç©ºé—´çš„ä¸­è½¬ */ void *buf_page = get_kernel_pages(1); if (buf_page == NULL) { return -1; } /* a å¤åˆ¶çˆ¶è¿›ç¨‹çš„pcbã€è™šæ‹Ÿåœ°å€ä½å›¾ã€å†…æ ¸æ ˆåˆ°å­è¿›ç¨‹ */ if (copy_pcb_vaddrbitmap_stack0(child_thread, parent_thread) == -1) { return -1; } /* b ä¸ºå­è¿›ç¨‹åˆ›å»ºé¡µè¡¨,æ­¤é¡µè¡¨ä»…åŒ…æ‹¬å†…æ ¸ç©ºé—´ */ child_thread-\u0026gt;pgdir = create_page_dir(); if (child_thread-\u0026gt;pgdir == NULL) { return -1; } /* c å¤åˆ¶çˆ¶è¿›ç¨‹è¿›ç¨‹ä½“åŠç”¨æˆ·æ ˆç»™å­è¿›ç¨‹ */ copy_body_stack3(child_thread, parent_thread, buf_page); /* d æ„å»ºå­è¿›ç¨‹thread_stackå’Œä¿®æ”¹è¿”å›å€¼pid */ build_child_stack(child_thread); /* e æ›´æ–°æ–‡ä»¶inodeçš„æ‰“å¼€æ•° */ update_inode_open_cnts(child_thread); mfree_page(PF_KERNEL, buf_page, 1); return 0; }   ä¸»ç³»ç»ŸAPIè°ƒç”¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  /* forkå­è¿›ç¨‹,å†…æ ¸çº¿ç¨‹ä¸å¯ç›´æ¥è°ƒç”¨ */ pid_t sys_fork(void) { task_struct *parent_thread = running_thread(); task_struct *child_thread = get_kernel_pages(1); // ä¸ºå­è¿›ç¨‹åˆ›å»ºpcb(task_structç»“æ„)  if (child_thread == NULL) { return -1; } ASSERT(INTR_OFF == intr_get_status() \u0026amp;\u0026amp; parent_thread-\u0026gt;pgdir != NULL); if (copy_process(child_thread, parent_thread) == -1) { return -1; } /* æ·»åŠ åˆ°å°±ç»ªçº¿ç¨‹é˜Ÿåˆ—å’Œæ‰€æœ‰çº¿ç¨‹é˜Ÿåˆ—,å­è¿›ç¨‹ç”±è°ƒè¯•å™¨å®‰æ’è¿è¡Œ */ ASSERT(!elem_find(\u0026amp;thread_ready_list, \u0026amp;child_thread-\u0026gt;general_tag)); list_append(\u0026amp;thread_ready_list, \u0026amp;child_thread-\u0026gt;general_tag); ASSERT(!elem_find(\u0026amp;thread_all_list, \u0026amp;child_thread-\u0026gt;all_list_tag)); list_append(\u0026amp;thread_all_list, \u0026amp;child_thread-\u0026gt;all_list_tag); return child_thread-\u0026gt;pid; // çˆ¶è¿›ç¨‹è¿”å›å­è¿›ç¨‹çš„pid }   å‚è€ƒï¼š\n åä¹. forkçš„åŸç†åŠå®ç° forkè¿›ç¨‹çš„è¿‡ç¨‹  MallocåŸç†ğŸš´  å†…å­˜ç®¡ç†æ¨¡å—ä¸­æ˜¯é€šè¿‡bitmapå¯¹å†…å­˜è¿›è¡Œç®¡ç†çš„ï¼Œbitmapä¸­çš„æ¯ä¸€ä¸ªbitä½å°±ä»£è¡¨ä¸€é¡µå¤§å°çš„å†…å­˜ï¼Œè¯¥ä½ä¸º1æ—¶è¡¨ç¤ºè¿™é¡µå·²ç»åˆ†é…å‡ºå»äº†ã€‚é‚£ä¹ˆå¯¹å°å—å†…å­˜è¿›è¡Œåˆ†é…çš„æ—¶å€™ï¼ŒåŒæ ·éœ€è¦ä¸€ä¸ªç»“æ„æ¥è®°å½•è¿™å—å†…å­˜çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦é€šè¿‡ä¸€ç§ç»“æ„æ¥å¯¹å†…å­˜çš„åˆ†é…ä¸é‡Šæ”¾è¿›è¡Œç®¡ç†ã€‚\n ä»»ä½•å®é™…çš„åˆ†é…å™¨éƒ½éœ€è¦ä¸€äº›æ•°æ®ç»“æ„ï¼Œå…è®¸å®ƒæ¥åŒºåˆ«å—è¾¹ç•Œï¼Œä»¥åŠåŒºåˆ«å·²åˆ†é…å—å’Œç©ºé—²å— ã€‚å¤§å¤šæ•°åˆ†é…å™¨å°†è¿™äº›ä¿¡æ¯åµŒäººå—æœ¬èº«ã€‚ä¸€ä¸ªç®€å•çš„ç»“æ„å¦‚ä¸‹ï¼š\nLinuxè¿›ç¨‹å †ç®¡ç† Linuxç»´æŠ¤ä¸€ä¸ªbreakæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å †ç©ºé—´çš„æŸä¸ªåœ°å€ã€‚ä»å †èµ·å§‹åœ°å€åˆ°breakä¹‹é—´çš„åœ°å€ç©ºé—´ä¸ºæ˜ å°„å¥½çš„ï¼Œå¯ä»¥ä¾›è¿›ç¨‹è®¿é—®ï¼›è€Œä»breakå¾€ä¸Šï¼Œæ˜¯æœªæ˜ å°„çš„åœ°å€ç©ºé—´ï¼Œå¦‚æœè®¿é—®è¿™æ®µç©ºé—´åˆ™ç¨‹åºä¼šæŠ¥é”™ã€‚\nbrkä¸sbrk è¦å¢åŠ ä¸€ä¸ªè¿›ç¨‹å®é™…çš„å¯ç”¨å †å¤§å°ï¼Œå°±éœ€è¦å°†breakæŒ‡é’ˆå‘é«˜åœ°å€ç§»åŠ¨ã€‚Linuxé€šè¿‡brkå’Œsbrkç³»ç»Ÿè°ƒç”¨æ“ä½œbreakæŒ‡é’ˆã€‚ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨çš„åŸå‹å¦‚ä¸‹ï¼š\n1 2  int brk(void *addr); void *sbrk(intptr_t increment);   brkå°†breakæŒ‡é’ˆç›´æ¥è®¾ç½®ä¸ºæŸä¸ªåœ°å€ï¼Œè€Œsbrkå°†breakä»å½“å‰ä½ç½®ç§»åŠ¨incrementæ‰€æŒ‡å®šçš„å¢é‡ã€‚brkåœ¨æ‰§è¡ŒæˆåŠŸæ—¶è¿”å›0ï¼Œå¦åˆ™è¿”å›-1å¹¶è®¾ç½®errnoä¸ºENOMEMï¼›sbrkæˆåŠŸæ—¶è¿”å›breakç§»åŠ¨ä¹‹å‰æ‰€æŒ‡å‘çš„åœ°å€ï¼Œå¦åˆ™è¿”å›(void *)-1ã€‚\nä¸€ä¸ªå°æŠ€å·§æ˜¯ï¼Œå¦‚æœå°†incrementè®¾ç½®ä¸º0ï¼Œåˆ™å¯ä»¥è·å¾—å½“å‰breakçš„åœ°å€ã€‚\nç®€å•å®ç°malloc 1 2 3 4 5 6 7 8 9 10 11  /* ä¸€ä¸ªç©å…·malloc */ #include \u0026lt;sys/types.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;void *malloc(size_t size) { void *p; p = sbrk(0); if (sbrk(size) == (void *)-1) return NULL; return p; }   è¿™ä¸ªmallocæ¯æ¬¡éƒ½åœ¨å½“å‰breakçš„åŸºç¡€ä¸Šå¢åŠ sizeæ‰€æŒ‡å®šçš„å­—èŠ‚æ•°ï¼Œå¹¶å°†ä¹‹å‰breakçš„åœ°å€è¿”å›ã€‚è¿™ä¸ªmallocç”±äºå¯¹æ‰€åˆ†é…çš„å†…å­˜ç¼ºä¹è®°å½•ï¼Œä¸ä¾¿äºå†…å­˜é‡Šæ”¾ï¼Œæ‰€ä»¥æ— æ³•ç”¨äºçœŸå®åœºæ™¯ã€‚\næ­£å¼å®ç°malloc æ•°æ®ç»“æ„\nä¸€ä¸ªç®€å•å¯è¡Œæ–¹æ¡ˆæ˜¯å°†å †å†…å­˜ç©ºé—´ä»¥å—ï¼ˆBlockï¼‰çš„å½¢å¼ç»„ç»‡èµ·æ¥ï¼Œæ¯ä¸ªå—ç”±metaåŒºå’Œæ•°æ®åŒºç»„æˆï¼ŒmetaåŒºè®°å½•æ•°æ®å—çš„å…ƒä¿¡æ¯ï¼ˆæ•°æ®åŒºå¤§å°ã€ç©ºé—²æ ‡å¿—ä½ã€æŒ‡é’ˆç­‰ç­‰ï¼‰ï¼Œæ•°æ®åŒºæ˜¯çœŸå®åˆ†é…çš„å†…å­˜åŒºåŸŸï¼Œå¹¶ä¸”æ•°æ®åŒºçš„ç¬¬ä¸€ä¸ªå­—èŠ‚åœ°å€å³ä¸ºmallocè¿”å›çš„åœ°å€ã€‚\n1 2 3 4 5 6 7 8 9  typedef struct s_block *t_block; struct s_block { size_t size; /* æ•°æ®åŒºå¤§å° 8å­—èŠ‚*/ t_block next; /* æŒ‡å‘ä¸‹ä¸ªå—çš„æŒ‡é’ˆ 8å­—èŠ‚*/ int free; /* æ˜¯å¦æ˜¯ç©ºé—²å— 4å­—èŠ‚*/ int padding; /* å¡«å……4å­—èŠ‚ï¼Œä¿è¯metaå—é•¿åº¦ä¸º8çš„å€æ•° 4å­—èŠ‚*/ char data[1] /* è¿™æ˜¯ä¸€ä¸ªè™šæ‹Ÿå­—æ®µï¼Œè¡¨ç¤ºæ•°æ®å—çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œé•¿åº¦ä¸åº”è®¡å…¥meta */ }; // æ€»å…±32å­—èŠ‚   ç”±äºæˆ‘ä»¬åªè€ƒè™‘64ä½æœºå™¨ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬åœ¨ç»“æ„ä½“æœ€åå¡«å……ä¸€ä¸ªintï¼Œä½¿å¾—ç»“æ„ä½“æœ¬èº«çš„é•¿åº¦ä¸º8çš„å€æ•°ï¼Œä»¥ä¾¿å†…å­˜å¯¹é½ã€‚ç¤ºæ„å›¾å¦‚ä¸‹ï¼š\nå¯»æ‰¾åˆé€‚çš„block\nã€€ç°åœ¨è€ƒè™‘å¦‚ä½•åœ¨blocké“¾ä¸­æŸ¥æ‰¾åˆé€‚çš„blockã€‚ä¸€èˆ¬æ¥è¯´æœ‰ä¸¤ç§æŸ¥æ‰¾ç®—æ³•ï¼š\n First fitï¼šä»å¤´å¼€å§‹ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªæ•°æ®åŒºå¤§å°å¤§äºè¦æ±‚sizeçš„å—æ‰€è°“æ­¤æ¬¡åˆ†é…çš„å— Best fitï¼šä»å¤´å¼€å§‹ï¼Œéå†æ‰€æœ‰å—ï¼Œä½¿ç”¨æ•°æ®åŒºå¤§å°å¤§äºsizeä¸”å·®å€¼æœ€å°çš„å—ä½œä¸ºæ­¤æ¬¡åˆ†é…çš„å—  ã€€ä¸¤ç§æ–¹æ³•å„æœ‰åƒç§‹ï¼Œbest fitå…·æœ‰è¾ƒé«˜çš„å†…å­˜ä½¿ç”¨ç‡ï¼ˆpayloadè¾ƒé«˜ï¼‰ï¼Œè€Œfirst fitå…·æœ‰æ›´å¥½çš„è¿è¡Œæ•ˆç‡ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨first fitç®—æ³•ã€‚\n1 2 3 4 5 6 7 8 9  /* First fit */ t_block find_block(t_block *last, size_t size) { t_block b = first_block; while(b \u0026amp;\u0026amp; !(b-\u0026gt;free \u0026amp;\u0026amp; b-\u0026gt;size \u0026gt;= size)) { *last = b; b = b-\u0026gt;next; } return b; }   find_blockä»frist_blockå¼€å§‹ï¼ŒæŸ¥æ‰¾ç¬¬ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„blockå¹¶è¿”å›blockèµ·å§‹åœ°å€ï¼Œå¦‚æœæ‰¾ä¸åˆ°è¿™è¿”å›NULLã€‚è¿™é‡Œåœ¨éå†æ—¶ä¼šæ›´æ–°ä¸€ä¸ªå«lastçš„æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆå§‹ç»ˆæŒ‡å‘å½“å‰éå†çš„blockã€‚è¿™æ˜¯ä¸ºäº†å¦‚æœæ‰¾ä¸åˆ°åˆé€‚çš„blockè€Œå¼€è¾Ÿæ–°blockä½¿ç”¨çš„ã€‚\nå¼€è¾Ÿæ–°çš„block\nå¦‚æœç°æœ‰blockéƒ½ä¸èƒ½æ»¡è¶³sizeçš„è¦æ±‚ï¼Œåˆ™éœ€è¦åœ¨é“¾è¡¨æœ€åå¼€è¾Ÿä¸€ä¸ªæ–°çš„blockã€‚è¿™é‡Œå…³é”®æ˜¯å¦‚ä½•åªä½¿ç”¨sbrkåˆ›å»ºä¸€ä¸ªstructï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  #define BLOCK_SIZE 24 /* ç”±äºå­˜åœ¨è™šæ‹Ÿçš„dataå­—æ®µï¼Œsizeofä¸èƒ½æ­£ç¡®è®¡ç®—metaé•¿åº¦ï¼Œè¿™é‡Œæ‰‹å·¥è®¾ç½® */ t_block extend_heap(t_block last, size_t s) { t_block b; b = sbrk(0); if(sbrk(BLOCK_SIZE + s) == (void *)-1) return NULL; b-\u0026gt;size = s; b-\u0026gt;next = NULL; if(last) last-\u0026gt;next = b; b-\u0026gt;free = 0; return b; }   åˆ†è£‚block\nFirst fitæœ‰ä¸€ä¸ªæ¯”è¾ƒè‡´å‘½çš„ç¼ºç‚¹ï¼Œå°±æ˜¯å¯èƒ½ä¼šè®©å¾ˆå°çš„sizeå æ®å¾ˆå¤§çš„ä¸€å—blockï¼Œæ­¤æ—¶ï¼Œä¸ºäº†æé«˜payloadï¼Œåº”è¯¥åœ¨å‰©ä½™æ•°æ®åŒºè¶³å¤Ÿå¤§çš„æƒ…å†µä¸‹ï¼Œå°†å…¶åˆ†è£‚ä¸ºä¸€ä¸ªæ–°çš„blockï¼Œç¤ºæ„å¦‚ä¸‹ï¼š\nå®ç°ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9  void split_block(t_block b, size_t s) { t_block new; new = b-\u0026gt;data + s; new-\u0026gt;size = b-\u0026gt;size - s - BLOCK_SIZE ; new-\u0026gt;next = b-\u0026gt;next; new-\u0026gt;free = 1; b-\u0026gt;size = s; b-\u0026gt;next = new; }   mallocå®ç°\næ³¨æ„é¦–å…ˆæˆ‘ä»¬è¦å®šä¹‰ä¸ªblocké“¾è¡¨çš„å¤´first_blockï¼Œåˆå§‹åŒ–ä¸ºNULLï¼›å¦å¤–ï¼Œæˆ‘ä»¬éœ€è¦å‰©ä½™ç©ºé—´è‡³å°‘æœ‰BLOCK_SIZE + 8æ‰æ‰§è¡Œåˆ†è£‚æ“ä½œã€‚\nç”±äºæˆ‘ä»¬å¸Œæœ›mallocåˆ†é…çš„æ•°æ®åŒºæ˜¯æŒ‰8å­—èŠ‚å¯¹é½ï¼Œæ‰€ä»¥åœ¨sizeä¸ä¸º8çš„å€æ•°æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†sizeè°ƒæ•´ä¸ºå¤§äºsizeçš„æœ€å°çš„8çš„å€æ•°ï¼š\n1 2 3 4 5  size_t align8(size_t s) { if(s \u0026amp; 0x7 == 0) return s; return ((s \u0026gt;\u0026gt; 3) + 1) \u0026lt;\u0026lt; 3; }   mallocä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  #define BLOCK_SIZE 24void *first_block=NULL; /* other functions... */ void *malloc(size_t size) { t_block b, last; size_t s; /* å¯¹é½åœ°å€ */ s = align8(size); if(first_block) { /* æŸ¥æ‰¾åˆé€‚çš„block */ last = first_block; b = find_block(\u0026amp;last, s); if(b) { /* å¦‚æœå¯ä»¥ï¼Œåˆ™åˆ†è£‚ */ if ((b-\u0026gt;size - s) \u0026gt;= ( BLOCK_SIZE + 8)) split_block(b, s); b-\u0026gt;free = 0; } else { /* æ²¡æœ‰åˆé€‚çš„blockï¼Œå¼€è¾Ÿä¸€ä¸ªæ–°çš„ */ b = extend_heap(last, s); if(!b) return NULL; } } else { b = extend_heap(NULL, s); if(!b) return NULL; first_block = b; } return b-\u0026gt;data; }   callocçš„å®ç° æœ‰äº†mallocï¼Œå®ç°callocåªè¦ä¸¤æ­¥ï¼š\n mallocä¸€æ®µå†…å­˜ å°†æ•°æ®åŒºå†…å®¹ç½®ä¸º0  ç”±äºæˆ‘ä»¬çš„æ•°æ®åŒºæ˜¯æŒ‰8å­—èŠ‚å¯¹é½çš„ï¼Œæ‰€ä»¥ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæˆ‘ä»¬å¯ä»¥æ¯8å­—èŠ‚ä¸€ç»„ç½®0ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚è®¾ç½®ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–°å»ºä¸€ä¸ªsize_tæŒ‡é’ˆï¼Œå°†å†…å­˜åŒºåŸŸå¼ºåˆ¶çœ‹åšsize_tç±»å‹æ¥å®ç°ã€‚\n1 2 3 4 5 6 7 8 9 10 11  void *calloc(size_t number, size_t size) { size_t *new; size_t s8, i; new = malloc(number * size); if(new) { s8 = align8(number * size) \u0026gt;\u0026gt; 3; for(i = 0; i \u0026lt; s8; i++) new[i] = 0; } return new; }   freeçš„å®ç° freeçš„å®ç°å¹¶ä¸åƒçœ‹ä¸Šå»é‚£ä¹ˆç®€å•ï¼Œè¿™é‡Œæˆ‘ä»¬è¦è§£å†³ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼š\n å¦‚ä½•éªŒè¯æ‰€ä¼ å…¥çš„åœ°å€æ˜¯æœ‰æ•ˆåœ°å€ï¼Œå³ç¡®å®æ˜¯é€šè¿‡mallocæ–¹å¼åˆ†é…çš„æ•°æ®åŒºé¦–åœ°å€ å¦‚ä½•è§£å†³ç¢ç‰‡é—®é¢˜  é¦–å…ˆæˆ‘ä»¬è¦ä¿è¯ä¼ å…¥freeçš„åœ°å€æ˜¯æœ‰æ•ˆçš„ï¼Œè¿™ä¸ªæœ‰æ•ˆåŒ…æ‹¬ä¸¤æ–¹é¢ï¼š\n åœ°å€åº”è¯¥åœ¨ä¹‹å‰mallocæ‰€åˆ†é…çš„åŒºåŸŸå†…ï¼Œå³åœ¨first_blockå’Œå½“å‰breakæŒ‡é’ˆèŒƒå›´å†… è¿™ä¸ªåœ°å€ç¡®å®æ˜¯ä¹‹å‰é€šè¿‡æˆ‘ä»¬è‡ªå·±çš„mallocåˆ†é…çš„  ç¬¬ä¸€ä¸ªé—®é¢˜æ¯”è¾ƒå¥½è§£å†³ï¼Œåªè¦è¿›è¡Œåœ°å€æ¯”è¾ƒå°±å¯ä»¥äº†ï¼Œå…³é”®æ˜¯ç¬¬äºŒä¸ªé—®é¢˜ã€‚è¿™é‡Œæœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼šä¸€æ˜¯åœ¨ç»“æ„ä½“å†…åŸ‹ä¸€ä¸ªmagic numberå­—æ®µï¼Œfreeä¹‹å‰é€šè¿‡ç›¸å¯¹åç§»æ£€æŸ¥ç‰¹å®šä½ç½®çš„å€¼æ˜¯å¦ä¸ºæˆ‘ä»¬è®¾ç½®çš„magic numberï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨ç»“æ„ä½“å†…å¢åŠ ä¸€ä¸ªmagic pointerï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘æ•°æ®åŒºçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆä¹Ÿå°±æ˜¯åœ¨åˆæ³•æ—¶freeæ—¶ä¼ å…¥çš„åœ°å€ï¼‰ï¼Œæˆ‘ä»¬åœ¨freeå‰æ£€æŸ¥magic pointeræ˜¯å¦æŒ‡å‘å‚æ•°æ‰€æŒ‡åœ°å€ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç¬¬äºŒç§æ–¹æ¡ˆï¼š\né¦–å…ˆæˆ‘ä»¬åœ¨ç»“æ„ä½“ä¸­å¢åŠ magic pointerï¼ˆåŒæ—¶è¦ä¿®æ”¹BLOCK_SIZEï¼‰ï¼š\n1 2 3 4 5 6 7 8 9  typedef struct s_block *t_block; struct s_block { size_t size; /* æ•°æ®åŒºå¤§å° */ t_block next; /* æŒ‡å‘ä¸‹ä¸ªå—çš„æŒ‡é’ˆ */ int free; /* æ˜¯å¦æ˜¯ç©ºé—²å— */ int padding; /* å¡«å……4å­—èŠ‚ï¼Œä¿è¯metaå—é•¿åº¦ä¸º8çš„å€æ•° */ void *ptr; /* Magic pointerï¼ŒæŒ‡å‘data */ char data[1] /* è¿™æ˜¯ä¸€ä¸ªè™šæ‹Ÿå­—æ®µï¼Œè¡¨ç¤ºæ•°æ®å—çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œé•¿åº¦ä¸åº”è®¡å…¥meta */ };   ç„¶åæˆ‘ä»¬å®šä¹‰æ£€æŸ¥åœ°å€åˆæ³•æ€§çš„å‡½æ•°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  t_block get_block(void *p) { char *tmp; tmp = p; return (p = tmp -= BLOCK_SIZE); } int valid_addr(void *p) { if(first_block) { if(p \u0026gt; first_block \u0026amp;\u0026amp; p \u0026lt; sbrk(0)) { return p == (get_block(p))-\u0026gt;ptr; } } return 0; }   å½“å¤šæ¬¡mallocå’Œfreeåï¼Œæ•´ä¸ªå†…å­˜æ± å¯èƒ½ä¼šäº§ç”Ÿå¾ˆå¤šç¢ç‰‡blockï¼Œè¿™äº›blockå¾ˆå°ï¼Œç»å¸¸æ— æ³•ä½¿ç”¨ï¼Œç”šè‡³å‡ºç°è®¸å¤šç¢ç‰‡è¿åœ¨ä¸€èµ·ï¼Œè™½ç„¶æ€»ä½“èƒ½æ»¡è¶³æŸæ­¤mallocè¦æ±‚ï¼Œä½†æ˜¯ç”±äºåˆ†å‰²æˆäº†å¤šä¸ªå°blockè€Œæ— æ³•fitï¼Œè¿™å°±æ˜¯ç¢ç‰‡é—®é¢˜ã€‚\nä¸€ä¸ªç®€å•çš„è§£å†³æ–¹å¼æ—¶å½“freeæŸä¸ªblockæ—¶ï¼Œå¦‚æœå‘ç°å®ƒç›¸é‚»çš„blockä¹Ÿæ˜¯freeçš„ï¼Œåˆ™å°†blockå’Œç›¸é‚»blockåˆå¹¶ã€‚ä¸ºäº†æ»¡è¶³è¿™ä¸ªå®ç°ï¼Œéœ€è¦å°†s_blockæ”¹ä¸ºåŒå‘é“¾è¡¨ã€‚ä¿®æ”¹åçš„blockç»“æ„å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10  typedef struct s_block *t_block; struct s_block { size_t size; /* æ•°æ®åŒºå¤§å° */ t_block prev; /* æŒ‡å‘ä¸Šä¸ªå—çš„æŒ‡é’ˆ */ t_block next; /* æŒ‡å‘ä¸‹ä¸ªå—çš„æŒ‡é’ˆ */ int free; /* æ˜¯å¦æ˜¯ç©ºé—²å— */ int padding; /* å¡«å……4å­—èŠ‚ï¼Œä¿è¯metaå—é•¿åº¦ä¸º8çš„å€æ•° */ void *ptr; /* Magic pointerï¼ŒæŒ‡å‘data */ char data[1] /* è¿™æ˜¯ä¸€ä¸ªè™šæ‹Ÿå­—æ®µï¼Œè¡¨ç¤ºæ•°æ®å—çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œé•¿åº¦ä¸åº”è®¡å…¥meta */ };   åˆå¹¶æ–¹æ³•å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9  t_block fusion(t_block b) { if (b-\u0026gt;next \u0026amp;\u0026amp; b-\u0026gt;next-\u0026gt;free) { b-\u0026gt;size += BLOCK_SIZE + b-\u0026gt;next-\u0026gt;size; b-\u0026gt;next = b-\u0026gt;next-\u0026gt;next; if(b-\u0026gt;next) b-\u0026gt;next-\u0026gt;prev = b; } return b; }   æœ‰äº†ä¸Šè¿°æ–¹æ³•ï¼Œfreeçš„å®ç°æ€è·¯å°±æ¯”è¾ƒæ¸…æ™°äº†ï¼šé¦–å…ˆæ£€æŸ¥å‚æ•°åœ°å€çš„åˆæ³•æ€§ï¼Œå¦‚æœä¸åˆæ³•åˆ™ä¸åšä»»ä½•äº‹ï¼›å¦åˆ™ï¼Œå°†æ­¤blockçš„freeæ ‡ä¸º1ï¼Œå¹¶ä¸”åœ¨å¯ä»¥çš„æƒ…å†µä¸‹ä¸åé¢çš„blockè¿›è¡Œåˆå¹¶ã€‚å¦‚æœå½“å‰æ˜¯æœ€åä¸€ä¸ªblockï¼Œåˆ™å›é€€breakæŒ‡é’ˆé‡Šæ”¾è¿›ç¨‹å†…å­˜ï¼Œå¦‚æœå½“å‰blockæ˜¯æœ€åä¸€ä¸ªblockï¼Œåˆ™å›é€€breakæŒ‡é’ˆå¹¶è®¾ç½®first_blockä¸ºNULLã€‚å®ç°å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  void free(void *p) { t_block b; if(valid_addr(p)) { b = get_block(p); b-\u0026gt;free = 1; if(b-\u0026gt;prev \u0026amp;\u0026amp; b-\u0026gt;prev-\u0026gt;free) b = fusion(b-\u0026gt;prev); if(b-\u0026gt;next) fusion(b); else { if(b-\u0026gt;prev) b-\u0026gt;prev-\u0026gt;prev = NULL; else first_block = NULL; brk(b); } } }   reallocçš„å®ç° ä¸ºäº†å®ç°reallocï¼Œæˆ‘ä»¬é¦–å…ˆè¦å®ç°ä¸€ä¸ªå†…å­˜å¤åˆ¶æ–¹æ³•ã€‚å¦‚åŒcallocä¸€æ ·ï¼Œä¸ºäº†æ•ˆç‡ï¼Œæˆ‘ä»¬ä»¥8å­—èŠ‚ä¸ºå•ä½è¿›è¡Œå¤åˆ¶ï¼š\n1 2 3 4 5 6 7 8  void copy_block(t_block src, t_block dst) { size_t *sdata, *ddata; size_t i; sdata = src-\u0026gt;ptr; ddata = dst-\u0026gt;ptr; for(i = 0; (i * 8) \u0026lt; src-\u0026gt;size \u0026amp;\u0026amp; (i * 8) \u0026lt; dst-\u0026gt;size; i++) ddata[i] = sdata[i]; }   ç„¶åæˆ‘ä»¬å¼€å§‹å®ç°reallocã€‚ä¸€ä¸ªç®€å•ï¼ˆä½†æ˜¯ä½æ•ˆï¼‰çš„æ–¹æ³•æ˜¯mallocä¸€æ®µå†…å­˜ï¼Œç„¶åå°†æ•°æ®å¤åˆ¶è¿‡å»ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åšçš„æ›´é«˜æ•ˆï¼Œå…·ä½“å¯ä»¥è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š\n å¦‚æœå½“å‰blockçš„æ•°æ®åŒºå¤§äºç­‰äºreallocæ‰€è¦æ±‚çš„sizeï¼Œåˆ™ä¸åšä»»ä½•æ“ä½œ å¦‚æœæ–°çš„sizeå˜å°äº†ï¼Œè€ƒè™‘split å¦‚æœå½“å‰blockçš„æ•°æ®åŒºä¸èƒ½æ»¡è¶³sizeï¼Œä½†æ˜¯å…¶åç»§blockæ˜¯freeçš„ï¼Œå¹¶ä¸”åˆå¹¶åå¯ä»¥æ»¡è¶³ï¼Œåˆ™è€ƒè™‘åšåˆå¹¶  ä¸‹é¢æ˜¯reallocçš„å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  void *realloc(void *p, size_t size) { size_t s; t_block b, new; void *newp; if (!p) /* æ ¹æ®æ ‡å‡†åº“æ–‡æ¡£ï¼Œå½“pä¼ å…¥NULLæ—¶ï¼Œç›¸å½“äºè°ƒç”¨malloc */ return malloc(size); if(valid_addr(p)) { s = align8(size); b = get_block(p); if(b-\u0026gt;size \u0026gt;= s) { if(b-\u0026gt;size - s \u0026gt;= (BLOCK_SIZE + 8)) split_block(b,s); } else { /* çœ‹æ˜¯å¦å¯è¿›è¡Œåˆå¹¶ */ if(b-\u0026gt;next \u0026amp;\u0026amp; b-\u0026gt;next-\u0026gt;free \u0026amp;\u0026amp; (b-\u0026gt;size + BLOCK_SIZE + b-\u0026gt;next-\u0026gt;size) \u0026gt;= s) { fusion(b); if(b-\u0026gt;size - s \u0026gt;= (BLOCK_SIZE + 8)) split_block(b, s); } else { /* æ–°malloc */ newp = malloc (s); if (!newp) return NULL; new = get_block(newp); copy_block(b, new); free(p); return(newp); } } return (p); } return NULL; }   é—ç•™é—®é¢˜å’Œä¼˜åŒ– ä»¥ä¸Šæ˜¯ä¸€ä¸ªè¾ƒä¸ºç®€é™‹ï¼Œä½†æ˜¯åˆæ­¥å¯ç”¨çš„mallocå®ç°ã€‚è¿˜æœ‰å¾ˆå¤šé—ç•™çš„å¯èƒ½ä¼˜åŒ–ç‚¹ï¼Œä¾‹å¦‚ï¼š\n åŒæ—¶å…¼å®¹32ä½å’Œ64ä½ç³»ç»Ÿ åœ¨åˆ†é…è¾ƒå¤§å¿«å†…å­˜æ—¶ï¼Œè€ƒè™‘ä½¿ç”¨mmapè€Œésbrkï¼Œè¿™é€šå¸¸æ›´é«˜æ•ˆ å¯ä»¥è€ƒè™‘ç»´æŠ¤å¤šä¸ªé“¾è¡¨è€Œéå•ä¸ªï¼Œæ¯ä¸ªé“¾è¡¨ä¸­çš„blockå¤§å°å‡ä¸ºä¸€ä¸ªèŒƒå›´å†…ï¼Œä¾‹å¦‚8å­—èŠ‚é“¾è¡¨ã€16å­—èŠ‚é“¾è¡¨ã€24-32å­—èŠ‚é“¾è¡¨ç­‰ç­‰ã€‚æ­¤æ—¶å¯ä»¥æ ¹æ®sizeåˆ°å¯¹åº”é“¾è¡¨ä¸­åšåˆ†é…ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘ç¢ç‰‡ï¼Œå¹¶æé«˜æŸ¥è¯¢blockçš„é€Ÿåº¦ å¯ä»¥è€ƒè™‘é“¾è¡¨ä¸­åªå­˜æ”¾freeçš„blockï¼Œè€Œä¸å­˜æ”¾å·²åˆ†é…çš„blockï¼Œå¯ä»¥å‡å°‘æŸ¥æ‰¾blockçš„æ¬¡æ•°ï¼Œæé«˜æ•ˆç‡  å‚è€ƒï¼š\n åå››. malloc\u0026amp;freeçš„å®ç° å¦‚ä½•å®ç°ä¸€ä¸ªmalloc brk(ï¼‰å’Œsbrk()å‡½æ•°çš„ä½¿ç”¨  mmap() åˆ›å»ºè¿›ç¨‹æ—¶ï¼Œå»ºç«‹è™šå­˜ç©ºé—´å’Œå…·ä½“æ–‡ä»¶ä¹‹é—´çš„æ˜ å°„ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯å»ºç«‹æ˜ å°„çš„è¿‡ç¨‹ä¸­å®Œæˆå¾ˆå¤šå¤æ‚çš„éœ€æ±‚ï¼Œæ¯”å¦‚ç”¨å‡½æ•°æŒ‡é’ˆæ¥ç»‘å®šä¸€äº›å¯¹é¡µé¢çš„æ“ä½œã€‚è¿™ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨çš„å®ç°è¿‡ç¨‹å…¶å®å¹¶ä¸ç®€å•ï¼Œéå¸¸å€¼å¾—ç ”ç©¶ï¼Œå…·ä½“è¿˜æ˜¯å‚çœ‹ä¹¦ç±ã€‚\nç»“è®º\n1ï¼‰å½“å¼€è¾Ÿçš„ç©ºé—´å°äº 128K æ—¶ï¼Œè°ƒç”¨ brkï¼ˆï¼‰å‡½æ•°ï¼Œmalloc çš„åº•å±‚å®ç°æ˜¯ç³»ç»Ÿè°ƒç”¨å‡½æ•° brkï¼ˆï¼‰ï¼Œå…¶ä¸»è¦ç§»åŠ¨æŒ‡é’ˆ _enddata(æ­¤æ—¶çš„ _enddata æŒ‡çš„æ˜¯ Linux åœ°å€ç©ºé—´ä¸­å †æ®µçš„æœ«å°¾åœ°å€ï¼Œä¸æ˜¯æ•°æ®æ®µçš„æœ«å°¾åœ°å€)\n2ï¼‰å½“å¼€è¾Ÿçš„ç©ºé—´å¤§äº 128K æ—¶ï¼Œmmapï¼ˆï¼‰ç³»ç»Ÿè°ƒç”¨å‡½æ•°æ¥åœ¨è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ï¼ˆå †å’Œæ ˆä¸­é—´ï¼Œç§°ä¸ºâ€œæ–‡ä»¶æ˜ å°„åŒºåŸŸâ€çš„åœ°æ–¹ï¼‰æ‰¾ä¸€å—ç©ºé—´æ¥å¼€è¾Ÿã€‚\nå‚è€ƒï¼šmalloc åº•å±‚å®ç°åŠåŸç†\nå†…å­˜ç®¡ç†çš„æœ¬è´¨ å¯¹äºç¤¾ä¼šæ¥è®²ï¼Œâ€œç®¡ç†â€æ˜¯äººç±»å‘å±•åˆ°ä¸€å®šé˜¶æ®µæ‰äº§ç”Ÿçš„ã€‚æ‹¿æ—¶ä¸‹æœ€ç–¯ç‹‚çš„ä¸€ä»¶äº‹â€œä¹°æˆ¿â€æ¥ä¸¾ä¾‹ï¼Œå½“æˆ‘æŠµä¸Šæœªæ¥20å¹´çš„é’æ˜¥ä¹°åˆ°ä¸€å¥—æˆ¿å­åï¼Œå¹¶ä¸æ˜¯å°†æˆ¿å­ä»åœ°ä¸ŠæŒ–èµ·æ¥é€åˆ°æˆ‘é¢å‰ï¼Œè€Œåªæ˜¯åœ¨åˆæ³•éƒ¨é—¨å°†æˆ¿å­çš„æ‰€å±æƒè·Ÿæˆ‘çš„**å·å…³è”èµ·æ¥ï¼Œæˆ‘å°±æœ‰æƒä½è¿›è¿™ä¸ªæˆ¿å­äº†ã€‚è…¿é•¿åœ¨æˆ‘è‡ªå·±èº«ä¸Šï¼ŒæŒ‰é“ç†æˆ‘æƒ³è¿›è°çš„æˆ¿å­å°±è¿›è°çš„æˆ¿å­å‘€ï¼Œä½†é™¤éæ˜¯åœ¨åŸå§‹ç¤¾ä¼šï¼Œåœ¨æœ‰äº†â€œç®¡ç†â€çš„å½“ä»Šç¤¾ä¼šï¼Œä¹±è·‘å°±ä¼šè¢«æŠ“èµ·æ¥ï¼åŸå§‹ç¤¾ä¼šåªç”Ÿæ´»ç€ä¸€ä¸ªæˆ–å°‘é‡çŒ¿çŒ´ï¼ˆéœ€\u0026laquo;æ±‚ï¼‰ï¼Œéšä¾¿æ‰¾ä¸ªæ´ç©´å°±æ˜¯æˆ¿å­ï¼Œä¸€æ–‡ä¸å€¼ï¼ŒçŒ¿çŒ´ä¸ä¼šå› ä¸ºæˆ¿å­è€Œå‘ç”Ÿå†²çªï¼Œæ‰€ä»¥æ‰ä¸éœ€è¦ç®¡ç†ã€‚\nå¯¹è®¡ç®—æœºæ¥è®²ï¼Œä»åŠ ç”µåˆ°å¯åŠ¨å®Œæˆï¼Œä¹Ÿç»å†äº†â€œåŸå§‹ç¤¾ä¼šâ€åˆ°â€œå½“ä»Šç¤¾ä¼šâ€çš„è¿‡ç¨‹ï¼Œå³â€œå®æ¨¡å¼â†’ä¿æŠ¤æ¨¡å¼â€ï¼Œå®æ¨¡å¼æ—¶åªæœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªå·´æŒæ‹ä¸å“ï¼Œæ‰€ä»¥ä¸æ‹…å¿ƒå¹²æ‰°ï¼Œåªç®¡ä¸ºè¿›å…¥ä¿æŠ¤æ¨¡å¼ä½œå¥½å‡†å¤‡ï¼Œå¹¶åˆ‡æ¢åˆ°ä¿æŠ¤æ¨¡å¼ã€‚ä¸€æ—¦è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼Œå®é™…ä¸Šå°±æ˜¯å¯åŠ¨ä¸€äº›é˜²æ­¢ç›¸äº’å¹²æ‰°çš„â€œç®¡ç†â€ï¼Œå…¶ä¸­å†…å­˜ç®¡ç†å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œä»è€Œå¤šä¸ªè¿›ç¨‹æ‰èƒ½å’Œè°å…±å¤„ã€‚\nå†…æ ¸è¦ä¿è¯å„ä¸ªè¿›ç¨‹å¯¹ç‰©ç†å†…å­˜ï¼ˆç³»ç»ŸèŒƒå›´å”¯ä¸€ï¼‰çš„ä½¿ç”¨ä¸å‘ç”Ÿå¹²æ‰°ï¼Œä¹Ÿè¦ä¿è¯æ¯ä¸ªè¿›ç¨‹ä¸­ä¸åŒçš„ç¨‹åºç‰‡æ®µå¯¹è™šæ‹Ÿå†…å­˜ï¼ˆè¿›ç¨‹èŒƒå›´å”¯ä¸€ï¼‰çš„ä½¿ç”¨ä¸å‘ç”Ÿå¹²æ‰°ï¼š\nâ‘  æ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„æ˜ å°„å…³ç³»è¡¨ï¼Œå†…æ ¸çš„è§†é‡èƒ½çœ‹è§ç³»ç»Ÿæ‰€æœ‰è¿›ç¨‹ï¼Œè‡ªç„¶ä¹Ÿèƒ½ä¿è¯å„ä¸ªè¿›ç¨‹å¯¹ç‰©ç†é¡µé¢çš„ä½¿ç”¨ä¸å†²çªã€‚\nâ‘¡ ç¨‹åºä¸­çš„å…¨å±€å˜é‡ã€staticå˜é‡ã€å‡½æ•°åç­‰ï¼Œç”±ç¼–è¯‘å™¨å®‰æ’ä¸å†²çªçš„è™šæ‹Ÿåœ°å€ï¼ŒåŠ¨æ€åˆ†é…/é‡Šæ”¾æ—¶ï¼Œå¯¹è™šæ‹Ÿé¡µé¢çš„ä½¿ç”¨éƒ½å»ºç«‹è®°å½•ä¿¡æ¯ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šå‘ç”Ÿå†²çªã€‚\næ‰€ä»¥å†…å­˜ç®¡ç†çš„æœ¬è´¨å°±æ˜¯ä¸ºé˜²æ­¢å¹²æ‰°ã€æ•ˆç‡ã€æ¢å…¥æ¢å‡ºç­‰å»ºç«‹è®°å½•ä¿¡æ¯ï¼Œå¹¶åˆ©ç”¨è¿™äº›ä¿¡æ¯è¾¾åˆ°ç›¸åº”çš„ç›®çš„ã€‚\nä»¥ä¸‹å°±æ˜¯åˆ†é…å†…å­˜æ—¶ï¼Œå»ºç«‹ç®¡ç†ä¿¡æ¯çš„å¤§è‡´ç¤ºæ„å›¾ï¼š\n  brk()\nä»ä¸Šå›¾ä¹Ÿå¯ä»¥çœ‹å‡ºLinuxå¯¹è™šæ‹Ÿç©ºé—´çš„ä½¿ç”¨å®‰æ’ï¼Œbrk()å°±æ˜¯æ“ä½œåŠ¨æ€åˆ†é…åŒºé—´çš„è™šæ‹Ÿåœ°å€ï¼ˆåˆ†é…/é‡Šæ”¾ï¼‰ã€‚glibcåº“ä¸­çš„malloc()å‡½æ•°ï¼Œå°±æ˜¯ç”¨brk()ç³»ç»Ÿè°ƒç”¨åˆ†é…/é‡Šæ”¾è™šæ‹Ÿé¡µé¢ã€‚\næ³¨æ„ï¼š\nchar *p = malloc(); // ä¸èƒ½free(p+1)\nbrk()å¾—åˆ°çš„ä¸€ä¸ªè™šæ‹Ÿåœ°å€åŒºé—´ï¼ˆå›¾ä¸­ç°è‰²åŒºåŸŸï¼Œç”¨vm_area_structç»“æ„è¡¨ç¤ºï¼‰ï¼Œå¯ä»¥é‡Šæ”¾å½“ä¸­ä¸€éƒ¨åˆ†ï¼Œè€Œè£‚ä¸ºä¸¤ä¸ªåŒºåŸŸ\n  Linuxç¼“å†²åŒºğŸƒ linuxä¸­æœ‰ä¸¤ä¸ªçº§åˆ«çš„ç¼“å†²ï¼šIOç¼“å†²ä¸å†…æ ¸ç¼“å†²\nï¼ˆ1ï¼‰IOç¼“å†²:å¯¹äºæ ‡å‡†IOæ“ä½œï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªç¼“å†²åŒºï¼Œå½“ç”¨æˆ·æƒ³è¦å†™æ•°æ®æ—¶ï¼Œé¦–å…ˆå°†æ•°æ®å†™å…¥ç¼“å†²åŒºï¼Œå¾…ç¼“å†²åŒºæ»¡ä¹‹åæ‰èƒ½è°ƒç”¨ç³»ç»Ÿå‡½æ•°å†™å…¥å†…æ ¸ç¼“å†²åŒºã€‚å½“ç”¨æˆ·æƒ³è¯»å–æ•°æ®æ—¶ï¼Œé¦–å…ˆå‘å†…æ ¸è¯»å–ä¸€å®šçš„æ•°æ®æ”¾å…¥IOç¼“å†²åŒºï¼Œè¯»æ“ä½œä»ç¼“å†²åŒºä¸­è¯»æ•°æ®ï¼Œå½“è¯»å®ŒIOç¼“å†²åŒºçš„æ•°æ®æ—¶ï¼Œæ‰èƒ½å†è¯»å–æ•°æ®åˆ°IOç¼“å†²åŒºã€‚\nç›®çš„ï¼šå‡å°‘å¯¹ç£ç›˜çš„è¯»å†™æ¬¡æ•°ï¼Œæé«˜å·¥ä½œæ•ˆç‡ã€‚\nï¼ˆ2ï¼‰å†…æ ¸ç¼“å†²åŒº:æ“ä½œç³»ç»Ÿå†…æ ¸éƒ¨åˆ†ä¹Ÿæœ‰ç¼“å†²ï¼Œå…¶ä¸IOç¼“å†²åŒºæ˜¯ä¸åŒçš„ï¼Œå…¶ä¸»è¦åŒºåˆ«ç”¨ä¸€å¼ å›¾è¡¨ç¤ºï¼š\n æ“ä½œç³»ç»Ÿï¼ˆå†…æ ¸ï¼‰å…ˆä»ç£ç›˜è¯»å–æ•°æ®åˆ°å†…æ ¸ç©ºé—´çš„å†…å­˜ï¼ˆreadâ‘ ï¼‰ï¼Œå†æŠŠæ•°æ®ä»å†…æ ¸ç©ºé—´å†…å­˜æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´å†…å­˜ï¼ˆreadâ‘¡ï¼‰ã€‚æ­¤åï¼Œç”¨æˆ·åº”ç”¨ç¨‹åºæ‰å¯ä»¥æ“ä½œæ­¤æ•°æ®ã€‚  é‚£ä¹ˆå†…æ ¸ç¼“å†²åšäº†ä»€ä¹ˆäº‹æƒ…å‘¢ï¼Ÿ\n è¯»ï¼šæ•°æ®é¢„è¯» å†™ï¼šå»¶æ—¶å›å†™  å‚è€ƒé“¾æ¥ï¼š\n https://github.com/raxxarr/note/issues/2  ä»€ä¹ˆæ˜¯RPC RPCæ˜¯æŒ‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤å°æœåŠ¡å™¨Aï¼ŒBï¼Œä¸€ä¸ªåº”ç”¨éƒ¨ç½²åœ¨AæœåŠ¡å™¨ä¸Šï¼Œæƒ³è¦è°ƒç”¨BæœåŠ¡å™¨ä¸Šåº”ç”¨æä¾›çš„å‡½æ•°/æ–¹æ³•ï¼Œç”±äºä¸åœ¨ä¸€ä¸ªå†…å­˜ç©ºé—´ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œæ¥è¡¨è¾¾è°ƒç”¨çš„è¯­ä¹‰å’Œä¼ è¾¾è°ƒç”¨çš„æ•°æ®ã€‚\nå‚è€ƒï¼š\n ä»€ä¹ˆæ˜¯RPC? ä¸ºä»€ä¹ˆè¦ç”¨RPCï¼Ÿ ä»€ä¹ˆæ˜¯RPCï¼Ÿ  çº¿ç¨‹åŒæ­¥çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ  äº’æ–¥é‡ï¼šé‡‡ç”¨äº’æ–¥å¯¹è±¡æœºåˆ¶ï¼Œåªæœ‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹æ‰æœ‰è®¿é—®å…¬å…±èµ„æºçš„æƒé™ã€‚å› ä¸ºäº’æ–¥å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯å…¬å…±èµ„æºä¸ä¼šè¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ã€‚ ä¿¡å·é‡ï¼šå®ƒå…è®¸åŒä¸€æ—¶åˆ»å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€èµ„æºï¼Œä½†æ˜¯éœ€è¦æ§åˆ¶åŒä¸€æ—¶åˆ»è®¿é—®æ­¤èµ„æºçš„æœ€å¤§çº¿ç¨‹æ•°é‡ã€‚ äº‹ä»¶ï¼ˆä¿¡å·ï¼‰ï¼šé€šè¿‡é€šçŸ¥æ“ä½œçš„æ–¹å¼æ¥ä¿æŒå¤šçº¿ç¨‹åŒæ­¥ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿çš„å®ç°å¤šçº¿ç¨‹ä¼˜å…ˆçº§çš„æ¯”è¾ƒæ“ä½œã€‚  ä¸­æ–­å’Œè½®è¯¢çš„ç‰¹ç‚¹? å¯¹I/Oè®¾å¤‡çš„ç¨‹åºè½®è¯¢çš„æ–¹å¼ï¼Œæ˜¯æ—©æœŸçš„è®¡ç®—æœºç³»ç»Ÿå¯¹I/Oè®¾å¤‡çš„ä¸€ç§ç®¡ç†æ–¹å¼ã€‚å®ƒå®šæ—¶å¯¹å„ç§è®¾å¤‡è½®æµè¯¢é—®ä¸€éæœ‰æ— å¤„ç†è¦æ±‚ã€‚è½®æµè¯¢é—®ä¹‹åï¼Œæœ‰è¦æ±‚çš„ï¼Œåˆ™åŠ ä»¥å¤„ç†ã€‚åœ¨å¤„ç†I/Oè®¾å¤‡çš„è¦æ±‚ä¹‹åï¼Œå¤„ç†æœºè¿”å›ç»§ç»­å·¥ä½œã€‚å°½ç®¡è½®è¯¢éœ€è¦æ—¶é—´ï¼Œä½†è½®è¯¢è¦æ¯”I/Oè®¾å¤‡çš„é€Ÿåº¦è¦å¿«å¾—å¤šï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šå‘ç”Ÿä¸èƒ½åŠæ—¶å¤„ç†çš„é—®é¢˜ã€‚å½“ç„¶ï¼Œå†å¿«çš„å¤„ç†æœºï¼Œèƒ½å¤„ç†çš„è¾“å…¥è¾“å‡ºè®¾å¤‡çš„æ•°é‡ä¹Ÿæ˜¯æœ‰ä¸€å®šé™åº¦çš„ã€‚è€Œä¸”ï¼Œç¨‹åºè½®è¯¢æ¯•ç«Ÿå æ®äº†CPUç›¸å½“ä¸€éƒ¨åˆ†å¤„ç†æ—¶é—´ï¼Œå› æ­¤ï¼Œç¨‹åºè½®è¯¢æ˜¯ä¸€ç§æ•ˆç‡è¾ƒä½çš„æ–¹å¼ï¼Œåœ¨ç°ä»£è®¡ç®—æœºç³»ç»Ÿä¸­å·²å¾ˆå°‘åº”ç”¨ã€‚\nã€€ç¨‹åºä¸­æ–­é€šå¸¸ç®€ç§°ä¸­æ–­ï¼Œæ˜¯æŒ‡CPUåœ¨æ­£å¸¸è¿è¡Œç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œç”±äºé¢„å…ˆå®‰æ’æˆ–å‘ç”Ÿäº†å„ç§éšæœºçš„å†…éƒ¨æˆ–å¤–éƒ¨äº‹ä»¶ï¼Œä½¿CPUä¸­æ–­æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œè€Œè½¬åˆ°ä¸ºå“åº”çš„æœåŠ¡ç¨‹åºå»å¤„ç†ã€‚\nã€€è½®è¯¢â€”â€”æ•ˆç‡ä½ï¼Œç­‰å¾…æ—¶é—´å¾ˆé•¿ï¼ŒCPUåˆ©ç”¨ç‡ä¸é«˜ã€‚\nã€€ä¸­æ–­â€”â€”å®¹æ˜“é—æ¼ä¸€äº›é—®é¢˜ï¼ŒCPUåˆ©ç”¨ç‡é«˜\nè¾“å…¥ä¸è¾“å‡º è®¾å¤‡\n  å—è®¾å¤‡\nå—è®¾å¤‡å­˜å‚¨åœ¨å›ºå®šå¤§å°çš„å—ä¸­ï¼Œæ¯ä¸ªå—æœ‰è‡ªå·±çš„åœ°å€ã€‚å—è®¾å¤‡çš„åŸºæœ¬ç‰¹å¾æ˜¯æ¯ä¸ªå—éƒ½èƒ½ç‹¬ç«‹äºå…¶ä»–å—è€Œè¯»å†™ã€‚ç¡¬ç›˜ã€CD-ROM å’Œ USB ç›˜æ˜¯æœ€å¸¸è§çš„å—è®¾å¤‡ã€‚\n  å­—ç¬¦è®¾å¤‡\nå­—ç¬¦è®¾å¤‡ä»¥å­—ç¬¦ä¸ºå•ä½å‘é€æˆ–æ¥æ”¶ä¸€ä¸ªå­—ç¬¦æµï¼Œè€Œä¸è€ƒè™‘ä»»ä½•å—ç»“æ„ã€‚å­—ç¬¦è®¾å¤‡æ˜¯ä¸å¯å¯»å€çš„ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•å¯»é“æ“ä½œã€‚æ‰“å°æœºã€ç½‘ç»œæ¥å£ã€é¼ æ ‡ï¼Œä»¥åŠå¤§å¤šæ•°ä¸ç£ç›˜ä¸åŒçš„è®¾å¤‡éƒ½å¯çœ‹ä½œæ˜¯å­—ç¬¦è®¾å¤‡ã€‚\n  IOæ§åˆ¶æ–¹å¼\n  ç¨‹åºç›´æ¥æ§åˆ¶æ–¹å¼ã€‚è®¡ç®—æœºä»å¤–éƒ¨è®¾å¤‡è¯»å–æ•°æ®åˆ°å­˜å‚¨å™¨ï¼Œæ¯æ¬¡è¯»ä¸€ä¸ªå­—çš„æ•°æ®ã€‚å¯¹è¯»å…¥çš„æ¯ä¸ªå­—ï¼ŒCPU éœ€è¦å¯¹å¤–è®¾çŠ¶æ€è¿›è¡Œå¾ªç¯æ£€æŸ¥çŸ¥é“ç¡®å®šè¯¥å­—å·²ç»åœ¨ I/O æ§åˆ¶å™¨çš„æ•°æ®å¯„å­˜å™¨ä¸­ã€‚\n  ä¸­æ–­é©±åŠ¨æ–¹å¼ã€‚å…è®¸ I/O è®¾å¤‡ä¸»åŠ¨æ‰“æ–­ CPU çš„è¿è¡Œå¹¶è¯·æ±‚æœåŠ¡ï¼Œä»è€Œâ€œè§£æ”¾â€ CPUï¼Œä½¿å¾—å…¶å‘ I/O æ§åˆ¶å™¨å‘é€è¯»å‘½ä»¤åå¯ä»¥ç»§ç»­åšå…¶ä»–æœ‰ç”¨çš„å·¥ä½œã€‚\n  DMA æ–¹å¼ã€‚DMA(ç›´æ¥å­˜å‚¨å™¨)æ–¹å¼çš„åŸºæœ¬æ€æƒ³æ˜¯åœ¨ I/O è®¾å¤‡å’Œå†…å­˜ä¹‹é—´å¼€è¾Ÿç›´æ¥çš„æ•°æ®äº¤æ¢é€šè·¯ï¼Œå½»åº•â€œè§£æ”¾â€ CPUã€‚DMAç‰¹ç‚¹å¦‚ä¸‹ï¼šï¼ˆ1ï¼‰åŸºæœ¬å•ä½æ˜¯æ•°æ®å— ï¼ˆ2ï¼‰æ‰€ä¼ é€çš„æ•°æ®ï¼Œæ˜¯ä»è®¾å¤‡ç›´æ¥é€å…¥å†…å­˜çš„ï¼Œæˆ–è€…ç›¸å ï¼ˆ3ï¼‰ä»…åœ¨ä¼ é€ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®å—çš„å¼€å§‹å’Œç»“æŸæ—¶ï¼Œæ‰éœ€ CPU å¹²é¢„ï¼Œæ•´å—æ•°æ®çš„ä¼ é€æ˜¯åœ¨ DMA æ§åˆ¶å™¨çš„æ§åˆ¶ä¸‹å®Œæˆçš„ã€‚\nä¸ºäº†åœ¨ä¸»æœºä¸æ§åˆ¶å™¨ä¹‹é—´å®ç°æˆå—æ•°æ®çš„ç›´æ¥äº¤æ¢ï¼Œå¿…é¡»åœ¨ DMA æ§åˆ¶å™¨ä¸­è®¾ç½®å¦‚ä¸‹4ç±»å¯„å­˜å™¨ï¼š\n å‘½ä»¤/çŠ¶æ€å¯„å­˜å™¨ï¼ˆCRï¼‰ã€‚ç”¨äºæ¥æ”¶ä» CPU å‘æ¥çš„ I/O å‘½ä»¤æˆ–æœ‰å…³æ§åˆ¶ä¿¡æ¯ï¼Œæˆ–è®¾å¤‡çš„çŠ¶æ€ã€‚ å†…å­˜åœ°å€å¯„å­˜å™¨ï¼ˆMARï¼‰ã€‚åœ¨è¾“å…¥æ—¶ï¼Œå®ƒå­˜æ”¾æŠŠæ•°æ®ä»è®¾å¤‡ä¼ é€åˆ°å†…å­˜çš„èµ·å§‹ç›®æ ‡åœ°å€ï¼›åœ¨è¾“å‡ºæ—¶ï¼Œå®ƒå­˜æ”¾ç”±å†…å­˜åˆ°è®¾å¤‡çš„å†…å­˜æºåœ°å€ã€‚ æ•°æ®å¯„å­˜å™¨ï¼ˆDRï¼‰ã€‚ç”¨äºæš‚å­˜ä»è®¾å¤‡åˆ°å†…å­˜æˆ–ä»å†…å­˜åˆ°è®¾å¤‡çš„æ•°æ®ã€‚ æ•°æ®è®¡æ•°å™¨ï¼ˆDCï¼‰ã€‚å­˜æ”¾æœ¬æ¬¡è¦ä¼ é€çš„å­—ï¼ˆèŠ‚ï¼‰æ•°ã€‚    é€šé“æ§åˆ¶æ–¹å¼ã€‚I/O é€šé“æ˜¯æŒ‡ä¸“é—¨è´Ÿè´£è¾“å…¥/è¾“å‡ºçš„å¤„ç†æœºã€‚I/O é€šé“æ˜¯ DMA æ–¹å¼çš„å‘å±•,å®ƒå¯ä»¥è¿›ä¸€æ­¥å‡å°‘ CPU çš„å¹²é¢„ï¼Œå³æŠŠå¯¹ä¸€ä¸ªæ•°æ®å—çš„è¯»ï¼ˆæˆ–å†™ï¼‰ä¸ºå•ä½çš„å¹²é¢„ï¼Œå‡å°‘ä¸ºå¯¹ä¸€ç»„æ•°æ®å—çš„è¯»ï¼ˆæˆ–å†™ï¼‰åŠæœ‰å…³æ§åˆ¶å’Œç®¡ç†ä¸ºå•ä½çš„å¹²é¢„ã€‚I/O é€šé“ä¸ä¸€èˆ¬å¤„ç†æœºçš„åŒºåˆ«æ˜¯ï¼šé€šé“æŒ‡ä»¤çš„ç±»å‹å•ä¸€æ²¡æœ‰è‡ªå·±çš„å†…å­˜ï¼Œé€šé“æ‰€æ‰§è¡Œçš„é€šé“ç¨‹åºæ˜¯æ”¾åœ¨ä¸»æœºå†…å­˜ä¸­çš„ï¼Œä¹Ÿå°±æ˜¯è¯´é€šé“ä¸ CPU å…±äº«å†…å­˜ã€‚I/O é€šé“ä¸ DMA æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼šDMA æ–¹å¼éœ€è¦ CPU æ¥æ§åˆ¶ä¼ è¾“çš„æ•°æ®å—å¤§å°ã€ä¼ è¾“çš„å†…å­˜ä½ç½®ï¼Œè€Œé€šé“æ–¹å¼ä¸­è¿™äº›ä¿¡æ¯æ˜¯ç”±é€šé“æ§åˆ¶çš„ã€‚å¦å¤–ï¼Œæ¯ä¸ª DMA æ§åˆ¶å™¨å¯¹åº”ä¸€å°è®¾å¤‡ä¸å†…å­˜ä¼ é€’æ•°æ®ï¼Œè€Œä¸€ä¸ªé€šé“å¯ä»¥æ§åˆ¶å¤šå°è®¾å¤‡ä¸å†…å­˜çš„æ•°æ®äº¤æ¢ã€‚\n  IOç³»ç»Ÿå±‚æ¬¡ç»“æ„\nå„å±‚æ¬¡åŠå…¶åŠŸèƒ½å¦‚ä¸‹ï¼š\n ç”¨æˆ·å±‚ I/O è½¯ä»¶ã€‚å®ç°ä¸ç”¨æˆ·äº¤äº’çš„æ¥å£ï¼Œç”¨æˆ·å¯ç›´æ¥è°ƒç”¨åœ¨ç”¨æˆ·å±‚æä¾›çš„ã€ä¸ I/O æ“ä½œæœ‰å…³çš„åº“å‡½æ•°ï¼Œå¯¹è®¾å¤‡è¿›è¡Œæ“ä½œã€‚ è®¾å¤‡ç‹¬ç«‹æ€§è½¯ä»¶ã€‚ç”¨äºå®ç°ç”¨æˆ·ç¨‹åºä¸è®¾å¤‡é©±åŠ¨å™¨çš„ç»Ÿä¸€æ¥å£ã€è®¾å¤‡å‘½ä»¤ã€è®¾å¤‡ä¿æŠ¤åŠè®¾å¤‡åˆ†é…ä¸é‡Šæ”¾ç­‰ï¼ŒåŒæ—¶ä¸ºè®¾å¤‡ç®¡ç†å’Œæ•°æ®ä¼ é€æä¾›å¿…è¦çš„å­˜å‚¨ç©ºé—´ã€‚ è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚ä¸ç¡¬ä»¶ç›´æ¥ç›¸å…³ï¼Œè´Ÿè´£å…·ä½“å®ç°ç³»ç»Ÿå¯¹è®¾å¤‡å‘å‡ºçš„æ“ä½œæŒ‡ä»¤ï¼Œé©±åŠ¨ I/O è®¾å¤‡å·¥ä½œçš„é©±åŠ¨ç¨‹åºã€‚ ä¸­æ–­å¤„ç†ç¨‹åºã€‚ç”¨äºä¿æŠ¤è¢«ä¸­æ–­è¿›ç¨‹çš„ CPU ç¯å¢ƒï¼Œè½¬å…¥ç›¸åº”çš„ä¸­æ–­å¤„ç†ç¨‹åºè¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œå¹¶æ¢å¤è¢«ä¸­æ–­è¿›ç¨‹çš„ç°åœºåï¼Œè¿”å›åˆ°è¢«ä¸­æ–­ç¨‹åºã€‚ ç¡¬ä»¶è®¾å¤‡ã€‚I/O è®¾å¤‡é€šå¸¸åŒ…æ‹¬ä¸€ä¸ªæœºæ¢°éƒ¨ä»¶å’Œä¸€ä¸ªç”µå­éƒ¨ä»¶ã€‚ä¸ºäº†è¾¾åˆ°è®¾è®¡çš„æ¨¡å—æ€§å’Œé€šç”¨æ€§ï¼Œä¸€èˆ¬å°†å…¶åˆ†å¼€ï¼šç”µå­éƒ¨ä»¶ç§°ä¸ºè®¾å¤‡æ§åˆ¶å™¨ï¼ˆæˆ–é€‚é…å™¨ï¼‰ï¼Œåœ¨ä¸ªäººè®¡ç®—æœºä¸­ï¼Œé€šå¸¸æ˜¯ä¸€å—æ’å…¥ä¸»æ¿æ‰©å……æ§½çš„å°åˆ¶ç”µè·¯æ¿ï¼›æœºæ¢°éƒ¨ä»¶åˆ™æ˜¯è®¾å¤‡æœ¬èº«ã€‚  å‚è€ƒ:\n https://github.com/jx453331958/blog/issues/17 ã€æ“ä½œç³»ç»Ÿã€‘ è¾“å…¥/è¾“å‡ºï¼ˆI/Oï¼‰ç®¡ç†  ","description":"","id":74,"section":"talks","tags":[""],"title":"interview","uri":"https://hugo.jiahongw.com/zh/talks/interview/"},{"content":"æ ‘æ˜¯ä¸€ç§éå¸¸å®ç”¨çš„ç»“æ„ï¼ğŸŒ´\nä»¥ä¸‹çš„äºŒå‰æ ‘é‡‡ç”¨çš„ç»“æ„éƒ½ä¸ºé“¾å¼ç»“æ„\n1 2 3 4 5  typedef struct BiTNode /* ç»“ç‚¹ç»“æ„ */ { int data; /* ç»“ç‚¹æ•°æ® */ struct BiTNode *lchild, *rchild; /* å·¦å³å­©å­æŒ‡é’ˆ */ } BiTNode, *BiTree;   1. äºŒå‰æ’åºæ ‘  äºŒå‰æ’åºæ ‘åˆç§°â€œäºŒå‰æŸ¥æ‰¾æ ‘â€ã€â€œäºŒå‰æœç´¢æ ‘â€ã€‚\n å®šä¹‰ æˆ–è€…æ˜¯ä¸€æ£µç©ºæ ‘ï¼Œæˆ–è€…æ˜¯å…·æœ‰ä¸‹åˆ—æ€§è´¨çš„äºŒå‰æ ‘ï¼š\n  è‹¥å®ƒçš„å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼›\n  è‹¥å®ƒçš„å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼›\n  å®ƒçš„å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æ’åºæ ‘ã€‚\n   ä¸­åºéå†äºŒå‰æ’åºæ ‘å¯å¾—åˆ°ä¸€ä¸ªä¾æ®å…³é”®å­—çš„æœ‰åºåºåˆ—ï¼Œä¸€ä¸ªæ— åºåºåˆ—å¯ä»¥é€šè¿‡æ„é€ ä¸€æ£µäºŒå‰æ’åºæ ‘å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ï¼Œæ„é€ æ ‘çš„è¿‡ç¨‹å³æ˜¯å¯¹æ— åºåºåˆ—è¿›è¡Œæ’åºçš„è¿‡ç¨‹ã€‚æ¯æ¬¡æ’å…¥çš„æ–°çš„ç»“ç‚¹éƒ½æ˜¯äºŒå‰æ’åºæ ‘ä¸Šæ–°çš„å¶å­ç»“ç‚¹ï¼Œåœ¨è¿›è¡Œæ’å…¥æ“ä½œæ—¶ï¼Œä¸å¿…ç§»åŠ¨å…¶å®ƒç»“ç‚¹ï¼Œåªéœ€æ”¹åŠ¨æŸä¸ªç»“ç‚¹çš„æŒ‡é’ˆï¼Œç”±ç©ºå˜ä¸ºéç©ºå³å¯ã€‚æœç´¢ã€æ’å…¥ã€åˆ é™¤çš„æ—¶é—´å¤æ‚åº¦ç­‰äºæ ‘é«˜ï¼ŒæœŸæœ›O(logn)ï¼Œæœ€åO(n)ï¼ˆæ•°åˆ—æœ‰åºï¼Œæ ‘é€€åŒ–æˆçº¿æ€§è¡¨ï¼Œå¦‚å³æ–œæ ‘ï¼‰ã€‚\n æŸ¥æ‰¾ç®—æ³• æŸ¥æ‰¾è¿‡ç¨‹ï¼š\n1.è‹¥bæ˜¯ç©ºæ ‘ï¼Œåˆ™æœç´¢å¤±è´¥ï¼Œå¦åˆ™ï¼š\n2.è‹¥xç­‰äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™æŸ¥æ‰¾æˆåŠŸï¼›å¦åˆ™ï¼š\n3.è‹¥xå°äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™æœç´¢å·¦å­æ ‘ï¼›å¦åˆ™ï¼š\n4.æŸ¥æ‰¾å³å­æ ‘ã€‚\n5.è‹¥æŸ¥æ‰¾ä¸æˆåŠŸï¼Œ åˆ™æŒ‡é’ˆ p æŒ‡å‘æŸ¥æ‰¾è·¯å¾„ä¸Šè®¿é—®çš„æœ€åä¸€ä¸ªç»“ç‚¹å¹¶è¿”å›FALSE\næ’å…¥ç®—æ³• æ’å…¥è¿‡ç¨‹ï¼š\n  å…ˆè°ƒç”¨æŸ¥æ‰¾æ“ä½œå°†è¦æ’å…¥çš„å…³é”®å­—è¿›è¡Œæ¯”è¾ƒ\n  å¦‚æœåœ¨åŸæœ‰çš„äºŒå‰æ’åºæ ‘ä¸­æ²¡æœ‰è¦æ’å…¥çš„å…³é”®å­—ï¼Œåˆ™å°†å…³é”®å­—ä¸æŸ¥æ‰¾çš„ç»“ç‚¹pï¼ˆåœ¨æŸ¥æ‰¾æ“ä½œä¸­è¿”å›çš„ç»“ç‚¹ï¼‰çš„å€¼è¿›è¡Œæ¯”è¾ƒ\n  è‹¥pä¸ºç©ºï¼Œåˆ™æ’å…¥å…³é”®å­—èµ‹å€¼ç»™è¯¥èŠ‚ç‚¹ï¼›\n  è‹¥å°äºç»“ç‚¹pçš„å€¼ï¼Œåˆ™æ’å…¥å…³é”®å­—ä½œä¸ºç»“ç‚¹pçš„å·¦å­æ ‘ï¼›\n  è‹¥å¤§äºç»“ç‚¹pçš„å€¼ï¼Œåˆ™æ’å…¥å…³é”®å­—ä½œä¸ºç»“ç‚¹pçš„å³å­æ ‘ï¼›\n   æ¯æ¬¡éœ€è¦æ’å…¥çš„èŠ‚ç‚¹éƒ½ä¸ºå¶å­èŠ‚ç‚¹ã€‚\n åˆ é™¤ç®—æ³• åˆ å»ä¸€ä¸ªç»“ç‚¹ï¼Œåˆ†ä¸‰ç§æƒ…å†µè®¨è®ºï¼š\n  è‹¥*pç»“ç‚¹ä¸ºå¶å­ç»“ç‚¹ï¼Œå³PL(å·¦å­æ ‘)å’ŒPR(å³å­æ ‘)å‡ä¸ºç©ºæ ‘ã€‚ç”±äºåˆ å»å¶å­ç»“ç‚¹ä¸ç ´åæ•´æ£µæ ‘çš„ç»“æ„ï¼Œåˆ™åªéœ€ä¿®æ”¹å…¶åŒäº²ç»“ç‚¹çš„æŒ‡é’ˆå³å¯ã€‚\n  è‹¥pç»“ç‚¹åªæœ‰å·¦å­æ ‘PLæˆ–å³å­æ ‘PRï¼Œæ­¤æ—¶åªè¦ä»¤PLæˆ–PRç›´æ¥æˆä¸ºå…¶åŒäº²ç»“ç‚¹fçš„å·¦å­æ ‘ï¼ˆå½“pæ˜¯å·¦å­æ ‘ï¼‰æˆ–å³å­æ ‘ï¼ˆå½“pæ˜¯å³å­æ ‘ï¼‰å³å¯ï¼Œä½œæ­¤ä¿®æ”¹ä¹Ÿä¸ç ´åäºŒå‰æ’åºæ ‘çš„ç‰¹æ€§ã€‚\n  è‹¥pç»“ç‚¹çš„å·¦å­æ ‘å’Œå³ å­æ ‘å‡ä¸ç©ºã€‚åœ¨åˆ å»pä¹‹åï¼Œä¸ºä¿æŒå…¶å®ƒå…ƒç´ ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œå¯æŒ‰ä¸­åºéå†ä¿æŒæœ‰åºè¿›è¡Œè°ƒæ•´ã€‚æ¯”è¾ƒå¥½çš„åšæ³•æ˜¯ï¼Œæ‰¾åˆ°*pçš„**ç›´æ¥å‰é©±ï¼ˆæˆ–ç›´æ¥åç»§ï¼‰sï¼Œç”¨sæ¥æ›¿æ¢ç»“ç‚¹pï¼Œç„¶åå†åˆ é™¤ç»“ç‚¹sã€‚(ä¾é ä¸­åºéå†åœ¨pèŠ‚ç‚¹ä¸‹è¿›è¡Œéå†å¾—åˆ°çš„æœ€åä¸€ä¸ªæ•°å³ä¸ºæ›¿æ¢çš„èŠ‚ç‚¹)\n  æ€§èƒ½åˆ†æ  æœ€å¥½çš„æƒ…å†µæ˜¯äºŒå‰æ’åºæ ‘çš„å½¢æ€å’ŒæŠ˜åŠæŸ¥æ‰¾çš„åˆ¤å®šæ ‘ç›¸åŒï¼Œå…¶å¹³å‡æŸ¥æ‰¾é•¿åº¦å’Œlognæˆæ­£æ¯”ï¼ˆO(log2(n))ï¼‰ã€‚ æœ€åæƒ…å†µä¸‹ï¼Œå½“å…ˆåæ’å…¥çš„å…³é”®å­—æœ‰åºæ—¶ï¼Œæ„æˆçš„äºŒå‰æ’åºæ ‘ä¸ºä¸€æ£µæ–œæ ‘ï¼Œæ ‘çš„æ·±åº¦ä¸ºnï¼Œå…¶å¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º(n + 1) / 2ã€‚ä¹Ÿå°±æ˜¯æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œç­‰åŒäºé¡ºåºæŸ¥æ‰¾ã€‚   è™½ç„¶äºŒå‰æ’åºæ ‘çš„æœ€åæ•ˆç‡æ˜¯O(n)ï¼Œä½†å®ƒæ”¯æŒåŠ¨æ€æŸ¥æ‰¾ã€‚æœ€å¥½æ˜¯æŠŠå®ƒæ„å»ºæˆä¸€æ£µå¹³è¡¡çš„äºŒå‰æ’åºæ ‘ï¼ˆå¹³è¡¡äºŒå‰æ ‘ï¼‰ï¼Œè¿™äº›å¹³è¡¡äºŒå‰æ ‘å¯ä»¥ä½¿æ ‘é«˜ä¸ºO(logn)ï¼Œå¦‚AVLã€çº¢é»‘æ ‘ç­‰ã€‚\n 2. å¹³è¡¡äºŒå‰æ ‘ï¼ˆAVLï¼‰ å®šä¹‰ å®ƒæˆ–è€…æ˜¯ä¸€é¢—ç©ºæ ‘ï¼Œæˆ–è€…å…·æœ‰ä»¥ä¸‹æ€§è´¨çš„äºŒå‰æ ‘ï¼šå®ƒçš„å·¦å­æ ‘å’Œå³å­æ ‘çš„æ·±åº¦ä¹‹å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1ï¼Œä¸”å®ƒçš„å·¦å­æ ‘å’Œå³å­æ ‘éƒ½æ˜¯ä¸€é¢—å¹³è¡¡äºŒå‰æ ‘ã€‚\nå¹³è¡¡å› å­(bf)ï¼šç»“ç‚¹çš„å·¦å­æ ‘çš„æ·±åº¦å‡å»å³å­æ ‘çš„æ·±åº¦ï¼Œé‚£ä¹ˆæ˜¾ç„¶-1\u0026lt;=bf\u0026lt;=1;\n åœ¨AVLæ ‘ä¸­ï¼Œä»»ä¸€èŠ‚ç‚¹å¯¹åº”çš„ä¸¤æ£µå­æ ‘çš„æœ€å¤§é«˜åº¦å·®ä¸º1ï¼Œå› æ­¤å®ƒä¹Ÿè¢«ç§°ä¸ºé«˜åº¦å¹³è¡¡æ ‘ã€‚\n æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤åœ¨å¹³å‡å’Œæœ€åæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯$O(log(n))$ã€‚å¢åŠ å’Œåˆ é™¤å…ƒç´ çš„æ“ä½œåˆ™å¯èƒ½éœ€è¦å€Ÿç”±ä¸€æ¬¡æˆ–å¤šæ¬¡æ ‘æ—‹è½¬ï¼Œä»¥å®ç°æ ‘çš„é‡æ–°å¹³è¡¡ã€‚\næŸ¥æ‰¾æ“ä½œ å¹³è¡¡äºŒå‰æ ‘çš„æŸ¥æ‰¾åŸºæœ¬ä¸äºŒå‰æŸ¥æ‰¾æ ‘ç›¸åŒã€‚\næ’å…¥æ“ä½œ åœ¨å¹³è¡¡äºŒå‰æ ‘ä¸­æ’å…¥ç»“ç‚¹ä¸äºŒå‰æŸ¥æ‰¾æ ‘æœ€å¤§çš„ä¸åŒåœ¨äºè¦éšæ—¶ä¿è¯æ’å…¥åæ•´æ£µäºŒå‰æ ‘æ˜¯å¹³è¡¡çš„ã€‚é‚£ä¹ˆè°ƒæ•´ä¸å¹³è¡¡æ ‘çš„åŸºæœ¬æ–¹æ³•å°±æ˜¯ï¼š æ—‹è½¬ ã€‚\né¦–å…ˆï¼Œè¿˜éœ€è¦æ˜ç™½çš„ä¸€ä¸ªæ¦‚å¿µå°±æ˜¯ï¼š\næœ€å°ä¸å¹³è¡¡å­æ ‘çš„æ ¹ç»“ç‚¹ï¼šä¹Ÿå°±æ˜¯å½“ä½ è¿›è¡Œæ’å…¥æ“ä½œæ—¶ï¼Œæ‰¾åˆ°è¯¥éœ€è¦æ’å…¥ç»“ç‚¹çš„ä½ç½®å¹¶æ’å…¥åï¼Œä»è¯¥ç»“ç‚¹èµ·å‘ä¸Šå¯»æ‰¾ï¼ˆå›æº¯ï¼‰ï¼Œç¬¬ä¸€ä¸ªä¸å¹³è¡¡çš„ç»“ç‚¹å³å¹³è¡¡å› å­bfå˜ä¸º-2æˆ–2çš„èŠ‚ç‚¹ã€‚\n é‚£ç©¶ç«Ÿæ˜¯å¦‚ä½•â€œè½¬â€çš„å‘¢ï¼Ÿ\nå…¶å®ï¼Œå¯ä»¥æ¢ä¸€ç§æ€è·¯æ€è€ƒï¼Œä¸è®©å®ƒå«â€œæ—‹è½¬â€ï¼è€Œå«â€”â€”\u0026gt;â€œä¸¤ä¸ªç»“ç‚¹çš„å˜æ¢â€\n ä¸‹é¢åˆ†æƒ…å†µåˆ†æå››ç§æ—‹è½¬æ–¹å¼\nå·¦å·¦ å³åœ¨xçš„å·¦å­©å­açš„å·¦å­©å­cä¸Šæ’å…¥ä¸€ä¸ªç»“ç‚¹yï¼ˆè¯¥ç»“ç‚¹ä¹Ÿå¯ä»¥æ˜¯c,å¦‚å›¾â‘ ï¼‰ï¼Œå³yå¯ä»¥æ˜¯cï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å·¦å­©å­ï¼ˆå¦‚å›¾â‘¡ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å³å­©å­ï¼ˆä¸åœ¨ç”»å‡ºï¼‰\n è¿™ç§å·¦å·¦æ’å…¥æ–¹å¼æœ‰ä¸€ä¸ªè§„å¾‹ï¼šä¸å¹³è¡¡å­æ ‘çš„å·¦å­æ ‘æ·±åº¦æ¯”å³å­æ ‘æ·±åº¦å¤§2.\n å›¾â‘ â‘¡æ’å…¥çš„èŠ‚ç‚¹éƒ½ä¸ºyï¼Œæ­¤æ—¶å‘ä¸Šå›æº¯ç¬¬ä¸€ä¸ªä¸å¹³è¡¡çš„å­æ ‘æ ¹èŠ‚ç‚¹ä¸ºxï¼Œé‚£ä¹ˆå°†xèŠ‚ç‚¹åŠå…¶å³å­æ ‘(å›¾â‘ ä¸ºNULLï¼Œå›¾â‘¡ä¸ºb)ä¸€èµ·ç»•ç€xçš„å·¦å­æ ‘æ ¹èŠ‚ç‚¹(å³a)å³æ—‹(å³é¡ºæ—¶é’ˆæ—‹è½¬),ç„¶åå°†açš„å³å­æ ‘ä½œä¸ºxçš„å·¦å­æ ‘ï¼Œå‡å¦‚açš„å³å­æ ‘ä¸ºç©ºåˆ™ä¸å¿…æ’å…¥ã€‚é‚£ä¹ˆè¿™æ ·æ—‹è½¬æœ€åå°†ä¸å¹³è¡¡å­æ ‘å˜ä¸ºå¹³è¡¡ã€‚\nå³å³ å³åœ¨xçš„å³å­©å­açš„å³å­©å­cä¸Šæ’å…¥ä¸€ä¸ªç»“ç‚¹yï¼ˆè¯¥ç»“ç‚¹ä¹Ÿå¯ä»¥æ˜¯c,å¦‚å›¾â‘ ï¼‰ï¼Œå³yå¯ä»¥æ˜¯cï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å³å­©å­ï¼ˆå¦‚å›¾â‘¡ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å·¦å­©å­ï¼ˆä¸åœ¨ç”»å‡ºï¼‰\n è¿™ç§å³å³æ’å…¥æ–¹å¼æœ‰ä¸€ä¸ªè§„å¾‹ï¼šä¸å¹³è¡¡å­æ ‘çš„å·¦å­æ ‘æ·±åº¦æ¯”å³å­æ ‘æ·±åº¦å°2.\n å›¾â‘ â‘¡æ’å…¥çš„èŠ‚ç‚¹éƒ½ä¸ºyï¼Œæ­¤æ—¶å‘ä¸Šå›æº¯æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸å¹³è¡¡å­æ ‘çš„èŠ‚ç‚¹ä¸ºxï¼Œéœ€è¦å°†èŠ‚ç‚¹xåŠå…¶å·¦å­æ ‘(å›¾â‘ ä¸ºNULLï¼Œå›¾äºŒä¸ºb)ç»•ç€xå³å­æ ‘(ä¸¤å›¾éƒ½ä¸ºaä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘)è¿›è¡Œå·¦æ—‹(é€†æ—¶é’ˆæ—‹è½¬),ç„¶åå°†å…¶å³å­æ ‘(a)çš„å·¦èŠ‚ç‚¹ä½œä¸ºxçš„å³èŠ‚ç‚¹ï¼Œè¿™æ ·ä½¿å¾—ä¸å¹³è¡¡å­æ ‘åˆå†åº¦å¹³è¡¡ã€‚\nå·¦å³ å³åœ¨xçš„å·¦å­©å­açš„å³å­©å­cä¸Šæ’å…¥ä¸€ä¸ªç»“ç‚¹yï¼ˆè¯¥ç»“ç‚¹ä¹Ÿå¯ä»¥æ˜¯c,å¦‚å›¾â‘ ï¼‰ï¼Œå³yå¯ä»¥æ˜¯cï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å³å­©å­ï¼ˆå¦‚å›¾â‘¡ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å·¦å­©å­ï¼ˆä¸åœ¨ç”»å‡ºï¼‰\n è¿™ç§å·¦å³æ’å…¥çš„è§„å¾‹å°±æ˜¯ï¼šä¸å¹³è¡¡å­æ ‘çš„å·¦å­æ ‘é«˜åº¦æ¯”å³å­æ ‘å¤§2ä¸”å·¦å­æ ‘çš„å³å­æ ‘æ¯”å·¦å­æ ‘çš„å·¦å­æ ‘æ·±åº¦æ·±ã€‚\n å‘ä¸Šå›æº¯çš„ç¬¬ä¸€ä¸ªä¸å¹³è¡¡å­æ ‘ä¸ºxï¼Œå…ˆå¯¹xçš„å·¦å­æ ‘å·¦æ—‹(æ—‹è½¬ä¸­å¿ƒä¸ºc)ï¼Œå†å¯¹xçš„å·¦å­æ ‘è¿›è¡Œå³æ—‹(æ—‹è½¬ä¸­å¿ƒä¸ºc)ã€‚(æ—‹è½¬ä¸­å¿ƒä¸ºå·¦å­æ ‘çš„å³èŠ‚ç‚¹)\n å¦‚æœæ˜¯å›¾â‘ ï¼Œæ—‹è½¬ä¸­å¿ƒä¸ºy\n å³å·¦ å³åœ¨xçš„å³å­©å­açš„å·¦å­©å­cä¸Šæ’å…¥ä¸€ä¸ªç»“ç‚¹yï¼ˆè¯¥ç»“ç‚¹ä¹Ÿå¯ä»¥æ˜¯c,å¦‚å›¾â‘ ï¼‰ï¼Œå³yå¯ä»¥æ˜¯cï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å³å­©å­ï¼ˆå¦‚å›¾â‘¡ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å·¦å­©å­ï¼ˆä¸åœ¨ç”»å‡ºï¼‰\n è¿™ç§å³å·¦æ’å…¥çš„è§„å¾‹å°±æ˜¯ï¼šä¸å¹³è¡¡å­æ ‘çš„å³å­æ ‘é«˜åº¦æ¯”å·¦å­æ ‘å¤§2ä¸”å³å­æ ‘çš„å·¦å­æ ‘æ¯”å³å­æ ‘çš„å³å­æ ‘æ·±åº¦æ·±ã€‚\n å‘ä¸Šå›æº¯çš„ç¬¬ä¸€ä¸ªä¸å¹³è¡¡å­æ ‘ä¸ºxï¼Œå…ˆå¯¹xçš„å³å­æ ‘å³æ—‹(æ—‹è½¬ä¸­å¿ƒä¸ºc)ï¼Œå†å¯¹xçš„å³å­æ ‘è¿›è¡Œå·¦æ—‹(æ—‹è½¬ä¸­å¿ƒä¸ºc)ã€‚(æ—‹è½¬ä¸­å¿ƒä¸ºå·¦å­æ ‘çš„å³èŠ‚ç‚¹)\n å¦‚æœæ˜¯å›¾â‘ ï¼Œæ—‹è½¬ä¸­å¿ƒä¸ºy\n AVLæ ‘çš„æ“ä½œæ±‡æ€»ï¼š\nåˆ é™¤æ“ä½œ åˆ é™¤ç±»ä¼¼æ’å…¥çš„æ“ä½œã€‚åˆ é™¤æ—¶å°‘ä¸€ä¸ªç»“ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯¥ç»“ç‚¹æ‰€åœ¨çš„å­æ ‘æ·±åº¦å¯èƒ½ä¼šå‡å°ï¼Œè€Œæ’å…¥æ—¶å¤šä¸€ä¸ªç»“ç‚¹ï¼Œè¯¥ç»“ç‚¹æ‰€åœ¨çš„å­æ ‘æ·±åº¦å¯èƒ½ä¼šå¢åŠ ï¼Œæ‰€ä»¥é€’å½’åˆ é™¤ä¸€ä¸ªç»“ç‚¹æ—¶ï¼Œå›æº¯æ—¶æ‰¾åˆ°æœ€å°ä¸å¹³è¡¡å­æ ‘çš„æ ¹ç»“ç‚¹æ—¶ï¼Œè¦å‘ç›¸åçš„æ–¹å‘å»æ‰¾å±äºå“ªç§æƒ…å†µï¼›\nå¦‚å›¾yä¸ºè¦åˆ é™¤çš„èŠ‚ç‚¹\nå›¾â‘ ï¼šyç»“ç‚¹åˆ é™¤åï¼Œå›æº¯åˆ°xç»“ç‚¹ä»bf=-1å˜ä¸ºbf=-2ï¼›åˆ™éœ€ä»ç›¸åæ–¹å‘å³ä»xçš„å³å­©å­çš„æ–¹å‘å‘ä¸‹æ£€æŸ¥å±äºå“ªç§æƒ…å†µï¼Œæ˜¾ç„¶ç¬¬ä¸€ä¸ªæ–¹å‘ä¸º1ï¼šå³ï¼›ç¬¬äºŒä¸ªæ–¹å‘çœ‹açš„bfçš„å€¼â€”â€”è‹¥ä¸º1æ—¶ï¼Œé‚£å°±ç›¸å½“äºæ’å…¥æ—¶â€˜å³å·¦â€™çš„æƒ…å†µï¼›è‹¥ä¸º-1æ—¶ï¼Œé‚£å°±ç›¸å½“äºæ’å…¥æ—¶â€˜å³å³â€™çš„æƒ…å†µï¼›å¯ç°åœ¨açš„bfæ—¢ä¸æ˜¯1ä¹Ÿä¸æ˜¯-1è€Œæ˜¯0ï¼Œè¿™å°±æ˜¯åˆ é™¤çš„ç‰¹æ®Šæƒ…å†µäº†ï¼æˆ‘ä»¬ä¸å¦¨è¯•è¯•å¯¹ä»–è¿›è¡Œç±»ä¼¼äºæ’å…¥æ—¶çš„â€˜å³å³â€™æ“ä½œï¼Œçœ‹æ€ä¹ˆæ ·~ å¦‚ä¸Šå›¾ï¼Œç»è¿‡å˜æ¢åè¯¥å­æ ‘å¹³è¡¡äº†ï¼ä½†æ˜¯å› å­çš„ä¿®æ”¹å°±è·Ÿæ’å…¥æ—¶çš„â€˜å³å³â€™ä¸ä¸€æ ·äº†ï¼æ­¤æ—¶å˜ä¸ºï¼šxçš„bf=-1,açš„bf=1ï¼›æ‰€ä»¥æˆ‘ä»¬ä¸å¦¨å°±æŠŠaçš„bf=0ä¹Ÿå½’çº³ä¸ºåˆ é™¤çš„â€˜å³å³â€™æˆ–â€˜å·¦å·¦â€™ï¼ˆå¦‚å›¾â‘¡ï¼Œä¸å†æ•–è¿°ï¼‰æ“ä½œï¼›\né‚£ä¹ˆåˆ é™¤æ—¶å› å­çš„æ”¹å˜éœ€åœ¨æ’å…¥æ—¶å› å­çš„æ”¹å˜ä¸­æ·»åŠ ä¸Šï¼š\nå·¦å·¦ï¼šå‰a:bf=0 åx:bf=1,a:bf=-1ï¼› å³å³ï¼šå‰a:bf=0 åx:bf=-1,a:bf=1ï¼›å…¶ä»–ä¸å˜ï¼\n å¯ä»¥æƒ³è±¡ï¼Œå…¶å®æ˜¯å¾ˆç®€å•çš„é“ç†ï¼šé™¤äº†ç‰¹æ®Šæƒ…å†µå…¶ä»–éƒ½ä¸æ’å…¥çš„æƒ…å†µä¸€æ¨¡ä¸€æ ·ï¼Œè¯´ç™½äº†å°±æ˜¯æŠŠæ·±åº¦å¤§çš„å­æ ‘ï¼ˆæ ¹ç»“ç‚¹çš„å…¶ä¸­ä¸€ä¸ªï¼‰å‘æ·±åº¦å°å­æ ‘è´¡çŒ®ä¸€ä¸ªæ·±åº¦ï¼Œé‚£ä¹ˆè¿™æ ·ä¸€æ¥ï¼Œè¯¥å­æ ‘ï¼ˆå¯¹äºæ ¹ç»“ç‚¹æ‰€é¢†å¯¼çš„æ ‘ï¼‰çš„æ·±åº¦æ˜¯ä¸æ˜¯æ¯”åŸæ¥çš„å°1äº†ï¼Ÿï¼æ‰€ä»¥è¦ç»§ç»­å‘ä¸Šä¸€ä¸ªä¸€ä¸ªè¿›è¡Œæ£€ç´¢ï¼Œç›´åˆ°æ ¹ç»“ç‚¹ä¸ºæ­¢ï¼\n ä»£ç å®ç° https://blog.csdn.net/nightwizard2030/article/details/72874715\næ€§èƒ½åˆ†æ ä¼˜åŠ¿ å¹³è¡¡äºŒå‰æ ‘çš„ä¼˜åŠ¿åœ¨äºä¸ä¼šå‡ºç°æ™®é€šäºŒå‰æŸ¥æ‰¾æ ‘çš„æœ€å·®æƒ…å†µã€‚å…¶æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(logN)$ã€‚\nç¼ºé™·  ä¸ºäº†ä¿è¯é«˜åº¦å¹³è¡¡ï¼ŒåŠ¨æ€æ’å…¥å’Œåˆ é™¤çš„ä»£ä»·ä¹Ÿéšä¹‹å¢åŠ . æ‰€æœ‰äºŒå‰æŸ¥æ‰¾æ ‘ç»“æ„çš„æŸ¥æ‰¾ä»£ä»·éƒ½ä¸æ ‘é«˜æ˜¯ç´§å¯†ç›¸å…³çš„ï¼Œèƒ½å¦é€šè¿‡å‡å°‘æ ‘é«˜æ¥è¿›ä¸€æ­¥é™ä½æŸ¥æ‰¾ä»£ä»·å‘¢ã€‚  åº”ç”¨åœºæ™¯ åº”ç”¨ï¼šwindowså¯¹è¿›ç¨‹åœ°å€ç©ºé—´çš„ç®¡ç†ç”¨åˆ°äº†AVLæ ‘ã€‚\n3. çº¢é»‘æ ‘ ä¹Ÿè¢«ç§°ä¸º\u0026rdquo;å¯¹ç§°äºŒå‰Bæ ‘\u0026quot;ã€‚\nå®šä¹‰ çº¢é»‘æ ‘(red-black tree) æ˜¯ä¸€æ£µæ»¡è¶³ä¸‹è¿°æ€§è´¨çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼š\n  æ¯ä¸€ä¸ªç»“ç‚¹è¦ä¹ˆæ˜¯çº¢è‰²ï¼Œè¦ä¹ˆæ˜¯é»‘è‰²ã€‚\n  æ ¹ç»“ç‚¹æ˜¯é»‘è‰²çš„ã€‚\n  æ‰€æœ‰å¶å­ç»“ç‚¹éƒ½æ˜¯é»‘è‰²çš„ï¼ˆå®é™…ä¸Šéƒ½æ˜¯NullæŒ‡é’ˆï¼Œä¸‹å›¾ç”¨NILè¡¨ç¤ºï¼‰ã€‚å¶å­ç»“ç‚¹ä¸åŒ…å«ä»»ä½•å…³é”®å­—ä¿¡æ¯ï¼Œæ‰€æœ‰æŸ¥è¯¢å…³é”®å­—éƒ½åœ¨éç»ˆç»“ç‚¹ä¸Šã€‚\n  æ¯ä¸ªçº¢è‰²ç»“ç‚¹çš„ä¸¤ä¸ªå­èŠ‚ç‚¹å¿…é¡»æ˜¯é»‘è‰²çš„ã€‚æ¢å¥è¯è¯´ï¼šä»æ¯ä¸ªå¶å­åˆ°æ ¹çš„æ‰€æœ‰è·¯å¾„ä¸Šä¸èƒ½æœ‰ä¸¤ä¸ªè¿ç»­çš„çº¢è‰²ç»“ç‚¹\n  ä»ä»»ä¸€ç»“ç‚¹åˆ°å…¶æ¯ä¸ªå¶å­çš„æ‰€æœ‰è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²ç»“ç‚¹\n  å‡ ä¸ªæ¦‚å¿µï¼š\né»‘æ·±åº¦ â€”â€”ä»æŸä¸ªç»“ç‚¹xå‡ºå‘(ä¸åŒ…æ‹¬ç»“ç‚¹xæœ¬èº«)åˆ°å¶ç»“ç‚¹(åŒ…æ‹¬å¶å­ç»“ç‚¹)çš„è·¯å¾„ä¸Šçš„é»‘ç»“ç‚¹ä¸ªæ•°,ç§°ä¸ºè¯¥ç»“ç‚¹xçš„é»‘æ·±åº¦,è®°ä¸º$bd(x)$,æ ¹ç»“ç‚¹çš„é»‘æ·±åº¦å°±æ˜¯è¯¥çº¢é»‘æ ‘çš„é»‘æ·±åº¦ã€‚å¶å­ç»“ç‚¹çš„é»‘æ·±åº¦ä¸º0ã€‚æ¯”å¦‚ï¼šä¸Šå›¾$bd(13)=2ï¼Œ bd(8)=2ï¼Œ bd(1)=1$\nå†…éƒ¨ç»“ç‚¹ â€”â€” çº¢é»‘æ ‘çš„éç»ˆç»“ç‚¹\nå¤–éƒ¨èŠ‚ç‚¹ â€”â€” çº¢é»‘æ ‘çš„å¶å­ç»“ç‚¹\nç›¸å…³åŸç†  ä»æ ¹åˆ°å¶å­çš„æœ€é•¿çš„å¯èƒ½è·¯å¾„ä¸å¤šäºæœ€çŸ­çš„å¯èƒ½è·¯å¾„çš„ä¸¤å€é•¿ã€‚ çº¢é»‘æ ‘çš„æ ‘é«˜$(h)$ä¸å¤§äºä¸¤å€çš„çº¢é»‘æ ‘çš„é»‘æ·±åº¦$(bd)$ï¼Œå³$h\u0026lt;=2bd$ ä¸€æ£µæ‹¥æœ‰nä¸ªå†…éƒ¨ç»“ç‚¹(ä¸åŒ…æ‹¬å¶å­ç»“ç‚¹)çš„çº¢é»‘æ ‘çš„æ ‘é«˜$h\u0026lt;=2log(n+1)$  æŸ¥æ‰¾æ“ä½œ å› ä¸ºæ¯ä¸€ä¸ªçº¢é»‘æ ‘ä¹Ÿæ˜¯ä¸€ä¸ªç‰¹åŒ–çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œå› æ­¤çº¢é»‘æ ‘ä¸Šçš„æŸ¥æ‰¾æ“ä½œä¸æ™®é€šäºŒå‰æŸ¥æ‰¾æ ‘ä¸Šçš„æŸ¥æ‰¾æ“ä½œç›¸åŒ.\næ’å…¥æ“ä½œ æˆ‘ä»¬é¦–å…ˆä»¥äºŒå‰æŸ¥æ‰¾æ ‘çš„æ–¹æ³•å¢åŠ èŠ‚ç‚¹å¹¶æ ‡è®°å®ƒä¸ºçº¢è‰²ã€‚ä¸‹é¢è¦è¿›è¡Œä»€ä¹ˆæ“ä½œå–å†³äºå…¶ä»–ä¸´è¿‘èŠ‚ç‚¹çš„é¢œè‰²ã€‚åŒäººç±»çš„å®¶æ—æ ‘ä¸­ä¸€æ ·ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœ¯è¯­å”çˆ¶èŠ‚ç‚¹æ¥æŒ‡ä¸€ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹ã€‚\nå‡è®¾æ–°åŠ å…¥çš„ç»“ç‚¹ä¸ºNï¼Œçˆ¶äº²ç»“ç‚¹ä¸ºPï¼Œå”çˆ¶ç»“ç‚¹ä¸ºUi(å”çˆ¶ç»“ç‚¹å°±æ˜¯ä¸€äº›åˆ—Pçš„å…„å¼Ÿç»“ç‚¹)ï¼Œç¥–çˆ¶ç»“ç‚¹G(çˆ¶äº²ç»“ç‚¹Pçš„çˆ¶äº²)ã€‚\næƒ…å†µ1. å½“å‰çº¢é»‘æ ‘ä¸ºç©ºï¼Œæ–°ç»“ç‚¹Nä½äºæ ‘çš„æ ¹ä¸Šï¼Œæ²¡æœ‰çˆ¶ç»“ç‚¹ã€‚\næ­¤æ—¶å¾ˆç®€å•ï¼Œæˆ‘ä»¬å°†ç›´æ¥æ’å…¥ä¸€ä¸ªé»‘ç»“ç‚¹Nï¼ˆæ»¡è¶³æ€§è´¨2ï¼‰ï¼Œå› ä¸ºæ˜¯ç‰¹æ®Šå¤§çš„æƒ…å†µï¼Œä¸æ’å…¥çº¢è‰²è€Œæ’å…¥é»‘è‰²èŠ‚ç‚¹ã€‚\næƒ…å†µ2. æ–°ç»“ç‚¹Nçš„çˆ¶ç»“ç‚¹Pæ˜¯é»‘è‰²ã€‚\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ’å…¥ä¸€ä¸ªçº¢è‰²ç»“ç‚¹N(æ»¡è¶³æ€§è´¨5)\n æ³¨æ„ï¼šåœ¨æƒ…å†µ3ï¼Œ4ï¼Œ5ä¸‹ï¼Œæˆ‘ä»¬å‡å®šæ–°èŠ‚ç‚¹æœ‰ç¥–çˆ¶èŠ‚ç‚¹ï¼Œå› ä¸ºçˆ¶èŠ‚ç‚¹æ˜¯çº¢è‰²ï¼›å¹¶ä¸”å¦‚æœå®ƒæ˜¯æ ¹ï¼Œå®ƒå°±åº”å½“æ˜¯é»‘è‰²ã€‚æ‰€ä»¥æ–°èŠ‚ç‚¹æ€»æœ‰ä¸€ä¸ªå”çˆ¶èŠ‚ç‚¹ï¼Œå°½ç®¡åœ¨æƒ…å½¢4å’Œ5ä¸‹å®ƒå¯èƒ½æ˜¯å¶å­ã€‚\n æƒ…å†µ3.å¦‚æœçˆ¶èŠ‚ç‚¹På’Œå”çˆ¶èŠ‚ç‚¹UäºŒè€…éƒ½æ˜¯çº¢è‰²ã€‚\nå¦‚ä¸‹å›¾ï¼Œå› ä¸ºæ–°åŠ å…¥çš„Nç»“ç‚¹å¿…é¡»ä¸ºçº¢è‰²ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†çˆ¶ç»“ç‚¹P(ä¿è¯æ€§è´¨4)ï¼Œä»¥åŠNçš„å”çˆ¶ç»“ç‚¹U(ä¿è¯æ€§è´¨5)é‡æ–°ç»˜åˆ¶æˆé»‘è‰²ã€‚å¦‚æœæ­¤æ—¶ç¥–çˆ¶ç»“ç‚¹Gæ˜¯æ ¹ï¼Œåˆ™ç»“æŸå˜åŒ–ã€‚å¦‚æœä¸æ˜¯æ ¹ï¼Œåˆ™ç¥–çˆ¶ç»“ç‚¹é‡ç»˜ä¸ºçº¢è‰²(ä¿è¯æ€§è´¨5)ã€‚ä½†æ˜¯ï¼ŒGçš„çˆ¶äº²ä¹Ÿå¯èƒ½æ˜¯çº¢è‰²çš„ï¼Œä¸ºäº†ä¿è¯æ€§è´¨4ã€‚æˆ‘ä»¬æŠŠGé€’å½’å½“åšæ–°åŠ å…¥çš„ç»“ç‚¹Nåœ¨è¿›è¡Œå„ç§æƒ…å†µçš„é‡æ–°æ£€æŸ¥ã€‚\n æ³¨æ„ï¼šåœ¨æƒ…å½¢4å’Œ5ä¸‹ï¼Œæˆ‘ä»¬å‡å®šçˆ¶èŠ‚ç‚¹P æ˜¯ç¥–çˆ¶ç»“ç‚¹G çš„å·¦å­èŠ‚ç‚¹ã€‚å¦‚æœå®ƒæ˜¯å³å­èŠ‚ç‚¹ï¼Œæƒ…å½¢4å’Œæƒ…å½¢5ä¸­çš„å·¦å’Œå³åº”å½“å¯¹è°ƒã€‚\n æƒ…å†µ4. çˆ¶èŠ‚ç‚¹Pæ˜¯çº¢è‰²è€Œå”çˆ¶èŠ‚ç‚¹Uæ˜¯é»‘è‰²æˆ–ç¼ºå°‘; å¦å¤–ï¼Œæ–°èŠ‚ç‚¹Næ˜¯å…¶çˆ¶èŠ‚ç‚¹Pçš„å³å­èŠ‚ç‚¹ï¼Œè€Œçˆ¶èŠ‚ç‚¹Påˆæ˜¯ç¥–çˆ¶ç»“ç‚¹Gçš„å·¦å­èŠ‚ç‚¹ã€‚\nå¦‚ä¸‹å›¾, åœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼Œæˆ‘ä»¬è¿›è¡Œä¸€æ¬¡å·¦æ—‹è½¬è°ƒæ¢æ–°èŠ‚ç‚¹å’Œå…¶çˆ¶èŠ‚ç‚¹çš„è§’è‰²ï¼ˆä¸AVLæ ‘çš„å·¦æ—‹è½¬ç›¸åŒï¼‰; è¿™å¯¼è‡´æŸäº›è·¯å¾„é€šè¿‡å®ƒä»¬ä»¥å‰ä¸é€šè¿‡çš„æ–°èŠ‚ç‚¹Næˆ–çˆ¶èŠ‚ç‚¹Pä¸­çš„ä¸€ä¸ªï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªèŠ‚ç‚¹éƒ½æ˜¯çº¢è‰²çš„ï¼Œæ‰€ä»¥æ€§è´¨5æ²¡æœ‰å¤±æ•ˆã€‚ä½†ç›®å‰æƒ…å†µå°†è¿åæ€§è´¨4ï¼Œæ‰€ä»¥æ¥ç€ï¼Œæˆ‘ä»¬æŒ‰ä¸‹é¢çš„æƒ…å†µ5ç»§ç»­å¤„ç†ä»¥å‰çš„çˆ¶èŠ‚ç‚¹Pã€‚\næƒ…å†µ5. çˆ¶èŠ‚ç‚¹Pæ˜¯çº¢è‰²è€Œå”çˆ¶èŠ‚ç‚¹U æ˜¯é»‘è‰²æˆ–ç¼ºå°‘ï¼Œæ–°èŠ‚ç‚¹N æ˜¯å…¶çˆ¶èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ï¼Œè€Œçˆ¶èŠ‚ç‚¹Påˆæ˜¯ç¥–çˆ¶ç»“ç‚¹çš„Gçš„å·¦å­èŠ‚ç‚¹ã€‚\nå¦‚ä¸‹å›¾ï¼š åœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼Œæˆ‘ä»¬è¿›è¡Œé’ˆå¯¹ç¥–çˆ¶èŠ‚ç‚¹P çš„ä¸€æ¬¡å³æ—‹è½¬; åœ¨æ—‹è½¬äº§ç”Ÿçš„æ ‘ä¸­ï¼Œä»¥å‰çš„çˆ¶èŠ‚ç‚¹Pç°åœ¨æ˜¯æ–°èŠ‚ç‚¹Nå’Œä»¥å‰çš„ç¥–çˆ¶èŠ‚ç‚¹G çš„çˆ¶èŠ‚ç‚¹ã€‚æˆ‘ä»¬çŸ¥é“ä»¥å‰çš„ç¥–çˆ¶èŠ‚ç‚¹Gæ˜¯é»‘è‰²ï¼Œå¦åˆ™çˆ¶èŠ‚ç‚¹På°±ä¸å¯èƒ½æ˜¯çº¢è‰²ã€‚æˆ‘ä»¬åˆ‡æ¢ä»¥å‰çš„çˆ¶èŠ‚ç‚¹På’Œç¥–çˆ¶èŠ‚ç‚¹Gçš„é¢œè‰²ï¼Œç»“æœçš„æ ‘æ»¡è¶³æ€§è´¨4[3]ã€‚æ€§è´¨ 5[4]ä¹Ÿä»ç„¶ä¿æŒæ»¡è¶³ï¼Œå› ä¸ºé€šè¿‡è¿™ä¸‰ä¸ªèŠ‚ç‚¹ä¸­ä»»ä½•ä¸€ä¸ªçš„æ‰€æœ‰è·¯å¾„ä»¥å‰éƒ½é€šè¿‡ç¥–çˆ¶èŠ‚ç‚¹G ï¼Œç°åœ¨å®ƒä»¬éƒ½é€šè¿‡ä»¥å‰çš„çˆ¶èŠ‚ç‚¹Pã€‚åœ¨å„è‡ªçš„æƒ…å½¢ä¸‹ï¼Œè¿™éƒ½æ˜¯ä¸‰ä¸ªèŠ‚ç‚¹ä¸­å”¯ä¸€çš„é»‘è‰²èŠ‚ç‚¹ã€‚\nåˆ é™¤æ“ä½œ ç›¸è¾ƒäºæ’å…¥æ“ä½œï¼Œçº¢é»‘æ ‘çš„åˆ é™¤æ“ä½œåˆ™è¦æ›´ä¸ºå¤æ‚ä¸€äº›ã€‚åˆ é™¤æ“ä½œé¦–å…ˆè¦ç¡®å®šå¾…åˆ é™¤èŠ‚ç‚¹æœ‰å‡ ä¸ªå­©å­ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªå­©å­ï¼Œä¸èƒ½ç›´æ¥åˆ é™¤è¯¥èŠ‚ç‚¹ã€‚è€Œæ˜¯è¦å…ˆæ‰¾åˆ°è¯¥èŠ‚ç‚¹çš„å‰é©±ï¼ˆè¯¥èŠ‚ç‚¹å·¦å­æ ‘ä¸­æœ€å¤§çš„èŠ‚ç‚¹ï¼‰æˆ–è€…åç»§ï¼ˆè¯¥èŠ‚ç‚¹å³å­æ ‘ä¸­æœ€å°çš„èŠ‚ç‚¹ï¼‰ï¼Œç„¶åå°†å‰é©±æˆ–è€…åç»§çš„å€¼å¤åˆ¶åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹ä¸­ï¼Œæœ€åå†å°†å‰é©±æˆ–åç»§åˆ é™¤ã€‚ç”±äºå‰é©±å’Œåç»§è‡³å¤šåªæœ‰ä¸€ä¸ªå­©å­èŠ‚ç‚¹ï¼Œè¿™æ ·æˆ‘ä»¬å°±æŠŠåŸæ¥è¦åˆ é™¤çš„èŠ‚ç‚¹æœ‰ä¸¤ä¸ªå­©å­çš„é—®é¢˜è½¬åŒ–ä¸ºåªæœ‰ä¸€ä¸ªå­©å­èŠ‚ç‚¹çš„é—®é¢˜ï¼Œé—®é¢˜è¢«ç®€åŒ–äº†ä¸€äº›ã€‚æˆ‘ä»¬å¹¶ä¸å…³å¿ƒæœ€ç»ˆè¢«åˆ é™¤çš„èŠ‚ç‚¹æ˜¯å¦æ˜¯æˆ‘ä»¬å¼€å§‹æƒ³è¦åˆ é™¤çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œåªè¦èŠ‚ç‚¹é‡Œçš„å€¼æœ€ç»ˆè¢«åˆ é™¤å°±è¡Œäº†ï¼Œè‡³äºæ ‘ç»“æ„å¦‚ä½•å˜åŒ–ï¼Œè¿™ä¸ªå¹¶ä¸é‡è¦ã€‚\nåº”ç”¨åœºæ™¯ å·¥ä¸šç•Œæœ€ä¸»è¦ä½¿ç”¨çš„äºŒå‰æœç´¢å¹³è¡¡æ ‘ï¼Œå¹¿æ³›ç”¨åœ¨C++çš„STLä¸­ã€‚å¦‚mapå’Œsetéƒ½æ˜¯ç”¨çº¢é»‘æ ‘å®ç°çš„ã€‚Javaç”¨å®ƒæ¥å®ç°TreeMapã€‚è‘—åçš„linuxè¿›ç¨‹è°ƒåº¦Completely Fair Scheduler,ç”¨çº¢é»‘æ ‘ç®¡ç†è¿›ç¨‹æ§åˆ¶å—ã€‚\n epollåœ¨å†…æ ¸ä¸­çš„å®ç°ï¼Œç”¨çº¢é»‘æ ‘ç®¡ç†äº‹ä»¶å— nginxä¸­ï¼Œç”¨çº¢é»‘æ ‘ç®¡ç†timerç­‰  Code å®ç°ï¼šhttps://www.cnblogs.com/skywang12345/p/3624291.html\nçº¢é»‘æ ‘èŠ‚ç‚¹å®šä¹‰ 1 2 3 4 5 6 7 8 9 10 11 12  template \u0026lt;class T\u0026gt; class RBTNode { public: RBTColor color; // é¢œè‰²  T key; // å…³é”®å­—(é”®å€¼)  RBTNode *left; // å·¦å­©å­  RBTNode *right; // å³å­©å­  RBTNode *parent; // çˆ¶ç»“ç‚¹  RBTNode(T value, RBTColor c, RBTNode *p, RBTNode *l, RBTNode *r) : key(value), color(c), parent(), left(l), right(r) {} };   é¢œè‰²å®šä¹‰ 1 2 3 4 5  enum RBTColor { RED, BLACK };   4.Bæ ‘ èƒŒæ™¯\nä¸€ä¸ªæ¯”è¾ƒå®é™…çš„é—®é¢˜ï¼šå°±æ˜¯å¤§é‡æ•°æ®å­˜å‚¨ä¸­ï¼Œå®ç°æŸ¥è¯¢è¿™æ ·ä¸€ä¸ªå®é™…èƒŒæ™¯ä¸‹ï¼Œå¹³è¡¡äºŒå‰æ ‘ç”±äºæ ‘æ·±åº¦è¿‡å¤§è€Œé€ æˆç£ç›˜IOè¯»å†™è¿‡äºé¢‘ç¹ï¼Œè¿›è€Œå¯¼è‡´æ•ˆç‡ä½ä¸‹ã€‚é‚£ä¹ˆå¦‚ä½•å‡å°‘æ ‘çš„æ·±åº¦ï¼ˆå½“ç„¶ä¸èƒ½å‡å°‘æŸ¥è¯¢æ•°æ®é‡ï¼‰ï¼Œä¸€ä¸ªåŸºæœ¬çš„æƒ³æ³•å°±æ˜¯ï¼š\n  æ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨å¤šä¸ªå…ƒç´  ï¼ˆä½†å…ƒç´ æ•°é‡ä¸èƒ½æ— é™å¤šï¼Œå¦åˆ™æŸ¥æ‰¾å°±é€€åŒ–æˆäº†èŠ‚ç‚¹å†…éƒ¨çš„çº¿æ€§æŸ¥æ‰¾äº†ï¼‰ã€‚\n  æ‘’å¼ƒäºŒå‰æ ‘ç»“æ„ï¼Œé‡‡ç”¨å¤šå‰æ ‘ ï¼ˆç”±äºèŠ‚ç‚¹å†…å…ƒç´ æ•°é‡ä¸èƒ½æ— é™å¤šï¼Œè‡ªç„¶å­æ ‘çš„æ•°é‡ä¹Ÿå°±ä¸ä¼šæ— é™å¤šäº†ï¼‰ã€‚\n  è¿™æ ·æˆ‘ä»¬å°±æå‡ºæ¥äº†ä¸€ä¸ªæ–°çš„æŸ¥æ‰¾æ ‘ç»“æ„ â€”â€”å¤šè·¯æŸ¥æ‰¾æ ‘ã€‚ æ ¹æ®AVLç»™æˆ‘ä»¬çš„å¯å‘ï¼Œä¸€é¢—å¹³è¡¡å¤šè·¯æŸ¥æ‰¾æ ‘(B~æ ‘) è‡ªç„¶å¯ä»¥ä½¿å¾—æ•°æ®çš„æŸ¥æ‰¾æ•ˆç‡ä¿è¯åœ¨O(logN)è¿™æ ·çš„å¯¹æ•°çº§åˆ«ä¸Šã€‚\n ç›®å‰å¤§éƒ¨åˆ†æ•°æ®åº“ç³»ç»ŸåŠæ–‡ä»¶ç³»ç»Ÿéƒ½é‡‡ç”¨B-Treeæˆ–å…¶å˜ç§B+Treeä½œä¸ºç´¢å¼•ç»“æ„\n B-æ ‘ B-æ ‘æ˜¯ä¸€ç§å¤šè·¯æœç´¢æ ‘ã€‚\nB-Tree æ˜¯æ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„æ•°æ®ç»“æ„ï¼š\n d ä¸ºå¤§äº 1 çš„ä¸€ä¸ªæ­£æ•´æ•°ï¼Œç§°ä¸º B-Tree çš„åº¦ã€‚ h ä¸ºä¸€ä¸ªæ­£æ•´æ•°ï¼Œç§°ä¸º B-Tree çš„é«˜åº¦ã€‚ æ¯ä¸ªéå¶å­èŠ‚ç‚¹ç”± n-1 ä¸ª key å’Œ n ä¸ªæŒ‡é’ˆç»„æˆï¼Œå…¶ä¸­ d\u0026lt;=n\u0026lt;=2dã€‚ æ¯ä¸ªå¶å­èŠ‚ç‚¹æœ€å°‘åŒ…å«ä¸€ä¸ª key å’Œä¸¤ä¸ªæŒ‡é’ˆï¼Œæœ€å¤šåŒ…å« 2d-1 ä¸ª key å’Œ 2d ä¸ªæŒ‡é’ˆï¼Œå¶èŠ‚ç‚¹çš„æŒ‡é’ˆå‡ä¸º null ã€‚ æ‰€æœ‰å¶èŠ‚ç‚¹å…·æœ‰ç›¸åŒçš„æ·±åº¦ï¼Œç­‰äºæ ‘é«˜ hã€‚ key å’ŒæŒ‡é’ˆäº’ç›¸é—´éš”ï¼ŒèŠ‚ç‚¹ä¸¤ç«¯æ˜¯æŒ‡é’ˆã€‚ ä¸€ä¸ªèŠ‚ç‚¹ä¸­çš„ key ä»å·¦åˆ°å³éé€’å‡æ’åˆ—ã€‚ æ‰€æœ‰èŠ‚ç‚¹ç»„æˆæ ‘ç»“æ„ã€‚ æ¯ä¸ªæŒ‡é’ˆè¦ä¹ˆä¸º nullï¼Œè¦ä¹ˆæŒ‡å‘å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹ã€‚ å¦‚æœæŸä¸ªæŒ‡é’ˆåœ¨èŠ‚ç‚¹ node æœ€å·¦è¾¹ä¸”ä¸ä¸º nullï¼Œåˆ™å…¶æŒ‡å‘èŠ‚ç‚¹çš„æ‰€æœ‰ key å°äº v(key1)ï¼Œå…¶ä¸­ v(key1) ä¸º node çš„ç¬¬ä¸€ä¸ª key çš„å€¼ã€‚ å¦‚æœæŸä¸ªæŒ‡é’ˆåœ¨èŠ‚ç‚¹ node æœ€å³è¾¹ä¸”ä¸ä¸º nullï¼Œåˆ™å…¶æŒ‡å‘èŠ‚ç‚¹çš„æ‰€æœ‰ key å¤§äº v(keym)ï¼Œå…¶ä¸­ v(keym) ä¸º node çš„æœ€åä¸€ä¸ª key çš„å€¼ã€‚ å¦‚æœæŸä¸ªæŒ‡é’ˆåœ¨èŠ‚ç‚¹ node çš„å·¦å³ç›¸é‚» key åˆ†åˆ«æ˜¯ keyi å’Œ keyi+1 ä¸”ä¸ä¸º nullï¼Œåˆ™å…¶æŒ‡å‘èŠ‚ç‚¹çš„æ‰€æœ‰ key å°äº v(keyi+1) ä¸”å¤§äº v(keyi)ã€‚  æ€§è´¨ï¼š\n  æ ¹ç»“ç‚¹è‡³å°‘æœ‰ä¸¤ä¸ªå­å¥³ï¼›\n  æ¯ä¸ªéæ ¹èŠ‚ç‚¹æ‰€åŒ…å«çš„å…³é”®å­—ä¸ªæ•° j æ»¡è¶³ï¼šâ”Œm/2â” - 1 \u0026lt;= j \u0026lt;= m - 1ï¼›\n  é™¤æ ¹ç»“ç‚¹ä»¥å¤–çš„æ‰€æœ‰ç»“ç‚¹ï¼ˆä¸åŒ…æ‹¬å¶å­ç»“ç‚¹ï¼‰çš„åº¦æ•°æ­£å¥½æ˜¯å…³é”®å­—æ€»æ•°åŠ 1ï¼Œæ•…å†…éƒ¨å­æ ‘ä¸ªæ•° k æ»¡è¶³ï¼šâ”Œm/2â” \u0026lt;= k \u0026lt;= m ï¼›\n  æ‰€æœ‰çš„å¶å­ç»“ç‚¹éƒ½ä½äºåŒä¸€å±‚ã€‚\n   ç”¨åœ¨ç£ç›˜æ–‡ä»¶ç»„ç»‡ æ•°æ®ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ã€‚\n B-Tree ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹æ ¹æ®å®é™…æƒ…å†µå¯ä»¥åŒ…å«å¤§é‡çš„å…³é”®å­—ä¿¡æ¯å’Œåˆ†æ”¯ï¼Œä¾‹ï¼š\næ¯ä¸ªèŠ‚ç‚¹å ç”¨ä¸€ä¸ªç›˜å—çš„ç£ç›˜ç©ºé—´ï¼Œä¸€ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ä¸¤ä¸ªå‡åºæ’åºçš„å…³é”®å­—å’Œä¸‰ä¸ªæŒ‡å‘å­æ ‘æ ¹èŠ‚ç‚¹çš„æŒ‡é’ˆï¼ŒæŒ‡é’ˆå­˜å‚¨çš„æ˜¯å­èŠ‚ç‚¹æ‰€åœ¨ç£ç›˜å—çš„åœ°å€ã€‚\nä¸¤ä¸ªå…³é”®è¯åˆ’åˆ†æˆçš„ä¸‰ä¸ªèŒƒå›´åŸŸå¯¹åº”ä¸‰ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®çš„èŒƒå›´åŸŸã€‚\nä»¥æ ¹èŠ‚ç‚¹ä¸ºä¾‹ï¼Œå…³é”®å­—ä¸º 17 å’Œ 35ï¼ŒP1 æŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®èŒƒå›´ä¸ºå°äº 17ï¼ŒP2 æŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®èŒƒå›´ä¸º 17~35ï¼ŒP3 æŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®èŒƒå›´ä¸ºå¤§äº 35ã€‚\næ¨¡æ‹ŸæŸ¥æ‰¾å…³é”®å­— 29 çš„è¿‡ç¨‹ï¼š\n æ ¹æ®æ ¹èŠ‚ç‚¹æ‰¾åˆ°ç£ç›˜å— 1ï¼Œè¯»å…¥å†…å­˜ã€‚ã€ç£ç›˜ I/O æ“ä½œç¬¬ 1 æ¬¡ã€‘ æ¯”è¾ƒå…³é”®å­— 29 åœ¨åŒºé—´ï¼ˆ17,35ï¼‰ï¼Œæ‰¾åˆ°ç£ç›˜å— 1 çš„æŒ‡é’ˆ P2ã€‚ æ ¹æ® P2 æŒ‡é’ˆæ‰¾åˆ°ç£ç›˜å— 3ï¼Œè¯»å…¥å†…å­˜ã€‚ã€ç£ç›˜ I/O æ“ä½œç¬¬ 2 æ¬¡ã€‘ æ¯”è¾ƒå…³é”®å­— 29 åœ¨åŒºé—´ï¼ˆ26,30ï¼‰ï¼Œæ‰¾åˆ°ç£ç›˜å— 3 çš„æŒ‡é’ˆ P2ã€‚ æ ¹æ® P2 æŒ‡é’ˆæ‰¾åˆ°ç£ç›˜å— 8ï¼Œè¯»å…¥å†…å­˜ã€‚ã€ç£ç›˜ I/O æ“ä½œç¬¬ 3 æ¬¡ã€‘ åœ¨ç£ç›˜å— 8 ä¸­çš„å…³é”®å­—åˆ—è¡¨ä¸­æ‰¾åˆ°å…³é”®å­— 29ã€‚   B-Tree ç›¸å¯¹äº AVLTree ç¼©å‡äº†èŠ‚ç‚¹ä¸ªæ•°ï¼Œä½¿æ¯æ¬¡ç£ç›˜ I/O å–åˆ°å†…å­˜çš„æ•°æ®éƒ½å‘æŒ¥äº†ä½œç”¨ï¼Œä»è€Œæé«˜äº†æŸ¥è¯¢æ•ˆç‡ã€‚\n B+æ ‘ B+æ ‘æ˜¯B-æ ‘çš„å˜ä½“ï¼Œä¹Ÿæ˜¯ä¸€ç§å¤šè·¯æœç´¢æ ‘ï¼š\n1.å…¶å®šä¹‰åŸºæœ¬ä¸B-æ ‘åŒï¼Œé™¤äº†ï¼š\n2.éå¶å­ç»“ç‚¹çš„å­æ ‘æŒ‡é’ˆä¸å…³é”®å­—ä¸ªæ•°ç›¸åŒï¼›\n3.éå¶å­ç»“ç‚¹çš„å­æ ‘æŒ‡é’ˆP[i]ï¼ŒæŒ‡å‘å…³é”®å­—å€¼å±äº[K[i], K[i+1])çš„å­æ ‘\nï¼ˆB-æ ‘æ˜¯å¼€åŒºé—´ï¼‰ï¼›\n5.ä¸ºæ‰€æœ‰å¶å­ç»“ç‚¹å¢åŠ ä¸€ä¸ªé“¾æŒ‡é’ˆï¼›\n6.æ‰€æœ‰å…³é”®å­—éƒ½åœ¨å¶å­ç»“ç‚¹å‡ºç°ï¼›\n ç”¨åœ¨ç£ç›˜æ–‡ä»¶ç»„ç»‡ æ•°æ®ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ã€‚MySQLå¸¸ç”¨çš„å¼•æ“InnoDB å’Œ Myisam éƒ½æ˜¯ç”¨ B+Tree æ¥å­˜å‚¨æ•°æ®çš„ã€‚\nBå’ŒB+ä¸»è¦ç”¨åœ¨æ–‡ä»¶ç³»ç»Ÿä»¥åŠæ•°æ®åº“ä¸­åšç´¢å¼•ç­‰ï¼Œæ¯”å¦‚Mysqlï¼šB-Tree Index in MySql\n  åœ¨ B-Tree ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸­æœ‰ keyï¼Œä¹Ÿæœ‰ dataï¼Œè€Œæ¯ä¸€ä¸ªé¡µçš„å­˜å‚¨ç©ºé—´æ˜¯æœ‰é™çš„ï¼Œå¦‚æœ data æ•°æ®è¾ƒå¤§æ—¶å°†ä¼šå¯¼è‡´æ¯ä¸ªèŠ‚ç‚¹ï¼ˆå³ä¸€ä¸ªé¡µï¼‰èƒ½å­˜å‚¨çš„ key çš„æ•°é‡å¾ˆå°ã€‚å½“å­˜å‚¨çš„æ•°æ®é‡å¾ˆå¤§æ—¶åŒæ ·ä¼šå¯¼è‡´ B-Tree çš„æ·±åº¦è¾ƒå¤§ï¼Œå¢å¤§æŸ¥è¯¢æ—¶çš„ç£ç›˜ I/O æ¬¡æ•°ï¼Œè¿›è€Œå½±å“æŸ¥è¯¢æ•ˆç‡ã€‚\n B+Tree æ˜¯åœ¨ B-Tree åŸºç¡€ä¸Šçš„ä¸€ç§ä¼˜åŒ–ï¼Œä½¿å…¶æ›´é€‚åˆå®ç°å¤–å­˜å‚¨ç´¢å¼•ç»“æ„ï¼ŒInnoDB å­˜å‚¨å¼•æ“å°±æ˜¯ç”¨ B+Tree å®ç°å…¶ç´¢å¼•ç»“æ„ã€‚\nB+Tree åœ¨ B-Tree çš„åŸºç¡€ä¸Šæœ‰ä¸¤ç‚¹å˜åŒ–ï¼š\n æ•°æ®æ˜¯å­˜åœ¨å¶å­èŠ‚ç‚¹ä¸­çš„ï¼› æ•°æ®èŠ‚ç‚¹ä¹‹é—´æ˜¯æœ‰æŒ‡é’ˆæŒ‡å‘çš„ã€‚  ç”±äº B+Tree çš„éå¶å­èŠ‚ç‚¹åªå­˜å‚¨é”®å€¼ä¿¡æ¯ï¼Œå‡è®¾æ¯ä¸ªç£ç›˜å—èƒ½å­˜å‚¨ 4 ä¸ªé”®å€¼åŠæŒ‡é’ˆä¿¡æ¯ï¼Œåˆ™å˜æˆ B+Tree åå…¶ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nMySQLåº”ç”¨ æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„åœ¨æŸä¸ªå­—æ®µä¸Šå»ºç´¢å¼•ï¼Œæ„æ€å°±æ˜¯è®© MySQL å¯¹è¯¥å­—æ®µä»¥ç´¢å¼•è¿™ç§æ•°æ®ç»“æ„æ¥å­˜å‚¨ï¼Œç„¶åæŸ¥æ‰¾çš„æ—¶å€™å°±æœ‰å¯¹åº”çš„æŸ¥æ‰¾ç®—æ³•ã€‚\nå»ºç´¢å¼•çš„æ ¹æœ¬ç›®çš„æ˜¯ä¸ºäº†æŸ¥æ‰¾çš„ä¼˜åŒ–ï¼Œç‰¹åˆ«æ˜¯å½“æ•°æ®å¾ˆåºå¤§çš„æ—¶å€™ï¼Œä¸€èˆ¬çš„æŸ¥æ‰¾ç®—æ³•æœ‰é¡ºåºæŸ¥æ‰¾ã€æŠ˜åŠæŸ¥æ‰¾ã€å¿«é€ŸæŸ¥æ‰¾ç­‰ã€‚\n InnoDB\nInnoDB çš„å­˜å‚¨æ–‡ä»¶æœ‰ä¸¤ä¸ªï¼Œåç¼€ååˆ†åˆ«æ˜¯ .frm å’Œ .idbï¼Œå…¶ä¸­ .frm æ˜¯è¡¨çš„å®šä¹‰æ–‡ä»¶ï¼Œè€Œ idb æ˜¯æ•°æ®æ–‡ä»¶ã€‚  InnoDB ä¸­å­˜åœ¨è¡¨é”å’Œè¡Œé”ï¼Œä¸è¿‡è¡Œé”æ˜¯åœ¨å‘½ä¸­ç´¢å¼•çš„æƒ…å†µä¸‹æ‰ä¼šèµ·ä½œç”¨ã€‚\nInnoDB æ”¯æŒäº‹åŠ¡ï¼Œä¸”æ”¯æŒå››ç§éš”ç¦»çº§åˆ«ï¼ˆè¯»æœªæäº¤ã€è¯»å·²æäº¤ã€å¯é‡å¤è¯»ã€ä¸²è¡ŒåŒ–ï¼‰ï¼Œé»˜è®¤çš„ä¸ºå¯é‡å¤è¯»ï¼›è€Œåœ¨ Oracle æ•°æ®åº“ä¸­ï¼Œåªæ”¯æŒä¸²è¡ŒåŒ–çº§åˆ«å’Œè¯»å·²æäº¤è¿™ä¸¤ç§çº§åˆ«ï¼Œå…¶ä¸­é»˜è®¤çš„ä¸ºè¯»å·²æäº¤çº§åˆ«ã€‚\nInnoDB é€šè¿‡ B+Tree ç»“æ„å¯¹ ID å»ºç´¢å¼•ï¼Œç„¶ååœ¨å¶å­èŠ‚ç‚¹ä¸­å­˜å‚¨è®°å½•ã€‚\nMyisam\nMyisam çš„å­˜å‚¨æ–‡ä»¶æœ‰ä¸‰ä¸ªï¼Œåç¼€ååˆ†åˆ«æ˜¯ .frmã€.MYDã€MYIï¼Œå…¶ä¸­ .frm æ˜¯è¡¨çš„å®šä¹‰æ–‡ä»¶ï¼Œ.MYD æ˜¯æ•°æ®æ–‡ä»¶ï¼Œ.MYI æ˜¯ç´¢å¼•æ–‡ä»¶ã€‚  Myisam åªæ”¯æŒè¡¨é”ï¼Œä¸”ä¸æ”¯æŒäº‹åŠ¡ã€‚Myisam ç”±äºæœ‰å•ç‹¬çš„ç´¢å¼•æ–‡ä»¶ï¼Œåœ¨è¯»å–æ•°æ®æ–¹é¢çš„æ€§èƒ½å¾ˆé«˜ ã€‚\nç”±äº Myisam ä¸­çš„ç´¢å¼•å’Œæ•°æ®åˆ†åˆ«å­˜æ”¾åœ¨ä¸åŒçš„æ–‡ä»¶ï¼Œæ‰€ä»¥åœ¨ç´¢å¼•æ ‘ä¸­çš„å¶å­èŠ‚ç‚¹ä¸­å­˜çš„æ•°æ®æ˜¯è¯¥ç´¢å¼•å¯¹åº”çš„æ•°æ®è®°å½•çš„åœ°å€ï¼Œç”±äºæ•°æ®ä¸ç´¢å¼•ä¸åœ¨ä¸€èµ·ï¼Œæ‰€ä»¥ Myisam æ˜¯éèšç°‡ç´¢å¼•ã€‚\nçº¢é»‘æ ‘å’Œå¤šè·¯æŸ¥æ‰¾æ ‘éƒ½æ˜¯å±äºæ·±åº¦æœ‰ç•ŒæŸ¥æ‰¾æ ‘ï¼ˆdepth-bounded tree â€”DBTï¼‰\n2-3-4æ ‘ 2-3-4 æ ‘åœ¨è®¡ç®—æœºç§‘å­¦ä¸­æ˜¯é˜¶ä¸º 4 çš„Bæ ‘ã€‚\n2-3-4 æ ‘æŠŠæ•°æ®å­˜å‚¨åœ¨å«åšå…ƒç´ çš„å•ç‹¬å•å…ƒä¸­ã€‚å®ƒä»¬ç»„åˆæˆèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸‹åˆ—ä¹‹ä¸€\n 2-èŠ‚ç‚¹ï¼Œå°±æ˜¯è¯´ï¼Œå®ƒåŒ…å« 1 ä¸ªå…ƒç´ å’Œ 2 ä¸ªå„¿å­ï¼Œ 3-èŠ‚ç‚¹ï¼Œå°±æ˜¯è¯´ï¼Œå®ƒåŒ…å« 2 ä¸ªå…ƒç´ å’Œ 3 ä¸ªå„¿å­ï¼Œ 4-èŠ‚ç‚¹ï¼Œå°±æ˜¯è¯´ï¼Œå®ƒåŒ…å« 3 ä¸ªå…ƒç´ å’Œ 4 ä¸ªå„¿å­ ã€‚  æ¯ä¸ªå„¿å­éƒ½æ˜¯ï¼ˆå¯èƒ½ä¸ºç©ºï¼‰ä¸€ä¸ªå­ 2-3-4 æ ‘ã€‚æ ¹èŠ‚ç‚¹æ˜¯å…¶ä¸­æ²¡æœ‰çˆ¶äº²çš„é‚£ä¸ªèŠ‚ç‚¹ï¼›å®ƒåœ¨éå†æ ‘çš„æ—¶å€™å……å½“èµ·ç‚¹ï¼Œå› ä¸ºä»å®ƒå¯ä»¥åˆ°è¾¾æ‰€æœ‰çš„å…¶ä»–èŠ‚ç‚¹ã€‚å¶å­èŠ‚ç‚¹æ˜¯æœ‰è‡³å°‘ä¸€ä¸ªç©ºå„¿å­çš„èŠ‚ç‚¹ã€‚\nåŒBæ ‘ä¸€æ ·ï¼Œ2-3-4 æ ‘æ˜¯æœ‰åºçš„ï¼šæ¯ä¸ªå…ƒç´ å¿…é¡»å¤§äºæˆ–ç­‰äºå®ƒå·¦è¾¹çš„å’Œå®ƒçš„å·¦å­æ ‘ä¸­çš„ä»»ä½•å…¶ä»–å…ƒç´ ã€‚æ¯ä¸ªå„¿å­å› æ­¤æˆä¸ºäº†ç”±å®ƒçš„å·¦å’Œå³å…ƒç´ ç•Œå®šçš„ä¸€ä¸ªåŒºé—´ã€‚\n2-3-4 æ ‘æ˜¯çº¢é»‘æ ‘çš„ä¸€ç§ç­‰åŒï¼Œè¿™æ„å‘³ç€å®ƒä»¬æ˜¯ç­‰ä»·çš„æ•°æ®ç»“æ„ã€‚æ¢å¥è¯è¯´ï¼Œå¯¹äºæ¯ä¸ª 2-3-4 æ ‘ï¼Œéƒ½å­˜åœ¨ç€è‡³å°‘ä¸€ä¸ªæ•°æ®å…ƒç´ æ˜¯ç›¸åŒæ¬¡åºçš„çº¢é»‘æ ‘ã€‚åœ¨ 2-3-4 æ ‘ä¸Šçš„æ’å…¥å’Œåˆ é™¤æ“ä½œä¹Ÿç­‰ä»·äºåœ¨çº¢é»‘æ ‘ä¸­çš„é¢œè‰²ç¿»è½¬å’Œæ—‹è½¬ã€‚è¿™ä½¿å¾—å®ƒæˆä¸ºç†è§£çº¢é»‘æ ‘èƒŒåçš„é€»è¾‘çš„é‡è¦å·¥å…·ã€‚\nå­—å…¸æ ‘ (åˆç§°trie æ ‘ï¼Œå•è¯æŸ¥æ‰¾æ ‘)\n1.åˆç§°å•è¯æŸ¥æ‰¾æ ‘ï¼ŒTrieæ ‘ï¼Œæ˜¯ä¸€ç§æ ‘å½¢ç»“æ„ï¼Œæ˜¯ä¸€ç§å“ˆå¸Œæ ‘çš„å˜ç§ã€‚\nå…¸å‹åº”ç”¨æ˜¯ç”¨äºç»Ÿè®¡ï¼Œæ’åºå’Œä¿å­˜å¤§é‡çš„å­—ç¬¦ä¸²ï¼ˆä½†ä¸ä»…é™äºå­—ç¬¦ä¸²ï¼‰ï¼Œæ‰€ä»¥ç»å¸¸è¢«æœç´¢å¼•æ“ç³»ç»Ÿç”¨äºæ–‡æœ¬è¯é¢‘ç»Ÿè®¡ã€‚\n2.å®ƒçš„ä¼˜ç‚¹æ˜¯ï¼šåˆ©ç”¨å­—ç¬¦ä¸²çš„å…¬å…±å‰ç¼€æ¥èŠ‚çº¦å­˜å‚¨ç©ºé—´ï¼Œæœ€å¤§é™åº¦åœ°å‡å°‘æ— è°“çš„å­—ç¬¦ä¸²æ¯”è¾ƒï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”å“ˆå¸Œè¡¨é«˜ã€‚\n3.å­—å…¸æ ‘ä¸å­—å…¸å¾ˆç›¸ä¼¼,å½“ä½ è¦æŸ¥ä¸€ä¸ªå•è¯æ˜¯ä¸æ˜¯åœ¨å­—å…¸æ ‘ä¸­,é¦–å…ˆçœ‹å•è¯çš„ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯ä¸æ˜¯åœ¨å­—å…¸çš„ç¬¬ä¸€å±‚,å¦‚æœä¸åœ¨,è¯´æ˜å­—å…¸æ ‘é‡Œæ²¡æœ‰è¯¥å•è¯,å¦‚æœåœ¨å°±åœ¨è¯¥å­—æ¯çš„å­©å­èŠ‚ç‚¹é‡Œæ‰¾æ˜¯ä¸æ˜¯æœ‰å•è¯çš„ç¬¬äºŒä¸ªå­—æ¯,æ²¡æœ‰è¯´æ˜æ²¡æœ‰è¯¥å•è¯,æœ‰çš„è¯ç”¨åŒæ ·çš„æ–¹æ³•ç»§ç»­æŸ¥æ‰¾.å­—å…¸æ ‘ä¸ä»…å¯ä»¥ç”¨æ¥å‚¨å­˜å­—æ¯,ä¹Ÿå¯ä»¥å‚¨å­˜æ•°å­—ç­‰å…¶å®ƒæ•°æ®ã€‚\n ç”¨åœ¨ç»Ÿè®¡å’Œæ’åºå¤§é‡å­—ç¬¦ä¸²ï¼Œå¦‚è‡ªåŠ¨æœºã€‚\ntrie æ ‘çš„ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯å‰ç¼€åŒ¹é…ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªå¾ˆå¸¸è§çš„åœºæ™¯ï¼Œåœ¨æˆ‘ä»¬è¾“å…¥æ—¶ï¼Œæœç´¢å¼•æ“ä¼šç»™äºˆæç¤º\nè¿˜æœ‰æ¯”å¦‚IPé€‰è·¯ï¼Œä¹Ÿæ˜¯å‰ç¼€åŒ¹é…ï¼Œä¸€å®šç¨‹åº¦ä¼šç”¨åˆ°trie\n  åç¼€æ ‘\n  å¹¿ä¹‰åç¼€æ ‘\n  å‚è€ƒï¼š\n https://www.cnblogs.com/zhuyf87/archive/2012/11/09/2763113.html äºŒå‰æ’åºæ ‘ https://www.cnblogs.com/fornever/archive/2011/11/15/2249492.html å¹³è¡¡äºŒå‰æ ‘ï¼ˆè§£æƒ‘ï¼‰ https://www.iteye.com/blog/hxraid-609949 å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ https://www.iteye.com/blog/hxraid-611816 çº¢é»‘æ ‘(RBT) https://www.zhihu.com/question/30527705 æ ‘çš„åº”ç”¨åœºæ™¯ è¯´ä¸€ä¸‹èšç°‡ç´¢å¼• \u0026amp; éèšç°‡ç´¢å¼• MySQLç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„åŠç®—æ³•åŸç† ","description":"","id":75,"section":"posts","tags":["äºŒå‰æ ‘"],"title":"é«˜çº§çš„äºŒå‰æ ‘","uri":"https://hugo.jiahongw.com/zh/posts/algorithmstructure/bst/"},{"content":"åœ°å€ï¼šhttp://markdown.xiaoshujiang.com/\nThis is a Test!\n","description":"","id":76,"section":"posts","tags":["å°ä¹¦åŒ "],"title":"ä½¿ç”¨å°ä¹¦åŒ åœ¨çº¿ç¼–å†™åšæ–‡","uri":"https://hugo.jiahongw.com/zh/posts/hugo/xiaoshujiang/"},{"content":"éœ€è¦ä» UGameViewportClient ç±»ç»§æ‰¿ ä¿®æ”¹è¿”å›å€¼ä¸ºtrue,è·¯å¾„ï¼š\\Source\\Runtime\\Engine\\Private\\GameViewportClient.h\n1  virtual bool RequiresHitProxyStorage() override { return true; }   åœ¨FViewportClientç±»ä¸­æ–°å»ºDrawHitProxyå‡½æ•° æ–‡ä»¶UnrealClient.h\nåœ¨GameViewportClientç±»ä¸­å£°æ˜å¹¶ä¸”å®ç° å£°æ˜ï¼š\\Source\\Runtime\\Engine\\Private\\GameViewportClient.h\nå°†GameViewportClientç±»ä¸­çš„å‡½æ•°Draw()å†…å®¹å¤åˆ¶åˆ°è¯¥å‡½æ•°DrawHitProxyï¼Œä¿®æ”¹ä¸‹é¢çš„çš„åœ°æ–¹ï¼š\nä¿®æ”¹FViewportç±»ä¸­çš„GetRawHitProxyDataå‡½æ•° åœ¨GetRawHitProxyDataå‡½æ•°ä¸­è¿›è¡Œä»¥ä¸‹çš„ä¿®æ”¹ï¼šEngine\\Source\\Runtime\\Engine\\Private\\UnrealClient.cpp\nè°ƒç”¨\u0026ndash;è·å–å±å¹•åæ ‡Hitproxy ç›¸å…³ç±»å‹ HHitProxyï¼šç”¨äºæ£€æµ‹ç”¨æˆ·ç•Œé¢å‘½ä¸­çš„åŸºç±»\nFHitProxyMapï¼šä»2Dåæ ‡åˆ°ç¼“å­˜å‘½ä¸­ä»£ç†çš„åœ°å›¾ã€‚\nå‚è€ƒï¼š\n How to select an actor in-game using GetHitProxy? UE4 ç¼–è¾‘å™¨çš„å…‰æ ‡æ‹¾å– ç¼–è¾‘å™¨Viewportçª—å£ä¸­çš„é¼ æ ‡æ‹¾å–åŸç† åœºæ™¯åŸºæœ¬å¯¹è±¡ æ¸²æŸ“æ€»æµç¨‹ https://docs.unrealengine.com/zh-CN/Programming/Rendering/MeshDrawingPipeline/index.html Unreal Mesh Drawingæºç åˆ†æ ç™½è¢ç¬‘é“  ","description":"","id":77,"section":"posts","tags":["C++","UE4","Game"],"title":"UEç¼–è¾‘å™¨ä¸‹æ¨¡æ‹Ÿä½¿ç”¨HitProxy","uri":"https://hugo.jiahongw.com/zh/posts/ue/ue-hitproxy/"},{"content":"åœ¨UE4ä¸­è·å–æ·±åº¦ç¼“å­˜ï¼Œè°ƒç”¨æ¸²æŸ“å‘½ä»¤è¯»å–ã€‚\nè·å–æ·±åº¦ç¼“å­˜ æ·±åº¦åƒç´ æ ¼å¼ é”®å…¥å‘½ä»¤vis scenedepthz uv0ä»¥æŸ¥çœ‹å®é™…ä½¿ç”¨çš„æ·±åº¦ç¼“å†²åŒºã€‚UE4å¯¹åœºæ™¯ä½¿ç”¨â€œåå‘â€æ·±åº¦ç¼“å†²åŒºã€‚\nWay1ï¼šç›´æ¥ä½¿ç”¨ENQUEUE_RENDER_COMMANDå‘½ä»¤è·å–(æ•ˆç‡è¾ƒä½) åœ¨ä»»æ„tickå‡½æ•°æˆ–è€…å…¶ä»–å‡½æ•°æ·»åŠ ä»¥ä¸‹çš„å‘½ä»¤ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  struct DepthPixel\t//å®šä¹‰æ·±åº¦åƒç´ ç»“æ„ä½“ \t{ float depth; char stencil; char unused1; char unused2; char unused3; }; float* cpuDataPtr;\t// Textureæ·±åº¦å€¼æ•°ç»„é¦–åœ°å€ \tTArray\u0026lt;DepthPixel\u0026gt; mydata;\t//æœ€ç»ˆè·å–è‰²æ·±åº¦å€¼æ•°æ® \tFIntPoint buffsize;\t//æ·±åº¦é•¿å®½å¤§å°Xå’ŒY  ENQUEUE_RENDER_COMMAND(ReadSurfaceFloatCommand)(\t// å°†è¯»å–æ·±åº¦æ•°æ®çš„å‘½ä»¤æ¨ç»™æ¸²æŸ“çº¿ç¨‹è¿›è¡Œæ‰§è¡Œ \t[\u0026amp;cpuDataPtr, \u0026amp;mydata, \u0026amp;buffsize](FRHICommandListImmediate\u0026amp; RHICmdList) //\u0026amp;cpuDataPtr, \u0026amp;mydata, \u0026amp;buffsizeä¸ºä¼ å…¥çš„å¤–éƒ¨å‚æ•° \t{ FSceneRenderTargets::Get(RHICmdList).AdjustGBufferRefCount(RHICmdList, 1); FTexture2DRHIRef uTex2DRes = FSceneRenderTargets::Get(RHICmdList).GetSceneDepthSurface();\tbuffsize = uTex2DRes-\u0026gt;GetSizeXY(); uint32 sx = buffsize.X; uint32 sy = buffsize.Y; mydata.AddUninitialized(sx * sy); uint32 Lolstrid = 0; cpuDataPtr = (float*)RHILockTexture2D(uTex2DRes,0,RLM_ReadOnly,Lolstrid,true);\t// åŠ é” è·å–å¯è¯»depth Textureæ·±åº¦å€¼æ•°ç»„é¦–åœ°å€ \tmemcpy(mydata.GetData(), cpuDataPtr, sx * sy * sizeof(DepthPixel));\t//å¤åˆ¶æ·±åº¦æ•°æ® \tRHIUnlockTexture2D(uTex2DRes, 0, true);\t//è§£é” \tFSceneRenderTargets::Get(RHICmdList).AdjustGBufferRefCount(RHICmdList, -1);\t}); FlushRenderingCommands();\t//ç­‰å¾…æ¸²æŸ“çº¿ç¨‹æ‰§è¡Œ  mydata; //æœ€ç»ˆè·å–æ·±åº¦æ•°æ®   æœ€ç»ˆè¿”å›çš„mydataæ•°æ®å°±æ˜¯æœ€ç»ˆçš„æ·±åº¦å€¼æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸ªæ·±åº¦å€¼çš„ç»“æ„æ˜¯DepthPixelï¼Œå…¶ä¸­ä¸€ä¸ªæˆå‘˜ä¸ºdepthï¼Œå¦å¤–å››ä¸ªä¸ä¸ä½¿ç”¨ã€‚å…¶ä¸­ä½¿ç”¨ä¸Šé¢çš„å‡ ä¸ªå‘½ä»¤éœ€è¦æ·»åŠ \u0026quot;RHI.h\u0026quot;å¤´æ–‡ä»¶\nWay2ï¼šå†™ä¸ªè¯·æ±‚ç±»è¯»å– UMLå›¾ï¼š\næµç¨‹å›¾ï¼š\n1. é¦–å…ˆåœ¨é¡¹ç›®çš„build.csæ–‡ä»¶æ·»åŠ ï¼š æ·»åŠ å¼•æ“æºç åœ°å€\n1 2 3 4 5 6 7 8 9 10  // æ·»åŠ å¼•æ“æºç åœ°å€  string EnginePath = \u0026#34;C:/Program Files (x86)/UE4+VS2017/UnrealEngine/\u0026#34;; PrivateIncludePaths.AddRange( new string[] { EnginePath + \u0026#34;Source/Runtime/Renderer/Private\u0026#34;, EnginePath + \u0026#34;Source/Runtime/Renderer/Private/CompositionLighting\u0026#34;, EnginePath + \u0026#34;Source/Runtime/Renderer/Private/PostProcess\u0026#34; } );   æ·»åŠ å¼•ä¾èµ–é¡¹\n2. ç±»å®ç° å°†ä¸‹é¢ç±»ä»£ç å¤åˆ¶åˆ°PostProcessing.hæ–‡ä»¶ä»»æ„ä½ç½®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83  /*****************************************Get Depth Class*******************************************************/ /*\tå­˜å‚¨ä¸€ä¸ªåƒç´ çš„ç¼“å­˜ depth æ·±åº¦ç¼“å­˜ stencil ï¼ˆæŠ å›¾ç¼“å­˜ï¼‰*/ struct DepthPixel { float depth; char stencil; char unused1; char unused2; char unused3; }; /*\tå­˜å‚¨æ•´ä¸ªè§†çª—çš„ç¼“å­˜ data\tåƒç´ ç¼“å­˜æ•°ç»„ bufferSizeX\tç¼“å­˜å¤§å°X bufferSizeY\tç¼“å­˜å¤§å°Y pixelSizeBytes\tåƒç´ ç¼“å­˜å­—èŠ‚æ•°*/ struct DepthResult { TArray\u0026lt;DepthPixel\u0026gt; data; int bufferSizeX; int bufferSizeY; int pixelSizeBytes; }; /*\tè·å–æ·±åº¦ç¼“å­˜çš„ç±»\t*/ class RENDERER_API DepthCapture { public: /*\té™æ€æˆå‘˜ï¼Œå½“ç”¨æˆ·å‘å‡ºä¸€ä¸ªè·å–æ·±åº¦ç¼“å­˜çš„è¯·æ±‚åï¼ŒwaitForCaptureé•¿åº¦åŠ 1ï¼Œæ–°å¢DepthResultå†…å®¹ä¸ºç©º å½“ç³»ç»Ÿå®Œæˆä¸€ä¸ªæ·±åº¦ç¼“å­˜çš„è¯·æ±‚åï¼ŒwaitForCaptureé•¿åº¦å‡ä¸€ */ static TQueue\u0026lt;DepthResult *, EQueueMode::Mpsc\u0026gt; waitForCapture; /*\té™æ€æˆå‘˜ï¼Œå½“ç³»ç»Ÿå®Œæˆä¸€ä¸ªæ·±åº¦ç¼“å­˜çš„è¯·æ±‚åï¼ŒfinishedCaptureé•¿åº¦åŠ 1ï¼Œ æ–°å¢DepthResultå«æœ‰æ·±åº¦ç¼“å­˜ä¿¡æ¯\t*/ static TQueue\u0026lt;DepthResult *, EQueueMode::Mpsc\u0026gt; finishedCapture; public: /*ç”¨æˆ·å‘å‡ºä¸€ä¸ªè·å–æ·±åº¦ç¼“å­˜çš„è¯·æ±‚æ—¶è°ƒç”¨*/ static void AddCapture() { waitForCapture.Enqueue(new DepthResult()); } /*ç³»ç»Ÿå®Œæˆä¸€ä¸ªæ·±åº¦ç¼“å­˜è¯·æ±‚åè°ƒç”¨*/ static void FinishedCapture(DepthResult *result) { finishedCapture.Enqueue(result); } /*è¿”å›æ˜¯å¦å­˜åœ¨å·²ç»å®Œæˆçš„è¯·æ±‚*/ static bool HasFinishedCapture() { return !finishedCapture.IsEmpty(); } /*å¦‚æœå­˜åœ¨å·²å®Œæˆçš„è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ªæ·±åº¦ç»“æœ*/ static DepthResult* GetIfExistFinished() { DepthResult* result = NULL; if (!finishedCapture.IsEmpty()) { finishedCapture.Dequeue(result); } return result; } /*è¿”å›æ˜¯å¦å­˜åœ¨ç­‰å¾…ç³»ç»Ÿæ‰§è¡Œçš„è¯·æ±‚*/ static bool HasCaptureRequest() { return !waitForCapture.IsEmpty(); } /*å¦‚æœå­˜åœ¨å¾…å®Œæˆçš„è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ªæ·±åº¦ç»“æœï¼ˆä¸ºç©ºï¼‰*/ static DepthResult* GetIfExistRequest() { DepthResult* result = NULL; if (!waitForCapture.IsEmpty()) { waitForCapture.Dequeue(result); } return result; } //friend void AddPostProcessingPasses(FRDGBuilder\u0026amp; GraphBuilder, const FViewInfo\u0026amp; View, const FPostProcessingInputs\u0026amp; Inputs); }; /*****************************************end******************************************************/   å°†ä¸‹é¢ç±»ä¸­é™æ€æˆå‘˜åˆå§‹åŒ–å’Œæ·»åŠ æ‰§è¡Œè·å–ä»£ç ä»£ç å¤åˆ¶åˆ°PostProcessing.cppæ–‡ä»¶ä»»æ„ä½ç½®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37  /*ç±»é™æ€æˆå‘˜çš„å®šä¹‰*/ TQueue\u0026lt;DepthResult *, EQueueMode::Mpsc\u0026gt; DepthCapture::waitForCapture; TQueue\u0026lt; DepthResult *, EQueueMode::Mpsc\u0026gt; DepthCapture::finishedCapture; /*è·å–æ·±åº¦ç¼“å­˜*/ void AddDepthInspectorPass(FRDGBuilder\u0026amp; GraphBuilder, const FViewInfo\u0026amp; View, DepthResult* result) { RDG_EVENT_SCOPE(GraphBuilder, \u0026#34;DepthInspector\u0026#34;); { // è·å–æ¸²æŸ“å¯¹è±¡ \tFSceneRenderTargets\u0026amp; renderTargets = FSceneRenderTargets::Get(GRHICommandList.GetImmediateCommandList()); // å®šä¹‰æ‹·è´å‚æ•° \tuint32 striped = 0; FIntPoint size = renderTargets.GetBufferSizeXY(); result-\u0026gt;bufferSizeX = size.X; result-\u0026gt;bufferSizeY = size.Y; result-\u0026gt;data.AddUninitialized(size.X * size.Y); // è·å–è§†çª—æŸä¸€å¸§çš„æ·±åº¦ç¼“å­˜å¯¹è±¡ \tFRHITexture2D* depthTexture = (FRHITexture2D *)renderTargets.SceneDepthZ-\u0026gt;GetRenderTargetItem().TargetableTexture.GetReference(); // æ‰§è¡Œæ‹·è´æ·±åº¦ç¼“å­˜æ“ä½œï¼Œå°†GPUæ˜¾å­˜ä¸­çš„ç¼“å­˜ä¿¡æ¯æ‹·è´åˆ°CPUå†…å­˜ä¸­ï¼Œè¿”å›æŒ‡å‘è¿™å—CPUå†…å­˜çš„é¦–åœ°å€ \tvoid* buffer = RHILockTexture2D(depthTexture, 0, EResourceLockMode::RLM_ReadOnly, striped, true); // å°†ç¼“å­˜ç»“æœæ‹·è´åˆ°resultï¼Œç”¨äºè¾“å‡º \tmemcpy(result-\u0026gt;data.GetData(), buffer, size.X * size.Y * 8); // å¿…é¡»æ‰§è¡Œè§£é”è¯­å¥ï¼Œå¦åˆ™è¢«é”ä½çš„GPUç¼“å­˜ä¿¡æ¯å°†ä¸èƒ½é‡Šæ”¾ \tRHIUnlockTexture2D(depthTexture, 0, true); // æ‹·è´ç»“æœå…¥é˜Ÿ \tDepthCapture::FinishedCapture(result); } } ////////////////////////////////////////   PostProcessing.cppä¸­è¯¥ä½ç½®æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š\nä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10  // Capture depth bufferï¼Œotherwise the buffer will be changed \tif (DepthCapture::HasCaptureRequest()) { DepthResult *reuslt; reuslt = DepthCapture::GetIfExistRequest(); if (reuslt) { AddDepthInspectorPass(GraphBuilder, View, reuslt); } }   3. è°ƒç”¨ ä½¿ç”¨ä»¥ä¸‹çš„ä»£ç å¯ä»¥è·å–æ·±åº¦å€¼ï¼Œè·å–çš„ç»“æœä¸ºresultï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  int tickcount = 0; // Called every frame void ATestPawn::Tick(float DeltaTime) { tickcount++; if (tickcount % 2 == 0)\t// è®¾è®¡å‡ å¸§è°ƒç”¨  DepthCapture::AddCapture(); // å®šæ—¶å‘å‡ºè·å–æ·±åº¦ç¼“å­˜çš„è¯·æ±‚  // å¦‚æœå­˜åœ¨å·²å®Œæˆçš„æ·±åº¦ç¼“å­˜è¯·æ±‚  if (DepthCapture::HasFinishedCapture()) { DepthResult *result; // è·å–å·²å®Œæˆçš„æ·±åº¦ç¼“å­˜ç»“æœ  result = DepthCapture::GetIfExistFinished(); if (result) { int n = result-\u0026gt;data.Num(); //this is test  GEngine-\u0026gt;AddOnScreenDebugMessage(-1, -1, FColor::Blue, FString::Printf(TEXT(\u0026#34;Get Depth Size: %d \u0026#34;), n)); } } }   ","description":"","id":78,"section":"posts","tags":["C++","UE4","Game"],"title":"UE4è·å–æ·±åº¦å€¼","uri":"https://hugo.jiahongw.com/zh/posts/ue/ue-depth/"},{"content":"æ¢ç´¢UE4æ¸¸æˆçº¿ç¨‹çš„è¿›å…¥\næ¸¸æˆçº¿ç¨‹ \u0026amp; æ¸²æŸ“çº¿ç¨‹ UE4æ¸¸æˆçº¿ç¨‹å¯åŠ¨ æ¸¸æˆçº¿ç¨‹æ¯ä¸€å¸§æ›´æ–°æ‰€æœ‰å†…å®¹ã€‚\nè¿™ä¸ªtickæ˜¯å“ªé‡Œæ‰“å¼€çš„ï¼Ÿ\nå¤´æ–‡ä»¶ï¼šEngine\\Source\\Runtime\\Launch\\Private\\Launch.cpp\nLauch.cppå®šä¹‰äº†ä¸€ä¸ªå…¨å±€çš„å˜é‡FEngineLoop GEngineLoop;\nè¯¥ç±»è·¯å¾„ï¼šEngine\\Source\\Runtime\\Launch\\Public\\LaunchEngineLoop.hï¼Œç»§æ‰¿ä¸€ä¸ªæ¥å£ç±»IEngineLoopï¼Œå®šä¹‰å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145  /** * Implements the main engine loop.\t*/ class FEngineLoop #if WITH_ENGINE\t: public IEngineLoop #endif{ public: /** Default constructor. */ FEngineLoop(); virtual ~FEngineLoop() { } public: /** * Pre-Initialize the main loop, and generates the commandline from standard ArgC/ArgV from main(). * * @param ArgC The number of strings in ArgV. * @param ArgV The command line parameters (ArgV[0] is expected to be the executable name). * @param AdditionalCommandLine Optional string to append to the command line (after ArgV is put together). * @return Returns the error level, 0 if successful and \u0026gt; 0 if there were errors. */ int32 PreInit(int32 ArgC, TCHAR* ArgV[], const TCHAR* AdditionalCommandline = nullptr); /** * Pre-Initialize the main loop - parse command line, sets up GIsEditor, etc. * * @param CmdLine The command line. * @return The error level; 0 if successful, \u0026gt; 0 if there were errors. */ int32 PreInit(const TCHAR* CmdLine); /** First part of PreInit. */ int32 PreInitPreStartupScreen(const TCHAR* CmdLine); /** Second part of PreInit. */ int32 PreInitPostStartupScreen(const TCHAR* CmdLine); /** Load all modules needed before Init. */ void LoadPreInitModules(); /** Load core modules. */ bool LoadCoreModules(); /** Clean up PreInit context. */ void CleanupPreInitContext(); #if WITH_ENGINE\t/** Load all core modules needed at startup time. */ bool LoadStartupCoreModules(); /** Load all modules needed at startup time. */ bool LoadStartupModules(); /** * Initialize the main loop (the rest of the initialization). * * @return The error level; 0 if successful, \u0026gt; 0 if there were errors. */ virtual int32 Init() override; /** Initialize the timing options from the command line. */ void InitTime(); /** Performs shut down. */ void Exit(); /** Whether the engine should operate in an idle mode that uses no CPU or GPU time. */ bool ShouldUseIdleMode() const; // Advances the main loop.æ¨è¿›ä¸»å¾ªç¯ \tvirtual void Tick() override; /** Removes references to any objects pending cleanup by deleting them. */ virtual void ClearPendingCleanupObjects() override; #endif // WITH_ENGINE  /** RHI post-init initialization */ static void PostInitRHI(); /** Pre-init HMD device (if necessary). */ static void PreInitHMDDevice(); public: /** Initializes the application. */ static bool AppInit(); /** * Prepares the application for shutdown. * * This function is called from within guarded exit code, only during non-error exits. */ static void AppPreExit(); /** * Shuts down the application. * * This function called outside guarded exit code, during all exits (including error exits). */ static void AppExit(); private: /** Utility function that processes Slate operations. */ void ProcessLocalPlayerSlateOperations() const; protected: /** Holds a dynamically expanding array of frame times in milliseconds (if FApp::IsBenchmarking() is set). */ TArray\u0026lt;float\u0026gt; FrameTimes; /** Holds the total time spent ticking engine. */ double TotalTickTime; /** Holds the maximum number of seconds engine should be ticked. */ double MaxTickTime; /** Holds the maximum number of frames to render in benchmarking mode. */ uint64 MaxFrameCounter; /** Holds the number of cycles in the last frame. */ uint32 LastFrameCycles; #if WITH_ENGINE /** Holds the objects which need to be cleaned up when the rendering thread finishes the previous frame. */ FPendingCleanupObjects* PendingCleanupObjects; #endif //WITH_ENGINE  private: #if WITH_ENGINE /** Holds the engine service. */ FEngineService* EngineService; /** Holds the application session service. */ TSharedPtr\u0026lt;ISessionService\u0026gt; SessionService; #endif // WITH_ENGINE \tFPreInitContext PreInitContext; };    è¯¥æ–‡ä»¶åªéœ€#include \u0026quot;CoreMinimal.h\u0026quot;ï¼Œæœ€å¤šåŠ ä¸Š#include \u0026quot;UnrealEngine.h\u0026quot;\n æ¥å£ç±»ï¼Œä½äºè·¯å¾„Engine\\Source\\Runtime\\Engine\\Public\\UnrealEngine.hï¼š\n1 2 3 4 5 6 7 8 9  /** Public interface to FEngineLoop so we can call it from editor or editor code */ class IEngineLoop { public: virtual int32 Init() = 0; virtual void Tick() = 0; /** Removes references to any objects pending cleanup by deleting them. */ virtual void ClearPendingCleanupObjects() = 0; };   å¼€å¯Tickå‡½æ•°ä¹‹å‰éœ€è¦åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–å‡½æ•°åœ¨Launch.cppè¿™ä¸ªæ–‡ä»¶ä¸­ï¼š\n1 2 3 4 5 6  /* Inits the engine loop */ int32 EngineInit() { int32 ErrorLevel = GEngineLoop.Init(); return( ErrorLevel ); }   GEngineLoop.Init()å‡½æ•°ï¼š\nå…¶ä¸­ä¼šåˆ¤æ–­æ˜¯è¿›å…¥é‚£ç§å¼•æ“æ¨¡å¼ï¼Œåˆ†ä¸ºGameæ¨¡å¼ä¸Editoræ¨¡å¼ã€‚\nç»“æŸå¼•æ“çš„å‡½æ•°ä¸ºï¼š\n1 2 3 4 5 6 7 8 9 10  /** * Shuts down the engine */ void EngineExit( void ) { // Make sure this is set \tRequestEngineExit(TEXT(\u0026#34;EngineExit() was called\u0026#34;)); GEngineLoop.Exit(); }   ä¹Ÿåœ¨Launch.cpp\nLaunch.cppä¸­çš„å‡½æ•°å¤šæ¬¡ä½¿ç”¨GEngineè¿™ä¸ªå¤–éƒ¨å˜é‡ï¼Œè¿™ä¸ªå˜é‡åœ¨ä¸Šé¢çš„åˆå§‹åŒ–å‡½æ•°ä¼šè‡ªå®šè®¾ç½®ä¸ºç›¸åº”çš„å¼•æ“ï¼Œå³Gameå¼•æ“æˆ–è€…Editorå¼•æ“ï¼š\n æ‰€åœ¨æ–‡ä»¶Engine.h\n åœ¨FEngineLoop::Tick()å‡½æ•°ä¼šè°ƒç”¨GEngineçš„Tickå‡½æ•°ï¼š\nä¹Ÿå°±æ˜¯æœ¬æ–‡å¼€å§‹çš„é‚£ä¸ªTickå‡½æ•°ã€‚\n","description":"","id":79,"section":"posts","tags":["C++","UE4","Game"],"title":"UEæ¸¸æˆã€æ¸²æŸ“çº¿ç¨‹","uri":"https://hugo.jiahongw.com/zh/posts/ue/ue-game-render/"},{"content":"==é€šå¸¸çš„æ¸¸æˆå¼•æ“ä¸­æ¸¸æˆçº¿ç¨‹å’Œæ¸²æŸ“çº¿ç¨‹éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç›¸äº’ä¹‹é—´ä¼šå­˜åœ¨ä¸€ä¸ªåŒæ­¥çš„æœºåˆ¶==\nKeyWord: UMG è™šå¹»ç¤ºæ„å›¾å½¢ç•Œé¢è®¾è®¡å™¨ï¼ˆUnreal Motion Graphics UI Designerï¼‰(UMG) æ˜¯ä¸€ä¸ªå¯è§†åŒ–çš„UIåˆ›ä½œå·¥å…·ï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºUIå…ƒç´ ï¼Œå¦‚æ¸¸æˆä¸­çš„HUDã€èœå•æˆ–æ‚¨å¸Œæœ›å‘ˆç°ç»™ç”¨æˆ·çš„å…¶ä»–ç•Œé¢ç›¸å…³å›¾å½¢ã€‚UMGçš„æ ¸å¿ƒæ˜¯æ§ä»¶ï¼Œè¿™äº›æ§ä»¶æ˜¯ä¸€ç³»åˆ—é¢„å…ˆåˆ¶ä½œçš„å‡½æ•°ï¼Œå¯ç”¨äºæ„å»ºç•Œé¢ï¼ˆå¦‚æŒ‰é’®ã€å¤é€‰æ¡†ã€æ»‘å—ã€è¿›åº¦æ¡ç­‰ï¼‰ã€‚è¿™äº›æ§ä»¶åœ¨ä¸“é—¨çš„æ§ä»¶è“å›¾ä¸­ç¼–è¾‘ï¼Œè¯¥è“å›¾ä½¿ç”¨ä¸¤ä¸ªé€‰é¡¹å¡è¿›è¡Œæ„é€ ï¼šè®¾è®¡å™¨ï¼ˆDesignerï¼‰é€‰é¡¹å¡å…è®¸ç•Œé¢å’ŒåŸºæœ¬å‡½æ•°çš„å¯è§†åŒ–å¸ƒå±€ï¼Œè€Œå›¾è¡¨ï¼ˆGraphï¼‰é€‰é¡¹å¡æä¾›æ‰€ä½¿ç”¨æ§ä»¶èƒŒåçš„åŠŸèƒ½ã€‚\nSlate Slate æ˜¯å®Œå…¨è‡ªå®šä¹‰ã€ä¸å¹³å°æ— å…³çš„ç”¨æˆ·ç•Œé¢æ¡†æ¶ï¼Œæ—¨åœ¨è®©å·¥å…·å’Œåº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚è™šå¹»ç¼–è¾‘å™¨ï¼‰çš„ç”¨æˆ·ç•Œé¢æˆ–æ¸¸æˆä¸­ç”¨æˆ·ç•Œé¢çš„æ„å»ºè¿‡ç¨‹å˜å¾—æœ‰è¶£ã€é«˜æ•ˆã€‚å®ƒå°†å£°æ˜æ€§è¯­æ³•ä¸è½»æ¾è®¾è®¡ã€å¸ƒå±€å’Œé£æ ¼ç»„ä»¶çš„åŠŸèƒ½ç›¸ç»“åˆï¼Œå…è®¸åœ¨UIä¸Šè½»æ¾å®ç°åˆ›å»ºå’Œè¿­ä»£ã€‚\nSlate UIè§£å†³æ–¹æ¡ˆä½¿å¾—ä¸ºå·¥å…·å’Œåº”ç”¨ç¨‹åºç»„åˆå›¾å½¢ç”¨æˆ·ç•Œé¢å’Œå¿«é€Ÿè¿­ä»£è¿™äº›ç•Œé¢å˜å¾—æå…¶ç®€å•ã€‚\nRHICmdList è¿™æ˜¯ä¸€ç»„ç‹¬ç‰¹çš„å®ï¼Œç”¨äºå°†æ“ä½œå‘é€åˆ°æ¸²æŸ“çº¿ç¨‹è¿›è¡Œæ“ä½œã€‚\nä¸»è¦æ˜¯å¯¹Textureä¹‹ç±»çš„æ•°æ®åœ¨GPUä»¥åŠGPUç›¸å…³çš„æŒ‡ä»¤è¿›è¡Œæ‰§è¡Œã€‚\næ¸²æŸ“çº¿ç¨‹çš„é€šä¿¡ å‚è€ƒé“¾æ¥ï¼š\n ã€ŠExploring in UE4ã€‹å¤šçº¿ç¨‹æœºåˆ¶è¯¦è§£[åŸç†åˆ†æ] çº¹ç†å’Œé‡‡æ ·å™¨ è™šå¹»4 Task Graph System ä»‹ç»  é¢„è§ˆ UE4å¼•æ“è¿è¡Œæ—¶çš„éƒ¨åˆ†çº¿ç¨‹ï¼Œåœ¨UEä¸­ï¼Œè®¸å¤šæ¨¡å—éƒ½ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œå¦‚æ¸²æŸ“æ¨¡å—ã€ç‰©ç†æ¨¡å—ã€ç½‘ç»œé€šä¿¡ã€éŸ³é¢‘ç³»ç»Ÿã€IOï¼š\nè™½ç„¶UE4éµå¾ªC++11çš„æ ‡å‡†ï¼Œä½†æ˜¯ä»–å¹¶æ²¡æœ‰ä½¿ç”¨std::threadï¼Œè€Œæ˜¯è‡ªå·±å®ç°äº†ä¸€å¥—å¤šçº¿ç¨‹æœºåˆ¶ï¼ˆåº”è¯¥æ˜¯ä»UE3æ—¶ä»£å°±æœ‰äº†ï¼Œæœªè€ƒè¯ï¼‰ï¼Œç”¨æ³•ä¸Šå¾ˆåƒJavaã€‚\nä½¿ç”¨çº¿ç¨‹ åœ¨UE4é‡Œé¢ï¼Œä½¿ç”¨çº¿ç¨‹æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼š\n æˆ‘ä»¬å¯ä»¥è‡ªå·±ç»§æ‰¿FRunnableæ¥å£åˆ›å»ºå•ä¸ªçº¿ç¨‹ ç›´æ¥åˆ›å»ºAsyncTaskæ¥è°ƒç”¨çº¿ç¨‹æ± é‡Œé¢ç©ºé—²çš„çº¿ç¨‹ é€šè¿‡TaskGraphç³»ç»Ÿæ¥å¼‚æ­¥å®Œæˆä¸€äº›è‡ªå®šä¹‰ä»»åŠ¡ã€‚  FRunnable çº¿ç´¢ï¼š\n   æ¨¡å— Core     .h /Engine/Source/Runtime/Core/Public/HAL/Runnable.h   include #include \u0026ldquo;HAL/Runnable.h\u0026rdquo;     UE4ä¸­æœ€åŸºç¡€çš„æ¨¡å‹å°±æ˜¯FRunnableå’ŒFRunnableThreadï¼ŒFRunnableæŠ½è±¡å‡ºä¸€ä¸ªå¯ä»¥æ‰§è¡Œåœ¨çº¿ç¨‹ä¸Šçš„å¯¹è±¡ï¼Œè€ŒFRunnableThreadæ˜¯å¹³å°æ— å…³çš„çº¿ç¨‹å¯¹è±¡çš„æŠ½è±¡ã€‚åé¢çš„ç¯‡å¹…ä¼šè¯¦ç»†è®¨è®ºè¿™äº›åŸºç¡€è®¾æ–½ã€‚\n åˆ›å»ºä¸€ä¸ªç»§æ‰¿äºFRunnableçš„ç±»ï¼ŒFRunnableå£°æ˜å¦‚ä¸‹ï¼š\n FRunnableå°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç±»ï¼Œé‡Œé¢åªæœ‰5ï¼Œ6ä¸ªå‡½æ•°æ¥å£ï¼Œä¸ºäº†ä¸çœŸæ­£çš„çº¿ç¨‹åŒºåˆ†ï¼Œæˆ‘è¿™é‡Œç§°FRunnableä¸ºâ€œçº¿ç¨‹æ‰§è¡Œä½“â€ï¼›æ‰€è°“çœŸæ­£çš„çº¿ç¨‹å…¶å®å°±æ˜¯FRunnableThreadï¼Œä¸åŒå¹³å°çš„çº¿ç¨‹éƒ½ç»§æ‰¿è‡ªä»–ï¼Œå¦‚FRunnableThreadWinï¼Œé‡Œé¢ä¼šè°ƒç”¨Windowså¹³å°çš„åˆ›å»ºçº¿ç¨‹çš„APIæ¥å£ã€‚\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59  class CORE_API FRunnable { public: /** * Initializes the runnable object. * * This method is called in the context of the thread object that aggregates this, not the * thread that passes this runnable to a new thread. * * @return True if initialization was successful, false otherwise * @see Run, Stop, Exit */ virtual bool Init() { return true; } /** * Runs the runnable object. * * This is where all per object thread work is done. This is only called if the initialization was successful. * * @return The exit code of the runnable object * @see Init, Stop, Exit */ virtual uint32 Run() = 0; /** * Stops the runnable object. * * This is called if a thread is requested to terminate early. * @see Init, Run, Exit */ virtual void Stop() { } /** * Exits the runnable object. * * Called in the context of the aggregating thread to perform any cleanup. * @see Init, Run, Stop */ virtual void Exit() { } /** * Gets single thread interface pointer used for ticking this runnable when multi-threading is disabled. * If the interface is not implemented, this runnable will not be ticked when FPlatformProcess::SupportsMultithreading() is false. * * @return Pointer to the single thread interface or nullptr if not implemented. */ virtual class FSingleThreadRunnable* GetSingleThreadInterface( ) { return nullptr; } /** Virtual destructor */ virtual ~FRunnable() { } };   FRunnableä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»ç±»å›¾ï¼š\nUE4ä¸­çš„å¤šçº¿ç¨‹æ¨¡å‹ç”¨ä¸€å¥è¯æ¦‚æ‹¬ä¸º: A FRunnable runs on a FRunnableThread.\n FQueuedThreadPoolçº¿ç¨‹æ±     æ¨¡å— Core      /Engine/Source/Runtime/Core/Public/Misc/QueuedThreadPool.h    #include \u0026ldquo;Misc/QueuedThreadPool.h\u0026rdquo;    FQueuedThreadPoolã€‚å’Œä¸€èˆ¬çš„çº¿ç¨‹æ± å®ç°ç±»ä¼¼ï¼Œçº¿ç¨‹æ± é‡Œé¢ç»´æŠ¤äº†å¤šä¸ªçº¿ç¨‹FQueuedThreadä¸å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—IQueuedWorkï¼Œçº¿ç¨‹æ˜¯æŒ‰ç…§é˜Ÿåˆ—çš„æ–¹å¼æ¥æ’åˆ—çš„ã€‚\nåœ¨çº¿ç¨‹æ± é‡Œé¢æ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯FQueuedThreadç±»å‹ï¼Œä¸è¿‡æ›´ç¡®åˆ‡çš„è¯´FQueuedThreadæ˜¯ç»§æ‰¿è‡ªFRunnableçš„çº¿ç¨‹æ‰§è¡Œä½“ï¼Œæ¯ä¸ªFQueuedThreadé‡Œé¢åŒ…å«ä¸€ä¸ªFRunnableThreadä½œä¸ºå†…éƒ¨æˆå‘˜ã€‚\nç›¸æ¯”ä¸€èˆ¬çš„çº¿ç¨‹ï¼ŒFQueuedThreadé‡Œé¢å¤šäº†ä¸€ä¸ªæˆå‘˜FEvent* DoWorkEventï¼Œä¹Ÿå°±æ˜¯è¯´FQueuedThreadé‡Œé¢æ˜¯æœ‰ä¸€ä¸ªäº‹ä»¶è§¦å‘æœºåˆ¶çš„ã€‚é‚£ä¹ˆè¿™ä¸ªäº‹ä»¶æœºåˆ¶çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿä¸€èˆ¬æƒ…å†µä¸‹æ¥è¯´ï¼Œå°±æ˜¯åœ¨æ²¡æœ‰ä»»åŠ¡çš„æ—¶å€™æŒ‚èµ·è¿™ä¸ªçº¿ç¨‹ï¼Œåœ¨æ·»åŠ å¹¶åˆ†é…ç»™è¯¥çº¿ç¨‹ä»»åŠ¡çš„æ—¶å€™æ¿€æ´»ä»–ï¼Œä¸è¿‡ä½ å¯ä»¥çµæ´»è¿ç”¨å®ƒï¼Œåœ¨ä½ éœ€è¦çš„æ—¶å€™å»åŠ¨æ€æ§åˆ¶çº¿ç¨‹ä»»åŠ¡çš„æ‰§è¡Œä¸æš‚åœã€‚\n AsyncTaskç³»ç»Ÿ AsyncTaskç³»ç»Ÿæ˜¯ä¸€å¥—åŸºäºçº¿ç¨‹æ± çš„å¼‚æ­¥ä»»åŠ¡å¤„ç†ç³»ç»Ÿã€‚\nFAsyncTaskæœ‰å‡ ä¸ªç‰¹ç‚¹ï¼š\n FAsyncTaskæ˜¯ä¸€ä¸ªæ¨¡æ¿ç±»ï¼ŒçœŸæ­£çš„AsyncTaskéœ€è¦ä½ è‡ªå·±å†™ã€‚é€šè¿‡DoWorkæä¾›ä½ è¦æ‰§è¡Œçš„å…·ä½“ä»»åŠ¡ï¼Œç„¶åæŠŠä½ çš„ç±»ä½œä¸ºæ¨¡æ¿å‚æ•°ä¼ è¿‡å» ä½¿ç”¨FAsyncTaskå°±é»˜è®¤ä½ è¦ä½¿ç”¨UEæä¾›çš„çº¿ç¨‹æ± FQueuedThreadPoolï¼Œå‰é¢ä»£ç é‡Œè¯´æ˜äº†åœ¨å¼•æ“PreInitçš„æ—¶å€™ä¼šåˆå§‹åŒ–çº¿ç¨‹æ± å¹¶è¿”å›ä¸€ä¸ªæŒ‡é’ˆGThreadPoolã€‚åœ¨æ‰§è¡ŒFAsyncTaskä»»åŠ¡æ—¶ï¼Œå¦‚æœä½ åœ¨æ‰§è¡ŒStartBackgroundTaskçš„æ—¶å€™ä¼šé»˜è®¤ä½¿ç”¨GThreadPoolçº¿ç¨‹æ± ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨å‚æ•°é‡Œé¢æŒ‡å®šè‡ªå·±åˆ›å»ºçš„çº¿ç¨‹æ±  åˆ›å»ºFAsyncTaskå¹¶ä¸ä¸€å®šè¦ä½¿ç”¨æ–°çš„çº¿ç¨‹ï¼Œä½ å¯ä»¥è°ƒç”¨å‡½æ•°StartSynchronousTaskç›´æ¥åœ¨å½“å‰çº¿ç¨‹ä¸Šæ‰§è¡Œä»»åŠ¡ FAsyncTaskæœ¬èº«åŒ…å«ä¸€ä¸ªDoneEventï¼Œä»»åŠ¡æ‰§è¡Œå®Œæˆçš„æ—¶å€™ä¼šæ¿€æ´»è¯¥äº‹ä»¶ã€‚å½“ä½ æƒ³ç­‰å¾…ä¸€ä¸ªä»»åŠ¡å®Œæˆæ—¶å†åšå…¶ä»–æ“ä½œï¼Œå°±å¯ä»¥è°ƒç”¨EnsureCompletionå‡½æ•°ï¼Œä»–å¯ä»¥ä»é˜Ÿåˆ—é‡Œé¢å–å‡ºæ¥è¿˜æ²¡è¢«æ‰§è¡Œçš„ä»»åŠ¡æ”¾åˆ°å½“å‰çº¿ç¨‹æ¥åšï¼Œä¹Ÿå¯ä»¥æŒ‚èµ·å½“å‰çº¿ç¨‹ç­‰å¾…DoneEventæ¿€æ´»åå†å¾€ä¸‹æ‰§è¡Œ  Task Graph ç³»ç»Ÿ Task Graph ç³»ç»Ÿæ˜¯UE4ä¸€å¥—æŠ½è±¡çš„å¼‚æ­¥ä»»åŠ¡å¤„ç†ç³»ç»Ÿï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªå¤šçº¿ç¨‹ä»»åŠ¡ï¼ŒæŒ‡å®šå„ä¸ªä»»åŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ŒæŒ‰ç…§è¯¥å…³ç³»æ¥ä¾æ¬¡å¤„ç†ä»»åŠ¡ã€‚\nTickå‡½æ•°\nå¹³æ—¶è°ƒè¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬éšä¾¿æ‰¾ä¸ªTickæ–­ç‚¹ä¸€ä¸‹éƒ½èƒ½çœ‹åˆ°ç±»ä¼¼ä¸‹å›¾è¿™æ ·çš„å‡½æ•°å †æ ˆã€‚å¦‚æœä½ å‰é¢çš„ç« èŠ‚éƒ½çœ‹æ‡‚çš„è¯ï¼Œè¿™ä¸ªå †æ ˆä¹Ÿèƒ½å¤§æ¦‚ç†è§£ã€‚Worldåœ¨æ‰§è¡ŒTickçš„æ—¶å€™ï¼Œè§¦å‘äº†FNamedTaskThreadçº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼ˆFTickFunctionTaskï¼‰ï¼Œä»»åŠ¡FTickFunctionTaskå…·ä½“çš„å·¥ä½œå†…å®¹å°±æ˜¯æ‰§è¡ŒACtorComponentçš„Tickå‡½æ•°ã€‚å…¶å®ï¼Œè¿™ä¸ªå †æ ˆä¹Ÿè¯´æ˜äº†æ‰€æœ‰Actorä¸Componentçš„Tickéƒ½æ˜¯é€šè¿‡TaskGraphç³»ç»Ÿæ¥æ‰§è¡Œçš„ï¼ˆåœ¨TG_PrePhysicsé˜¶æ®µï¼‰ã€‚\nCconclusion ==å¯¹äºæ¶ˆè€—å¤§çš„ï¼Œå¤æ‚çš„ä»»åŠ¡ä¸å»ºè®®ä½¿ç”¨TaskGraphï¼Œä¸€æ˜¯å› ä¸ºTaskGraphå¦‚æœè¢«åˆ†é…åˆ°æ¸¸æˆçº¿ç¨‹ï¼Œå°±ä¼šé˜»å¡æ•´ä¸ªæ¸¸æˆçº¿ç¨‹çš„æ‰§è¡Œï¼ŒäºŒæ˜¯å³ä½¿ä½ ä¸åœ¨é‚£å‡ ä¸ªæœ‰åå­—çš„çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œä¹Ÿå¯èƒ½ä¼šå½±å“åˆ°æ¸¸æˆçš„å…¶ä»–é€»è¾‘ã€‚==\nå…¨å®¶ç¦ï¼š\nçº¿ç¨‹åŒæ­¥ UE4å¯¹æ“ä½œç³»ç»Ÿæä¾›çš„çº¿ç¨‹åŒæ­¥ç›¸å…³æ¥å£è¿›è¡Œäº†ä¸€å®šçš„å°è£…ã€‚\nAtomics \u0026hellip;\u0026hellip;\n","description":"","id":80,"section":"posts","tags":["UE","C++"],"title":"UE4å¤šçº¿ç¨‹","uri":"https://hugo.jiahongw.com/zh/posts/ue/ue-thread-commuicate/"},{"content":"UE4é—®é¢˜æ±‡æ€»   UE4å…‰ç…§æ„å»ºå¤±è´¥âš \nhttps://blog.csdn.net/earlyAutumnOfRain/article/details/80863561\n  UE4å¯¼å…¥ç°åº¦å›¾\nhttps://www.cnblogs.com/gucheng/p/10116857.html\n  è¯¦è§£UE4é™æ€åº“ä¸åŠ¨æ€åº“çš„å¯¼å…¥ä¸ä½¿ç”¨\nhttps://gameinstitute.qq.com/community/detail/121551\n  Ue4_åºåˆ—åŒ–æµ…æ_\nhttps://blog.csdn.net/mohuak/article/details/83027211\n  UEå¿«æ·é”®\nhttps://www.unrealengine.com/zh-CN/tech-blog/designer-s-guide-to-unreal-engine-keyboard-shortcuts\n  UE4èµ„æºåŠ è½½ï¼ˆä¸€ï¼‰ä»StaticLoadObjectå¼€å§‹\nhttp://suo.im/6v7hUc\n  Unreal Cookbookï¼šåˆ›å»ºå¯¹è±¡çš„çš„å‡ ç§å§¿åŠ¿ï¼ˆC++ï¼‰\nhttps://blog.csdn.net/Neil3D/article/details/51488401\n  Aeryçš„UE4 C++æ¸¸æˆå¼€å‘ä¹‹æ—…ï¼ˆ1ï¼‰åŸºç¡€å¯¹è±¡æ¨¡å‹\nhttps://www.cnblogs.com/KillerAery/p/11986316.html\n  ç›®å½•ç»“æ„\nhttps://docs.unrealengine.com/zh-CN/Engine/Basics/DirectoryStructure/index.html\n  å¼•æ“ä¸–ç•Œ\nhttps://www.engineworld.cn/\n  ã€ŠInsideUE4ã€‹GamePlayæ¶æ„ï¼ˆä¸€ï¼‰Actorå’ŒComponent\nhttps://zhuanlan.zhihu.com/p/22833151\n  å®æ—¶æ¸²æŸ“ä¸­çš„åæ ‡ç³»å˜æ¢ï¼ˆ5ï¼‰ï¼šæŠ•å½±å˜æ¢-3\nhttps://zhuanlan.zhihu.com/p/115395322\n  UE4 å±å¹•åæ ‡è½¬æ¢åˆ°ä¸–ç•Œåæ ‡\nhttps://blog.csdn.net/weixin_36412907/article/details/77306212\n  UE4å¿…è¯»æ–‡ç« åˆ—è¡¨_ä¸ªäººæ•´ç†\nhttps://zhuanlan.zhihu.com/p/126611976\n  OpenGL å­¦ä¹ ç³»åˆ—\u0026mdash;æŠ•å½±çŸ©é˜µ\nhttps://juejin.im/post/5b0ec5fef265da092a2b79b1\n  Alpha Test\nhttp://geekfaner.com/shineengine/blog13_OpenGLESv2_12.html\n  Rendocä½¿ç”¨\nhttps://www.cnblogs.com/kekec/p/11760288.html\n  [å¤šè§†å›¾å‡ ä½•] - é€†é€è§†å˜æ¢\nhttps://blog.csdn.net/chishuideyu/article/details/79136903\n  UE4å¿…è¯»æ–‡ç« åˆ—è¡¨_ä¸ªäººæ•´ç†\nhttps://zhuanlan.zhihu.com/p/126611976\n  UE4ä¸­çš„Tone Mapping\nhttps://www.dingshukai.com/blog/ue4-tone-mapping.html\n  UE4 æ¸²æŸ“æµç¨‹\nhttps://blog.csdn.net/or_7r_ccl/article/details/81102771\n  [UE4]å°è¯•ä½¿ç”¨è‡ªå®šä¹‰æ·±åº¦ fq\nhttp://monsho.blog63.fc2.com/blog-entry-138.html#comment469\n  [UE4]æ‰©å±•GBuffer\nhttp://monsho.blog63.fc2.com/blog-entry-191.html\n  https://ue4study-osaka.connpass.com/event/120568/\n  UE4æ–‡ä»¶ç³»ç»Ÿ  æ¨¡å—æ˜¯UE4çš„æ„å»ºå—ã€‚å¼•æ“æ˜¯ä»¥å¤§é‡æ¨¡å—çš„é›†åˆå½¢å¼å®ç°çš„ï¼Œæ¸¸æˆæä¾›è‡ªå·±çš„æ¨¡å—æ¥æ‰©å……è‡ªå·±ã€‚æ¯ä¸ªæ¨¡å—éƒ½å°è£…äº†ä¸€ç»„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥æä¾›å…¬å…±æ¥å£å’Œç¼–è¯‘ç¯å¢ƒï¼ˆåŒ…æ‹¬å®ã€è·¯å¾„ç­‰ï¼‰ä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨ã€‚\n .build.csæ–‡ä»¶çš„å…¸å‹ç»“æ„å¦‚ä¸‹ã€‚\n1 2 3 4 5 6 7 8 9  using UnrealBuildTool; using System.Collections.Generic; public class MyModule : ModuleRules { public MyModule(ReadOnlyTargetRules Target) : base(Target) { // Settings go here  } }     \\Engine\\Source\\ThirdPartyç›®å½•\nå­˜æ”¾ç¬¬ä¸‰æ–¹çš„åº“\n  F:\\UnrealEngine4.14\\Engine\\Pluginsç›®å½•(æˆ–è€…F:\\UE4Project\\é¡¹ç›®åç§°\\Pluginsç›®å½•)\nä¿å­˜æ’ä»¶çš„ç›®å½•\n  UEåˆ›ä¸–ï¼Œä¸‡ç‰©çš†UObjectï¼Œæ¥ç€æœ‰Actorã€‚\nComponentå’ŒActor  UE4è®©Actorä»¬è½»è£…ä¸Šé˜µï¼Œåªæä¾›ä¸€äº›é€šç”¨çš„åŸºæœ¬ç”Ÿå­˜èƒ½åŠ›ï¼Œè€ŒæŠŠä¼—å¤šçš„â€œæŠ€èƒ½â€æŠ½è±¡æˆäº†ä¸€ä¸ªä¸ªâ€œComponentâ€å¹¶æä¾›ç»„è£…çš„æ¥å£ï¼Œè®©Actoréšç”¨éšç»„è£…ï¼ŒæŠŠè‡ªå·±æ­¦è£…æˆä¸€ä¸ªä¸ªä¸“ä¸šèƒ½æ‰‹ã€‚\n ç›¸å…³ç»„ä»¶ RootComponent å®šä¹‰è¿™ä¸ªæ¼”å‘˜åœ¨ä¸–ç•Œä¸Šçš„å˜æ¢(ä½ç½®ã€æ—‹è½¬ã€ç¼©æ”¾)çš„ç»„ä»¶ï¼Œæ‰€æœ‰å…¶ä»–ç»„ä»¶å¿…é¡»ä»¥æŸç§æ–¹å¼é™„åŠ åˆ°è¿™ä¸ªç»„ä»¶\nå¼¹ç°§è‡‚ç»„ä»¶ å¼¹ç°§è‡‚ç»„ä»¶ç”¨äºè‡ªåŠ¨æ§åˆ¶æ‘„åƒæœºå—é˜»æ—¶çš„åº”å¯¹æ–¹å¼ã€‚\nUEæ–‡ä»¶å­˜å‚¨çš„æ–¹å¼ UE ä¸­ä½¿ç”¨ç»Ÿä¸€çš„æ ¼å¼å­˜å‚¨èµ„æº (uassetï¼Œ umap)ï¼Œæ¯ä¸ª uasset å¯¹åº”ä¸€ä¸ªåŒ… (package)ï¼Œå­˜å‚¨ä¸€ä¸ª UPackage å¯¹è±¡æ—¶ï¼Œä¼šå°†è¯¥åŒ…ä¸‹çš„æ‰€æœ‰å¯¹è±¡éƒ½å­˜åˆ° uasset ä¸­ã€‚\n ä¸€ä¸ªèµ„æºåœ¨æ–‡ä»¶ä¸­å¯¹åº”uassetï¼Œåœ¨å†…å­˜ä¸­å¯¹åº”ä¸ºUPackageã€‚\n uassetæ–‡ä»¶æ ¼å¼  File Summary æ–‡ä»¶å¤´ä¿¡æ¯ Name Table åŒ…ä¸­å¯¹è±¡çš„åå­—è¡¨ Import Table å­˜æ”¾è¢«è¯¥åŒ…ä¸­å¯¹è±¡å¼•ç”¨çš„å…¶å®ƒåŒ…ä¸­çš„å¯¹è±¡ä¿¡æ¯(è·¯å¾„åå’Œç±»å‹) Export Table è¯¥åŒ…ä¸­çš„å¯¹è±¡ä¿¡æ¯(è·¯å¾„åå’Œç±»å‹) Export Objects æ‰€æœ‰Export Tableä¸­å¯¹è±¡çš„å®é™…æ•°æ®ã€‚  FlinkerLoad FLinkerLoadæ˜¯ä½œä¸ºuassetå’Œå†…å­˜UPackageçš„ä¸­é—´æ¡¥æ¢ã€‚åœ¨åŠ è½½å†…å®¹ç”ŸæˆUPackageçš„æ—¶å€™ï¼ŒUPackageä¼šæ ¹æ®åå­—æ‰¾åˆ°uassetæ–‡ä»¶ï¼Œç”±FLinkerLoadæ¥è´Ÿè´£åŠ è½½ã€‚\nFLinkerLoadä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š\n FArchive* Loader;\t//Loaderè´Ÿè´£è¯»å–å…·ä½“æ–‡ä»¶ TArray ImportMap; //å°†uassetçš„ImportTableåŠ è½½åˆ°ImportMapä¸­ï¼ŒFObjectImportæ˜¯éœ€è¦ä¾èµ–ï¼ˆå¯¼å…¥ï¼‰çš„UObject TArray ExportMap; //FObjectExportæ˜¯è¿™ä¸ªUPackageæ‰€æ‹¥æœ‰çš„UObjectï¼ˆè¿™äº›UObjectéƒ½èƒ½æä¾›ç»™å…¶ä»–UPackageä½œä¸ºImportï¼‰  StaticLoadObjectåŠ è½½ æ­¥éª¤ï¼š\n æ ¹æ®æ–‡ä»¶åå­—åˆ›å»ºä¸€ä¸ªç©ºçš„åŒ…ï¼ˆæ²¡æœ‰ä»»ä½•æ–‡ä»¶ç›¸å…³çš„æ•°æ®ï¼‰ å»ºç«‹ä¸€ä¸ªLinkerLoadå»åŠ è½½å¯¹åº”çš„uassetæ–‡ä»¶ åºåˆ—åŒ–ã€‚ ä¼˜å…ˆåŠ è½½ImportMap åŠ è½½ExportMapï¼ˆæœ¬èº«çš„æ•°æ®ï¼‰  1ã€å»ºç«‹ä¸€ä¸ªUPackage\n2ã€åºåˆ—åŒ–uasset\n3ã€åŠ è½½ImportMap\nPawné»˜è®¤ç»„ä»¶ UEç›¸æœº http://www.geodesic.games/2019/03/27/projection-matrices-in-unreal-engine/\n Firstly, Unreal inverses the perspective divide, applying 1 instead of -1 for the â€œWâ€ value.ï¼ˆè™šå¹»å¤„ç†æŠ•å½±ä¸ Unity ä¸­ä½¿ç”¨çš„æ ‡å‡† OpenGL é€è§†çŸ©é˜µä¸åŒã€‚ï¼‰ Secondly, Unreal applies a matrix transposition to all their perspective matrices.ï¼ˆå…¶æ¬¡ï¼ŒUnreal å¯¹æ‰€æœ‰çš„é€è§†çŸ©é˜µè¿›è¡Œäº†çŸ©é˜µç§»ä½ã€‚  ç¼ºçœæƒ…å†µä¸‹ï¼ŒUnreal æä¾›äº†å„ç§æ–¹ä¾¿çš„é€è§†çŸ©é˜µæ„é€ å‡½æ•°ã€‚ æœ‰ä¸¤ç§å˜ä½“ï¼Œä¸€ç§æ˜¯æ™®é€šé€è§†çŸ©é˜µï¼Œå¦ä¸€ç§æ˜¯é€†å‘é€è§†çŸ©é˜µã€‚  å³æ‰‹åæ ‡ç³»ï¼š https://zhuanlan.zhihu.com/p/114729671\né€è§†æŠ•å½±ï¼š\nå½’ä¸€åŒ–é½æ¬¡åæ ‡ä»¥åçš„ç»“æœæ˜¯ï¼š\n camera space 3Dç©ºé—´ä¸­ï¼Œç›¸åŒçš„xï¼Œzè¶Šå¤§ï¼ŒæŠ•å½±å˜æ¢ä»¥åçš„xåˆ†é‡è¶Šé è¿‘0ã€‚\u0026ldquo;è¿‘å¤§è¿œå°\u0026quot;çš„é€è§†æ•ˆæœï¼Œå°±æ˜¯è¿™ä¹ˆç®—å‡ºæ¥çš„ã€‚\n  Unityçš„æŠ•å½±çŸ©é˜µï¼Œæ˜¯æŠŠè§†é”¥å†…çš„æ‰€æœ‰3Dåæ ‡ï¼Œè½¬æ¢åˆ° [-1,1] èŒƒå›´ä¹‹å†…ã€‚æœ€åè½¬åŒ–ä¸ºScreen Spaceï¼ŒèŒƒå›´ä¸º[0,1]\n æ·±åº¦å€¼æ˜¯åˆ°è¿‘å¹³é¢çš„è·ç¦»ï¼š\næ­£äº¤æŠ•å½±ï¼š\n é€è§†æŠ•å½±å˜æ¢ï¼Œæœ‰\u0026quot;è¿‘å¤§è¿œå°\u0026quot;çš„é€è§†æ•ˆæœã€‚3Dç©ºé—´ä¸­çš„ä¸¤æ¡å¹³è¡Œçº¿ï¼Œåœ¨æŠ•å½±å˜æ¢ä»¥åä¼šç›¸äº¤äºæŸä¸ª\u0026quot;ç­ç‚¹\u0026rdquo;ã€‚\næ­£äº¤æŠ•å½±å˜æ¢ï¼Œæ²¡æœ‰\u0026quot;è¿‘å¤§è¿œå°\u0026quot;çš„é€è§†æ•ˆæœã€‚3Dç©ºé—´ä¸­çš„ä¸¤æ¡å¹³è¡Œçº¿ï¼Œåœ¨æŠ•å½±å˜æ¢ä»¥åï¼Œä»æ—§æ˜¯å¹³è¡Œçš„ã€‚\n Unreal æ­£äº¤çŸ©é˜µï¼š\n UE4é‡Œçš„é€è§†æŠ•å½±çŸ©é˜µçš„è®¡ç®—æ–¹å¼ï¼Œå‚è§å¼•æ“æºä»£ç çš„OrthoMatrix.hæ–‡ä»¶ã€‚\n ä»£ç 1ï¼š\n1  UGameplayStatics::DeprojectScreenToWorld(UGameplayStatics::GetPlayerController(GetWorld(), 0), forwardCursorPos, forwardWorldPos, forwardMoveDirection);   ä»£ç 2ï¼š\n1 2 3  FVector forwardMoveDirection; GetWorld()-\u0026gt;GetFirstPlayerController()-\u0026gt;GetMousePosition(forwardCursorPos.X, forwardCursorPos.Y); UGameplayStatics::DeprojectScreenToWorld(UGameplayStatics::GetPlayerController(GetWorld(), 0), forwardCursorPos, forwardWorldPos, forwardMoveDirection);    APlayerController ç©å®¶æ§åˆ¶å™¨è¢«äººç±»ç©å®¶ç”¨æ¥æ§åˆ¶æ£‹å­ã€‚åœ°å€ ULocalPlayer å½“å‰å®¢æˆ·ç«¯ä¸Šçš„æ¯ä¸ªç©å®¶éƒ½æœ‰ä¸€ä¸ªLocalPlayerã€‚åœ°å€ FViewportClient è§†çª—å®¢æˆ·ç«¯çš„æŠ½è±¡æ¥å£ã€‚åœ°å€ ViewportClient åœ¨ç©å®¶ä¸­åŒ…å«æ­¤ç©å®¶è§†å›¾çš„ä¸»è§†çª—.ã€‚ åœ°å€ ULocalPlayer::GetProjectionData ç”¨äºå¯¼å‡ºæŠ•å½±æ‰€éœ€çš„å„ç§æ•°æ®ä½çš„è¾…åŠ©å‡½æ•°ã€‚ åœ°å€  bianxngjing:\nhttps://v.qq.com/x/page/t0770a2b6f6.html\nAPI UGameplayStatics::DeprojectScreenToWorld  Unity ä¸ NGUI åæ ‡è½¬æ¢åŸç†   å°†ç»™å®šçš„2Då±å¹•ç©ºé—´åæ ‡è½¬æ¢ä¸º3Dä¸–ç•Œç©ºé—´ç‚¹å’Œæ–¹å‘ã€‚\nAPIåœ°å€ï¼š https://docs.unrealengine.com/en-US/API/Runtime/Engine/Kismet/UGameplayStatics/DeprojectScreenToWorld/index.html\nè¯­æ³•ï¼š\n1 2 3 4 5 6 7  static bool DeprojectScreenToWorld ( APlayerController const * Player,\t// ç©å®¶è§†è§’  const FVector2D \u0026amp; ScreenPosition,\t// 2Dç‚¹  FVector \u0026amp; WorldPosition,\t// ä¸–ç•Œç©ºé—´ä¸‰ç»´åæ ‡ è¾“å‡º  FVector \u0026amp; WorldDirection\t// åœ¨ç»™å®šçš„2dç‚¹ä¸Šè¿œç¦»ç›¸æœºçš„ä¸–ç•Œç©ºé—´æ–¹å‘çŸ¢é‡ã€‚\tè¾“å‡º )   æºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  bool UGameplayStatics::DeprojectScreenToWorld(APlayerController const* Player, const FVector2D\u0026amp; ScreenPosition, FVector\u0026amp; WorldPosition, FVector\u0026amp; WorldDirection) { // è·å–LocalPlayer \tULocalPlayer* const LP = Player ? Player-\u0026gt;GetLocalPlayer() : nullptr; if (LP \u0026amp;\u0026amp; LP-\u0026gt;ViewportClient) {//ViewpoetClient åŒ…å«æ­¤ç©å®¶è§†å›¾çš„ä¸»è§†çª—ã€‚ \t// get the projection data \tFSceneViewProjectionData ProjectionData; //ç«‹ä½“æ¸²æŸ“é€šè¿‡ã€‚FULLè¡¨ç¤ºæ­¤è¿‡ç¨‹ä¸­æœªå¯ç”¨ç«‹ä½“æ¸²æŸ“ï¼ŒeSSP_FULL \tif (LP-\u0026gt;GetProjectionData(LP-\u0026gt;ViewportClient-\u0026gt;Viewport, eSSP_FULL, /*out*/ ProjectionData)) {// è·å–æŠ•å½±æ•°æ® \tFMatrix const InvViewProjMatrix = ProjectionData.ComputeViewProjectionMatrix().InverseFast(); FSceneView::DeprojectScreenToWorld(ScreenPosition, ProjectionData.GetConstrainedViewRect(), InvViewProjMatrix, /*out*/ WorldPosition, /*out*/ WorldDirection); return true; } } // something went wrong, zero things and return falseï¼Œé”™è¯¯ä¸ç®¡ \tWorldPosition = FVector::ZeroVector; WorldDirection = FVector::ZeroVector; return false; }   é€†é€è§†å˜æ¢ æŠ•å½±çŸ©é˜µï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  // Projection data for a FSceneView struct FSceneViewProjectionData { FVector ViewOrigin;\t//æºè§†å›¾å‘é‡ \t/** Rotation matrix transforming from world space to view space. */ FMatrix ViewRotationMatrix;\t// ä»ä¸–ç•Œç©ºé—´åˆ°è§†å›¾ç©ºé—´çš„æ—‹è½¬çŸ©é˜µè½¬æ¢ã€‚ \t/** UE4 projection matrix projects such that clip space Z=1 is the near plane, and Z=0 is the infinite far plane. */ FMatrix ProjectionMatrix;\t// UE4æŠ•å½±çŸ©é˜µæŠ•å½±ä½¿å¾—å‰ªè¾‘ç©ºé—´Z=1æ˜¯è¿‘å¹³é¢ï¼ŒZ=0æ˜¯æ— é™è¿œå¹³é¢ã€‚ protected: //The unconstrained (no aspect ratio bars applied) view rectangle (also unscaled) \tFIntRect ViewRect;\t// æ— çº¦æŸ(æœªåº”ç”¨å®½é«˜æ¯”æ¡)è§†å›¾çŸ©å½¢(ä¹Ÿæœªç¼©æ”¾) \t// The constrained view rectangle (identical to UnconstrainedUnscaledViewRect if aspect ratio is not constrained) \tFIntRect ConstrainedViewRect;\t// å—çº¦æŸçš„è§†å›¾çŸ©å½¢(å¦‚æœé•¿å®½æ¯”ä¸å—çº¦æŸï¼Œåˆ™ä¸UnconstrainedUnscaledViewRectç›¸åŒ) public: void SetViewRectangle(const FIntRect\u0026amp; InViewRect) { ViewRect = InViewRect; ConstrainedViewRect = InViewRect; } void SetConstrainedViewRectangle(const FIntRect\u0026amp; InViewRect) { ConstrainedViewRect = InViewRect; } // ä¸Šé¢ä¸¤ä¸ªå‡½æ•°è®¾ç½®Rectçª—å£  bool IsValidViewRectangle() const {//åˆ¤æ–­çª—å£æ˜¯å¦æœ‰æ•ˆ \treturn (ConstrainedViewRect.Min.X \u0026gt;= 0) \u0026amp;\u0026amp; (ConstrainedViewRect.Min.Y \u0026gt;= 0) \u0026amp;\u0026amp; (ConstrainedViewRect.Width() \u0026gt; 0) \u0026amp;\u0026amp; (ConstrainedViewRect.Height() \u0026gt; 0); } bool IsPerspectiveProjection() const {// åˆ¤æ–­æ˜¯ä¸æ˜¯é€è§†æŠ•å½±çŸ©é˜µ \treturn ProjectionMatrix.M[3][3] \u0026lt; 1.0f; } const FIntRect\u0026amp; GetViewRect() const { return ViewRect; } const FIntRect\u0026amp; GetConstrainedViewRect() const { return ConstrainedViewRect; } FMatrix ComputeViewProjectionMatrix() const {// è®¡ç®—è§†å›¾æŠ•å½±çŸ©é˜µ \treturn FTranslationMatrix(-ViewOrigin) * ViewRotationMatrix * ProjectionMatrix; } };   ä¸Šé¢å¹³ç§»çŸ©é˜µï¼š\n1 2 3 4 5 6 7 8  FORCEINLINE FTranslationMatrix::FTranslationMatrix(const FVector\u0026amp; Delta)\t//åŸºäºç»™å®šå‘é‡çš„æ„é€ å‡½æ•°è½¬æ¢çŸ©é˜µï¼Œ//è½¬ç½®çŸ©é˜µ \t: FMatrix( FPlane(1.0f,\t0.0f,\t0.0f,\t0.0f), FPlane(0.0f,\t1.0f,\t0.0f,\t0.0f), FPlane(0.0f,\t0.0f,\t1.0f,\t0.0f), FPlane(Delta.X,\tDelta.Y,Delta.Z,1.0f) ) { }   éš¾ç‚¹ä¸€ï¼šGetProjectionDataå‡½æ•°\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141  bool ULocalPlayer::GetProjectionData(FViewport* Viewport, EStereoscopicPass StereoPass, FSceneViewProjectionData\u0026amp; ProjectionData) const { // If the actor  //Sizeä¸ºåˆ†é…ç»™æ­¤ç©å®¶çš„ä¸»è§†å£å­åŒºåŸŸçš„å¤§å°ã€‚0-1  // Viewport-\u0026gt;GetSizeXY()è·å–è§†ç«¯çš„Xä¸Y \tif ((Viewport == NULL) || (PlayerController == NULL) || (Viewport-\u0026gt;GetSizeXY().X == 0) || (Viewport-\u0026gt;GetSizeXY().Y == 0) || (Size.X == 0) || (Size.Y == 0)) { return false; } // å°†æµ®ç‚¹æ•°è½¬æ¢ä¸ºæˆªæ–­å€¼æ¥è¿‘é›¶çš„æ•´æ•°ã€‚å³å‘ä¸‹å–æ•´  // Originä¸ºåˆ†é…ç»™è¯¥ç©å®¶çš„ä¸»è§†å£å­åŒºåŸŸå·¦ä¸Šè§’çš„åæ ‡ã€‚0-1 \tint32 X = FMath::TruncToInt(Origin.X * Viewport-\u0026gt;GetSizeXY().X); int32 Y = FMath::TruncToInt(Origin.Y * Viewport-\u0026gt;GetSizeXY().Y); // åŠ ä¸Šè§†ç«¯åˆå§‹çš„åæ ‡å€¼ \tX += Viewport-\u0026gt;GetInitialPositionXY().X; Y += Viewport-\u0026gt;GetInitialPositionXY().Y; //æ–°çš„çª—å£å¤§å° \tuint32 SizeX = FMath::TruncToInt(Size.X * Viewport-\u0026gt;GetSizeXY().X); uint32 SizeY = FMath::TruncToInt(Size.Y * Viewport-\u0026gt;GetSizeXY().Y); //X=0,Y = 0 #if !(UE_BUILD_SHIPPING || UE_BUILD_TEST) // We expect some size to avoid problems with the view rect manipulation \t// æˆ‘ä»¬å¸Œæœ›æœ‰ä¸€å®šçš„å¤§å°æ¥é¿å…view rectæ“ä½œçš„é—®é¢˜ \tif(SizeX \u0026gt; 50 \u0026amp;\u0026amp; SizeY \u0026gt; 50) { int32 Value = CVarViewportTest.GetValueOnGameThread();\t//æ ¹æ®valueçš„å€¼åˆ†ç±»å„ç§è§†ç«¯  if(Value) { int InsetX = SizeX / 4; int InsetY = SizeY / 4; // this allows to test various typical view port situations (todo: split screen)  // è¿™å…è®¸æµ‹è¯•å„ç§å…¸å‹çš„è§†å›¾ç«¯å£æƒ…å†µ(todo:åˆ†å‰²å±å¹•) \tswitch(Value) { case 1: X += InsetX; Y += InsetY; SizeX -= InsetX * 2; SizeY -= InsetY * 2;break; case 2: Y += InsetY; SizeY -= InsetY * 2; break; case 3: X += InsetX; SizeX -= InsetX * 2; break; case 4: SizeX /= 2; SizeY /= 2; break; case 5: SizeX /= 2; SizeY /= 2; X += SizeX;\tbreak; case 6: SizeX /= 2; SizeY /= 2; Y += SizeY; break; case 7: SizeX /= 2; SizeY /= 2; X += SizeX; Y += SizeY; break; } } } #endif\t// FIntRectä¸ºäºŒç»´ç©ºé—´ä¸­æ•´æ•°çŸ©å½¢çš„ç»“æ„ã€‚æ–°çš„è§†ç«¯çŸ©é˜µ \tFIntRect UnconstrainedRectangle = FIntRect(X, Y, X+SizeX, Y+SizeY);//InMin(X,Y),InMax(X+SizeX,Y+SizeY) \t// è®¾ç½®æŠ•å½±æ•°æ®çš„çª—å£ \tProjectionData.SetViewRectangle(UnconstrainedRectangle); // Get the viewpoint.  // è·å¾—è§†ç‚¹ \tFMinimalViewInfo ViewInfo; //ç»“æ„  /** enum EStereoscopicPass { eSSP_FULL, eSSP_LEFT_EYE, eSSP_RIGHT_EYE, eSSP_LEFT_EYE_SIDE, eSSP_RIGHT_EYE_SIDE, } **/ GetViewPoint(/*out*/ ViewInfo, StereoPass);\t//æ£€ç´¢è¯¥ç©å®¶çš„è§†ç‚¹ã€‚  // If stereo rendering is enabled, update the size and offset appropriately for this pass  // å¦‚æœå¯ç”¨äº†ç«‹ä½“æ¸²æŸ“ï¼Œè¯·ä¸ºæ­¤è¿‡ç¨‹é€‚å½“æ›´æ–°å¤§å°å’Œåç§» \tconst bool bNeedStereo = IStereoRendering::IsStereoEyePass(StereoPass) \u0026amp;\u0026amp; GEngine-\u0026gt;IsStereoscopic3D(); const bool bIsHeadTrackingAllowed = GEngine-\u0026gt;XRSystem.IsValid() \u0026amp;\u0026amp; GEngine-\u0026gt;XRSystem-\u0026gt;IsHeadTrackingAllowed(); if (bNeedStereo) { GEngine-\u0026gt;StereoRenderingDevice-\u0026gt;AdjustViewRect(StereoPass, X, Y, SizeX, SizeY); } // scale distances for cull distance purposes by the ratio of our current FOV to the default FOV  // æ ¹æ®æˆ‘ä»¬å½“å‰çš„FOVä¸é»˜è®¤FOVçš„æ¯”ç‡ï¼Œä¸ºé€‰æ‹©è·ç¦»çš„ç›®çš„ç¼©æ”¾è·ç¦» \tPlayerController-\u0026gt;LocalPlayerCachedLODDistanceFactor = ViewInfo.FOV / FMath::Max\u0026lt;float\u0026gt;(0.01f, (PlayerController-\u0026gt;PlayerCameraManager != NULL) ? PlayerController-\u0026gt;PlayerCameraManager-\u0026gt;DefaultFOV : 90.f); FVector StereoViewLocation = ViewInfo.Location; // åŠ å…¥ç«‹ä½“æ¸²æŸ“æˆ–è€…  if (bNeedStereo || bIsHeadTrackingAllowed) {// å‡å¦‚å¯ç”¨äº†ç«‹ä½“æ¸²æŸ“å’Œå¤´éƒ¨è¿½è¸ª \tauto XRCamera = GEngine-\u0026gt;XRSystem.IsValid() ? GEngine-\u0026gt;XRSystem-\u0026gt;GetXRCamera() : nullptr;\t//è™šæ‹Ÿç°å®ç›¸æœº \tif (XRCamera.IsValid()) { AActor* ViewTarget = PlayerController-\u0026gt;GetViewTarget(); const bool bHasActiveCamera = ViewTarget \u0026amp;\u0026amp; ViewTarget-\u0026gt;HasActiveCameraComponent(); XRCamera-\u0026gt;UseImplicitHMDPosition(bHasActiveCamera); } if (GEngine-\u0026gt;StereoRenderingDevice.IsValid()) { GEngine-\u0026gt;StereoRenderingDevice-\u0026gt;CalculateStereoViewOffset(StereoPass, ViewInfo.Rotation, GetWorld()-\u0026gt;GetWorldSettings()-\u0026gt;WorldToMeters, StereoViewLocation); } } // Create the view matrix  // åˆ›å»ºè§†å›¾çŸ©é˜µ  // FPlane ä¸‰ç»´å¹³é¢çš„ç»“æ„ã€‚(X,Y,Z,W)  // FMatrix æµ®ç‚¹å€¼çš„4x4çŸ©é˜µã€‚ \tProjectionData.ViewOrigin = StereoViewLocation; ProjectionData.ViewRotationMatrix = FInverseRotationMatrix(ViewInfo.Rotation) * FMatrix( FPlane(0,\t0,\t1,\t0), FPlane(1,\t0,\t0,\t0), FPlane(0,\t1,\t0,\t0), FPlane(0,\t0,\t0,\t1)); // @todo viewext this use case needs to be revisited  // é‡æ–°è€ƒè™‘viewext \tif (!bNeedStereo)\t//å‡å¦‚æ²¡æœ‰ç«‹ä½“æ¸²æŸ“ \t{ // Create the projection matrix (and possibly constrain the view rectangle)  // åˆ›å»ºæŠ•å½±çŸ©é˜µ(å¹¶å¯èƒ½çº¦æŸè§†å›¾çŸ©å½¢)  // ViewInfoè§†ç‚¹ \tFMinimalViewInfo::CalculateProjectionMatrixGivenView(ViewInfo, AspectRatioAxisConstraint, Viewport, /*inout*/ ProjectionData);//è®¡ç®—ç»™å®šè§†å›¾æŠ•å½±çŸ©é˜µ \t// è§†å›¾æ‰©å±•å¯¹è±¡å¯ä»¥åœ¨æ²¡æœ‰è¿åŠ¨æ§åˆ¶å™¨ç»„ä»¶çš„æƒ…å†µä¸‹ä¿ç•™åœ¨æ¸²æŸ“çº¿ç¨‹ä¸Šï¼Œå¤§æ¦‚æ˜¯è®¾ç½®ç›¸å…³è¯•å›¾æ‹“å±•çš„æŠ•å½±çŸ©é˜µ \tfor (auto\u0026amp; ViewExt : GEngine-\u0026gt;ViewExtensions-\u0026gt;GatherActiveExtensions()) { ViewExt-\u0026gt;SetupViewProjectionMatrix(ProjectionData); }; } else {\t// æœ‰ä¸‰ç»´æ¸²æŸ“ \t// Let the stereoscopic rendering device handle creating its own projection matrix, as needed  // è®©ç«‹ä½“æ¸²æŸ“è®¾å¤‡æ ¹æ®éœ€è¦å¤„ç†åˆ›å»ºè‡ªå·±çš„æŠ•å½±çŸ©é˜µï¼Œè°ƒç”¨ä¸€ç³»åˆ—å‡½æ•°GetProjectMatrix \tProjectionData.ProjectionMatrix = GEngine-\u0026gt;StereoRenderingDevice-\u0026gt;GetStereoProjectionMatrix(StereoPass); // calculate the out rect \tProjectionData.SetViewRectangle(FIntRect(X, Y, X + SizeX, Y + SizeY)); } return true; }   éš¾ç‚¹ï¼šè®¡ç®—ç»™å®šè§†å›¾æŠ•å½±çŸ©é˜µ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78  void FMinimalViewInfo::CalculateProjectionMatrixGivenView(const FMinimalViewInfo\u0026amp; ViewInfo, TEnumAsByte\u0026lt;enum EAspectRatioAxisConstraint\u0026gt; AspectRatioAxisConstraint, FViewport* Viewport, FSceneViewProjectionData\u0026amp; InOutProjectionData) { // Create the projection matrix (and possibly constrain the view rectangle)  // åˆ›å»ºæŠ•å½±çŸ©é˜µ(å¹¶å¯èƒ½çº¦æŸè§†å›¾çŸ©å½¢) \tif (ViewInfo.bConstrainAspectRatio) { // Enforce a particular aspect ratio for the render of the scene. \t// Results in black bars at top/bottom etc. \tInOutProjectionData.SetConstrainedViewRectangle(Viewport-\u0026gt;CalculateViewExtents(ViewInfo.AspectRatio, InOutProjectionData.GetViewRect())); InOutProjectionData.ProjectionMatrix = ViewInfo.CalculateProjectionMatrix(); } else { // Avoid divide by zero in the projection matrix calculation by clamping FOV \tfloat MatrixFOV = FMath::Max(0.001f, ViewInfo.FOV) * (float)PI / 360.0f; float XAxisMultiplier; float YAxisMultiplier; const FIntRect\u0026amp; ViewRect = InOutProjectionData.GetViewRect(); const int32 SizeX = ViewRect.Width(); const int32 SizeY = ViewRect.Height(); // if x is bigger, and we\u0026#39;re respecting x or major axis, AND mobile isn\u0026#39;t forcing us to be Y axis aligned \tif (((SizeX \u0026gt; SizeY) \u0026amp;\u0026amp; (AspectRatioAxisConstraint == AspectRatio_MajorAxisFOV)) || (AspectRatioAxisConstraint == AspectRatio_MaintainXFOV) || (ViewInfo.ProjectionMode == ECameraProjectionMode::Orthographic)) { //if the viewport is wider than it is tall \tXAxisMultiplier = 1.0f; YAxisMultiplier = SizeX / (float)SizeY; } else { //if the viewport is taller than it is wide \tXAxisMultiplier = SizeY / (float)SizeX; YAxisMultiplier = 1.0f; } if (ViewInfo.ProjectionMode == ECameraProjectionMode::Orthographic) {\t//åˆ¤æ–­æŠ•å½±æ¨¡å¼ \tconst float OrthoWidth = ViewInfo.OrthoWidth / 2.0f * XAxisMultiplier; const float OrthoHeight = (ViewInfo.OrthoWidth / 2.0f) / YAxisMultiplier; const float NearPlane = ViewInfo.OrthoNearClipPlane; const float FarPlane = ViewInfo.OrthoFarClipPlane; const float ZScale = 1.0f / (FarPlane - NearPlane); const float ZOffset = -NearPlane; InOutProjectionData.ProjectionMatrix = FReversedZOrthoMatrix( // è®¡ç®—åå‘Zæ­£äº¤çŸ©é˜µ \tOrthoWidth, OrthoHeight, ZScale, ZOffset );\t} else { InOutProjectionData.ProjectionMatrix = FReversedZPerspectiveMatrix(\t// åè½¬Zé€è§†çŸ©é˜µ \tMatrixFOV, MatrixFOV, XAxisMultiplier, YAxisMultiplier, GNearClippingPlane, GNearClippingPlane ); } } if (!ViewInfo.OffCenterProjectionOffset.IsZero()) { const float Left = -1.0f + ViewInfo.OffCenterProjectionOffset.X; const float Right = Left + 2.0f; const float Bottom = -1.0f + ViewInfo.OffCenterProjectionOffset.Y; const float Top = Bottom + 2.0f; InOutProjectionData.ProjectionMatrix.M[2][0] = (Left + Right) / (Left - Right); InOutProjectionData.ProjectionMatrix.M[2][1] = (Bottom + Top) / (Bottom - Top); } }   åå‘Zæ­£äº¤ï¼š\n1 2 3 4 5 6 7 8  FORCEINLINE FReversedZOrthoMatrix::FReversedZOrthoMatrix(float Width,float Height,float ZScale,float ZOffset) : FMatrix( FPlane((Width != 0.0f) ? (1.0f / Width) : 1.0f, 0.0f, 0.0f, 0.0f), FPlane(0.0f, (Height != 0.0f) ? (1.0f / Height) : 1.f, 0.0f, 0.0f), FPlane(0.0f, 0.0f, -ZScale, 0.0f), FPlane(0.0f, 0.0f, 1.0f - ZOffset * ZScale, 1.0f) ) { }   éš¾ç‚¹2ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53  void FSceneView::DeprojectScreenToWorld(const FVector2D\u0026amp; ScreenPos, const FIntRect\u0026amp; ViewRect, const FMatrix\u0026amp; InvViewProjMatrix, FVector\u0026amp; out_WorldOrigin, FVector\u0026amp; out_WorldDirection) { float PixelX = FMath::TruncToFloat(ScreenPos.X); float PixelY = FMath::TruncToFloat(ScreenPos.Y); // Get the eye position and direction of the mouse cursor in two stages (inverse transform projection, then inverse transform view).  // //åˆ†ä¸¤ä¸ªé˜¶æ®µè·å–é¼ æ ‡å…‰æ ‡çš„çœ¼ç›ä½ç½®å’Œæ–¹å‘(é€†å˜æ¢æŠ•å½±ï¼Œç„¶åé€†å˜æ¢è§†å›¾)ã€‚  // This avoids the numerical instability that occurs when a view matrix with large translation is composed with a projection matrix \t// //è¿™é¿å…äº†å½“å…·æœ‰å¤§å¹³ç§»çš„è§†å›¾çŸ©é˜µç”±æŠ•å½±çŸ©é˜µç»„æˆæ—¶å‡ºç°çš„æ•°å€¼ä¸ç¨³å®šæ€§  // Get the pixel coordinates into 0..1 normalized coordinates within the constrained view rectangle  // å°†åƒç´ åæ ‡è½¬æ¢ä¸º0..1çº¦æŸè§†å›¾çŸ©å½¢å†…çš„æ ‡å‡†åŒ–åæ ‡ \tconst float NormalizedX = (PixelX - ViewRect.Min.X) / ((float)ViewRect.Width()); const float NormalizedY = (PixelY - ViewRect.Min.Y) / ((float)ViewRect.Height()); // Get the pixel coordinates into -1..1 projection space  // å°†åƒç´ åæ ‡è½¬æ¢ä¸º-1..1æŠ•å½±ç©ºé—´ \tconst float ScreenSpaceX = (NormalizedX - 0.5f) * 2.0f; const float ScreenSpaceY = ((1.0f - NormalizedY) - 0.5f) * 2.0f; // The start of the ray trace is defined to be at mousex,mousey,1 in projection space (z=1 is near, z=0 is far - this gives us better precision)  // //å…‰çº¿è·Ÿè¸ªçš„å¼€å§‹è¢«å®šä¹‰ä¸ºåœ¨æŠ•å½±ç©ºé—´ä¸­mousexï¼Œmouseyï¼Œ1å¤„(z = 1æ˜¯è¿‘çš„ï¼Œz=0æ˜¯è¿œçš„-è¿™ç»™äº†æˆ‘ä»¬æ›´å¥½çš„ç²¾åº¦) \t// To get the direction of the ray trace we need to use any z between the near and the far plane, so let\u0026#39;s use (mousex, mousey, 0.5)  // //ä¸ºäº†å¾—åˆ°å…‰çº¿è½¨è¿¹çš„æ–¹å‘ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨è¿‘å¹³é¢å’Œè¿œå¹³é¢ä¹‹é—´çš„ä»»ä½•zï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä½¿ç”¨(mousexï¼Œmouseyï¼Œ0.5) \tconst FVector4 RayStartProjectionSpace = FVector4(ScreenSpaceX, ScreenSpaceY, 1.0f, 1.0f); const FVector4 RayEndProjectionSpace = FVector4(ScreenSpaceX, ScreenSpaceY, 0.5f, 1.0f); // Projection (changing the W coordinate) is not handled by the FMatrix transforms that work with vectors, so multiplications  // //æŠ•å½±(æ”¹å˜wåæ ‡)ä¸æ˜¯ç”±å¤„ç†å‘é‡çš„çŸ©é˜µå˜æ¢æ¥å¤„ç†çš„ï¼Œæ‰€ä»¥ä¹˜æ³•  // by the projection matrix should use homogeneous coordinates (i.e. FPlane).  // ç”±æŠ•å½±çŸ©é˜µåº”ä½¿ç”¨é½æ¬¡åæ ‡(å³å¹³é¢)ã€‚ \tconst FVector4 HGRayStartWorldSpace = InvViewProjMatrix.TransformFVector4(RayStartProjectionSpace); const FVector4 HGRayEndWorldSpace = InvViewProjMatrix.TransformFVector4(RayEndProjectionSpace); FVector RayStartWorldSpace(HGRayStartWorldSpace.X, HGRayStartWorldSpace.Y, HGRayStartWorldSpace.Z); FVector RayEndWorldSpace(HGRayEndWorldSpace.X, HGRayEndWorldSpace.Y, HGRayEndWorldSpace.Z); // divide vectors by W to undo any projection and get the 3-space coordinate  // //å°†å‘é‡é™¤ä»¥wä»¥æ’¤é”€ä»»ä½•æŠ•å½±å¹¶è·å¾—3-ç©ºé—´åæ ‡ \tif (HGRayStartWorldSpace.W != 0.0f) { RayStartWorldSpace /= HGRayStartWorldSpace.W; } if (HGRayEndWorldSpace.W != 0.0f) { RayEndWorldSpace /= HGRayEndWorldSpace.W; } const FVector RayDirWorldSpace = (RayEndWorldSpace - RayStartWorldSpace).GetSafeNormal(); // Finally, store the results in the outputs \tout_WorldOrigin = RayStartWorldSpace; out_WorldDirection = RayDirWorldSpace; }   FPlane:\nFMatrix:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  FORCEINLINE FMatrix::FMatrix(const FPlane\u0026amp; InX,const FPlane\u0026amp; InY,const FPlane\u0026amp; InZ,const FPlane\u0026amp; InW) { M[0][0] = InX.X; M[0][1] = InX.Y; M[0][2] = InX.Z; M[0][3] = InX.W; M[1][0] = InY.X; M[1][1] = InY.Y; M[1][2] = InY.Z; M[1][3] = InY.W; M[2][0] = InZ.X; M[2][1] = InZ.Y; M[2][2] = InZ.Z; M[2][3] = InZ.W; M[3][0] = InW.X; M[3][1] = InW.Y; M[3][2] = InW.Z; M[3][3] = InW.W; } FORCEINLINE FMatrix::FMatrix(const FVector\u0026amp; InX,const FVector\u0026amp; InY,const FVector\u0026amp; InZ,const FVector\u0026amp; InW) { M[0][0] = InX.X; M[0][1] = InX.Y; M[0][2] = InX.Z; M[0][3] = 0.0f; M[1][0] = InY.X; M[1][1] = InY.Y; M[1][2] = InY.Z; M[1][3] = 0.0f; M[2][0] = InZ.X; M[2][1] = InZ.Y; M[2][2] = InZ.Z; M[2][3] = 0.0f; M[3][0] = InW.X; M[3][1] = InW.Y; M[3][2] = InW.Z; M[3][3] = 1.0f; }   step1:\nAPI UGameplayStatics::ProjectWorldToScreen å°†ç»™å®šçš„3Dä¸–ç•Œç©ºé—´ç‚¹è½¬æ¢ä¸ºå…¶2Då±å¹•ç©ºé—´åæ ‡ã€‚\nAPIåœ°å€ï¼š https://docs.unrealengine.com/en-US/API/Runtime/Engine/Kismet/UGameplayStatics/ProjectWorldToScreen/index.html\nè¯­æ³•ï¼š\n1 2 3 4 5 6 7  static bool ProjectWorldToScreen ( APlayerController const * Player, const FVector \u0026amp; WorldPosition, FVector2D \u0026amp; ScreenPosition, bool bPlayerViewportRelative\t//è¿™æ˜¯å¦åº”è¯¥ä¸ç©å®¶è§†çª—å­åŒºåŸŸç›¸å…³(åœ¨åˆ†å‰²å±å¹•ä¸­ä½¿ç”¨ç©å®¶é™„åŠ çš„å°éƒ¨ä»¶æ—¶å¾ˆæœ‰ç”¨) )   Z-Buffer ç”¨Renderdocå¯¹UE4(PCï¼ŒDX11ï¼‰æˆªå¸§ï¼ŒUE4çš„ç‰ˆæœ¬ä¸º4.18. å¯ä»¥çœ‹åˆ°UE4ä¸€å¸§ç”»é¢çš„æ¸²æŸ“è¿‡ç¨‹å¦‚ä¸‹\nè·å–GBufferçš„ä¸€ç§æ–¹å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER( DZRenderSutioBP_InterceptSceneBaseColor, UTexture2D*, vTextureAsset, TextureAsset, { /*if (!IsInRenderingThread()) return;*/ FRHICommandListImmediate\u0026amp; RHICmdList = GRHICommandList.GetImmediateCommandList(); //è®¡æ•°åŠ ä¸€é¿å…Renderå®Œæˆåç›´æ¥æ¸…ç©ºäº†GBuffer,ä½†ä¼šæ…¢ä¸€å¸§ï¼Œä½ çŒœ FSceneRenderTargets::Get(RHICmdList).AdjustGBufferRefCount(RHICmdList, 1); static const FString ScrollingMessage(TEXT(\u0026#34;Hello World: \u0026#34;)); GEngine-\u0026gt;AddOnScreenDebugMessage(-1, 0.2f, FColor::Red, ScrollingMessage); FSceneRenderTargets\u0026amp; SceneContext = FSceneRenderTargets::Get(RHICmdList); if (SceneContext.GBufferA) { FTexture2DRHIRef vTextTarget = SceneContext.GetGBufferATexture(); FString vSiceStr = FString::Printf(TEXT(\u0026#34;FSceneRenderTargets GBufferA Size = %d*%d\u0026#34;), vTextTarget-\u0026gt;GetSizeX(), vTextTarget-\u0026gt;GetSizeY()); GEngine-\u0026gt;AddOnScreenDebugMessage(-1, 0.2f, FColor::Red, vSiceStr); } //ç§»é™¤ FSceneRenderTargets::Get(RHICmdList).AdjustGBufferRefCount(RHICmdList, -1); } );   How to export FTexture2DRHIRef to png?\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  classÂ SceneDepthCapture { public: TArray\u0026lt;FLinearColor\u0026gt;Â sceneDepthData; FIntPointÂ bufferSize; voidÂ SceneDepthCaptureSync() { ENQUEUE_RENDER_COMMAND(ReadSurfaceFloatCommand)( [this](FRHICommandListImmediate\u0026amp;Â RHICmdList) { FSceneRenderTargets\u0026amp;Â contextÂ =Â FSceneRenderTargets::Get(RHICmdList); bufferSizeÂ =Â context.GetBufferSizeXY(); FIntRectÂ Rect(0,Â 0,Â bufferSize.X,Â bufferSize.Y); RHICmdList.ReadSurfaceData( context.GetSceneDepthTexture(), Rect, sceneDepthData, FReadSurfaceDataFlags()); }); FlushRenderingCommands(); } };   ä½¿ç”¨æ¨¡å—çš„æ–¹å¼ ä½¿ç”¨æ¨¡å—\næ·»åŠ è‡ªå®šä¹‰Passçš„æ–¹æ³•  æ·»åŠ Shader  äº†è§£äº†ä¸€ä¸ªPassè¦å®Œæˆçš„å·¥ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥åŠ¨æ‰‹å®ç°ä¸€ä¸ªè‡ªå·±çš„ Pass äº†ã€‚é¦–å…ˆè¦ç¡®å®šçš„é—®é¢˜æ˜¯ Shaderã€‚æ—¢ç„¶è¦æŠŠåŒä¸€ä¸ªæ¨¡å‹ç”»ä¸¤æ¬¡ï¼Œé‚£å¿…ç„¶è¦ç”¨åˆ°ä¸åŒçš„Shaderã€‚å…³äºå¦‚ä½•åœ¨UE4ä¸­æ·»åŠ  Shaderï¼Œå¯ä»¥å‚è€ƒ DepthPass çš„ VS/PS(åœ¨DepthRendering.hä¸­) å’Œ UE4 çš„å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.unrealengine.com/en-US/Programming/Rendering/ShaderDevelopment/index.htmlã€‚MobileBasePassçš„Shaderå› ä¸ºæ¶‰åŠç¯å¢ƒå…‰ï¼Œç‚¹å…‰æºæ•°ç­‰å¯å¼€å…³çš„Definationï¼Œæ‰€ä»¥å¯¹åº”çš„ C++ ç±»æ˜¯ä»¥ template çš„å½¢å¼å®ç°çš„ã€‚ä¸€èˆ¬æ¥è¯´è‡ªå®šä¹‰ Pass çš„ Shader ä¼šç»§æ‰¿ FMaterialShader å¹¶ç”¨ IMPLEMENT_MATERIAL_SHADER_TYPE å®æ¥ç»‘å®šå¯¹åº”çš„ usf æ–‡ä»¶ã€‚ å¯ä»¥å®Œå…¨è‡ªå·±å†™æ–°çš„ usf æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åœ¨ FMaterialShader::ModifyCompilationEnvironment() ä¸­åº”ç”¨ä¸åŒçš„ SetDefine() æ¥å®ç°ä¸åŒçš„ Shaderã€‚éœ€è¦æ³¨æ„çš„æ˜¯ UE4 çš„ Shader ç¼–è¯‘æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ¼«é•¿çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥æœ€å¥½åœ¨ FMaterialShader::ShouldCompilePremutation() ä¸­å¯¹æè´¨è¿›è¡Œç­›é€‰ï¼Œåªç¼–è¯‘å¿…è¦çš„Shaderã€‚å¦åˆ™æ‰€æœ‰çš„ Material éƒ½ä¼šç¼–è¯‘å¯¹åº”çš„ Shaderï¼Œæ•ˆç‡å¾ˆä½ã€‚è¿˜æœ‰æ³¨æ„ Shader è¦åœ¨æ„é€ å‡½æ•°ä¸­ç»‘å®šéœ€è¦çš„ Uniform Bufferï¼Œåœ¨ GetShaderBinding ä¸­ç»‘å®šå¯¹åº”çš„UniformBufferï¼Œå¦åˆ™ä¼šå‡ºç° ResourceMissã€‚\n2. æ·»åŠ  MeshProcessor\næ ¹æ®å¯¹UE4çš„æ¸²æŸ“æµç¨‹åˆ†ææˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒPass ç”Ÿæˆ DrawCall çš„ä¸»è¦é€»è¾‘æ˜¯åœ¨ MeshProcessor ä¸­å®Œæˆçš„ã€‚MeshProcessor æ˜¯ 4.22 ä¸­æ–°åŠ å…¥çš„ç±»åï¼Œä¹‹å‰å¯¹åº”çš„æ˜¯ DrawingPolicyã€‚æ·»åŠ  MeshProcessor å¾ˆç®€å•ï¼Œåªéœ€è¦ç»§æ‰¿ FMeshPassProcessor å¹¶å¤å†™å…¶ AddMeshBatch() æ–¹æ³•å³å¯ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¼šåœ¨ AddMeshBatch æ–¹æ³•ä¸­è·å– Material Resource çš„ä¿¡æ¯å¹¶å¯¹ MeshBatch åšè¿›ä¸€æ­¥ç­›é€‰ï¼Œæœ€åè°ƒç”¨ Process æ–¹æ³•ç»‘å®š Shaderï¼ŒMesh å’Œ Materialï¼Œè®¡ç®— Mesh çš„ CullModeï¼ŒZTestï¼ŒZwriteï¼ŒBlendOP å’Œ SortKeyç­‰ç­‰å¹¶ç”¨ BuildMeshCommands ç”Ÿæˆ DrawCallã€‚\n3. æ·»åŠ  Pass\næ‰€æœ‰çš„ Pass éƒ½å¯ä»¥åœ¨ Enum EMeshPassä¸­æ‰¾åˆ°ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥å°±æ˜¯åœ¨ MeshProcessor.h çš„ EMeshPass ä¸­æ·»åŠ å¯¹åº”çš„ Enumã€‚ç„¶åæˆ‘ä»¬è¦ä¸º Pass åˆ›å»ºå¯¹åº”çš„ MeshProcessorï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯¹åº” .cpp æ–‡ä»¶ä¸­å®ç°å¯¹åº” MeshProcessor çš„ Creator æ–¹æ³•ï¼Œå¹¶å®šä¹‰å¯¹åº”çš„ FRegisterPassProcessorCreatFunction åœ¨å…¶æ„é€ å‡½æ•°ä¸­ä¼ å…¥å¯¹åº”çš„ Creator æ–¹æ³•æŒ‡é’ˆå’Œ Pass Enumã€‚è¿™ä¸€éƒ¨åˆ†å¯ä»¥å‚è€ƒ MobileBasePass.cpp æœ€åçš„ CreateMobileBasePassProcessor å’Œ RegisterMobileBasePass éƒ¨åˆ†ã€‚ä¹‹åæˆ‘ä»¬å°±è¦åœ¨ MobileSceneRenderer çš„ Render æ–¹æ³•ä¸­æ’å…¥è‡ªå®šä¹‰ Pass çš„æ¸²æŸ“æµç¨‹ï¼Œè¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯ä¸€äº› Profile æ ‡ç­¾å’Œ RHICmdList çš„Setup å’Œ Flushï¼Œè¿˜æœ‰ç”Ÿæˆ Pass çš„å¤šçº¿ç¨‹ DrawTaskã€‚è¿™ä¸€éƒ¨åˆ†é€»è¾‘å¯ä»¥å‚è€ƒ MobileBasePassRendering.cpp ä¸­çš„ RenderMobileBasePass æ–¹æ³•ã€‚\n","description":"è™šå¹»å¼•æ“ç›¸å…³é—®é¢˜","id":81,"section":"talks","tags":[""],"title":"UE4 Problems","uri":"https://hugo.jiahongw.com/zh/talks/ue4-talks/"},{"content":"å¤§æ¦‚ä»‹ç»ä»¥ä¸‹UE4çš„ä¸»è¦æ¸²æŸ“è¿‡ç¨‹ã€‚\nUE4æ¸²æŸ“è¿‡ç¨‹ å»¶è¿Ÿæ¸²æŸ“ æ‰€è°“å»¶è¿Ÿæ¸²æŸ“ï¼Œæ˜¯æŒ‡å°†ä¸€ä¸ªåœºæ™¯çš„å‡ ä½•ä½“ï¼ˆ3Dæ¨¡å‹ã€å¤šè¾¹å½¢ï¼‰çš„å…‰ç…§ã€é˜´å½±ã€è´¨æ„Ÿæç½®åˆ°ä¸€æ—ï¼Œå…ˆç€æ‰‹äºç»˜ç”»ï¼Œç„¶ååœ¨ååŠæ®µå†å¯¹å…‰ç…§ã€é˜´å½±ã€è´¨æ„Ÿè¿›è¡Œå¤„ç†çš„å¤„ç†æ–¹å¼ã€‚å³ç»™äººä¸€ç§æŠŠåŸæœ¬çš„å¤šè¾¹å½¢å…ˆç»˜åˆ¶å‡ºæ¥çš„å°è±¡ï¼Œå®é™…ä¸Šä¸ä»…è¦ç»˜åˆ¶å¤šè¾¹å½¢ï¼Œå‰è€…çš„å‚æ•°è¿˜éœ€è¦é…åˆåé¢å…‰ç…§å’Œé˜´å½±çš„å¤„ç†ã€‚å…¶è¾“å‡ºç›®æ ‡ï¼Œåœ¨æˆä¸ºå¤æ•°ç¼“å†²æ—¶å…·æœ‰æ™®éæ€§ï¼Œä½†æ˜¯è¿™é‡Œçš„ç¼“å†²æˆ‘ä»¬ç§°ä¹‹ä¸º\u0026quot;ç‰©ç†ç¼“å†²\u0026rdquo;ã€‚ç‰©ä½“ç¼“å†²æ˜¯æŒ‡ä½¿ç”¨åç…§æ˜å’Œåå¤„ç†ç‰¹æ•ˆçš„ä¸­é—´è¿‡æ¸¡ç¯èŠ‚\nç›¸å…³æœ¯è¯­ RHI\næ¸²æŸ“ç¡¬ä»¶æ¥å£ï¼Œæ˜¯ä¸ºä¸åŒå¹³å°æŠ½è±¡å‡ºä¸åŒå›¾å½¢APIçš„ä¸€å±‚ã€‚æ‰€æœ‰æ¸²æŸ“å‘½ä»¤å‡é€šè¿‡RHIå±‚ä¼ é€’ï¼Œä»¥è½¬æ¢ä¸ºé€‚ç”¨çš„æ¸²æŸ“å™¨ã€‚\nå»¶è¿Ÿæ¸²æŸ“\nè™šå¹»å¼•æ“4ä¸­çš„é»˜è®¤æ¸²æŸ“å™¨ã€‚å®ƒå› å°†ç…§æ˜/é˜´å½±è®¡ç®—æ¨è¿Ÿåˆ°å…¨å±è¿‡ç¨‹è€Œä¸æ˜¯ç»˜åˆ¶æ¯ä¸ªç½‘æ ¼æ—¶è€Œå¾—åã€‚\né¡¶ç‚¹å·¥å‚\né¡¶ç‚¹å·¥å‚æ˜¯å°è£…é¡¶ç‚¹æ•°æ®æºå¹¶é“¾æ¥åˆ°é¡¶ç‚¹ç€è‰²å™¨ä¸Šçš„è¾“å…¥çš„ç±»ã€‚é™æ€ç½‘æ ¼ç‰©ä½“ï¼Œéª¨æ¶ç½‘æ ¼ç‰©ä½“å’Œè¿‡ç¨‹ç½‘æ ¼ç»„ä»¶å‡ä½¿ç”¨ä¸åŒçš„é¡¶ç‚¹å·¥å‚ã€‚\nç€è‰²å™¨\nåœ¨è™šå¹»å¼•æ“ä¸­ï¼Œç€è‰²å™¨æ˜¯HLSLä»£ç ï¼ˆä»¥.ush / .usfæ–‡ä»¶çš„å½¢å¼ï¼‰å’Œæè´¨å›¾çš„å†…å®¹çš„ç»„åˆã€‚åœ¨Unrealä¸­åˆ›å»ºæè´¨æ—¶ï¼Œå®ƒä¼šæ ¹æ®è®¾ç½®ï¼ˆå¦‚ç€è‰²æ¨¡å¼ï¼‰å’Œç”¨æ³•æ¥ç¼–è¯‘å¤šä¸ªç€è‰²å™¨æ’åˆ—ã€‚\næ¸²æŸ“æ•°æ® ç›¸å…³çš„æ¸²æŸ“çš„æ•°æ®åŒ…æ‹¬æ·±åº¦å€¼åŠä¸€äº›Gbufferï¼Œå¦‚ä¸‹å›¾ï¼š\nå‡ ä¸ªPass Z Pre Pass UE4çš„æ¸²æŸ“ç®¡é“ï¼Œæ˜¯åœ¨Bass Passçš„ç‰©ä½“ç¼“å†²å†™å‡ºæ¥ä¹‹å‰ï¼Œåœ¨ä»…é¢„å¤„ç†æ·±åº¦å€¼ï¼ˆZå€¼ï¼‰ä¹‹åï¼Œè¿è¡ŒZé¢„é˜¶æ®µã€‚\näº‹å…ˆé¢„å¤„ç†æ·±åº¦å€¼çš„ç›®çš„ï¼Œæ˜¯å°†æœ€ç»ˆå½±åƒå’ŒåŒä¸€æ·±åº¦ç¼“å†²çš„å†…å®¹ç»“æœï¼Œåœ¨é€è§†å‰è·å¾—ã€‚Zé¢„é˜¶æ®µä¹‹åçš„Base Passåˆ™æ˜¯ï¼Œå‚è€ƒé¢„å…ˆå¾—å‡ºçš„æ·±åº¦å€¼ç¼“å†²è¿›è¡ŒZé¢„æµ‹è¯•ï¼Œå› æ­¤é€šè¿‡åœ¨æœ€ç»ˆçš„ç”»é¢é‡Œä¸ç•™ä¸‹åƒç´ ç—•è¿¹ï¼ˆå³ç¼–å†™ååˆè¢«æ¶ˆå»çš„åƒç´ ï¼‰ï¼Œä»¥å›é¿åƒç´ ç€è‰²å™¨çš„è¿è¡Œã€‚\nBase Pass\nä½¿ç”¨Base Passè¾“å‡ºç‰©ä½“ç¼“å†²éœ€è¦æ³¨æ„çš„ä¸¤ç‚¹ï¼š\n  ä¸ç»˜åˆ¶æ²¡è¿›å…¥è§†çº¿çš„å¯¹è±¡\nè¿™ç§\u0026quot;æŠ•å½±å‰”é™¤\u0026rdquo;ï¼ˆFrustum Cullingï¼‰ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡CPUç«¯æ¥å¤„ç†ï¼›ä¸ºäº†æ•´ä½“è¦†ç›–è¢«ç§°ä¸º\u0026quot;åŒ…å›´çƒ\u0026rdquo;ï¼ˆBounding sphereï¼‰çš„å„ä¸ª3Då¯¹è±¡ï¼Œå¯¹è±¡æ˜¯å¦åœ¨è§†é‡å†…çš„åˆ¤å®šæ ‡å‡†ï¼Œæ˜¯é€šè¿‡é¢„å…ˆè®¾å®šçš„åŒ…å›´çƒæ¥å®è¡Œçš„ã€‚\n ä»€ä¹ˆç¨‹åº¦çš„å‰”é™¤ä¼šæˆåŠŸï¼Œå¯ä»¥é€šè¿‡Statåˆå§‹è§†å›¾ï¼ˆStat InitViewsï¼‰æŒ‡ä»¤çš„\u0026quot;è§†é”¥ä½“è£å‰ªåŸºå…ƒï¼ˆFrustum Culled Primitivesï¼‰\u0026ldquo;è¿›è¡Œç¡®è®¤ã€‚\n   ä¸è®¡ç®—å¤šä½™çš„åƒç´ \nåœ¨å›¾åƒå¤„ç†çš„æµç¨‹ä¸­ï¼Œä½¿ç”¨åƒç´ ç€è‰²å™¨å®é™…å¤„ç†å‰ï¼Œä¼šæœ‰è¿è¡Œæ·±åº¦æµ‹è¯•ï¼ˆZ æµ‹è¯•ï¼‰çš„\u0026quot;Pre Z æµ‹è¯•\u0026quot;è¿™ä¸€æ­¥éª¤ã€‚ä»è¿™é‡Œç€æ‰‹å¤„ç†çš„åƒç´ ï¼Œä¼šå› ä¸ºè¢«æŸä¸ªä¸œè¥¿æ‰€é®æŒ¡è€Œæ— æ³•ç»˜åˆ¶å‡ºæ¥ï¼Œè¿™æ—¶å¯ä»¥è¿›è¡Œæ’¤é”€å¤„ç†ã€‚\n ä½†æ˜¯ï¼ŒåƒåŠé€æ˜å¯¹è±¡è¿™ç§ä¼šä¼´éšÎ±æµ‹è¯•çš„ç»˜åˆ¶ã€è§†å·®é®è”½æ˜ å°„è¿™ç§åƒç´ ç€è‰²å™¨å¤„ç†åä¼šé‡æ–°ç¼–å†™æ·±åº¦å€¼çš„æƒ…å†µï¼Œå°±ä¸è¿›è¡ŒPre Zæµ‹è¯•ï¼Œè€Œé€šè¿‡å¤„ç†å®è¡Œåˆ†è·¯è¿‚å›ã€‚\n    UE4 ç»˜åˆ¶ç­–ç•¥DrawingPolicy\nç»˜åˆ¶ç­–ç•¥åœ¨UE4æ¸²æŸ“ä¸­ä½¿ç”¨å¾ˆå¤šï¼Œ ä¸­æ–‡ä¹Ÿä¸å¥½ç¿»è¯‘ã€‚ å…¶å®å°±æ˜¯æ ¹æ®ç­–ç•¥ ä½¿ç”¨äº†å“ªäº› ç€è‰²å™¨ ã€‚\n \u0026hellip;\u0026hellip;\u0026hellip;.\nUE4æ¸²æŸ“ä¸€å¸§ æ¸²æŸ“ç®¡é“ é¦–å…ˆï¼Œè™šå¹»çš„æ¸²æŸ“ç”±ä¸‰ä¸ªçº¿ç¨‹å…±åŒå®Œæˆã€‚åˆ†åˆ«æ˜¯CPUçº¿ç¨‹ï¼ŒDRAWçº¿ç¨‹ï¼Œå’ŒGPUçº¿ç¨‹ã€‚\nçŸ¥ä¹ï¼šhttps://zhuanlan.zhihu.com/p/57158725\nRenderæ¨¡å— è°ƒç”¨Render()å‡½æ•°åœ¨Renderæ¨¡å—RendererModule.hä¸­ï¼Œä»¥ä¸‹å‡½æ•°ï¼š\n1 2 3 4 5  class FRendererModule : public IRendererModule { // å¼€å§‹æ¸²æŸ“è§†å›¾æ—  virtual void BeginRenderingViewFamily(FCanvas* Canvas,FSceneViewFamily* ViewFamily) override; }   ==è°æœ€ç»ˆè°ƒç”¨äº†Renderï¼Ÿ==\nå®æ—¶æ¸²æŸ“æµç¨‹å›¾ï¼š part1:https://i.loli.net/2020/05/30/qU8vN2WZVbt9hkF.jpg\npart2:https://i.loli.net/2020/05/30/3trKVpOMU5sTQfB.jpg\næ¸²æŸ“å‡½æ•°Render è·¯å¾„ï¼šEngine \\ Source \\ Runtime \\ Renderer \\ Private \\ DeferredShadingRenderer.cppï¼ˆ660ï¼‰\nå‡½æ•°ï¼šFDeferredShadingSceneRenderer :: Renderï¼ˆï¼‰æ¸²æŸ“è·¯å¾„\n   å…¨å±€ç³»ç»Ÿçº¹ç†åˆå§‹åŒ– DeferredShadingRenderer.cppï¼ˆ677ï¼‰ GSystemTextures.InitializeTexturesï¼ˆï¼‰     ä¿æŠ¤ å¿…è¦çš„æ¸²æŸ“ç›®æ ‡æ‚¨æ˜¯å¦å·²ç¡®ä¿å¯ä»¥ä¿æŠ¤çš„æœ€å¤§ç›®æ ‡æ•°ç›®ï¼Ÿ DeferredShadingRenderer.cppï¼ˆ680ï¼‰ GSceneRenderTargets.Allocateï¼ˆï¼‰   åˆå§‹åŒ–æ¯ä¸ªè§†å£ è®¾ç½®è§†å£æ˜¾ç¤ºçš„å¯¹è±¡ï¼Œé€‰æ‹©ä½¿ç”¨åŠ¨æ€é˜´å½±æ—¶æ˜¾ç¤ºçš„å¯¹è±¡ï¼Œå¯¹åŠé€æ˜å¯¹è±¡è¿›è¡Œæ’åº DeferredShadingRenderer.cppï¼ˆ683ï¼‰ InitViews()ï¼ˆï¼‰   FXSystemé¢„å¤„ç† GPUç²’å­æ­£åœ¨è¢«ä»¿çœŸ DeferredShadingRenderer.cppï¼ˆ758ï¼‰ FXSystem-\u0026gt; PreRenderï¼ˆï¼‰   å¯ç”¨Z Pre-Passæ—¶æ‰§è¡Œçš„æ—©æœŸZç»˜åˆ¶ ä¸ç»˜åˆ¶Tileæ¸²æŸ“çš„ç¡¬ä»¶ï¼ˆç§»åŠ¨è®¾å¤‡ï¼ŒAndroidæˆ–iOSï¼‰å¯¹äº PCæˆ–PS4ï¼Œå°†ç”Ÿæˆæ·±åº¦ç¼“å†²åŒºå’ŒHiZï¼Œå› æ­¤åç»­ç»˜åˆ¶é€Ÿåº¦å¾ˆå¿«æˆä¸ºï¼Ÿ DeferredShadingRenderer.cppï¼ˆ768ï¼‰ RenderPrePassï¼ˆï¼‰   å®‰å…¨GBuffer DeferredShadingRenderer.cppï¼ˆ774ï¼‰ GSceneRenderTargets.AllocGBufferTargetsï¼ˆï¼‰   é€æ˜å…‰ä¼ æ’­é‡ DeferredShadingRenderer.cppï¼ˆ779ï¼‰ ClearLPVsï¼ˆï¼‰   ä½¿ç”¨DBufferæ—¶ç»˜åˆ¶å»¶æœŸè´´å›¾å•å‡»æ­¤å¤„è·å– DBufferå’Œå»¶æœŸè´´å›¾ DeferredShadingRenderer.cppï¼ˆ796ï¼‰ GCompositionLighting.ProcessBeforeBasePassï¼ˆï¼‰   å¦‚æœ‰å¿…è¦ï¼Œè¯· åœ¨ç»˜åˆ¶çº¿æ¡†å›¾æ—¶æ¸…é™¤GBufferé€æ˜é¢œè‰²ç¼“å†²åŒºï¼Œ æœ‰äº›æ¸¸æˆåœ¨å‘è¡Œæ¸¸æˆæ—¶æ— æ³•æ¸…é™¤GBufferæˆ–å±å¹•ã€‚ DeferredShadingRenderer.cppï¼ˆ805ï¼‰ SetAndClearViewGBufferï¼ˆï¼‰ DeferredShadingRenderer.cppï¼ˆ816ï¼‰ RHICmdList.Clearï¼ˆï¼‰   æ¸²æŸ“ä¸é€æ˜çš„å¯¹è±¡æ¸²æŸ“ é¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®æ ¹æ®å®ƒä»¬æ˜¯Maskedè¿˜æ˜¯Defaultï¼Œæ˜¯å¦æœ‰LightMapç­‰æŒ‰æ¯ç§æ’åºé¡ºåºè¿›è¡Œäº†ç²¾ç»†åˆ†ç±» DeferredShadingRenderer.cppï¼ˆ828ï¼‰ RenderBasePassï¼ˆï¼‰   æ¸…é™¤ GBuffer çš„æœªç»˜åˆ¶éƒ¨åˆ†å¦‚æœäº‹å…ˆæ¸…é™¤GBufferï¼Œåˆ™ä¸å¿…è¦ã€‚ DeferredShadingRenderer.cppï¼ˆ851ï¼‰ ClearGBufferAtMaxZï¼ˆï¼‰   ç»˜åˆ¶ è‡ªå®šä¹‰æ·±åº¦è¯·å‚è§æ­¤å¤„ä»¥è·å–è‡ªå®šä¹‰æ·±åº¦ DeferredShadingRenderer.cppï¼ˆ860ï¼‰ RenderCustomDepthPassï¼ˆï¼‰   åœ¨è¿™é‡Œå†æ¬¡æ¨¡æ‹ŸGPUç²’å­é™¤äº†åœ¨è¿™é‡Œ å¤„ç†ä½¿ç”¨æ·±åº¦ç¼“å†²åŒºæ‰§è¡Œç¢°æ’æ£€æµ‹çš„ ç²’å­å¤–ï¼Œè¿˜å¯¹GPUç²’å­è¿›è¡Œæ’åº DeferredShadingRenderer.cppï¼ˆ865ï¼‰ åœºæ™¯-\u0026gt; FXSystem-\u0026gt; PostRenderOpaqueï¼ˆï¼‰   ä¸ºSceneDepthTextureåˆ›å»ºä¸€ä¸ªåŠåˆ†è¾¨ç‡ï¼ˆæ¯ä¸ªæ–¹é¢ä¸º1/4åˆ†è¾¨ç‡ï¼‰çš„ç¼“å†²åŒº DeferredShadingRenderer.cppï¼ˆ875ï¼‰ UpdateDownsampledDepthSurfaceï¼ˆï¼‰   æ‰§è¡Œé˜»å¡æµ‹è¯• HZBçš„æ„å»ºï¼Œæ‰§è¡Œæäº¤ çš„HZB Attotempkinderçš„è¿™ç¯‡æ–‡ç« æŒ‡ DeferredShadingRenderer.cppï¼ˆ881ï¼‰ BeginOcclusionTestsï¼ˆï¼‰   å¼€å§‹å†™ å› ä¸ºæœ‰ç‚¹å¤æ‚ï¼Œæ‰€ä»¥è¦å†™ä¸€äº›ç»†èŠ‚ DeferredShadingRenderer.cppï¼ˆ890ï¼‰   ä¸ä½¿ç”¨DBufferç»˜åˆ¶å»¶è¿Ÿçš„è´´å›¾ CompositionLighting.cppï¼ˆ293ï¼‰ AddDeferredDecalsBeforeLightingï¼ˆï¼‰   åœ¨å±å¹•ç©ºé—´ä¸­ç»˜åˆ¶ç¯å¢ƒå…‰é®æŒ¡ CompositionLighting.cppï¼ˆ300ï¼‰ AddPostProcessingAmbientOcclusionï¼ˆï¼‰   åæœŸå¤„ç†ç¯å¢ƒç«‹æ–¹ä½“è´´å›¾ CompositionLighting.cppï¼ˆ305ï¼‰ AddPostProcessingAmbientCubemapï¼ˆï¼‰   åˆ°è¿™é‡Œä¸ºæ­¢çš„ä¸€ç³»åˆ—å¤„ç† DeferredShadingRenderer.cppï¼ˆ904ï¼‰ GCompositionLighting.ProcessAfterBasePassï¼ˆï¼‰   é€æ˜çš„ä½“ç§¯å…‰ç¼“å†²æ¶²å¯æé«˜é€æ˜åº¦ DeferredShadingRenderer.cppï¼ˆ908ï¼‰ ClearTranslucentVolumeLightingï¼ˆï¼‰   ä»æ­¤å¤„å¼€å§‹çš„ä¸»è¦ç…§æ˜è®¾å¤‡ æ”¶é›†è¦ç»˜åˆ¶çš„ç¯å…‰å¹¶å°†å…¶æ’åº ä¸è¦æŠ•å½±ï¼Œä¸ä½¿ç”¨ç¯å…‰åŠŸèƒ½çš„ç¯å…‰å°†ä½¿ç”¨â€œ åŸºäºå›¾å—â€ ç»˜åˆ¶ï¼ˆå¦‚æœå¯èƒ½ï¼‰å¦‚æœä¸èƒ½ä½¿ç”¨â€œ åŸºäºå›¾å—â€å…³äºå»¶è¿Ÿæ¸²æŸ“ï¼Œè¿™æ˜¯å‘³oï¼Œä½†è¯·å‚è§æ­¤å¤„ LightRendering.cppï¼ˆ312-348ï¼‰ LightRendering.cppï¼ˆ423ï¼‰ RenderTiledDeferredLightingï¼ˆï¼‰ LightRendering.cppï¼ˆ429ï¼‰ RenderSimpleLightsStandardDeferredï¼ˆï¼‰   å®ƒä¸ä¼šé˜´å½±ï¼Œä¹Ÿä¸ä¼šä½¿ç”¨ç¯å…‰åŠŸèƒ½ï¼Œä½†æ˜¯ä¼¼ä¹æ— æ³•ä½¿ç”¨TBDRç»˜åˆ¶çš„ç¯å…‰ è¢«ç§°ä¸ºæ ‡å‡†å»¶è¿Ÿç¯å…‰ã€‚ LightRendering.cppï¼ˆ445ï¼‰ RenderLightï¼ˆï¼‰   å¦‚æœç”¨äºåŠé€æ˜çš„ä½“ç§¯å…‰æ˜¯æœ‰æ•ˆçš„ï¼Œåˆ™å°†æ¯ä¸ªå…‰æ³¨å…¥åˆ°ä½“ç§¯å…‰ä¸­ ï¼Œä»è€Œåœ¨3Dçº¹ç†ä¸Šç»˜åˆ¶å…‰æ•ˆæœã€‚ LightRendering.cppï¼ˆ455ï¼‰ InjectTranslucentVolumeLightingArrayï¼ˆï¼‰ LightRendering.cppï¼ˆ461ï¼‰ InjectSimpleTranslucentVolumeLightingArrayï¼ˆï¼‰   ä½¿ç”¨ç¯å…‰åŠŸèƒ½æŠ•å°„é˜´å½±çš„ç¯å…‰å°†å•ç‹¬å¤„ç† LightRendering.cppï¼ˆ468-552ï¼‰   é¦–å…ˆï¼Œæˆ‘åœ¨æŠ•å°„é˜´å½±æ—¶ ç»˜åˆ¶äº†ä¸€ä¸ªé˜´å½±è´´å›¾ï¼›åœ¨è¿™é‡Œæˆ‘è¿˜ç»˜åˆ¶äº†ä¸€ä¸ª åŠé€æ˜çš„é˜´å½±è´´å›¾ï¼›æˆ‘è®°å¾—åŠé€æ˜çš„å½“ç„¶æ˜¯å‚…ç«‹å¶ä¸é€æ˜åº¦è´´å›¾ã€‚ LightRendering.cppï¼ˆ495ï¼‰ RenderTranslucentProjectedShadowsï¼ˆï¼‰ LightRendering.cppï¼ˆ497ï¼‰ RenderProjectedShadowsï¼ˆï¼‰   ä½¿ç”¨LPVæ—¶ç»˜åˆ¶åå°„é˜´å½±è´´å›¾ LightRendering.cppï¼ˆ508ï¼‰ RenderReflectiveShadowMapsï¼ˆï¼‰   ç¯å…‰åŠŸèƒ½å›¾ é˜´å½±æŒ‡ç¤ºå™¨å›¾ LightRendering.cppï¼ˆ515ï¼‰ RenderLightFunctionï¼ˆï¼‰ LightRendering.cppï¼ˆ522ï¼‰ RenderPreviewShadowsIndicatorï¼ˆï¼‰   è¡°å‡ç¼“å†²å™¨ä¸­çš„åˆ†è¾¨ å…‰çš„è¡°å‡ä¿¡æ¯æ˜¯å¦æ›¾ç»è¢«å¸å…¥å¦ä¸€ä¸ªç¼“å†²å™¨ä¸­ï¼Ÿ LightRendering.cppï¼ˆ534ï¼‰ GSceneRenderTargets.FinishRenderingLightAttenuationï¼ˆï¼‰   æ³¨å…¥ä½“ç§¯å…‰ä»¥è·å¾—åŠé€æ˜ LightRendering.cppï¼ˆ541ï¼‰ InjectTranslucentVolumeLightingï¼ˆï¼‰   è¿™ æ˜¯ä½¿ç”¨å…‰åŠŸèƒ½æŠ•å°„é˜´å½±çš„å…‰å¤„ç†çš„ç»“æŸã€‚ LightRendering.cppï¼ˆ550ï¼‰ RenderLightï¼ˆï¼‰   è¿™ æ˜¯æ¯ä¸ªå…‰çš„LPV çš„ä¸»è¦æ³¨å…¥ç…§æ˜è¿‡ç¨‹çš„ç»“å°¾ LightRendering.cppï¼ˆ561-593ï¼‰ Lpv-\u0026gt; InjectLightDirectï¼ˆï¼‰   æ³¨å…¥ä½“ç§¯å…‰ä»¥å®ç°ç¯å¢ƒç«‹æ–¹ä½“è´´å›¾çš„åŠé€æ˜ DeferredShadingRenderer.cppï¼ˆ916ï¼‰ InjectAmbientCubemapTranslucentVolumeLightingï¼ˆï¼‰   è¿‡æ»¤ä½“ç§¯å…‰ä»¥è·å¾—åŠé€æ˜ DeferredShadingRenderer.cppï¼ˆ919ï¼‰ FilterTranslucentVolumeLightingï¼ˆï¼‰   LPVä¼ è¾“è¿‡ç¨‹ æ­¤å¤–ï¼Œç¬¬921è¡Œçš„æ³¨é‡Šä¸Šå†™æœ‰â€œ copypimisâ€ï¼Œä¾‹å¦‚â€œ Clear LPV bufferâ€ã€‚ DeferredShadingRenderer.cppï¼ˆ924ï¼‰ PropagateLPVsï¼ˆï¼‰   åŠ¨æ€å¤©å…‰ç»˜å›¾ DeferredShadingRenderer.cppï¼ˆ928ï¼‰ RenderDynamicSkyLightingï¼ˆï¼‰   å»¶è¿Ÿçš„åå°„å›¾å½¢ æ•è·çš„åå°„å›¾å½¢è€Œä¸æ˜¯å±å¹•ç©ºé—´ DeferredShadingRenderer.cppï¼ˆ931ï¼‰ RenderDeferredReflectionsï¼ˆï¼‰   LPVçš„GIç»˜å›¾ CompositionLighting.cppï¼ˆ344ï¼‰ AddPostProcessingLpvIndirectï¼ˆï¼‰   å±å¹•ç©ºé—´æ¬¡è¡¨é¢æ•£å°„ï¼ˆSSSSSï¼‰çš„åå¤„ç† CompositionLighting.cppï¼ˆ347-376ï¼‰   å¦‚æœå¯ç”¨äº†â€œå…‰è½´â€ï¼Œåˆ™ç»˜åˆ¶â€œå…‰è½´é®æŒ¡â€ DeferredShadingRenderer.cppï¼ˆ953ï¼‰ RenderLightShaftOcclusionï¼ˆï¼‰   å¤§æ°”é›¾å›¾ DeferredShadingRenderer.cppï¼ˆ977ï¼‰ RenderAtmosphereï¼ˆï¼‰   ç»˜å›¾é›¾ è¿™æ˜¯é«˜åº¦é›¾å—ï¼Ÿ DeferredShadingRenderer.cppï¼ˆ986ï¼‰ RenderFogï¼ˆï¼‰   ç”»ä¸€ä¸ªåŠé€æ˜çš„ç‰©ä½“ åœ¨è¿™é‡Œä¹Ÿç”»ä¸€ä¸ªå•ç‹¬çš„åŠé€æ˜çš„ä¸œè¥¿ DeferredShadingRenderer.cppï¼ˆ1000ï¼‰ RenderTranslucencyï¼ˆï¼‰   æŠ˜å°„å˜å½¢å¤„ç† DeferredShadingRenderer.cppï¼ˆ1008ï¼‰ RenderDistortionï¼ˆï¼‰   å…‰è½´çš„èµ·éœœå¤„ç† DeferredShadingRenderer.cppï¼ˆ1013ï¼‰ RenderLightShaftBloomï¼ˆï¼‰   è·ç¦»åœºAOå¤„ç†ä¸èƒ½åœ¨ å½“å‰ä¸æ”¯æŒå¤šä¸ªè§†å£ çš„åˆ†å±æ¸¸æˆä¸­ä½¿ç”¨å—ï¼Ÿ DeferredShadingRenderer.cppï¼ˆ1019ï¼‰ RenderDistanceFieldAOSurfaceCacheï¼ˆï¼‰   å®ƒåªæ˜¯åœ¨æŸ¥çœ‹ç½‘æ ¼çš„â€œè·ç¦»åœºâ€çš„å¯è§†åŒ–å¤„ç†ç»“æœå—ï¼Ÿ DeferredShadingRenderer.cppï¼ˆ1024ï¼‰ RenderMeshDistanceFieldVisualizationï¼ˆï¼‰   ç”±äºé€Ÿåº¦æ¨¡ç³Šè€Œç»˜åˆ¶è¿åŠ¨å¯¹è±¡çš„é€Ÿåº¦ DeferredShadingRenderer.cppï¼ˆ1034ï¼‰ RenderVelocitiesï¼ˆï¼‰   ä»è¿™é‡Œåˆ°æœ€åçš„å‘å¸ƒè¿‡ç¨‹ï¼Œ è¿™ä¹Ÿå¾ˆå¤æ‚è€Œä¸”å¾ˆé•¿ DeferredShadingRenderer.cppï¼ˆ1047ï¼‰ GPostProcessing.Processï¼ˆï¼‰   ä½¿ç”¨BeforeTranslucencyè®¾ç½®ç»˜åˆ¶åå¤„ç†ææ–™ PostProcessing.cppï¼ˆ878ï¼‰ AddPostProcessMaterialï¼ˆï¼‰   æ™¯æ·±å¤„ç† é€šè¿‡é«˜æ–¯æ¨¡ç³Šè¿›è¡ŒDOF å¤„ç†ä¹‹åï¼Œæ­£åœ¨æ‰§è¡Œæ•£ç„¦å¤„ç†ï¼ˆä½¿ç”¨æŒ‡å®šçš„å…‰åœˆå½¢çŠ¶çš„çº¹ç†è¿›è¡Œç»˜åˆ¶ï¼‰ï¼Œ åœ¨æ­¤é˜¶æ®µä¼¼ä¹åˆå¹¶äº†å•ç‹¬çš„åŠé€æ˜ç¼“å†²åŒº PostProcessing.cppï¼ˆ888ï¼‰ AddPostProcessDepthOfFieldGaussianï¼ˆï¼‰ PostProcessing.cppï¼ˆ898ï¼‰ AddPostProcessDepthOfFieldBokehï¼ˆï¼‰ PostProcessing.cppï¼ˆ905ï¼‰ FRCPassPostProcessBokehDOFRecombine ï¼ˆå¦‚æœæœªå¯ç”¨æ¨¡ç³Šï¼‰   ä½¿ç”¨BeforeTonemappingè®¾ç½®ç»˜åˆ¶åå¤„ç†ææ–™ PostProcessing.cppï¼ˆ913ï¼‰ AddPostProcessMaterialï¼ˆï¼‰   å¦‚æœè¦ä½¿ç”¨TemporalAA ï¼Œè¯·åœ¨æ­¤å¤„ç»˜åˆ¶ï¼Œå¦‚æœä½¿ç”¨FXAAï¼Œè¯·ç¨åå†ç»˜åˆ¶ PostProcessing.cppï¼ˆ921ï¼‰ AddTemporalAAï¼ˆï¼‰ PostProcessing.cppï¼ˆ928ï¼‰ AddTemporalAAï¼ˆï¼‰ ï¼ˆå¦‚æœä¸ä½¿ç”¨é€Ÿåº¦ç¼“å†²åŒºï¼Œè¯·å•å‡»æ­¤å¤„ï¼‰   è¿åŠ¨æ¨¡ç³Šå¤„ç† è®¾ç½®ï¼Œåˆ†è¾¨ç‡ä¸‹é‡‡æ ·ï¼Œé«˜æ–¯æ¨¡ç³Šï¼Œè¿åŠ¨æ¨¡ç³Šç»˜åˆ¶ï¼Œç»„åˆå¤„ç† PostProcessing.cppï¼ˆ932-994ï¼‰ FRCPassPostProcessMotionBlurSetup FRCPassPostProcessDownsample RenderGaussianBlurï¼ˆï¼‰ FRCPassPostProcessMotionBlur FRCPassPostProcessMotionBlurRecombine   SceneColorä¸‹é‡‡æ · PostProcessing.cppï¼ˆ1000ï¼‰ FRCPassPostProcessDownsample   ç›´æ–¹å›¾ PostProcessing.cppï¼ˆ1006-1040ï¼‰ FRCPassPostProcessHistogram FRCPassPostProcessHistogramReduce   æ­¤å¤„éœ€è¦çœ¼ç›é€‚åº”å›¾ç›´æ–¹å›¾ PostProcessing.cppï¼ˆ1046ï¼‰ AddPostProcessEyeAdaptationï¼ˆï¼‰   å¸ƒå¢å§†ç»˜å›¾ PostProcessing.cppï¼ˆ1057ï¼‰ AddBloomï¼ˆï¼‰ PostProcessing.cppï¼ˆ1060-1148ï¼‰ ï¼ˆå¯¹äºç§»åŠ¨è®¾å¤‡ï¼Œè¯·å•å‡»æ­¤å¤„ï¼‰   è‰²è°ƒæ˜ å°„ ä»…æ›¿æ¢ReplacecingTonemapperè®¾ç½®å·¥ç¨‹å›¾çš„ä¸€ç§åå¤„ç†ææ–™ï¼Œä½†æ˜¯ å¦‚æœå­˜åœ¨è¯¥ææ–™ï¼Œåˆ™æ‰§è¡Œé»˜è®¤è‰²è°ƒæ˜ å°„ PostProcessing.cppï¼ˆ1155ï¼‰ AddSinglePostProcessMaterialï¼ˆï¼‰ PostProcessing.cppï¼ˆ1171ï¼‰ AddTonemapperï¼ˆï¼‰ ï¼ˆé»˜è®¤è‰²è°ƒæ˜ å°„ï¼‰   å¦‚æœå¯ç”¨äº†FXAAï¼Œè¯·åœ¨æ­¤å¤„å¤„ç† PostProcessing.cppï¼ˆ1177ï¼‰ AddPostProcessAAï¼ˆï¼‰   ç»˜åˆ¶ä¸€äº›ç¼–è¾‘å™¨ï¼ˆå¦‚é€‰å®šçš„è½®å»“ï¼‰ï¼Œ ç„¶åä½¿ç”¨AfterTonemappingè®¾ç½®ç»˜åˆ¶åæœŸå¤„ç†ææ–™ PostProcessing.cppï¼ˆ1244ï¼‰ AddPostProcessMaterialï¼ˆï¼‰   ç”¨äºåœ°ä¸‹å’ŒGBufferçš„å¯è§†åŒ– è°ƒè¯• PostProcessing.cppï¼ˆ1246-1254ï¼‰   ç”¨äºHMDçš„åå¤„ç† Oculusæˆ–Morpheus PostProcessing.cppï¼ˆ1256-1277ï¼‰ FRCPassPostProcessHMD FRCPassPostProcessMorpheus   ä¹‹åï¼Œè°ƒè¯•å’Œé«˜åˆ†è¾¨ç‡å±å¹•æˆªå›¾åŠŸèƒ½ç­‰ã€‚ ä¹‹åï¼Œè¿›è¡Œåå¤„ç†å¹¶ç»“æŸï¼ è°¢è°¢ï¼ PostProcessing.cppï¼ˆ1279-ï¼‰    å“¦ï¼Œå¾ˆé•¿ã€‚\nå‚è€ƒé“¾æ¥ï¼š\n  å¦‚ä½•åœ¨C ++ä¸­ä»UTexture2Dè¯»å–æ•°æ®\n  https://forums.unrealengine.com/development-discussion/c-gameplay-programming/1422920-casting-converting-frhitexture-to-utexture\n  Unrealæ¸²æŸ“ç›¸å…³çš„ç¼“å†²åŒº\n  https://qiita.com/mechamogera/items/a0c369a3b853a3042cae\n  https://answers.unrealengine.com/questions/17862/access-color-and-depth-buffer-of-each-frame.html\n  https://segmentfault.com/a/1190000012737548\n  Gbuffæ•°æ®\n  æ¸²æŸ“ç³»ç»Ÿæ¦‚è¿° å›¾ç‰‡\n  ","description":"","id":82,"section":"posts","tags":["C++","UE4","Game"],"title":"UE4æ¸²æŸ“è¿‡ç¨‹","uri":"https://hugo.jiahongw.com/zh/posts/ue/ue4-render/"},{"content":"RSAç®—æ³• RSAåŠ å¯†ç®—æ³•æ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œåœ¨å…¬å¼€å¯†é’¥åŠ å¯†å’Œç”µå­å•†ä¸šä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚\n å¯¹æå¤§æ•´æ•°åšå› æ•°åˆ†è§£çš„éš¾åº¦å†³å®šäº† RSA ç®—æ³•çš„å¯é æ€§ã€‚æ¢è¨€ä¹‹ï¼Œå¯¹ä¸€æå¤§æ•´æ•°åšå› æ•°åˆ†è§£æ„ˆå›°éš¾ï¼ŒRSA ç®—æ³•æ„ˆå¯é ã€‚å‡å¦‚æœ‰äººæ‰¾åˆ°ä¸€ç§å¿«é€Ÿå› æ•°åˆ†è§£çš„ç®—æ³•çš„è¯ï¼Œé‚£ä¹ˆç”¨ RSA åŠ å¯†çš„ä¿¡æ¯çš„å¯é æ€§å°±ä¼šæåº¦ä¸‹é™ã€‚ä½†æ‰¾åˆ°è¿™æ ·çš„ç®—æ³•çš„å¯èƒ½æ€§æ˜¯éå¸¸å°çš„ã€‚ä»Šå¤©åªæœ‰çŸ­çš„ RSA é’¥åŒ™æ‰å¯èƒ½è¢«å¼ºåŠ›æ–¹å¼ç ´è§£ã€‚åˆ°å½“å‰ä¸ºæ­¢ï¼Œä¸–ç•Œä¸Šè¿˜æ²¡æœ‰ä»»ä½•å¯é çš„æ”»å‡»RSAç®—æ³•çš„æ–¹å¼ã€‚åªè¦å…¶é’¥åŒ™çš„é•¿åº¦è¶³å¤Ÿé•¿ï¼Œç”¨RSAåŠ å¯†çš„ä¿¡æ¯å®é™…ä¸Šæ˜¯ä¸èƒ½è¢«ç ´è§£çš„ã€‚\n å…¬é’¥/åŒå¯†é’¥/éå¯¹ç§° åŠ å¯† æ¶‰åŠåˆ°ä¸¤ä¸ªå¯†é’¥çš„ä½¿ç”¨:\n ä¸€ä¸ªå…¬é’¥, å¯ä»¥è¢«ä»»ä½•äººçŸ¥é“ï¼Œç”¨äºåŠ å¯†æ¶ˆæ¯å’ŒéªŒè¯ç­¾å ä¸€ä¸ªç§é’¥, åªæœ‰æ¥æ”¶æ–¹æ‰çŸ¥é“ï¼Œç”¨äºè§£å¯†æ¶ˆæ¯å’Œåˆ›é€ ç­¾å  RSAå®ç°è¿‡ç¨‹ 1. å…¬é’¥ä¸ç§é’¥çš„äº§ç”Ÿ ç”Ÿæˆå…¬é’¥eå’Œç§é’¥dçš„æ­¥éª¤å¦‚ä¸‹ï¼š\n éšæ„é€‰æ‹©ä¸¤ä¸ªå¤§çš„è´¨æ•°$p$å’Œ$q$ï¼Œ$p$ä¸ç­‰äº$q$ï¼Œè®¡ç®—$n=pq$ã€‚ æ ¹æ®æ¬§æ‹‰å‡½æ•°ï¼Œæ±‚$r = \\varphi (N) = \\varphi (p)\\varphi (q) = (p - 1)(q - 1)$ é€‰æ‹©ä¸€ä¸ªå°äº$r$çš„æ•´æ•°$e$ï¼Œä½¿$e$ä¸$r$äº’è´¨ã€‚å¹¶æ±‚å¾—$e$å…³äº$r$çš„æ¨¡åå…ƒç´ ï¼Œå‘½åä¸º$d$(æ±‚$d$ä»¤$ed \\equiv 1(\\bmod ;r)$)ã€‚(æ¨¡åå…ƒç´ å­˜åœ¨ï¼Œå½“ä¸”ä»…å½“$e$ä¸$r$äº’è´¨) å°†$p$å’Œ$q$çš„è®°å½•é”€æ¯  ç»è¿‡ä¸Šé¢å››ä¸ªæ­¥éª¤æœ€ç»ˆå¯ä»¥å¾—åˆ°å…¬é’¥$(n,e)$å’Œç§é’¥$(n,d)$ã€‚\næ¥æ”¶æ¶ˆæ¯çš„äººå°†è‡ªå·±çš„å…¬é’¥$(n,e)$å‘é€ç»™å‘é€æ¶ˆæ¯çš„äºº,å‘é€çš„äººä½¿ç”¨è¿™ä¸ªå…¬é’¥åŠ å¯†ä¿¡æ¯å‘é€ç»™æ¥æ”¶æ–¹ï¼Œè€Œæ¥æ”¶æ–¹å°†ç§é’¥$(n,d)$ä¿å­˜èµ·æ¥ç”¨äºè§£å¯†ã€‚\nä¸‹é¢å®ç°RSAç±»\n å‚è€ƒèµ„æ–™ï¼š\n ç±³å‹’-æ‹‰å®¾ç´ æ€§æ£€éªŒ RSAåŠ å¯†ç®—æ³• C++å®ç°   å®éªŒæ­¥éª¤ä¸ç»“æœ 1.å®ç°å¤§æ•´æ•°ç±» å› ä¸ºè¯¥åŠ å¯†ç®—æ³•æ¶‰åŠçš„æ•°å¯èƒ½å¾ˆå¤§ï¼Œè€ŒC++ä¸­å¹¶æ²¡æœ‰åƒJavaä¸€æ ·ï¼Œå†…ç½®å¤§æ•´æ•°ç±»BigIntegerï¼Œæ•…éœ€è‡ªå·±å®ç°ï¼Œè¿™é‡Œæˆ‘å‚è€ƒäº†ç½‘ä¸Šçš„ä¸€äº›èµ„æ–™è®¾è®¡äº†BigIntegerç±»ï¼Œå®ç°äº†åŠ å‡ä¹˜é™¤ä»¥åŠæ¨¡å¹‚ç­‰è¿ç®—ï¼Œä¹Ÿå®ç°äº†è¿ç®—ç¬¦é‡è½½ï¼Œå…·ä½“å‚è€ƒå®ç°çš„æ–¹æ³•å¦‚ä¸‹ï¼š\n2. è®¾è®¡RSAç±» ç¼–å†™rsa.hå¤´æ–‡ä»¶ï¼Œå®šä¹‰RSAç±»ï¼Œå…¶ä¸­åŒ…å«çš„æˆå‘˜ä»¥åŠæˆå‘˜å‡½æ•°å¦‚ä¸‹ï¼š\nä¸‹é¢åˆ†åˆ«å®ç°ä¸Šè¿°çš„å„ä¸ªæ–¹æ³•\né¦–å…ˆè¦ç”Ÿæˆå¯†é’¥å¯¹ï¼Œå³ç”Ÿæˆå…¬é’¥å’Œç§é’¥ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•°på’Œq,æ˜¾ç„¶ï¼Œç´ æ•°æ˜¯ä¸å¯èƒ½æ˜¯å¶æ•°çš„ï¼Œæ•…å®šä¹‰ä¸€ä¸ªç”Ÿæˆéšæœºå¥‡æ•°çš„å‡½æ•°BigInteger createOddNum(unsigned len)å‚æ•°ä¸ºå¥‡æ•°çš„é•¿åº¦ã€‚\nä½¿ç”¨16è¿›åˆ¶çš„éšæœºå­—æ¯ï¼Œç„¶åéšæœºé€‰å–å…¶ä¸­çš„len/4ä¸ªå¾—åˆ°ä¸€ä¸ªéšæœºçš„å¤§å¥‡æ•°ï¼Œåªéœ€è¦æœ«å°¾é‚£ä¸ªæ•°ä¸ºå¥‡æ•°å³å¯ï¼Œæœ€åè¿”å›BigIntegerç±»å‹çš„å¥‡æ•°å¤§æ•´æ•°ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š\nç„¶åå®šä¹‰ä¸€ä¸ªç”Ÿæˆç´ æ•°çš„å‡½æ•°ï¼Œå…¶ä¸­ç”¨åˆ°ç±³å‹’-æ‹‰å®¾ç´ æ€§æ£€éªŒç®—æ³•åˆ¤æ–­ç”Ÿæˆçš„ç´ æ•°æ˜¯å¦ä¸ºç´ æ•°ç´ æ•°ï¼š\nç±³å‹’-æ‹‰å®¾ç´ æ€§æ£€æµ‹ç®—æ³• åŸºäºä»¥ä¸‹å®šç†ï¼š\n è´¹é©¬å°å®šç†  è¦æµ‹è¯•$N$æ˜¯å¦ä¸ºç´ æ•°ï¼Œé¦–å…ˆå°†$Nâˆ’1$åˆ†è§£ä¸º$2^{s}d$ã€‚åœ¨æ¯æ¬¡æµ‹è¯•å¼€å§‹æ—¶ï¼Œå…ˆéšæœºé€‰ä¸€ä¸ªä»‹äº$[1,Nâˆ’1]$çš„æ•´æ•°$a$ï¼Œä¹‹åå¦‚æœå¯¹æ‰€æœ‰çš„$râˆˆ[0,sâˆ’1]$ï¼Œè‹¥${a^d}\\bmod N \\ne 1$ä¸”${a^{{2^r}d}}\\bmod N \\ne - 1$ï¼Œåˆ™$N$æ˜¯åˆæ•°ã€‚å¦åˆ™ï¼Œ$N$æœ‰$3/4$çš„æ¦‚ç‡ä¸ºç´ æ•°ã€‚\nå…³é”®ä»£ç å¦‚ä¸‹ï¼š\nç”Ÿæˆç´ æ•°çš„é€»è¾‘å°±æ˜¯é¦–å…ˆä½¿ç”¨å‡½æ•°createOddNumç”Ÿæˆä¸€ä¸ªå¤§å¥‡æ•°ï¼Œç„¶åè°ƒç”¨isPrimeåˆ¤æ–­æ˜¯å¦ä¸ºä¸€ä¸ªç´ æ•°ï¼Œæ˜¯çš„è¯å°±å¯ä»¥returnï¼Œä¸ç„¶ç»§ç»­å¯»æ‰¾ï¼ŒçŸ¥é“ç”Ÿæˆä¸€ä¸ªç´ æ•°ã€‚\næ¥ä¸‹æ¥è®¡ç®—nå€¼ï¼Œnå€¼çš„è®¡ç®—å¾ˆç®€å•ï¼Œç›´æ¥ä½¿ç”¨$n = p * q$ è¿™ä¸ªå¼å­å°±èƒ½å¤Ÿè®¡ç®—å‡ºæ¥ï¼›è®¡ç®—æ¬§æ‹‰å€¼ä¹Ÿä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨$\\varphi(n) = (p-1) * (q-1)$å¾—å‡ºã€‚å…¶ä¸­æ¯”è¾ƒéš¾çš„æ˜¯ç”Ÿæˆçš„ç§é’¥dã€‚\nä¸‹é¢å®šä¹‰ä¸€ä¸ªRSAç±»çš„åˆå§‹åŒ–å‡½æ•°init()â€‹ï¼Œç”Ÿæˆpã€qä»¥åŠå¯†é’¥å¯¹ï¼Œå¦‚ä¸‹ï¼š\nåœ¨åˆ›å»ºå…¬é’¥eå’Œç§é’¥dçš„å‡½æ•°createExponent(eul)ä¸­ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªæ¯”æ¬§æ‹‰å€¼å°çš„å…¬é’¥eï¼Œå…¶ä¸­eä¸ºä¸€ä¸ªç´ æ•°ï¼Œç›´æ¥è°ƒç”¨å‡½æ•°createPrime()ç”Ÿæˆï¼Œç„¶åä½¿ç”¨å¤§æ•´æ•°ç±»ä¸­çš„æ±‚æ¨¡é€†å…ƒï¼Œå³æ±‚å‡ºç§é’¥dã€‚\næ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•  é€†å…ƒ\né€†å…ƒæ˜¯æ¨¡è¿ç®—ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬é€šå¸¸è¯´ A æ˜¯ B æ¨¡ C çš„é€†å…ƒï¼Œå®é™…ä¸Šæ˜¯æŒ‡ A * B = 1 mod Cï¼Œä¹Ÿå°±æ˜¯è¯´ A ä¸ B çš„ä¹˜ç§¯æ¨¡ C çš„ä½™æ•°ä¸º 1ã€‚å¯è¡¨ç¤ºä¸º A = B^(-1) mod Cã€‚\næ‰“ä¸ªæ¯”æ–¹ï¼Œ7 æ¨¡ 11 çš„é€†å…ƒï¼Œå³ï¼š7^(-1) mod 11 = 8ï¼Œè¿™æ˜¯å› ä¸º 7 Ã— 8 = 5 Ã— 11 + 1ï¼Œæ‰€ä»¥è¯´ 7 æ¨¡ 11 çš„é€†å…ƒæ˜¯ 8ã€‚\n æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ˜¯æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆåˆå«è¾—è½¬ç›¸é™¤æ³•ï¼‰çš„æ‰©å±•ã€‚å·²çŸ¥æ•´æ•°aã€bï¼Œæ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥åœ¨æ±‚å¾—aã€bçš„æœ€å¤§å…¬çº¦æ•°çš„åŒæ—¶ï¼Œèƒ½æ‰¾åˆ°æ•´æ•°xã€yï¼ˆå…¶ä¸­ä¸€ä¸ªå¾ˆå¯èƒ½æ˜¯è´Ÿæ•°ï¼‰ï¼Œä½¿å®ƒä»¬æ»¡è¶³è´ç¥–ç­‰å¼\n$$\nax{\\rm{ }} + {\\rm{ }}by{\\rm{ }} = {\\rm{ }}gcd\\left( {a,b} \\right).\n$$\nåœ¨RSAç®—æ³•ä¸­æ±‚ç§é’¥ä¸­çš„æ•´æ•°dæ—¶ï¼Œéœ€è¦ä½¿å¾— (e * d ) % n = 1ï¼Œè¯¥æ–¹ç¨‹ç­‰ä»·äº e * d = 1 + y * n ï¼ˆyä¸ºæ•´æ•°ï¼‰ï¼Œä¹Ÿç­‰ä»·äº e * d - y * n = 1ã€‚\nå› æ­¤æ±‚è§£dçš„è¿‡ç¨‹å°±æ˜¯æ±‚è§£è¯¥äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„ï¼ˆeå’Œnå·²çŸ¥ï¼Œæ±‚è§£dï¼‰ï¼Œå³æ±‚eæ¨¡nçš„é€†å…ƒã€‚\nå…³é”®ä»£ç å¦‚ä¸‹ï¼š\næˆ‘ä»¬çŸ¥é“ï¼ŒRSAçš„åŠ å¯†ä¸è§£å¯†å…¶å®å°±æ˜¯ä¸€ä¸ªæ¨¡å¹‚çš„è¿ç®—ï¼Œè€Œè¿™ä¸ªæ¨¡å¹‚çš„è¿ç®—å·²ç»åœ¨å¤§æ•´æ•°ç±»ä¸­å®ç°äº†ï¼Œå¦‚ä¸‹ï¼š\nä½¿ç”¨RSAç±»è¿›è¡ŒåŠ å¯†è§£å¯†çš„å‡½æ•°åªéœ€è¦è°ƒç”¨è¿™ä¸ªæ¨¡å¹‚è¿ç®—å³å¯ï¼Œä¾‹å¦‚ç§é’¥åŠ å¯†å¯ä»¥è¿™æ ·è°ƒç”¨ï¼š\nä»¥ä¸Šå°±è®¾è®¡å®Œäº†RSAç±»çš„ç›¸å…³æ“ä½œï¼Œä¸»è¦æ˜¯åŒ…æ‹¬å¯†é’¥çš„ç”Ÿæˆã€‚ä¸‹é¢å°†RSAåŠ å¯†è§£å¯†çš„æ“ä½œå°è£…åœ¨ä¸€ä¸ªç±»ä¸­ã€‚\n3. è®¾è®¡åŠ å¯†è§£å¯†ç±»EncryptDecrypt ä¸»è¦çš„æ–¹æ³•åŠæˆå‘˜å¦‚ä¸‹ï¼š\nå®ç°RSAåŠ å¯†è§£å¯†å­—ç¬¦ä¸² åŠ å¯†å­—ç¬¦ä¸²çš„é€»è¾‘æ˜¯ï¼Œå…ˆå°†å­—ç¬¦ä¸²ä»¥æ¯ä¸¤ä¸ªå­—ç¬¦ ä¸€ç»„ï¼Œè½¬åŒ–ä¸ºä¸€ä¸ª16è¿›åˆ¶æ•°æ®åºåˆ—ï¼Œä½¿ç”¨vectorå®¹å™¨ä¿å­˜ï¼Œä¹‹åè°ƒç”¨rsaçš„å…¬é’¥åŠ å¯†å‡½æ•°è¿›è¡ŒåŠ å¯†ï¼Œå¦‚ä¸‹æ˜¯å…³é”®ä»£ç ï¼š\nè§£å¯†å‡½æ•°å…¶å®æ˜¯æ¥å—ä¸€ä¸ªåŠ å¯†åçš„16è¿›åˆ¶åºåˆ—ï¼Œç„¶åå¯¹è¿™ä¸ªåºåˆ—è°ƒç”¨RSAçš„ç§é’¥è§£å¯†å‡½æ•°è¿›è¡Œè§£å¯†ï¼Œç„¶åå¾—åˆ°è§£å¯†åçš„16è¿›åˆ¶æ•°æ®åºåˆ—ï¼Œæœ€åè¿˜æœ‰ä¸€æ­¥å°±æ˜¯éœ€è¦å°†è¿™ä¸ª16è¿›åˆ¶åºåˆ—æœ€ç»ˆè½¬åŒ–ä¸ºåŸæ¥çš„å­—ç¬¦ä¸²ï¼Œåªéœ€è¦æ ¹æ®asciiç çš„æ•°å€¼å³å¯å¾—åˆ°ï¼Œè¿™é‡Œç¼–å†™äº†ä¸€ä¸ªhex2stringå‡½æ•°ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š\nå®ç°æ•ˆæœ\né¦–å…ˆæ˜¾ç¤ºå¯†é’¥ï¼š\nåŠ å¯†å­—ç¬¦ä¸²\nè§£å¯†å­—ç¬¦ä¸²\nå®ç°RSAåŠ å¯†è§£å¯†æ–‡ä»¶ å®ç°RSAåŠ å¯†è§£å¯†æ–‡ä»¶æ—¶åŸºäºRSAåŠ å¯†è§£å¯†å­—ç¬¦ä¸²å®ç°çš„ï¼Œå…¶ä¸­ä¸»è¦çš„åŠ å¯†é€»è¾‘å°±æ˜¯å°†ä¸€ä¸ªæ–‡ä»¶çœ‹ä½œæ˜¯ä¸€è¡Œä¸€è¡Œçš„å­—ç¬¦ä¸²æ–‡æœ¬ï¼Œæ²¡æ¯è¯»å–ä¸€è¡Œï¼Œå°±è°ƒç”¨åŠ å¯†å­—ç¬¦ä¸²çš„å‡½æ•°è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå°†åŠ å¯†å¾—åˆ°çš„16è¿›åˆ¶åºåˆ—å†™å…¥åˆ°å¦å¤–ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶ä¹Ÿå°±æ˜¯åŠ å¯†åçš„æ–‡ä»¶ï¼Œä¸»è¦å…³é”®ä»£ç å¦‚ä¸‹ï¼š\nè§£å¯†æ–‡ä»¶çš„å‡½æ•°ç¨å¾®æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œæ˜¯ä»æ‰“å¼€çš„å¾…è§£å¯†æ–‡ä»¶ä¸­å¾ªç¯è¯»å–æ¯ä¸€ä¸ª16è¿›åˆ¶æ•°æ®ï¼Œç„¶åå¯¹æ¯ä¸€ä¸ª16è¿›åˆ¶æ•°æ®è°ƒç”¨è§£å¯†å‡½æ•°å¾—åˆ°è§£å¯†åçš„16è¿›åˆ¶æ•°æ®ï¼Œå°†16è¿›åˆ¶æ•°æ®è½¬ä¸ºå­—ç¬¦ä¸²åå†ç›¸ç»§çš„å†™åˆ°å¦å¤–ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå³è§£å¯†åçš„æ–‡ä»¶ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š\nå®ç°æ•ˆæœ\nåŠ å¯†æ–‡ä»¶\nè§£å¯†æ–‡ä»¶\nåŠ å¯†æ–‡ä»¶è§£å¯†æ–‡ä»¶å¯¹æ¯”\nå®ç°RSAæ•°å­—ç­¾ååŠéªŒè¯ å®ç°æ•°å­—ç­¾åæ–¹æ¡ˆï¼ŒæŒ‰ç…§ä»¥ä¸‹çš„æµç¨‹å›¾è¿›è¡Œæ“ä½œã€‚\né¦–å…ˆéœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œä¿¡æ¯çš„æ‘˜è¦ï¼Œå¾—åˆ°Hashå€¼ï¼Œè¿™é‡Œé€‰æ‹©çš„Hashç®—æ³•æ˜¯SHA512ç®—æ³•ï¼Œå¯ä»¥ç›´æ¥å¯¹æ–‡ä»¶è¿›è¡Œä¿¡æ¯æ‘˜è¦ã€‚\nå¯ä»¥ç›´æ¥include C++ å®ç°çš„\u0026quot;sha512.h\u0026quot;æ–‡ä»¶å¤´ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹çš„è¯­å¥å°±èƒ½å¤Ÿç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º512çš„Hashå€¼ï¼Œå¦‚ä¸‹ï¼š\nå¯ä»¥åœ¨å‘½ä»¤è¡Œè¾“å‡ºæ–‡ä»¶çš„Hashæ‘˜è¦å€¼å¦‚ä¸‹:\næ•°å­—ç­¾åçš„å®ç°ç±»ä¼¼å­—ç¬¦ä¸²åŠ å¯†ï¼Œå¯¹æ–‡ä»¶çš„hashå€¼è¿›è¡ŒåŠ å¯†å¾—åˆ°åé¢çš„16è¿›åˆ¶åºåˆ—ï¼Œç„¶åå°†16è¿›åˆ¶åºåˆ—ä¼´éšæ–‡ä»¶å‘é€å‡ºå»ï¼Œç­¾åçš„å…³é”®ä»£ç å°±æ˜¯å¯¹hashå€¼è¿›è¡ŒåŠ å¯†ï¼Œå¦‚ä¸‹ï¼š\néªŒè¯å‡½æ•°ç›´æ¥å°†16è¿›åˆ¶åºåˆ—è¿›è¡Œè§£å¯†ï¼Œç„¶åè¿˜åŸæˆå­—ç¬¦ä¸²å†ä¸æ”¶åˆ°çš„æ–‡ä»¶çš„hashå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰ï¼Œé‚£ä¹ˆéªŒè¯æˆåŠŸï¼›å¦åˆ™éªŒè¯å¤±è´¥ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š\nå®ç°æ•ˆæœ\næ•°å­—ç­¾å\néªŒè¯æ•°å­—ç­¾å\n","description":"","id":83,"section":"posts","tags":["rsa"],"title":"RSAåŠ å¯†ç®—æ³•","uri":"https://hugo.jiahongw.com/zh/posts/cryptography/rsa/"},{"content":"è´¹é©¬å¤§å®šç†åœ¨æ•°å­¦é‡Œæœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç°è±¡ï¼Œå³åœ¨äºå®ƒæ˜¯é”™è¯¯è¯æ˜æ•°é‡æœ€å¤šçš„æ•°å­¦é¢˜ã€‚\nè´¹é©¬å°å®šç† è´¹é©¬å°å®šç†æ˜¯æ•°è®ºä¸­çš„ä¸€ä¸ªå®šç†ï¼šå‡å¦‚$a$æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ$p$æ˜¯ä¸€ä¸ªè´¨æ•°ï¼Œé‚£ä¹ˆ$a^{p}-a$æ˜¯$p$çš„å€æ•°ï¼Œå¯ä»¥è¡¨ç¤ºä¸º\n$$\na^{p} \\equiv a \\pmod p\n$$\nå½“aä¸æ˜¯pçš„å€æ•°æ—¶ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸º\n$$\na^{p-1} \\equiv 1 \\pmod p\n$$\n åŒä½™ç¬¦å·\nä¸¤ä¸ªæ•´æ•°aï¼Œbï¼Œè‹¥å®ƒä»¬é™¤ä»¥æ­£æ•´æ•°mæ‰€å¾—çš„ä½™æ•°ç›¸ç­‰ï¼Œåˆ™ç§°aï¼Œbå¯¹äºæ¨¡måŒä½™\nè®°ä½œ$a \\equiv b\\pmod {m}$\nè¯»ä½œaåŒä½™äºbæ¨¡mï¼Œæˆ–è¯»ä½œaä¸bå…³äºæ¨¡måŒä½™ã€‚\næ¯”å¦‚$26 \\equiv 14 \\pmod{12}$\n ä¸€ç§è¯æ˜ï¼š\nè€ƒè™‘ä¸€æ ¹æœ‰ [å…¬å¼] é¢—ç å­çš„é¡¹é“¾ï¼Œå…¶æ¯é¢—ç å­æœ‰ [å…¬å¼] ç§æŸ“è‰²é€‰æ‹©ï¼Œç„¶åç”±ä¸‹å›¾è•´å«çš„ç²¾ç¥å¯å¾—åŸå‘½é¢˜æˆç«‹ã€‚\nè´¹é©¬å¤§å®šç† å½“æ•´æ•°$n\u0026gt;2$æ—¶ï¼Œå…³äº$x, y, z$çš„ä¸å®šæ–¹ç¨‹\n$$\nx^{n} + y^{n} = z^{n}\n$$\næ²¡æœ‰æ•´æ•°è§£\n","description":"è´¹é©¬å¤§å®šç†ã€è´¹é©¬å°å®šç†","id":84,"section":"posts","tags":["è´¹é©¬"],"title":"è´¹é©¬ğŸ¦“å®šç†","uri":"https://hugo.jiahongw.com/zh/posts/math/feima/"},{"content":"æ“ä½œæµç¨‹ ç”¨åˆ°çš„äº‘äº§å“åŠæœåŠ¡            åºå· äº‘äº§å“ åŠŸèƒ½åŠç”¨é€” å¤‡æ³¨   1 å®¹å™¨é•œåƒä»“åº“ ç”¨äºå­˜æ”¾ç¤ºä¾‹demoé•œåƒ    2 äº‘ç¼–è¯‘ ç¼–è¯‘å’Œæ‰“åŒ…å®ä¾‹demoä»£ç ï¼ŒåŒæ—¶å°†é•œåƒæ¨é€è‡³å®¹å™¨é•œåƒä»“åº“    3 ç§æœ‰ç½‘ç»œ åˆ›å»ºç”¨äºKubernetesé›†ç¾¤ï¼Œå·¥ä½œèŠ‚ç‚¹æ‰€éœ€çš„VPC    4 Access Key æˆæƒK8Sé›†ç¾¤è®¿é—®äº¬ä¸œæ™ºè”äº‘å„ä¸ªæœåŠ¡APIçš„æˆæƒå‡­è¯ã€‚ ä¾‹å¦‚ï¼šé›†ç¾¤å‘äº¬ä¸œæ™ºè”äº‘ç›‘æ§ä¸­å¿ƒï¼Œæ¨é€ä¸šåŠ¡ç›‘æ§æ•°æ®å°±éœ€è¦ç”¨åˆ°AK/SKã€‚   5 Kubernetesé›†ç¾¤ åˆ›å»ºK8Sé›†ç¾¤ï¼Œéƒ¨ç½²åº”ç”¨æœåŠ¡ è§„æ ¼ï¼šé€šç”¨å‹1æ ¸4GBï¼Œå…¬ç½‘IP 5Mpbs   6 äº‘ç›‘æ§ æŸ¥è¯¢ä¸šåŠ¡ç›‘æ§æ•°æ®ï¼Œé…ç½®å‘Šè­¦æœåŠ¡ã€‚     å®æ“ ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡Dockeré•œåƒ åˆ›å»ºå®¹å™¨é•œåƒä»“åº“ æ–°å»ºæ³¨å†Œè¡¨\n  ç™»å½•äº¬ä¸œæ™ºè”äº‘æ§åˆ¶å°ï¼Œé€‰æ‹©äº‘æœåŠ¡-\u0026gt;å¼¹æ€§è®¡ç®—-\u0026gt;å®¹å™¨é•œåƒä»“åº“ã€‚\n  è¿›å…¥æ³¨å†Œè¡¨é¡µé¢ï¼Œé€‰æ‹©â€œååŒ—-åŒ—äº¬â€åœ°åŸŸï¼Œç‚¹å‡»â€œæ–°å»ºâ€æŒ‰é’®ï¼Œè¿›å…¥æ–°å»ºæ³¨å†Œè¡¨é¡µé¢ã€‚\n  åœ¨æ–°å»ºæ³¨å†Œè¡¨é¡µé¢ï¼Œè®¾ç½®åç§°ï¼Œå‹¾é€‰åŒæ„æœåŠ¡æ¡æ¬¾ã€‚ç‚¹å‡»â€œä¿å­˜â€æŒ‰é’®å³å¯ã€‚\n  æ–°å»ºé•œåƒä»“åº“\n  åˆ‡æ¢è‡³â€œé•œåƒä»“åº“â€åˆ—è¡¨é¡µé¢ï¼Œé€‰æ‹©åœ°åŸŸâ€œååŒ—-åŒ—äº¬â€ï¼Œç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ã€‚\n  åœ¨æ–°å»ºé•œåƒä»“åº“é¡µé¢ï¼Œ é€‰æ‹©åˆšæ–°å»ºçš„æ³¨å†Œè¡¨ï¼Œé…ç½®æ³¨å†Œè¡¨åç§°ä¿¡æ¯\n  åˆ›å»ºæˆåŠŸåï¼Œåœ¨é•œåƒä»“åº“é‡Œåˆ—è¡¨å¯ä»¥çœ‹åˆ°åˆ°ä»“åº“åç§°ã€‚ä»¥åŠé•œåƒä»“åº“çš„URI\n  ç¼–è¯‘æ„å»ºDockeré•œåƒ æ–°å»ºç¼–è¯‘ä»»åŠ¡\n  é€‰æ‹©äº‘æœåŠ¡-\u0026gt;å¼€å‘è€…å·¥å…·-\u0026gt;äº‘ç¼–è¯‘ï¼Œè¿›å…¥äº‘ç¼–è¯‘æœåŠ¡é¡µé¢ã€‚\n  åœ¨ä»»åŠ¡åˆ—è¡¨é¡µé¢ï¼Œé€‰æ‹©ååŒ—-åŒ—äº¬åœ°åŸŸï¼Œ ç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ï¼Œé€‰æ‹©ä¸­â€œåˆ›å»ºä»»åŠ¡â€\n  åœ¨åˆ›å»ºä»»åŠ¡é¡µé¢åšå¦‚ä¸‹é…ç½®ï¼š\nä»»åŠ¡é…ç½®ä¸æºç é…ç½®å¦‚ä¸‹ï¼Œå…¶ä¸­ä»£ç åº“åœ°å€ä¸º:https://code.jdcloud.com/jdcloud-monitor/prometheus-demo.git\næ„å»ºå­˜æ”¾çš„é…ç½®å¦‚ä¸‹ï¼š\nå…¶ä»–é€‰é¡¹ä¿æŒé»˜è®¤é…ç½®\n  ç‚¹å‡»â€œä¿å­˜â€æŒ‰é’®ï¼Œå®Œæˆä»»åŠ¡çš„åˆ›å»ºã€‚\n  æ„å»ºä»»åŠ¡\n  é€‰ä¸­åˆšåˆ›å»ºçš„ä»»åŠ¡ï¼Œç‚¹å‡»æ“ä½œäº†ä¸‹çš„æ‰§è¡Œæ„å»ºæŒ‰é’®ã€‚\n  åœ¨å¼¹å‡ºçš„æ„å»ºé¡µé¢ï¼Œé…ç½®å¦‚ä¸‹ä¿¡æ¯,å…¶ä¸­CommitIDä¸ºece523fc68cce1cd3d48b38fc07252f81ba2c44c\n  ç‚¹å‡»â€œç¡®å®šâ€æŒ‰é’®ï¼Œæ‰§è¡Œç¼–è¯‘æ„å»ºæ“ä½œã€‚å½“äº§ç‰©å½’æ¡£çŠ¶æ€å˜ä¸ºå®ŒæˆçŠ¶æ€æ—¶ï¼Œå®Œæˆæ„å»ºã€‚\n  ç¬¬äºŒæ­¥ï¼šç”¨K8Séƒ¨ç½²åº”ç”¨æœåŠ¡ å‰æå‡†å¤‡ åˆ›å»ºkubernetesè¿›ç¾¤æ—¶ï¼Œéœ€è¦ç”¨åˆ°VPC å’Œ å¯†é’¥ä¿¡æ¯ï¼Œ åªéœ€åˆ›å»ºVPCå³å¯ï¼Œæ— éœ€åˆ›å»ºå­ç½‘ï¼Œå·¥ä½œèŠ‚ç‚¹ç»„ç”¨åˆ°çš„å­ç½‘ä¼šè‡ªå·±åˆ›å»ºã€‚\nåˆ›å»ºVPC\n  é€‰æ‹©äº‘æœåŠ¡-\u0026gt;ç½‘ç»œ-\u0026gt;ç§æœ‰ç½‘ç»œï¼Œè¿›å…¥ç§æœ‰ç½‘ç»œVPCåˆ—è¡¨é¡µé¢ã€‚\n  åœ¨ç§æœ‰ç½‘ç»œé¡µé¢ï¼Œé€‰ä¸­ååŒ—-åŒ—äº¬åœ°åŸŸï¼Œç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ã€‚\n  é…ç½®ç½‘ç»œåç§°ï¼ŒIPv4CIRDé€‰æ‹© 192.168.0.0/16ã€‚\n  åˆ›å»ºAK/SKå¯†é’¥\n  ç‚¹å‡»é¡¶éƒ¨å¯¼èˆªçš„è´¦æˆ·åç§°ï¼Œåœ¨å¼¹å‡ºçš„ä¸‹æ‹‰æ¡†ä¸­ç‚¹å‡»â€œAccess Keyç®¡ç†â€\n  åœ¨è¿›å…¥çš„Access Keyç®¡ç†é¡µé¢ä¸­ï¼Œç‚¹å‡»â€œåˆ›å»ºAccess Keyâ€ï¼Œä¼šæç¤ºè¾“å…¥çŸ­ä¿¡éªŒè¯ç ï¼Œè¾“å…¥å®Œå°±å¯ä»¥åˆ›å»ºäº†\n  åˆ›å»ºKubernetesé›†ç¾¤   é€‰æ‹©äº‘æœåŠ¡-\u0026gt;å¼¹æ€§è®¡ç®—-\u0026gt; Kubernetesé›†ç¾¤ï¼Œè¿›å…¥é›†ç¾¤åˆ—è¡¨é¡µé¢ã€‚\n  é€‰æ‹©â€œååŒ—-åŒ—äº¬â€åœ°åŸŸï¼Œç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ï¼Œåœ¨æ–°å»ºKubernetesé›†ç¾¤ï¼Œè¿›è¡Œå¦‚ä¸‹é…ç½®\né›†ç¾¤ä¿¡æ¯é…ç½®\nç½‘ç»œä¸å·¥ä½œèŠ‚ç‚¹é…ç½®\nå¯†ç é…ç½®\n  éƒ¨ç½²æœåŠ¡ æ³¨å†Œé•œåƒä»“åº“\n æœ¬æ“ä½œæ˜¯å°†å®¹å™¨é•œåƒä»“åº“çš„æ³¨å†Œè¡¨åœ¨K8SæœåŠ¡ä¸­è¿›è¡Œæ³¨å†Œï¼Œä¾¿äºåç»­podä¸Šéƒ¨ç½²åº”ç”¨æœåŠ¡ã€‚\n   é€‰æ‹©äº‘æœåŠ¡-\u0026gt;å¼¹æ€§è®¡ç®—-\u0026gt; äº‘ä¸»æœºï¼Œè¿›å…¥äº‘ä¸»æœºåˆ—è¡¨é¡µé¢ã€‚åœ¨äº‘ä¸»æœºåˆ—è¡¨å¯ä»¥çœ‹åˆ°æ–°åˆ›å»ºäº†2å°äº‘ä¸»æœºå®ä¾‹ã€‚\n  æ‰¾åˆ°k8s-***-nat-vm-***å‘½åçš„äº‘ä¸»æœºï¼Œå…¶ä¸ºK8Sé›†ç¾¤çš„ç®¡ç†èŠ‚ç‚¹äº‘ä¸»æœºï¼Œ å¯ä»¥å…¬ç½‘SSHè¿œç¨‹ç™»å½•è¿›å»ã€‚\n  è·å–é›†ç¾¤å‡­æ®ï¼Œ é€‰æ‹©äº‘æœåŠ¡-\u0026gt;å¼¹æ€§è®¡ç®—-\u0026gt; Kubernetesé›†ç¾¤, è¿›å…¥é›†ç¾¤åˆ—è¡¨é¡µé¢ã€‚é€‰ä¸­åˆšåˆ›å»ºçš„é›†ç¾¤ä¿¡æ¯ï¼Œç‚¹å‡»åç§°ï¼Œè¿›å…¥è¯¦æƒ…é¡µé¢ã€‚åˆ‡æ¢è‡³kubectlå®¢æˆ·ç«¯é…ç½®é¡µã€‚\n  ç®¡ç†èŠ‚ç‚¹ç™»å½•æˆåŠŸåï¼Œssh ç™»å½•è‡³ k8s-node-*** èŠ‚ç‚¹çš„äº‘ä¸»æœºï¼ˆ**å‘½ä»¤ï¼š ssh root@your_node_ip, éœ€è¦å°† your_node_ip æ›¿æ¢ä¸ºä½ çš„nodeäº‘ä¸»æœºçš„å†…ç½‘ipã€‚ç‚¹å‡»å›è½¦åè¾“å…¥å¯†ç å³å¯** ï¼‰ã€‚\n  é…ç½®kubectlå®¢æˆ·ç«¯\næ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤\n1 2 3 4 5  mkdir -p $HOME/.kube cd $HOME/.kube vi config   å°†kubectlå®¢æˆ·ç«¯é…ç½®çš„å‡­æ®ï¼Œæ‹·è´è‡³configä¸­ï¼Œä¿å­˜åé€€å‡ºã€‚æ‰§è¡Œ sudo chown $(id -u):$(id -g) $HOME/.kube/config å‘½ä»¤ã€‚\n  æ‰§è¡Œä»¥ä¸‹æ“ä½œå‘½åï¼Œæ³¨å†Œé•œåƒä»“åº“ã€‚\nkubectl create secret -n default docker-registry my-secret --docker-server=k8s-monitor-demo01-cn-north-1.jcr.service.jdcloud.com --docker-username=jdcloud --docker-password=Eoj3Ja4mSeXasAbX --docker-email=1427298682@qq.com è¾“å…¥æŒ‡ä»¤å¦‚ä¸‹ï¼š\n  åˆ›å»ºPod\n  åœ¨kubernetesé›†ç¾¤é¡µé¢ï¼Œèœå•åˆ‡æ¢è‡³Workloads-\u0026gt;Podï¼Œè¿›å…¥Podåˆ—è¡¨é¡µé¢ã€‚ç‚¹å‡»åˆ›å»ºpod\n  é…ç½®å¦‚ä¸‹ä¿¡æ¯\na. é›†ç¾¤ï¼šè¯·ç¡®è®¤åˆšåˆ›å»ºçš„é›†ç¾¤ï¼Œä¾‹å¦‚ï¼šmonitor-demo\nb. Yaml æ–‡ä»¶ï¼šå°†å¦‚ä¸‹å†…å®¹æ‹·è´è‡³é»‘è‰²è¾“å…¥æ¡†ï¼Œæ³¨æ„é»„è‰²æ ‡æ³¨å†…å®¹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  apiVersion:v1kind:Podmetadata:name:prometheus-demolabels:app:prometheus-demospec:imagePullSecrets:- name:my-secretcontainers:- name:flaskapp-demoimage:k8s-monitor-demo01-cn-north-1.jcr.service.jdcloud.com/k8s-monitor-demo-repo:job-ANbzZdjyyYKEBRX-1587872493ports:- containerPort:5000- containerPort:7777   æ³¨æ„ï¼š\n  nameï¼šä¸ºæ‚¨æ³¨å†Œé•œåƒä»“åº“åˆ›å»ºçš„secretåç§°ï¼Œç¤ºä¾‹ç”¨çš„my-secretã€‚\n  image æ ‡æ³¨ä¸ºé»„è‰²çš„å†…å®¹åŒ…å«2ä¸ªéƒ¨åˆ†ï¼ŒURI:é•œåƒç‰ˆæœ¬ï¼Œè¯·ä¸€å®šè¦æ›¿æ¢ä¸ºè‡ªå·±é•œåƒä»“åº“çš„å†…å®¹ã€‚å¯é€šè¿‡å¦‚ä¸‹æˆªå›¾ä½ç½®è·å–ã€‚\n     åˆ›å»ºPod  å¯ä»¥çœ‹åˆ°åˆ›å»ºçš„podï¼Œè¿›å…¥podè¯¦æƒ…ï¼Œåˆ‡æ¢è‡³Containerå¯ä»¥æŸ¥çœ‹å…¶è¿è¡ŒçŠ¶æ€ï¼Œç­‰å¾…3åˆ†é’Ÿå·¦å³ï¼Œå…¶çŠ¶æ€å˜ä¸ºè¿è¡Œï¼ŒæœåŠ¡éƒ¨ç½²æˆåŠŸã€‚\n  é…ç½®è®¿é—®ç­–ç•¥ åˆ›å»ºService\n æ³¨ï¼šåŸºäºK8Séƒ¨ç½²çš„åº”ç”¨æœåŠ¡ï¼Œè‹¥éœ€è¦å¤–ç½‘è®¿é—®ï¼Œåˆ™éœ€è¦åˆ›å»ºä¸€ä¸ªè´Ÿè½½å‡è¡¡ï¼ŒåŒæ—¶ç»‘å®šå…¬ç½‘IPï¼Œä»¥ä¸‹æ­¥éª¤å°±æ˜¯é€šè¿‡åˆ›å»ºServiceä¸ºæœåŠ¡é…ç½®ä¸€ä¸ªè´Ÿè½½å‡è¡¡ã€‚\n   åˆ‡æ¢è‡³serviceåˆ—è¡¨é¡µé¢ï¼Œé€‰æ‹©â€œååŒ—-åŒ—äº¬â€ï¼Œç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ã€‚\n  è¿›å…¥åˆ›å»ºServiceé¡µé¢\né…ç½®å¦‚ä¸‹ä¿¡æ¯\na. é›†ç¾¤ï¼šç¡®è®¤é€‰ä¸­çš„é›†ç¾¤ã€‚\nb. Yamlï¼šå°†å¦‚ä¸‹ä¿¡æ¯æ‹·è´è‡³è¾“å…¥æ¡†ä¸­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  kind:ServiceapiVersion:v1metadata:name:prometheus-demoannotations:prometheus.io/path:/metricsprometheus.io/port:\u0026#39;7777\u0026#39;prometheus.io/scrape:\u0026#39;true\u0026#39;spec:ports:- protocol:TCPport:5000targetPort:5000selector:app:prometheus-demotype:LoadBalancer    ç‚¹å‡»â€œç¡®å®šâ€æŒ‰é’®ï¼Œå®Œæˆserviceåˆ›å»ºã€‚ç‚¹å‡»åç§°ï¼Œè¿›å…¥è¯¦æƒ…é¡µé¢ï¼Œå¯æŸ¥çœ‹åˆ°podçŠ¶æ€ä¸ºrunningã€‚\n  ç‚¹å‡»é¡¶éƒ¨å¯¼èˆªäº‘æœåŠ¡-\u0026gt;ç½‘ç»œ-\u0026gt;è´Ÿè½½å‡è¡¡ï¼Œè¿›å…¥åº”ç”¨è´Ÿè½½å‡è¡¡é¡µé¢ã€‚å¯ä»¥çœ‹åˆ°åˆšæ–°å»ºçš„çš„LoadBalancerã€‚\n  è®¿é—®æœåŠ¡\n  åœ¨æ–°å»ºçš„è´Ÿè½½å‡è¡¡æœåŠ¡é¡µé¢ï¼Œè·å–åˆ°å…¬ç½‘IPï¼Œ åœ¨æµè§ˆå™¨ç«¯è¾“å…¥http://å…¬ç½‘IP:5000ï¼Œå¯çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ã€‚\n  ç¬¬ä¸‰æ­¥ï¼šä¸šåŠ¡ç›‘æ§å‘Šè­¦ æŸ¥çœ‹ç›‘æ§å›¾   é€‰æ‹©äº‘æœåŠ¡-\u0026gt;ç›‘æ§ä¸è¿ç»´-\u0026gt; äº‘ç›‘æ§ï¼Œè¿›å…¥äº‘ç›‘æ§æ§åˆ¶å°ã€‚\n  åœ¨å·¦ä¾§èœå•é€‰ä¸­â€œè‡ªå®šä¹‰ç›‘æ§â€ï¼Œè¿›å…¥è‡ªå®šä¹‰ç›‘æ§é¡µé¢ã€‚\n   è¾“å…¥ä»¥ä¸‹æŸ¥è¯¢æ¡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°Demoç¤ºä¾‹å†…ç½®é‡‡é›†çš„ä¸€äº›ä¸šåŠ¡æ•°æ®ã€‚æŸ¥è¯¢æ¡ä»¶å¦‚ä¸‹ï¼š\n  é…ç½®å‘Šè­¦   åœ¨ä¸Šè¿°æŸ¥çœ‹çš„çš„ç›‘æ§å›¾ä¸­ï¼Œç‚¹å‡»â€œé…ç½®æŠ¥è­¦â€æŒ‰é’®ï¼Œè¿›å…¥è®¾ç½®å‘Šè­¦é¡µé¢ï¼Œè¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š\nåŸºæœ¬ä¿¡æ¯é…ç½®\nè§¦å‘æ¡ä»¶é…ç½®\né€šçŸ¥ç­–ç•¥é…ç½®\n  ä¸Šé¢é…ç½®å®Œä¹‹åå½“è®¿é—®é¡µé¢æ¬¡æ•°è¶…è¿‡10æ­¤çš„æ—¶å€™å°±ä¼šæœ‰é‚®ä»¶å’ŒçŸ­ä¿¡çš„é€šçŸ¥\né‚®ä»¶\nçŸ­ä¿¡\n","description":"","id":85,"section":"posts","tags":["äº‘è®¡ç®—","äº¬ä¸œäº‘"],"title":"ä½¿ç”¨äº‘ç›‘æ§ç®¡ç†k8s-äº¬ä¸œäº‘å®è·µ","uri":"https://hugo.jiahongw.com/zh/posts/cloudcomputing/cloud-kubernetes/"},{"content":"[toc]\n1. é²²é¹äº‘æœåŠ¡ é²²é¹å¤„ç†å™¨ä¸æœåŠ¡å™¨ é²²é¹å¤„ç†å™¨ åä¸ºé²²é¹å¤„ç†å™¨æ˜¯åä¸ºè‡ªä¸»ç ”å‘çš„åŸºäºARMæ¶æ„çš„ä¼ä¸šçº§ç³»åˆ—å¤„ç†å™¨äº§å“ï¼ŒåŒ…å«â€œç®—ã€å­˜ã€ä¼ ã€ç®¡ã€æ™ºâ€äº”ä¸ªäº§å“ç³»ç»Ÿä½“ç³»ã€‚\næ¶æ„ä»‹ç»ï¼š åä¸ºé²²é¹å¤„ç†å™¨åŸºäºARMæ¶æ„ã€‚ARMæ˜¯ä¸€ç§CPUæ¶æ„ï¼Œæœ‰åˆ«äºIntelã€AMD CPUé‡‡ç”¨çš„CISCå¤æ‚æŒ‡ä»¤é›†ï¼ŒARM CPUé‡‡ç”¨RISCç²¾ç®€æŒ‡ä»¤é›†ï¼ˆreduced instruction set computerï¼Œç²¾ç®€æŒ‡ä»¤é›†è®¡ç®—æœºï¼‰ã€‚\nå¤„ç†å™¨å¯¹æ¯”ï¼š\nä¼˜ç‚¹ï¼š  é‡‡ç”¨ARMæ¶æ„ï¼ŒåŒæ ·åŠŸèƒ½æ€§èƒ½å ç”¨çš„èŠ¯ç‰‡é¢ç§¯å°ã€åŠŸè€—ä½ã€é›†æˆåº¦æ›´é«˜ï¼Œæ›´å¤šçš„ç¡¬ä»¶CPUæ ¸å…·å¤‡æ›´å¥½çš„å¹¶å‘æ€§èƒ½ã€‚ æ”¯æŒ16ä½ã€32ä½ã€64ä½å¤šç§æŒ‡ä»¤é›†ï¼Œèƒ½å¾ˆå¥½çš„å…¼å®¹ä»IOTã€ç»ˆç«¯åˆ°äº‘ç«¯çš„å„ç±»åº”ç”¨åœºæ™¯ã€‚ å¤§é‡ä½¿ç”¨å¯„å­˜å™¨ï¼Œå¤§å¤šæ•°æ•°æ®æ“ä½œéƒ½åœ¨å¯„å­˜å™¨ä¸­å®Œæˆï¼ŒæŒ‡ä»¤æ‰§è¡Œé€Ÿåº¦æ›´å¿«ã€‚ é‡‡ç”¨RISCæŒ‡ä»¤é›†ï¼ŒæŒ‡ä»¤é•¿åº¦å›ºå®šï¼Œå¯»å€æ–¹å¼çµæ´»ç®€å•ï¼Œæ‰§è¡Œæ•ˆç‡é«˜ã€‚  è§„æ ¼å‘å±• åä¸ºé²²é¹920å¤„ç†å™¨è§„æ ¼ æŠ€æœ¯åˆ›æ–° å†…ç½®å¤šç§åŠ é€Ÿå¼•æ“ TaishanæœåŠ¡å™¨ ç³»åˆ— TaiShan 200æœºæ¶æœåŠ¡å™¨å…¨æ™¯å›¾ TaiShan 200é«˜å¯†æœåŠ¡å™¨ äº‘æœåŠ¡ äº‘è®¡ç®— ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ï¼ˆNISTï¼‰å®šä¹‰ï¼š\näº‘è®¡ç®—æ˜¯ä¸€ç§æ¨¡å‹ï¼Œå®ƒå¯ä»¥å®ç°éšæ—¶éšåœ°ï¼Œä¾¿æ·åœ°ï¼Œéšéœ€åº”å˜åœ°ä»å¯é…ç½®è®¡ç®—èµ„æºå…±äº«æ± ä¸­è·å–æ‰€éœ€çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç½‘ç»œã€æœåŠ¡å™¨ã€å­˜å‚¨ã€åº”ç”¨ã€åŠæœåŠ¡ï¼‰ï¼Œèµ„æºèƒ½å¤Ÿå¿«é€Ÿä¾›åº”å¹¶é‡Šæ”¾ï¼Œä½¿ç®¡ç†èµ„æºçš„å·¥ä½œé‡å’Œä¸æœåŠ¡æä¾›å•†çš„äº¤äº’å‡å°åˆ°æœ€ä½é™åº¦ã€‚\näº‘è®¡ç®—çš„ç‰¹ç‚¹:\n å¿«æ·çš„ç½‘ç»œè®¿é—® è‡ªæœåŠ¡å’Œéšéœ€åˆ†é… èµ„æºæ±  çµæ´»æœ‰å¼¹æ€§ æœåŠ¡å¯åº¦é‡  äº‘è®¡ç®—çš„æœ¬è´¨å°±æ˜¯è‡ªåŠ¨åŒ–å’Œè§„æ¨¡åŒ–åœ¨ITè¡Œä¸šçš„æœåŠ¡åŒ–ä½“ç°ï¼  äº‘æœåŠ¡å®ä¾‹ è€Œäº‘æœåŠ¡æ­£æ˜¯ç”±äºäº‘è®¡ç®—çš„å‘å±•è€Œå­•è‚²è€Œç”Ÿ,ä¸»è¦ä¾é äº‘è®¡ç®—çš„è™šæ‹ŸåŒ–æŠ€æœ¯.å°†æ‰€æœ‰çš„ç¡¬ä»¶èµ„æºè¿›è¡Œè®¡ç®—è™šæ‹ŸåŒ–å’Œå­˜å‚¨è™šæ‹ŸåŒ–,æœ€åå¾—åˆ°æˆ‘ä»¬çš„äº‘æœåŠ¡.\nä¸€ä¸ªç®€å•çš„ç½‘ç«™ä¾‹å­å¯ä»¥æ˜¯ä¸‹é¢è¿™å¼ å›¾:\nè®¡ç®—ç±»äº‘æœåŠ¡ è®¡ç®—ç±»äº‘æœåŠ¡æœ‰å¦‚ä¸‹è¿™ä¹ˆå¤šç§:\nECS-(å¼¹æ€§äº‘ä¸»æœº) å¼¹æ€§äº‘æœåŠ¡å™¨ï¼ˆ Elastic Cloud Server ï¼‰æ˜¯ä¸€ç§å¯éšæ—¶è‡ªåŠ©è·å–ã€å¯å¼¹æ€§ä¼¸ç¼©çš„äº‘æœåŠ¡å™¨ï¼Œå¸®åŠ©ç”¨æˆ·æ‰“é€ å¯é ã€å®‰å…¨ã€çµæ´»ã€é«˜æ•ˆçš„åº”ç”¨ç¯å¢ƒï¼Œç¡®ä¿æœåŠ¡æŒä¹…ç¨³å®šè¿è¡Œï¼Œæå‡è¿è¥æ•ˆç‡ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯,ECSä¸€èˆ¬è¦é…åˆç¡¬ç›˜ç³»ç»Ÿç›˜ã€æ•°æ®ç›˜ä»¥åŠVPCç­‰ç»„ä»¶è¿›è¡Œä½¿ç”¨.  å¦‚ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å¤šæ€ECSæœåŠ¡å™¨çš„æ‹“æ‰‘å›¾:\nBMSè£¸é‡‘å±æœåŠ¡å™¨ å¼¹æ€§è£¸é‡‘å±æœåŠ¡å™¨(Bare Metal Server)æœåŠ¡, ä¸ºç”¨æˆ·æä¾›ä¸“å±çš„ç‰©ç†æœåŠ¡å™¨ï¼Œæä¾›å“è¶Šçš„è®¡ç®—æ€§èƒ½ï¼Œæ»¡è¶³æ ¸å¿ƒåº”ç”¨åœºæ™¯å¯¹é«˜æ€§èƒ½åŠç¨³å®šæ€§çš„éœ€æ±‚ï¼Œç»“åˆäº†ä¼ ç»Ÿæ‰˜ç®¡æœåŠ¡å™¨å¸¦æ¥çš„ç¨³å®šæ€§èƒ½ä¸äº‘ä¸­èµ„æºé«˜åº¦å¼¹æ€§çš„ä¼˜åŠ¿ã€‚\nè¿™ä¸ªäº‘æœåŠ¡çš„åº”ç”¨åœºæ™¯ä¸»è¦é’ˆå¯¹éƒ¨ç½²åœ¨ç‰©ç†æœºä¸Šçš„åœºæ™¯.\nè§„æ ¼å’Œåœºæ™¯ï¼š\n è‡ªå¸¦SDIå¡ï¼Œå®ç°æ— ç³»ç»Ÿç›˜æŒ‚è½½çš„æŠ€æœ¯ã€‚\n IMSé•œåƒæœåŠ¡ é•œåƒæ˜¯ç”±åŸºç¡€æ“ä½œç³»ç»Ÿã€é¢„è£…çš„å…¬å…±åº”ç”¨ä»¥åŠç”¨æˆ·ç§æœ‰åº”ç”¨ç»„æˆçš„æ¨¡æ¿ï¼Œä¾¿äºç”¨æˆ·æ‰¹é‡å‘æ”¾å¼¹æ€§äº‘ä¸»æœºæˆ–è£¸é‡‘å±æœåŠ¡å™¨ã€‚\næœ‰äº†é•œåƒä¹‹å,å°±ç›¸å½“äºæœ‰äº†ä¸€ä¸ªå½“å‰ç³»ç»Ÿçš„å¤‡ä»½,å¯ä»¥å¤åˆ¶åˆ°å…¶ä»–äº‘æœåŠ¡å™¨ä¸Š,å‡å°‘é…ç½®çš„æ—¶è€—.  é•œåƒæœåŠ¡æä¾›é•œåƒç”Ÿå‘½å‘¨æœŸç®¡ç†èƒ½åŠ›ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æœåŠ¡å™¨æˆ–å¤–éƒ¨æ–‡ä»¶åˆ›å»ºç³»ç»Ÿç›˜é•œåƒæˆ–æ•°æ®ç›˜é•œåƒï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¼¹æ€§äº‘æœåŠ¡å™¨æˆ–äº‘æœåŠ¡å™¨å¤‡ä»½åˆ›å»ºå¸¦æ•°æ®ç›˜çš„æ•´æœºé•œåƒã€‚å¹¶å¯¹é•œåƒè¿›è¡Œä¿®æ”¹ï¼Œå…±äº«ï¼ŒåŠ å¯†ï¼Œå¤åˆ¶ï¼Œå¯¼å‡ºï¼Œæ ‡ç­¾ç®¡ç†ï¼Œä¼ä¸šå¤šé¡¹ç›®ç®¡ç†ï¼Œå‘å¸ƒå¸‚åœºé•œåƒç­‰æ“ä½œã€‚\nASå¼¹æ€§ä¼¸ç¼©æœåŠ¡ å¼¹æ€§ä¼¸ç¼©ï¼ˆAuto Scalingï¼‰å¯æ ¹æ®ç”¨æˆ·çš„ä¸šåŠ¡éœ€æ±‚å’Œé¢„è®¾ç­–ç•¥ï¼Œè‡ªåŠ¨è°ƒæ•´è®¡ç®—èµ„æºæˆ–å¼¹æ€§IPèµ„æºï¼Œä½¿äº‘æœåŠ¡å™¨æ•°é‡æˆ–å¼¹æ€§IPå¸¦å®½è‡ªåŠ¨éšä¸šåŠ¡è´Ÿè½½å¢é•¿è€Œå¢åŠ ï¼Œéšä¸šåŠ¡è´Ÿè½½é™ä½è€Œå‡å°‘ï¼ŒèŠ‚çœäº‘ä¸Šä¸šåŠ¡èµ„è´¹ï¼Œä¿è¯ä¸šåŠ¡å¹³ç¨³å¥åº·è¿è¡Œ.\nåº”ç”¨åœºæ™¯ä¸»è¦æœ‰:\n ä¼ä¸šç½‘ç«™ã€ç”µå•†ã€ç§»åŠ¨åº”ç”¨ç­‰ï¼Œä¸šåŠ¡ç‰¹ç‚¹ï¼šä¸šåŠ¡è¯·æ±‚æœ‰çªå‘å¼æš´å¢æˆ–è€…è®¿é—®é‡èµ·ä¼ä¸å®š è§†é¢‘ç½‘ç«™ã€åª’ä½“ç¼–è§£ç åº”ç”¨ã€åª’ä½“å†…å®¹å›ä¼ åº”ç”¨ã€é«˜æµé‡å†…å®¹ç®¡ç†ç³»ç»Ÿã€åˆ†å¸ƒå¼é«˜é€Ÿç¼“å­˜ç³»ç»Ÿ,ä¸šåŠ¡ç‰¹ç‚¹:éœ€è¦æ ¹æ®è®¡ç®—é‡åŠ¨æ€è°ƒæ•´è®¡ç®—ã€ç½‘ç»œç­‰èµ„æº  ASæœåŠ¡ä¸€èˆ¬é…åˆè´Ÿè½½å‡è¡¡(ELB)ä¸€èµ·ä½¿ç”¨,ä¾‹å¦‚:\n ASç³»ç»Ÿæ¶æ„å¦‚ä¸‹:\näº‘å®¹å™¨æœåŠ¡ CCE(äº‘å®¹å™¨å¼•æ“)\näº‘å®¹å™¨å¼•æ“ï¼ˆCloud Container Engineï¼Œç®€ç§°CCEï¼‰æä¾›é«˜åº¦å¯æ‰©å±•çš„ã€é«˜æ€§èƒ½çš„ä¼ä¸šçº§Kubernetesé›†ç¾¤ï¼Œæ”¯æŒè¿è¡ŒDockerå®¹å™¨ã€‚å€ŸåŠ©äº‘å®¹å™¨å¼•æ“ï¼Œæ‚¨å¯ä»¥åœ¨äº‘ä¸Šè½»æ¾éƒ¨ç½²ã€ç®¡ç†å’Œæ‰©å±•å®¹å™¨åŒ–åº”ç”¨ç¨‹åºã€‚\nå®ç”¨å®ä¾‹ï¼š\nä¼˜ç‚¹ï¼š\n å¤šå¹³å°æ··åˆéƒ¨ç½² è·¨äº‘ç®¡ç† ä¸€é”®å¼äº¤ä»˜ é«˜æ€§èƒ½  CCI(äº‘å®¹å™¨å®ä¾‹)\näº‘å®¹å™¨å®ä¾‹ï¼ˆCloud Container Instanceï¼Œ CCIï¼‰æœåŠ¡æä¾› Serverless Containerï¼ˆæ— æœåŠ¡å™¨å®¹å™¨ï¼‰å¼•æ“ï¼Œè®©æ‚¨æ— éœ€åˆ›å»ºå’Œç®¡ç†æœåŠ¡å™¨é›†ç¾¤å³å¯ç›´æ¥è¿è¡Œå®¹å™¨ã€‚\nä½¿ç”¨äº‘å®¹å™¨å®ä¾‹\nä¼˜ç‚¹\n å…è¿ç»´ é«˜å®‰å…¨ æè‡´æ€§èƒ½ ç§’çº§ä»˜è´¹ å¼€æ”¾ç”Ÿæ€ æé€Ÿå¼¹æ€§  äº‘å®¹å™¨ç‰¹æ€§\næœåŠ¡æ€»è§ˆ\nå­˜å‚¨ç±»äº‘æœåŠ¡ å­˜å‚¨ç±»äº‘æœåŠ¡ä¸»è¦åˆ†ä¸ºå¦‚ä¸‹ä¸‰ç§:\näº‘ç¡¬ç›˜EVS äº‘ç¡¬ç›˜ï¼ˆElastic Volume Serviceï¼‰æ˜¯ä¸€ç§ä¸ºECSã€BMSç­‰è®¡ç®—æœåŠ¡æä¾›æŒä¹…æ€§å—å­˜å‚¨çš„æœåŠ¡ï¼Œé€šè¿‡æ•°æ®å†—ä½™å’Œç¼“å­˜åŠ é€Ÿç­‰å¤šé¡¹æŠ€æœ¯ï¼Œæä¾›é«˜å¯ç”¨æ€§å’ŒæŒä¹…æ€§ï¼Œä»¥åŠç¨³å®šçš„ä½æ—¶å»¶æ€§èƒ½ã€‚æ‚¨å¯ä»¥å¯¹äº‘ç¡¬ç›˜åšæ ¼å¼åŒ–ã€åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿç­‰æ“ä½œï¼Œå¹¶å¯¹æ•°æ®åšæŒä¹…åŒ–å­˜å‚¨ã€‚äº‘ç¡¬ç›˜æä¾›å¤šç§æ€§èƒ½è§„æ ¼ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®ä¸åŒä¸šåŠ¡åœºæ™¯æŒ‰éœ€ã€çµæ´»é…ç½®ã€‚\nä½¿ç”¨å›¾è§£:\nç›¸å½“äºåœ¨äº‘ä¸Šçš„ç¡¬ç›˜.\nå¯¹è±¡å­˜å‚¨æœåŠ¡OBS å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆOBSï¼‰æ˜¯ä¸€ä¸ªåŸºäºå¯¹è±¡çš„æµ·é‡å­˜å‚¨æœåŠ¡ï¼Œä¸ºæ‚¨æä¾›æµ·é‡ã€ä½æˆæœ¬ã€é«˜å¯é ã€å®‰å…¨çš„æ•°æ®å­˜å‚¨èƒ½åŠ›ã€‚\nå›¾è§£å¦‚ä¸‹:\nå¼¹æ€§æ–‡ä»¶æœåŠ¡SFSå’ŒSFS å¼¹æ€§æ–‡ä»¶æœåŠ¡ï¼ˆScalable File Serviceï¼‰ä¸ºç”¨æˆ·çš„å¼¹æ€§äº‘æœåŠ¡å™¨ï¼ˆECSï¼‰æä¾›ä¸€ä¸ªå®Œå…¨æ‰˜ç®¡çš„å…±äº«æ–‡ä»¶å­˜å‚¨ï¼Œç¬¦åˆæ ‡å‡†æ–‡ä»¶åè®®ï¼ˆNFSï¼‰ï¼Œèƒ½å¤Ÿå¼¹æ€§ä¼¸ç¼©è‡³PBè§„æ¨¡ï¼ˆSFS Turboæœ€å¤§320TBï¼‰ï¼Œå…·å¤‡å¯æ‰©å±•çš„æ€§èƒ½ï¼Œä¸ºæµ·é‡æ•°æ®ã€é«˜å¸¦å®½å‹åº”ç”¨æä¾›æœ‰åŠ›æ”¯æŒã€‚\näº‘å¤‡ä»½æœåŠ¡ æœ€ç®€å•çš„å¤‡ä»½æœåŠ¡ï¼Œå¯å°†äº‘æœåŠ¡å™¨æ•°æ®æ¢å¤åˆ°ä»»æ„å¤‡ä»½ç‚¹,ä¾‹å¦‚:\nSDRS å­˜å‚¨å®¹ç¾æœåŠ¡ å­˜å‚¨å®¹ç¾æœåŠ¡ï¼ˆStorage Disaster Recovery Serviceï¼Œç®€ç§°SDRSï¼‰æ˜¯ä¸€ç§æœåŠ¡åŒ–å®¹ç¾æ–¹æ¡ˆï¼Œå¯å¤§å¹…é™ä½ä¼ä¸šå®¹ç¾TCOã€‚é€šè¿‡ç®€å•ä¸‰æ­¥æ“ä½œï¼ˆåˆ›å»ºä¿æŠ¤ç»„ã€åˆ›å»ºä¿æŠ¤å®ä¾‹ã€å¼€å¯ä¿æŠ¤ï¼‰å³å¯ä¸ºäº‘ä¸Šè™šæ‹Ÿæœºæä¾›è·¨å¯ç”¨åŒºçº§åˆ«çš„å®¹ç¾ä¿æŠ¤ï¼Œç¡®ä¿æ•°æ®é›¶ä¸¢å¤±ï¼ˆRPO=0ï¼‰ï¼Œå¹¶å¯åœ¨ç¾éš¾å‘ç”Ÿæ—¶è¿…é€Ÿæ¢å¤ä¸šåŠ¡ï¼Œå‡å°‘æŸå¤±ã€‚\nç®€å•ä¾‹å­:\nç½‘ç»œç±»äº‘æœåŠ¡ ä¸»è¦æœ‰å¦‚ä¸‹å‡ ç§:\nVPCè™šæ‹Ÿç§æœ‰äº‘æœåŠ¡ è™šæ‹Ÿç§æœ‰äº‘ï¼ˆVirtual Private Cloud): ç”¨æˆ·åœ¨åä¸ºäº‘ä¸Šç”³è¯·çš„éš”ç¦»çš„ã€ç§å¯†çš„è™šæ‹Ÿç½‘ç»œç¯å¢ƒã€‚ç”¨æˆ·å¯ä»¥è‡ªç”±é…ç½®VPCå†…çš„IPåœ°å€æ®µã€å­ç½‘ã€å®‰å…¨ç»„ç­‰å­æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ç”³è¯·å¼¹æ€§å…¬ç½‘IPå’Œå¸¦å®½æ­å»ºé¢å‘Internetçš„ä¸šåŠ¡ç³»ç»Ÿã€‚\nä¸»è¦åŒ…æ‹¬å¦‚ä¸‹å››ä¸ªæ–¹å‘å†…å®¹:\nå¼¹æ€§å…¬ç½‘IP å¼¹æ€§å…¬ç½‘IPï¼ˆElastic IPï¼‰æä¾›ç‹¬ç«‹çš„å…¬ç½‘IPèµ„æºï¼ŒåŒ…æ‹¬å…¬ç½‘IPåœ°å€ä¸å…¬ç½‘å‡ºå£å¸¦å®½æœåŠ¡ã€‚å¯ä»¥ä¸å¼¹æ€§äº‘æœåŠ¡å™¨ã€è£¸é‡‘å±æœåŠ¡å™¨ã€è™šæ‹ŸIPã€å¼¹æ€§è´Ÿè½½å‡è¡¡ã€NATç½‘å…³ç­‰èµ„æºçµæ´»åœ°ç»‘å®šåŠè§£ç»‘ã€‚\n ç®€å•æ¥è¯´,å°±æ˜¯å¤–ç•Œå¯ä»¥è®¿é—®çš„ipåœ°å€.å¹¶ä¸”æ˜¯å…¶ä»–åŠŸèƒ½çš„ä¾èµ–.\n ä½¿ç”¨æ¨¡å‹ï¼š\nNATç½‘å…³æœåŠ¡ NATç½‘å…³ï¼ˆNAT Gatewayï¼‰èƒ½å¤Ÿä¸ºVPCå†…çš„å¼¹æ€§äº‘æœåŠ¡å™¨æä¾›SNATå’ŒDNATåŠŸèƒ½ï¼Œé€šè¿‡çµæ´»ç®€æ˜“çš„é…ç½®ï¼Œå³å¯è½»æ¾æ„å»ºVPCçš„å…¬ç½‘å‡ºå…¥å£\n SNATå’ŒDNATåˆ†åˆ«ä¸ºæºåœ°å€è½¬æ¢å’Œç›®çš„åœ°å€è½¬æ¢ã€‚\nSNATæ¶æ„ï¼š\nDNATæ¶æ„ï¼š\n ä½¿ç”¨NATè¿™ä¸ªåŠŸèƒ½ä¸»è¦æ˜¯ä¸ºäº†èŠ‚çœå¼¹æ€§å…¬ç½‘IPèµ„æºå¹¶ä¸”é¿å…äº‘ä¸»æœºIPç›´æ¥æš´éœ²åœ¨å…¬ç½‘ä¸Šã€‚\nè™šæ‹Ÿä¸“ç”¨ç½‘ç»œ VPN è™šæ‹Ÿä¸“ç”¨ç½‘ç»œï¼ˆVirtual Private Networkï¼‰ç”¨äºæ­å»ºç”¨æˆ·æœ¬åœ°æ•°æ®ä¸­å¿ƒä¸åä¸ºäº‘VPCä¹‹é—´ä¾¿æ·ã€çµæ´»ï¼Œå³å¼€å³ç”¨çš„IPsecåŠ å¯†è¿æ¥é€šé“ï¼Œå®ç°çµæ´»ä¸€ä½“ï¼Œå¯ä¼¸ç¼©çš„æ··åˆäº‘è®¡ç®—ç¯å¢ƒ\n ä¸»è¦é¢å‘çš„æ˜¯ä¼ä¸šç”¨æˆ·ã€‚\n æ»¡è¶³éœ€æ±‚ï¼š\n æ··åˆäº‘éƒ¨ç½² è·¨åœ°åŸŸVPC äº’è”  äº‘ä¸“çº¿ DC äº‘ä¸“çº¿ï¼ˆDirect Connectï¼‰ç”¨äºæ­å»ºç”¨æˆ·æœ¬åœ°æ•°æ®ä¸­å¿ƒä¸åä¸ºäº‘VPCä¹‹é—´é«˜é€Ÿã€ä½æ—¶å»¶ã€ç¨³å®šå®‰å…¨çš„ä¸“å±è¿æ¥é€šé“ï¼Œå……åˆ†åˆ©ç”¨åä¸ºäº‘æœåŠ¡ä¼˜åŠ¿çš„åŒæ—¶ï¼Œç»§ç»­ä½¿ç”¨ç°æœ‰çš„ITè®¾æ–½ï¼Œå®ç°çµæ´»ä¸€ä½“ï¼Œå¯ä¼¸ç¼©çš„æ··åˆäº‘è®¡ç®—ç¯å¢ƒ\nåº”ç”¨åœºæ™¯ï¼š\n æ··åˆäº‘éƒ¨ç½² å¼‚åœ°å®¹ç¾  å¼¹æ€§è´Ÿè½½å‡è¡¡æœåŠ¡ELB å¼¹æ€§è´Ÿè½½å‡è¡¡ï¼ˆElastic Load Balanceï¼Œç®€ç§°ELBï¼‰æ˜¯å°†è®¿é—®æµé‡æ ¹æ®è½¬å‘ç­–ç•¥åˆ†å‘åˆ°åç«¯å¤šå°å¼¹æ€§äº‘æœåŠ¡å™¨çš„æµé‡åˆ†å‘æ§åˆ¶æœåŠ¡ã€‚å¼¹æ€§è´Ÿè½½å‡è¡¡å¯ä»¥é€šè¿‡æµé‡åˆ†å‘æ‰©å±•åº”ç”¨ç³»ç»Ÿå¯¹å¤–çš„æœåŠ¡èƒ½åŠ›ï¼Œæé«˜åº”ç”¨ç¨‹åºçš„å®¹é”™èƒ½åŠ›ã€‚\nç®€å•æ¥è¯´ï¼ŒELBå°±æ˜¯ç”¨æ¥å¤„ç†å¤šç”¨æˆ·è¿æ¥æ—¶å€™çš„èµ„æºç¼ºä¹çš„ï¼Œä¸´æ—¶åˆ¶é€ å¤šä¸ªå‰¯æœ¬æ¥ç¼“è§£å‹åŠ›ã€‚åº”ç”¨åœºæ™¯æœ‰ï¼šå¤§å‹é—¨æˆ·ç½‘ç«™ã€è·¨å¯ç”¨åŒºåŒåŸå®¹ç¾ã€ç”µå•†æŠ¢è´­ã€‚\nPPT  2. é²²é¹åº”ç”¨ç§»æ¤ ä¸¤ç§è¯­è¨€ 1. ç¼–è¯‘å‹è¯­è¨€ 2. è§£é‡Šå‹è¯­è¨€ ç­–ç•¥ è¿ç§»è¿‡ç¨‹ è¿ç§»å·¥å…· åä¸ºé²²é¹ä»£ç è¿ç§»å·¥å…·ä¸»è¦é¢å‘é²²é¹å¹³å°çš„å¼€å‘è€…ã€ç”¨æˆ·å’Œç¬¬ä¸‰æ–¹å¾…ç§»æ¤è½¯ä»¶æä¾›æ–¹å¼€å‘å·¥ç¨‹å¸ˆï¼Œç”¨æ¥åˆ†æå¾…ç§»æ¤è½¯ä»¶æºç æ–‡ä»¶ï¼Œå¹¶ç»™å‡ºä»£ç ç§»æ¤æŒ‡å¯¼æŠ¥å‘Šï¼ŒåŒæ—¶èƒ½å¤Ÿè‡ªåŠ¨åˆ†æå‡ºéœ€ä¿®æ”¹çš„ä»£ç å†…å®¹ï¼Œå¹¶æŒ‡å¯¼å¦‚ä½•ä¿®æ”¹ï¼Œå¸®åŠ©ç”¨æˆ·é¡ºåˆ©å®Œæˆåº”ç”¨ä»x86å¹³å°å‘é²²é¹å¹³å°çš„ç§»æ¤ã€‚\né€»è¾‘æ¶æ„ å®¹å™¨è¿ç§» å®¹å™¨æ˜¯ä¸€ç§è½»é‡çº§ã€å¯ç§»æ¤ã€è‡ªåŒ…å«çš„è½¯ä»¶æ‰“åŒ…æŠ€æœ¯ï¼Œä½¿åº”ç”¨ç¨‹åºå¯ä»¥åœ¨å‡ ä¹ä»»ä½•åœ°æ–¹ä»¥ç›¸åŒçš„æ–¹å¼è¿è¡Œã€‚å¼€å‘äººå‘˜åœ¨è‡ªå·±ç¬”è®°æœ¬ä¸Šåˆ›å»ºå¹¶æµ‹è¯•å¥½çš„å®¹å™¨ï¼Œæ— éœ€ä»»ä½•ä¿®æ”¹å°±èƒ½å¤Ÿåœ¨ç”Ÿäº§ç³»ç»Ÿçš„è™šæ‹Ÿæœºã€ç‰©ç†æœåŠ¡å™¨æˆ–å…¬æœ‰äº‘ä¸»æœºä¸Šè¿è¡Œã€‚\nå®¹å™¨ä¸è™šæ‹Ÿæœºçš„ä¸åŒ å‰æ è·¨å¹³å°çš„å®¹å™¨æ— æ³•è¿è¡Œï¼Œä¼šå‡ºç°æ ¼å¼é”™è¯¯\n x86å¹³å°è·å–çš„é•œåƒæ˜¯é€‚ç”¨äºx86å¹³å°ï¼Œå½“è¿ç§»åˆ°é²²é¹å¹³å°ï¼Œå®¹å™¨æ— æ³•æ‰§è¡Œã€‚ åœ¨åŸºäºARMçš„å¹³å°ä¸­ï¼Œdocker pullæ–¹å¼æˆ–è€…Dockerfileæ–¹å¼è·å–æˆ–è€…æ„å»ºçš„é•œåƒå‡ä¸ºåŸºäºARMå¹³å°çš„ï¼ŒåŒæ ·ä¹Ÿæ— æ³•åœ¨x86ä¸Šè¿è¡Œã€‚  å®¹å™¨è¿ç§»çš„åŸç† è¿ç§»å®¹å™¨åŒæ—¶æ¶‰åŠåˆ°ä¸¤ä¸ªæ“ä½œï¼Œå¤‡ä»½å’Œæ¢å¤ã€‚æˆ‘ä»¬å¯ä»¥å°†ä»»ä½•ä¸€ä¸ªDockerå®¹å™¨ä»ä¸€å°æœºå™¨è¿ç§»åˆ°å¦ä¸€å°æœºå™¨ã€‚åœ¨è¿ç§»è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆæˆ‘ä»¬å°†æŠŠå®¹å™¨å¤‡ä»½ä¸ºDockeré•œåƒå¿«ç…§ã€‚ç„¶åï¼Œè¯¥Dockeré•œåƒæˆ–è€…æ˜¯è¢«æ¨é€åˆ°äº†Dockeræ³¨å†Œä¸­å¿ƒï¼Œæˆ–è€…è¢«ä½œä¸ºtaråŒ…æ–‡ä»¶ä¿å­˜åˆ°äº†æœ¬åœ°ã€‚å¦‚æœæˆ‘ä»¬å°†é•œåƒæ¨é€åˆ°äº†Dockeræ³¨å†Œä¸­å¿ƒï¼Œæˆ‘ä»¬ç®€å•åœ°ä»ä»»ä½•æˆ‘ä»¬æƒ³è¦çš„æœºå™¨ä¸Šä½¿ç”¨ docker run å‘½ä»¤æ¥æ¢å¤å¹¶è¿è¡Œè¯¥å®¹å™¨ï¼Œæˆ–è€…é€šè¿‡docker pullå‘½ä»¤æ‹‰å–æˆ‘ä»¬æƒ³è¦çš„é•œåƒã€‚\nè¿ç§»ç­–ç•¥ Dockerå®¹å™¨è¿ç§»æœ‰ä¸¤ç§ç­–ç•¥ï¼šä½¿ç”¨Docker pullè·å–é•œåƒæˆ–ä½¿ç”¨Dockerfileæ„å»ºé•œåƒã€‚\nä¸»è¦æµç¨‹  Dockerå®‰è£… Dockeræ„å»ºåŸºç¡€é•œåƒ Dockerfileåˆ›å»ºåº”ç”¨é•œåƒ éªŒè¯åº”ç”¨é•œåƒ  æ€§èƒ½è°ƒä¼˜ æ€§èƒ½è°ƒä¼˜å°±æ˜¯å¯¹è®¡ç®—æœºç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºæœ‰ç›¸å½“æ·±å…¥çš„äº†è§£ï¼Œè°ƒèŠ‚ä¸‰è€…ä¹‹é—´çš„å…³ç³»ï¼Œå®ç°æ•´ä¸ªç³»ç»Ÿï¼ˆåŒ…æ‹¬ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿã€åº”ç”¨ç¨‹åºï¼‰çš„æ€§èƒ½æœ€å¤§åŒ–ï¼Œå¹¶èƒ½ä¸æ–­åœ°æ»¡è¶³ç°æœ‰çš„ä¸šåŠ¡éœ€æ±‚ã€‚\nåä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…· ä¸ºè§£å†³å®¢æˆ·è½¯ä»¶è¿è¡Œé‡åˆ°æ€§èƒ½é—®é¢˜æ—¶å‡­äººå·¥ç»éªŒå®šä½å›°éš¾ã€è°ƒä¼˜èƒ½åŠ›å¼±çš„ç—›ç‚¹ï¼Œåä¸ºæ¨å‡ºäº†Kunpeng Tuning Kité²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·ã€‚\nåä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·ä¸»è¦é¢å‘åä¸ºFAEã€å¼€æ”¾å®éªŒå®¤èƒ½åŠ›å»ºè®¾å·¥ç¨‹å¸ˆæˆ–å®¢æˆ·å·¥ç¨‹å¸ˆï¼Œé’ˆå¯¹åº”ç”¨ç¨‹åºéƒ¨ç½²åœ¨TaiShanæœåŠ¡å™¨çš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡æ”¶é›†æœåŠ¡å™¨çš„å¤„ç†å™¨ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿã€è¿›ç¨‹/çº¿ç¨‹ã€å‡½æ•°ç­‰å„å±‚æ¬¡çš„æ€§èƒ½æ•°æ®ï¼Œåˆ†æå‡ºç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡ï¼Œå®šä½åˆ°ç“¶é¢ˆç‚¹åŠçƒ­ç‚¹å‡½æ•°ã€‚\nåä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·åŠŸèƒ½ç‰¹æ€§  æ”¯æŒé‡‡é›†æ•´ä¸ªç³»ç»Ÿæˆ–æŒ‡å®šè¿›ç¨‹çš„CPU Cyclesæ€§èƒ½äº‹ä»¶ï¼Œèƒ½å¤Ÿå¿«é€Ÿå®šä½çƒ­ç‚¹å‡½æ•°ã€‚ æ”¯æŒçƒ­ç‚¹å‡½æ•°æŒ‰ç…§CPUæ ¸/çº¿ç¨‹/æ¨¡å—è¿›è¡Œåˆ†ç»„ï¼Œæ”¯æŒæŸ¥çœ‹çƒ­ç‚¹å‡½æ•°è°ƒç”¨æ ˆã€‚ æ”¯æŒé€šè¿‡ç«ç„°å›¾æŸ¥çœ‹çƒ­ç‚¹å‡½æ•°åŠå…¶è°ƒç”¨æ ˆã€‚ æ”¯æŒä»£ç æ˜ å°„åŠŸèƒ½ï¼Œå³æŸ¥çœ‹å‡½æ•°å†…çš„çƒ­ç‚¹æŒ‡ä»¤åŠè¯¥æŒ‡ä»¤å¯¹åº”çš„é«˜çº§è¯­è¨€æ–‡ä»¶åŠè¡Œå·ã€‚ æ”¯æŒæ˜¾ç¤ºæ±‡ç¼–ä»£ç çš„æ§åˆ¶æµå›¾ã€‚ æ”¯æŒåˆ†æJavaä»£ç çš„çƒ­ç‚¹å‡½æ•°åŠçƒ­ç‚¹æŒ‡ä»¤ã€‚  åä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·é€»è¾‘æ¶æ„ ä¸»è¦åˆ†ä¸ºAnalysiså’ŒAgentä¸¤ä¸ªæ¨¡å—ã€‚\nå­æ¨¡å— Analysiså­æ¨¡å—\nAgentå­æ¨¡å—\néƒ¨ç½²æ–¹å¼ å½“å‰ç‰ˆæœ¬åªæ”¯æŒå•æœºéƒ¨ç½²ï¼Œå³å°†åä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·æ‰€æœ‰ç»„ä»¶éƒ¨ç½²åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå®Œæˆå¯¹è¯¥å°æœåŠ¡å™¨è½¯ä»¶çš„æ€§èƒ½æ•°æ®é‡‡é›†å’Œåˆ†æã€‚\nå¦‚ä»¥ä¸‹ç¤ºä¾‹å›¾ï¼š\n éƒ¨ç½²ç¯å¢ƒè¦æ±‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š\n éƒ¨ç½²åè®¿é—®æ–¹å¼  åä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·éƒ¨ç½²åœ¨TaiShanæœåŠ¡å™¨ä¸Šï¼Œè¯¥æœåŠ¡å™¨ä¸ŠåŒæ—¶è¿è¡Œå®¢æˆ·çš„åº”ç”¨è½¯ä»¶ã€‚ åä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·æä¾›Webç•Œé¢è®¿é—®æ–¹å¼ï¼Œç”¨æˆ·åªéœ€è¦åœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥ï¼šhttps:// éƒ¨ç½²æœåŠ¡å™¨çš„IP:ç«¯å£å· å³å¯ã€‚  è®¿é—®Webç•Œé¢æ—¶ï¼Œå¯¹æœ¬åœ°æµè§ˆå™¨çš„è¦æ±‚å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚\nä¼˜åŒ–å·¥å…·ä¸šåŠ¡æµç¨‹ C/C++ç¨‹åºæ€§èƒ½åˆ†æå’Œä¼˜åŒ– Java Mixed-Modeç¨‹åºæ€§èƒ½åˆ†æå’Œä¼˜åŒ– 3. å®¹ç¾å¤‡ä»½å®‰å…¨ äº‘æ¶æ„ åŸºç¡€æ¶æ„ï¼š\nå®‰å…¨æ¶æ„ï¼š\nä¼ä¸šä¸»æœºå®‰å…¨ï¼ˆHSSï¼‰ ä¼ä¸šä¸»æœºå®‰å…¨ï¼ˆHost Security Serviceï¼‰æ˜¯æå‡ä¸»æœºæ•´ä½“å®‰å…¨æ€§çš„æœåŠ¡ï¼ŒåŒ…æ‹¬è´¦æˆ·ç ´è§£é˜²æŠ¤ã€å¼±å£ä»¤æ£€æµ‹ã€æ¶æ„ç¨‹åºæ£€æµ‹ã€åŒå› å­è®¤è¯ã€æ¼æ´ç®¡ç†ï¼Œç½‘é¡µé˜²ç¯¡æ”¹ç­‰åŠŸèƒ½ï¼Œå¸®åŠ©ä¼ä¸šæ„å»ºæœåŠ¡å™¨å®‰å…¨é˜²æŠ¤ä½“ç³»ï¼Œé™ä½å½“å‰æœåŠ¡å™¨é¢ä¸´çš„ä¸»è¦å®‰å…¨é£é™©\nWAFï¼šæœ€å¸¸ç”¨æœ€æœ‰æ•ˆçš„é˜²æŠ¤æ–¹æ¡ˆ Webåº”ç”¨é˜²ç«å¢™ï¼ˆWeb Application Firewallï¼‰å¯¹ç½‘ç«™ä¸šåŠ¡æµé‡è¿›è¡Œå¤šç»´åº¦æ£€æµ‹å’Œé˜²æŠ¤ï¼Œç»“åˆæ·±åº¦æœºå™¨å­¦ä¹ æ™ºèƒ½è¯†åˆ«æ¶æ„è¯·æ±‚ç‰¹å¾å’Œé˜²å¾¡æœªçŸ¥å¨èƒï¼Œé˜»æŒ¡è¯¸å¦‚SQLæ³¨å…¥æˆ–è·¨ç«™è„šæœ¬ç­‰å¸¸è§æ”»å‡»ï¼Œé¿å…è¿™äº›æ”»å‡»å½±å“Webåº”ç”¨ç¨‹åºçš„å¯ç”¨æ€§ã€å®‰å…¨æ€§æˆ–è¿‡åº¦æ¶ˆè€—èµ„æºï¼Œé™ä½æ•°æ®è¢«ç¯¡æ”¹ã€å¤±çªƒçš„é£é™©\nDBSS-æ•°æ®åº“å®‰å…¨æœåŠ¡ æ•°æ®åº“å®‰å…¨æœåŠ¡ï¼ˆDatabase Security Serviceï¼‰æ˜¯ä¸€ä¸ªæ™ºèƒ½çš„æ•°æ®åº“å®‰å…¨é˜²æŠ¤æœåŠ¡ï¼ŒåŸºäºåå‘ä»£ç†åŠæœºå™¨å­¦ä¹ æœºåˆ¶ï¼Œæä¾›æ•æ„Ÿæ•°æ®å‘ç°ã€æ•°æ®è„±æ•ã€æ•°æ®åº“å®¡è®¡å’Œé˜²æ³¨å…¥æ”»å‡»ç­‰åŠŸèƒ½ï¼Œä¿éšœäº‘ä¸Šæ•°æ®åº“çš„å®‰å…¨\nCBH-äº‘å ¡å’æœºï¼šäº‘è¿ç»´å®¡è®¡çš„ç‘å£«å†›åˆ€ äº‘å ¡å’æœºï¼ˆCloud Bastion Hostï¼‰å¼€ç®±å³ç”¨ï¼ŒåŒ…å«ä¸»æœºç®¡ç†ã€æƒé™æ§åˆ¶ã€è¿ç»´å®¡è®¡ã€å®‰å…¨åˆè§„ç­‰åŠŸèƒ½ï¼Œæ”¯æŒChromeç­‰ä¸»æµæµè§ˆå™¨éšæ—¶éšåœ°è¿œç¨‹è¿ç»´ï¼Œå¼€å¯é«˜æ•ˆè¿ç»´æ–°æ—¶ä»£ã€‚\næ¡ˆä¾‹ å®¹ç¾å¤‡ä»½ ç³»ç»Ÿå¯é æ€§è®¾è®¡ä¹‹é«˜å¯ç”¨ã€åŒæ´»ã€å®¹ç¾ã€å¤‡ä»½ å®¹ç¾æŒ‡æ ‡ RTOï¼š RTO (Recovery Time Objectives)ï¼Œå…³é”®ä¸šåŠ¡åŠŸèƒ½ï¼ˆCBFï¼‰ä»ä¸­æ–­ç‚¹æ¢å¤åˆ°å…¶æœ€ä½ä¸šåŠ¡è¿ç»­ç›®æ ‡ï¼ˆMBCOï¼‰æ‰€èƒ½æ‰¿å—çš„æœ€å¤§æ—¶é—´ï¼Œä»è€Œä½¿ä¸­æ–­å¯¹ä¸šåŠ¡æ‰€å¸¦é¢†çš„å†²å‡»æœ€å°åŒ–ã€‚\nRPOï¼š RPO (Recovery Point Objectives)ï¼Œç¾éš¾æ¢å¤ä¸­çš„æ¢å¤æ—¶é—´ç‚¹ç›®æ ‡ï¼ŒæŒ‡ä¸šåŠ¡å¯æ¥å—çš„ã€ç¾éš¾å‘ç”Ÿåï¼Œç³»ç»Ÿå’Œæ•°æ®ä»ç¾éš¾å‘ç”Ÿæ—¶é—´ç‚¹åˆ°å¯æ¢å¤è‡³ç¾éš¾å‰çš„æ—¶é—´ç‚¹çš„ç›®æ ‡ã€‚\nMBCO MBCOï¼ˆMinimum Business Continuity Objectivesï¼‰ï¼Œåœ¨çªå‘äº‹ä»¶ã€ç´§æ€¥çŠ¶æ€ã€æˆ–ç¾éš¾å‘ç”ŸæœŸé—´ï¼Œä¼ä¸šä¸ºå®Œæˆå…¶ä¸šåŠ¡ç›®æ ‡æ‰€èƒ½æ¥å—çš„æœ€ä½æœåŠ¡åŠç”Ÿäº§æ°´å¹³ã€‚\n  æ ‡å‡† å®¹ç¾æ–¹æ¡ˆ æ··åˆäº‘å®¹ç¾æ•´ä½“æ–¹æ¡ˆ 4. GaussDB 5. å¤§æ•°æ® ç®—å­˜åˆ†ç¦» è§£å†³æ–¹æ¡ˆ 6. è§£å†³æ–¹æ¡ˆ å…¨è§ˆ\nåä¸ºé²²é¹é€šç”¨è§£å†³æ–¹æ¡ˆ åä¸ºé²²é¹è¡Œä¸šè§£å†³æ–¹æ¡ˆ æ€§èƒ½è°ƒä¼˜åˆ†æå·¥å…· Kunpeng Tuning Kité²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·\nåä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·ä¸»è¦é¢å‘åä¸ºFAEã€å¼€æ”¾å®éªŒå®¤èƒ½åŠ›å»ºè®¾å·¥ç¨‹å¸ˆæˆ–å®¢æˆ·å·¥ç¨‹å¸ˆï¼Œé’ˆå¯¹åº”ç”¨ç¨‹åºéƒ¨ç½²åœ¨TaiShanæœåŠ¡å™¨çš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡æ”¶é›†æœåŠ¡å™¨çš„å¤„ç†å™¨ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿã€è¿›ç¨‹/çº¿ç¨‹ã€å‡½æ•°ç­‰å„å±‚æ¬¡çš„æ€§èƒ½æ•°æ®ï¼Œåˆ†æå‡ºç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡ï¼Œå®šä½åˆ°ç“¶é¢ˆç‚¹åŠçƒ­ç‚¹å‡½æ•°ã€‚\né«˜æ€§èƒ½è®¡ç®— é¡¹ç›®:ä¸ªäººåŒæ­¥ç½‘ç›˜\n","description":"","id":86,"section":"talks","tags":["äº‘è®¡ç®—"],"title":"é²²é¹LearningğŸ¸","uri":"https://hugo.jiahongw.com/zh/talks/kubpeng_exercise/"},{"content":"C++å­¦ä¹ è·¯çº¿ğŸŒ± hode on!ğŸ’ \n","description":"","id":87,"section":"talks","tags":["C++"],"title":"C++å­¦ä¹ è·¯çº¿","uri":"https://hugo.jiahongw.com/zh/talks/cpp_router/"},{"content":"| ç®¡é“ç¬¦ï¼Œâ€œ|â€ï¼Œè¡¨ç¤ºå°†å‰ä¸€ä¸ªå‘½ä»¤çš„å¤„ç†ç»“æœè¾“å‡ºä¼ é€’ç»™åé¢çš„å‘½ä»¤å¤„ç†ã€‚\ngrep Linuxç³»ç»Ÿä¸­grepå‘½ä»¤æ˜¯ä¸€ç§å¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·ï¼Œå®ƒèƒ½ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢æ–‡æœ¬ï¼Œå¹¶æŠŠåŒ¹ é…çš„è¡Œæ‰“å°å‡ºæ¥ã€‚grepå…¨ç§°æ˜¯Global Regular Expression Printï¼Œè¡¨ç¤ºå…¨å±€æ­£åˆ™è¡¨è¾¾å¼ç‰ˆæœ¬ï¼Œå®ƒçš„ä½¿ç”¨æƒé™æ˜¯æ‰€æœ‰ç”¨æˆ·ã€‚\nè¯­æ³• grep [é€‰é¡¹] æŸ¥æ‰¾å†…å®¹ æºæ–‡ä»¶ é€‰é¡¹å‚æ•°   -a --text #ä¸è¦å¿½ç•¥äºŒè¿›åˆ¶çš„æ•°æ®ã€‚\n  -A\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; --after-context=\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; #é™¤äº†æ˜¾ç¤ºç¬¦åˆèŒƒæœ¬æ ·å¼çš„é‚£ä¸€åˆ—ä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹åçš„å†…å®¹ã€‚\n  -b  --byte-offset  #åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œæ ‡ç¤ºå‡ºè¯¥è¡Œç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç¼–å·ã€‚â­\n  -B\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; --before-context=\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; #é™¤äº†æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹å‰çš„å†…å®¹ã€‚\n  -c --count #è®¡ç®—ç¬¦åˆæ ·å¼çš„åˆ—æ•°ã€‚â­\n  -C\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; --context=\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt;æˆ–-\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; #é™¤äº†æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹å‰åçš„å†…å®¹ã€‚\n  -d \u0026lt;åŠ¨ä½œ\u0026gt; --directories=\u0026lt;åŠ¨ä½œ\u0026gt; #å½“æŒ‡å®šè¦æŸ¥æ‰¾çš„æ˜¯ç›®å½•è€Œéæ–‡ä»¶æ—¶ï¼Œå¿…é¡»ä½¿ç”¨è¿™é¡¹å‚æ•°ï¼Œå¦åˆ™grepæŒ‡ä»¤å°†å›æŠ¥ä¿¡æ¯å¹¶åœæ­¢åŠ¨ä½œã€‚â­\n  -e\u0026lt;èŒƒæœ¬æ ·å¼\u0026gt; --regexp=\u0026lt;èŒƒæœ¬æ ·å¼\u0026gt; #æŒ‡å®šå­—ç¬¦ä¸²åšä¸ºæŸ¥æ‰¾æ–‡ä»¶å†…å®¹çš„æ ·å¼ã€‚\n  -E --extended-regexp #å°†æ ·å¼ä¸ºå»¶ä¼¸çš„æ™®é€šè¡¨ç¤ºæ³•æ¥ä½¿ç”¨ã€‚\n  -f\u0026lt;è§„åˆ™æ–‡ä»¶\u0026gt; --file=\u0026lt;è§„åˆ™æ–‡ä»¶\u0026gt; #æŒ‡å®šè§„åˆ™æ–‡ä»¶ï¼Œå…¶å†…å®¹å«æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè§„åˆ™æ ·å¼ï¼Œè®©grepæŸ¥æ‰¾ç¬¦åˆè§„åˆ™æ¡ä»¶çš„æ–‡ä»¶å†…å®¹ï¼Œæ ¼å¼ä¸ºæ¯è¡Œä¸€ä¸ªè§„åˆ™æ ·å¼ã€‚\n  -F --fixed-regexp #å°†æ ·å¼è§†ä¸ºå›ºå®šå­—ç¬¦ä¸²çš„åˆ—è¡¨ã€‚\n  -G --basic-regexp #å°†æ ·å¼è§†ä¸ºæ™®é€šçš„è¡¨ç¤ºæ³•æ¥ä½¿ç”¨ã€‚\n  -h --no-filename #åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œä¸æ ‡ç¤ºè¯¥è¡Œæ‰€å±çš„æ–‡ä»¶åç§°ã€‚\n  -H --with-filename  #åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œè¡¨ç¤ºè¯¥è¡Œæ‰€å±çš„æ–‡ä»¶åç§°ã€‚\n  -i --ignore-case  #å¿½ç•¥å­—ç¬¦å¤§å°å†™çš„å·®åˆ«ã€‚â­\n  -l --file-with-matches #åˆ—å‡ºæ–‡ä»¶å†…å®¹ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§°ã€‚\n  -L --files-without-match #åˆ—å‡ºæ–‡ä»¶å†…å®¹ä¸ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§°ã€‚\n  -n --line-number #åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œæ ‡ç¤ºå‡ºè¯¥è¡Œçš„åˆ—æ•°ç¼–å·ã€‚\n  -q --quietæˆ–--silent #ä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ã€‚\n  -r --recursive #æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®šâ€œ-d recurseâ€å‚æ•°ç›¸åŒã€‚\n  -s --no-messages #ä¸æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚\n  -v --revert-match #æ˜¾ç¤ºä¸åŒ…å«åŒ¹é…æ–‡æœ¬çš„æ‰€æœ‰è¡Œã€‚\n  -V --version #æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚\n  -w --word-regexp #åªæ˜¾ç¤ºå…¨å­—ç¬¦åˆçš„åˆ—ã€‚\n  -x --line-regexp #åªæ˜¾ç¤ºå…¨åˆ—ç¬¦åˆçš„åˆ—ã€‚\n  -y #æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®šâ€œ-iâ€å‚æ•°ç›¸åŒã€‚\n   å…¶ä¸­æ ‡â­å·çš„ä¸ºæ¯”è¾ƒå¸¸å®ç”¨çš„\n æŸ¥æ‰¾å†…å®¹è§„åˆ™ æŸ¥æ‰¾å†…å®¹çš„è§„åˆ™ä¸æ­£åˆ™è¡¨è¾¾å¼å¤§åŒå°å¼‚ã€‚\n  ^ #é”šå®šè¡Œçš„å¼€å§‹ å¦‚ï¼š\u0026lsquo;^grep'åŒ¹é…æ‰€æœ‰ä»¥grepå¼€å¤´çš„è¡Œã€‚\n  $ #é”šå®šè¡Œçš„ç»“æŸ å¦‚ï¼š\u0026lsquo;grep$'åŒ¹é…æ‰€æœ‰ä»¥grepç»“å°¾çš„è¡Œã€‚\n  . #åŒ¹é…ä¸€ä¸ªéæ¢è¡Œç¬¦çš„å­—ç¬¦ å¦‚ï¼š\u0026lsquo;gr.p'åŒ¹é…gråæ¥ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚\n  *#åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå…ˆå‰å­—ç¬¦ å¦‚ï¼š'*grep'åŒ¹é…æ‰€æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åç´§è·Ÿgrepçš„è¡Œã€‚\n  .* #ä¸€èµ·ç”¨ä»£è¡¨ä»»æ„å­—ç¬¦ã€‚\n  [] #åŒ¹é…ä¸€ä¸ªæŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚\u0026rsquo;[Gg]rep'åŒ¹é…Grepå’Œgrepã€‚\n  [^]  #åŒ¹é…ä¸€ä¸ªä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚ï¼š'[^A-FH-Z]rep'åŒ¹é…ä¸åŒ…å«A-Rå’ŒT-Zçš„ä¸€ä¸ªå­—æ¯å¼€å¤´ï¼Œç´§è·Ÿrepçš„è¡Œã€‚\n  \\(..\\) #æ ‡è®°åŒ¹é…å­—ç¬¦ï¼Œå¦‚\u0026rsquo;(love)'ï¼Œloveè¢«æ ‡è®°ä¸º1ã€‚\n  \\\u0026lt; #é”šå®šå•è¯çš„å¼€å§‹ï¼Œå¦‚:'\u0026lt;grep'åŒ¹é…åŒ…å«ä»¥grepå¼€å¤´çš„å•è¯çš„è¡Œã€‚\n  \\\u0026gt; #é”šå®šå•è¯çš„ç»“æŸï¼Œå¦‚\u0026rsquo;grep\u0026gt;'åŒ¹é…åŒ…å«ä»¥grepç»“å°¾çš„å•è¯çš„è¡Œã€‚\n  x\\{m\\} #é‡å¤å­—ç¬¦xï¼Œmæ¬¡ï¼Œå¦‚ï¼š\u0026lsquo;0{5}\u0026lsquo;åŒ¹é…åŒ…å«5ä¸ªoçš„è¡Œã€‚\n  x\\{m,\\}  #é‡å¤å­—ç¬¦x,è‡³å°‘mæ¬¡ï¼Œå¦‚ï¼š\u0026lsquo;o{5,}\u0026lsquo;åŒ¹é…è‡³å°‘æœ‰5ä¸ªoçš„è¡Œã€‚\n  x\\{m,n\\} #é‡å¤å­—ç¬¦xï¼Œè‡³å°‘mæ¬¡ï¼Œä¸å¤šäºnæ¬¡ï¼Œå¦‚ï¼š\u0026lsquo;o{5,10}\u0026lsquo;åŒ¹é…5\u0026ndash;10ä¸ªoçš„è¡Œã€‚\n  \\w  #åŒ¹é…æ–‡å­—å’Œæ•°å­—å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯[A-Za-z0-9]ï¼Œå¦‚ï¼š\u0026lsquo;G\\w*p'åŒ¹é…ä»¥Gåè·Ÿé›¶ä¸ªæˆ–å¤šä¸ªæ–‡å­—æˆ–æ•°å­—å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚\n  \\W  #\\wçš„åç½®å½¢å¼ï¼ŒåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéå•è¯å­—ç¬¦ï¼Œå¦‚ç‚¹å·å¥å·ç­‰ã€‚\n  \\b  #å•è¯é”å®šç¬¦ï¼Œå¦‚: \u0026lsquo;\\bgrep\\b'åªåŒ¹é…grepã€‚\n  åœ¨/etc/profileæ–‡ä»¶ä¸­æŸ¥æ‰¾å…³é”®å­—CLASS_PATHæ‰€åœ¨ä½ç½®\næŸ¥è¯¢sshç›¸å…³è¿›ç¨‹\nå‹ç¼©è§£å‹ç±»å‘½ä»¤ gzip/gunzip gzipç”¨äºå‹ç¼©æ–‡ä»¶ï¼Œgunzipç”¨äºè§£å‹\nè¯­æ³•ï¼š\ngzipæ–‡ä»¶åï¼ˆåŠŸèƒ½æè¿°ï¼šå‹ç¼©æ–‡ä»¶ï¼Œåªèƒ½å°†æ–‡ä»¶å‹ç¼©ä¸º*.gzæ–‡ä»¶ï¼‰\ngunzip æ–‡ä»¶å(.gzç»“å°¾)ï¼š(åŠŸèƒ½æè¿°ï¼šè§£å‹ç¼©æ–‡ä»¶å‘½ä»¤ï¼‰\nå‹ç¼©b.txtæ–‡ä»¶\nè§£å‹b.txt.gzå‹ç¼©æ–‡ä»¶\nzip/unzip zipç”¨äºå‹ç¼©æ–‡ä»¶ï¼Œunzipç”¨äºè§£å‹çš„ï¼Œè¿™ä¸ªåœ¨é¡¹ç›®æ‰“åŒ…å‘å¸ƒä¸­å¾ˆæœ‰ç”¨çš„.\nè¯­æ³•ï¼š\nzip [é€‰é¡¹] XXX.zip å°†è¦å‹ç¼©çš„å†…å®¹ï¼ˆåŠŸèƒ½æè¿°ï¼šå‹ç¼©æ–‡ä»¶å’Œç›®å½•çš„å‘½ä»¤ï¼‰\nunzip [é€‰é¡¹] XXX.zip (åŠŸèƒ½æè¿°ï¼šè§£å‹ç¼©æ–‡ä»¶ï¼‰\nåŠ å¯†a.txtæ–‡ä»¶\nè§£å¯†a.zipæ–‡ä»¶\ntar taræŒ‡ä»¤æ˜¯æ‰“åŒ…æŒ‡ä»¤ï¼Œæœ€åæ‰“åŒ…åçš„æ–‡ä»¶å¯ä»¥æ˜¯.tar.gzçš„æ–‡ä»¶ã€‚\nè¯­æ³•ï¼š\ntar [é€‰é¡¹] XXX.tar.gz æ‰“åŒ…çš„å†…å®¹ï¼ˆåŠŸèƒ½æè¿°ï¼šæ‰“åŒ…ç›®å½•ï¼Œå‹ç¼©åçš„æ–‡ä»¶æ ¼å¼tar.gz)\né€‰é¡¹å‚æ•°ï¼š\n  -A æ–°å¢å‹ç¼©æ–‡ä»¶åˆ°å·²å­˜åœ¨çš„å‹ç¼©\n  -B è®¾ç½®åŒºå—å¤§å°\n  -c å»ºç«‹æ–°çš„å‹ç¼©æ–‡ä»¶\n  -d è®°å½•æ–‡ä»¶çš„å·®åˆ«\n  -r æ·»åŠ æ–‡ä»¶åˆ°å·²ç»å‹ç¼©çš„æ–‡ä»¶\n  -u æ·»åŠ æ”¹å˜äº†å’Œç°æœ‰çš„æ–‡ä»¶åˆ°å·²ç»å­˜åœ¨çš„å‹ç¼©æ–‡ä»¶\n  -x ä»å‹ç¼©çš„æ–‡ä»¶ä¸­æå–æ–‡ä»¶\n  -t æ˜¾ç¤ºå‹ç¼©æ–‡ä»¶çš„å†…å®¹\n  -z æ”¯æŒgzipè§£å‹æ–‡ä»¶\n  -j æ”¯æŒbzip2è§£å‹æ–‡ä»¶\n  -Z æ”¯æŒcompressè§£å‹æ–‡ä»¶\n  -v æ˜¾ç¤ºæ“ä½œè¿‡ç¨‹\n  -l æ–‡ä»¶ç³»ç»Ÿè¾¹ç•Œè®¾ç½®\n  -k ä¿ç•™åŸæœ‰æ–‡ä»¶ä¸è¦†ç›–\n  -m ä¿ç•™æ–‡ä»¶ä¸è¢«è¦†ç›–\n  -W ç¡®è®¤å‹ç¼©æ–‡ä»¶çš„æ­£ç¡®æ€§\n  å¯é€‰å‚æ•°å¦‚ä¸‹ï¼š\n  -b è®¾ç½®åŒºå—æ•°ç›®\n  -C åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•\n  -f æŒ‡å®šå‹ç¼©æ–‡ä»¶\n  --help æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯\n  --version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯\n  å®ä¾‹ï¼š\næ‰“åŒ…/victoræ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰å†…å®¹ï¼Œæ‰“åŒ…åçš„æ–‡ä»¶åä¸ºvictor.tar\nè§£å‹victor.taræ–‡ä»¶\næ‰“åŒ…æ–‡ä»¶å¤¹/victorå¹¶ä¸”å‹ç¼©æˆdata.tar.gz\nå°†å¤šä¸ªæ–‡ä»¶å‹ç¼©æˆa.tar.gz\nå°†a.tar.gzè§£å‹åˆ°å½“å‰ç›®å½•\nè§£å‹åˆ°æ–‡ä»¶å¤¹/a(æ–‡ä»¶å¤¹å¿…é¡»å­˜åœ¨ï¼Œä¸ç„¶æŠ¥é”™)\n![](https://i.loli.net/2020/04/16/xALa9JldzXuBjRi.png\n https://www.cnblogs.com/peida/archive/2012/12/17/2821195.html https://www.cnblogs.com/peida/archive/2012/12/19/2824418.html https://www.cnblogs.com/peida/archive/2012/12/06/2804323.html ","description":"","id":88,"section":"posts","tags":["Linux","grep","tar","gzip"],"title":"Linuxå®ç”¨æŒ‡ä»¤","uri":"https://hugo.jiahongw.com/zh/posts/linux/linux-grep/"},{"content":"æ¯ä¸€ä¸ªç”¨æˆ·éƒ½æ˜¯ä¸€ä¸ªä¸ªä½“ï¼Œæ¯ä¸€ä¸ªä¸ªä½“éƒ½å±äºä¸€ä¸ªç¾¤ç»„ï¼Œè€Œæ¯ä¸€ä¸ªç¾¤ç»„åˆæœ‰åŒºåˆ«!\nâ€”â€”Users\n Linuxç³»ç»Ÿæ˜¯ä¸€ä¸ªå¤šç”¨æˆ·å¤šä»»åŠ¡çš„æ“ä½œç³»ç»Ÿï¼Œä»»ä½•ä¸€ä¸ªè¦ä½¿ç”¨ç³»ç»Ÿèµ„æºçš„ç”¨æˆ·ï¼Œéƒ½å¿…é¡»é¦–å…ˆå‘ç³»ç»Ÿç®¡ç†å‘˜ç”³è¯·ä¸€ä¸ªè´¦å·ï¼Œç„¶åä»¥è¿™ä¸ªè´¦å·çš„èº«ä»½è¿›å…¥ç³»ç»Ÿã€‚\n æ·»åŠ ç”¨æˆ· åŸºæœ¬è¯­æ³• useradd [é€‰é¡¹] ç”¨æˆ·å å®æ“ è¾“å…¥ä»¥ä¸‹å‘½ä»¤ä¹‹ååˆ›å»ºä¸€ä¸ªç”¨æˆ·victor\nè¿™é‡Œæˆ‘ä»¬é€‰é¡¹å‚æ•°ä»€ä¹ˆä¹Ÿæ²¡æœ‰å†™ï¼Œæ­¤æ—¶ä¼šé»˜è®¤åœ¨/homeç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª/victorçš„æ–‡ä»¶å¤¹ç”¨äºä¿å­˜ç”¨æˆ·victorç”¨æˆ·çš„æ•°æ®ä¿¡æ¯ã€‚\nå½“ç„¶æˆ‘ä»¬å¯ä»¥æŒ‡å®šå‚æ•°ï¼š\nç”¨å‚æ•° -d ç›®å½•æŒ‡å®šç”¨æˆ·ä¿¡æ¯å­˜å‚¨çš„ç›®å½•ï¼Œä½¿ç”¨å‘½ä»¤useradd -d /home/test tomåˆ›å»ºç”¨æˆ·tomã€‚\nä½¿ç”¨-g ç”¨æˆ·ç»„æŒ‡å®šå°†å½“å‰åˆ›å»ºçš„ç”¨æˆ·æ·»åŠ åˆ°æŒ‡å®šçš„ç”¨æˆ·ç»„ï¼Œä½¿ç”¨å‘½ä»¤useradd -g root wjhå°†æ–°å»ºç”¨æˆ·wjhæ·»åŠ åˆ°rootç”¨æˆ·ç»„ã€‚\nç»™ç”¨æˆ·è®¾ç½®å¯†ç  åŸºæœ¬è¯­æ³• passwd ç”¨æˆ·å å®æ“ ç»™ç”¨æˆ·victorè®¾ç½®å¯†ç (é»˜è®¤å¯†ç æ˜¯ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥çš„)\nä¸‹é¢å¯ä»¥ä½¿ç”¨victorè¿™ä¸ªç”¨æˆ·ç™»é™†\né»˜è®¤æ˜¯ä¸èƒ½è®¿é—®rootç”¨æˆ·çš„æ–‡ä»¶çš„ï¼Œå› ä¸ºä¸åœ¨åŒä¸€ä¸ªç»„\nåˆ‡æ¢ç”¨æˆ· åŸºæœ¬è¯­æ³• su - åˆ‡æ¢ç”¨æˆ·å å®æ“ åˆ‡æ¢åˆ°rootã€‚å…¶ä¸­ä½æƒé™ç”¨æˆ·åˆ‡æ¢åˆ°é«˜æƒé™ç”¨æˆ·éœ€è¦è¾“å…¥å¯†ç ã€‚\né€€å‡ºåˆ‡æ¢ä½¿ç”¨exitåˆ é™¤ç”¨æˆ· åŸºæœ¬è¯­æ³• userdel [é€‰é¡¹] ç”¨æˆ·å å…¶ä¸­é€‰é¡¹å‚æ•°å¯ä»¥æ·»åŠ -rï¼Œè¡¨ç¤ºåˆ é™¤ç”¨æˆ·æ—¶åŒæ—¶åˆ é™¤ä¿å­˜ç”¨æˆ·çš„æ–‡ä»¶å¤¹ã€‚\nå®æ“ åˆ é™¤ç”¨æˆ·tom\nå¯ä»¥çœ‹åˆ°ä¹‹å‰tomè‡´ç”µç»™åˆ›å»ºçš„æ–‡ä»¶å¤¹testå¹¶æ²¡æœ‰åˆ é™¤ã€‚\n æ³¨æ„ï¼Œåˆ é™¤ç”¨æˆ·å¿…é¡»è¦rootæƒé™ï¼Œä¸ç„¶åˆ é™¤ä¸äº†ã€‚\n åˆ é™¤ç”¨æˆ·victorï¼ŒåŒæ—¶åˆ é™¤å…¶æ–‡ä»¶å¤¹ï¼Œvictoræ–‡ä»¶å¤¹æ¶ˆå¤±äº†\nå…¶ä»–æ“ä½œ æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ è¯­æ³•\nid ç”¨æˆ·å å¦‚ä¸‹æŸ¥è¯¢ç”¨æˆ·rootçš„ä¿¡æ¯\nrootç”¨æˆ·çš„ç”¨æˆ·idä¸º0ï¼Œç»„idä¸º0ï¼Œç»„ä¸º0\næŸ¥è¯¢å½“å‰ç”¨æˆ· è¯­æ³•\nwhoami ç”¨æˆ·ç»„  ç±»ä¼¼äºè§’è‰²ï¼Œç³»ç»Ÿå¯ä»¥å¯¹æœ‰å…±æ€§çš„å¤šä¸ªç”¨æˆ·è¿›è¡Œç»Ÿä¸€çš„ç®¡ç†ã€‚\n ç”¨æˆ·ç»„å…³ç³»å›¾ï¼š\nå¢åŠ ç»„ è¯­æ³•\ngroupadd ç»„å å¢åŠ ç”¨æˆ·ç»„test\nåˆ é™¤ç»„ è¯­æ³•\ngroupdel ç»„å åˆ é™¤ç”¨æˆ·ç»„test\nä¿®æ”¹ç”¨æˆ·çš„ç»„ è¯­æ³•\nusermod -g ç”¨æˆ·ç»„ ç”¨æˆ·å ç›¸å…³é…ç½®æ–‡ä»¶  ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶ï¼š/etc/passwd å¯†ç æ–‡ä»¶ï¼š /etc/shadow ç”¨æˆ·ç»„æ–‡ä»¶ï¼š/etc/group ç”¨æˆ·ç»„å¯†ç æ–‡ä»¶ï¼š /etc/gshadow ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼š\n/etc/login.defs\n/etc/default/useradd æ–°ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶ï¼š/etc/skel ç™»å½•ä¿¡æ¯ï¼š/etc/motd  /etc/passwd æ¯ä¸€è¡Œå†…å®¹å­˜æ”¾ä¸€ä¸ªç”¨æˆ·çš„ä¿¡æ¯ï¼Œæ¯ä¸ªç”¨æˆ·ä¿¡æ¯æœ‰7éƒ¨åˆ†ç»„æˆ\nrootâ€‹ï¼šx:0:0:root:/root:/bin/bash\nroot ç”¨æˆ·å ç”¨æˆ·ç™»å½•ç³»ç»Ÿæ—¶ä½¿ç”¨çš„ç”¨æˆ·å\nx å¯†ç  å¯†ç ä½\n2 UID ç”¨æˆ·æ ‡è¯†å·\n2 GID ç¼ºçœç»„æ ‡è¯†\nroot æ³¨é‡Šæ€§æè¿° ä¾‹å¦‚å­˜æ”¾ç”¨æˆ·å…¨åç­‰ä¿¡æ¯\n/root å®¿ä¸»ç›®å½• ç”¨æˆ·ç™»å½•ç³»ç»Ÿåçš„ç¼ºçœç›®å½•\n/bin/bash å‘½ä»¤è§£é‡Šå™¨ ç”¨æˆ·ä½¿ç”¨çš„Shell ,é»˜è®¤ä¸ºbash\n UIDåˆ†ç±»\nè¶…çº§ç”¨æˆ·ï¼šï¼ˆroot UID=0ï¼‰\næ™®é€šç”¨æˆ·ï¼š ï¼ˆUID 500~60000ï¼‰\nä¼ªç”¨æˆ·ï¼š ï¼ˆUID 1~499ï¼‰\nä»€ä¹ˆæ˜¯ä¼ªç”¨æˆ·?\n ä¼ªç”¨æˆ·ä¸ç³»ç»Ÿå’Œç¨‹åºæœåŠ¡ç›¸å…³  binã€daemonã€shutdownã€haltç­‰ï¼Œä»»ä½•Linuxç³»ç»Ÿé»˜è®¤éƒ½æœ‰è¿™äº›ä¼ªç”¨æˆ·ã€‚\nmailã€newsã€gamesã€apacheã€ftpã€mysqlåŠsshdç­‰ï¼Œä¸linuxç³»ç»Ÿçš„è¿›ç¨‹ç›¸å…³ã€‚\n ä¼ªç”¨æˆ·é€šå¸¸ä¸éœ€è¦æˆ–æ— æ³•ç™»å½•ç³»ç»Ÿ\n  å¯ä»¥æ²¡æœ‰å®¿ä¸»ç›®å½•\n   /etc/shadow æ¯è¡Œçš„å«ä¹‰ï¼š ç™»å½•å: åŠ å¯†å£ä»¤: æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´: æœ€å°æ—¶é—´é—´éš”: æœ€å¤§æ—¶é—´é—´éš”:è­¦å‘Šæ—¶é—´: ä¸æ´»åŠ¨æ—¶é—´: å¤±æ•ˆæ—¶é—´:æ ‡å¿—\n/etc/group æ¯è¡Œå«ä¹‰ï¼š ç»„å: å£ä»¤: ç»„æ ‡è¯†å·: ç»„å†…ç”¨æˆ·åˆ—è¡¨\n https://www.cnblogs.com/qmfsun/p/3674024.html linuxç”¨æˆ·ç®¡ç†å‘½ä»¤ ","description":"","id":89,"section":"posts","tags":["Linux","ç”¨æˆ·ç®¡ç†"],"title":"Linuxç”¨æˆ·ç®¡ç†","uri":"https://hugo.jiahongw.com/zh/posts/linux/linux-users/"},{"content":"åœ¨å¤§å­¦æ—¶ä»£ï¼ŒVim çš„å¤§åå°±å·²å¦‚é›·è´¯è€³ï¼Œä½†ç”±äºå®ƒé™¡å³­çš„å­¦ä¹ æ›²çº¿ï¼Œä¸€ç›´æœ›è€Œå´æ­¥ã€‚ç­‰çœŸæ­£å¼€å§‹å­¦ä¹ ä¹‹åï¼Œå‘ç°å¹¶æ²¡æœ‰æƒ³è±¡ä¸­çš„å¤æ‚ï¼Œä¹Ÿæ²¡æœ‰æ‰€è°“çš„ç“¶é¢ˆï¼Œåªè¦åœ¨å®é™…å†™ä»£ç ä¸­å¼ºè¿«è‡ªå·±ä½¿ç”¨å°±å¯ä»¥äº†ï¼Œæ— å½¢ä¸­å°±ä¼šå½¢æˆä¹ æƒ¯ã€‚\nâ€‹\tâ€”â€”GeekPlux\nä¸‰ç§æ¨¡å¼ æ­£å¸¸æ¨¡å¼ ä»¥ vim æ‰“å¼€ä¸€ä¸ªæ¡£æ¡ˆå°±ç›´æ¥è¿›å…¥ä¸€èˆ¬æ¨¡å¼äº†(è¿™æ˜¯é»˜è®¤çš„æ¨¡å¼)ã€‚æ­£å¸¸æ¨¡å¼å¯ä»¥ä½¿ç”¨å¿«æ·é”®ã€‚\nç¼–è¾‘æ¨¡å¼ æŒ‰ä¸‹i, I, o, O, a, A, r, Rç­‰ä»»ä½•ä¸€ä¸ªå­—æ¯ä¹‹åæ‰ä¼šè¿›å…¥ç¼–è¾‘æ¨¡å¼, ä¸€èˆ¬æ¥è¯´æŒ‰iå³å¯.\nå‘½ä»¤è¡Œæ¨¡å¼ åœ¨è¿™ä¸ªæ¨¡å¼å½“ä¸­ï¼Œ å¯ä»¥æä¾›ä½ ç›¸å…³æŒ‡ä»¤ï¼Œå®Œæˆè¯»å–ã€å­˜ç›˜ã€æ›¿æ¢ã€ç¦»å¼€ vim ã€æ˜¾ç¤ºè¡Œå·ç­‰çš„åŠ¨ä½œåˆ™æ˜¯åœ¨æ­¤æ¨¡å¼ä¸­è¾¾æˆçš„ã€‚\n vi å’Œvimæ¨¡å¼çš„ç›¸äº’åˆ‡æ¢\n å¸¸ç”¨å¿«æ·é”®  ä½¿ç”¨å¿«æ·é”®åœ¨æ­£å¸¸æ¨¡å¼ä¸‹è¾“å…¥ï¼\n å¤åˆ¶ç²˜è´´ æ‹·è´å½“å‰è¡Œè¾“å…¥yyï¼Œç„¶åå†æŒ‰ä¸‹pé”®çš„æ—¶å€™å°±å¯ä»¥ç²˜è´´äº†ã€‚\nå¤åˆ¶å¤šè¡Œå¯ä»¥è¾“å…¥nyyï¼Œå…¶ä¸­nä¸ºä¸€ä¸ªæ•°å­—ï¼Œä¾‹å¦‚5yyï¼Œå³å¤åˆ¶å½“å‰è¡Œå‘ä¸‹çš„5è¡Œï¼ŒåŒæ ·ç²˜è´´ä¹Ÿæ˜¯æŒ‰pé”®ã€‚\nåˆ é™¤ åˆ é™¤å½“å‰è¡Œè¾“å…¥dd\nåˆ é™¤å¤šè¡Œè¾“å…¥nddï¼Œè¡¨ç¤ºåˆ é™¤å½“å‰è¡Œå‘ä¸‹çš„nè¡Œã€‚\næŸ¥æ‰¾å•è¯ å†æ­£å¸¸æ¨¡å¼ä¸‹è¾“å…¥/å…³é”®å­—å³å¯æŸ¥æ‰¾å…³é”®å­—æ‰€åœ¨çš„ä½ç½®ï¼Œä¾‹å¦‚/helloä¸ºæŸ¥æ‰¾helloè¿™ä¸ªå•è¯æ‰€æœ‰çš„æ‰€åœ¨ä½ç½®ï¼Œè¾“å…¥ n å°±æ˜¯æŸ¥æ‰¾ä¸‹ä¸€ä¸ªã€‚\nè®¾ç½®æ–‡ä»¶è¡Œå· æœ‰æ—¶å€™ä¸ºäº†çœ‹æ–‡æ¡£æ›´æ¸…æ¥šï¼Œæƒ³è¦çŸ¥é“æ¯ä¸€è¡Œçš„è¡Œæ•°ï¼Œå¯ä»¥å…ˆè¿›å…¥å‘½ä»¤æ¨¡å¼ï¼Œåœ¨è¾“å…¥set nuï¼Œå³å†æ­£å¸¸æ¨¡å¼ä¸‹è¾“å…¥:set nu,ç„¶åå›è½¦ã€‚\nå–æ¶ˆè¡Œå·å¯ä»¥è¾“å…¥:set nonu\nç§»åŠ¨åˆ°åº•éƒ¨åˆ°é¦–éƒ¨ æœ‰æ—¶å€™éœ€è¦ç›´æ¥çœ‹æ–‡æ¡£çš„æœ«å°¾ï¼Œå¯ä»¥è¾“å…¥Gç§»åŠ¨åˆ°æ–‡ä»¶æœ«è¡Œã€‚\nè€Œç§»åŠ¨åˆ°é¦–è¡Œåˆ™æ˜¯è¾“å…¥ggï¼Œç„¶åå›è½¦å³å¯ã€‚\næ’¤é”€ å–æ¶ˆä¸Šä¸€æ¬¡åšçš„æ“ä½œï¼Œè¾“å…¥uã€‚è¡¨ç¤ºundoã€‚\nç§»åŠ¨åˆ°æŸè¡Œ å‡å¦‚æˆ‘ä»¬è¦ç§»åŠ¨åˆ°ç¬¬20è¡Œï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è¾“å…¥ï¼š20 + shift + g\næ›´å¤šå¿«æ·é”®å¯ä»¥å‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/77283813\nVimé”®ç›˜å›¾\næ€ç»´å¯¼å›¾ï¼š\n","description":"","id":90,"section":"posts","tags":["Linux","Vim"],"title":"Linuxç¼–è¾‘åˆ©å™¨-Vim","uri":"https://hugo.jiahongw.com/zh/posts/linux/vim-use/"},{"content":"é—®é¢˜æè¿° ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œæ‰¾åˆ° s ä¸­æœ€é•¿çš„å›æ–‡å­ä¸²ã€‚ä½ å¯ä»¥å‡è®¾ s çš„æœ€å¤§é•¿åº¦ä¸º 1000ã€‚\nç¤ºä¾‹ 1ï¼š\nè¾“å…¥: \u0026quot;babad\u0026quot; è¾“å‡º: \u0026quot;bab\u0026quot; æ³¨æ„: \u0026quot;aba\u0026quot; ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰æ•ˆç­”æ¡ˆã€‚ ç¤ºä¾‹ 2ï¼š\nè¾“å…¥: \u0026quot;cbbd\u0026quot; è¾“å‡º: \u0026quot;bb\u0026quot; è§£ç­” ä½¿ç”¨åŠ¨æ€è§„åˆ’ï¼ŒæŠŠåŸæ¥çš„å­—ç¬¦ä¸²å€’ç½®ï¼Œç„¶åæ‰¾æœ€é•¿çš„å…¬å…±å­ä¸²å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚ S = \u0026ldquo;caba\u0026rdquo; ï¼ŒS = \u0026ldquo;abac\u0026rdquo;ï¼Œæœ€é•¿å…¬å…±å­ä¸²æ˜¯ \u0026ldquo;aba\u0026rdquo;ï¼Œæ‰€ä»¥åŸå­—ç¬¦ä¸²çš„æœ€é•¿å›æ–‡ä¸²å°±æ˜¯ \u0026ldquo;aba\u0026rdquo;ã€‚å…¶ä¸­æ±‚æœ€å¤§å…¬å…±å­ä¸²å°±æ˜¯ä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹æ³•ã€‚\nç¤ºæ„å›¾ï¼š\n å½“S[i]==S[j]æ—¶ï¼ŒçŸ©é˜µarr[i][j]=arr[i-1][j-1]+1ï¼›ç‰¹æ®Šæƒ…å†µiã€jä¸º0æ—¶arr[i][j]=1 å…¶ä»–æƒ…å†µè·³è¿‡ã€‚   å¦å¤–ï¼Œè¿˜éœ€è¦è€ƒè™‘æœ€é•¿å…¬å…±å­ä¸²ä¸æ˜¯å›æ–‡çš„æƒ…å†µï¼Œåªéœ€è¦åˆ¤æ–­ç¿»è½¬å‰åçš„æœ«å°¾å­—ç¬¦ä¸‹æ ‡æ˜¯å¦ä¸€æ ·å³å¯ï¼Œæ¯”å¦‚ S=\u0026quot;caba\u0026rdquo;ï¼ŒS'=\u0026quot;abac\u0026rdquo; ï¼ŒSâ€™ ä¸­ aba çš„ä¸‹æ ‡æ˜¯ 0 1 2 ï¼Œå€’ç½®å‰æ˜¯ 3 2 1ï¼Œå’Œ S ä¸­ aba çš„ä¸‹æ ‡ç¬¦åˆï¼Œæ‰€ä»¥ aba å°±æ˜¯æˆ‘ä»¬éœ€è¦æ‰¾çš„ã€‚å½“ç„¶æˆ‘ä»¬ä¸éœ€è¦æ¯ä¸ªå­—ç¬¦éƒ½åˆ¤æ–­ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ¤æ–­æœ«å°¾å­—ç¬¦å°±å¯ä»¥ã€‚\n ä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46  #include \u0026lt;iostream\u0026gt;#include \u0026lt;algorithm\u0026gt;class Solution { public: string longestPalindrome(string s) { //æš´åŠ›æ³•  int len = s.length(); if (len \u0026lt;= 1) return s; std::string r; std::string real = s; reverse(s.begin(), s.end()); std::string reverse = s; int arr[len][len]; for (int i = 0; i \u0026lt; len; ++i) for (int j = 0; j \u0026lt; len; ++j) arr[i][j] = 0; int maxLen(0), maxEnd(0); for (int i = 0; i \u0026lt; len; ++i) { for (int j = 0; j \u0026lt; len; ++j) { if (real[i] == reverse[j]) { if (i == 0 || j == 0) arr[i][j] = 1; else { arr[i][j] = arr[i - 1][j - 1] + 1; } } if (arr[i][j] \u0026gt; maxLen) { int beforeindex = len - 1 - j; if ((beforeindex + arr[i][j] - 1) == i) { maxLen = arr[i][j]; maxEnd = i; } } } } return real.substr(maxEnd - maxLen + 1, maxLen); } };   ç»“æœï¼š ","description":"","id":91,"section":"posts","tags":["C++","leetcode"],"title":"Leetcode-æœ€é•¿å›æ–‡å­ä¸²","uri":"https://hugo.jiahongw.com/zh/posts/leetcode/leetcode-0/"},{"content":"LinuxåŸºæœ¬æ“ä½œã€‚ğŸ¤ \nLinux ç›®å½•ç»“æ„åŠè§£é‡Š æŸ¥çœ‹å‘½ä»¤è¡Œæ‰§è¡Œå®Œä½ç½®ï¼š\n1  echo $BASH   å‘½ä»¤è®°å½• mkdir mkdirå‘½ä»¤ ç”¨æ¥åˆ›å»ºç›®å½•ã€‚\nè¯­æ³•ï¼šmkdir (é€‰é¡¹)(å‚æ•°)\n ä¸»è¦é€‰é¡¹ï¼š\n-m\u0026lt;ç›®æ ‡å±æ€§\u0026gt;æˆ–\u0026ndash;mode\u0026lt;ç›®æ ‡å±æ€§\u0026gt;å»ºç«‹ç›®å½•çš„åŒæ—¶è®¾ç½®ç›®å½•çš„æƒé™ï¼›\n-pæˆ–\u0026ndash;parents è‹¥æ‰€è¦å»ºç«‹ç›®å½•çš„ä¸Šå±‚ç›®å½•ç›®å‰å°šæœªå»ºç«‹ï¼Œåˆ™ä¼šä¸€å¹¶å»ºç«‹ä¸Šå±‚ç›®å½•ï¼›\nå‚æ•°ï¼š\næŒ‡å®šè¦åˆ›å»ºçš„ç›®å½•åˆ—è¡¨ï¼Œå¤šä¸ªç›®å½•ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€ã€‚\n åˆ›å»ºå¤šå±‚ç›®å½•ï¼š\n1  mkdir a/b/c/d   chmod chmodå‘½ä»¤ç”¨æ¥å˜æ›´æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚\nè¯­æ³•ï¼šchmod(é€‰é¡¹)(å‚æ•°)\næƒé™èŒƒå›´çš„è¡¨ç¤ºæ³•å¦‚ä¸‹ï¼š\nu Userï¼Œå³æ–‡ä»¶æˆ–ç›®å½•çš„æ‹¥æœ‰è€…ï¼›\ng Groupï¼Œå³æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±ç¾¤ç»„ï¼›\no Otherï¼Œé™¤äº†æ–‡ä»¶æˆ–ç›®å½•æ‹¥æœ‰è€…æˆ–æ‰€å±ç¾¤ç»„ä¹‹å¤–ï¼Œå…¶ä»–ç”¨æˆ·çš†å±äºè¿™ä¸ªèŒƒå›´ï¼›\na Allï¼Œå³å…¨éƒ¨çš„ç”¨æˆ·ï¼ŒåŒ…å«æ‹¥æœ‰è€…ï¼Œæ‰€å±ç¾¤ç»„ä»¥åŠå…¶ä»–ç”¨æˆ·ï¼›\nr è¯»å–æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ4â€;\nw å†™å…¥æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ2â€ï¼›\nx æ‰§è¡Œæˆ–åˆ‡æ¢æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ1â€ï¼›\n- ä¸å…·ä»»ä½•æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ0â€ï¼›\ns ç‰¹æ®ŠåŠŸèƒ½è¯´æ˜ï¼šå˜æ›´æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚\nä¾‹å­ï¼š\n1 2 3 4  chmod u+x,g+w f01ã€€//ä¸ºæ–‡ä»¶f01è®¾ç½®è‡ªå·±å¯ä»¥æ‰§è¡Œï¼Œç»„å‘˜å¯ä»¥å†™å…¥çš„æƒé™ chmod u=rwx,g=rw,o=r f01 chmod 764 f01 chmod a+x f01ã€€//å¯¹æ–‡ä»¶f01çš„u,g,oéƒ½è®¾ç½®å¯æ‰§è¡Œå±æ€§   å¯ä»¥è¾“å…¥å‘½ä»¤ll -d æ–‡ä»¶åæŸ¥çœ‹æ–‡ä»¶çš„æƒé™ï¼š\nlinuxæ–‡ä»¶çš„ç”¨æˆ·æƒé™çš„åˆ†æå›¾\nä¾‹ï¼šrwxã€€rw-ã€€r\u0026ndash;\nr=è¯»å–å±æ€§ã€€//å€¼ï¼4\nw=å†™å…¥å±æ€§ã€€//å€¼ï¼2\nx=æ‰§è¡Œå±æ€§ã€€//å€¼ï¼1\nå¯¹demo.shæ‰§è¡Œchmod a+x demo.shä¹‹åï¼ŒæŸ¥çœ‹å…¶æƒé™ï¼Œä¸‰ä¸ªç»„éƒ½å«xï¼Œè¡¨ç¤ºæ‰€æœ‰ç”¨æˆ·éƒ½èƒ½æ‰§è¡Œï¼š\nShellè„šæœ¬ shellè„šæœ¬ä¸€èˆ¬ä»¥.shç»“å°¾ã€‚å¦‚demo.shï¼š\n1 2 3  #!/bin/bash #This is my First shell echo \u0026#34;Hello World!\u0026#34;    ç¬¬ä¸€è¡Œè¡¨ç¤ºè„šæœ¬çš„ä½ç½®\nç¬¬äºŒè¡Œä¸ºæ³¨é‡Š\nç¬¬ä¸‰è¡Œä¸ºè„šæœ¬çš„å‘½ä»¤\n å¦‚ä½•æ‰§è¡Œï¼Ÿåœ¨Linuxä¸‹éœ€è¦å…ˆèµ‹äºˆæƒé™\n1  chmod o+x demo.sh   æ‰§è¡Œ\n1  ./demo.sh   å¸¸è§çš„å˜é‡\n$0å½“å‰ç¨‹åºçš„åç§°\n$nå½“å‰ç¨‹åºçš„ç¬¬ n ä¸ªå‚æ•°,n=1,2,â€¦9\n$* å½“å‰ç¨‹åºçš„æ‰€æœ‰å‚æ•°(ä¸åŒ…æ‹¬ç¨‹åºæœ¬èº«)\n$# å½“å‰ç¨‹åºçš„å‚æ•°ä¸ªæ•°(ä¸åŒ…æ‹¬ç¨‹åºæœ¬èº«)\n$? å‘½ä»¤æˆ–ç¨‹åºæ‰§è¡Œå®Œåçš„çŠ¶æ€ï¼Œä¸€èˆ¬è¿”å› 0 è¡¨ç¤ºæ‰§è¡ŒæˆåŠŸã€‚\n$UID å½“å‰ç”¨æˆ·çš„ ID\n$PWD å½“å‰æ‰€åœ¨çš„ç›®å½•\nIf æ¡ä»¶åˆ¤æ–­è¯­å¥ æ ¼å¼ï¼š\n1 2 3 4 5  if (è¡¨è¾¾å¼) #if ( Variable in Array ) è¯­å¥ 1 else è¯­å¥ 2 fi   ä¾‹ï¼š\n1 2 3 4 5  #!/bin/sh NUM=100 if (( $NUM \u0026gt; 4 )) ;then echo â€œthis num is $NUM greater 4 !â€ fi   å‚è€ƒï¼š\n https://wangchujiang.com/linux-command/ ","description":"","id":92,"section":"posts","tags":["Linux","Shell","bash"],"title":"Linuxå‘½ä»¤ä¸Shell","uri":"https://hugo.jiahongw.com/zh/posts/linux/linux-shell/"},{"content":"Dockeræ˜¯åŸºäºå†…æ ¸çš„å®¹å™¨,å¯ä»¥è¿è¡Œåœ¨å®¿ä¸»æœºä¸Š,çœ‹ä½œæ˜¯ä¸€ä¸ªå®¹å™¨.\nDockerğŸ‹ å®‰è£…é…ç½® ç•¥,å¯ä»¥ç™¾åº¦æœç´¢.å¦‚ä¸‹:\nhttps://juejin.im/post/5dc241ce6fb9a04aa333c1bd\nåŸºæœ¬ä½¿ç”¨ å®‰è£…å®Œæˆä¹‹å,å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ç‰ˆæœ¬\n1  docker version   æ‹‰å–å¹¶ä¸”è¿è¡Œhello-worldé•œåƒè¿›è¡Œæµ‹è¯•\ndocker run hello-world æŸ¥çœ‹æœ¬åœ°é•œåƒ:\ndocker image ls æœ¬åœ°æœ‰ä¸€ä¸ªhello-worldé•œåƒ\nImageçš„è·å– 1. ä»Dockerfileåˆ¶ä½œ 2. ä»Registeræ‹‰å–(Pull from Register) ä¾‹å¦‚:\n1  docker pull ubuntu:14.04   å¯ä»¥åœ¨DockerHubé‡Œé¢æœç´¢ç›¸å…³çš„é•œåƒ\næ·»åŠ Dockerç”¨æˆ·æƒé™ï¼Œåˆ›å»ºdockerç»„\n1  sudo groupadd docker   1  sudo gpasswd -a vagrant docker   1  sudo service docker restart   æœ€åé‡æ–°ç™»é™†æœåŠ¡å™¨å³å¯\nè‡ªå®šä¹‰image æ„å»ºä¸€ä¸ªè¾“å‡ºä¿¡æ¯çš„Cè¯­è¨€ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶é•œåƒ\né¦–å…ˆç¼–å†™Cæ–‡ä»¶,å¦‚ä¸‹:\n1 2 3 4 5 6  #include \u0026lt;stdio.h\u0026gt;int main(){ printf(\u0026#34;Hello,Docker!\\n\u0026#34;); return 0; }   å®‰è£…gccåŠç›¸å…³åº“:\n1 2  sudo yum install gcc sudo yum install glibc-static   ç¼–è¯‘:\n1  gcc -static hello.c -o hello   åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºDockerfile\n1  vim Dockerfile   ç¼–å†™ä¸‹é¢çš„å†…å®¹\n1 2 3  FROM scratch ADD hello / CMD [\u0026#34;/hello\u0026#34;]   ä½¿ç”¨dockeræ„å»º:\n1  docker build -t victorhong/hello .   å…¶ä¸­victorhongæ˜¯ç”¨æˆ·å,helloæ˜¯é•œåƒå,.è¡¨ç¤ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹\næ„å»ºå®Œå¯ä»¥æŸ¥çœ‹åˆ°é•œåƒ:\næŸ¥çœ‹æ„å»ºçš„å†å²\nè¿è¡Œå®¹å™¨\ndocker run victorhong/hello Container ä»€ä¹ˆæ˜¯container?\næŸ¥çœ‹container\n1  docker container ls   æŸ¥çœ‹æ‰€æœ‰cpntainer,åŒ…æ‹¬ç»“æŸçš„\n1  docker container ls -a   è¿è¡Œubuntu:16.04æ˜¯é©¬ä¸Šå°±ä¼šç»“æŸçš„,è¦æƒ³äº¤äº’å¼çš„æ‰§è¡Œå®¹å™¨,ä½¿ç”¨ä»¥ä¸‹çš„mingl\n1  docker run -it ubuntu:16.04   å¦å¤–å¼€ä¸€ä¸ªçª—å£,æŸ¥çœ‹container\n1  docker container ls   å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªubuntuå®¹å™¨æ­£åœ¨è¿è¡Œ\næ„å»ºè‡ªå·±çš„Dockeré•œåƒ   docker container commit\n1  docker commit clever_franklin victorhong/centos-vim   åœ¨å¯¹å®¹å™¨è¿›è¡Œä¿®æ”¹äº†ä¹‹å,clever_franklinä¸ºå®¹å™¨å,victorhong/centos-vimä¸ºæäº¤çš„é•œåƒå\n  Dockerfile build\n1 2  FROMcentosRUN yum install -y vim  ç„¶åæ‰§è¡Œ\n1  docker build -t victorhong/centos-vim-new .     Dockerfileè¯­æ³• FROM å®šä¹‰base image\nLabel å®šä¹‰æ•°æ®ä¿¡æ¯,ç±»ä¼¼æ³¨é‡Š\n Metadataä¸å¯å°‘\n RUN æ¯æ‰§è¡Œä¸€æ¬¡run,éƒ½ä¼šæ–°å»ºä¸€å±‚,å°½é‡å°‘ç”¨å¤šæ¬¡run\nWORKDIR è®¾å®šå½“å‰å·¥ä½œç›®å½•,ç±»ä¼¼cd\n æ³¨æ„:\n ADD and COPY ADDè¿˜æœ‰è§£å‹åŠŸèƒ½\nENV è®¾ç½®ç¯å¢ƒå˜é‡æˆ–è€…å¸¸é‡å˜é‡\nå°½é‡ä½¿ç”¨ENVå¢åŠ å¯ç»´æŠ¤æ€§\nVOLUME ADN EXPOSE VOLUMEç”¨äºæŒ‚è½½æ•°æ®å·ï¼ŒEXPOSEç”¨äºæš´éœ²ç«¯å£\nCMD and ENTRYPOINT åŒºåˆ«:\næ‰§è¡Œå‘½ä»¤æ ¼å¼:\nGitHubä¸Šçš„å®˜æ–¹Dockerfile\né•œåƒçš„å‘å¸ƒ ä½¿ç”¨DockerHubå»push\nç™»é™†docker\n1  docker login   push\n1  docker push victorhongdream/hello:latest   æŸ¥çœ‹DockerHub\n","description":"","id":93,"section":"posts","tags":["docker"],"title":"å…¥é—¨Docker","uri":"https://hugo.jiahongw.com/zh/posts/middleware/docker-begin/"},{"content":"C++ç‰¹æ€§ä¹‹å¤šæ€ğŸ„\né™æ€ç±»å‹ æ˜¯æŒ‡ä¸éœ€è¦è€ƒè™‘è¡¨è¾¾å¼çš„æ‰§è¡ŒæœŸè¯­ä¹‰ï¼Œä»…åˆ†æç¨‹åºæ–‡æœ¬è€Œå†³å®šçš„è¡¨è¾¾å¼ç±»å‹ã€‚\nåŠ¨æ€ç±»å‹ æ˜¯æŒ‡ç”±ä¸€ä¸ªå·¦å€¼è¡¨è¾¾å¼è¡¨ç¤ºçš„å·¦å€¼æ‰€å¼•ç”¨çš„æœ€ç»ˆæ´¾ç”Ÿå¯¹è±¡çš„ç±»å‹ã€‚\nåŠ¨æ€ç»‘å®šä¸é™æ€ç»‘å®š **é™æ€ç»‘å®šï¼š**ç¼–è¯‘æ—¶ç»‘å®šï¼Œé€šè¿‡å¯¹è±¡è°ƒç”¨\n**åŠ¨æ€ç»‘å®šï¼š**è¿è¡Œæ—¶ç»‘å®šï¼Œé€šè¿‡åœ°å€å®ç°\nä½•æ—¶ä½¿ç”¨åŠ¨æ€ç»‘å®š?\n åªæœ‰é‡‡ç”¨â€œæŒ‡é’ˆ-\u0026gt;å‡½æ•°()â€æˆ–â€œå¼•ç”¨å˜é‡.å‡½æ•°()â€çš„æ–¹å¼è°ƒç”¨C++ç±»ä¸­çš„è™šå‡½æ•°æ‰ä¼šæ‰§è¡ŒåŠ¨æ€ç»‘å®šã€‚ å¯¹äºC++ä¸­çš„éè™šå‡½æ•°ï¼Œå› ä¸ºå…¶ä¸å…·å¤‡åŠ¨æ€ç»‘å®šçš„ç‰¹å¾ï¼Œæ‰€ä»¥ä¸ç®¡é‡‡ç”¨ä»€ä¹ˆæ ·çš„æ–¹å¼è°ƒç”¨ï¼Œéƒ½ä¸ä¼šæ‰§è¡ŒåŠ¨æ€ç»‘å®šã€‚   æ€»çš„æ¥æ‰€,åŠ¨æ€ç»‘å®šæ‰§è¡Œçš„å‡½æ•°åªé’ˆå¯¹è™šå‡½æ•°,æ‰§è¡Œè™šå‡½æ•°ä¼šåŠ¨æ€æ‰§è¡Œ,è€Œéè™šå‡½æ•°å°±ç›´æ¥æ‰§è¡ŒåŸºç±»ç±»å‹çš„å‡½æ•°,ä¹Ÿå°±æ˜¯è¯´æŒ‡é’ˆç±»å‹æ˜¯ä»€ä¹ˆï¼Œå°±ä¼šè°ƒç”¨è¯¥ç±»å‹ç›¸åº”çš„å‡½æ•°ã€‚\n ä¾‹å¦‚ä¸‹é¢çš„ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  #include \u0026lt;iostream\u0026gt;using namespace std; class Base { public: void func() { cout \u0026lt;\u0026lt; \u0026#34;func() in Base.\u0026#34; \u0026lt;\u0026lt; endl; } virtual void test() { cout \u0026lt;\u0026lt; \u0026#34;test() in Base.\u0026#34; \u0026lt;\u0026lt; endl; } }; class Derived : public Base { void func() { cout \u0026lt;\u0026lt; \u0026#34;func() in Derived.\u0026#34; \u0026lt;\u0026lt; endl; } virtual void test() { cout \u0026lt;\u0026lt; \u0026#34;test() in Derived.\u0026#34; \u0026lt;\u0026lt; endl; } }; int main() { Base *b; b = new Derived(); b-\u0026gt;func(); b-\u0026gt;test(); }   è¾“å‡ºä¸º:\nfunc() in Base. test() in Derived. å†ä¾‹å¦‚ä¸‹é¢çš„ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  class A { public: virtual void func(int val = 1) { std::cout\u0026lt;\u0026lt;\u0026#34;A-\u0026gt;\u0026#34;\u0026lt;\u0026lt;val \u0026lt;\u0026lt;std::endl;} virtual void test() { func();} }; class B : public A { public: void func(int val=0) {std::cout\u0026lt;\u0026lt;\u0026#34;B-\u0026gt;\u0026#34;\u0026lt;\u0026lt;val \u0026lt;\u0026lt;std::endl;} }; int main(int argc ,char* argv[]) { B*p = new B; p-\u0026gt;test(); return 0; }   è¾“å‡ºä¸º: B-\u0026gt;1\n test()æ˜¯è™šå‡½æ•°,p-\u0026gt;test()ä¼šåŠ¨æ€è°ƒç”¨Bç±»ä¸­çš„test()å‡½æ•°,å¹¶ä¸”,è¿˜éœ€è¦è®°ä½ä¸€ä¸ªç»“è®º:virtual å‡½æ•°æ˜¯åŠ¨æ€ç»‘å®šï¼Œè€Œç¼ºçœå‚æ•°å€¼å´æ˜¯é™æ€ç»‘å®š,ç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„ç¼ºçœå‚æ•°å€¼ï¼\n è™šå‡½æ•°ã€åŠ¨æ€ç»‘å®šã€è¿è¡Œæ—¶å¤šæ€ä¹‹é—´çš„å…³ç³» è¦è§¦å‘åŠ¨æ€ç»‘å®šï¼Œéœ€æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š\n  åªæœ‰è™šå‡½æ•°æ‰èƒ½è¿›è¡ŒåŠ¨æ€ç»‘å®šï¼Œéè™šå‡½æ•°ä¸è¿›è¡ŒåŠ¨æ€ç»‘å®šã€‚\n  å¿…é¡»é€šè¿‡åŸºç±»ç±»å‹çš„å¼•ç”¨æˆ–æŒ‡é’ˆè¿›è¡Œå‡½æ•°è°ƒç”¨ã€‚\n  ç®€å•åœ°è¯´ï¼Œè™šå‡½æ•°æ˜¯åŠ¨æ€ç»‘å®šçš„åŸºç¡€ï¼›åŠ¨æ€ç»‘å®šæ˜¯å®ç°è¿è¡Œæ—¶å¤šæ€çš„åŸºç¡€ã€‚\n https://blog.csdn.net/iicy266/article/details/11906509 C++ä¸­çš„åŠ¨æ€ç±»å‹ä¸åŠ¨æ€ç»‘å®šã€è™šå‡½æ•°ã€è¿è¡Œæ—¶å¤šæ€çš„å®ç° ","description":"","id":94,"section":"posts","tags":["C++","å¤šæ€"],"title":"C++åŠ¨æ€ä¸é™æ€","uri":"https://hugo.jiahongw.com/zh/posts/candcplusplus/cpp-duotai/"},{"content":"cæ–‡ä»¶è¯»å†™ğŸ—ƒ\nFILEå¯¹è±¡ç»“æ„ä½“ 1 2 3 4 5 6 7 8  typedef struct { int _fd; // æ–‡ä»¶å·  int _cleft; // ç¼“å†²åŒºä¸­å‰©ä¸‹çš„å­—èŠ‚æ•°  int _mode; // æ–‡ä»¶æ“ä½œæ¨¡å¼  char * _nextc; // ä¸‹ä¸€ä¸ªå­—èŠ‚çš„ä½ç½®  char * _buff; // æ–‡ä»¶ç¼“å†²åŒºä½ç½® }FILE;   æ‰“å¼€æ–‡ä»¶ å¯ä»¥ä½¿ç”¨ fopen( ) å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶æˆ–è€…æ‰“å¼€ä¸€ä¸ªå·²æœ‰çš„æ–‡ä»¶ï¼Œè¿™ä¸ªè°ƒç”¨ä¼šåˆå§‹åŒ–ç±»å‹ FILE çš„ä¸€ä¸ªå¯¹è±¡ï¼Œç±»å‹ FILE åŒ…å«äº†æ‰€æœ‰ç”¨æ¥æ§åˆ¶æµçš„å¿…è¦çš„ä¿¡æ¯ã€‚ä¸‹é¢æ˜¯è¿™ä¸ªå‡½æ•°è°ƒç”¨çš„åŸå‹ï¼š\n1  FILE *fopen( const char * filename, const char * mode );   mode çš„å€¼å¯ä»¥æ˜¯r,w,a,,r+,w+,a+:\n   r æ‰“å¼€ä¸€ä¸ªå·²æœ‰çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå…è®¸è¯»å–æ–‡ä»¶ã€‚     w æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…è®¸å†™å…¥æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨çš„ç¨‹åºä¼šä»æ–‡ä»¶çš„å¼€å¤´å†™å…¥å†…å®¹ã€‚å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™è¯¥ä¼šè¢«æˆªæ–­ä¸ºé›¶é•¿åº¦ï¼Œé‡æ–°å†™å…¥ã€‚   a æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œä»¥è¿½åŠ æ¨¡å¼å†™å…¥æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨çš„ç¨‹åºä¼šåœ¨å·²æœ‰çš„æ–‡ä»¶å†…å®¹ä¸­è¿½åŠ å†…å®¹ã€‚   r+ æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…è®¸è¯»å†™æ–‡ä»¶ã€‚   w+ æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…è®¸è¯»å†™æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™æ–‡ä»¶ä¼šè¢«æˆªæ–­ä¸ºé›¶é•¿åº¦ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚   a+ æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…è®¸è¯»å†™æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚è¯»å–ä¼šä»æ–‡ä»¶çš„å¼€å¤´å¼€å§‹ï¼Œå†™å…¥åˆ™åªèƒ½æ˜¯è¿½åŠ æ¨¡å¼ã€‚    å¦‚æœå¤„ç†çš„æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåˆ™éœ€ä½¿ç”¨ä¸‹é¢çš„è®¿é—®æ¨¡å¼æ¥å–ä»£ä¸Šé¢çš„è®¿é—®æ¨¡å¼ï¼š\n1  \u0026#34;rb\u0026#34;, \u0026#34;wb\u0026#34;, \u0026#34;ab\u0026#34;, \u0026#34;rb+\u0026#34;, \u0026#34;r+b\u0026#34;, \u0026#34;wb+\u0026#34;, \u0026#34;w+b\u0026#34;, \u0026#34;ab+\u0026#34;, \u0026#34;a+b\u0026#34;     å…³é—­æ–‡ä»¶ å…³é—­æ–‡ä»¶éå¸¸ç®€å•,åªéœ€è¦è°ƒç”¨**fclose()**å‡½æ•°å³å¯,å…¶ä¸­å‚æ•°å°±æ˜¯æŒ‡å‘æ–‡ä»¶å¯¹è±¡çš„æŒ‡é’ˆ.\n1  int fclose( FILE *fp );   å¦‚æœæˆåŠŸå…³é—­æ–‡ä»¶ï¼Œfclose( ) å‡½æ•°è¿”å›é›¶ï¼Œå¦‚æœå…³é—­æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ï¼Œå‡½æ•°è¿”å› EOFã€‚è¿™ä¸ªå‡½æ•°å®é™…ä¸Šï¼Œä¼šæ¸…ç©ºç¼“å†²åŒºä¸­çš„æ•°æ®ï¼Œå…³é—­æ–‡ä»¶ï¼Œå¹¶é‡Šæ”¾ç”¨äºè¯¥æ–‡ä»¶çš„æ‰€æœ‰å†…å­˜ã€‚EOF æ˜¯ä¸€ä¸ªå®šä¹‰åœ¨å¤´æ–‡ä»¶ stdio.h ä¸­çš„å¸¸é‡ã€‚  demo 1 2 3 4 5 6 7 8 9 10 11 12 13  void open_close_file(){ char fname[10]; printf(\u0026#34;pease input file name: \u0026#34;); scanf(\u0026#34;%s\u0026#34;,fname); FILE *p = fopen(fname,\u0026#34;r+\u0026#34;); if(p == NULL) { printf(\u0026#34;file open fail!\\n\u0026#34;); return ; } printf(\u0026#34;file %s open sucessful!\\n\u0026#34;,fname); fclose(p); printf(\u0026#34;file %s had be closed!\\n\u0026#34;,fname); }   è¯»å–æ–‡ä»¶ è¯»å–å•ä¸ªå­—ç¬¦çš„æœ€ç®€å•çš„å‡½æ•°:\n1  int fgetc( FILE * fp );   è¯»å–å¤šä¸ªå­—ç¬¦çš„å‡½æ•°(ä¹Ÿå¯ä»¥è¯»å–å•ä¸ªå­—ç¬¦):\n1  char *fgets( char *buf, int n, FILE *fp );   fgetc() å‡½æ•°ä» fp æ‰€æŒ‡å‘çš„è¾“å…¥æ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ªå­—ç¬¦ã€‚è¿”å›å€¼æ˜¯è¯»å–çš„å­—ç¬¦ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯åˆ™è¿”å› EOFã€‚\nå‡½æ•° fgets() ä» fp æ‰€æŒ‡å‘çš„è¾“å…¥æµä¸­è¯»å– n - 1 ä¸ªå­—ç¬¦ã€‚å®ƒä¼šæŠŠè¯»å–çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ°ç¼“å†²åŒº bufï¼Œå¹¶åœ¨æœ€åè¿½åŠ ä¸€ä¸ª null å­—ç¬¦æ¥ç»ˆæ­¢å­—ç¬¦ä¸²ã€‚\n ä¾‹å­:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  void read_file_demo() { char fname[10] = \u0026#34;basic.sql\u0026#34;; FILE *fp = fopen(fname, \u0026#34;r+\u0026#34;); if (fp == NULL) { printf(\u0026#34;file open fail!\\n\u0026#34;); return; } printf(\u0026#34;file %s open sucessful!\\n\u0026#34;, fname); char ch; int n = 5; printf(\u0026#34;\\nusing fgetc()......\\n\u0026#34;); while (n--) { ch = fgetc(fp); if(ch != EOF) printf(\u0026#34;char = %c\\n\u0026#34;, ch); } char str[20]; printf(\u0026#34;\\nusing fgets()......\\n\u0026#34;); fgets(str,20,fp); printf(\u0026#34;str[20] = %s\\n\u0026#34;,str); fclose(fp); printf(\u0026#34;file %s had be closed!\\n\u0026#34;, fname); }   è¯»å–äºŒè¿›åˆ¶è¾“å…¥:\n1  size_t fread(void *buffer, size_t size, size_t count, FILE * stream);    bufferä¸ºæ¥æ”¶æ•°æ®çš„åœ°å€ï¼Œsizeä¸ºä¸€ä¸ªå•å…ƒçš„å¤§å°ï¼Œcountä¸ºå•å…ƒä¸ªæ•°ï¼Œstreamä¸ºæ–‡ä»¶æµã€‚\nè¿”å›å®é™…è¯»å–çš„å•å…ƒä¸ªæ•°ã€‚å¦‚æœå°äºcountï¼Œåˆ™å¯èƒ½æ–‡ä»¶ç»“æŸæˆ–è¯»å–å‡ºé”™ï¼›å¯ä»¥ç”¨ferror()æ£€æµ‹æ˜¯å¦è¯»å–å‡ºé”™ï¼Œç”¨feof()å‡½æ•°æ£€æµ‹æ˜¯å¦åˆ°è¾¾æ–‡ä»¶ç»“å°¾ã€‚å¦‚æœsizeæˆ–countä¸º0ï¼Œåˆ™è¿”å›0ã€‚\n å†™å…¥æ–‡ä»¶ å†™å…¥å•ä¸ªå­—ç¬¦çš„æœ€ç®€å•çš„å‡½æ•°:\n1  int fputc( int c, FILE *fp );   å†™å…¥å¤šä¸ªå­—ç¬¦çš„å‡½æ•°(ä¹Ÿå¯ä»¥å†™å…¥å•ä¸ªå­—ç¬¦):\n1  int fputs( const char *s, FILE *fp );   å‡½æ•° fputc() æŠŠå‚æ•° c çš„å­—ç¬¦å€¼å†™å…¥åˆ° fp æ‰€æŒ‡å‘çš„è¾“å‡ºæµä¸­ã€‚å¦‚æœå†™å…¥æˆåŠŸï¼Œå®ƒä¼šè¿”å›å†™å…¥çš„å­—ç¬¦ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™ä¼šè¿”å› EOFã€‚\nå‡½æ•° fputs() æŠŠå­—ç¬¦ä¸² s å†™å…¥åˆ° fp æ‰€æŒ‡å‘çš„è¾“å‡ºæµä¸­ã€‚å¦‚æœå†™å…¥æˆåŠŸï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªéè´Ÿå€¼ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™ä¼šè¿”å› EOFã€‚\n ä¾‹å­:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  void write_file_demo() { char fname[10] = \u0026#34;test.txt\u0026#34;; FILE *fp = fopen(fname, \u0026#34;w+\u0026#34;); if (fp == NULL) { printf(\u0026#34;file open fail!\\n\u0026#34;); return; } printf(\u0026#34;file %s open sucessful!\\n\u0026#34;, fname); char ch; int n = 5; printf(\u0026#34;\\nusing fputc()......\\n\u0026#34;); while (n--) { ch = (char)(100+n); if((ch = fputc(ch,fp)) != EOF) printf(\u0026#34;char %c write successful!\\n\u0026#34;,ch); } char str[30] = \u0026#34;\\nIt`s a test for write!\u0026#34;; printf(\u0026#34;\\nusing fputs()......\\n\u0026#34;); int r = fputs(str,fp); if(r \u0026gt;= 0) printf(\u0026#34;str[30] = %s write successful!\\n\u0026#34;,str); fclose(fp); printf(\u0026#34;file %s had be closed!\\n\u0026#34;, fname); }   äºŒè¿›åˆ¶è¾“å‡º:\n1  size_t fwrite(void * buffer, size_t size, size_t count, FILE * stream);    bufferä¸ºæ•°æ®æºåœ°å€ï¼Œsizeä¸ºæ¯ä¸ªå•å…ƒçš„å­—èŠ‚æ•°ï¼Œcountä¸ºå•å…ƒä¸ªæ•°ï¼Œstreamä¸ºæ–‡ä»¶æµæŒ‡é’ˆã€‚\nè¿”å›æˆåŠŸå†™å…¥çš„å•å…ƒä¸ªæ•°ã€‚å¦‚æœå°äºcountï¼Œåˆ™è¯´æ˜å‘ç”Ÿäº†é”™è¯¯ï¼Œæ–‡ä»¶æµé”™è¯¯æ ‡å¿—ä½å°†è¢«è®¾ç½®ï¼Œéšåå¯ä»¥é€šè¿‡ferror()å‡½æ•°åˆ¤æ–­ã€‚\n å‚è€ƒ:\n https://www.runoob.com/cprogramming/c-file-io.html ","description":"","id":95,"section":"posts","tags":["C","æ–‡ä»¶è¯»å†™"],"title":"Cæ–‡ä»¶è¯»å†™","uri":"https://hugo.jiahongw.com/zh/posts/candcplusplus/c-read-write/"},{"content":"åœ¨markdownæ–‡ä»¶ä¸­åµŒå…¥htmlä»£ç .ğŸ›¶\nä½¿ç”¨è‡ªå®šä¹‰æ–‡å­—æ ·å¼ è¾“å…¥ä»£ç :\n1  \u0026lt;span style=\u0026#34;font-size:2rem; background:yellow;\u0026#34;\u0026gt;**Bigger**\u0026lt;/span\u0026gt;   Bigger\nè®¾ç½®é”®ç›˜æŒ‰é”® è¾“å…¥ä»£ç :\n1  \u0026lt;kbd\u0026gt;Ctrl\u0026lt;/kbd\u0026gt;+\u0026lt;kbd\u0026gt;F9\u0026lt;/kbd\u0026gt;   Ctrl+F9\nå…¶ä»–ç½‘ç«™æ‘˜å½•çš„html 1  \u0026lt;blockquote class=\u0026#34;twitter-tweet\u0026#34;\u0026gt;\u0026lt;p lang=\u0026#34;en\u0026#34; dir=\u0026#34;ltr\u0026#34;\u0026gt;Sunsets don\u0026amp;#39;t get much better than this one over \u0026lt;a href=\u0026#34;https://twitter.com/GrandTetonNPS?ref_src=twsrc%5Etfw\u0026#34;\u0026gt;@GrandTetonNPS\u0026lt;/a\u0026gt;. \u0026lt;a href=\u0026#34;https://twitter.com/hashtag/nature?src=hash\u0026amp;amp;ref_src=twsrc%5Etfw\u0026#34;\u0026gt;#nature\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;https://twitter.com/hashtag/sunset?src=hash\u0026amp;amp;ref_src=twsrc%5Etfw\u0026#34;\u0026gt;#sunset\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;http://t.co/YuKy2rcjyU\u0026#34;\u0026gt;pic.twitter.com/YuKy2rcjyU\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026amp;mdash; US Department of the Interior (@Interior) \u0026lt;a href=\u0026#34;https://twitter.com/Interior/status/463440424141459456?ref_src=twsrc%5Etfw\u0026#34;\u0026gt;May 5, 2014\u0026lt;/a\u0026gt;\u0026lt;/blockquote\u0026gt; \u0026lt;script async src=\u0026#34;https://platform.twitter.com/widgets.js\u0026#34; charset=\u0026#34;utf-8\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;   Sunsets don\u0026#39;t get much better than this one over @GrandTetonNPS. #nature #sunset pic.twitter.com/YuKy2rcjyU\n\u0026mdash; US Department of the Interior (@Interior) May 5, 2014 ","description":"","id":96,"section":"posts","tags":["markdown","html"],"title":"åœ¨markdownä½¿ç”¨html","uri":"https://hugo.jiahongw.com/zh/posts/writingtips/markdown-html/"},{"content":"TCP/IPç¼–ç¨‹\n  ç›®æ ‡:  èƒ½è¿›è¡Œç½‘ç»œç¼–ç¨‹\n1.å¦‚æœä½ è¯´ä½ ä¼šselect,epoll,iocpæ¨¡å‹,é‚£ä¼šè®©å¯¹æ–¹è§‰å¾—æ›´é è°±\n2.å¦‚æœä½ è¯´å‡ºä½ åšè¿‡im,ä¸‹è½½ä¹‹ç±»é‚£ä¼šè®©å¯¹æ–¹æ¥å…´è¶£.\n3.å¦‚æœä½ è¯´è®¾è®¡äº†é€šè®¯åè®®,ä¼šè®©å¯¹æ–¹è§‰å¾—æ›´è´´åˆ‡\n4.å¦‚æœä½ è¯´åšè¿‡,ç†Ÿæ‚‰, ftp http snmp smtp è¿™äº›ç®€å•çš„è€å¤è‘£åè®®,ä¼šåŠ åˆ†,ä½†ä¸å¤§.\n5.å¦‚æœä½ è¯´ç†Ÿæ‚‰bt,emule,udtç­‰åè®®,é‚£ä¼šå¯¹ä½ å¾ˆæœ‰å¥½æ„Ÿ.\n6.å¦‚æœä½ è¯´ä½ ç ´è§£è¿‡æŸå¤§ç‰Œ qq,360å†…æŸé€šè®¯åè®®,é‚£ä¼šå¯¹ä½ åŠ åˆ†å¾ˆå¤§.\né˜¶æ®µ:\n1)ç†Ÿæ‚‰TCP/IPåè®®æ—çš„åŸºæœ¬åŸç†\nIPåœ°å€çš„åˆ†ç±»ï¼Œå®šä¹‰ï¼Œè·å¾—ï¼Œå¤§æ¦‚çš„ç®¡ç†æ–¹æ³•\nTCPã€UDPç­‰ä¸»è¦åè®®çš„ç‰¹ç‚¹ï¼Œä¸»è¦æ ¼å¼ï¼Œä»¥åŠé‡è¦å­—æ®µåœ¨åè®®äº¤äº’ä¸­èµ·åˆ°çš„ä½œç”¨ã€‚\n2ï¼‰å¯¹äºç®€å•çš„TCP/IPåè®®å¯¼è‡´çš„é—®é¢˜ï¼Œæœ‰åŸºæœ¬çš„åˆ¤æ–­\nç†Ÿæ‚‰ç½‘ç»œé—®é¢˜çš„è§£å†³æ–¹æ³•ï¼Œä¸€ä¸ªé—®é¢˜ï¼Œåº”è¯¥æ˜¯ç”±ä¸Šè€Œä¸‹ï¼ˆtop-buttonï¼‰ï¼Œè¿˜æ˜¯ç”±ä¸‹è€Œä¸Šï¼ˆbutton-topï¼‰æ¥åˆ†æï¼Ÿ\n3ï¼‰åŸºæœ¬çš„ç¼–ç¨‹çŸ¥è¯†ã€‚\nåœ¨ç³»ç»Ÿå†…ï¼Œæ„å»ºç®€å•é€šä¿¡ã€‚\nåœ¨ç³»ç»Ÿé—´ï¼Œæ„å»ºç®€å•çš„é€šä¿¡ã€‚\nç†Ÿæ‚‰ç³»ç»Ÿå†…çš„APIï¼ŒçŸ¥é“åœ¨ä»€ä¹ˆæ—¶å€™ï¼Œæ”¹ä½¿ç”¨å“ªäº›APIåè°ƒå·¥ä½œã€‚\nèƒ½å¤Ÿç†Ÿç»ƒä½¿ç”¨è¿™äº›APIï¼Œåœ¨ç³»ç»Ÿé—´ä¼ é€’ä¿¡æ¯ï¼Œæ–‡ä»¶ã€‚\nèƒ½å¤Ÿç†Ÿç»ƒä½¿ç”¨è¿™äº›APIï¼Œå®ç°è‡ªå·±çš„ç®€å•çš„ç§æœ‰åè®®ã€‚\n4ï¼‰è¿›é˜¶ç¼–ç¨‹çŸ¥è¯†\nçŸ¥é“ä¸€ä¸¤ä¸ªå·²ç»å°è£…å¥½çš„æ¡†æ¶ï¼ˆframworkï¼‰ï¼Œå®ƒä»¬ä¹‹é—´çš„å·®åˆ«ã€‚\nä½¿ç”¨ä¸€ä¸ªæ¡†æ¶ï¼Œå†™è¿‡èƒ½æ­£å¸¸å·¥ä½œçš„ç¨‹åºã€‚\nçŸ¥é“ç½‘ç»œåè®®å¤„ç†ä¹Ÿæ˜¯è¦è®²ç©¶æ€§èƒ½çš„ï¼ŒçŸ¥é“æ€§èƒ½çš„ç“¶é¢ˆä¼šåœ¨ä»€ä¹ˆåœ°æ–¹äº§ç”Ÿã€‚\nèƒ½æœ‰è¾ƒå¥½çš„è®¾è®¡æŠ€å·§ï¼Œå°†ç§æœ‰åè®®è®¾è®¡å¾—æ›´åŠ å…·æœ‰å¼¹æ€§ï¼Œä¼˜é›…ã€‚\nç†Ÿæ‚‰ç³»ç»Ÿé—´åè®®å¤„ç†çš„ç»†å¾®çš„å·®å¼‚ï¼Œä»¥åŠå°†ä¼šå¯¹ä¸šåŠ¡é€ æˆçš„å½±å“ï¼Œæ—¶å»¶ã€çŠ¶æ€ä¸ä¸€è‡´ã€è‡ªå®šä¹‰å­—æ®µã€ã€ã€ã€ã€\n5ï¼‰ç†Ÿç»ƒé˜¶æ®µçš„çŸ¥è¯†\né’ˆå¯¹ä¸šåŠ¡çš„éœ€æ±‚ï¼Œå¿«é€Ÿé€‰å‹ï¼Œå®šæ¡†æ¶ã€‚\nä¸å†è®¤ä¸ºå¤šçº¿ç¨‹æ˜¯ä¸‡èƒ½çš„ã€‚\nçŸ¥é“ç¨³å®šæ€§æ¯”æ€§èƒ½æ›´åŠ é‡è¦ã€‚\næ•°æ®åŒ…å»äº†å“ªå„¿ï¼Œä¸ç”¨çœ‹ä»£ç ï¼Œä¹Ÿèƒ½é¢„ä¼°å‡ºæ¥ã€‚\n6ï¼‰æºä»£ç æ˜¯æœ€å¥½çš„è€å¸ˆï¼Œæ°¸è¿œéƒ½æ˜¯ã€‚\nä»¥ä¸Šï¼Œå·®ä¸å¤šæˆ–è€…å·²ç»è¾¾åˆ°4ï¼‰çš„æ—¶å€™ï¼Œå°±æ˜¯â€œç†Ÿæ‚‰â€äº†ã€‚\n  ç½‘ç»œæ¨¡å‹ OSIæ¨¡å‹ TCP/IPæ¨¡å‹ ç¤ºä¾‹ åè®®å¯¹åº” æ•°æ®å°è£… C++UDP/TCPå®ä¾‹ å¥—æ¥å­— ä¸ºäº†åŒºåˆ†ä¸åŒåº”ç”¨ç¨‹åºè¿›ç¨‹å’Œè¿æ¥ï¼Œè®¸å¤šè®¡ç®—æœºæ“ä½œç³»ç»Ÿä¸ºåº”ç”¨ç¨‹åºä¸TCP/IPäº¤äº’æä¾›äº†ç§°ä¸º**åµŒå¥—å­—(Socket)**çš„æ¥å£ã€‚\nå¸¸ç”¨çš„TCP/IPæœ‰ä»¥ä¸‹ä¸‰ç§ç±»å‹çš„åµŒå¥—å­—ï¼š\n  æµå¼åµŒå¥—å­—ï¼ˆSOCK_STREAMï¼‰\nç”¨äºæä¾›é¢å‘è¿æ¥çš„ã€å¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œå³ä½¿ç”¨TCPè¿›è¡Œä¼ è¾“ã€‚\n  æ•°æ®æŠ¥åµŒå¥—å­—ï¼ˆSOCK_DGRAMï¼‰\nç”¨äºæä¾›æ— è¿æ¥çš„æœåŠ¡ï¼Œå³ä½¿ç”¨UDPè¿›è¡Œä¼ è¾“ã€‚\n  åŸå§‹åµŒå¥—å­—ï¼ˆSOCK_RAW\nå¯ä»¥è¯»å†™å†…æ ¸æ²¡æœ‰å¤„ç†çš„IPæ•°æ®æŠ¥ï¼Œè€Œæµå¼åµŒå¥—å­—åªèƒ½è¯»å–TCPçš„æ•°æ®ï¼Œæ•°æ®æŠ¥åµŒå¥—å­—åªèƒ½è¯»å–UDPçš„æ•°æ®.\n   å¦‚æœè¦è®¿é—®å…¶å®ƒåè®®å‘é€çš„æ•°æ®å¿…é¡»ä½¿ç”¨åŸå§‹åµŒå¥—å­—ï¼Œå®ƒå…è®¸å¯¹åº•å±‚åè®®(å¦‚IPæˆ–ICMP)ç›´æ¥è®¿é—®\n ç«¯å£å¯¹åº”è¿›ç¨‹ å•å•ä¹‹åipåœ°å€è¿˜ä¸è¶³ä»¥è¾¨è¯†é€šä¿¡çš„ä¸¤ä¸ªè¿›ç¨‹,å› ä¸ºæ“ä½œç³»ç»Ÿæ˜¯å¹¶å‘çš„,ä½¿ç”¨ç«¯å£æ¥è¾¨è®¤æŸä¸ªè¿›ç¨‹.æ‰€ä»¥å¥—æ¥å­—å¿…é¡»çš„ä¸¤ä¸ªä¿¡æ¯ä¸º: ipåœ°å€ + ç«¯å£,ä¾‹å¦‚: 192.168.1.4 1500\nå‚è€ƒ:\n https://www.jianshu.com/p/c1015f5ffa74 è¿›ç¨‹é—´é€šä¿¡ https://segmentfault.com/a/1190000003063859 Linux IOæ¨¡å¼åŠ selectã€pollã€epollè¯¦è§£ https://cloud.tencent.com/developer/article/1373483 å„ç§IOå¤ç”¨æ¨¡å¼ä¹‹selectï¼Œpollï¼Œepollï¼Œkqueueï¼Œiocpåˆ†æ ","description":"","id":97,"section":"posts","tags":["tcp","udp","ç½‘ç»œ"],"title":"Udp-Tcpç¼–ç¨‹","uri":"https://hugo.jiahongw.com/zh/posts/network/udp-tcp/"},{"content":"æ¯æ¬¡pushéƒ½éœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ,å…¶å®å¯ä»¥å…å»è¿™äº›æ“ä½œ.ğŸš›\n1. ä½¿ç”¨.git-credentialsæ–‡ä»¶ åœ¨gité¡¹ç›®ç›®å½•ä¸‹æ–°å»º.git-credentialsè¿™ä¸ªæ–‡ä»¶,ç„¶ååœ¨é‡Œé¢å¡«å†™ä¸‹é¢å†…å®¹(å¤§æ‹¬å·ä¸ç”¨å¡«å†™):\nhttps://{username}:{password}@github.com ç„¶ååœ¨gité¡¹ç›®ç›®å½•æ‰§è¡Œ:\n1  git config --global credential.helper store   æ‰§è¡Œæ­¤å‘½ä»¤åï¼Œç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„.gitconfigæ–‡ä»¶ä¼šå¤šäº†ä¸€é¡¹ï¼š[credential]\nhelper = store  æ³¨æ„: Linuxç”¨æˆ·ä¸»ç›®å½•ä¸€èˆ¬åœ¨~/ä¸‹,è€ŒWindowsä¸‹ä¸€èˆ¬ä¸ºC:\\users\\Administrator\n è¿™æ ·ä»¥åpushå°±ä¸éœ€è¦ç”¨æˆ·åå’Œå¯†ç äº†\n2. ä½¿ç”¨sshåè®® é¦–å…ˆç”Ÿæˆå¯†é’¥å¯¹,æ‰§è¡Œ\n1  ssh-keygen -t rsa -C \u0026#34;youremail\u0026#34;   æ¥ä¸‹æ¥æŒ‰ç…§æç¤ºæ“ä½œï¼Œé»˜è®¤å¯ä»¥ä¸€è·¯å¾€ä¸‹ã€‚\nç„¶åå°†ç”Ÿæˆçš„ä½äº~/.ssh/çš„id_rsa.pubçš„å†…å®¹å¤åˆ¶åˆ°ä½ github settingé‡Œçš„ssh keyä¸­ã€‚\nå¤åˆ¶ä¹‹åï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰å…‹éš†ä½ çš„ä»“åº“ï¼Œé‚£ä½ ç›´æ¥ä½¿ç”¨sshåè®®ç”¨æ³•ï¼šgit@github.com:yourusername/yourrepositorynameå…‹éš†å°±è¡Œäº†ã€‚\nå¦‚æœå·²ç»ä½¿ç”¨httpsåè®®å…‹éš†äº†ï¼Œé‚£ä¹ˆæŒ‰ç…§å¦‚ä¸‹æ–¹æ³•æ›´æ”¹åè®®ï¼š\ngit remote set-url origin git@github.com:yourusername/yourrepositoryname.git\nDone!\n3. ç®¡ç†å¤šgitè´¦å· å‚è€ƒ:\n https://www.jianshu.com/p/f7f4142a1556 ç®€ä¹¦ https://segmentfault.com/a/1190000012432367 https://juejin.im/post/5d6a23d45188252bd90f601a æ˜é‡‘ https://www.cnblogs.com/popfisher/p/5731232.html ","description":"","id":98,"section":"posts","tags":["git","github"],"title":"Gitå…å¯†push","uri":"https://hugo.jiahongw.com/zh/posts/git/git-push-no-pw/"},{"content":"AESç®—æ³•æ˜¯ç»§DESä¹‹åæ¯”è¾ƒå¿«ä¸”æ¯”è¾ƒç®€å•çš„åŠ å¯†ç®—æ³•.âš–\nå¯¹ç§°åŠ å¯† å¯¹ç§°åŠ å¯†æ¨¡å‹ å¦‚ä¸‹å›¾ï¼Œå‘é€è€…å’Œæ¥æ”¶è€…å…±äº«ä¸€ä¸ªä¸€æ ·çš„å¯†é’¥ï¼Œç›¸å½“äºç°å®ç”Ÿæ´»ä¸­çš„é”ï¼Œ\nå¯¹ç§°åŠ å¯†çš„ä½¿ç”¨è¦æ±‚  ä¸€ä¸ªå¼ºåŠ å¯†ç®—æ³• åªæœ‰å‘é€å‘å’Œæ¥æ”¶æ–¹çŸ¥é“ç§é’¥   åŠ å¯†ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œä¸éœ€ä¿å¯†ï¼›å¹¶ä¸”è§£å¯†ç®—æ³•æœ¬è´¨ä¸Šæ˜¯åŠ å¯†ç®—æ³•çš„åå‘æ‰§è¡Œã€‚\n ä½†æ˜¯ï¼Œå¦‚ä½•å®‰å…¨çš„åˆ†å‘å®‰å…¨å¯†é’¥å‘¢ï¼Ÿâ€”â€”â€”â€”â€”â€”å®‰å…¨åˆ†å‘ä¸å¯èƒ½å•é å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œå¸¸å¸¸ä½¿ç”¨çš„æ˜¯éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚\næ‰€ä»¥ï¼Œå¯¹ç§°åŠ å¯†çš„å®‰å…¨æ€§å–å†³äºå¯†é’¥çš„ä¿å¯†æ€§è€Œéç®—æ³•çš„ä¿å¯†æ€§ï¼Œé€šå¸¸è®¤ä¸ºå·²çŸ¥å¯†æ–‡å’ŒåŠ å¯†/åŠ å¯†ç®—æ³•çš„åŸºç¡€ä¸Šä¸èƒ½å¤Ÿç ´è¯‘ä¿¡æ¯ã€‚\nAESç®—æ³• ç®—æ³•åŸç†ï¼š AESå¯†ç ä¸åˆ†ç»„å¯†ç RijndaelåŸºæœ¬ä¸Šå®Œå…¨ä¸€è‡´ï¼ŒRijndaelåˆ†ç»„å¤§å°å’Œå¯†é’¥å¤§å°éƒ½å¯ä»¥ä¸º128ä½ã€192ä½å’Œ256ä½ã€‚ç„¶è€ŒAESåªè¦æ±‚åˆ†ç»„å¤§å°ä¸º128ä½ï¼Œå› æ­¤åªæœ‰åˆ†ç»„é•¿åº¦ä¸º128Bitçš„Rijndaelæ‰ç§°ä¸ºAESç®—æ³•ã€‚\nä¸‹é¢æ˜¯åˆ†ç»„é•¿åº¦ä¸º128ä½çš„AESç®—æ³•,è€Œkeyä½æ•°å¯ä»¥æ˜¯128/192/256,æœ¬æ¬¡å®éªŒé€‰æ‹©keyçš„å¤§å°ä½128ä½.\nç‰¹ç‚¹  æ˜æ–‡åˆ†ç»„è¢«æè¿°ä¸ºä¸€ä¸ªå­—èŠ‚æ–¹é˜µå¹¶å¤åˆ¶åˆ°çŠ¶æ€æ•°ç»„ï¼Œåœ¨æ¯è½®æ›¿æ¢å’Œç§»ä½æ—¶éƒ½å¹¶è¡Œå¤„ç†æ•´ä¸ªçŠ¶æ€åˆ†ç»„ã€‚ çŸ©é˜µä¸­å­—èŠ‚çš„é¡ºåºæ˜¯æŒ‰åˆ—æ’åºçš„ï¼Œä¾‹å¦‚128æ¯”ç‰¹çš„æ˜æ–‡åˆ†ç»„çš„å‰4ä¸ªå­—èŠ‚å è¾“å…¥çŸ©é˜µçš„ç¬¬ä¸€åˆ—ï¼Œæ¥ä¸‹æ¥çš„4ä¸ªå­—èŠ‚å ç¬¬äºŒåˆ—ï¼Œä¾æ¬¡ç±»æ¨ã€‚æ‰©å±•å­å¯†é’¥æ•°ç»„ä¹Ÿç±»ä¼¼æ“ä½œã€‚ å‡è®¾AESä½¿ç”¨128æ¯”ç‰¹çš„å¯†é’¥ï¼Œå…¶å¯†é’¥è¢«æè¿°ä¸ºä¸€ä¸ªå­—èŠ‚æ–¹é˜µå¹¶å°†æ‰©å±•æˆä¸ºä¸€ä¸ªå­å¯†é’¥æ•°ç»„w[i]ï¼ˆå…·æœ‰44ä¸ª32æ¯”ç‰¹å­—ï¼‰ï¼Œ4ä¸ªä¸åŒçš„å­—ï¼ˆå…±128æ¯”ç‰¹ï¼‰ç”¨ä½œæ¯è½®çš„è½®å¯†é’¥ã€‚ AESåœ¨æ¯è½®è¿ç®—ä¸­å°†è¿›è¡Œ4ä¸ªä¸åŒçš„æ­¥éª¤ï¼Œ1ä¸ªæ˜¯ç§»ä½ï¼Œ3ä¸ªæ˜¯æ›¿æ¢ã€‚  æ•°å­¦çŸ¥è¯† åœ¨AESç®—æ³•ä¸­çš„MixColumnå±‚ä¸­ä¼šç”¨åˆ°ä¼½ç½—ç“¦åŸŸä¸­çš„ä¹˜æ³•è¿ç®—ï¼Œè€Œä¼½ç½—ç“¦åŸŸçš„è¿ç®—æ¶‰åŠä¸€äº›æ•°å­¦çŸ¥è¯†ã€‚\nç´ åŸŸ æœ‰é™åŸŸæœ‰æ—¶ä¹Ÿç§°ä¼½ç½—ç“¦åŸŸï¼Œå®ƒæŒ‡çš„æ˜¯ç”±æœ‰é™ä¸ªå…ƒç´ ç»„æˆçš„é›†åˆï¼Œåœ¨è¿™ä¸ªé›†åˆå†…å¯ä»¥æ‰§è¡ŒåŠ ã€å‡ã€ä¹˜å’Œé€†è¿ç®—ã€‚è€Œåœ¨å¯†ç ç¼–ç å­¦ä¸­ï¼Œæˆ‘ä»¬åªç ”ç©¶æ‹¥æœ‰æœ‰é™ä¸ªå…ƒç´ çš„åŸŸï¼Œä¹Ÿå°±æ˜¯æœ‰é™åŸŸã€‚åŸŸä¸­åŒ…å«å…ƒç´ çš„ä¸ªæ•°ç§°ä¸ºåŸŸçš„é˜¶ã€‚åªæœ‰å½“mæ˜¯ä¸€ä¸ªç´ æ•°å¹‚æ—¶ï¼Œå³$m=p^n$(å…¶ä¸­nä¸ºæ­£æ•´æ•°æ˜¯pçš„æ¬¡æ•°ï¼Œpä¸ºç´ æ•°)ï¼Œé˜¶ä¸ºmçš„åŸŸæ‰å­˜åœ¨ã€‚pç§°ä¸ºè¿™ä¸ªæœ‰é™åŸŸçš„ç‰¹å¾ã€‚\nä¾‹å¦‚ï¼Œæœ‰é™åŸŸä¸­å…ƒç´ çš„ä¸ªæ•°å¯ä»¥æ˜¯11(p=11æ˜¯ä¸€ä¸ªç´ æ•°,n=1)ã€å¯ä»¥æ˜¯81(p=3æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œn=4)ã€ä¹Ÿå¯ä»¥æ˜¯256(p=2æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œn=8)\u0026hellip;..ä½†æœ‰é™åŸŸçš„ä¸­ä¸å¯èƒ½æ‹¥æœ‰12ä¸ªå…ƒç´ ï¼Œå› ä¸º12=2Â·2Â·3ï¼Œå› æ­¤12ä¹Ÿä¸æ˜¯ä¸€ä¸ªç´ æ•°å¹‚ã€‚å› æ­¤æ»¡è¶³pæ˜¯ä¸€ä¸ªç´ æ•°ä¸”æ»¡è¶³$m = p^n$è¿™ä¸ªå…¬å¼ï¼Œmæ‰æ˜¯ä¸€ä¸ªç´ æ•°å¹‚ã€‚\næœ‰é™åŸŸä¸­æœ€ç›´è§‚çš„ä¾‹å­å°±æ˜¯é˜¶ä¸ºç´ æ•°çš„åŸŸï¼Œå³n=1çš„åŸŸã€‚åŸŸGF(p)çš„å…ƒç´ å¯ä»¥ç”¨æ•´æ•°0ã€1ã€\u0026hellip;ã€p-1læ¥è¡¨ç¤ºã€‚åŸŸçš„ä¸¤ç§æ“ä½œå°±æ˜¯æ¨¡æ•´æ•°åŠ æ³•å’Œæ•´æ•°ä¹˜æ³•æ¨¡pã€‚åŠ ä¸Špæ˜¯ä¸€ä¸ªç´ æ•°ï¼Œæ•´æ•°ç¯Zè¡¨ç¤ºä¸ºGF(p)ï¼Œä¹Ÿæˆä¸ºæ‹¥æœ‰ç´ æ•°ä¸ªå…ƒç´ çš„ç´ æ•°åŸŸæˆ–è€…ä¼½ç½—ç“¦åŸŸã€‚GF(p)ä¸­æ‰€æœ‰çš„éé›¶å…ƒç´ éƒ½å­˜åœ¨é€†å…ƒï¼ŒGF(p)å†…æ‰€æœ‰çš„è¿ç®—éƒ½æ˜¯æ¨¡på®ç°çš„ã€‚\nç´ åŸŸå†…çš„ç®—æ•°è¿ç®—è§„åˆ™å¦‚ä¸‹  åŠ æ³•å’Œä¹˜æ³•éƒ½æ˜¯é€šè¿‡æ¨¡på®ç°çš„ï¼› ä»»ä½•ä¸€ä¸ªå…ƒç´ açš„åŠ æ³•é€†å…ƒéƒ½æ˜¯ç”±a+(açš„é€†å…ƒ)=0 mod på¾—åˆ°çš„ï¼› ä»»ä½•ä¸€ä¸ªéé›¶å…ƒç´ açš„ä¹˜æ³•é€†å…ƒå®šä¹‰ä¸ºaÂ·açš„é€†å…ƒ=1ã€‚  ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ç´ åŸŸGF(5)={0ã€1ã€2ã€3ã€4}ä¸­ï¼Œ2çš„åŠ æ³•é€†å…ƒä¸º3ï¼Œè¿™æ˜¯å› ä¸º2+(3)=5ï¼Œ5mod5=0,æ‰€ä»¥2+3=5mod5=0ã€‚2çš„ä¹˜æ³•é€†å…ƒä¸º3ï¼Œè¿™æ˜¯å› ä¸º2Â·3=6ï¼Œ6mod5=1ï¼Œæ‰€ä»¥2Â·3=6mod5=1ã€‚(åœ¨å¾ˆå¤šåœ°æ–¹açš„åŠ æ³•é€†å…ƒ1ç”¨$-a$è¡¨ç¤ºï¼Œaçš„ä¹˜æ³•é€†å…ƒ2ç”¨$1/a$è¡¨ç¤º)\n æ³¨ï¼šGF(2)æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç´ åŸŸï¼Œä¹Ÿæ˜¯å­˜åœ¨çš„æœ€å°çš„æœ‰é™åŸŸï¼Œç”±äºGF(2)çš„åŠ æ³•ï¼Œå³æ¨¡2åŠ æ³•ä¸å¼‚æˆ–(XOR)é—¨ç­‰ä»·ï¼ŒGF(2)çš„ä¹˜æ³•ä¸é€»è¾‘ä¸(AND)é—¨ç­‰ä»·ï¼Œæ‰€ä»¥GF(2)å¯¹AESéå¸¸é‡è¦ã€‚\næ¨¡2åŠ æ³•ä¸å¼‚æˆ–(XOR)é—¨ç­‰ä»·:\n$$\n(1 + 0) \\mod 2 = 1\\\\\n(0 + 1) \\mod 2 = 1\\\\\n(0 + 0) \\mod 2 = 0\\\\\n(1 + 1) \\mod 2 = 0\\\\\n$$\nä¹˜æ³•ä¸é€»è¾‘ä¸(AND)é—¨ç­‰ä»·:\n$$\n(1 \\times 0) \\mod 2 = 0\\\\\n(0 \\times 1) \\mod 2 = 0\\\\\n(0 \\times 0) \\mod 2 = 0\\\\\n(1 \\times 1) \\mod 2 = 1\\\\\n$$\n æ‰©å±•åŸŸ å¦‚æœæœ‰é™åŸŸçš„é˜¶ä¸æ˜¯ç´ æ•°ï¼Œåˆ™è¿™æ ·çš„æœ‰é™åŸŸå†…çš„åŠ æ³•å’Œä¹˜æ³•è¿ç®—å°±ä¸èƒ½ç”¨æ¨¡æ•´æ•°åŠ æ³•å’Œæ•´æ•°ä¹˜æ³•æ¨¡pè¡¨ç¤ºã€‚è€Œä¸”m\u0026gt;1çš„åŸŸè¢«ç§°ä¸ºæ‰©å±•åŸŸï¼Œä¸ºäº†å¤„ç†æ‰©å±•åŸŸï¼Œæˆ‘ä»¬å°±è¦ä½¿ç”¨ä¸åŒçš„ç¬¦å·è¡¨ç¤ºæ‰©å±•åŸŸå†…çš„å…ƒç´ ï¼Œä½¿ç”¨ä¸åŒçš„è§„åˆ™æ‰§è¡Œæ‰©å±•åŸŸå†…å…ƒç´ çš„ç®—æœ¯è¿ç®—ã€‚\nåœ¨æ‰©å±•åŸŸ$GF(2^m)$ä¸­ï¼Œå…ƒç´ å¹¶ä¸æ˜¯ç”¨æ•´æ•°è¡¨ç¤ºçš„ï¼Œè€Œæ˜¯ç”¨ç³»æ•°ä¸ºåŸŸ$GF(2)$ä¸­å…ƒç´ çš„å¤šé¡¹å¼è¡¨ç¤ºã€‚è¿™ä¸ªå¤šé¡¹å¼æœ€å¤§çš„åº¦(å¹‚)ä¸ºm-1â€‹ï¼Œæ‰€ä»¥æ¯ä¸ªå…ƒç´ å…±æœ‰mä¸ªç³»æ•°ï¼Œåœ¨AESç®—æ³•ä½¿ç”¨çš„åŸŸ$GF(2^8)$ä¸­ï¼Œæ¯ä¸ªå…ƒç´ $AâˆˆGF(2^8)$éƒ½å¯ä»¥è¡¨ç¤ºä¸ºï¼š\n$$\nA(x) = a_7x^7 + a_6x^6 + a_5x^5 + a_4x^4 + a_3x^3 + a_2x^2+a_1x + a_0,x_i \\in GF(2) = 0,1\n$$\næ³¨æ„ï¼šåœ¨åŸŸGF(2^8)ä¸­è¿™æ ·çš„å¤šé¡¹å¼å…±æœ‰256ä¸ªï¼Œè¿™256ä¸ªå¤šé¡¹å¼ç»„æˆçš„é›†åˆå°±æ˜¯æ‰©å±•åŸŸGF(2^8)ã€‚æ¯ä¸ªå¤šé¡¹å¼éƒ½å¯ä»¥æŒ‰ä¸€ä¸ª8ä½é¡¹é“¾çš„æ•°å€¼å½¢å¼å­˜å‚¨ï¼š\n$$\nA = (a_7,a_6,a_5,a_4,a_3,a_2,a_1,a_0)\n$$\nåƒ$x^7$ã€$x^6$ç­‰å› å­éƒ½æ— éœ€å­˜å‚¨ï¼Œå› ä¸ºä»ä½çš„ä½ç½®å°±å¯ä»¥æ¸…æ¥šåœ°åˆ¤æ–­å‡ºæ¯ä¸ªç³»æ•°å¯¹åº”çš„å¹‚ã€‚\næ‰©å±•åŸŸ$GF(2^m)$å†…çš„åŠ å‡æ³• åœ¨AESç®—æ³•ä¸­çš„å¯†é’¥åŠ æ³•å±‚ä¸­å°±ä½¿ç”¨äº†è¿™éƒ¨åˆ†çš„çŸ¥è¯†ï¼Œä½†æ˜¯ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œå› ä¸ºæˆ‘ä»¬é€šå¸¸æŠŠæ‰©å±•åŸŸä¸­çš„åŠ æ³•å½“ä½œå¼‚æˆ–è¿ç®—è¿›è¡Œå¤„ç†äº†ï¼Œå› ä¸ºåœ¨æ‰©å±•åŸŸä¸­çš„åŠ å‡æ³•å¤„ç†éƒ½æ˜¯åœ¨åº•å±‚åŸŸGF(2)å†…å®Œæˆçš„ï¼Œä¸æŒ‰ä½å¼‚æˆ–è¿ç®—ç­‰ä»·ã€‚å‡è®¾$A(x)$ã€$B(x)âˆˆGF(2^m)$ï¼Œè®¡ç®—ä¸¤ä¸ªå…ƒç´ ä¹‹å’Œçš„æ–¹æ³•å°±æ˜¯ï¼š\n$$\nC(x) = A(x) + B(x) = \\sum_{i=0}^{m-1}C_ix^i , c_i = (a_i + b_i) \\mod 2\n$$\nè€Œä¸¤ä¸ªå…ƒç´ ä¹‹å·®çš„è®¡ç®—å…¬å¼å°±æ˜¯ï¼š\n$$\nC(x) = A(x) - B(x) = \\sum_{i=0}^{m-1}C_ix^i , c_i = (a_i - b_i) \\mod 2 = (a_i + b_i) \\mod 2\n$$\n æ³¨ï¼šåœ¨å‡æ³•è¿ç®—ä¸­å‡å·ä¹‹æ‰€ä»¥å˜æˆåŠ å·ï¼Œè¿™å°±å’ŒäºŒè¿›åˆ¶å‡æ³•çš„æ€§è´¨æœ‰å…³äº†ï¼Œå¤§å®¶å¯ä»¥è¯•ç€éªŒç®—ä¸‹ã€‚ä»ä¸Šè¿°ä¸¤ä¸ªå…¬å¼ä¸­æˆ‘ä»¬å‘ç°åœ¨æ‰©å±•åŸŸä¸­åŠ æ³•å’Œå‡æ³•ç­‰ä»·ï¼Œå¹¶ä¸”ä¸XORç­‰ä»·(å¼‚æˆ–è¿ç®—ä¹Ÿè¢«ç§°ä½œäºŒè¿›åˆ¶åŠ æ³•)ã€‚\n æ‰©å±•åŸŸGF(2^m)å†…çš„ä¹˜æ³• æ‰©å±•åŸŸçš„ä¹˜æ³•ä¸»è¦è¿ç”¨åœ¨AESç®—æ³•çš„åˆ—æ··æ·†å±‚(Mix Column)ä¸­ï¼Œä¹Ÿæ˜¯åˆ—æ··æ·†å±‚ä¸­æœ€é‡è¦çš„æ“ä½œã€‚æˆ‘ä»¬é¡¹è¦å°†æ‰©å±•åŸŸä¸­çš„ä¸¤ä¸ªå…ƒç´ ç”¨å¤šé¡¹å¼å½¢å¼å±•å¼€ï¼Œç„¶åä½¿ç”¨æ ‡å‡†çš„å¤šé¡¹å¼ä¹˜æ³•è§„åˆ™å°†ä¸¤ä¸ªå¤šé¡¹å¼ç›¸ä¹˜ï¼š\nAESæ­¥éª¤è¯¦è§£ AESç®—æ³•ä¸»è¦æœ‰å››ç§æ“ä½œå¤„ç†ï¼Œåˆ†åˆ«æ˜¯å¯†é’¥åŠ æ³•å±‚(ä¹Ÿå«è½®å¯†é’¥åŠ ï¼Œè‹±æ–‡Add Round Key)ã€å­—èŠ‚ä»£æ¢å±‚(SubByte)ã€è¡Œä½ç§»å±‚(Shift Rows)ã€åˆ—æ··æ·†å±‚(Mix Column)ã€‚è€Œæ˜æ–‡xå’Œå¯†é’¥kéƒ½æ˜¯ç”±16ä¸ªå­—èŠ‚ç»„æˆçš„æ•°æ®(å½“ç„¶å¯†é’¥è¿˜æ”¯æŒ192ä½å’Œ256ä½çš„é•¿åº¦)ï¼Œå®ƒæ˜¯æŒ‰ç…§å­—èŠ‚çš„å…ˆåé¡ºåºä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³è¿›è¡Œæ’åˆ—çš„ã€‚è€ŒåŠ å¯†å‡ºçš„å¯†æ–‡è¯»å–é¡ºåºä¹Ÿæ˜¯æŒ‰ç…§è¿™ä¸ªé¡ºåºè¯»å–çš„ï¼Œç›¸å½“äºå°†æ•°ç»„è¿˜åŸæˆå­—ç¬¦ä¸²çš„æ¨¡æ ·äº†ï¼Œç„¶åå†è§£å¯†çš„æ—¶å€™åˆæ˜¯æŒ‰ç…§4Â·4æ•°ç»„å¤„ç†çš„ã€‚AESç®—æ³•åœ¨å¤„ç†çš„è½®æ•°ä¸Šåªæœ‰æœ€åä¸€è½®æ“ä½œä¸å‰é¢çš„è½®å¤„ç†ä¸Šæœ‰äº›è®¸ä¸åŒ(æœ€åä¸€è½®åªæ˜¯å°‘äº†åˆ—æ··æ·†å¤„ç†)ï¼Œåœ¨è½®å¤„ç†å¼€å§‹å‰è¿˜å•ç‹¬è¿›è¡Œäº†ä¸€æ¬¡è½®å¯†é’¥åŠ çš„å¤„ç†ã€‚åœ¨å¤„ç†è½®æ•°ä¸Šï¼Œåªè€ƒè™‘128ä½å¯†é’¥çš„10è½®å¤„ç†ã€‚\nå…¶ä¸­å­—èŠ‚æ’åˆ—æ–¹å¼éœ€è¦æŒ‰ç…§å¦‚ä¸‹è½¬æ¢:\nAESç®—æ³•æµç¨‹å›¾å¦‚ä¸‹:\nå®ç°æ­¥éª¤åŠä»£ç  æŒ‰ç…§AESæµç¨‹å›¾,å¯¹æ¯ä¸€å±‚çš„ä»£ç è¿›è¡Œå®ç°.\nå¯†é’¥åŠ æ³•å±‚ åœ¨å¯†é’¥åŠ æ³•å±‚ä¸­æœ‰ä¸¤ä¸ªè¾“å…¥çš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯æ˜æ–‡å’Œå­å¯†é’¥k[0]ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªè¾“å…¥éƒ½æ˜¯128ä½çš„ã€‚åœ¨æ‰©å±•åŸŸä¸­åŠ å‡æ³•æ“ä½œå’Œå¼‚æˆ–è¿ç®—ç­‰ä»·ï¼Œæ‰€ä»¥è¿™é‡Œçš„å¤„ç†ä¹Ÿå°±å¼‚å¸¸çš„ç®€å•äº†ï¼Œåªéœ€è¦å°†ä¸¤ä¸ªè¾“å…¥çš„æ•°æ®è¿›è¡ŒæŒ‰å­—èŠ‚å¼‚æˆ–æ“ä½œå°±ä¼šå¾—åˆ°è¿ç®—çš„ç»“æœã€‚\nå¦‚ä¸‹å›¾ï¼š\nä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  //è½®å¯†é’¥åŠ å˜æ¢ - å°†æ¯ä¸€åˆ—ä¸æ‰©å±•å¯†é’¥è¿›è¡Œå¼‚æˆ– void AddRoundKey(byte mtx[4 * 4], word k[4]) { for (int i = 0; i \u0026lt; 4; ++i) { word k1 = k[i] \u0026gt;\u0026gt; 24; word k2 = (k[i] \u0026lt;\u0026lt; 8) \u0026gt;\u0026gt; 24; word k3 = (k[i] \u0026lt;\u0026lt; 16) \u0026gt;\u0026gt; 24; word k4 = (k[i] \u0026lt;\u0026lt; 24) \u0026gt;\u0026gt; 24; mtx[i] = mtx[i] ^ byte(k1.to_ulong()); mtx[i + 4] = mtx[i + 4] ^ byte(k2.to_ulong()); mtx[i + 8] = mtx[i + 8] ^ byte(k3.to_ulong()); mtx[i + 12] = mtx[i + 12] ^ byte(k4.to_ulong()); } }   AESå¯†é’¥ç”Ÿæˆ é¦–å…ˆå®šä¹‰ä½ç½®å˜æ¢å‡½æ•°RotWord(),ä½œç”¨æ˜¯æ¥å—ä¸€ä¸ªå­— $[a0, a1, a2, a3] $ä½œä¸ºè¾“å…¥ï¼Œå¾ªç¯å·¦ç§»ä¸€ä¸ªå­—èŠ‚åè¾“å‡º$ [a1, a2, a3, a0]$,ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6  word RotWord(const word \u0026amp;w) { word result(0x0); result = (w \u0026lt;\u0026lt; 8) | (w \u0026gt;\u0026gt; 24); return result; }   å®šä¹‰Sç›’å˜æ¢å‡½æ•°SubWord()ï¼Œæ¥å—ä¸€ä¸ªå­— $[a0, a1, a2, a3]$ ä½œä¸ºè¾“å…¥ï¼Œç„¶åæ¯ä¸€ä¸ªbyteï¼Œä¾‹å¦‚a0ï¼Œå‰å››ä¸ªå­—èŠ‚ä¸ºè¡Œï¼Œåå››ä¸ªå­—èŠ‚ä¸ºåˆ—ï¼Œä»S_Boxä¸­æŸ¥æ‰¾å¹¶ä¸”è¿”å›å››ä¸ªå…ƒç´ ã€‚ï¼Œä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13  word SubWord(const word\u0026amp; sw) { word temp; for(int i=0; i\u0026lt;32; i+=8) { int row = sw[i+7]*8 + sw[i+6]*4 + sw[i+5]*2 + sw[i+4]; int col = sw[i+3]*8 + sw[i+2]*4 + sw[i+1]*2 + sw[i]; byte val = S_Box[row][col]; for(int j=0; j\u0026lt;8; ++j) temp[i+j] = val[j]; } return temp; }   è½®å¸¸æ•°Rcon[]ä½œä¸ºä¸€ä¸ªå¸¸é‡æ•°ç»„ï¼Œæ¯ä¸€è½®ç”Ÿæˆå¯†é’¥çš„æ—¶å€™éœ€è¦ä½œä¸ºå‚æ•°å¼‚æˆ–\n1 2 3  // è½®å¸¸æ•°ï¼Œå¯†é’¥æ‰©å±•ä¸­ç”¨åˆ°ã€‚ï¼ˆAES-128åªéœ€è¦10è½®ï¼‰ word Rcon[10] = {0x01000000, 0x02000000, 0x04000000, 0x08000000, 0x10000000, 0x20000000, 0x40000000, 0x80000000, 0x1b000000, 0x36000000};   å¯†é’¥æ‹“å±•å‡½æ•°KeyExpansion(),æ¥å—ä¸€ä¸ªå‚æ•°ä¸ºå¤–éƒ¨å¯†é’¥ï¼Œå¦å¤–ä¸€ä¸ªä¸ºéœ€è¦æ‹“å±•çš„è½®å¯†é’¥æ•°ç»„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  //å¯†é’¥æ‰©å±•å‡½æ•° - å¯¹128ä½å¯†é’¥è¿›è¡Œæ‰©å±•å¾—åˆ° w[4*(Nr+1),Nrä¸ºè½®æ•° void KeyExpansion(byte key[4 * N_key], word w[4 * (N_round + 1)]) { word temp; int i = 0; while (i \u0026lt; N_key)\t//å‰å››ä¸ªwordå°±æ˜¯è¾“å…¥çš„key  { w[i] = ToWord(key[4 * i], key[4 * i + 1], key[4 * i + 2], key[4 * i + 3]); ++i; } i = N_key; while (i \u0026lt; 4 * (N_round + 1)) { temp = w[i - 1]; //è®°å½•å‰ä¸€ä¸ªword  if (i % N_key == 0) { //tempå…ˆä½ç½®è¡¨æ¢RotWordï¼Œå†Sç›’å˜æ¢ï¼Œç„¶åä¸è½®å¸¸æ•°å¼‚æˆ–ï¼Œæœ€åw[i-N_key] å¼‚æˆ–  w[i] = w[i - N_key] ^ SubWord(RotWord(temp)) ^ Rcon[i / N_key - 1]; } else { w[i] = w[i - N_key] ^ temp; } i++; } }   å­—èŠ‚æ›¿æ¢å±‚ Sç›’å­—èŠ‚æ›¿æ¢ï¼Œä¸»è¦åŠŸèƒ½å°±æ˜¯è®©è¾“å…¥çš„æ•°æ®é€šè¿‡S_boxè¡¨å®Œæˆä»ä¸€ä¸ªå­—èŠ‚åˆ°å¦ä¸€ä¸ªå­—èŠ‚çš„æ˜ å°„ï¼Œè¯»å–S_boxæ•°æ®çš„æ–¹æ³•å°±æ˜¯è¦å°†è¾“å…¥æ•°æ®çš„æ¯ä¸ªå­—èŠ‚çš„é«˜å››ä½ä½œä¸ºç¬¬ä¸€ä¸ªä¸‹æ ‡ï¼Œç¬¬å››ä½ä½œä¸ºç¬¬äºŒä¸ªä¸‹æ ‡ã€‚ç„¶åè¿”å›æ•°æ®ï¼Œå­—èŠ‚æ›¿æ¢ä¸»è¦æ˜¯ä¸ºäº†æ‰°ä¹±æ•°æ®ã€‚\nSç›’ï¼š\né€†Sç›’ï¼š\nå›¾è§£å¦‚ä¸‹ï¼š\næ­£å‘Sç›’å˜æ¢ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10  //Sç›’å˜æ¢ - å‰4ä½ä¸ºè¡Œå·ï¼Œå4ä½ä¸ºåˆ—å· void SubBytes(byte mtx[4 * 4]) { for (int i = 0; i \u0026lt; 16; ++i) { int row = mtx[i][7] * 8 + mtx[i][6] * 4 + mtx[i][5] * 2 + mtx[i][4]; int col = mtx[i][3] * 8 + mtx[i][2] * 4 + mtx[i][1] * 2 + mtx[i][0]; mtx[i] = S_Box[row][col]; } }   åå‘Sç›’å˜æ¢ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10  // é€†Sç›’å˜æ¢ void InvSubBytes(byte mtx[4*4]) { for(int i=0; i\u0026lt;16; ++i) { int row = mtx[i][7]*8 + mtx[i][6]*4 + mtx[i][5]*2 + mtx[i][4]; int col = mtx[i][3]*8 + mtx[i][2]*4 + mtx[i][1]*2 + mtx[i][0]; mtx[i] = Inv_S_Box[row][col]; } }   è¡Œç§»ä½å±‚ å°†è¾“å…¥æ•°æ®ä½œä¸ºä¸€ä¸ª$4Â·4$çš„å­—èŠ‚çŸ©é˜µè¿›è¡Œå¤„ç†ï¼Œç„¶åå°†è¿™ä¸ªçŸ©é˜µçš„å­—èŠ‚è¿›è¡Œä½ç½®ä¸Šçš„ç½®æ¢ã€‚åœ¨åŠ å¯†æ—¶è¡Œä½ç§»å¤„ç†ä¸è§£å¯†æ—¶çš„å¤„ç†ç›¸åï¼Œæˆ‘ä»¬è¿™é‡Œå°†è§£å¯†æ—¶çš„å¤„ç†ç§°ä½œé€†è¡Œä½ç§»ã€‚å®ƒä¹‹æ‰€ä»¥ç§°ä½œè¡Œä½ç§»ï¼Œæ˜¯å› ä¸ºå®ƒåªåœ¨$4Â·4$çŸ©é˜µçš„è¡Œé—´è¿›è¡Œæ“ä½œï¼Œæ¯è¡Œ4å­—èŠ‚çš„æ•°æ®ã€‚åœ¨åŠ å¯†æ—¶ï¼Œä¿æŒçŸ©é˜µçš„ç¬¬ä¸€è¡Œä¸å˜ï¼Œç¬¬äºŒè¡Œå‘å·¦ç§»åŠ¨8Bit(ä¸€ä¸ªå­—èŠ‚)ã€ç¬¬ä¸‰è¡Œå‘å·¦ç§»åŠ¨2ä¸ªå­—èŠ‚ã€ç¬¬å››è¡Œå‘å·¦ç§»åŠ¨3ä¸ªå­—èŠ‚ã€‚è€Œåœ¨è§£å¯†æ—¶æ°æ°ç›¸åï¼Œä¾ç„¶ä¿æŒç¬¬ä¸€è¡Œä¸å˜ï¼Œå°†ç¬¬äºŒè¡Œå‘å³ç§»åŠ¨ä¸€ä¸ªå­—èŠ‚ã€ç¬¬ä¸‰è¡Œå³ç§»2ä¸ªå­—èŠ‚ã€ç¬¬å››è¡Œå³ç§»3ä¸ªå­—èŠ‚ã€‚æœ€ç»ˆç»“æŸã€‚\næ­£å‘è¡Œç§»ä½å›¾è§£ï¼š\nä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  //æ­£å‘è¡Œå˜æ¢ - æŒ‰å­—èŠ‚å¾ªç¯ç§»ä½ void ShiftRows(byte mtx[4 * 4]) { // ç¬¬äºŒè¡Œå¾ªç¯å·¦ç§»ä¸€ä½  byte temp = mtx[4]; for (int i = 0; i \u0026lt; 3; ++i) mtx[i + 4] = mtx[i + 5]; mtx[7] = temp; // ç¬¬ä¸‰è¡Œå¾ªç¯å·¦ç§»ä¸¤ä½  for (int i = 0; i \u0026lt; 2; ++i) { temp = mtx[i + 8]; mtx[i + 8] = mtx[i + 10]; mtx[i + 10] = temp; } // ç¬¬å››è¡Œå¾ªç¯å·¦ç§»ä¸‰ä½  temp = mtx[15]; for (int i = 3; i \u0026gt; 0; --i) mtx[i + 12] = mtx[i + 11]; mtx[12] = temp; }   åå‘è¡Œç§»ä½å›¾è§£ï¼š\nä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  // é€†è¡Œå˜æ¢ - ä»¥å­—èŠ‚ä¸ºå•ä½å¾ªç¯å³ç§» void InvShiftRows(byte mtx[4*4]) { // ç¬¬äºŒè¡Œå¾ªç¯å³ç§»ä¸€ä½ \tbyte temp = mtx[7]; for(int i=3; i\u0026gt;0; --i) mtx[i+4] = mtx[i+3]; mtx[4] = temp; // ç¬¬ä¸‰è¡Œå¾ªç¯å³ç§»ä¸¤ä½ \tfor(int i=0; i\u0026lt;2; ++i) { temp = mtx[i+8]; mtx[i+8] = mtx[i+10]; mtx[i+10] = temp; } // ç¬¬å››è¡Œå¾ªç¯å³ç§»ä¸‰ä½ \ttemp = mtx[12]; for(int i=0; i\u0026lt;3; ++i) mtx[i+12] = mtx[i+13]; mtx[15] = temp; }   åˆ—æ··æ·†å±‚ åˆ—æ··æ·†å­å±‚æ˜¯AESç®—æ³•ä¸­æœ€ä¸ºå¤æ‚çš„éƒ¨åˆ†ï¼Œå±äºæ‰©æ•£å±‚ï¼Œåˆ—æ··æ·†æ“ä½œæ˜¯AESç®—æ³•ä¸­ä¸»è¦çš„æ‰©æ•£å…ƒç´ ï¼Œå®ƒæ··æ·†äº†è¾“å…¥çŸ©é˜µçš„æ¯ä¸€åˆ—ï¼Œä½¿è¾“å…¥çš„æ¯ä¸ªå­—èŠ‚éƒ½ä¼šå½±å“åˆ°4ä¸ªè¾“å‡ºå­—èŠ‚ã€‚è¡Œä½ç§»å­å±‚å’Œåˆ—æ··æ·†å­å±‚çš„ç»„åˆä½¿å¾—ç»è¿‡ä¸‰è½®å¤„ç†ä»¥åï¼ŒçŸ©é˜µçš„æ¯ä¸ªå­—èŠ‚éƒ½ä¾èµ–äº16ä¸ªæ˜æ–‡å­—èŠ‚æˆå¯èƒ½ã€‚\nåœ¨åŠ å¯†çš„æ­£å‘åˆ—æ··æ·†ä¸­ï¼Œæˆ‘ä»¬è¦å°†è¾“å…¥çš„$4Â·4$çŸ©é˜µå·¦ä¹˜ä¸€ä¸ªç»™å®šçš„$4Â·4$çŸ©é˜µã€‚è€Œå®ƒä»¬ä¹‹é—´çš„åŠ æ³•ã€ä¹˜æ³•éƒ½åœ¨æ‰©å±•åŸŸ$GF(2^8)$ä¸­è¿›è¡Œï¼Œ,åœ¨çŸ©é˜µç›¸ä¹˜è®¡ç®—ä¸­ï¼Œå‡ºç°äº†åŠ æ³•å’Œä¹˜æ³•ï¼Œè€Œå‰é¢æåˆ°äº†åœ¨æ‹“å±•åŸŸä¸­åŠ æ³•ç­‰åŒäºå¼‚æˆ–è¿ç®—ï¼Œè€Œå¯¹äºä¹˜æ³•ï¼Œéœ€è¦ç‰¹æ®Šçš„æ–¹å¼è¿›è¡Œå¤„ç†ï¼Œäºæ˜¯å°†+å·æ¢æˆ^å·ï¼Œç„¶åå°†ä¼½ç½—ç“¦åŸŸçš„ä¹˜æ³•å®šä¹‰æˆä¸€ä¸ªæœ‰ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå¹¶è®©ä»–è¿”å›æœ€åè®¡ç®—ç»“æœï¼Œæœ€ååˆ—æ··æ·†ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  //æ­£å‘åˆ—å˜æ¢ void MixColumns(byte mtx[4*4]) { byte arr[4]; for(int i=0; i\u0026lt;4; ++i) { for(int j=0; j\u0026lt;4; ++j) arr[j] = mtx[i+j*4]; mtx[i] = GFMul(0x02, arr[0]) ^ GFMul(0x03, arr[1]) ^ arr[2] ^ arr[3]; mtx[i+4] = arr[0] ^ GFMul(0x02, arr[1]) ^ GFMul(0x03, arr[2]) ^ arr[3]; mtx[i+8] = arr[0] ^ arr[1] ^ GFMul(0x02, arr[2]) ^ GFMul(0x03, arr[3]); mtx[i+12] = GFMul(0x03, arr[0]) ^ arr[1] ^ arr[2] ^ GFMul(0x02, arr[3]); } }   åœ¨è§£å¯†çš„é€†å‘åˆ—æ··æ·†ä¸­ä¸æ­£å‘åˆ—æ··æ·†çš„ä¸åŒä¹‹å¤„åœ¨äºä½¿ç”¨çš„å·¦ä¹˜çŸ©é˜µä¸åŒï¼Œå®ƒä¸æ­£å‘åˆ—æ··æ·†çš„å·¦ä¹˜çŸ©é˜µäº’ä¸ºé€†çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°æ®çŸ©é˜µåŒæ—¶å·¦ä¹˜è¿™ä¸¤ä¸ªçŸ©é˜µåï¼Œæ•°æ®çŸ©é˜µä¸ä¼šå‘ç”Ÿä»»ä½•å˜åŒ–ã€‚ä¸‹é¢æ˜¯å›¾è§£ï¼š\næ­£å‘æ··æ·†å¤„ç†ï¼š\né€†å‘æ··æ·†å¤„ç†ï¼š\nåå‘åˆ—å˜æ¢ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  //åå‘åˆ—æ··æ·† void InvMixColumns(byte mtx[4*4]) { byte arr[4]; for(int i=0; i\u0026lt;4; ++i) { for(int j=0; j\u0026lt;4; ++j) arr[j] = mtx[i+j*4]; mtx[i] = GFMul(0x0e, arr[0]) ^ GFMul(0x0b, arr[1]) ^ GFMul(0x0d, arr[2]) ^ GFMul(0x09, arr[3]); mtx[i+4] = GFMul(0x09, arr[0]) ^ GFMul(0x0e, arr[1]) ^ GFMul(0x0b, arr[2]) ^ GFMul(0x0d, arr[3]); mtx[i+8] = GFMul(0x0d, arr[0]) ^ GFMul(0x09, arr[1]) ^ GFMul(0x0e, arr[2]) ^ GFMul(0x0b, arr[3]); mtx[i+12] = GFMul(0x0b, arr[0]) ^ GFMul(0x0d, arr[1]) ^ GFMul(0x09, arr[2]) ^ GFMul(0x0e, arr[3]); } }   å¯†é’¥åŠ æ³•å±‚ è¿™ä¸€å±‚ä¸»è¦æ˜¯æ˜æ–‡çŸ©é˜µç›’å­å¯†é’¥çŸ©é˜µè¿›è¡Œå¼‚æˆ–æ“ä½œ,åœ¨å¯†é’¥åŠ æ³•å±‚ä¸­æœ‰ä¸¤ä¸ªè¾“å…¥çš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯æ˜æ–‡å’Œå­å¯†é’¥ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªè¾“å…¥éƒ½æ˜¯128ä½çš„ã€‚åªéœ€è¦å°†ä¸¤ä¸ªè¾“å…¥çš„æ•°æ®è¿›è¡ŒæŒ‰å­—èŠ‚å¼‚æˆ–æ“ä½œå°±ä¼šå¾—åˆ°è¿ç®—çš„ç»“æœã€‚\nå›¾è§£ï¼š\nä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  //è½®å¯†é’¥åŠ å˜æ¢ - å°†æ¯ä¸€åˆ—ä¸æ‰©å±•å¯†é’¥è¿›è¡Œå¼‚æˆ– void AddRoundKey(byte mtx[4*4], word k[4]) { for(int i=0; i\u0026lt;4; ++i) { word k1 = k[i] \u0026gt;\u0026gt; 24; word k2 = (k[i] \u0026lt;\u0026lt; 8) \u0026gt;\u0026gt; 24; word k3 = (k[i] \u0026lt;\u0026lt; 16) \u0026gt;\u0026gt; 24; word k4 = (k[i] \u0026lt;\u0026lt; 24) \u0026gt;\u0026gt; 24; mtx[i] = mtx[i] ^ byte(k1.to_ulong()); mtx[i+4] = mtx[i+4] ^ byte(k2.to_ulong()); mtx[i+8] = mtx[i+8] ^ byte(k3.to_ulong()); mtx[i+12] = mtx[i+12] ^ byte(k4.to_ulong()); } }   å®ç°åŠ å¯†å‡½æ•° åŠ å¯†å‡½æ•°æŒ‰ç…§æµç¨‹å›¾,é¦–å…ˆå¼€å§‹æ˜¯å…ˆè¿›è¡Œä¸€æ¬¡è½®å¯†é’¥åŠ ,ç„¶åå¼€å§‹9è½®çš„å­—èŠ‚æ›¿æ¢+è¡Œç§»ä½+åˆ—æ··æ·†+è½®å¯†é’¥åŠ çš„æ“ä½œ,å¾ªç¯ä¹‹åå†åšä¸€æ¬¡å­—èŠ‚æ›¿æ¢+è¡Œç§»ä½+è½®å¯†é’¥åŠ å°±å®ŒæˆåŠ å¯†æ“ä½œäº†.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  void encrypt(byte in[4*4], word w[4*(N_round+1)]) { word key[4]; for(int i=0; i\u0026lt;4; ++i) key[i] = w[i]; AddRoundKey(in, key); for(int round=1; round\u0026lt;N_round; ++round) { SubBytes(in); ShiftRows(in); MixColumns(in); for(int i=0; i\u0026lt;4; ++i) key[i] = w[4*round+i]; AddRoundKey(in, key); } SubBytes(in); ShiftRows(in); for(int i=0; i\u0026lt;4; ++i) key[i] = w[4*N_round+i]; AddRoundKey(in, key); }   å®ç°è§£å¯†å‡½æ•° è§£å¯†å‡½æ•°ä¸åŠ å¯†å·®ä¸å¤š,åªä¸è¿‡å°†è¡Œç§»ä½å˜æˆåå‘è¡Œç§»ä½,åˆ—æ··æ·†å˜æˆåå‘åˆ—æ··æ·†,å­—èŠ‚æ›¿æ¢å˜æˆé€†å­—èŠ‚æ›¿æ¢å³å¯.\nä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  void decrypt(byte in[4*4], word w[4*(N_round+1)]) { word key[4]; for(int i=0; i\u0026lt;4; ++i) key[i] = w[4*N_round+i]; AddRoundKey(in, key); for(int round=N_round-1; round\u0026gt;0; --round) { InvShiftRows(in); InvSubBytes(in); for(int i=0; i\u0026lt;4; ++i) key[i] = w[4*round+i]; AddRoundKey(in, key); InvMixColumns(in); } InvShiftRows(in); InvSubBytes(in); for(int i=0; i\u0026lt;4; ++i) key[i] = w[i]; AddRoundKey(in, key); }   æµ‹è¯•åŠ å¯†è§£å¯†å‡½æ•° å¯ä»¥å‘ç°ä¸Šé¢é¢çš„æµ‹è¯•ä¸­æ˜æ–‡ä¸è§£å¯†ä¹‹åçš„æ˜æ–‡æ˜¯å®Œå…¨æ­£ç¡®çš„,è¯´æ˜åŠ å¯†å‡½æ•°ä¸è§£å¯†å‡½æ•°æ­£ç¡®!\næµ‹è¯•ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  void Aes_test() { byte key[16] = {0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c}; byte plain[16] = {0x32, 0x88, 0x31, 0xe0, 0x43, 0x5a, 0x31, 0x37, 0xf6, 0x30, 0x98, 0x07, 0xa8, 0x8d, 0xa2, 0x34}; // è¾“å‡ºå¯†é’¥  cout \u0026lt;\u0026lt; \u0026#34;Key is : \u0026#34;; for (int i = 0; i \u0026lt; 16; ++i) cout \u0026lt;\u0026lt; hex \u0026lt;\u0026lt; key[i].to_ulong() \u0026lt;\u0026lt; \u0026#34;\u0026#34;; cout \u0026lt;\u0026lt; endl; word w[4 * (N_round + 1)]; KeyExpansion(key, w); // è¾“å‡ºå¾…åŠ å¯†çš„æ˜æ–‡  cout \u0026lt;\u0026lt; endl \u0026lt;\u0026lt; \u0026#34;the plaintext to encrypy:\u0026#34; \u0026lt;\u0026lt; endl; for (int i = 0; i \u0026lt; 16; ++i) { cout \u0026lt;\u0026lt; hex \u0026lt;\u0026lt; plain[i].to_ulong() \u0026lt;\u0026lt; \u0026#34;\u0026#34;; if ((i + 1) % 4 == 0) cout \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; endl; // åŠ å¯†ï¼Œè¾“å‡ºå¯†æ–‡  encrypt(plain, w); cout \u0026lt;\u0026lt; \u0026#34;cipher : \u0026#34; \u0026lt;\u0026lt; endl; for (int i = 0; i \u0026lt; 16; ++i) { cout \u0026lt;\u0026lt; hex \u0026lt;\u0026lt; plain[i].to_ulong() \u0026lt;\u0026lt; \u0026#34;\u0026#34;; if ((i + 1) % 4 == 0) cout \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; endl; // è§£å¯†ï¼Œè¾“å‡ºæ˜æ–‡  decrypt(plain, w); cout \u0026lt;\u0026lt; \u0026#34;plain arter decrypt:\u0026#34; \u0026lt;\u0026lt; endl; for (int i = 0; i \u0026lt; 16; ++i) { cout \u0026lt;\u0026lt; hex \u0026lt;\u0026lt; plain[i].to_ulong() \u0026lt;\u0026lt; \u0026#34;\u0026#34;; if ((i + 1) % 4 == 0) cout \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; endl; }   å®ç°åŠ è§£å¯†æ–‡ä»¶ åŠ å¯†æ–‡ä»¶å‡½æ•°,è¿”å›åŠ å¯†åçš„æ–‡ä»¶å:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  string encryptFile(string oname, string suffix, word w[4 * (N_round + 1)]) { string outputfilename = oname + \u0026#34;_cipher.bin\u0026#34;; bitset\u0026lt;128\u0026gt; data; byte plain[16]; cout \u0026lt;\u0026lt; \u0026#34;begining encrypy...........\u0026#34; \u0026lt;\u0026lt; endl; clock_t start = clock(); // å°†æ–‡ä»¶åŠ å¯†åˆ° oname + cipher.bin ä¸­  ifstream in; ofstream out; in.open(oname + suffix, ios::binary); //è¾“å…¥æ–‡ä»¶  out.open(outputfilename, ios::binary); //è¾“å‡ºåŠ å¯†æ–‡ä»¶  while (in.read((char *)\u0026amp;data, sizeof(data))) { divideToByte(plain, data); encrypt(plain, w); data = mergeByte(plain); out.write((char *)\u0026amp;data, sizeof(data)); data.reset(); // ç½®0  } in.close(); out.close(); clock_t end = clock(); cout \u0026lt;\u0026lt; \u0026#34;encrypy finish!\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;encrypy cost time : \u0026#34; \u0026lt;\u0026lt; (end - start) \u0026lt;\u0026lt; \u0026#34;ms\u0026#34; \u0026lt;\u0026lt; endl; return outputfilename; //è¿”å›åŠ å¯†ä¹‹åçš„æ–‡ä»¶ }   è§£å¯†æ–‡ä»¶å‡½æ•°,è¿”å›è§£å¯†åçš„æ–‡ä»¶å:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  string decryptFile(string filename, string oname, string suffix, word w[4 * (N_round + 1)]) { ifstream in; ofstream out; in.open(filename, ios::binary); string outputfilename = oname + \u0026#34;_decrypt\u0026#34; + suffix; out.open(outputfilename, ios::binary); bitset\u0026lt;128\u0026gt; data; byte plain[16]; cout \u0026lt;\u0026lt; \u0026#34;begining decrypt............\u0026#34; \u0026lt;\u0026lt; endl; clock_t start = clock(); while (in.read((char *)\u0026amp;data, sizeof(data))) { divideToByte(plain, data); decrypt(plain, w); data = mergeByte(plain); out.write((char *)\u0026amp;data, sizeof(data)); data.reset(); // ç½®0  } in.close(); out.close(); clock_t end = clock(); cout \u0026lt;\u0026lt; \u0026#34;decrypt finish!\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;decrypt cost time : \u0026#34; \u0026lt;\u0026lt; end - start \u0026lt;\u0026lt; \u0026#34;ms\u0026#34; \u0026lt;\u0026lt; endl; return outputfilename; }   å®ç°æ•ˆæœ:\nåŠ å¯†txtæ–‡ä»¶:\nåŠ å¯†jpgæ–‡ä»¶:\nåŠ å¯†mp3æ–‡ä»¶:\nåŠ å¯†docæ–‡ä»¶:\nAESäº”ç§åŠ å¯†æ¨¡å¼ å®ç°äº”ç§åŠ å¯†æ–¹å¼çš„å¯†é’¥æ˜¯ä¸€ä¸ªç½®æ¢è¡¨unsigned char Table[4] = {0x12, 0xb1, 0x53, 0x28};,åŠ å¯†å‡½æ•°æ˜¯åŸæ–‡ä¸å¯†é’¥çš„å¼‚æˆ–.\nECBæ¨¡å¼(ç”µå­å¯†ç æœ¬æ¨¡å¼) åŠ å¯†å‰æ ¹æ®åŠ å¯†å—å¤§å°ï¼ˆå¦‚AESä¸º128ä½ï¼‰åˆ†æˆè‹¥å¹²å—ï¼Œä¹‹åå°†æ¯å—ä½¿ç”¨ç›¸åŒçš„å¯†é’¥å•ç‹¬åŠ å¯†ï¼Œè§£å¯†åŒç†ã€‚\nECBæ¨¡å¼ç”±äºæ¯å—æ•°æ®çš„åŠ å¯†æ˜¯ç‹¬ç«‹çš„å› æ­¤åŠ å¯†å’Œè§£å¯†éƒ½å¯ä»¥å¹¶è¡Œè®¡ç®—ï¼ŒECBæ¨¡å¼æœ€å¤§çš„ç¼ºç‚¹æ˜¯ç›¸åŒçš„æ˜æ–‡å—ä¼šè¢«åŠ å¯†æˆç›¸åŒçš„å¯†æ–‡å—ï¼Œè¿™ç§æ–¹æ³•åœ¨æŸäº›ç¯å¢ƒä¸‹ä¸èƒ½æä¾›ä¸¥æ ¼çš„æ•°æ®ä¿å¯†æ€§ã€‚\næµç¨‹å›¾å¦‚ä¸‹:\nå®ç°ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  //ç”µå­å¯†ç æœ¬æ¨¡å¼,åˆ†ç»„å¤§å°ä¸º4 unsigned char* ECB(unsigned char *plain, int N) { int gNum = N / groupSize; //åˆ†ç»„æ•°é‡  //å¯†æ–‡  unsigned char *cipher = new unsigned char[N]; int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[groupSize]; for(int j = 0;j \u0026lt; groupSize;++j) temp[j] = plain[count++]; //åŠ å¯†  encrypt(temp,groupSize); for(int j = i*4;j \u0026lt; i*4 + 4;++j) cipher[j] = temp[j - i * 4]; } return cipher;//è¿”å›å¯†æ–‡ }   è§£å¯†æ–¹æ³•ä¹Ÿæ˜¯è®©å¯†æ–‡ä¸å¯†é’¥è¿›è¡Œå¼‚æˆ–å³å¯,å®ç°æ•ˆæœå¦‚ä¸‹:\nCBCæ¨¡å¼(åˆ†ç»„é“¾æ¥æ¨¡å¼) CBCæ¨¡å¼å¯¹äºæ¯ä¸ªå¾…åŠ å¯†çš„å¯†ç å—åœ¨åŠ å¯†å‰ä¼šå…ˆä¸å‰ä¸€ä¸ªå¯†ç å—çš„å¯†æ–‡å¼‚æˆ–ç„¶åå†ç”¨åŠ å¯†å™¨åŠ å¯†ã€‚ç¬¬ä¸€ä¸ªæ˜æ–‡å—ä¸ä¸€ä¸ªå«åˆå§‹åŒ–å‘é‡çš„æ•°æ®å—å¼‚æˆ–ã€‚\nå¯ç”¨å…¬å¼æ€»ç»“ä¸º:\n$$\nC_i = E_K(P_i XOR C_{i-1}) \\\nC_{-1} = IV\n$$\næµç¨‹å›¾å¦‚ä¸‹:\nCBCæ¨¡å¼ç›¸æ¯”ECBæœ‰æ›´é«˜çš„ä¿å¯†æ€§ï¼Œä½†ç”±äºå¯¹æ¯ä¸ªæ•°æ®å—çš„åŠ å¯†ä¾èµ–ä¸å‰ä¸€ä¸ªæ•°æ®å—çš„åŠ å¯†æ‰€ä»¥åŠ å¯†æ— æ³•å¹¶è¡Œã€‚ä¸ECBä¸€æ ·åœ¨åŠ å¯†å‰éœ€è¦å¯¹æ•°æ®è¿›è¡Œå¡«å……ï¼Œä¸æ˜¯å¾ˆé€‚åˆå¯¹æµæ•°æ®è¿›è¡ŒåŠ å¯†ã€‚\nä»£ç å¦‚ä¸‹:\nåŠ å¯†å‡½æ•°:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  //CCBåŠ å¯†å‡½æ•° unsigned char *CCB(unsigned char *plain, int N) { int gNum = N / groupSize; //åˆ†ç»„æ•°é‡  //å¯†æ–‡  unsigned char *cipher = new unsigned char[N]; //è®¾ç½®åˆå§‹å‘é‡  unsigned char C[groupSize] = {0xe4, 0xa9, 0x5d, 0x99}; int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[groupSize]; for (int j = 0; j \u0026lt; groupSize; ++j) temp[j] = plain[count++]; //åŠ å¯†  for (int j = 0; j \u0026lt; groupSize; ++j) //å…ˆä¸åˆå§‹å‘é‡å¼‚æˆ–  temp[i] ^= C[i]; encrypt(temp, groupSize); //åŠ å¯†  for (int j = i * 4; j \u0026lt; i * 4 + 4; ++j) { cipher[j] = temp[j - i * 4]; C[j - i * 4] = temp[j - i * 4];//è®¾ç½®æ–°å‘é‡  } } return cipher; }   è§£å¯†å‡½æ•°:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  //CCBè§£å¯†å‡½æ•° unsigned char *dCCB(unsigned char *cipher, int N) { int gNum = N / groupSize; //åˆ†ç»„æ•°é‡  //æ˜æ–‡  unsigned char *plain = new unsigned char[N]; //è®¾ç½®åˆå§‹å‘é‡  unsigned char C[groupSize] = {0xe4, 0xa9, 0x5d, 0x99}; int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[groupSize]; for (int j = 0; j \u0026lt; groupSize; ++j) temp[j] = cipher[count++]; //è§£å¯†  encrypt(temp, groupSize); //å…ˆè§£å¯†  for (int j = 0; j \u0026lt; groupSize; ++j) //ç„¶åä¸åˆå§‹å‘é‡å¼‚æˆ–  temp[i] ^= C[i]; for (int j = i * 4; j \u0026lt; i * 4 + 4; ++j) { plain[j] = temp[j - i * 4]; C[j - i * 4] = cipher[j];//è®¾ç½®æ–°å‘é‡  } } return plain; }   å®ç°æ•ˆæœ:\nCFBæ¨¡å¼(å¯†æ–‡åé¦ˆæ¨¡å¼) ä¸å‰é¢çš„æ¨¡å¼ä¸åŒ,CFBæ¨¡å¼å¯ä»¥å°†æ¶ˆæ¯è¢«å½“æˆæ˜¯æ¯”ç‰¹æµ.å¯ä»¥æ€»ç»“ä¸ºå¦‚ä¸‹çš„å…¬å¼:\n$$\nC_i = P_i XOR E_K(C_{i-1})\\\nC_{-1} = IV\n$$\næµç¨‹å›¾å¦‚ä¸‹:\nåŠ å¯†ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39  //å¯†æ–‡åé¦ˆæ¨¡å¼,åŠ å¯†å‡½æ•° unsigned char *CFB(unsigned char *plain, int N) { int gsize = 2; int gNum = N / gsize; //åˆ†ç»„æ•°é‡,åˆ†æˆ8ç»„,æ¯ç»„å¤§å°ä¸º2  //å¯†æ–‡  unsigned char *cipher = new unsigned char[N]; //è®¾ç½®åˆå§‹å‘é‡  unsigned char C[4] = {0xe4, 0xa9, 0x5d, 0x99}; unsigned char S[2]; //å‰2ä¸ªå­—èŠ‚  int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[gsize]; //åˆ†ç»„æ˜æ–‡,å¤§å°ä¸º2  for (int j = 0; j \u0026lt; gsize; ++j) temp[j] = plain[count++]; //åŠ å¯†  //å…ˆå¯¹åˆå§‹å‘é‡è¿›è¡ŒåŠ å¯†  encrypt(C,4); //è·å–ç»“æœCçš„å‰ä¸¤ä¸ªbit,ç„¶åå‰2ä¸ªbit Sä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–  for(int j = 0;j \u0026lt; gsize;++j){ temp[j] ^= C[j]; S[j] = temp[j]; //è·å–å¯†æ–‡çš„2bit  } //è®¾ç½®å¯†æ–‡  for (int j = i * gsize; j \u0026lt; i * gsize + gsize; ++j) { cipher[j] = temp[j - i * gsize]; } //è®¾ç½®æ–°å‘é‡,æ–°å‘é‡å·¦ç§»  for(int j = 0;j \u0026lt; gsize;++j) { C[j] = C[j + gsize]; C[j + gsize] = S[j]; } } return cipher; }   è§£å¯†ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  //å¯†æ–‡åé¦ˆè§£å¯† unsigned char *dCFB(unsigned char *cipher, int N) { int gsize = 2; int gNum = N / gsize; //åˆ†ç»„æ•°é‡,åˆ†æˆ8ç»„,æ¯ç»„å¤§å°ä¸º2  //æ˜æ–‡  unsigned char *plain = new unsigned char[N]; //è®¾ç½®åˆå§‹å‘é‡  unsigned char C[4] = {0xe4, 0xa9, 0x5d, 0x99}; unsigned char S[2]; //å‰2ä¸ªå­—èŠ‚  int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[gsize]; //åˆ†ç»„å¯†æ–‡  for (int j = 0; j \u0026lt; gsize; ++j) temp[j] = cipher[count++]; //è§£å¯†  //å…ˆå¯¹åˆå§‹å‘é‡è¿›è¡ŒåŠ å¯†  encrypt(C,4); //è·å–ç»“æœCçš„å‰ä¸¤ä¸ªbit,ç„¶åå‰2ä¸ªbit Sä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–  for(int j = 0;j \u0026lt; 2;++j){ S[j] = temp[j]; temp[j] = C[j] ^ temp[j]; } //è®¾ç½®æ˜æ–‡  for (int j = i * gsize; j \u0026lt; i * gsize + gsize; ++j) { plain[j] = temp[j - i * gsize]; } //è®¾ç½®æ–°å‘é‡,æ–°å‘é‡å·¦ç§»  for(int j = 0;j \u0026lt; gsize;++j) { C[j] = C[j + gsize]; C[j+gsize] = S[j]; } } return plain; }   å®ç°æ•ˆæœ:\nOFBæ¨¡å¼(è¾“å‡ºåé¦ˆæ¨¡å¼) OFBæ˜¯å…ˆç”¨å—åŠ å¯†å™¨ç”Ÿæˆå¯†é’¥æµï¼ˆKeystreamï¼‰ï¼Œç„¶åå†å°†å¯†é’¥æµä¸æ˜æ–‡æµå¼‚æˆ–å¾—åˆ°å¯†æ–‡æµï¼Œè§£å¯†æ˜¯å…ˆç”¨å—åŠ å¯†å™¨ç”Ÿæˆå¯†é’¥æµï¼Œå†å°†å¯†é’¥æµä¸å¯†æ–‡æµå¼‚æˆ–å¾—åˆ°æ˜æ–‡ï¼Œç”±äºå¼‚æˆ–æ“ä½œçš„å¯¹ç§°æ€§æ‰€ä»¥åŠ å¯†å’Œè§£å¯†çš„æµç¨‹æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚\nOFBä¸CFBä¸€æ ·éƒ½éå¸¸é€‚åˆå¯¹æµæ•°æ®çš„åŠ å¯†ï¼ŒOFBç”±äºåŠ å¯†å’Œè§£å¯†éƒ½ä¾èµ–ä¸å‰ä¸€æ®µæ•°æ®ï¼Œæ‰€ä»¥åŠ å¯†å’Œè§£å¯†éƒ½ä¸èƒ½å¹¶è¡Œã€‚\næµç¨‹å›¾å¦‚ä¸‹:\nåŠ å¯†è§£å¯†ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39  //è¾“å‡ºåé¦ˆæ¨¡å¼,åŠ å¯†è§£å¯†å‡½æ•°ç›¸åŒ unsigned char *OFB(unsigned char *plain, int N) { int gsize = 2; int gNum = N / gsize; //åˆ†ç»„æ•°é‡,åˆ†æˆ8ç»„,æ¯ç»„å¤§å°ä¸º2  //å¯†æ–‡  unsigned char *cipher = new unsigned char[N]; //è®¾ç½®åˆå§‹å‘é‡  unsigned char C[4] = {0xee, 0xa9, 0x5d, 0x99}; unsigned char S[2]; //å‰2ä¸ªå­—èŠ‚  int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[gsize]; //åˆ†ç»„æ˜æ–‡  for (int j = 0; j \u0026lt; gsize; ++j) temp[j] = plain[count++]; //åŠ å¯†  //å…ˆå¯¹åˆå§‹å‘é‡è¿›è¡ŒåŠ å¯†  encrypt(C,4); //è·å–ç»“æœCçš„å‰ä¸¤ä¸ªbit,ç„¶åå‰2ä¸ªbit Sä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–  for(int j = 0;j \u0026lt; 2;++j){ S[j] = C[j]; //å–å‘é‡åŠ å¯†åçš„å‰ä¸¤ä½  temp[j] ^= C[j]; } //è®¾ç½®å¯†æ–‡  for (int j = i * gsize; j \u0026lt; i * gsize + gsize; ++j) { cipher[j] = temp[j - i * gsize]; } //è®¾ç½®æ–°å‘é‡,æ–°å‘é‡å·¦ç§»  for(int j = 0;j \u0026lt; gsize;++j) { C[j] = C[j + gsize]; C[j + gsize] = S[j]; } } return cipher; }   å®ç°æ•ˆæœ:\nCTRæ¨¡å¼(è®¡æ•°å™¨æ¨¡å¼) ç±»å‹äºCFBï¼Œä½†æ˜¯åŠ å¯†æ¯ä¸ªè®¡æ•°å€¼ï¼Œè€Œä¸æ˜¯ä»»ä½•åé¦ˆå€¼,å¯¹æ¯ä¸ªæ˜æ–‡åˆ†ç»„ï¼Œå¿…é¡»æœ‰ä¸åŒçš„å¯†é’¥å’Œè®¡æ•°å€¼ (ä»ä¸é‡å¤ä½¿ç”¨),,å¯ä»¥ç”¨å¦‚ä¸‹å…¬å¼è¡¨ç¤º:\n$$\nO_i = E_K(i)\\\nC_i = P_i XOR O_i\n$$\nè®¡æ•°å™¨æ¨¡å¼æµç¨‹å›¾å¦‚ä¸‹:\nè®¡æ•°å™¨æ¨¡å¼åŠ å¯†å‡½æ•°ä¸è§£å¯†å‡½æ•°ä¸€æ ·,ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  //è®¡æ•°å™¨æ¨¡å¼,åŠ å¯†å‡½æ•° unsigned char *CTR(unsigned char *plain, int N) { int gNum = N / groupSize; //åˆ†ç»„æ•°é‡  //å¯†æ–‡  unsigned char *cipher = new unsigned char[N]; //è®¾ç½®éšæœºå€¼  unsigned char Counter[groupSize*groupSize] = {0x44, 0xa9, 0x5d, 0x99, 0xe5, 0xf1, 0x3d, 0x91, 0x16, 0xa6, 0xe1, 0x33, 0x22, 0xdd, 0xab, 0x1f}; int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[groupSize]; //æ˜æ–‡åˆ†ç»„  unsigned char C[groupSize]; //åˆ†ç»„éšæœºå€¼  for (int j = 0; j \u0026lt; groupSize; ++j) { temp[j] = plain[count++]; C[j] = Counter[i*4+j]; } //åŠ è¿·  //é¦–å…ˆåŠ å¯†éšæœºå€¼C  encrypt(C, groupSize); //ç„¶åä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–  for(int j = 0;j \u0026lt; groupSize;++j) temp[j] ^= C[j]; //è®¾ç½®å¯†æ–‡  for(int j = i*groupSize;j \u0026lt; i*groupSize+groupSize;j++) cipher[j] = temp[j-i*groupSize]; } return cipher; }   å®ç°æ•ˆæœå¦‚ä¸‹:\nå‚è€ƒ:\n https://www.cnblogs.com/RabbitHu/p/bitset.html bitsetç”¨æ³• https://blog.csdn.net/liushu1231/article/details/8844631 bitsetçš„ç©ºé—´å¤§å° http://c.biancheng.net/cpp/html/2834.html æ–‡ä»¶å¤„ç† https://bbs.pediy.com/thread-253884.htm AESç®—æ³•å¸¦å›¾è§£ https://blog.csdn.net/lisonglisonglisong/article/details/41909813 AESç®—æ³• CSDN https://blog.csdn.net/sinat_23338865/article/details/72869841 AESäº”ç§åŠ å¯†æ¨¡å¼   è®¾â€œ+â€ä¸ºä¸€ä¸ªäº¤æ¢æ€§çš„äºŒå…ƒè¿ç®—ï¼Œå³å¯¹äºæ‰€æœ‰x,yï¼Œx+y=y+xã€‚è‹¥è¯¥é›†å†…å­˜åœ¨ä¸€ä¸ªå…ƒç´ 0ï¼Œä½¿å¾—å¯¹äºæ‰€æœ‰xï¼Œx+0=0+x=xï¼Œåˆ™æ­¤å…ƒç´ æ˜¯å”¯ä¸€çš„ã€‚å¦‚æœå¯¹äºä¸€ä¸ªç»™å®šçš„xï¼Œå­˜åœ¨ä¸€ä¸ªx'ä½¿å¾—x+x'=x'+x=0ï¼Œåˆ™ç§°x'æ˜¯xçš„åŠ æ³•é€†å…ƒã€‚ \u0026#x21a9;\u0026#xfe0e;\n ä¹˜æ³•é€†å…ƒï¼Œæ˜¯æŒ‡æ•°å­¦é¢†åŸŸç¾¤Gä¸­ä»»æ„ä¸€ä¸ªå…ƒç´ aï¼Œéƒ½åœ¨Gä¸­æœ‰å”¯ä¸€çš„é€†å…ƒaâ€˜ï¼Œå…·æœ‰æ€§è´¨aÃ—a'=a'Ã—a=eï¼Œå…¶ä¸­eä¸ºè¯¥ç¾¤çš„å•ä½å…ƒã€‚ \u0026#x21a9;\u0026#xfe0e;\n  ","description":"","id":99,"section":"posts","tags":["AES","å¯†ç å­¦","åŠ å¯†"],"title":"Aes-é«˜çº§åŠ å¯†æ ‡å‡†","uri":"https://hugo.jiahongw.com/zh/posts/cryptography/aes/"},{"content":"ç®€å•åœ°è¯´ï¼Œäº‘è®¡ç®—å°±æ˜¯è®¡ç®—æœåŠ¡çš„æä¾›ï¼ˆåŒ…æ‹¬æœåŠ¡å™¨ã€å­˜å‚¨ã€æ•°æ®åº“ã€ç½‘ç»œã€è½¯ä»¶ã€åˆ†æå’Œæ™ºèƒ½ï¼‰- é€šè¿‡ Internetï¼ˆäº‘ï¼‰æä¾›å¿«é€Ÿåˆ›æ–°ã€å¼¹æ€§èµ„æºå’Œè§„æ¨¡ç»æµã€‚å¯¹äºäº‘æœåŠ¡ï¼Œé€šå¸¸ä½ åªéœ€ä½¿ç”¨å¤šå°‘æ”¯ä»˜å¤šå°‘ï¼Œä»è€Œå¸®åŠ©é™ä½è¿è¥æˆæœ¬ï¼Œä½¿åŸºç¡€è®¾æ–½æ›´æœ‰æ•ˆåœ°è¿è¡Œï¼Œå¹¶èƒ½æ ¹æ®ä¸šåŠ¡éœ€æ±‚çš„å˜åŒ–è°ƒæ•´å¯¹æœåŠ¡çš„ä½¿ç”¨ã€‚\nè¡Œäº‘è¶£ç è®°å½• è¡Œäº‘è¶£ç å®˜ç½‘ï¼šhttp://mart.cloudtogo.cn/\nLinuxæœåŠ¡å™¨ ç”Ÿæˆè‡ªå·±çš„æœåŠ¡å™¨ è¿›å…¥åº”ç”¨å•†åº—ï¼Œé€‰æ‹©éœ€è¦çš„LinuxæœåŠ¡å™¨ï¼Œè¿™é‡Œé€‰æ‹©CentOS\nç‚¹å‡»éƒ¨ç½²ï¼Œç­‰å¾…ç”Ÿæˆè‡ªå·±çš„æœåŠ¡å™¨\nå‘å¸ƒæˆåŠŸ\nå‚æ•°è§£é‡Š ç‚¹å‡»è®¿é—®ï¼Œä¼šè·³å‡ºè®¿é—®åœ°å€ï¼Œéƒ¨ç½²åŒºåŸŸä»¥åŠæç¤ºä¿¡æ¯ï¼Œä¸€æ­¥ä¸€æ­¥çœ‹ã€‚\nè®¿é—®åœ°å€\néƒ¨ç½²åŒºåŸŸ\néƒ¨ç½²åŒºåŸŸæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå°±æ˜¯è¿™ä¸ªæœåŠ¡å™¨éƒ¨ç½²çš„åŒºåŸŸã€‚\nè¯¦æƒ…\nä»ä¸Šé¢ç»™çš„ä¿¡æ¯ï¼Œå¯ä»¥å½’ä¸ºå¦‚ä¸‹ï¼š\n  sshè¿œç¨‹è®¿é—®çš„åœ°å€ä¸º2c56369b3c95a919.c.cloudtogo.cnï¼Œç«¯å£ä¸º34920(æ³¨æ„ï¼šç«¯å£ä¸æ˜¯22)ã€‚è¿œç¨‹ç™»é™†çš„ç”¨æˆ·åä¸ºï¼šrootï¼Œå¯†ç ä¸ºï¼š123456.\n  æœ‰äº”ä¸ªæ˜ å°„ç«¯å£ï¼Œä»–ä»¬çš„å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š\n   Linuxå†…éƒ¨ å¤–éƒ¨è®¿é—®     8001 34921(é¢„ç•™aç«¯å£)   8002 34916(é¢„ç•™bç«¯å£)   8003 34917(é¢„ç•™cç«¯å£)   8004 34918(é¢„ç•™dç«¯å£)   8005 34924(é¢„ç•™eç«¯å£)    ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬åœ¨Linuxå†…éƒ¨å¯ç”¨8001-8005è¿™äº”ä¸ªç«¯å£è¿è¡Œç›¸åº”çš„åº”ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®å¯¹åº”çš„å¤–éƒ¨é¢„ç•™ç«¯å£ä»¥åŠå­åŸŸåè¿›è¡Œè®¿é—®æµ‹è¯•ã€‚\nä¾‹å¦‚åœ¨Linuxå†…è¿è¡Œäº†ä¸€ä¸ªwebåº”ç”¨åœ¨8001ç«¯å£ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨è®¿é—®61823a63ab19b300.c.cloudtogo.cn:34921\n  sshè¿œç¨‹è¿æ¥ï¼š\næŸ¥çœ‹é…ç½® æŸ¥çœ‹CPUå‹å·: Intel(R) Xeon(R) CPU E5-2680 v3\n1  cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c   æŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°: 2\n1  cat /proc/cpuinfo | grep \u0026#34;physical id\u0026#34; | sort | uniq|wc -l   æŸ¥çœ‹é€»è¾‘CPUçš„ä¸ªæ•°: 8ä¸ª\n1  cat /proc/cpuinfo | grep \u0026#34;processor\u0026#34; |wc -l   æŸ¥çœ‹CPUæ˜¯å‡ æ ¸: 4æ ¸\n1  cat /proc/cpuinfo | grep \u0026#34;cores\u0026#34;|uniq   è®¾ç½®è¿œç¨‹è®¿é—®jupyter å®‰è£…å®Œjupyterä¹‹åï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼š\n1  jupyter notebook --generate-config   å‚è€ƒï¼š\nhttps://www.jianshu.com/p/960f011f712e\nhttps://zhuanlan.zhihu.com/p/64524822\nç»“æœï¼š\næ·»åŠ è™šæ‹Ÿç¯å¢ƒï¼šhttps://ofooo.github.io/wiki/python/%E5%B7%A5%E5%85%B7/jupyter-notebook/\næ›´æ¢pipæºï¼šhttps://www.linuxidc.com/Linux/2019-04/158178.htm\néƒ¨ç½²nodejsï¼šhttps://blog.csdn.net/xerysherryx/article/details/78920978\nnpmé•œåƒï¼šhttps://www.cnblogs.com/alps/p/12439387.html\nCentOSåŸºæœ¬å‘½ä»¤ æŸ¥çœ‹æœåŠ¡è¿›ç¨‹\n1 2 3  [victor@mylove ~]$ ps -aux|grep mysql victor 23477 0.0 0.0 110656 2688 pts/3 S+ 12:26 0:00 grep --color=auto mysql   æŸ¥çœ‹è¿›ç¨‹ç«¯å£\n1  netstat -anp |grep 1506   æŸ¥çœ‹ç«¯å£è¿›ç¨‹\n1  netstat -lnp|grep 3306   å…³é—­è¿›ç¨‹\n1  kill â€“9 1506   ç”Ÿäº§åº”ç”¨ ä½¿ç”¨dockerç”Ÿäº§è‡ªå·±çš„åº”ç”¨ å¼€å‘ç½‘é¡µApp è¿›å…¥åº”ç”¨å·¥å‚,æ‰“å¼€ä¸€ä¸ªBlankçš„æ¨¡æ¿ç»§ç»­,ç„¶åå†è®¾è®¡é¡µé¢æ‹–å…¥ä¸€ä¸ªä»£ç ç»„ä»¶,å¦‚ä¸‹:\nè¾“å…¥åå­—ä¸ºwebpy,åº”ä¸ºä½¿ç”¨çš„æ˜¯web.pyæ¡†æ¶è¿›è¡Œç¼–å†™,ç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥.\nç„¶åè¾“å…¥å­˜æ”¾ä»£ç çš„åœ°å€,ä»£ç éœ€è¦ç¼–å†™å®Œæˆä¹‹åå­˜åˆ°GitHubä¸Š,ç¨‹åºé»˜è®¤çš„è¿è¡Œå…¥å£æ—¶main.py,åœ¨è¿è¡Œmain.pyä¹‹å‰,è¿˜ä¼šæ‰§è¡Œpip install -r requirements.txtè¿™ä¸ªä»£ç ,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†æ‰€éœ€è¦çš„ä¾èµ–åŒ…éƒ½å†™åœ¨requirements.txtè¿™ä¸ªæ–‡ä»¶ä¸­.\næˆ‘çš„ä»£ç åœ°å€: https://github.com/redisread/webpy.git\nç¼–å†™ç»„ä»¶å‘å¯¼,æœ‰è®¸å¤šå‚æ•°\nå…¶ä»–çš„å‚æ•°ä½œç”¨:\n ç¯å¢ƒå˜é‡: å­˜å‚¨ç³»ç»Ÿçš„ç›¸å…³éœ€è¦è¿è¡Œçš„ç¨‹åºçš„ä½ç½® å¤šå‰¯æœ¬: å¤šå‰¯æœ¬è®¾ç½®æ”¯æŒå¯ä»¥ä½¿ç”¨å¼¹æ€§ä¼¸ç¼©åŠŸèƒ½,å¯å¼€å¯å¯ä¸å¼€å¯ ä¼šè¯ä¿æŒ: ç»´æŒå®¢æˆ·ç«¯ä¸ä¸€å°æœåŠ¡å™¨çš„è¿æ¥,å³å¯¹äºæŸä¸ªå®¢æˆ·ç«¯,,ä¸ä¼šæ›´æ¢ä¸ä»–è¿›è¡Œè¿æ¥çš„æœåŠ¡å™¨ æ‰§è¡Œå‘½ä»¤: å¯ä»¥æ‰§è¡ŒLinuxçš„ç›¸å…³å‘½ä»¤ å­˜å‚¨è·¯å¾„: å¯ä»¥è®¾ç½®å­˜å‚¨åˆ°æ•°æ®å·ä¸­,å¡«å†™çš„Linuxçš„ä½ç½®å°±æ˜¯æ•°æ®å·å­˜æ”¾çš„ä½ç½® rootæƒé™: æ˜¯å¦å¼€å¯rootæƒé™ æœåŠ¡åç§°: å°±æ˜¯æœåŠ¡çš„åç§° è¯»å–æŒ‡å®šæ–‡ä»¶: **0 æ—¥å¿—æ–‡ä»¶: å¡«å†™æ—¥å¿—æ–‡ä»¶å­˜æ”¾çš„çš„åœ°æ–¹ æ˜ å°„é…ç½®æ–‡ä»¶: å¯ä»¥æ˜ å°„(ç›¸å½“äºæ›¿æ¢)é…ç½®æ–‡ä»¶,ä¾‹å¦‚nginxçš„nginx.confæ–‡ä»¶. å¥åº·æ£€æŸ¥: ç‰¹æƒæ¨¡å¼: èµ„æºé™åˆ¶: é™åˆ¶CPUyä»¥åŠå†…å­˜çš„è®¾ç½®  æœ€åç‚¹å‡»å®Œæˆå°±å¯ä»¥å‘å‘å¸ƒåº”ç”¨äº†\nå‘å¸ƒä¸€èˆ¬ä¸éœ€è¦é…ç½®ä»€ä¹ˆ,éœ€è¦çš„è¯å¯ä»¥è‡ªè¡Œè®¾ç½®.\nå‘å¸ƒæˆåŠŸ!\nè®¿é—®è¯¥åœ°å€å°±èƒ½å¤Ÿè®¿é—®æˆ‘ä»¬å†™çš„åº”ç”¨äº†.\nè¿ç»´ç®¡ç† åœ¨å‘å¸ƒé¡µçš„ä¾§è¾¹æ æœ‰ä¸€ä¸ªè¿ç»´æŒ‰é’®,ç‚¹å‡»è¿›å…¥è¿ç»´ç•Œé¢\nå¦‚ä¸‹å°±æ˜¯å¯ä»¥è¿›è¡ŒæŸ¥çœ‹çš„ç›¸å…³ä¿¡æ¯\n","description":"","id":100,"section":"posts","tags":["äº‘è®¡ç®—","è¡Œäº‘è¶£ç "],"title":"è¡Œäº‘å¼€å‘","uri":"https://hugo.jiahongw.com/zh/posts/cloudcomputing/xingyun-begin/"},{"content":"ã€‚ã€‚é›†ä¸‡æ»´é›¨æ°´ï¼Œæˆä¸€æ¡æ±Ÿæ²³ğŸŒŠğŸŒŠ\nRedis  REmote DIctionary Server(Redis) æ˜¯ä¸€ä¸ªç”±Salvatore Sanfilippoå†™çš„key-valueå­˜å‚¨ç³»ç»Ÿã€‚\nRedisæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€éµå®ˆBSDåè®®1ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚\nå®ƒé€šå¸¸è¢«ç§°ä¸ºæ•°æ®ç»“æ„æœåŠ¡å™¨ï¼Œå› ä¸ºå€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯ å­—ç¬¦ä¸²(String), å“ˆå¸Œ(Hash), åˆ—è¡¨(list), é›†åˆ(sets) å’Œ æœ‰åºé›†åˆ(sorted sets)ç­‰ç±»å‹ã€‚\n  å¼€æºç•Œçš„ 5 å¤§è®¸å¯åè®®ï¼šäº”å¤§å¼€æºè®¸å¯åè®®åˆ†åˆ«æ˜¯GPL,LGPL,BSD,MIT,Apacheã€‚\n å­˜å‚¨ç±»å‹ï¼š\n String: å­—ç¬¦ä¸² Hash: æ•£åˆ— List: åˆ—è¡¨ Set: é›†åˆ Sorted Set: æœ‰åºé›†åˆ  ä¸‰ä¸ªç‰¹ç‚¹ï¼š\n Redisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ã€‚ Redisä¸ä»…ä»…æ”¯æŒç®€å•çš„key-valueç±»å‹çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜æä¾›listï¼Œsetï¼Œzsetï¼Œhashç­‰æ•°æ®ç»“æ„çš„å­˜å‚¨ã€‚ Redisæ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³master-slaveæ¨¡å¼2çš„æ•°æ®å¤‡ä»½ã€‚  Redisä¸å…¶ä»–key-valueå­˜å‚¨æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ\n Redisæœ‰ç€æ›´ä¸ºå¤æ‚çš„æ•°æ®ç»“æ„å¹¶ä¸”æä¾›å¯¹ä»–ä»¬çš„åŸå­æ€§æ“ä½œ3ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸åŒäºå…¶ä»–æ•°æ®åº“çš„è¿›åŒ–è·¯å¾„ã€‚Redisçš„æ•°æ®ç±»å‹éƒ½æ˜¯åŸºäºåŸºæœ¬æ•°æ®ç»“æ„çš„åŒæ—¶å¯¹ç¨‹åºå‘˜é€æ˜ï¼Œæ— éœ€è¿›è¡Œé¢å¤–çš„æŠ½è±¡ã€‚ Redisè¿è¡Œåœ¨å†…å­˜ä¸­ä½†æ˜¯å¯ä»¥æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ‰€ä»¥åœ¨å¯¹ä¸åŒæ•°æ®é›†è¿›è¡Œé«˜é€Ÿè¯»å†™æ—¶éœ€è¦æƒè¡¡å†…å­˜ï¼Œå› ä¸ºæ•°æ®é‡ä¸èƒ½å¤§äºç¡¬ä»¶å†…å­˜ã€‚åœ¨å†…å­˜æ•°æ®åº“æ–¹é¢çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œç›¸æ¯”åœ¨ç£ç›˜ä¸Šç›¸åŒçš„å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œåœ¨å†…å­˜ä¸­æ“ä½œèµ·æ¥éå¸¸ç®€å•ï¼Œè¿™æ ·Rediså¯ä»¥åšå¾ˆå¤šå†…éƒ¨å¤æ‚æ€§å¾ˆå¼ºçš„äº‹æƒ…ã€‚åŒæ—¶ï¼Œåœ¨ç£ç›˜æ ¼å¼æ–¹é¢ä»–ä»¬æ˜¯ç´§å‡‘çš„ä»¥è¿½åŠ çš„æ–¹å¼äº§ç”Ÿçš„ï¼Œå› ä¸ºä»–ä»¬å¹¶ä¸éœ€è¦è¿›è¡Œéšæœºè®¿é—®ã€‚  å®‰è£… githubé“¾æ¥ï¼šhttps://github.com/microsoftarchive/redis/releases\nRedisæ˜¯Cè¯­è¨€å¼€å‘ï¼Œå®‰è£…Rediséœ€è¦å…ˆå°†å®˜ç½‘ä¸‹è½½çš„æºç è¿›è¡Œç¼–è¯‘ï¼Œç¼–è¯‘ä¾èµ–gccç¯å¢ƒï¼Œå¦‚æœæ²¡æœ‰gccç¯å¢ƒï¼Œéœ€è¦å®‰è£…gccã€‚\nå®‰è£…GCC æ­¥éª¤ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  ## å…ˆå®‰è£… gcc ç¼–è¯‘ç¯å¢ƒ,å¦‚æœå·²ç»å®‰è£…, è¯·å¿½ç•¥ yum -y install gcc automake autoconf libtool make ## ä¸‹è½½ redis æºä»£ç  wget http://download.redis.io/releases/redis-4.0.1.tar.gz ## ä¸‹è½½å®Œæˆå,è§£å‹ tar zxvf redis-4.0.1.tar.gz ## è·³è½¬åˆ° redis ç›®å½• cd redis-4.0.1 ## ç¼–è¯‘ make ## å®‰è£…ç¼–è¯‘åçš„è½¯ä»¶åˆ° /usr/local/redis ## PREFIXå¿…é¡»å¤§å†™,è‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºredisç›®å½•ï¼Œå¹¶å°†ç»“æœå®‰è£…æ­¤ç›®å½• make PREFIX=/usr/local/redis install ## æŸ¥çœ‹å®‰è£…çš„ç»“æœ cd /usr/local/redis/bin ls -l -rwxr-xr-x 1 root root 2451864 Mar 12 13:28 redis-benchmark -rwxr-xr-x 1 root root 5741096 Mar 12 13:28 redis-check-aof -rwxr-xr-x 1 root root 5741096 Mar 12 13:28 redis-check-rdb -rwxr-xr-x 1 root root 2606088 Mar 12 13:28 redis-cli lrwxrwxrwx 1 root root 12 Mar 12 13:28 redis-sentinel -\u0026gt; redis-server -rwxr-xr-x 1 root root 5741096 Mar 12 13:28 redis-server   é…ç½®  Redis çš„é…ç½®æ–‡ä»¶ä½äº Redis å®‰è£…ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åä¸º redis.conf(Windows åä¸º redis.windows.conf)ã€‚\n redis.confé…ç½®æ–‡ä»¶è¯¦è§£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116  ## æŒ‡å®šåŒ…å«å…¶å®ƒçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªRediså®ä¾‹ä½¿ç”¨åŒä¸€ä»½é…ç½®æ–‡ä»¶ï¼Œè€Œå„ä¸ªå®ä¾‹åˆæ‹¥æœ‰è‡ªå·±çš„ç‰¹å®šé…ç½®æ–‡ä»¶ include /path/to/local.conf ## ç»‘å®šçš„ä¸»æœºåœ°å€, å¯ä»¥ç›‘å¬ä¸€ä¸ªæˆ–å¤šä¸ª, å¦‚æœä¸º 127.0.0.1 åªèƒ½æœ¬æœºæ‰èƒ½è®¿é—® bind 127.0.0.1 ## Redisé»˜è®¤ä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥é€šè¿‡è¯¥é…ç½®é¡¹ä¿®æ”¹ï¼Œä½¿ç”¨yeså¯ç”¨å®ˆæŠ¤è¿›ç¨‹ daemonize no ## Redisä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œæ—¶,Redisé»˜è®¤ä¼šæŠŠ pid å†™å…¥ /var/run/redis.pid æ–‡ä»¶,å¯ä»¥é€šè¿‡ pidfile æŒ‡å®š pidfile /var/run/redis_6379.pid ## æŒ‡å®šRedisç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º6379 port 6379 ## å½“å®¢æˆ·ç«¯é—²ç½®å¤šé•¿æ—¶é—´åå…³é—­è¿æ¥ï¼Œå¦‚æœæŒ‡å®šä¸º0ï¼Œè¡¨ç¤ºå…³é—­è¯¥åŠŸèƒ½ timeout 0 ## æŒ‡å®šæ—¥å¿—è®°å½•çº§åˆ«ï¼ŒRedisæ€»å…±æ”¯æŒå››ä¸ªçº§åˆ«ï¼šdebugã€verboseã€noticeã€warningï¼Œé»˜è®¤ä¸ºverbose ## debug ä¼šæ‰“å°å‡ºå¾ˆå¤šä¿¡æ¯ï¼Œé€‚ç”¨äºå¼€å‘å’Œæµ‹è¯•é˜¶æ®µ ## verbose åŒ…å«å¾ˆå¤šä¸å¤ªæœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ¯”debugè¦æ¸…çˆ½ä¸€äº› ## notice é€‚ç”¨äºç”Ÿäº§æ¨¡å¼ ## warning è­¦å‘Šä¿¡æ¯ï¼ˆä»…è®°å½•éå¸¸é‡è¦/é‡è¦çš„æ¶ˆæ¯ï¼‰ loglevel verbose ## æ—¥å¿—è®°å½•æ–¹å¼ï¼Œé»˜è®¤ä¸ºæ ‡å‡†è¾“å‡º ## å¦‚æœ Redis ä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œï¼Œè€Œè¿™é‡Œåˆé…ç½®ä¸ºæ—¥å¿—è®°å½•æ–¹å¼ä¸ºæ ‡å‡†è¾“å‡ºï¼Œåˆ™æ—¥å¿—å°†ä¼šå‘é€ç»™/dev/null logfile stdout ## è®¾ç½®æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ•°æ®åº“ä¸º0ï¼Œå¯ä»¥ä½¿ç”¨SELECT \u0026lt;dbid\u0026gt;å‘½ä»¤åœ¨è¿æ¥ä¸ŠæŒ‡å®šæ•°æ®åº“id databases 16 ## æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶(æŒä¹…åŒ–)ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é…åˆ ## save \u0026lt;seconds\u0026gt; \u0026lt;changes\u0026gt; save 900 1 ## 900ç§’å†…æœ‰ä¸€ä¸ªæ›´æ–° save 300 10 ## 300ç§’å†…æœ‰10ä¸ªæ›´æ–° save 60 10000 ## 60ç§’å†…æœ‰10000ä¸ªæ›´æ–° ## æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸ºyes ## Redisé‡‡ç”¨LZFå‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœCPUæ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§ rdbcompression yes ## æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸ºdump.rdb dbfilename dump.rdb ## ä¹Ÿå°±æ˜¯å®‰è£…ç›®å½•ä¸‹æˆ‘ä»¬çœ‹åˆ°çš„é‚£ä¸ªæ–‡ä»¶ ## æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½• dir ./ ## å½“æœ¬æœºä¸ºslavæœåŠ¡æ—¶ï¼Œè®¾ç½®masteræœåŠ¡çš„IPåœ°å€åŠç«¯å£ï¼Œåœ¨Rediså¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ä»masterè¿›è¡Œæ•°æ®åŒæ­¥ slaveof \u0026lt;masterip\u0026gt; \u0026lt;masterport\u0026gt; ## å½“masteræœåŠ¡è®¾ç½®äº†å¯†ç ä¿æŠ¤æ—¶ï¼ŒslavæœåŠ¡è¿æ¥masterçš„å¯†ç  masterauth \u0026lt;master-password\u0026gt; ## è®¾ç½®Redisè¿æ¥å¯†ç  ## å¦‚æœé…ç½®äº†è¿æ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥Redisæ—¶éœ€è¦é€šè¿‡AUTH \u0026lt;password\u0026gt;å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­ requirepass foobared ## è®¾ç½®åŒä¸€æ—¶é—´æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œé»˜è®¤æ— é™åˆ¶ ## Rediså¯ä»¥åŒæ—¶æ‰“å¼€çš„å®¢æˆ·ç«¯è¿æ¥æ•°ä¸ºRedisè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•° ## å¦‚æœè®¾ç½® maxclients 0ï¼Œè¡¨ç¤ºä¸ä½œé™åˆ¶ ## å®¢æˆ·ç«¯è¿æ¥æ•°åˆ°è¾¾é™åˆ¶æ—¶,Redisä¼šå…³é—­æ–°çš„è¿æ¥å¹¶å‘å®¢æˆ·ç«¯è¿”å›max number of clients reachedé”™è¯¯ä¿¡æ¯ maxclients 128 ## Redisæœ€å¤§å†…å­˜é™åˆ¶ ## Redisåœ¨å¯åŠ¨æ—¶ä¼šæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¾¾åˆ°æœ€å¤§å†…å­˜åï¼ŒRedisä¼šå…ˆå°è¯•æ¸…é™¤å·²åˆ°æœŸæˆ–å³å°†åˆ°æœŸçš„Key ## å½“æ­¤æ–¹æ³•å¤„ç†åï¼Œä»ç„¶åˆ°è¾¾æœ€å¤§å†…å­˜è®¾ç½®ï¼Œå°†æ— æ³•å†è¿›è¡Œå†™å…¥æ“ä½œï¼Œä½†ä»ç„¶å¯ä»¥è¿›è¡Œè¯»å–æ“ä½œã€‚ ## Redisæ–°çš„vmæœºåˆ¶ï¼Œä¼šæŠŠKeyå­˜æ”¾å†…å­˜ï¼ŒValueä¼šå­˜æ”¾åœ¨swapåŒº maxmemory \u0026lt;bytes\u0026gt; ## æŒ‡å®šæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåè¿›è¡Œæ—¥å¿—è®°å½•, é»˜è®¤ä¸º no ## Redisåœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œå¦‚æœä¸å¼€å¯ï¼Œå¯èƒ½ä¼šåœ¨æ–­ç”µæ—¶å¯¼è‡´ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®ä¸¢å¤± ## å› ä¸º redisæœ¬èº«åŒæ­¥æ•°æ®æ–‡ä»¶æ˜¯æŒ‰ä¸Šé¢saveæ¡ä»¶æ¥åŒæ­¥çš„ï¼Œæ‰€ä»¥æœ‰çš„æ•°æ®ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…åªå­˜åœ¨äºå†…å­˜ä¸­ appendonly no ## æŒ‡å®šæ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤ä¸º appendonly.aof appendfilename appendonly.aof ## æŒ‡å®šæ›´æ–°æ—¥å¿—æ¡ä»¶ ## no : è¡¨ç¤ºç­‰æ“ä½œç³»ç»Ÿè¿›è¡Œæ•°æ®ç¼“å­˜åŒæ­¥åˆ°ç£ç›˜ï¼ˆå¿«ï¼‰ ## always : è¡¨ç¤ºæ¯æ¬¡æ›´æ–°æ“ä½œåæ‰‹åŠ¨è°ƒç”¨fsync()å°†æ•°æ®å†™åˆ°ç£ç›˜ï¼ˆæ…¢ï¼Œå®‰å…¨ï¼‰ ## everysec : è¡¨ç¤ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼ˆæŠ˜ä¸­ï¼Œé»˜è®¤å€¼ï¼‰ appendfsync everysec ## æŒ‡å®šæ˜¯å¦å¯ç”¨è™šæ‹Ÿå†…å­˜æœºåˆ¶ï¼Œé»˜è®¤å€¼ä¸ºno ## VMæœºåˆ¶å°†æ•°æ®åˆ†é¡µå­˜æ”¾,å°†è®¿é—®é‡è¾ƒå°‘çš„é¡µå³å†·æ•°æ®swapåˆ°ç£ç›˜ä¸Š,è®¿é—®å¤šçš„é¡µé¢ç”±ç£ç›˜è‡ªåŠ¨æ¢å‡ºåˆ°å†…å­˜ä¸­ vm-enabled no ## è™šæ‹Ÿå†…å­˜æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤å€¼ä¸º/tmp/redis.swapï¼Œä¸å¯å¤šä¸ªRediså®ä¾‹å…±äº« vm-swap-file /tmp/redis.swap ## å°†æ‰€æœ‰å¤§äºvm-max-memoryçš„æ•°æ®å­˜å…¥è™šæ‹Ÿå†…å­˜ ## æ— è®ºvm-max-memoryè®¾ç½®å¤šå°,æ‰€æœ‰ç´¢å¼•æ•°æ®éƒ½æ˜¯å†…å­˜å­˜å‚¨çš„(Redisçš„ç´¢å¼•æ•°æ® å°±æ˜¯keys), ## ä¹Ÿå°±æ˜¯è¯´,å½“vm-max-memoryè®¾ç½®ä¸º0çš„æ—¶å€™,å…¶å®æ˜¯æ‰€æœ‰valueéƒ½å­˜åœ¨äºç£ç›˜ã€‚é»˜è®¤å€¼ä¸º0 vm-max-memory 0 ## Redis swapæ–‡ä»¶åˆ†æˆäº†å¾ˆå¤šçš„pageï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥ä¿å­˜åœ¨å¤šä¸ªpageä¸Šé¢ï¼Œä½†ä¸€ä¸ªpageä¸Šä¸èƒ½è¢«å¤šä¸ªå¯¹è±¡å…±äº« vm-page-size 32 ## è®¾ç½®swapæ–‡ä»¶ä¸­çš„pageæ•°é‡ ## ç”±äºé¡µè¡¨ï¼ˆä¸€ç§è¡¨ç¤ºé¡µé¢ç©ºé—²æˆ–ä½¿ç”¨çš„bitmapï¼‰æ˜¯åœ¨æ”¾åœ¨å†…å­˜ä¸­çš„,åœ¨ç£ç›˜ä¸Šæ¯8ä¸ªpageså°†æ¶ˆè€—1byteçš„å†…å­˜ã€‚ vm-pages 134217728 ## è®¾ç½®è®¿é—®swapæ–‡ä»¶çš„çº¿ç¨‹æ•°,æœ€å¥½ä¸è¦è¶…è¿‡æœºå™¨çš„æ ¸æ•°, ## å¦‚æœè®¾ç½®ä¸º0,é‚£ä¹ˆæ‰€æœ‰å¯¹swapæ–‡ä»¶çš„æ“ä½œéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œå¯èƒ½ä¼šé€ æˆæ¯”è¾ƒé•¿æ—¶é—´çš„å»¶è¿Ÿã€‚é»˜è®¤å€¼ä¸º4 vm-max-threads 4 ## è®¾ç½®åœ¨å‘å®¢æˆ·ç«¯åº”ç­”æ—¶ï¼Œæ˜¯å¦æŠŠè¾ƒå°çš„åŒ…åˆå¹¶ä¸ºä¸€ä¸ªåŒ…å‘é€ï¼Œé»˜è®¤ä¸ºå¼€å¯ glueoutputbuf yes ## æŒ‡å®šåœ¨è¶…è¿‡ä¸€å®šçš„æ•°é‡æˆ–è€…æœ€å¤§çš„å…ƒç´ è¶…è¿‡æŸä¸€ä¸´ç•Œå€¼æ—¶ï¼Œé‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„å“ˆå¸Œç®—æ³• hash-max-zipmap-entries 64 hash-max-zipmap-value 512 ## æŒ‡å®šæ˜¯å¦æ¿€æ´»é‡ç½®å“ˆå¸Œï¼Œé»˜è®¤ä¸ºå¼€å¯ï¼ˆåé¢åœ¨ä»‹ç»Redisçš„å“ˆå¸Œç®—æ³•æ—¶å…·ä½“ä»‹ç»ï¼‰ activerehashing yes   æ³¨æ„äº‹é¡¹ æˆ‘ä»¬æŸ¥çœ‹äº†é…ç½®æ–‡ä»¶ä¿¡æ¯, æ€»ç»“å¦‚ä¸‹\n   å¦‚æœä½ æƒ³è¦ä»¥åŠ è½½é…ç½®æ–‡ä»¶çš„æ–¹å¼å¯åŠ¨ Redis, é‚£ä¹ˆä½ éœ€è¦ä½¿ç”¨ ./redis-server /path/to/redis.conf å‘½ä»¤å¯åŠ¨ Redis æœåŠ¡ç«¯.\n  å†…å­˜è®¾ç½®å¤§å°å•ä½\n   1k =\u0026gt; 1000 bytes 1kb =\u0026gt; 1024 bytes 1m =\u0026gt; 1000000 bytes 1mb =\u0026gt; 1024*1024 bytes 1g =\u0026gt; 1000000000 bytes 1gb =\u0026gt; 102410241024 bytes 1GB 1Gb 1gB è¡¨è¾¾ä¸€æ ·çš„æ„æ€, å•ä½ä¸åŒºåˆ†å¤§å°å†™    121321\n   åŸºæœ¬æ“ä½œ è¿æ¥è¿œç¨‹æœåŠ¡å™¨ï¼šredis-cli -h host -p port -a password\nä¾‹å¦‚ï¼š$redis-cli -h 127.0.0.1 -p 6379 -a \u0026quot;mypass\u0026quot;\né”®Key ä¸ Redis é”®ç›¸å…³çš„åŸºæœ¬å‘½ä»¤ï¼š\n   åºå· å‘½ä»¤åŠæè¿°     1 DEL key è¯¥å‘½ä»¤ç”¨äºåœ¨ key å­˜åœ¨æ—¶åˆ é™¤ keyã€‚   2 DUMP key åºåˆ—åŒ–ç»™å®š key ï¼Œå¹¶è¿”å›è¢«åºåˆ—åŒ–çš„å€¼ã€‚   3 EXISTS key æ£€æŸ¥ç»™å®š key æ˜¯å¦å­˜åœ¨ã€‚   4 EXPIRE key seconds ä¸ºç»™å®š key è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä»¥ç§’è®¡ã€‚   5 EXPIREAT key timestamp EXPIREAT çš„ä½œç”¨å’Œ EXPIRE ç±»ä¼¼ï¼Œéƒ½ç”¨äºä¸º key è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚ ä¸åŒåœ¨äº EXPIREAT å‘½ä»¤æ¥å—çš„æ—¶é—´å‚æ•°æ˜¯ UNIX æ—¶é—´æˆ³(unix timestamp)ã€‚   6 PEXPIRE key milliseconds è®¾ç½® key çš„è¿‡æœŸæ—¶é—´ä»¥æ¯«ç§’è®¡ã€‚   7 PEXPIREAT key milliseconds-timestamp è®¾ç½® key è¿‡æœŸæ—¶é—´çš„æ—¶é—´æˆ³(unix timestamp) ä»¥æ¯«ç§’è®¡   8 KEYS pattern æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼( pattern)çš„ key ã€‚   9 MOVE key db å°†å½“å‰æ•°æ®åº“çš„ key ç§»åŠ¨åˆ°ç»™å®šçš„æ•°æ®åº“ db å½“ä¸­ã€‚   10 PERSIST key ç§»é™¤ key çš„è¿‡æœŸæ—¶é—´ï¼Œkey å°†æŒä¹…ä¿æŒã€‚   11 PTTL key ä»¥æ¯«ç§’ä¸ºå•ä½è¿”å› key çš„å‰©ä½™çš„è¿‡æœŸæ—¶é—´ã€‚   12 TTL key ä»¥ç§’ä¸ºå•ä½ï¼Œè¿”å›ç»™å®š key çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´(TTL, time to live)ã€‚   13 RANDOMKEY ä»å½“å‰æ•°æ®åº“ä¸­éšæœºè¿”å›ä¸€ä¸ª key ã€‚   14 RENAME key newkey ä¿®æ”¹ key çš„åç§°   15 RENAMENX key newkey ä»…å½“ newkey ä¸å­˜åœ¨æ—¶ï¼Œå°† key æ”¹åä¸º newkey ã€‚   16 TYPE key è¿”å› key æ‰€å‚¨å­˜çš„å€¼çš„ç±»å‹ã€‚    è®¾ç½®é”®å€¼å¯¹ set key value ä¸å–å‡ºé”®å€¼å¯¹ get key\nåˆ é™¤é”®å€¼ä½¿ç”¨del key\nå­—ç¬¦ä¸²å­˜å‚¨ Hashå­˜å‚¨ ä¹‹å‰å˜é‡æ²¡åˆ é™¤ä¼šæŠ¥é”™\nRedis hash æ˜¯ä¸€ä¸ªé”®å€¼(key=\u0026gt;value)å¯¹é›†åˆã€‚\nRedis hash æ˜¯ä¸€ä¸ª string ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼Œhash ç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚\næ¯ä¸ª hash å¯ä»¥å­˜å‚¨ 232 -1 é”®å€¼å¯¹ï¼ˆ40å¤šäº¿ï¼‰ã€‚\nåˆ—è¡¨å­˜å‚¨ Redis åˆ—è¡¨æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åºã€‚ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°åˆ—è¡¨çš„å¤´éƒ¨ï¼ˆå·¦è¾¹ï¼‰æˆ–è€…å°¾éƒ¨ï¼ˆå³è¾¹ï¼‰\nå±•ç¤ºï¼š\nåˆ—è¡¨æœ€å¤šå¯å­˜å‚¨ 232 - 1 å…ƒç´  (4294967295, æ¯ä¸ªåˆ—è¡¨å¯å­˜å‚¨40å¤šäº¿)ã€‚\né›†åˆå­˜å‚¨ æŒ‡ä»¤ï¼šsadd key member å‘é›†åˆkeyæ·»åŠ å…ƒç´ ã€‚\næŒ‡ä»¤ï¼šsmembers keyï¼Œå±•ç¤ºé›†åˆkeyä¸­çš„å…ƒç´ ï¼š\næœ‰åºé›†åˆ-zset æŒ‡ä»¤ï¼šzadd key score member ï¼Œå‘æœ‰åºé›†åˆæ·»åŠ å…ƒç´ ï¼Œå¹¶ä¸”è®¾ç½®ç›¸åº”çš„scoreã€‚\nä¸Šé¢è®¾ç½®Aä¸”scoreä¸º0ï¼ŒBä¸”scoreä¸º2ï¼ŒCä¸”scoreä¸º1.\næŒ‡ä»¤ï¼šzrangebyscore key l r,å±•ç¤ºæœ‰åºé›†åˆæŒ‰scoreæ’åºä¹‹åä¸”åœ¨èŒƒå›´låˆ°rçš„å…ƒç´ ã€‚\næ˜¾ç„¶å…ƒç´ å·²ç»æŒ‰ç…§scoreçš„é¡ºåºæ’åˆ—ã€‚\n è·Ÿå…¶ä»–æ¡æ¬¾ç›¸æ¯”ï¼Œä»GNUé€šç”¨å…¬å…±è®¸å¯è¯ï¼ˆGPLï¼‰åˆ°é™åˆ¶é‡é‡çš„è‘—ä½œæƒï¼ˆCopyrightï¼‰ï¼ŒBSDè®¸å¯è¯æ¯”è¾ƒå®½æ¾ï¼Œç”šè‡³è·Ÿå…¬æœ‰é¢†åŸŸæ›´ä¸ºæ¥è¿‘ã€‚äº‹å®ä¸Šï¼ŒBSDè®¸å¯è¯è¢«è®¤ä¸ºæ˜¯copycenterï¼ˆä¸­é—´è‘—ä½œæƒï¼‰ï¼Œä»‹ä¹æ ‡å‡†çš„copyrightä¸GPLçš„copyleftä¹‹é—´ã€‚\u0026ldquo;Take it down to the copy center and make as many copies as you want\u0026rdquo;[1]ã€‚å¯ä»¥è¯´ï¼ŒGPLå¼ºè¿«åç»­ç‰ˆæœ¬å¿…é¡»ä¸€æ ·æ˜¯è‡ªç”±è½¯ä»¶ï¼ŒBSDçš„åç»­ç‰ˆæœ¬å¯ä»¥é€‰æ‹©è¦ç»§ç»­æ˜¯BSDæˆ–å…¶ä»–è‡ªç”±è½¯ä»¶æ¡æ¬¾æˆ–å°é—­è½¯ä»¶ç­‰ç­‰ã€‚ \u0026#x21a9;\u0026#xfe0e;\n ä¸»ä»è®¾å¤‡æ¨¡å¼ä¹Ÿå«åšä¸»ä»†æ¨¡å¼è‹±æ–‡ç®€ç§°ä¸ºMaster-Slave,æ ¸å¿ƒæ€æƒ³æ˜¯åŸºäºåˆ†è€Œæ²»ä¹‹çš„æ€æƒ³,å°†ä¸€ä¸ªåŸå§‹ä»»åŠ¡åˆ†è§£ä¸ºè‹¥å¹²ä¸ªè¯­ä¹‰ç­‰åŒçš„å­ä»»åŠ¡,å¹¶ç”±ä¸“é—¨çš„å·¥ä½œè€…çº¿ç¨‹æ¥å¹¶è¡Œæ‰§è¡Œè¿™äº›ä»»åŠ¡,åŸå§‹ä»»åŠ¡çš„ç»“æœæ˜¯é€šè¿‡æ•´åˆå„ä¸ªå­ä»»åŠ¡çš„å¤„ç†ç»“æœå½¢æˆçš„ \u0026#x21a9;\u0026#xfe0e;\n æ„æ€å°±æ˜¯è¦ä¹ˆæˆåŠŸæ‰§è¡Œè¦ä¹ˆå¤±è´¥å®Œå…¨ä¸æ‰§è¡Œã€‚å•ä¸ªæ“ä½œæ˜¯åŸå­æ€§çš„ã€‚å¤šä¸ªæ“ä½œä¹Ÿæ”¯æŒäº‹åŠ¡ï¼Œå³åŸå­æ€§ï¼Œé€šè¿‡MULTIå’ŒEXECæŒ‡ä»¤åŒ…èµ·æ¥ã€‚ \u0026#x21a9;\u0026#xfe0e;\n  ","description":"","id":101,"section":"posts","tags":["redis","åˆ†å¸ƒå¼è®¡ç®—","äº‘è®¡ç®—","æ•°æ®åº“"],"title":"åˆ†å¸ƒå¼-Redis","uri":"https://hugo.jiahongw.com/zh/posts/database/redis/"},{"content":"èµ°å¾—æ…¢çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆä¸è·‘å‘¢ï¼Ÿ#ï¸âƒ£\nå“ˆå¸Œæ•£åˆ—è¡¨ ä¸¤ä¸ªæ¦‚å¿µï¼š\næ•£åˆ—è¡¨ï¼š\næ•£åˆ—è¡¨ï¼ˆHash tableï¼Œä¹Ÿå«å“ˆå¸Œè¡¨ï¼‰ï¼Œæ˜¯æ ¹æ®é”®ï¼ˆKeyï¼‰è€Œç›´æ¥è®¿é—®åœ¨å†…å­˜å­˜å‚¨ä½ç½®çš„æ•°æ®ç»“æ„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡è®¡ç®—ä¸€ä¸ªå…³äºé”®å€¼çš„å‡½æ•°ï¼Œå°†æ‰€éœ€æŸ¥è¯¢çš„æ•°æ®æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®¿é—®è®°å½•ï¼Œè¿™åŠ å¿«äº†æŸ¥æ‰¾é€Ÿåº¦ã€‚è¿™ä¸ªæ˜ å°„å‡½æ•°ç§°åšæ•£åˆ—å‡½æ•°ï¼Œå­˜æ”¾è®°å½•çš„æ•°ç»„ç§°åšæ•£åˆ—è¡¨ã€‚\næ•£åˆ—å‡½æ•°ï¼š\næ•£åˆ—å‡½æ•°ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å¦‚æœæŠŠå®ƒå®šä¹‰æˆ hash(key) ï¼Œå…¶ä¸­ key è¡¨ç¤ºå…ƒç´ çš„é”®å€¼ï¼Œåˆ™ hash(key) çš„å€¼è¡¨ç¤ºç»è¿‡æ•£åˆ—å‡½æ•°è®¡ç®—å¾—åˆ°çš„æ•£åˆ—å€¼ã€‚\næ•£åˆ—å‡½æ•°ç‰¹ç‚¹ï¼š\n ç¡®å®šæ€§ æ•£åˆ—ç¢°æ’ï¼ˆcollisionï¼‰ ä¸å¯é€†æ€§(ä¸€ä¸ªå“ˆå¸Œå€¼å¯¹åº”æ— æ•°ä¸ªæ˜æ–‡ï¼Œç†è®ºä¸Šä½ å¹¶ä¸çŸ¥é“å“ªä¸ªæ˜¯ã€‚) æ··æ·†ç‰¹æ€§  å¸¸è§çš„æ•£åˆ—å‡½æ•°ï¼š\n MD51 SHA-12  ä¸ºä»€ä¹ˆå“ˆå¸Œç®—æ³•æŸ¥æ‰¾æ•°ç»„å…ƒç´ ä¼šæ›´å¿«ï¼Ÿ\n åŸæ¥ä½¿ç”¨ä¸‹æ ‡è¿›è¡ŒåŒ¹é…çš„ç”»ï¼Œä¼šä¸€ä¸ªä¸€ä¸ªä»ä¸€æ•´ä¸ªæ•°ç»„è¿›è¡Œå…ƒç´ åŒ¹é…ï¼ŒçŸ¥é“æ‰¾åˆ°ç›¸ç­‰çš„å…ƒç´ æ‰å¾—åˆ°æ•°ç»„çš„ä¿¡æ¯ã€‚ä¾‹å¦‚åœ¨Arr[20]æŸ¥æ‰¾å€¼ä¸º12çš„,å°±éœ€è¦ä»ä¸‹æ ‡0åˆ°19è¿›è¡ŒæŸ¥æ‰¾ã€‚\nä½†æ˜¯å“ˆå¸Œæ•£åˆ—è¡¨å°†ä¸€ä¸ªä¸€ä¸ªæŒ‰é¡ºåºçš„æŸ¥æ‰¾è½¬æ¢ä¸ºä½¿ç”¨è®¡ç®—çš„æ–¹å¼è¿›è¡ŒæŸ¥æ‰¾ï¼Œå°†è¿ç®—ç»“æœçš„ä¸‹æ ‡æ˜ å°„æˆä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œå®ç°äº†è·³è·ƒå¼çš„æŸ¥æ‰¾ï¼Œä»è€Œæ•ˆç‡æ›´é«˜ã€‚\n é—®é¢˜:æ•£åˆ—å†²çª\n å¯¹äºæ•£åˆ—è¡¨è€Œè¨€ï¼Œæ— è®ºè®¾ç½®çš„å­˜å‚¨åŒºåŸŸï¼ˆnï¼‰æœ‰å¤šå¤§ï¼Œå½“éœ€è¦å­˜å‚¨çš„æ•°æ®å¤§äº n æ—¶ï¼Œé‚£ä¹ˆå¿…ç„¶ä¼šå­˜åœ¨å“ˆå¸Œå€¼ç›¸åŒçš„æƒ…å†µã€‚è¿™å°±æ˜¯æ‰€è°“çš„æ•£åˆ—å†²çªã€‚\n è§£å†³æ•£åˆ—å‡½æ•°çš„ä¸¤ä¸ªæ–¹æ³•ï¼š\n  é“¾è¡¨æ³•\nå°±æ˜¯ä½¿ç”¨é“¾è¡¨æ¥ä¿å­˜å†²çªä¸‹æ ‡çš„æ•°æ®ï¼Œä¾‹å¦‚$12 % 5 = 2$å’Œ$7 % 5 = 2$,é‚£ä¹ˆåœ¨ä¸‹æ ‡ä¸º2çš„è¡¨ä¸‹ç”¨ä¸€ä¸ªé“¾è¡¨å­˜å‚¨12å’Œ7ã€‚\n  å¼€æ”¾å¯»å€æ³•ã€‚\nå¸¸è§ä¸‰ç§æ–¹æ³•ï¼šçº¿æ€§æ¢æµ‹æ³•ã€äºŒæ¬¡æ¢æµ‹æ³•ã€åŒæ•£åˆ—\nå‡è®¾å“ˆå¸Œå‡½æ•°ä¸ºï¼š\n$$\nH(key) = key \\mod10\n$$\nçº¿æ€§æ¢æµ‹æ³•ï¼š\nè¿˜æ˜¯$12 % 10 = 2 $å’Œ$22 % 10 = 2$è¿™ä¸¤ä¸ªä¾‹å­ï¼Œå½“22è¿™ä¸ªæ•°å­—éœ€è¦å­˜å…¥å“ˆå¸Œè¡¨æ—¶ï¼Œå‘ç°å·²ç»æœ‰12è¿™ä¸ªå…ƒç´ å­˜æ”¾åœ¨ä¸‹æ ‡ä¸º2çš„å“ˆå¸Œè¡¨ä¸Šäº†ï¼Œé‚£ä¹ˆå¯¹Hashåçš„æ•°å­—åŠ ä¸€åœ¨è¿›è¡ŒHashã€‚å³å¯¹7è¿›è¡Œè¿™æ ·çš„æ“ä½œï¼š\n$$\nH((H(key)+1)) = ((22 \\mod 10) + 1) \\mod 10 = (2 + 1) \\mod 10 = 3\n$$\nä½†æ˜¯è¿™ç§æ–¹å¼çš„é—®é¢˜æ˜¯å†²çªè¾ƒå¤šçš„æ—¶å€™ä¼šå‡ºç°æ•°æ®èšé›†åœ¨ä¸€ä¸ªåŒºåŸŸï¼Œè¿™æ ·ä¸åˆ©äºæŸ¥è¯¢æ•°æ®ã€‚\näºŒæ¬¡æ¢æµ‹æ³•ï¼š\näºŒæ¬¡æ¢æµ‹æ³•ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°è§£å†³å†²çªï¼š\n$$\n(H(key) \\pm j^2) \\mod 10,j = 0,1,2\u0026hellip;\n$$\nè¿™ç§æ–¹æ³•è¾ƒä¸ºå¤æ‚ï¼Œè€Œä¸”è™½ç„¶ä¸ä¼šè¿ç»­çš„èšé›†ä¸€ç‰‡ï¼Œä½†æ˜¯ä¼šåœ¨å¤šä¸ªé—´æ–­çš„ä½ç½®èšé›†ã€‚\nåŒæ•£åˆ—ï¼š\nåŒæ•£åˆ—ï¼Œé¡¾åæ€ä¹‰å°±éœ€è¦å¢åŠ ä¸€ä¸ªäºŒçº§æ•£åˆ—å‡½æ•°ï¼Œä¾‹å¦‚$G(key) = q - (key \\mod q) qä¸ºç´ æ•°ä¸”q\u0026lt;N$ï¼Œå‘ç°å†²çªä½¿ç”¨å¦‚ä¸‹æ“ä½œï¼š\n$$\nH(key) + j * G(key),j = 0,1,2\u0026hellip;\u0026hellip;\n$$\nåŒæ•£åˆ—æ–¹æ³•æœ‰å¾ˆå¤šç»„åˆçš„æ–¹æ³•ï¼Œè¿™é‡Œåªæ˜¯å…¶ä¸­çš„ä¸€ç§ï¼Œä¹Ÿæœ‰ä¸€äº›ä¾‹å¦‚:$H(key) + G(key)$,æ²¡æœ‰jè¿™ä¸ªå‚æ•°ã€‚\n  å¯†ç å­¦ä¸­çš„å“ˆå¸Œç®—æ³•  hashï¼ˆæ•£åˆ—ã€æ‚å‡‘ï¼‰å‡½æ•°ï¼Œæ˜¯å°†ä»»æ„é•¿åº¦çš„æ•°æ®æ˜ å°„åˆ°æœ‰é™é•¿åº¦çš„åŸŸä¸Šã€‚ç›´è§‚è§£é‡Šèµ·æ¥ï¼Œå°±æ˜¯å¯¹ä¸€ä¸²æ•°æ®mè¿›è¡Œæ‚ç³…ï¼Œè¾“å‡ºå¦ä¸€æ®µå›ºå®šé•¿åº¦çš„æ•°æ®hï¼Œä½œä¸ºè¿™æ®µæ•°æ®çš„ç‰¹å¾ï¼ˆæŒ‡çº¹ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ— è®ºæ•°æ®å—mæœ‰å¤šå¤§ï¼Œå…¶è¾“å‡ºå€¼hä¸ºå›ºå®šé•¿åº¦ã€‚åˆ°åº•æ˜¯ä»€ä¹ˆåŸç†ï¼Ÿå°†måˆ†æˆå›ºå®šé•¿åº¦ï¼ˆå¦‚128ä½ï¼‰ï¼Œä¾æ¬¡è¿›è¡Œhashè¿ç®—ï¼Œç„¶åç”¨ä¸åŒçš„æ–¹æ³•è¿­ä»£å³å¯ï¼ˆå¦‚å‰ä¸€å—çš„hashå€¼ä¸åä¸€å—çš„hashå€¼è¿›è¡Œå¼‚æˆ–ï¼‰ã€‚å¦‚æœä¸å¤Ÿ128ä½æ€ä¹ˆåŠï¼Ÿç”¨0è¡¥å…¨æˆ–è€…ç”¨1è¡¥å…¨éšæ„ï¼Œç®—æ³•ä¸­çº¦å®šå¥½å°±å¯ä»¥äº†ã€‚\n ä¸€èˆ¬æ¥è¯´ï¼Œå…¬å¸ä¸ä¼šç›´æ¥å°†ç”¨æˆ·çš„å¯†ç ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œè€Œæ˜¯ä¿å­˜ç»è¿‡å“ˆå¸Œæ“ä½œçš„å¯†ç å¾—åˆ°çš„å“ˆå¸Œå€¼ã€‚è¿™æ ·ï¼Œå½“å“ˆå¸Œå€¼è¢«ä¸æ³•åˆ†å­çªƒå–ï¼Œä¹Ÿä¸èƒ½è¿˜åŸå‡ºç”¨æˆ·çš„å¯†ç ï¼›å¹¶ä¸”ï¼Œå…¬å¸åªéœ€è¦å°†ç”¨æˆ·è¾“å…¥çš„å¯†ç è¿›è¡Œå“ˆå¸Œæ“ä½œï¼Œå°†å“ˆå¸Œå€¼ä¸å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å“ˆå¸Œå€¼è¿›è¡Œå¯¹æ¯”å°±èƒ½å¤ŸéªŒè¯ç”¨æˆ·äº†ã€‚\nå“ˆå¸Œçš„å…¶ä»–ç”¨æ³• æ•°æ®æ ¡éªŒï¼š\n  Gitçš„- git commit id\næ¯æ¬¡gitæäº¤åéƒ½æœ‰ä¸€ä¸ªcommit idï¼Œæ¯”å¦‚:\n19d02d2cc358e59b3d04f82677dbf3808ae4fc40\n  ç‰ˆæƒæ ¡éªŒ\nåˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯ä¸æ˜¯ä¸€æ ·çš„ï¼Œå¯¹ä¸¤ä¸ªæ–‡ä»¶éƒ½è¿›è¡Œå“ˆå¸Œæ“ä½œï¼Œå¾—åˆ°å“ˆå¸Œå€¼ï¼Œè‹¥å“ˆå¸Œå€¼ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªæ–‡ä»¶ä¸ºåŒä¸€ä¸ªæ–‡ä»¶ã€‚\n  å¤§æ–‡ä»¶åˆ†å—æ ¡éªŒ\nä¾‹å¦‚ä½¿ç”¨btä¸‹è½½ï¼Œåœ¨p2pç½‘ç»œä¸­ä¼šæŠŠä¸€ä¸ªå¤§æ–‡ä»¶æ‹†åˆ†æˆå¾ˆå¤šå°çš„æ•°æ®å„è‡ªä¼ è¾“ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯å¦‚æœæŸä¸ªå°çš„æ•°æ®å—åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æŸåäº†ï¼Œåªè¦é‡æ–°ä¸‹è½½è¿™ä¸ªå—å°±å¥½ã€‚ä¸ºäº†ç¡®ä¿æ¯ä¸€ä¸ªå°çš„æ•°æ®å—éƒ½æ˜¯å‘å¸ƒè€…è‡ªå·±ä¼ è¾“çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯ä¸€ä¸ªå°çš„æ•°æ®å—éƒ½è¿›è¡Œä¸€ä¸ªhashçš„è®¡ç®—ï¼Œç»´æŠ¤ä¸€ä¸ªhash Listï¼Œåœ¨æ”¶åˆ°æ‰€æœ‰æ•°æ®ä»¥åï¼Œæˆ‘ä»¬å¯¹äºè¿™ä¸ªhash Listé‡Œçš„æ¯ä¸€å—è¿›è¡Œéå†æ¯”å¯¹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¼˜åŒ–ç‚¹æ˜¯å¦‚æœæ–‡ä»¶åˆ†å—ç‰¹åˆ«å¤šçš„æ—¶å€™ï¼Œå¦‚æœéå†å¯¹æ¯”å°±ä¼šæ•ˆç‡æ¯”è¾ƒä½ã€‚å¯ä»¥æŠŠæ‰€æœ‰åˆ†å—çš„hashå€¼ç»„åˆæˆä¸€ä¸ªå¤§çš„å­—ç¬¦ä¸²ï¼Œå¯¹äºè¿™ä¸ªå­—ç¬¦ä¸²å†åšä¸€æ¬¡Hashè¿ç®—ï¼Œå¾—åˆ°æœ€ç»ˆçš„hashï¼ˆRoot hashï¼‰ã€‚åœ¨å®é™…çš„æ ¡éªŒä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æ‹¿åˆ°äº†æ­£ç¡®çš„Root hashï¼Œå³å¯æ ¡éªŒHash Listï¼Œä¹Ÿå°±å¯ä»¥æ ¡éªŒæ¯ä¸€ä¸ªæ•°æ®å—äº†ã€‚\n  è´Ÿè½½å‡è¡¡ï¼š\nä¸€è‡´æ€§hashçš„åŸºæœ¬åŸç†æ˜¯å°†è¾“å…¥çš„å€¼hashåï¼Œå¯¹ç»“æœçš„hashå€¼è¿›è¡Œ2^32å–æ¨¡ï¼Œè¿™é‡Œå’Œæ™®é€šçš„hashå–æ¨¡ç®—æ³•ä¸ä¸€æ ·çš„ç‚¹æ˜¯åœ¨ä¸€è‡´æ€§hashç®—æ³•é‡Œå°†å–æ¨¡çš„ç»“æœæ˜ å°„åˆ°ä¸€ä¸ªç¯ä¸Šã€‚å°†ç¼“å­˜æœåŠ¡å™¨ä¸è¢«ç¼“å­˜å¯¹è±¡éƒ½æ˜ å°„åˆ°hashç¯ä¸Šä»¥åï¼Œä»è¢«ç¼“å­˜å¯¹è±¡çš„ä½ç½®å‡ºå‘ï¼Œæ²¿é¡ºæ—¶é’ˆæ–¹å‘é‡åˆ°çš„ç¬¬ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå°±æ˜¯å½“å‰å¯¹è±¡å°†è¦ç¼“å­˜äºçš„æœåŠ¡å™¨ï¼Œç”±äºè¢«ç¼“å­˜å¯¹è±¡ä¸æœåŠ¡å™¨hashåçš„å€¼æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ï¼Œåœ¨æœåŠ¡å™¨ä¸å˜çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªopenidå¿…å®šä¼šè¢«ç¼“å­˜åˆ°å›ºå®šçš„æœåŠ¡å™¨ä¸Šï¼Œé‚£ä¹ˆï¼Œå½“ä¸‹æ¬¡æƒ³è¦è®¿é—®è¿™ä¸ªç”¨æˆ·çš„æ•°æ®æ—¶ï¼Œåªè¦å†æ¬¡ä½¿ç”¨ç›¸åŒçš„ç®—æ³•è¿›è¡Œè®¡ç®—ï¼Œå³å¯ç®—å‡ºè¿™ä¸ªç”¨æˆ·çš„æ•°æ®è¢«ç¼“å­˜åœ¨å“ªä¸ªæœåŠ¡å™¨ä¸Šï¼Œç›´æ¥å»å¯¹åº”çš„æœåŠ¡å™¨æŸ¥æ‰¾å¯¹åº”çš„æ•°æ®å³å¯ã€‚è¿™é‡Œçš„é€»è¾‘å…¶å®å’Œç›´æ¥å–æ¨¡çš„æ˜¯ä¸€æ ·çš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nè¿™éƒ¨åˆ†ä¸æ˜¯å¾ˆæ·±å…¥ï¼Œä¹‹åå†è¡¥å……\u0026hellip;\u0026hellip;ğŸš´\nå‚è€ƒé“¾æ¥ï¼š\n https://www.zhihu.com/question/26762707?sort=created-çŸ¥ä¹ åŠ¨ç”»ï¼šä»€ä¹ˆæ˜¯æ•£åˆ—è¡¨ï¼Ÿ-äº”åˆ†é’Ÿç®—æ³• ä»€ä¹ˆæ˜¯ hashï¼Ÿ-çŸ¥ä¹   MD5 å³ Message-Digest Algorithm 5ï¼ˆä¿¡æ¯-æ‘˜è¦ç®—æ³•5ï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚æ˜¯è®¡ç®—æœºå¹¿æ³›ä½¿ç”¨çš„æ‚å‡‘ç®—æ³•ä¹‹ä¸€ï¼Œä¸»æµç¼–ç¨‹è¯­è¨€æ™®éå·²æœ‰ MD5 å®ç°ã€‚ \u0026#x21a9;\u0026#xfe0e;\n SHA-1ï¼ˆè‹±è¯­ï¼šSecure Hash Algorithm 1ï¼Œä¸­æ–‡åï¼šå®‰å…¨æ•£åˆ—ç®—æ³•1ï¼‰æ˜¯ä¸€ç§å¯†ç æ•£åˆ—å‡½æ•°ï¼ŒSHA-1å¯ä»¥ç”Ÿæˆä¸€ä¸ªè¢«ç§°ä¸ºæ¶ˆæ¯æ‘˜è¦çš„160ä½ï¼ˆ20å­—èŠ‚ï¼‰æ•£åˆ—å€¼ï¼Œæ•£åˆ—å€¼é€šå¸¸çš„å‘ˆç°å½¢å¼ä¸º40ä¸ªåå…­è¿›åˆ¶æ•°ã€‚ \u0026#x21a9;\u0026#xfe0e;\n  ","description":"","id":102,"section":"posts","tags":["Hash","Algorithm","md5","sha"],"title":"ä»€ä¹ˆæ˜¯Hashï¼Ÿ","uri":"https://hugo.jiahongw.com/zh/posts/algorithmstructure/hash-circle/"},{"content":"æ’åºæ˜¯æœ€åŸºæœ¬çš„ç®—æ³•ï¼Œé‡Œé¢åŒ…å«äº†æœ€åŸºç¡€çš„æ€æƒ³ã€‚ä¸€ä¸ªç®€å•çš„ä¼˜åŒ–å¯ä»¥è®©æ’åºå¿«å¾ˆå¤šã€‚\n$O(n^2)$çš„æ’åºç®—æ³• å†’æ³¡æ’åº 1 2 3 4 5 6 7 8 9 10 11 12 13  //å†’æ³¡æ’åº template \u0026lt;typename T\u0026gt; void bubbleSort(T *arr, int size) { for (int i = 0; i \u0026lt; size; ++i) { for (int j = 0; j \u0026lt; size - i - 1; ++j) { if (arr[j] \u0026gt; arr[j + 1]) swap(arr[j], arr[j + 1]); } } }   æ’å…¥æ’åº â€‹\n1 2 3 4 5 6 7 8 9  template\u0026lt;typename T\u0026gt; void insertSort(T *arr,int size) { for(int i = 0;i \u0026lt; size;++i) { int j; for(j = i;j \u0026gt; 0 \u0026amp;\u0026amp; arr[j] \u0026lt; arr[j-1];--j){swap(arr[j],arr[j-1]);} } }   é€‰æ‹©æ’åº 1 2 3 4 5 6 7 8 9 10 11 12 13 14  //é€‰æ‹©æ’åº å¤æ‚åº¦O(n^2) template\u0026lt;typename T\u0026gt; void selectionSort(T *arr,int size) { int k; for(int i = 0;i \u0026lt; size-1; ++i) { k = i; for(int j = i+1;j \u0026lt; size;++j) if(arr[j] \u0026lt; arr[k]) k = j; if(k != i) mySwap(arr[k],arr[i]); } }   æµ‹è¯•æ’åºä½¿ç”¨æ—¶é—´çš„æ—¶å€™ï¼Œæ€»æ˜¯é€‰æ‹©æ’åºå¿«äºæ’å…¥æ’åºï¼ŒæŒ‰ç†è¯´ï¼Œæ’å…¥æ’åºåº”è¯¥æ¯”é€‰æ‹©æ’åºè¦å¿«å•Šï¼Œå› ä¸ºæ’å…¥æ’åºå¯ä»¥æå‰ç»ˆæ­¢å¾ªç¯ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\n åŸå› æ˜¯é€‰æ‹©æ’åºæ¯”è¾ƒçš„æ˜¯ä¸‹æ ‡ï¼Œè€Œæ’å…¥æ’åºæ¯ä¸€æ¬¡æ¯”è¾ƒéƒ½è¦äº¤æ¢ï¼Œè€Œäº¤æ¢æ‰€è€—è´¹çš„æ—¶é—´æ˜¯é«˜äºç®€å•çš„æ¯”è¾ƒçš„ã€‚\n æ’å…¥æ’åºä¼˜åŒ–-å°†äº¤æ¢å˜æˆèµ‹å€¼\n1 2 3 4 5 6 7 8 9 10 11  template\u0026lt;typename T\u0026gt; void insertSort(T *arr,int size) { for(int i = 0;i \u0026lt; size;++i) { T e = arr[i]; int j; for(j = i;j \u0026gt; 0 \u0026amp;\u0026amp; arr[j-1] \u0026gt; e;--j){arr[j] = arr[j-1];} arr[j] = e; } }   è¿è¡Œæ—¶é—´æ˜æ˜¾å˜å¿«äº†\n å¯¹äºè¿‘ä¹æœ‰åºçš„æ•°æ®æ¥è¯´ï¼Œæ’å…¥æ’åºçš„é€Ÿåº¦è¦å¿«å¾ˆå¤šï¼Œè¿‘ä¹$O (n)$ã€‚è€Œæ’å…¥æ’åºçš„å®é™…åº”ç”¨æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚æ—¥å¿—ï¼Œæ—¥å¿—çš„æ—¶é—´æ˜¯è¿‘ä¹æœ‰åºçš„ï¼Œä½†æ˜¯ç”Ÿæˆæ—¥å¿—å¯èƒ½ä¼šå‡ºé”™ï¼Œéœ€è¦è¿›è¡Œæ—¶é—´æ’åºå¤„ç†ï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨æ’å…¥æ’åºä¼šæ›´å¥½ï¼›è¿˜æœ‰é“¶è¡Œçš„ä¸€äº›æµæ°´å•ç­‰ç­‰\n æ‹“å±•ï¼š C++è¿ç®—ç¬¦é‡è½½\n ä¸€èˆ¬åœ¨ç±»ä¸­å®ç°ï¼Œæœ‰ä¸¤ç§å¯ä»¥å®ç°çš„æ–¹æ³•\n  è¿ç®—ç¬¦é‡è½½ä¾‹å­ï¼Œä½¿ç”¨åœ¨ä¸€ä¸ªç±»ä¸­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  class Student { public: string name; int score; bool operator\u0026lt;(const Student \u0026amp;otherStudent) { return this-\u0026gt;score \u0026lt; otherStudent.score; } friend ostream \u0026amp;operator\u0026lt;\u0026lt;(ostream \u0026amp;os, const Student \u0026amp;student) { os \u0026lt;\u0026lt; \u0026#34;Student:\u0026#34; \u0026lt;\u0026lt; student.name \u0026lt;\u0026lt; \u0026#34;\u0026#34;\u0026lt;\u0026lt;student.score\u0026lt;\u0026lt;endl; return os; } };      ä½¿ç”¨å‹å…ƒå‡½æ•°\n1 2 3 4 5 6 7 8  è¿”å›å€¼ç±»å‹ operator è¿ç®—ç¬¦(å½¢å‚è¡¨) { ... } //ä¾‹Complexæ˜¯ä¸€ä¸ªå¤æ•°ç±» friend Complex operator+(const Complex \u0026amp;c1,const Complex \u0026amp;c2){ return Complex(c1.i + c2.i,c1.j + c2.j); }     ä½¿ç”¨ç±»é‡Œé¢çš„å‡½æ•°\n1 2 3 4 5 6 7 8  è¿”å›å€¼ç±»å‹ operator è¿ç®—ç¬¦(å½¢å‚è¡¨) { ... } //ä¾‹Complexæ˜¯ä¸€ä¸ªå¤æ•°ç±» Complex operator+(const Complex \u0026amp;complex){ return Complex(this-\u0026gt;i + complex.i,this-\u0026gt;j + complex.j); }     å®ƒä»¬çš„åŒºåˆ«å°±æ˜¯å‚æ•°çš„ä¸ªæ•°ä¸åŒä»¥åŠéœ€ä¸éœ€è¦åŠ ä¸Šfridendè¿™ä¸ªå…³é”®å­—\n$O(n\\log (n))$çš„æ’åºç®—æ³• å½’å¹¶æ’åº ä»£ç å®ç°\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  template \u0026lt;typename T\u0026gt; void __merge(T *arr, int l, int middle, int r) { T aux[r - l + 1]; for (int i = l; i \u0026lt;= r; ++i) aux[i - l] = arr[i]; int i = l, j = middle + 1; for (int k = l; k \u0026lt;= r; ++k) { if (i \u0026gt; middle) { arr[k] = aux[j - l]; j++; } else if (j \u0026gt; r) { arr[k] = aux[i - l]; i++; } else if (aux[i - l] \u0026lt; aux[j - l]) { arr[k] = aux[i - l]; i++; } else { arr[k] = aux[j - l]; j++; } } } template \u0026lt;typename T\u0026gt; void __mergeSort(T *arr, int l, int r) { if (l \u0026gt;= r) return; int middle = (l + r) / 2; __mergeSort(arr, l, middle); __mergeSort(arr, middle+1, r); if(arr[middle] \u0026gt; arr[middle+1]) __merge(arr, l, middle, r); } //å½’å¹¶æ’åº template \u0026lt;typename T\u0026gt; void mergeSort(T *arr, int size) { __mergeSort(arr, 0, size - 1); }   ä¸‹é¢è¿™æ®µä»£ç çš„æ ‡è®°éƒ¨åˆ†éœ€è¦è€ƒè™‘æº¢å‡ºçš„é—®é¢˜\n å½’å¹¶æ’åºå¿«æ˜¯å¿«ï¼Œä½†æ˜¯è¦è€—è´¹å¤šä¸€å€$O(n)$çš„å­˜å‚¨ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ç©ºé—´æ¢æ—¶é—´ã€‚\n å¸Œå°”æ’åº åŠ¨ç”»æ¼”ç¤º(æ¥è‡ª@äº”åˆ†é’Ÿç®—æ³•)ï¼š\nä»£ç å®ç°:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  //å¸Œå°”æ’åº template \u0026lt;typename T\u0026gt; void shellSort(T *arr, int size) { int dk[] = {5, 3, 1}; for (int index = 0; index \u0026lt; 3; ++index) { for (int i = 0; i \u0026lt; size / dk[index]; ++i) { int j; int e = arr[i]; for (j = i + dk[index]; j \u0026gt; dk[index] \u0026amp;\u0026amp; arr[j] \u0026gt; e; j -= dk[index]) { arr[j] = arr[j - dk[index]]; } arr[j] = e; } } }    å¸Œå°”æ’åºç›¸å½“äºæ˜¯æ’å…¥æ’åºçš„å‡çº§ç‰ˆï¼Œå¢åŠ äº†ä¸€ä¸ªæ­¥é•¿å‚æ•°ï¼Œä½¿ç”¨å¸Œå°”æ’åºå¯ä»¥è®©é›¶æ•£çš„æ•°æ®å®ç°è·³è·ƒè¡Œçš„äº¤æ¢ï¼Œæœ€åé€æ¸å°†æ•°ç»„è½¬åŒ–ä¸ºæœ‰åºï¼Œè¿™æ ·æœ€åä½¿ç”¨æ­¥é•¿ä¸º1çš„æ’å…¥æ’åºå°±éå¸¸å¿«äº†ã€‚\n å¿«é€Ÿæ’åº è¢«ç§°ä¸ºäºŒåä¸–çºªå½±å“æœ€å¤§çš„ç®—æ³•ä¹‹ä¸€ï¼\nåŠ¨ç”»æ¼”ç¤º(æ¥è‡ª@äº”åˆ†é’Ÿç®—æ³•)ï¼š\nä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  template\u0026lt;typename T\u0026gt; int __partition(T *arr,int l,int r){ T v = arr[l]; int j = l; for(int i = l+1;i \u0026lt;= r;++i){ if(arr[i] \u0026lt; v){ swap(arr[i],arr[++j]); } } swap(arr[l],arr[j]); return j; } template\u0026lt;typename T\u0026gt; void __quickSort(T *arr,int l,int r) { if(l \u0026gt;= r) return; int p = __partition(arr,l,r); __quickSort(arr,l,p-1); __quickSort(arr,p+1,r); } //å¿«é€Ÿæ’åº template\u0026lt;typename T\u0026gt; void quickSort(T *arr,int size) { __quickSort(arr,0,size-1); }   ä¼˜åŒ–ä¸€ï¼š\nåœ¨æ•°ç»„çš„å…ƒç´ ä¸ªæ•°å°äº15ä¸ªçš„æ—¶å€™ä½¿ç”¨æ’å…¥æ’åºè¿›è¡Œä¼˜åŒ–:\n1 2 3 4 5 6 7 8  template\u0026lt;typename T\u0026gt; void __quickSort(T *arr,int l,int r) { + if(r - l \u0026lt;= 15) insertionSort(arr,l,r);  int p = __partition(arr,l,r); __quickSort(arr,l,p-1); __quickSort(arr,p+1,r); }   ä¼˜åŒ–äºŒï¼š\nä½¿ç”¨éšæœºå€¼ä½œä¸ºåˆ’åˆ†æ ‡å‡†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  template\u0026lt;typename T\u0026gt; int __partition(T *arr,int l,int r){ + swap(arr[l],arr[rand() % (r-l+1) + l]);  T v = arr[l]; int j = l; for(int i = l+1;i \u0026lt;= r;++i){ if(arr[i] \u0026lt; v){ swap(arr[i],arr[++j]); } } swap(arr[l],arr[j]); return j; } template\u0026lt;typename T\u0026gt; void quickSort(T *arr,int size) { + srand(time(NULL));  __quickSort(arr,0,size-1); }   ç¼ºç‚¹:\n åœ¨è¿‘ä¹æœ‰åºçš„æ•°ç»„æ’åºä¸­ï¼Œå¿«é€Ÿæ’åºçš„æ€§èƒ½å¾ˆå·®ã€‚æ—¶é—´å¤æ‚åº¦ä¹Ÿè¿‘ä¹$O(n^2 )$ å¯¹äºæœ‰å¾ˆå¤šé‡å¤å…ƒç´ çš„æ•°ç»„ï¼Œå¿«é€Ÿæ’åºçš„æ€§èƒ½ä¹Ÿå¾ˆå·®  å¿«é€Ÿæ’åºç‰ˆæœ¬äºŒï¼šä¸¤è·¯å¿«æ’ ä½¿ç”¨ä¸¤ä¸ªä¸‹æ ‡åˆ†åˆ«å¤„ç†å¤§äºvä¸å°äºvçš„éƒ¨åˆ†ã€‚(vä¸ºåŸºå‡†å…ƒç´ )\nä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  template\u0026lt;typename T\u0026gt; int __partition2(T *arr,int l,int r){ swap(arr[l],arr[rand() % (r-l+1) + l]); T v = arr[l]; int i = l + 1,j = r; while(true) { while(arr[i] \u0026lt; v \u0026amp;\u0026amp; i \u0026lt;= r) ++i; while(arr[j] \u0026gt; v \u0026amp;\u0026amp; j \u0026gt;= l+1) --j; if(i \u0026gt; j) break; swap(arr[i++],arr[j--]); } swap(arr[l],arr[j]); return j; } template\u0026lt;typename T\u0026gt; void __quickSort2(T *arr,int l,int r) { if(r - l\u0026lt;= 15){ insertSort(arr,l,r); return; } int p = __partition2(arr,l,r); __quickSort2(arr,l,p-1); __quickSort2(arr,p+1,r); } //å¿«é€Ÿæ’åºç‰ˆæœ¬äºŒï¼ŒåŒè·¯å¿«æ’ template\u0026lt;typename T\u0026gt; void quickSort2(T *arr,int size) { srand(time(NULL)); __quickSort2(arr,0,size-1); }   å¿«é€Ÿæ’åºç‰ˆæœ¬ä¸‰ï¼šä¸‰è·¯å¿«æ’ ä½¿ç”¨ä¸‰ä¸ªä¸‹æ ‡åˆ†åˆ«å¤„ç†å¤§äºvã€ç­‰äºvä¸å°äºvçš„éƒ¨åˆ†ã€‚(vä¸ºåŸºå‡†å…ƒç´ )\nä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  template\u0026lt;typename T\u0026gt; void __quickSort3(T *arr,int l,int r) { if(r - l\u0026lt;= 15){ insertSort(arr,l,r); return; } swap(arr[l],arr[rand() % (r-l+1) + l]); T v = arr[l]; int lt = l; //arr[l+1...lt] \u0026lt; v  int gt = r + 1; //arr[gt...r] \u0026gt; v  int i = l+1; //arr[lt+1...i] == v  while(i \u0026lt; gt){ if(arr[i] \u0026lt; v){ swap(arr[i++],arr[++lt]); }else if(arr[i] \u0026gt; v){ swap(arr[i],arr[--gt]); }else{ i++; } } swap(arr[l],arr[lt]); __quickSort3(arr,l,lt-1); __quickSort3(arr,gt,r); } //å¿«é€Ÿæ’åºç‰ˆæœ¬ä¸‰ï¼Œä¸‰è·¯å¿«æ’ template\u0026lt;typename T\u0026gt; void quickSort3(T *arr,int size) { srand(time(NULL)); __quickSort3(arr,0,size-1); }   å †æ’åº åŸºæ•°æ’åº æ¡¶æ’åº æ’åºç®—æ³•æ€»ç»“ å›¾ç‰‡ï¼š\næœªå®Œå¾…ç»­\u0026hellip;\u0026hellip;ğŸ›´\nå‚è€ƒï¼š\n https://www.cnblogs.com/onepixel/p/7674659.html https://github.com/MisterBooo/Article ","description":"","id":103,"section":"posts","tags":["ç®—æ³•","æ’åº","C++"],"title":"æ’åºç®—æ³•æ€»ç»“","uri":"https://hugo.jiahongw.com/zh/posts/algorithmstructure/sort/"},{"content":"æœºå™¨å­¦ä¹ æœ‰è¿™äº›åŸºæœ¬çš„ç®—æ³•ç»„æˆï¼Œè¦é—¨æœºå™¨å­¦ä¹ ï¼Œå°±éœ€è¦æ‰“ä¸ªåœ°åŸºâœ’\nKè¿‘é‚»ç®—æ³•-KNN-(k-Nearest-Neighbors) å¯ä»¥è§£å†³çš„é—®é¢˜:\n åˆ†ç±»é—®é¢˜ å›å½’é—®é¢˜  é¢„æµ‹ä¸€ä¸ªäººæ˜¯å¤©æ‰è¿˜æ˜¯ç™½ç—´ é¦–å…ˆå…ˆç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®ï¼Œ,x1å’Œx2åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªç‰¹å¾\nIQå€¼ä½çš„æ•°æ®\n1 2 3  x1_low = np.random.random(10) + 3 x2_low = np.random.random(10) + 6 x1_low,y2_low   (array([3.72183336, 3.16146551, 3.88914234, 3.85673496, 3.1573191 , 3.4293751 , 3.96033808, 3.78793864, 3.94939642, 3.57378294]), array([6.47227974, 6.49537929, 6.98666118, 6.79440424, 6.99201224, 6.73386195, 6.63275792, 6.65411763, 6.42891099, 6.49695701])) IQå€¼é«˜çš„æ•°æ®\n1 2 3  x1_high = 4 + np.random.random(8) x2_high = 7 + np.random.random(8) x1_high,x2_high   (array([4.39543051, 4.73302502, 4.02667743, 4.46232039, 4.68128181, 4.92115752, 4.45267816, 4.84647668]), array([7.40538131, 7.3356809 , 7.90412483, 7.45237382, 7.15550294, 7.3764611 , 7.52492352, 7.67692014])) æ€»çš„æ•°æ®å’Œæ ‡ç­¾\n1 2 3 4 5 6  x1 = np.append(x1_low,x1_high) x2 = np.append(x2_low,x2_high) x_train = np.c_[x1.T,x2.T] print(x_train) y_train = np.append(np.zeros_like(x_low),np.ones_like(x_high)) print(y_train)   [[3.72183336 6.47227974] [3.16146551 6.49537929] [3.88914234 6.98666118] [3.85673496 6.79440424] [3.1573191 6.99201224] [3.4293751 6.73386195] [3.96033808 6.63275792] [3.78793864 6.65411763] [3.94939642 6.42891099] [3.57378294 6.49695701] [4.28739637 7.71057536] [4.31513454 7.70173516] [4.10934692 7.38111019] [4.35094666 7.33731866] [4.01739934 7.41472044] [4.98558165 7.72054925] [4.80075428 7.12604512] [4.48912715 7.08753069]] [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1.] ç»˜åˆ¶æ•£ç‚¹å›¾\n1 2 3 4 5  plt.scatter(x_train[y_train==0,0],x_train[y_train==0,1]) plt.scatter(x_train[y_train==1,0],x_train[y_train==1,1]) plt.xlabel(\u0026#39;t\u0026#39;) plt.ylabel(\u0026#39;IQ\u0026#39;) plt.show()    ä¸Šå›¾çº¢è‰²è¡¨ç¤ºå¤©æ‰ï¼Œè“è‰²è¡¨ç¤ºç™½ç—´\n å‡è®¾è¾“å…¥ä¸€ä¸ªæ ·æœ¬çš„æ•°æ®ä¸º (4.36,7.465)ï¼Œåˆ¤æ–­å®ƒå¤©æ‰è¿˜æ˜¯ç™½ç—´\n1 2 3 4 5 6 7 8  example = np.array([4.36,7.456]) # é¦–å…ˆå†å›¾ä¸Šç”»å‡ºæ¥è§‚å¯Ÿ plt.scatter(x_train[y_train==0,0],x_train[y_train==0,1]) plt.scatter(x_train[y_train==1,0],x_train[y_train==1,1]) plt.scatter(example[0],example[1],color=\u0026#39;black\u0026#39;) plt.xlabel(\u0026#39;t\u0026#39;) plt.ylabel(\u0026#39;IQ\u0026#39;) plt.show()    é»‘ç‚¹è¡¨ç¤ºè¾“å…¥çš„æ ·æœ¬\n è·å–è·ç¦»åˆ—è¡¨\n1 2  distance = [sqrt(sum(((x-example)**2))) for x in x_train] distance   [1.172587826601725, 1.5359938425092403, 0.6648201732802982, 0.8312548678718089, 1.2890795094301544, 1.177941448784469, 0.9151268590623418, 0.9850226059672444, 1.1061225623709607, 1.2401212526176475, 0.2647260841097585, 0.24979727210937175, 0.26160170347749107, 0.1190261413334191, 0.3450785650776031, 0.6792191910080055, 0.5505765678982287, 0.39044007348145965] å¯¹äºKNNï¼Œå‡è®¾k=3ï¼Œå°±æ˜¯æ±‚å‡ºä¸æ ·æœ¬æœ€è¿‘çš„ä¸‰ä¸ªç‚¹çš„æ•°æ®\n1 2  result = np.argsort(distance) result[:k]   array([13, 11, 12], dtype=int64)  å¯ä»¥å¾—çŸ¥ï¼Œå‰ä¸‰ä¸ªçš„è®­ç»ƒæ ·æœ¬çš„ç‚¹çš„ä¸‹æ ‡åˆ†åˆ«å›´æ®´13ï¼Œ11ï¼Œ12\n æ¥ä¸‹æ¥æ ¹æ®è¿™ä¸‰ä¸ªè®­ç»ƒæ ·æœ¬çš„ç±»åˆ«æ¥é¢„æµ‹è¾“å…¥çš„æ ·æœ¬æ˜¯å¤©æ‰è¿˜æ˜¯ç™½ç—´ï¼Œå‡å¦‚è¿™ä¸‰ä¸ªè®­ç»ƒæ ·æœ¬æ˜¯å¤©æ‰çš„æ•°é‡å¤šäºç™½ç—´ï¼Œå°±è®¤ä¸ºå®ƒæ˜¯å¤©æ‰ï¼›ä¸ç„¶ï¼Œå°±è®¤ä¸ºå®ƒæ˜¯ç™½ç—´\n1 2 3 4 5 6 7  from collections import Counter votes = Counter(r) y_hat = votes.most_common(1)[0][0] if y_hat == 1: print(\u0026#34;é¢„æµ‹å®ƒä¸ºå¤©æ‰\u0026#34;) else: print(\u0026#34;é¢„æµ‹å®ƒä¸ºç™½ç—´\u0026#34;)   é¢„æµ‹å®ƒä¸ºå¤©æ‰ ä¸»æˆåˆ†åˆ†ææ³•-PCA-(Principal Component Analysis)  PACä¸»è¦ç”¨äºæ•°æ®çš„é™ç»´\n äºŒç»´é™åˆ°ä¸€ç»´\n ç”±ä¸Šé¢ä¸¤ä¸ªé™ç»´çš„å›¾æ¥çœ‹ï¼Œç¬¬äºŒå¼ å›¾ç‰‡æ˜¯ä¸€ä¸ªæ›´å¥½çš„å›¾ï¼Œå› ä¸ºå›¾äºŒç‚¹å’Œç‚¹çš„è·ç¦»ç›¸å¯¹æ¯”è¾ƒå¤§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç‚¹ä¹‹é—´çš„åŒºåˆ†åº¦æ¯”è¾ƒé«˜\n æ›´å¥½çš„é™ç»´æ–¹æ¡ˆ\n æ­¤æ—¶ç‚¹å’Œç‚¹ä¹‹é—´çš„è·ç¦»æœ€å¤§ï¼ŒåŒºåˆ†åº¦æ›´å¤§\n é‚£ä¹ˆå¦‚ä½•å®šä¹‰æ ·æœ¬ä¹‹é—´çš„é—´è·å‘¢ï¼Ÿ\nå¯ä»¥ä½¿ç”¨æ–¹å·®(Variance),æ–¹å·®å¯ä»¥è¡¨ç¤ºæ ·æœ¬æ•´ä½“åˆ†å¸ƒçš„ç–å¯†ç¨‹åº¦\n$$\nVar(x) = \\frac{1}{m}\\sum_{i = 1}^{m}(x_{i} - \\bar x)^2\n$$\nå¯ä»¥è½¬åŒ–æˆï¼š\nâ€‹\tå¸Œæœ›æ‰¾åˆ°ä¸€æ¡è½´ï¼Œä½¿å¾—æ ·æœ¬æŠ•å½±åˆ°è¯¥è½´ä¸Šçš„å„ç‚¹ä¹‹é—´çš„æ–¹å·®æœ€å¤§\nPCAæ“ä½œæ­¥éª¤ï¼š\n  å°†æ ·ä¾‹çš„å‡å€¼å½’ä¸º0(demean)\nè¿™æ ·ï¼Œå°±ç›¸å½“äºåæ ‡è½´å˜æˆå¦‚ä¸‹çš„å›¾ï¼š\n  å½“å‡å€¼$\\bar x = 0$æ—¶ï¼ŒåŸæ¥çš„æ–¹å·®å…¬å¼å˜ä¸º\n$$\nVar(x) = \\frac{1}{m}\\sum_{i = 1}^{m}(x_{i} - \\bar x)^2 \\Rightarrow Var(x) = \\frac{1}{m}\\sum_{i = 1}^{m}x_{i}^2\n$$\nå‡è®¾ä¸¤ä¸ªç»´åº¦çš„ç‰¹å¾ä¸º$w1$,$w2$,é‚£ä¹ˆéœ€è¦æ±‚å¾—çš„ç›´çº¿çš„æ–¹å‘ä¸º$w =ï¼ˆw_{1},w_{2}ï¼‰$,æ˜ å°„åˆ°$w$åï¼Œæœ‰:\n$$\nVar(X_{project}) = \\frac{1}{m} \\sum_{1}^{m} (X_{project}^{(i)} - \\bar X{project})^2\n$$\nä½¿å¾—ä¸Šé¢çš„å…¬å¼æœ€å¤§\nå…¶å®æœ€åçš„ç»“æœè¿˜æ˜¯å‘é‡ï¼Œå› ä¸º$X$æ¯ä¸€ä¸ªç‚¹éƒ½åŒ…å«ä¸¤ä¸ªå…ƒç´ ï¼Œå³åº”è¯¥æ˜¯\nç”±å‡å€¼ä¸º0ï¼Œå¾—åˆ°\n  è®¡ç®—è¿‡ç¨‹\nç›®æ ‡å³ï¼š\nä¸çº¿æ€§å›å½’çš„ä¸åŒï¼š\n PCAçš„ä¸¤ä¸ªåæ ‡è½´è¡¨ç¤ºçš„æ˜¯ä¸¤ä¸ªç‰¹å¾ï¼Œè€Œçº¿æ€§å›å½’çš„æ¨ªè½´æ˜¯ç‰¹å¾ï¼Œçºµè½´æ˜¯è¾“å‡ºæ ‡è®° PCAä½¿å¾—ç‚¹ä¹‹é—´çš„æ–¹å·®æœ€å¤§ï¼Œè€Œçº¿æ€§å›å½’åˆ™æ˜¯éœ€è¦ä½¿å¾—è¾“å‡ºæ ‡è®°å°½é‡æ‹Ÿåˆä¸€æ¡ç›´çº¿ï¼Œæ˜¯åœ¨çºµè½´ä¸Šçš„  å†³ç­–æ ‘ ä¾‹å­ï¼š\næ•°å€¼ç‰¹å¾ä¾‹å­ï¼š\nç‰¹ç‚¹ï¼š\n éå‚æ•°å­¦ä¹ ç®—æ³• å¯ä»¥è§£å†³åˆ†ç±»é—®é¢˜ å¤©ç„¶çš„è§£å†³å¤šåˆ†ç±»é—®é¢˜ ä¹Ÿå¯ä»¥è§£å†³å›å½’é—®é¢˜ éå¸¸å¥½çš„å¯è§£é‡Šæ€§  é—®é¢˜ï¼š\n æ¯ä¸ªèŠ‚ç‚¹åœ¨å“ªä¸ªç»´åº¦ä½œåˆ’åˆ† æŸä¸ªç»´åº¦çš„å“ªä¸ªå€¼ä½œåˆ’åˆ†    æ”¯æŒå‘é‡æœº-SVM-(Support Vector Machine) ä¸»è¦æ€æƒ³ï¼š\nSVMåˆ†ç±»:\n  Hard Margin SVM\tè§£å†³çš„æ˜¯çº¿æ€§å¯åˆ†é—®é¢˜\n  Soft Margin SVM å¯è§£å†³çº¿æ€§ä¸å¯åˆ†é—®é¢˜\n  ğŸ¤ æœªå®Œå¾…ç»­\u0026hellip;\u0026hellip;\n","description":"æœºå™¨å­¦ä¹ å¿…é¡»æŒæ¡çš„åŸºç¡€ç®—æ³•ï¼Œå­¦ä¼šè¿™äº›åŸºç¡€ï¼Œå¯¹åé¢çš„ç†è§£æ‰ä¼šé€å½»","id":104,"section":"posts","tags":["æœºå™¨å­¦ä¹ ","SVM","å†³ç­–æ ‘","kNN","PCA"],"title":"æœºå™¨å­¦ä¹ åŸºæœ¬ç®—æ³•","uri":"https://hugo.jiahongw.com/zh/posts/deeplearning/machine-learning-base/"},{"content":"ä¸€äº›è‹±é›„çš„å›¾æ¡ˆğŸŒ¿\n","description":"","id":105,"section":"gallery","tags":[""],"title":"Hero","uri":"https://hugo.jiahongw.com/zh/gallery/hero/"},{"content":"ä½¿ç”¨Scrapyçˆ¬å–æ–‡ç« çš„ä¸€ä¸ªå°é¡¹ç›®..\nScrapy æ¡†æ¶å›¾ï¼š\næŠ“å–å°ç¨‹åºç¤¾åŒºæ–‡ç«  åˆ›å»ºçˆ¬è™«é¡¹ç›® åˆ›å»ºé¡¹ç›®ï¼ˆé¡¹ç›®åä¸ºMyTestï¼‰\n1  scrapy startproject MyTest   åˆ›å»ºçˆ¬è™«ğŸ(å…ˆè¿›å…¥åˆ°MyTestç›®å½•)\n1  scrapy genspider -t crawl wx wxapp-union.com    wxä¸ºçˆ¬è™«çš„åå­—ï¼Œwxapp-union.comä¸ºçˆ¬å–çš„åŸŸåï¼Œä½¿ç”¨äº†æ¨¡æ¿crawl\n å®šä¹‰çˆ¬å–çš„æ•°æ®ç»“æ„ çˆ¬å–çš„æ•°æ®ç»“æ„ç±»ç»§æ‰¿Itemç±»ï¼Œåœ¨items.pyæ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹æ˜¯è®¾ç½®éœ€è¦çˆ¬å–çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­åŒ…æ‹¬:æ ‡é¢˜ã€ä½œè€…ã€æ—¶é—´ã€è®¿é—®è€…ã€å‰è¨€ã€æ­£æ–‡ã€‚\n1 2 3 4 5 6 7 8 9 10  from scrapy import Item,Field # å®šä¹‰æ–‡ç« æ•°æ®ç»“æ„ class ArticleItem(Item): title = Field() author = Field() _time = Field() visitors = Field() pre_talk = Field() article_content = Field()   ç¼–å†™çˆ¬è™«è§„åˆ™ä¸è§£æè§„åˆ™  çˆ¬è™«çš„çˆ¬å–ç½‘é¡µçš„é“¾æ¥çš„è§„åˆ™å’Œè§£æé¡µé¢çš„è§„åˆ™éƒ½æ˜¯åœ¨æ–°å»ºçš„spideræ–‡ä»¶ä¸­çš„ç±»ä¸­ï¼Œä¹Ÿå³åœ¨wx.pyä¸­\n ç¼–å†™çš„spiderç±»å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  import scrapy from scrapy.linkextractors import LinkExtractor from scrapy.spiders import CrawlSpider, Rule from MyTest.items import ArticleItem class WxSpider(CrawlSpider): name = \u0026#39;wx\u0026#39; allowed_domains = [\u0026#39;wxapp-union.com\u0026#39;] start_urls = [\u0026#39;http://www.wxapp-union.com/portal.php?mod=list\u0026amp;catid=2\u0026amp;page=255\u0026#39;] rules = ( Rule(LinkExtractor(allow=r\u0026#39;.+mod=list\u0026amp;catid=2\u0026amp;page=\\d\u0026#39;), follow=True), Rule(LinkExtractor(allow=r\u0026#39;.+article-.+\\.html\u0026#39;),callback=\u0026#34;parse_item\u0026#34;,follow=False) ) def parse_item(self, response): title = response.xpath(\u0026#39;//h1[@class=\u0026#34;ph\u0026#34;]/text()\u0026#39;).get() author = response.xpath(\u0026#39;//p[@class=\u0026#34;authors\u0026#34;]//a\u0026#39;).get() _time = response.xpath(\u0026#39;//span[@class=\u0026#34;time\u0026#34;]/text()\u0026#39;).get() visitors = response.xpath(\u0026#39;//div[contains(@class,\u0026#34;focus_num\u0026#34;)]//a/text()\u0026#39;).get() pre_talk = response.xpath(\u0026#39;//div[@class=\u0026#34;blockquote\u0026#34;]//p/text()\u0026#39;).get() article_content = response.xpath(\u0026#39;//td[@id=\u0026#34;article_content\u0026#34;]\u0026#39;).get() item = ArticleItem(title=title,author=author,_time=_time,visitors=visitors,pre_talk=pre_talk,article_content=article_content) print(\u0026#39;*\u0026#39;*40) print(title) print(\u0026#39;*\u0026#39;*40) return item    é¦–å…ˆruleså®šä¹‰äº†çˆ¬å–é“¾æ¥è§„åˆ™ï¼Œæœ‰ä¸¤ä¸ªè§„åˆ™ï¼Œç¬¬ä¸€ä¸ªè§„åˆ™æ˜¯çˆ¬å–é¡µé¢çš„é“¾æ¥ï¼Œæ¯ä¸€é¡µæœ‰å¤šä¸ªæ–‡ç« çš„é“¾æ¥ï¼Œè€Œç¬¬äºŒä¸ªè§„åˆ™åˆ™æ˜¯å®šä¹‰çˆ¬å–çš„å…·ä½“æ–‡ç« å†…å®¹çš„é“¾æ¥ã€‚ ç¬¬ä¸€ä¸ªè§„åˆ™éœ€è¦Followï¼Œå› ä¸ºéœ€è¦æ ¹æ®æ¯ä¸€é¡µçš„å†…å®¹æŸ¥æ‰¾æ–‡ç« çš„é“¾æ¥ï¼›è€Œç¬¬äºŒä¸ªè§„åˆ™æ˜¯æ–‡ç« é“¾æ¥ï¼Œæ•…ä¸éœ€è¦ç»§ç»­Follow ç¬¬ä¸€ä¸ªé¡µé¢é“¾æ¥è§„åˆ™ä¸éœ€è¦å›è°ƒå‡½æ•°ï¼Œå› ä¸ºä¸éœ€è¦è§£æï¼Œåªéœ€è¦è·å–æ–‡ç« é“¾æ¥ï¼›ç¬¬äºŒä¸ªæ–‡ç« é“¾æ¥è§„åˆ™åˆ™éœ€è¦è®¾ç½®å›è°ƒå‡½æ•°æ¥å¯¹è¿”å›çš„æ–‡ç« ç½‘é¡µå†…å®¹è¿›è¡Œè§£æã€‚  parse_itemè¯´æ˜ï¼š\n parse_itemæ˜¯è§£æé¡µé¢è¿”å›å†…å®¹çš„å‡½æ•°ï¼Œå…¶è¿”å›Itemæ•°æ®ç»“æ„ï¼Œä½¿ç”¨Xpathåˆ†åˆ«è·å–æ•°æ®ç»“æ„å„ä¸ªå…ƒç´ çš„å†…å®¹å¹¶ä¸”è¿”å›Item\n ä¿å­˜æ•°æ®  pipelinesæ˜¯ä¸€ä¸ªæœ€åå¤„ç†Itemçš„ç®¡é“\n åœ¨pipelines.pyæ–‡ä»¶ä¸­æ–°å»ºpiplelineå¯¹è¿”å›çš„Itemè¿›è¡Œå¤„ç†ï¼Œå¯ä»¥ä¿å­˜ä¸ºæ–‡ä»¶ï¼Œæˆ–è€…å­˜å‚¨åˆ°æ•°æ®åº“ã€‚\né¦–å…ˆæ–‡ä»¶ä¸­éœ€è¦å¯¼å…¥å¿…è¦çš„åº“â€˜\n1 2 3 4 5  import re\t# æ­£åˆ™å¤„ç† from html2text import HTML2Text\t# å°†ç½‘é¡µè½¬åŒ–ä¸ºMarkdownæ ¼å¼ from scrapy.exporters import JsonLinesItemExporter\t# è¾“å‡ºJsonæ–‡ä»¶è¾“å‡ºå™¨ from urllib.parse import urljoin\t# è¡¥å…¨URLï¼Œå› ä¸ºæœ‰äº›URLåªæ˜¾ç¤ºç›¸å¯¹ä½ç½® import pymongo\t# MongoDBæ“ä½œåº“   ç¬¬ä¸€ä¸ªPipelineï¼šä¿å­˜åˆ°Jsonæ–‡ä»¶ ç¨‹åºçš„æ„é€ å‡½æ•°æ–°å»ºä¸€ä¸ªJsonæ–‡ä»¶è¾“å‡ºå™¨ï¼Œprocess_itemè¿›è¡Œæ•°æ®çš„å­˜å‚¨ï¼Œå…³é—­çš„æ—¶å€™close_spiderä¼šè°ƒç”¨å…³é—­æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  # å­˜å‚¨åˆ°Jsonæ–‡ä»¶ä¸­ class JsonPipeline(object): def __init__(self): self.f = open(\u0026#39;wxjc.json\u0026#39;,\u0026#39;wb\u0026#39;) self.exporter = JsonLinesItemExporter(self.f, ensure_ascii=False,encoding=\u0026#34;utf-8\u0026#34;) def process_item(self, item, spider): # å°†å†…å®¹è½¬åŒ–ä¸ºMarkDownæ ¼å¼ item[\u0026#39;article_content\u0026#39;] = convert_md(item[\u0026#39;article_content\u0026#39;]) self.exporter.export_item(item) return item def close_spider(self,spider): self.f.close()   ç¬¬äºŒä¸ªPipelineï¼šä¿å­˜åˆ°Markdownæ–‡ä»¶ æ–¹æ³•ä¸ç¬¬ä¸€å‘Pipelineç±»ä¼¼ï¼Œåªæ˜¯å†™æ–‡ä»¶ä½¿ç”¨æœ€ç®€å•çš„è¿½åŠ æ–¹å¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  # å†™å…¥Markdown class MDPipeline(object): def __init__(self): self.f = open(\u0026#39;wx_teaches.md\u0026#39;,\u0026#39;a\u0026#39;,encoding=\u0026#39;utf-8\u0026#39;) def process_item(self,item,spider): if self.f: self.f.write(\u0026#39;\\n\u0026#39;) self.f.write(\u0026#34;# \u0026#34; + item[\u0026#39;title\u0026#39;] + \u0026#39;\\n\u0026#39;) header_info = \u0026#34;ä½œè€…:{} å‘å¸ƒæ—¶é—´:{} Visitors:{}\\n\u0026#34;.format(item[\u0026#39;author\u0026#39;],item[\u0026#39;_time\u0026#39;],item[\u0026#39;visitors\u0026#39;]) self.f.write(header_info) self.f.write(\u0026#39;\u0026gt; \u0026#39; + item[\u0026#39;pre_talk\u0026#39;] + \u0026#39;\\n\u0026#39;) self.f.write(item[\u0026#39;article_content\u0026#39;]) return item def close_spider(self,spider): self.f.close()   ç¬¬ä¸‰ä¸ªPilelineï¼šä¿å­˜åˆ°MongoDB å…¶ä¸­ä½¿ç”¨äº†ç±»æ–¹æ³•è£…é¥°å™¨@classmethod,æ„æ€å°±æ˜¯ç›´æ¥ç”¨ç±»åè°ƒç”¨è¯¥å‡½æ•°ï¼Œå°±èƒ½å¤Ÿç›´æ¥è¿”å›ä¸€ä¸ªMongoPipelineç±»äº†ï¼Œè¿˜å®šä¹‰äº†æ‰“å¼€spiderä¸å…³é—­spiderçš„æ“ä½œï¼Œå°±æ˜¯è¿æ¥æ•°æ®åº“ä¸å…³é—­æ•°æ®åº“\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  # å­˜å‚¨åˆ°MongoDBæ•°æ®åº“ class MongoPipeline(object): def __init__(self,mongo_uri,mongo_db): self.mongo_uri = mongo_uri self.mongo_db = mongo_db @classmethod def from_crawler(cls,crawler): return cls(mongo_uri = crawler.settings.get(\u0026#39;MONGO_URI\u0026#39;), mongo_db = crawler.settings.get(\u0026#39;MONGO_DB\u0026#39;)) def open_spider(self,spider): self.client = pymongo.MongoClient(self.mongo_uri) self.db =self.client[self.mongo_db] def process_item(self,item,spider): name = item.__class__.__name__ # \u0026lt;a href=\\\u0026#34;space-uid-17761.html\\\u0026#34;\u0026gt;Rolan\u0026lt;/a\u0026gt;  item[\u0026#39;author\u0026#39;] = re.search(\u0026#39;\u0026lt;a.*?\u0026gt;(.*?)\u0026lt;/a\u0026gt;\u0026#39;,item[\u0026#39;author\u0026#39;]).group(1) self.db[name].insert(dict(item)) return item def close_spider(self,spider): self.client.close()    æœ€åéœ€è¦åœ¨settings.pyä¸­æ·»åŠ å¦‚ä¸‹å­—æ®µ:\n1 2  MONGO_URI = \u0026#39;localhost\u0026#39; MONGO_DB = \u0026#39;WX\u0026#39;    æœ€åéœ€è¦åœ¨settings.pyä¸­æ·»åŠ å¦‚ä¸‹å­—æ®µ 1 2 3 4 5 6 7 8 9  ITEM_PIPELINES = { \u0026#39;MyTest.pipelines.JsonPipeline\u0026#39;: 300, \u0026#39;MyTest.pipelines.MDPipeline\u0026#39;: 301, \u0026#39;MyTest.pipelines.MongoPipeline\u0026#39;: 400, } # ä¿®æ”¹ä¸ºFalse ROBOTSTXT_OBEY = False # è®¾ç½®å»¶è¿Ÿ1s DOWNLOAD_DELAY = 1   å¼€å§‹çˆ¬å– å¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸­æ–°å»ºä¸€ä¸ªè„šæœ¬start.pyï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œè‡ªåŠ¨è¿è¡Œè„šæœ¬\n1 2  from scrapy import cmdline cmdline.execute(\u0026#39;scrapy crawl test\u0026#39;.split(\u0026#39;\u0026#39;))   çˆ¬å–ç»“æœ Jsonç»“æœ Markdownç»“æœ Markdownæ–‡ä»¶ç”±äºå¤ªå¤§äº†ä½¿ç”¨Markdownæ–‡ä»¶æ‰“ä¸å¼€ï¼Œåªå¥½ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€\nMongoDBç»“æœ ","description":"","id":106,"section":"posts","tags":["çˆ¬è™«","Scrapy"],"title":"Scrapyæ¡†æ¶","uri":"https://hugo.jiahongw.com/zh/posts/spider/scrapy-1/"},{"content":"å¥½çš„å·¥å…·ğŸ— å°±æˆåŠŸäº†ä¸€åŠã€‚\nå·¥å…·ğŸš¡ åˆ›é€ ä¸è®°å½• GitBook ä½¿ç”¨å‰æï¼š  å®‰è£…NodeJS ä½¿ç”¨npmå®‰è£…ï¼šnpm install gitbook-cli -g(è¿™æ˜¯å‘½ä»¤è¡Œå·¥å…·)  GitNote Notion Typora ä¿¡æ¯èšåˆ irreaderğŸ”– ä¸‹è½½åœ°å€:http://irreader.fatecore.com/\nç¾½é›€-äº‘ç«¯çŸ¥è¯†åº“â˜ å¦‚æœè‹±è¯­ä¸å¥½ï¼Œæˆ–è€…çœ‹ç€è‹±æ–‡çš„æ–‡æ¡£å¾ˆçƒ¦æ¼ï¼Œå¯ä»¥è¯•è¯•è¿™ä¸ªã€‚ğŸƒ\nåœ°å€:https://www.yuque.com/\nä¸‹è½½å¾®ä¿¡å…¬ä¼—å·æ–‡ç«   é“¾æ¥ï¼šhttps://pan.baidu.com/s/1v2LAAZUn94azCtG_gllncw\næå–ç ï¼š6cl3\nå¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦\n ä»Šæ—¥çƒ­æ¦œ https://tophub.today/\nåœ¨çº¿CreateğŸ¨ GitMind GitMind æ˜¯ä¸€æ¬¾å…¨æ–°çš„äº‘ç«¯æ™ºèƒ½æ€ç»´å¯¼å›¾ã€æµç¨‹å›¾åˆ¶ä½œè½¯ä»¶ï¼ŒåŒæ—¶æ”¯æŒåœ¨ç”µè„‘ã€æ‰‹æœºæµè§ˆå™¨ä¸Šä½¿ç”¨ã€‚\nå®˜ç½‘ï¼šhttps://gitmind.cn/\nå¾®ä¿¡ç‰ˆæœ¬ï¼š\nProcessOnğŸ¤´ https://www.processon.com/\næ•°å­—ç»˜ https://www.myshuju.net/\ncarbon(ä»£ç ç¾åŒ–)ğŸ”° https://carbon.now.sh/\nå›¾ç‰‡   https://xinquji.com/r/d232a93deb8766\n  https://burst.shopify.com/\n  https://wallhaven.cc/\n  https://wallpapershome.com/\n  Emoji\n ","description":"å®ç”¨çš„å·¥å…·é›†åˆ","id":107,"section":"talks","tags":[""],"title":"Tools","uri":"https://hugo.jiahongw.com/zh/talks/tools/"},{"content":"All about Intresting in Github.\nPythonå¥½ç©çš„åº“ html2text  å°†ç½‘é¡µè½¬åŒ–ä¸ºMarkdownæ–‡ä»¶æ ¼å¼\n ä½¿ç”¨å‰æï¼š 1  pip install htmltotext   ä½¿ç”¨æ–¹æ³•ï¼š 1 2 3  ## è½¬åŒ–ä¸ºTEXT h = HTML2Text() text = h.handle(parse_html) # textä¸ºmarkdownæ–‡ä»¶   pypandoc  å¯¹æ–‡ä»¶è¿›è¡Œä»»æ„çš„è½¬æ¢\n ä½¿ç”¨å‰æï¼š å®‰è£…pypandocåº“ï¼špip install pypandoc.\nä½¿ç”¨æ–¹æ³• å¯¼å…¥åº“:import pypandoc\nMarkdown \u0026mdash;\u0026ndash;\u0026gt; docx 1  output = pypandoc.convert_file(\u0026#39;somefile.md\u0026#39;, \u0026#39;docx\u0026#39;, outputfile=\u0026#34;somefile.docx\u0026#34;)   Markdown \u0026mdash;\u0026ndash;\u0026gt; Rst 1 2 3  output = pypandoc.convert_file(\u0026#39;somefile.md\u0026#39;, \u0026#39;rst\u0026#39;)\t# way1 output = pypandoc.convert_file(\u0026#39;somefile.txt\u0026#39;, \u0026#39;rst\u0026#39;, format=\u0026#39;md\u0026#39;)\t# way 2 output = pypandoc.convert_text(\u0026#39;#some title\u0026#39;, \u0026#39;rst\u0026#39;, format=\u0026#39;md\u0026#39;)\t# ç›´æ¥è½¬åŒ–æ–‡æœ¬    å…¶ä¸­æœ‰å¯¹åº”çš„å·¥å…·Pandoc\n å¦‚ä½•æŠŠ Markdown æ–‡ä»¶æ‰¹é‡è½¬æ¢ä¸º PDF mdoutè½¬æ¢è„šæœ¬ é¡¹ç›®åœ°å€:https://github.com/JabinGP/mdout\nä½¿ç”¨æ–¹æ³•ï¼š  æ‰“å¼€é¡¹ç›®åœ°å€æŸ¥çœ‹ï¼Œå…¶ä¸­ä¸»è¦å‘½ä»¤ä¸º:mdout filename -t pdf\n","description":"Githubä¸Šå¥½ç©çš„é‚£äº›åº“~","id":108,"section":"talks","tags":[""],"title":"Goodåº“","uri":"https://hugo.jiahongw.com/zh/talks/github-lib/"},{"content":"ğŸš´ä¸€äº›æ”¶é›†è§†é¢‘çš„æ–¹æ³•âš’\nè§†é¢‘å½’æ€»æ–¹æ³• BiliBliè§†é¢‘åµŒå…¥ä»£ç  ä½¿ç”¨æ–¹æ³• é¦–å…ˆæ‰¾åˆ°åµŒå…¥ä»£ç \nç„¶åå¤åˆ¶ä»£ç åˆ°Markdownæ–‡ä»¶å°±å¯ä»¥å¾—åˆ°å¦‚ä¸‹æ˜¾ç¤ºæ•ˆæœï¼š\n ä»£ç å¦‚ä¸‹: 1  \u0026lt;iframe src=\u0026#34;//player.bilibili.com/player.html?aid=6731067\u0026amp;cid=10959711\u0026amp;page=1\u0026#34; scrolling=\u0026#34;no\u0026#34; border=\u0026#34;0\u0026#34; frameborder=\u0026#34;no\u0026#34; framespacing=\u0026#34;0\u0026#34; allowfullscreen=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;/iframe\u0026gt;    å…¶ä¸­å¯ä»¥åœ¨iframä¸­æ·»åŠ ç›¸å…³å±æ€§\n weiboä¸Šä¼ çš„è§†é¢‘ ä½¿ç”¨æ–¹æ³• åœ¨å¾®åšä¸­ä¸Šä¼ è§†é¢‘åï¼Œæ‰“å¼€è§†é¢‘çš„é¡µé¢ï¼ŒæŒ‰F12æ‰“å¼€å·¥å…·,é¼ æ ‡ç‚¹å‡»è§†é¢‘æ‰¾åˆ°é“¾æ¥\næ¥ä¸‹æ¥ç›´æ¥åœ¨Markdownä¸­æ·»åŠ ä»£ç \nYour browser does not support the video tag.\nä»£ç å¦‚ä¸‹:\n1  \u0026lt;video poster=\u0026#34;https://i.loli.net/2020/03/02/GabXC4JmfN6H2hE.png\u0026#34; src=\u0026#34;https://f.video.weibocdn.com/00393mgEgx07BmNCEF4j01041200eeW00E010.mp4?label=mp4_720p\u0026amp;template=1280x720.25.0\u0026amp;trans_finger=721584770189073627c6ee9d880087b3\u0026amp;Expires=1583079687\u0026amp;ssig=%2BAmJANwAPn\u0026amp;KID=unistore,video\u0026#34; style=\u0026#34;max-height :100%; max-width: 100%; display: block; margin-left: auto; margin-right: auto;\u0026#34; controls=\u0026#34;controls\u0026#34; preload=\u0026#34;meta\u0026#34;\u0026gt;Your browser does not support the video tag.\u0026lt;/video\u0026gt;   QQç©ºé—´å‘å¸ƒçš„è§†é¢‘ ä½¿ç”¨æ–¹æ³• ä¸å¾®åšçš„æ“ä½œç±»ä¼¼ï¼Œæ‰“å¼€è§†é¢‘é¡µé¢ï¼Œå…ˆç‚¹å‡»ä¸‹è½½æŒ‰é’®\nç„¶åä¼šè‡ªåŠ¨è·³è½¬ï¼Œæœç´¢æ ä¸Šçš„åœ°å€å°±æ˜¯è§†é¢‘çš„åœ°å€\næ¥ä¸‹æ¥ç›´æ¥åœ¨Markdownä¸­æ·»åŠ ä»£ç \nYour browser does not support the video tag.\nä»£ç å¦‚ä¸‹:\n1  \u0026lt;video poster=\u0026#34;https://i.loli.net/2020/03/02/GabXC4JmfN6H2hE.png\u0026#34; src=\u0026#34;http://photovideo.photo.qq.com/1075_0b53zeiu6vidieapa3kya5pdbsiej6zqhfsa.f20.mp4?dis_k=97f710c26b204f7f2312614fbcf8f897\u0026amp;dis_t=1583082992\u0026amp;vuin=1427298682\u0026amp;save=1\u0026amp;d=1\u0026#34; style=\u0026#34;max-height :100%; max-width: 100%; display: block; margin-left: auto; margin-right: auto;\u0026#34; controls=\u0026#34;controls\u0026#34; preload=\u0026#34;meta\u0026#34;\u0026gt;Your browser does not support the video tag.\u0026lt;/video\u0026gt;   ","description":"","id":109,"section":"posts","tags":["blog","è§†é¢‘","BliBli","weibo"],"title":"è§†é¢‘çš„æ”¶é›†","uri":"https://hugo.jiahongw.com/zh/posts/settings/collect-videos/"},{"content":"åœ¨Pté¡µé¢å¢åŠ äº†ä¸€äº›ç”¨JSå®ç°çš„PPTï¼Œä¸»è¦å±•ç¤ºä¸€äº›æ•ˆæœã€‚ğŸ”Œ\nç½‘é¡µPPT ä¸»é¢˜ beige black blood monokai league moon night serif simple solarized sky white ä½¿ç”¨æ–¹æ³•ğŸŒŒ åœ¨markdownæ–‡ä»¶çš„ymalå¤´éƒ¨æ·»åŠ :revealTheme: serif\nåœ¨çº¿åˆ¶ä½œPPT Slides https://slides.com/\n","description":"","id":110,"section":"posts","tags":["ppt","blog"],"title":"Slideså’Œç½‘é¡µPPT","uri":"https://hugo.jiahongw.com/zh/posts/settings/ppt-use/"},{"content":"ä½¿ç”¨MXNetçš„å¥½å¤„ä½ æ°¸è¿œæƒ³è±¡ä¸åˆ°ã€‚ğŸ‰‘\næœ¬åœ°ç¯å¢ƒæ­å»ºæ•™ç¨‹  å‚è€ƒ:\nhttps://discuss.gluon.ai/t/topic/13576?u=bigbigwolf-ai\n èŒƒæ•° L0èŒƒæ•°ï¼šæŒ‡å‘é‡ä¸­é0å…ƒç´ çš„ä¸ªæ•°ã€‚ï¼ˆéš¾ä¼˜åŒ–æ±‚è§£ï¼‰\nL1èŒƒæ•°ï¼šæŒ‡å‘é‡ä¸­å„ä¸ªå…ƒç´ çš„ç»å¯¹å€¼ä¹‹å’Œ\nL2èŒƒæ•°ï¼šæŒ‡å‘é‡å„å…ƒç´ çš„å¹³æ–¹å’Œç„¶åæ±‚å¹³æ–¹æ ¹\nè®¾$n$ç»´å‘é‡$x$ä¸­çš„å…ƒç´ ä¸º$x_1, \\ldots, x_n$ã€‚å‘é‡$x$çš„$L_{p}$èŒƒæ•°ä¸º:\n$$\n|\\boldsymbol{x}|_p = \\left(\\sum_{i=1}^n \\left|x_i \\right|^p \\right)^{1/p}.\n$$\n$L_{1}$èŒƒæ•°ï¼š\n$$\n|\\boldsymbol{x}|_1 = \\sum_{i=1}^n \\left|x_i \\right|.\n$$\n$L_{2}$èŒƒæ•°ï¼š\n$$\n|\\boldsymbol{x}|_2 = \\sqrt{\\sum_{i=1}^n x_i^2}.\n$$\nè®¾$X$æ˜¯ä¸€ä¸ª$m$è¡Œ$n$åˆ—çŸ©é˜µã€‚çŸ©é˜µ$X$çš„FrobeniusèŒƒæ•°ä¸ºè¯¥çŸ©é˜µå…ƒç´ å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ï¼š\n$$\n|\\boldsymbol{X}|_F = \\sqrt{\\sum_{i=1}^m \\sum_{j=1}^n x_{ij}^2},\n$$\næŸ¥é˜…æ–‡æ¡£ 1 2  from mxnet import nd print(dir(nd.random))   ['NDArray', '_Null', '__all__', '__builtins__', '__cached__', '__doc__', '__file__', '__loader__', '__name__', '__package__', '__spec__', '_internal', '_random_helper', 'current_context', 'exponential', 'exponential_like', 'gamma', 'gamma_like', 'generalized_negative_binomial', 'generalized_negative_binomial_like', 'multinomial', 'negative_binomial', 'negative_binomial_like', 'normal', 'normal_like', 'numeric_types', 'poisson', 'poisson_like', 'randint', 'randn', 'shuffle', 'uniform', 'uniform_like']  helpå‡½æ•°å¯ä»¥æŸ¥è¯¢å…·ä½“çš„å‡½æ•°ä½œç”¨åŠç”¨æ³•\n1  help(nd.ones_like)   Help on function ones_like: ones_like(data=None, out=None, name=None, **kwargs) Return an array of ones with the same shape and type as the input array. Examples:: x = [[ 0., 0., 0.], [ 0., 0., 0.]] ones_like(x) = [[ 1., 1., 1.], [ 1, 1., 1.]] Parameters ---------- data : NDArray The input out : NDArray, optional The output NDArray to hold the result. Returns ------- out : NDArray or list of NDArrays The output of this function.  çº¿æ€§å›å½’ å¯¼å…¥å¿…è¦çš„åº“\n1 2 3 4 5  %matplotlib inline from IPython import display from matplotlib import pyplot as plt from mxnet import autograd, nd import random   ç”Ÿæˆæ•°æ®é›†ï¼Œå…¶ä¸­æ¯ä¸ªä¾‹å­è¾“å…¥æ•°æ®ä¸ªæ•°ä¸º2ï¼Œæœ‰1000ä¸ªæ•°æ®\n1 2 3 4 5 6 7  num_inputs = 2 num_examples = 1000 true_w = nd.array([2, -3.4]) true_b = nd.array([4.2]) features = nd.random.normal(scale=1, shape=(num_examples, num_inputs)) labels = nd.dot(true_w,features.T) + true_b labels += nd.random.normal(scale=0.01, shape=labels.shape)   æŸ¥çœ‹æ•°æ®\n1  features[0], labels[0]   ( [ 0.28752208 -0.04466231] \u0026lt;NDArray 2 @cpu(0)\u0026gt;, [4.927063] \u0026lt;NDArray 1 @cpu(0)\u0026gt;)  å®šä¹‰ç›¸å…³å‡½æ•°\n1 2 3 4 5 6 7 8 9 10 11  def use_svg_display(): # ç”¨çŸ¢é‡å›¾æ˜¾ç¤º display.set_matplotlib_formats(\u0026#39;svg\u0026#39;) def set_figsize(figsize=(3.5, 2.5)): use_svg_display() # è®¾ç½®å›¾çš„å°ºå¯¸ plt.rcParams[\u0026#39;figure.figsize\u0026#39;] = figsize set_figsize() plt.scatter(features[:, 1].asnumpy(), labels.asnumpy(), 1); # åŠ åˆ†å·åªæ˜¾ç¤ºå›¾   data_iterå‡½æ•°ä½œç”¨:\n æ‰°ä¹±è¯»å–é¡ºåºï¼Œä½¿å¾—è¯»å–éšæœº æŒ‰Batch_sizeåˆ†æ®µå–æ•°æ®ï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦åˆ°ç»“å°¾ï¼Œä½¿ç”¨yieldæ„å»ºç”Ÿæˆå™¨èŠ‚çœå†…å­˜  1 2 3 4 5 6 7 8  # æœ¬å‡½æ•°å·²ä¿å­˜åœ¨d2lzhåŒ…ä¸­æ–¹ä¾¿ä»¥åä½¿ç”¨ def data_iter(batch_size, features, labels): num_examples = len(features) indices = list(range(num_examples)) random.shuffle(indices) # æ ·æœ¬çš„è¯»å–é¡ºåºæ˜¯éšæœºçš„ for i in range(0, num_examples, batch_size): j = nd.array(indices[i: min(i + batch_size, num_examples)]) yield features.take(j), labels.take(j) # takeå‡½æ•°æ ¹æ®ç´¢å¼•è¿”å›å¯¹åº”å…ƒç´    1 2 3 4 5  batch_size = 10 for X, y in data_iter(batch_size, features, labels): print(X, y) break   [[-0.65439206 0.74410725] [ 0.69013244 -0.6483847 ] [-0.59409887 0.3589477 ] [-0.47491348 0.6438462 ] [ 0.5074032 0.42834154] [-0.18589513 -0.21707669] [ 0.70281196 -1.3320632 ] [ 1.2072632 1.6909351 ] [-0.17264698 -1.5742793 ] [-1.6516455 -0.29966688]] \u0026lt;NDArray 10x2 @cpu(0)\u0026gt; [ 0.37379816 7.7938933 1.7758217 1.0414512 3.743439 4.5605783 10.148926 0.84148276 9.19984 1.9295483 ] \u0026lt;NDArray 10 @cpu(0)\u0026gt;  åˆå§‹åŒ–\n1 2  w = nd.random.normal(scale=0.01, shape=(num_inputs, 1)) b = nd.zeros(shape=(1,))   æ·»åŠ ä¿å­˜æ¢¯åº¦çš„ç©ºé—´\n1 2  w.attach_grad() b.attach_grad()   1 2  def linreg(X, w, b): # æœ¬å‡½æ•°å·²ä¿å­˜åœ¨d2lzhåŒ…ä¸­æ–¹ä¾¿ä»¥åä½¿ç”¨ return nd.dot(X, w) + b   1 2  def squared_loss(y_hat, y): # æœ¬å‡½æ•°å·²ä¿å­˜åœ¨d2lzhåŒ…ä¸­æ–¹ä¾¿ä»¥åä½¿ç”¨ return (y_hat - y.reshape(y_hat.shape)) ** 2 / 2   1 2 3  def sgd(params, lr, batch_size): # æœ¬å‡½æ•°å·²ä¿å­˜åœ¨d2lzhåŒ…ä¸­æ–¹ä¾¿ä»¥åä½¿ç”¨ for param in params: param[:] = param - lr * param.grad / batch_size   å¼€å§‹è®­ç»ƒ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  lr = 0.03 num_epochs = 3 net = linreg loss = squared_loss for epoch in range(num_epochs): # è®­ç»ƒæ¨¡å‹ä¸€å…±éœ€è¦num_epochsä¸ªè¿­ä»£å‘¨æœŸ # åœ¨æ¯ä¸€ä¸ªè¿­ä»£å‘¨æœŸä¸­ï¼Œä¼šä½¿ç”¨è®­ç»ƒæ•°æ®é›†ä¸­æ‰€æœ‰æ ·æœ¬ä¸€æ¬¡ï¼ˆå‡è®¾æ ·æœ¬æ•°èƒ½å¤Ÿè¢«æ‰¹é‡å¤§å°æ•´é™¤ï¼‰ã€‚X # å’Œyåˆ†åˆ«æ˜¯å°æ‰¹é‡æ ·æœ¬çš„ç‰¹å¾å’Œæ ‡ç­¾ for X, y in data_iter(batch_size, features, labels): with autograd.record(): l = loss(net(X, w, b), y) # læ˜¯æœ‰å…³å°æ‰¹é‡Xå’Œyçš„æŸå¤± l.backward() # å°æ‰¹é‡çš„æŸå¤±å¯¹æ¨¡å‹å‚æ•°æ±‚æ¢¯åº¦ sgd([w, b], lr, batch_size) # ä½¿ç”¨å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™è¿­ä»£æ¨¡å‹å‚æ•° train_l = loss(net(features, w, b), labels) print(\u0026#39;epoch %d, loss %f\u0026#39; % (epoch + 1, train_l.mean().asnumpy()))   epoch 1, loss 0.040809 epoch 2, loss 0.000157 epoch 3, loss 0.000051  å¯¹æ¯”\n1  true_w, w   ( [ 2. -3.4] \u0026lt;NDArray 2 @cpu(0)\u0026gt;, [[ 1.9991481] [-3.3992586]] \u0026lt;NDArray 2x1 @cpu(0)\u0026gt;)  1  true_b, b   ( [4.2] \u0026lt;NDArray 1 @cpu(0)\u0026gt;, [4.19921] \u0026lt;NDArray 1 @cpu(0)\u0026gt;) ","description":"","id":113,"section":"posts","tags":["python","MXNet","æ·±åº¦å­¦ä¹ ","liner"],"title":"MXNetå›é¡¾","uri":"https://hugo.jiahongw.com/zh/posts/deeplearning/mxnet-begin/"},{"content":"é‡æ–°å­¦ä¹ ä¸€ä¸‹DLï¼Œè¿™æ¬¡ä½¿ç”¨PyTorchæ¡†æ¶ğŸ”¦\n å‚è€ƒèµ„æ–™ï¼š\nhttps://github.com/dsgiitr/d2l-pytorch\n å¯¼å…¥PyTorchåº“ 1 2  import torch import numpy as np   åˆ›å»ºTensor 5x3çš„æœªåˆå§‹åŒ–çš„å¼ é‡\n1 2  x = torch.empty(5,3) x   tensor([[1.0286e-38, 9.0919e-39, 8.9082e-39], [9.2755e-39, 8.4490e-39, 1.0194e-38], [9.0919e-39, 8.4490e-39, 8.7245e-39], [1.0102e-38, 1.0653e-38, 8.7245e-39], [1.0286e-38, 9.6429e-39, 4.2244e-39]])  5x3éšæœºåˆå§‹åŒ–çš„å¼ é‡\n1 2  x = torch.rand(5,3) x   tensor([[0.2518, 0.0419, 0.3233], [0.1493, 0.1408, 0.8559], [0.5145, 0.4648, 0.4605], [0.2555, 0.2502, 0.4506], [0.9798, 0.5056, 0.2726]])  5x3å…¨0çš„å¼ é‡\n1 2  x = torch.zeros(5,3) # å¯ä»¥æŒ‡å®šç±»å‹ x = torch.zeros(5,3,dtype=torch.long) x   tensor([[0., 0., 0.], [0., 0., 0.], [0., 0., 0.], [0., 0., 0.], [0., 0., 0.]])  æ•°æ®å¼ é‡\n1 2  x = torch.tensor([5.5,3]) x   tensor([5.5000, 3.0000])  é»˜è®¤åˆ›å»ºå’ŒåŸæ¥çš„å¼ é‡ä¸€æ ·çš„dtypeå’Œdeviceçš„å¼ é‡ï¼Œä¹Ÿå¯ä»¥å¦å¤–è®¾ç½®\n1 2 3 4  x = x.new_ones(5,3,dtype=torch.double) print(x) x = torch.randn_like(x,dtype=torch.float) print(x)   tensor([[1., 1., 1.], [1., 1., 1.], [1., 1., 1.], [1., 1., 1.], [1., 1., 1.]], dtype=torch.float64) tensor([[-0.7829, -0.4010, 0.3230], [ 0.2660, 0.4766, 0.3186], [ 0.6096, 1.1226, -1.7942], [ 1.3255, 0.1835, -0.9078], [ 1.7743, -0.0944, -0.1704]])  è·å–Tensorçš„å½¢çŠ¶\n1  x.shape,x.size()   (torch.Size([5, 3]), torch.Size([5, 3]))  å…¶ä»–åˆ›å»ºTensorçš„å‡½æ•°:\n   å‡½æ•° åŠŸèƒ½     Tensor(*sizes) åŸºç¡€æ„é€ å‡½æ•°   tensor(data,) ç±»ä¼¼np.arrayçš„æ„é€ å‡½æ•°   ones(*sizes) å…¨1Tensor   zeros(*sizes) å…¨0Tensor   eye(*sizes) å¯¹è§’çº¿ä¸º1ï¼Œå…¶ä»–ä¸º0   arange(s,e,step) ä»såˆ°eï¼Œæ­¥é•¿ä¸ºstep   linspace(s,e,steps) ä»såˆ°eï¼Œå‡åŒ€åˆ‡åˆ†æˆstepsä»½   rand/randn(*sizes) å‡åŒ€/æ ‡å‡†åˆ†å¸ƒ   normal(mean,std)/uniform(from,to) æ­£æ€åˆ†å¸ƒ/å‡åŒ€åˆ†å¸ƒ   randperm(m) éšæœºæ’åˆ—     è¿™äº›åˆ›å»ºæ–¹æ³•éƒ½å¯ä»¥åœ¨åˆ›å»ºçš„æ—¶å€™æŒ‡å®šæ•°æ®ç±»å‹dtypeå’Œå­˜æ”¾device(cpu/gpu)\n æ“ä½œ 1 2 3  x = torch.rand(5,3) y = torch.rand(5,3) x,y   (tensor([[0.7706, 0.7674, 0.0476], [0.3675, 0.3652, 0.1215], [0.2842, 0.4927, 0.0903], [0.1202, 0.7635, 0.1862], [0.1391, 0.5023, 0.0580]]), tensor([[0.2149, 0.4744, 0.6664], [0.5948, 0.3451, 0.6485], [0.2303, 0.6660, 0.3796], [0.7194, 0.3815, 0.7536], [0.7886, 0.0630, 0.2459]]))  åŠ æ³•ï¼Œä¸‰ç§æ–¹æ³•\n1 2 3 4  z1 = torch.add(x,y) z2 = x.add_(y) # xä¼šæ”¹å˜ z3 = x + y z1,z2,z3   (tensor([[0.9855, 1.2418, 0.7140], [0.9623, 0.7103, 0.7700], [0.5145, 1.1588, 0.4699], [0.8396, 1.1450, 0.9397], [0.9276, 0.5653, 0.3040]]), tensor([[0.9855, 1.2418, 0.7140], [0.9623, 0.7103, 0.7700], [0.5145, 1.1588, 0.4699], [0.8396, 1.1450, 0.9397], [0.9276, 0.5653, 0.3040]]), tensor([[1.2004, 1.7163, 1.3804], [1.5571, 1.0554, 1.4185], [0.7448, 1.8248, 0.8495], [1.5590, 1.5265, 1.6933], [1.7162, 0.6283, 0.5499]]))  ç´¢å¼•\n1 2  y = x[0, :] y   tensor([0.9855, 1.2418, 0.7140])  ä¿®æ”¹yä¼šä¿®æ”¹åŸæ¥çš„æ•°æ®ï¼Œå› ä¸ºå…±äº«å†…å­˜\n1 2 3  y+=1 print(y) print(x[0,:])   tensor([1.9855, 2.2418, 1.7140]) tensor([1.9855, 2.2418, 1.7140])  PyTorchè¿˜æä¾›äº†ä¸€äº›é«˜çº§çš„é€‰æ‹©å‡½æ•°:\n   å‡½æ•° åŠŸèƒ½     index_select(input, dim, index) åœ¨æŒ‡å®šç»´åº¦dimä¸Šé€‰å–ï¼Œæ¯”å¦‚é€‰å–æŸäº›è¡Œã€æŸäº›åˆ—   masked_select(input, mask) ä¾‹å­å¦‚ä¸Šï¼Œa[a\u0026gt;0]ï¼Œä½¿ç”¨ByteTensorè¿›è¡Œé€‰å–   nonzero(input) é0å…ƒç´ çš„ä¸‹æ ‡   gather(input, dim, index) æ ¹æ®indexï¼Œåœ¨dimç»´åº¦ä¸Šé€‰å–æ•°æ®ï¼Œè¾“å‡ºçš„sizeä¸indexä¸€æ ·    æ”¹å˜å½¢çŠ¶ ç”¨view()æ¥æ”¹å˜Tensorçš„å½¢çŠ¶ï¼š\n1 2 3  y = x.view(15) z = x.view(-1,5) # -1ä¸ºè‡ªåŠ¨è®¡ç®—ç»´åº¦ print(x.size(),y.size(),z.size())   torch.Size([5, 3]) torch.Size([15]) torch.Size([3, 5])   æ³¨æ„view()è¿”å›çš„æ–°Tensorä¸æºTensorè™½ç„¶å¯èƒ½æœ‰ä¸åŒçš„sizeï¼Œä½†æ˜¯æ˜¯å…±äº«dataçš„ï¼Œä¹Ÿå³æ›´æ”¹å…¶ä¸­çš„ä¸€ä¸ªï¼Œå¦å¤–ä¸€ä¸ªä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚(é¡¾åæ€ä¹‰ï¼Œviewä»…ä»…æ˜¯æ”¹å˜äº†å¯¹è¿™ä¸ªå¼ é‡çš„è§‚å¯Ÿè§’åº¦ï¼Œå†…éƒ¨æ•°æ®å¹¶æœªæ”¹å˜)\n 1 2  x += 1 x,y   (tensor([[4.9855, 5.2418, 4.7140], [3.9623, 3.7103, 3.7700], [3.5145, 4.1588, 3.4699], [3.8396, 4.1450, 3.9397], [3.9276, 3.5653, 3.3040]]), tensor([4.9855, 5.2418, 4.7140, 3.9623, 3.7103, 3.7700, 3.5145, 4.1588, 3.4699, 3.8396, 4.1450, 3.9397, 3.9276, 3.5653, 3.3040]))  ä½¿ç”¨reshape()å‡½æ•°ä¼šæ‹·è´ä¸€ä»½\n1 2  y = x.reshape(15) y   tensor([4.9855, 5.2418, 4.7140, 3.9623, 3.7103, 3.7700, 3.5145, 4.1588, 3.4699, 3.8396, 4.1450, 3.9397, 3.9276, 3.5653, 3.3040])  ä¹Ÿå¯ä»¥ä½¿ç”¨å…‹éš†åview\n ä½¿ç”¨cloneè¿˜æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯ä¼šè¢«è®°å½•åœ¨è®¡ç®—å›¾ä¸­ï¼Œå³æ¢¯åº¦å›ä¼ åˆ°å‰¯æœ¬æ—¶ä¹Ÿä¼šä¼ åˆ°æºTensorã€‚\n 1 2  y = x.clone().view(15) y   tensor([4.9855, 5.2418, 4.7140, 3.9623, 3.7103, 3.7700, 3.5145, 4.1588, 3.4699, 3.8396, 4.1450, 3.9397, 3.9276, 3.5653, 3.3040])  item(), å®ƒå¯ä»¥å°†ä¸€ä¸ªæ ‡é‡Tensorè½¬æ¢æˆä¸€ä¸ªPython numberï¼š\n1 2 3  x = torch.randn(1) print(x) print(x.item())   tensor([0.3816]) 0.3816383183002472  çº¿æ€§ä»£æ•°API    å‡½æ•° åŠŸèƒ½     trace å¯¹è§’çº¿å…ƒç´ ä¹‹å’Œ(çŸ©é˜µçš„è¿¹)   diag å¯¹è§’çº¿å…ƒç´    triu/tril çŸ©é˜µçš„ä¸Šä¸‰è§’/ä¸‹ä¸‰è§’ï¼Œå¯æŒ‡å®šåç§»é‡   mm/bmm çŸ©é˜µä¹˜æ³•ï¼Œbatchçš„çŸ©é˜µä¹˜æ³•   addmm/addbmm/addmv/addr/baddbmm.. çŸ©é˜µè¿ç®—   t è½¬ç½®   dot/cross å†…ç§¯/å¤–ç§¯   inverse æ±‚é€†çŸ©é˜µ   svd å¥‡å¼‚å€¼åˆ†è§£    å¹¿æ’­æœºåˆ¶ ä»€ä¹ˆæ˜¯å¹¿æ’­æœºåˆ¶ï¼Ÿç®€å•çš„è¯´å°±æ˜¯å½¢çŠ¶ä¸åŒçš„è¿ç®—ä¼šè‡ªåŠ¨å˜æ¢ä¸ºé€‚åˆçš„è¿ç®—\n1 2 3 4 5  x = torch.arange(3).view(1,3) print(x) y = torch.arange(2).view(2,1) print(y) print(x + y)   tensor([[0, 1, 2]]) tensor([[0], [1]]) tensor([[0, 1, 2], [1, 2, 3]]) ","description":"","id":114,"section":"posts","tags":["PyTorch","python","Tensor"],"title":"Pytorch Begin","uri":"https://hugo.jiahongw.com/zh/posts/deeplearning/pytorch-begin/"},{"content":"ä¸€ä»½è¿˜ç®—å¯ä»¥çš„ç¿»å¢™æ¸…å•ğŸ“‡\næœ¬æ–‡ä»‹ç»çš„æ–¹æ³•å½’æ€»: PCç«¯ Mobileç«¯   è°·æ­Œè®¿é—®åŠ©æ‰‹ æ’ä»¶(å¯ä»¥ç°åœ¨æç®€æ’ä»¶ä¸­ä¸‹è½½ï¼‰ Astar VPN æ’ä»¶ SSR    äº‘å¸†VPN è€ç‹VPN     'use strict'; var containerId = JSON.parse(\"\\\"635a6660b3cf14fc\\\"\"); var containerElem = document.getElementById(containerId); var tabLinks = null; var tabContents = null; var ids = []; if (containerElem) { tabLinks = containerElem.querySelectorAll('.tab__link'); tabContents = containerElem.querySelectorAll('.tab__content'); } for (var i = 0; i 0) { tabContents[0].style.display = 'block'; }  PCç«¯ è°·æ­Œè®¿é—®åŠ©æ‰‹ é¦–å…ˆæ˜¯ä¸èƒ½é€šè¿‡è°·æ­Œçš„åº”ç”¨å•†åº—ä¸‹è½½çš„ï¼Œå¯ä»¥åœ¨å›½å†…çš„ä¸€äº›æ’ä»¶ç½‘ç«™ä¸‹è½½ï¼Œè¿™äº›æ¨èæç®€æ’ä»¶ï¼Œæ‰¾åˆ°è°·æ­Œè®¿é—®åŠ©æ‰‹è¿›è¡Œä¸‹è½½ã€‚\nå°†CRTæ–‡ä»¶æ‹–å…¥è°·æ­Œæµè§ˆå™¨çš„æ‹“å±•ç¨‹åºç•Œé¢ä¸­(è¿™é‡Œç”¨çš„åŠ©æ‰‹æ˜¯å¦ä¸€ä¸ªç‰ˆæœ¬)\nä¹‹åå°±å¯ä»¥è®¿é—®è°·æ­Œçš„ä¸€éƒ¨åˆ†æœåŠ¡äº†ï¼Œä¾‹å¦‚è°·æ­Œæœç´¢ï¼ŒGmailï¼Œè°·æ­Œåº”ç”¨å•†åº—.\nå®‰è£…è¿‡ç¨‹å¯èƒ½ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ:å®‰è£…æŒ‡å¼•    å…¶ä»–ç±»ä¼¼çš„æ’ä»¶   PPè°·æ­Œè®¿é—®åŠ©æ‰‹:https://chrome.zzzmh.cn/info?token=kahndhhhcnignmbbpiobmdlgjhgfkfil é›†è£…ç®±:https://chrome.zzzmh.cn/info?token=kbgigmcnifmaklccibmlepmahpfdhjch è°·æ­Œè®¿é—®åŠ©æ‰‹:https://chrome.zzzmh.cn/info?token=gocklaboggjfkolaknpbhddbaopcepfp è°·æ­Œå­¦æœ¯åŠ©æ‰‹:https://chrome.zzzmh.cn/info?token=jkicnibdkfemnfhojeajbldjgdddpajk è°·æ­ŒæœåŠ¡åŠ©æ‰‹:https://chrome.zzzmh.cn/info?token=cgncbhnhlkbdieckbbmeppcefokppagh è°·æ­Œä¸Šç½‘åŠ©æ‰‹:https://chrome.zzzmh.cn/info?token=nonmafimegllfoonjgplbabhmgfanaka    Astar VPN Astar VPNä¹Ÿæ˜¯ä¸€ä¸ªChromeæ’ä»¶ï¼Œåœ¨è°·æ­Œåº”ç”¨å•†åº—å¯ä»¥ä¸‹è½½ã€‚ç»è¿‡ç¬¬ä¸€æ­¥ä¹‹åï¼Œwe\u0026rsquo;re good to go!ğŸ˜\nåº”ç”¨å•†åº—æœç´¢Astar VPNè¿›è¡Œä¸‹è½½ï¼Œç›´æ¥å°±å¯ä»¥åœ¨Chromeä¸­è¿›è¡Œè‡ªåŠ¨å®‰è£…ã€‚\nä¹‹åå†æ’ä»¶é€‰é¡¹ä¸­å¼€å¯è¯¥æ’ä»¶ï¼Œå…¶ä¸­å¯ä»¥é€‰æ‹©ä¸åŒçš„æœåŠ¡å™¨è¿›è¡Œè¿æ¥ï¼Œé€Ÿåº¦è¿˜ä¸é”™ã€‚\nä½¿ç”¨è¯¥æ’ä»¶è¿›è¡Œç§‘å­¦ä¸Šç½‘æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ï¼Œå®ƒå¯ä»¥è®¿é—®å›½å¤–ä»»ä½•ç½‘ç«™!  ShadowsSocks ShadowsSocksæ˜¯ä¸€æ¬¾åœ¨githubä¸Šçš„å¼€æºè½¯ä»¶ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œè¿æ¥èŠ‚ç‚¹æœåŠ¡å™¨ï¼Œä½†æ˜¯èŠ‚ç‚¹éœ€è¦è‡ªå·±å»æ‰¾ï¼Œä¸‹é¢ä¼šä»‹ç»èŠ‚ç‚¹çš„é€‰æ‹©ã€‚\né¦–å…ˆå»githubä¸‹è½½è¿™ä¸ªè½¯ä»¶ï¼Œé“¾æ¥ä¸ºï¼šhttps://github.com/shadowsocks/shadowsocks-windows/releases/tag/4.1.9.2\nå°†ä¸¤ä¸ªæ–‡ä»¶è§£å‹ä¹‹åï¼Œå°†ç¬¬ä¸€ä¸ªæ–‡ä»¶å¤¹å†…çš„exeæ–‡ä»¶ç§»åŠ¨åˆ°ç¬¬äºŒä¸ªæ–‡ä»¶å¤¹çš„æ ¹ç›®å½•å¹¶ä¸”æ‰“å¼€å³å¯\nå…³äºå…è´¹èŠ‚ç‚¹ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç½‘å€ï¼šhttps://free-ss.site/(éœ€è¦ç§‘å­¦ä¸Šç½‘)\nå³é”®ShadowSocksçš„å›¾æ ‡ï¼Œé€‰æ‹©æœåŠ¡å™¨ï¼Œåœ¨é€‰æ‹©æ‰«æå±å¹•äºŒç»´ç ï¼Œå³å¯æ·»åŠ èŠ‚ç‚¹ï¼Œä¹‹åç‚¹å‡»ç³»ç»Ÿä»£ç†å¹¶å¼€å¯ç³»ç»Ÿä»£ç†ä¸ºå…¨å±€æ¨¡å¼ã€‚\nä¹‹åå°±å¯ä»¥ğŸ¤™ğŸ¤™ğŸ¤™!\nMobileç«¯ ä¸‹é¢ä¸¤ä¸ªè½¯ä»¶éƒ½æ˜¯éœ€è¦ç§‘å­¦ä¸Šç½‘çš„ï¼Œå»ºè®®å…ˆåœ¨PCç«¯ä¸‹è½½å†ä¼ åˆ°æ‰‹æœºå®‰è£…ã€‚  äº‘å¸†VPN ä¸‹è½½åœ°å€ï¼šhttps://apkpure.com/store/apps/details?id=cc.dingnet.yunfangp\nè™½ç„¶æ¯å¤©åªèƒ½ä½¿ç”¨1å°æ—¶ï¼Œä½†æ˜¯åŸºæœ¬å¤Ÿäº†ã€‚\nè€ç‹VPN ä¸‹è½½åœ°å€ï¼šhttps://apkpure.com/wang-vpn-%E2%9D%A4%EF%B8%8F-free-fast-stable-best-vpn-just-try-it/com.findtheway\nè€ç‹çš„ä¸œè¥¿æ°¸è¿œå…è´¹ï¼\nå‚è€ƒé“¾æ¥\n 2020å¹´Androidé«˜é€Ÿç¨³å®šç¿»å¢™æ–¹æ³• Windowsä¸Šé•¿æœŸæœ‰æ•ˆçš„å…è´¹ä¸”é«˜é€Ÿç¨³å®šç¿»å¢™æ³•ï¼ ","description":"","id":115,"section":"posts","tags":["ç§‘å­¦ä¸Šç½‘","ShadowShocks"],"title":"2020ç¿»å¢™æŒ‡å—ğŸ‘ˆ","uri":"https://hugo.jiahongw.com/zh/posts/settings/2020-fanqiang/"},{"content":"ğŸ‘±â€â™€ä»‹ç»ä¸€äº›markdownä¸­æ¯”è¾ƒå®ç”¨çš„ä¸€äº›å†™ä½œæ–¹æ³•ã€‚\nä»»åŠ¡åˆ—è¡¨âœ  a task list item list syntax required normal formatting, @mentions, #1234 refs incomplete completed  ä¸Šé¢çš„ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5  - [ ] a task list item - [ ] list syntax required - [ ] normal **formatting**, @mentions, #1234 refs - [ ] incomplete - [x] completed   æ•°å­¦å…¬å¼ğŸ“ ä½¿ç”¨MathJaxæ¸²æŸ“LaTeXæ•°å­¦è¡¨è¾¾å¼ã€‚ğŸ’¡\n$$\n\\mathbf{V}_1 \\times \\mathbf{V}_2 = \\begin{vmatrix}\n\\mathbf{i} \u0026amp; \\mathbf{j} \u0026amp; \\mathbf{k} \\\\\n\\frac{\\partial X}{\\partial u} \u0026amp; \\frac{\\partial Y}{\\partial u} \u0026amp; 0 \\\\\n\\frac{\\partial X}{\\partial v} \u0026amp; \\frac{\\partial Y}{\\partial v} \u0026amp; 0 \\\\\n\\end{vmatrix}\n$$\nä¸Šé¢çš„ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7  $$ \\mathbf{V}_1 \\times \\mathbf{V}_2 = \\begin{vmatrix} \\mathbf{i} \u0026amp; \\mathbf{j} \u0026amp; \\mathbf{k} \\\\\\\\ \\frac{\\partial X}{\\partial u} \u0026amp; \\frac{\\partial Y}{\\partial u} \u0026amp; 0 \\\\\\\\ \\frac{\\partial X}{\\partial v} \u0026amp; \\frac{\\partial Y}{\\partial v} \u0026amp; 0 \\\\\\\\ \\end{vmatrix} $$   $$\n\\begin{align*}\ny = y(x,t) \u0026amp;= A e^{i\\theta} \\\\\n\u0026amp;= A (\\cos \\theta + i \\sin \\theta) \\\\\n\u0026amp;= A (\\cos(kx - \\omega t) + i \\sin(kx - \\omega t)) \\\\\n\u0026amp;= A\\cos(kx - \\omega t) + i A\\sin(kx - \\omega t) \\\\\n\u0026amp;= A\\cos \\Big(\\frac{2\\pi}{\\lambda}x - \\frac{2\\pi v}{\\lambda} t \\Big) + i A\\sin \\Big(\\frac{2\\pi}{\\lambda}x - \\frac{2\\pi v}{\\lambda} t \\Big) \\\\\n\u0026amp;= A\\cos \\frac{2\\pi}{\\lambda} (x - v t) + i A\\sin \\frac{2\\pi}{\\lambda} (x - v t)\n\\end{align*}\n$$\nä¸Šé¢ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10  $$ \\begin{align*} y = y(x,t) \u0026amp;= A e^{i\\theta} \\\\\\\\ \u0026amp;= A (\\cos \\theta + i \\sin \\theta) \\\\\\\\ \u0026amp;= A (\\cos(kx - \\omega t) + i \\sin(kx - \\omega t)) \\\\\\\\ \u0026amp;= A\\cos(kx - \\omega t) + i A\\sin(kx - \\omega t) \\\\\\\\ \u0026amp;= A\\cos \\Big(\\frac{2\\pi}{\\lambda}x - \\frac{2\\pi v}{\\lambda} t \\Big) + i A\\sin \\Big(\\frac{2\\pi}{\\lambda}x - \\frac{2\\pi v}{\\lambda} t \\Big) \\\\\\\\ \u0026amp;= A\\cos \\frac{2\\pi}{\\lambda} (x - v t) + i A\\sin \\frac{2\\pi}{\\lambda} (x - v t) \\end{align*} $$   è„šæ³¨ğŸ‘£ å¦‚ä¸‹æ˜¯ä½¿ç”¨çš„ä»£ç ï¼Œå°†é¼ æ ‡æ‚¬åœåœ¨â€œ fn1â€æˆ–â€œ fn2â€ä¸Šæ ‡ä¸Šå¯ä»¥æŸ¥çœ‹è„šæ³¨çš„å†…å®¹ã€‚æ‚¨å¯ä»¥å°†ä»»ä½•å–œæ¬¢çš„å”¯ä¸€æ ‡è¯†ç”¨ä½œè„šæ³¨æ ‡è®°ï¼ˆä¾‹å¦‚â€œ fn1â€ï¼‰ã€‚\n1 2  [^fn1]: Here is the *text* of the first **footnote**. [^fn2]: Here is the *text* of the second **footnote**   ä½ ä¹Ÿå¯ä»¥å†…åµŒè„šæ³¨ï¼Œå°±åƒ^[Here is the text of the first footnote.]\næ°´å¹³çº¿ã€° ğŸŒŸåœ¨ç©ºè¡Œè¾“å…¥***æˆ–---ï¼Œå¦‚ä¸‹ï¼š\nYMALé¦–è¦äº‹é¡¹ğŸ¤” åŒ…å«YAMLå‰äº‹å—çš„æ–‡ä»¶å°†ä½œä¸ºç‰¹æ®Šæ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­\n1 2 3 4  ---layout:posttitle:BloggingLikeaHacker---  ç›®å½•ğŸ“‘ è¾“å…¥[toc]å¹¶å›è½¦å³å¯ã€‚\nå†…éƒ¨é“¾æ¥ğŸ”— è¿™æ˜¯ä¸€ä¸ªè·³è½¬åˆ°ä»»åŠ¡åˆ—è¡¨çš„é“¾æ¥,this link ï¼\nä»£ç å¦‚ä¸‹ï¼š\n1  [this link](#ä»»åŠ¡åˆ—è¡¨âœ)   å‚è€ƒé“¾æ¥ğŸ“– å‚è€ƒé“¾æ¥ä½¿ç”¨ä¸¤ç»„æ–¹æ‹¬å·çš„æ ¼å¼ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ˜¾ç¤ºçš„æ–‡å­—ï¼Œç¬¬äºŒä¸ªæ‹¬å·å†…æ˜¯æŸ¥æ‰¾çš„idï¼Œä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5  This is [an example][id] reference-style link. Then, anywhere in the document, you define your link label on a line by itself like this: [id]: http://example.com/ \u0026#34;Optional Title Here\u0026#34;   éšå¼é“¾æ¥ï¼Œç›´æ¥ä½¿ç”¨GoogleæŸ¥é˜…ï¼š\n[Google][] And then define the link: [Google]: http://google.com/ åˆ é™¤çº¿âŒ åˆ é™¤Mistaken text.ï¼Œä»£ç ä¸º~~Mistaken text.~~\né«˜äº®ğŸ”† ==highlight==ï¼Œä½¿ç”¨ä¸¤ä¸ªç­‰å·åœ¨ä¸¤è¾¹è¿›è¡ŒåŒ…å›´ï¼Œä»£ç å¦‚ä¸‹ï¼š\n1  ==highlight==   æ’å…¥è§†é¢‘ğŸ“¹ Your browser does not support the video tag.\nä¸Šé¢çš„ä»£ç å³ï¼š\n1  \u0026lt;video poster=\u0026#34;https://i.loli.net/2020/02/29/S4oN2djFDZYiqAx.png\u0026#34; src=\u0026#34;https://files.catbox.moe/bqrntc.flv\u0026#34; style=\u0026#34;max-height :100%; max-width: 100%; display: block; margin-left: auto; margin-right: auto;\u0026#34; controls=\u0026#34;controls\u0026#34; loop=\u0026#34;loop\u0026#34; preload=\u0026#34;meta\u0026#34;\u0026gt;Your browser does not support the video tag.\u0026lt;/video\u0026gt;   æ’å…¥éŸ³ä¹ğŸ¼ Your browser does not support the audio tag.\nä¸Šé¢çš„ä»£ç å³ï¼š\n1  \u0026lt;audio src=\u0026#34;https://files.catbox.moe/wjiywu.mp3\u0026#34; style=\u0026#34;max-height :100%; max-width: 100%; display: block; margin-left: auto; margin-right: auto;\u0026#34; controls=\u0026#34;controls\u0026#34; loop=\u0026#34;loop\u0026#34; preload=\u0026#34;meta\u0026#34;\u0026gt;Your browser does not support the audio tag.\u0026lt;/audio\u0026gt;   æ›´å¤šï¼š\néšæœºå›¾ç‰‡ğŸŒ³ ç½‘å€:https://picsum.photos/1920/1080\n","description":"","id":116,"section":"posts","tags":["markdown","Typora"],"title":"Markdownæ·±å…¥ä½¿ç”¨","uri":"https://hugo.jiahongw.com/zh/posts/settings/markdown-deep/"},{"content":"SM.MS sm.ms æ”¯æŒçš„å›¾ç‰‡æ ¼å¼åŒ…æ‹¬ JPGã€JPEGã€GIFã€PNG åŠ BMPï¼Œå•æ¡£ä¸è¶…è¿‡ 5 MBï¼Œå•æ¬¡å¯ä¸Šä¼ å›¾ç‰‡æœ€å¤§ 10 å¼ ã€‚å›¾ç‰‡æ°¸ä¹…ä¿å­˜ï¼Œè¯·å‹¿ä¸Šä¼ æ”¿æ²»ç›¸å…³å›¾ç‰‡\né€Ÿåº¦ï¼šé«˜é€ŸæœåŠ¡å™¨ â¤ â¤ â¤ â¤ â¤(15 å¹´æˆç«‹)\nå¦‚ä¼˜å›¾åºŠ æ”¯æŒå¤§é‡å…è´¹å›¾åºŠåˆ†å‘ï¼Œç½‘ç«™ç¨³å®šæ€§æœªçŸ¥\né€Ÿåº¦ï¼šåŠ¨æ€ â¤ â¤ â¤ â¤ â¤\nç‰›å›¾ç½‘ é€Ÿåº¦ï¼šæ—¥æœ¬æœåŠ¡å™¨ â¤ â¤ â¤ â¤(2010 å¹´)\nniupic.com ç¨³å®šæ€§ä¸é”™ï¼Œä¸è¦ä¸Šä¼ è¿æ³•å›¾ç‰‡\nvim-cn ä¸Šä¼ ç•Œé¢ååˆ†ç®€å•ï¼Œä½†ååˆ†ç¨³å®šã€‚\né€Ÿåº¦ï¼š â¤ â¤ â¤(12å¹´åˆ°ç°åœ¨)\nimgbb æ— éœ€æ³¨å†Œï¼Œæ”¯æŒæœ€å¤§ 16M å›¾ç‰‡ä¸Šä¼ ï¼Œæ”¯æŒ httpsï¼Œé€Ÿåº¦ä¸é”™\né€Ÿåº¦ï¼šäºšå¤ªæœåŠ¡å™¨ â¤ â¤ â¤ â¤\nmeotu 16 å¹´æˆç«‹çš„å…è´¹å›¾ç‰‡å¤–é“¾ç½‘ç«™ã€‚ä¸Šä¼ ä¸‹è½½é€Ÿåº¦å¿«ã€‚\néœ€è¦æ³¨å†Œï¼Œé»˜è®¤åŸå›¾ä¸Šä¼ ï¼Œæ”¯æŒ https\né€Ÿåº¦ï¼šé«˜é€ŸæœåŠ¡å™¨ â¤ â¤ â¤ â¤ â¤\né‡è§å›¾åºŠ 18 å¹´æˆç«‹çš„å…è´¹å›¾ç‰‡å¤–é“¾ç½‘ç«™ã€‚ä¸Šä¼ ä¸‹è½½é€Ÿåº¦å¿«ã€‚\néœ€è¦æ³¨å†Œï¼Œé»˜è®¤åŸå›¾ä¸Šä¼ ï¼Œæ”¯æŒæœ€å¤§ 10Mï¼Œæ”¯æŒ https\né€Ÿåº¦ï¼šé«˜é€ŸæœåŠ¡å™¨ â¤ â¤ â¤ â¤ â¤\nz4a å›¾åºŠ éœ€è¦æ³¨å†Œï¼Œæ”¯æŒ HTTPS é€Ÿåº¦å—\né€Ÿåº¦ï¼šé«˜é€ŸæœåŠ¡å™¨ â¤ â¤ â¤ â¤ â¤\nz4a.net ç”±äºæˆç«‹æ—¶é—´è¾ƒçŸ­ï¼Œç¨³å®šæ€§æœªçŸ¥ã€‚\nupload 2012 å¹´æˆç«‹çš„å…è´¹å›¾ç‰‡ä¸Šä¼ å¤–é“¾ç½‘ç«™ï¼Œè‡³ä»Šä¾ç„¶ç¨³å®š\næ— éœ€æ³¨å†Œï¼Œé»˜è®¤åŸå›¾ä¸Šä¼ ï¼Œæ”¯æŒ https\né€Ÿåº¦ï¼šäºšå¤ªæœåŠ¡å™¨ â¤ â¤ â¤\ncatbox æ— éœ€æ³¨å†Œï¼Œæ”¯æŒ https\né€Ÿåº¦ï¼šæµ·å¤–æœåŠ¡å™¨ â¤ â¤ â¤\ncatbox.moe æ”¯æŒ 200m ä¸»æµæ ¼å¼æ–‡ä»¶å¤–é“¾ç½‘ç«™\n","description":"","id":117,"section":"posts","tags":["photo","å›¾åºŠ"],"title":"å‡ æ¬¾å¥½ç”¨çš„å›¾åºŠ","uri":"https://hugo.jiahongw.com/zh/posts/settings/free-image-bed/"},{"content":"Freenom æ˜¯ç›®å‰ä¸ºæ•°ä¸å¤šçš„å…è´¹åŸŸåæä¾›å•†ï¼Œæä¾› .ga, .ml, .gq, .tk, .cf äº”ä¸ªå…è´¹é¡¶çº§åŸŸã€‚å½“ç„¶ä¹Ÿæœ‰ä¸€äº›ä»˜è´¹çš„åŸŸåï¼Œå¯¹äºæ™®é€šäººæ¥è¯´ï¼Œå…è´¹åŸŸåå°±å¤Ÿäº†ã€‚ğŸ˜\nç¬¬ä¸€æ­¥ï¼Œæ‰¾åŸŸå æ‰“å¼€Freenomï¼Œç™»é™†åç›´æ¥åœ¨æœç´¢æ æœç´¢è‡ªå·±æƒ³è¦çš„åŸŸååå­—ï¼Œç„¶åç³»ç»Ÿä¼šè¿”å›å¯ä»¥ä½¿ç”¨çš„å…è´¹åŸŸåï¼Œé€‰æ‹©ä¸€ä¸ªç»“ç®—å³å¯\nç¬¬äºŒæ­¥ï¼Œé…ç½®è§£ææœåŠ¡ ä½¿ç”¨cloudflareè§£ææœåŠ¡ æ‰“å¼€cloudflareï¼Œé¦–å…ˆéœ€è¦æ³¨å†Œä¸€ä¸ªè´¦å·ã€‚ç„¶åä»–ä¼šè¦æ±‚è¾“å…¥éœ€è¦è§£æçš„åŸŸå\nå¡«å†™ç›¸åº”çš„DNSä¿¡æ¯ï¼Œå¹¶ä¸”å°†ä¸‹é¢çš„NSä¿¡æ¯å¡«å†™åˆ°freenomçš„custom nameservers\nç­‰å¾…ä¸ªå‡ åˆ†é’Ÿå°±å¥½äº†ã€‚Over ğŸ¤\n","description":"","id":118,"section":"posts","tags":["åŸŸå","freenom"],"title":"Freenom å…è´¹åŸŸåç”³è¯·","uri":"https://hugo.jiahongw.com/zh/posts/settings/freenom-domain/"},{"content":"å®‰è£…MinGWä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é‚£å®ƒæ¥ä½œä¸ºCæˆ–C++çš„ç¼–è¯‘å™¨.ğŸ•¸\nCMDç¼–è¯‘ç¨‹åº  ç¼–è¯‘è¿‡ç¨‹åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼šé¢„å¤„ç†ã€ç¼–è¯‘ã€æ±‡ç¼–ã€é“¾æ¥ã€‚\n ä½¿ç”¨g++å¯ä»¥åœ¨å‘½ä»¤è¡Œåˆ†åˆ«å®ç°ä¸Šé¢å››ä¸ªæ­¥éª¤ã€‚ä½¿ç”¨ä¸‹é¢çš„ç¨‹åºä½œä¸ºä¾‹å­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  #include \u0026lt;iostream\u0026gt;#include \u0026lt;cmath\u0026gt;using namespace std; // this is my test program  #ifndef myNum#define myNum 666 #endifint main() { cout \u0026lt;\u0026lt; \u0026#34;Hello!\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;myNum = \u0026#34; \u0026lt;\u0026lt; myNum \u0026lt;\u0026lt;endl; return 0; }   é¢„å¤„ç† é¢„å¤„ç†ä¸»è¦å®Œæˆçš„å·¥ä½œæœ‰ï¼š\nï¼ˆ1ï¼‰åˆ é™¤#defineï¼Œå±•å¼€å®ï¼›\nï¼ˆ2ï¼‰å¤„ç†æ¡ä»¶ç¼–è¯‘æŒ‡ä»¤ï¼Œé¢„å¤„ç†ç¨‹åºå…ˆåˆ¤æ–­æ¡ä»¶ï¼Œåœ¨æ ¹æ®æ¡ä»¶ä¿®æ”¹æºä»£ç ï¼›\nï¼ˆ3ï¼‰åˆ é™¤æ³¨é‡Šï¼›\nï¼ˆ4ï¼‰æ·»åŠ è¡Œå·ï¼Œä»¥åŠæ–‡ä»¶åæ ‡è¯†ï¼Œä¾¿äºè°ƒè¯•\nï¼ˆ5ï¼‰åˆ é™¤â€œ#includeâ€ï¼Œæ’å…¥ç›¸åº”çš„å¤´æ–‡ä»¶ï¼›\n ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼Œå¾—åˆ°é¢„å¤„ç†åçš„æ–‡ä»¶test.i\n1  g++ -E test.cpp -o test.i   æŸ¥çœ‹test.iæ–‡ä»¶\nç¼–è¯‘ ä½¿ç”¨ä¸‹é¢çš„ä»£ç ç”Ÿæˆæ±‡ç¼–æ–‡ä»¶test.s\n1  g++ -S test.i -o test.s   æ³¨æ„ï¼šç›´æ¥ä»test.cppæ–‡ä»¶å¾—åˆ°æ±‡ç¼–æ–‡ä»¶ä¹Ÿå¯ä»¥ã€‚ç›´æ¥ä½¿ç”¨å‘½ä»¤ g++ -S test.cpp -o test.s  æŸ¥çœ‹test.sæ–‡ä»¶\næ±‡ç¼– ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å°†æ±‡ç¼–æŒ‡ä»¤è½¬åŒ–ä¸ºæœºå™¨æŒ‡ä»¤ï¼Œç”Ÿæˆæ–‡ä»¶test.o\n1  g++ -c test.s -o test.o   æŸ¥çœ‹æ–‡ä»¶test.o\né“¾æ¥ é€šè¿‡é“¾æ¥åº“æ–‡ä»¶ï¼Œå¯ä»¥å°†ç›®æ ‡æ–‡ä»¶test.oè½¬åŒ–ä¸ºå¯æ‰§è¡Œæ–‡ä»¶test.exe\næ³¨æ„:Windowsä¸‹å¯æ‰§è¡Œæ–‡ä»¶çš„åç¼€ä¸ºexeï¼Œè€ŒLinuxä¸‹ä¸éœ€è¦åç¼€ã€‚  CMDè¾“å…¥ä»¥ä¸‹ä»£ç \n1  g++ test.o -o test.exe   æ³¨æ„:Windowsä¸‹.oæ–‡ä»¶å·²ç»å¯ä»¥æ‰§è¡Œï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥test.oå°±å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„æ•ˆæœï¼š\n å¦å¤–ä¸€ä¸ªå‘½ä»¤æ˜¯\n1  g++ test.o -o test.exe -L æ‰€éœ€åº“æ–‡ä»¶è·¯å¾„   å…¶ä¸­Lä¸ºlinkçš„ç¼©å†™ã€‚ å¿«é€Ÿç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨g++ test.cpp -o test å°±å¯ä»¥ç”Ÿæˆå¯æ‰§è¡Œç¨‹åºäº†ã€‚\nè¿è¡Œç¨‹åº å¦‚ä¸‹ï¼š\nMinGW + SublimeTexté…ç½®C++ç¯å¢ƒ ä¸‹è½½MinGWå’ŒSublimeText SublimeTextä¸‹è½½\nMinGWä¸‹è½½åŠç›¸å…³é…ç½®\nä½¿ç”¨SublimeText å› ä¸ºå‰é¢é…ç½®å¥½ç¯å¢ƒå˜é‡äº†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åœ¨SublimeTextä¸‹ç¼–è¯‘è¿è¡Œç¨‹åº\nTools-\u0026gt;build(æˆ–è€…æŒ‰å¿«æ·é”®Ctrl+B æˆ– Ctrl + Shift + B)\nå¯ä»¥åœ¨æœ€ä¸‹é¢ä¸€æ çœ‹åˆ°è¾“å‡ºç»“æœ\nenjoy it!\nè§£å†³SublimeTextä¸‹ä¸èƒ½ä½¿ç”¨è¾“å…¥çš„é—®é¢˜ SublimeTextæ˜¯æŠŠshellæ‰§è¡Œçš„ç»“æœè¯»å›æ¥æ˜¾ç¤ºåœ¨ç»ˆç«¯ï¼Œè¿™æ„å‘³æ— æ³•ä½¿ç”¨è¾“å…¥è¯­å¥ï¼Œæ— æ³•ä½¿ç”¨è°ƒè¯•åŠŸèƒ½ã€‚  è§£å†³æ–¹æ³•:è®©ç¨‹åºç›´æ¥è¿è¡Œåœ¨CMD\nåœ¨sublime-\u0026gt;Tools\u0026gt;Build Systemé‡Œæ–°å»ºç¼–è¯‘ç³»ç»Ÿï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹æ„å»ºC++ç¼–è¯‘ç¯å¢ƒ,ä¿å­˜åå­—ä¸ºC++Buider\n1 2 3 4 5 6 7 8 9 10 11 12  {\u0026#34;cmd\u0026#34;: [\u0026#34;g++\u0026#34;,\u0026#34;$file_name\u0026#34;,\u0026#34;-o\u0026#34;,\u0026#34;${file_base_name}\u0026#34;,\u0026#34;-lm\u0026#34;,\u0026#34;-Wall\u0026#34;],\u0026#34;file_regex\u0026#34;: \u0026#34;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$\u0026#34;,\u0026#34;selector\u0026#34;: \u0026#34;source.c, source.c++\u0026#34;,\u0026#34;shell\u0026#34;: false,\u0026#34;working_dir\u0026#34;: \u0026#34;$file_path\u0026#34;,\u0026#34;variants\u0026#34;: [{\u0026#34;name\u0026#34;: \u0026#34;RunInCommand\u0026#34;,\u0026#34;cmd\u0026#34;: [\u0026#34;cmd\u0026#34;,\u0026#34;/c\u0026#34;,\u0026#34;g++\u0026#34;,\u0026#34;-g\u0026#34;,\u0026#34;${file}\u0026#34;,\u0026#34;-o\u0026#34;,\u0026#34;${file_path}/${file_base_name}\u0026#34;,\u0026#34;\u0026amp;\u0026amp;\u0026#34;,\u0026#34;start\u0026#34;,\u0026#34;cmd\u0026#34;,\u0026#34;/k\u0026#34;,\u0026#34;${file_path}/${file_base_name}\u0026#34;]}]}  ç„¶åå¯ä»¥ä½¿ç”¨å¿«æ·é”®Ctrl + Shift + Bï¼Œä¼šæ˜¾ç¤ºå¦‚ä¸‹ï¼Œä½¿ç”¨å‘½ä»¤è¡Œæ‰“å¼€æ¨¡å¼é€‰é¡¹å³å¯\nç»“æœå¦‚ä¸‹ï¼š\nå…¶ä»–ç¼–è¯‘ç¯å¢ƒçš„é…ç½®ä¹Ÿç±»ä¼¼ï¼š\nCç¼–è¯‘é…ç½®æ–‡ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12  {\u0026#34;cmd\u0026#34;: [\u0026#34;gcc\u0026#34;,\u0026#34;$file_name\u0026#34;,\u0026#34;-o\u0026#34;,\u0026#34;${file_base_name}\u0026#34;,\u0026#34;-lm\u0026#34;,\u0026#34;-Wall\u0026#34;],\u0026#34;file_regex\u0026#34;: \u0026#34;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$\u0026#34;,\u0026#34;selector\u0026#34;: \u0026#34;source.c, source.c++\u0026#34;,\u0026#34;shell\u0026#34;: false,\u0026#34;working_dir\u0026#34;: \u0026#34;$file_path\u0026#34;,\u0026#34;variants\u0026#34;: [{\u0026#34;name\u0026#34;: \u0026#34;RunInCommand\u0026#34;,\u0026#34;cmd\u0026#34;: [\u0026#34;cmd\u0026#34;,\u0026#34;/c\u0026#34;,\u0026#34;gcc\u0026#34;,\u0026#34;-g\u0026#34;,\u0026#34;${file}\u0026#34;,\u0026#34;-o\u0026#34;,\u0026#34;${file_path}/${file_base_name}\u0026#34;,\u0026#34;\u0026amp;\u0026amp;\u0026#34;,\u0026#34;start\u0026#34;,\u0026#34;cmd\u0026#34;,\u0026#34;/k\u0026#34;,\u0026#34;${file_path}/${file_base_name}\u0026#34;]}]}  Javaç¼–è¯‘é…ç½®æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  { \u0026#34;cmd\u0026#34;: [\u0026#34;javac\u0026#34;, \u0026#34;$file_name\u0026#34;], \u0026#34;file_regex\u0026#34;: \u0026#34;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$\u0026#34;, \u0026#34;selector\u0026#34;: \u0026#34;source.java\u0026#34;, \u0026#34;shell\u0026#34;: false, \u0026#34;working_dir\u0026#34;: \u0026#34;$file_path\u0026#34;, \u0026#34;variants\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;RunInCommand\u0026#34;, \u0026#34;cmd\u0026#34;: [\u0026#34;cmd\u0026#34;, \u0026#34;/c\u0026#34;, \u0026#34;javac\u0026#34;, \u0026#34;${file}\u0026#34;, \u0026#34;\u0026amp;\u0026amp;\u0026#34;, \u0026#34;start\u0026#34;, \u0026#34;cmd\u0026#34;, \u0026#34;/k\u0026#34;, \u0026#34;java $file_name\u0026#34;] }, { \u0026#34;name\u0026#34;: \u0026#34;Debug\u0026#34;, \u0026#34;cmd\u0026#34;: [\u0026#34;cmd\u0026#34;, \u0026#34;/c\u0026#34;, \u0026#34;javac\u0026#34;, \u0026#34;${file}\u0026#34;, \u0026#34;\u0026amp;\u0026amp;\u0026#34;, \u0026#34;start\u0026#34;, \u0026#34;cmd\u0026#34;, \u0026#34;/k\u0026#34;, \u0026#34;gdb ${file_path}/${file_base_name}\u0026#34;] }] }   è§£å†³ä¸èƒ½è¾“å…¥ä¸­æ–‡çš„é—®é¢˜ ä½¿ç”¨ä¸‹é¢çš„ç¼–è¯‘é…ç½®æ–‡ä»¶å³å¯ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  {\u0026#34;encoding\u0026#34;: \u0026#34;GBK\u0026#34;,\u0026#34;working_dir\u0026#34;: \u0026#34;$file_path\u0026#34;,\u0026#34;shell_cmd\u0026#34;: \u0026#34;g++ -fexec-charset=GBK -Wall -std=c++11 \\\u0026#34;$file_name\\\u0026#34; -o \\\u0026#34;$file_base_name\\\u0026#34;\u0026#34;,\u0026#34;file_regex\u0026#34;: \u0026#34;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$\u0026#34;,\u0026#34;selector\u0026#34;: \u0026#34;source.c++\u0026#34;,\u0026#34;variants\u0026#34;: [{\u0026#34;name\u0026#34;: \u0026#34;Run in sublime\u0026#34;,\u0026#34;shell_cmd\u0026#34;: \u0026#34;g++ -fexec-charset=GBK -Wall -std=c++11 \\\u0026#34;$file_name\\\u0026#34; -o \\\u0026#34;$file_base_name\\\u0026#34; \u0026amp;\u0026amp; cmd /c \\\u0026#34;${file_path}/${file_base_name}\\\u0026#34;\u0026#34;},{\u0026#34;name\u0026#34;: \u0026#34;CMD Run\u0026#34;,\u0026#34;shell_cmd\u0026#34;: \u0026#34;g++ -fexec-charset=GBK -Wall -std=c++11 \\\u0026#34;$file\\\u0026#34; -o \\\u0026#34;$file_base_name\\\u0026#34; \u0026amp;\u0026amp; start cmd /c \\\u0026#34;\\\u0026#34;${file_path}/${file_base_name}\\\u0026#34; \u0026amp; pause\\\u0026#34;\u0026#34;},{\u0026#34;name\u0026#34;: \u0026#34;gdb Debug\u0026#34;,\u0026#34;shell_cmd\u0026#34;: \u0026#34;g++ -fexec-charset=GBK -g -std=c++11 \\\u0026#34;$file\\\u0026#34; -o \\\u0026#34;$file_base_name\\\u0026#34; \u0026amp;\u0026amp; start cmd /c gdb ${file_path}/${file_base_name} \u0026amp; pause\u0026#34;}]}  é…ç½®ä»£ç æ ¼å¼åŒ– ä»èœå•é‡Œé€‰View-\u0026gt;Show Consoleï¼Œè·³å‡ºConsoleï¼Œä¸‹é¢æœ‰ä¸€è¡Œè¾“å…¥çš„ï¼ˆå…‰æ ‡ä½ç½®ï¼‰ï¼ŒæŠŠä¸‹é¢è¿™æ®µä»£ç è¾“å…¥è¿›å»å›è½¦(åªé€‚ç”¨sublime Text 3)\n1  import urllib.request,os; pf = \u0026#39;Package Control.sublime-package\u0026#39;; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); open(os.path.join(ipp, pf), \u0026#39;wb\u0026#39;).write(urllib.request.urlopen( \u0026#39;http://sublime.wbond.net/\u0026#39; + pf.replace(\u0026#39;\u0026#39;,\u0026#39;%20\u0026#39;)).read())   å®‰è£…CoolFormatï¼ŒæŒ‰Ctrl+Shift+Pï¼Œç„¶åè¾“å…¥install,å°±ä¼šå‡ºç°â€œPackage Control: Install Packageâ€ï¼Œè¾“å…¥CoolFormatè¿›è¡Œä¸‹è½½ï¼Œä¸‹è½½å®Œæˆä¹‹åè¾“å…¥Ctrl+Shift+Pï¼Œç„¶åè¾“å…¥CoolFormatï¼Œé€‰ä¸‹Formatter Settingsï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹é…ç½®:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  ;Pleasevisithttp://akof1314.github.io/CoolFormat/doc/index.htmlformoreinformation[SynTidy]C++=\u0026#34;\u0026#34;-A1-p-N-Y-k3\u0026#34;\u0026#34;Java=\u0026#34;\u0026#34;-A1-p-N-Y-k3\u0026#34;\u0026#34;C#=\u0026#34;\u0026#34;-A1-p-N-Y-k3\u0026#34;\u0026#34;Objective-C=\u0026#34;\u0026#34;-A1-p-N-Y-k3\u0026#34;\u0026#34;HTML=\u0026#34;\u0026#34;-aan-dep-fb-fbc-fu-js-ll-n-ox-pe-qa-qn-m-wa-wj-wp-ws-sw-fo-i0-d1-ce0-ie0-oe0-w0-sbo0\u0026#34;\u0026#34;XML=\u0026#34;\u0026#34;-aan-dep-fb-fbc-js-ll-n-ix-qa-qn-m-wa-wj-wp-ws-sw-fo-i1-ce0-ie0-oe0-w0\u0026#34;\u0026#34;PHP=\u0026#34;\u0026#34;-sas-icd-samt-salo-saeo-saro-sabo-saao-samp-aas-rsl-iel-rpc-rst-st\u0026#34;\u0026#34;JavaScript=\u0026#34;\u0026#34;-nb-cn4\u0026#34;\u0026#34;CSS=\u0026#34;\u0026#34;-c2-rub-cl0-os1-cc-cf-cfp0-rs2\u0026#34;\u0026#34;JSON=\u0026#34;\u0026#34;-cn3\u0026#34;\u0026#34;SQL=\u0026#34;\u0026#34;-cn2-el-ml0\u0026#34;\u0026#34;Verilog=\u0026#34;\u0026#34;-A1\u0026#34;\u0026#34;  å»ºç«‹å¿«æ·é”®\nè¿›å…¥èœå•é€‰Preferences-\u0026gt;Browse Packagesï¼Œç„¶åè¿›CoolFormatï¼Œé‡Œé¢æœ‰ä¸ªDefault.sublime-keymap\næ‰“å¼€åï¼Œé‡Œé¢æœ‰å¿«æ·æ–¹å¼çš„æŒ‰é”®,æ›´æ”¹å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9  [{\u0026#34;keys\u0026#34;: [\u0026#34;ctrl+q\u0026#34;], \u0026#34;command\u0026#34;: \u0026#34;coolformat\u0026#34;, \u0026#34;args\u0026#34;: {\u0026#34;action\u0026#34;: \u0026#34;quickFormat\u0026#34;}},{\u0026#34;keys\u0026#34;: [\u0026#34;ctrl+alt+shift+s\u0026#34;], \u0026#34;command\u0026#34;: \u0026#34;coolformat\u0026#34;, \u0026#34;args\u0026#34;: {\u0026#34;action\u0026#34;: \u0026#34;selectedFormat\u0026#34;}}]   è¿™æ ·ä»¥åå†™å®Œçš„ä»£ç ç›´æ¥æŒ‰ â€œCtrl+Qâ€ ä¾¿å¯ä»¥æ ¼å¼åŒ–ä»£ç \n å¦ä¸€ç§æ ¼å¼åŒ–ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13  ;Pleasevisithttp://akof1314.github.io/CoolFormat/doc/index.htmlformoreinformation[SynTidy]C++=\u0026#34;\u0026#34;-A2-p-N-Y-o-T-N-k3\u0026#34;\u0026#34;Java=\u0026#34;\u0026#34;-A1-p-N-T-Y-k3\u0026#34;\u0026#34;C#=\u0026#34;\u0026#34;-A1-p-N-Y-T-k3\u0026#34;\u0026#34;Objective-C=\u0026#34;\u0026#34;-A1-p-N-Y-k3\u0026#34;\u0026#34;HTML=\u0026#34;\u0026#34;-aan-dep-fb-fbc-fu-js-ll-n-ox-pe-qa-qn-m-wa-wj-wp-ws-sw-fo-i0-d1-ce0-ie0-oe0-w0-sbo0\u0026#34;\u0026#34;XML=\u0026#34;\u0026#34;-aan-dep-fb-fbc-js-ll-n-ix-qa-qn-m-wa-wj-wp-ws-sw-fo-i1-ce0-ie0-oe0-w0\u0026#34;\u0026#34;PHP=\u0026#34;\u0026#34;-sas-icd-samt-salo-saeo-saro-sabo-saao-samp-aas-rsl-iel-rpc-rst-st\u0026#34;\u0026#34;JavaScript=\u0026#34;\u0026#34;-nb-cn4\u0026#34;\u0026#34;CSS=\u0026#34;\u0026#34;-c2-rub-cl0-os1-cc-cf-cfp0-rs2\u0026#34;\u0026#34;JSON=\u0026#34;\u0026#34;-cn3\u0026#34;\u0026#34;SQL=\u0026#34;\u0026#34;-cn2-el-ml0\u0026#34;\u0026#34;  ","description":"","id":119,"section":"posts","tags":[""],"title":"MinGWåœ¨Windowsçš„ä½¿ç”¨","uri":"https://hugo.jiahongw.com/zh/posts/settings/mingw-use/"},{"content":"HUGO + Github + Github ActionæŒç»­é›†æˆéƒ¨ç½²ä¸ªäººåšå®¢\nHUGOæœ¬åœ°ç¯å¢ƒ é¦–å…ˆåœ¨HUGOçš„å®˜ç½‘ä¸‹è½½Hugoçš„Windowså®‰è£…åŒ…ï¼Œç„¶åå°†è·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡å³å¯ã€‚\nstep1:ä¸‹è½½hugo\nstep2:é…ç½®ç¯å¢ƒå˜é‡\nHUGOç«™ç‚¹é…ç½®åŠä¸»é¢˜é…ç½® åˆ›å»ºç«™ç‚¹ åœ¨ç›®å½•ä¸‹ç›´æ¥è¾“å…¥ä¸‹é¢çš„ä»£ç å³å¯åˆ›å»ºä¸€ä¸ªåä¸ºblogçš„hugoç«™ç‚¹(æ³¨æ„ï¼šæ–°å»ºçš„ç«™ç‚¹æ˜¯æ²¡æœ‰è‡ªå¸¦ä¸»é¢˜çš„)\n1  hugo new site blog   æˆ–è€…è¿›å…¥blogæ–‡ä»¶å¤¹å†…ç›´æ¥è¾“å…¥ä»¥ä¸‹è¯­å¥ï¼š\n1  hugo new site .   ä¸‹è½½ä¸»é¢˜ å¯ä»¥åœ¨hugo themeä¸‹è½½ä¸»é¢˜ï¼Œç„¶åæ ¹æ®ä¸»é¢˜çš„æ–‡æ¡£è¿›è¡Œé…ç½®\næ”¾åˆ°ç«™ç‚¹æ–‡ä»¶å¤¹themeså†…ï¼Œé…ç½®config.toml\næœ¬åœ°æµ‹è¯•è¿è¡Œ è¾“å…¥hugo serveræµ‹è¯•\nGithubé…ç½® åˆ›å»ºç«™ç‚¹ä»“åº“å¹¶ä¸”è®¾ç½®GithubPage å¯ä»¥åœ¨Settingä¸­çœ‹è§å¦‚ä¸‹ï¼š\nåˆ›å»ºä¸€ä¸ªå­˜å‚¨é¡¹ç›®çš„ä»“åº“ é…ç½®Github Action é¦–å…ˆåœ¨é¡¹ç›®ä»“åº“ç‚¹å‡»actionï¼Œé€‰æ‹©Simple workflowï¼Œè¾“å…¥ä¸€ä¸‹çš„é…ç½®ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  name:CI#è‡ªåŠ¨åŒ–çš„åç§°on:push:# pushçš„æ—¶å€™è§¦å‘branches:# é‚£äº›åˆ†æ”¯éœ€è¦è§¦å‘- masterjobs:build:runs-on:ubuntu-latest# é•œåƒå¸‚åœºsteps:- name:checkout# æ­¥éª¤çš„åç§°uses:actions/checkout@v1#è½¯ä»¶å¸‚åœºçš„åç§°with:# å‚æ•°submodules:true- name:SetupHugouses:peaceiris/actions-hugo@v2.2.2with:hugo-version:\u0026#39;0.64.1\u0026#39;extended:true- name:Buildrun:hugo-D- name:Deployuses:peaceiris/actions-gh-pages@v2.5.1env:ACTIONS_DEPLOY_KEY:${{secrets.ACTIONS_DEPLOY_KEY}}EXTERNAL_REPOSITORY:redisread/redisread.github.ioPUBLISH_BRANCH:masterPUBLISH_DIR:./public  å‡†å¤‡éƒ¨ç½²ï¼Œæˆ‘ä»¬å¼€å‘çš„é¡¹ç›®åŠgithub pageså®é™…æ˜¯åˆ†å¼€çš„ï¼Œä¸€ä¸ªç”¨äºä¿å­˜é¡¹ç›®ï¼Œç›¸å½“äºæºä»£ç ï¼Œå¦å¤–ä¸€ä¸ªç”¨äºä¿å­˜æœ€ç»ˆçš„ç½‘é¡µæ–‡ä»¶ã€‚\n  ä½¿ç”¨gitç”Ÿæˆssh key(ç›¸å½“äºç”Ÿæˆå¯¹å¯†é’¥)\n1 2 3 4  ssh-keygen -t rsa -b 4096 -C \u0026#34;$(git config user.email)\u0026#34; -f gh-pages -N \u0026#34;\u0026#34; # You will get 2 files: # gh-pages.pub (public key) # gh-pages (private key)    å‡è®¾ å¼€å‘é¡¹ç›®ä¸º HUGO_blog éƒ¨ç½²çš„é¡¹ç›®ä¸º redisread.github.io\n   æ‰“å¼€HUGO_blogä»“åº“çš„settingsï¼Œå†ç‚¹å‡»Secretsï¼Œç„¶åæ·»åŠ åˆšåˆšç”Ÿæˆçš„ç§é’¥ï¼Œnameä¸ºACTIONS_DEPLOY_KEY\n  åŒç†ï¼Œæ‰“å¼€redisread.github.ioï¼Œç‚¹å‡»Deploy keysï¼Œæ·»åŠ å…¬é’¥ï¼ŒAllow write accessä¸€å®šè¦å‹¾ä¸Šï¼Œå¦åˆ™ä¼šæ— æ³•æäº¤\n  ç„¶åï¼Œä½ å°±å¯ä»¥æäº¤ä»£ç äº†ï¼ŒpushæˆåŠŸåï¼Œæ‰“å¼€ä»“åº“actionsï¼Œè‡³æ­¤éƒ¨ç½²æˆåŠŸï¼Œå¤§åŠŸå‘Šæˆï¼\n","description":"Guide to set Hugo site.","id":120,"section":"posts","tags":["Hugo","Github"],"title":"Hugoé…ç½®","uri":"https://hugo.jiahongw.com/zh/posts/hugo/hugo_setup/"},{"content":"ä½¿ç”¨Github+PicGoå»ºç«‹ä¸€ä¸ªå…è´¹çš„ä¸ªäººå›¾åºŠã€‚\nPicGoä»‹ç» PicGoæ˜¯ä¸€æ¬¾å›¾ç‰‡ä¸Šä¼ çš„å·¥å…·ï¼Œç›®å‰æ”¯æŒå¾®åšå›¾åºŠï¼Œä¸ƒç‰›å›¾åºŠï¼Œè…¾è®¯äº‘ï¼Œåˆæ‹äº‘ï¼ŒGitHubç­‰å›¾åºŠ\nåœ¨Githubåˆ›å»ºå›¾åºŠ åˆ›å»ºRepository ç”Ÿæˆä¸€ä¸ªTokenç”¨äºæ“ä½œGitHub repository æ­¥éª¤å¦‚ä¸‹:\n{% note warning %}\næ³¨ï¼šåˆ›å»ºæˆåŠŸåï¼Œä¼šç”Ÿæˆä¸€ä¸²tokenï¼Œè¿™ä¸²tokenä¹‹åä¸ä¼šå†æ˜¾ç¤ºï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡çœ‹åˆ°çš„æ—¶å€™ï¼Œå°±è¦å¥½å¥½ä¿å­˜\n{% endnote %}\né…ç½®PicGo ä¸‹è½½PicGo Windowsç”¨æˆ·ä¸‹è½½exeæ–‡ä»¶\né…ç½®å›¾åºŠ    è®¾å®šä»“åº“åçš„æ—¶å€™ï¼Œæ˜¯æŒ‰ç…§â€œè´¦æˆ·å/ä»“åº“åçš„æ ¼å¼å¡«å†™â€\n  åˆ†æ”¯åç»Ÿä¸€å¡«å†™â€œmasterâ€\n  å°†ä¹‹å‰çš„Tokené»è´´åœ¨è¿™é‡Œ\n  å­˜å‚¨çš„è·¯å¾„å¯ä»¥æŒ‰ç…§æˆ‘è¿™æ ·å­å†™ï¼Œå°±ä¼šåœ¨repositoryä¸‹åˆ›å»ºä¸€ä¸ªâ€œimgâ€æ–‡ä»¶å¤¹\n  è‡ªå®šä¹‰åŸŸåçš„ä½œç”¨æ˜¯ï¼Œåœ¨ä¸Šä¼ å›¾ç‰‡åæˆåŠŸåï¼ŒPicGoä¼šå°†â€œè‡ªå®šä¹‰åŸŸå+ä¸Šä¼ çš„å›¾ç‰‡åâ€ç”Ÿæˆçš„è®¿é—®é“¾æ¥ï¼Œæ”¾åˆ°å‰ªåˆ‡æ¿ä¸Šhttps://raw.githubusercontent.com/ç”¨æˆ·å/RepositoryName/åˆ†æ”¯åï¼Œï¼Œè‡ªå®šä¹‰åŸŸåéœ€è¦æŒ‰ç…§è¿™æ ·å»å¡«å†™\n   å¿«æ·é”®åŠç›¸å…³é…ç½®  è¿™é‡Œé…ç½®ä¸Šä¼ å¿«æ·é”®ä¸ºctrl+shift+c\n ä½¿ç”¨ ç»è¿‡ä¸Šé¢çš„é…ç½®å°±å¤§åŠŸå‘Šæˆäº†ï¼Œæ¯æ¬¡æˆªå›¾ä¹‹åï¼Œåªéœ€è¦ctrl+shift+cä¸€ä¸‹å°±å¯ä»¥æŠŠå‰ªåˆ‡æ¿ä¸Šé¢çš„æˆªå›¾è½¬åŒ–ä¸ºåœ¨çº¿ç½‘ç»œå›¾ç‰‡é“¾æ¥ã€‚\n","description":"","id":121,"section":"posts","tags":["PicGo","Github","å›¾åºŠ"],"title":"é…ç½®åŸºäºGithubçš„PicGoå›¾åºŠ","uri":"https://hugo.jiahongw.com/zh/posts/settings/image-bed/"},{"content":"å†™åœ¨æºæ–‡ä»¶ä¸­çš„æºä»£ç æ˜¯äººç±»å¯è¯»çš„æºã€‚å®ƒéœ€è¦\u0026quot;ç¼–è¯‘\u0026rdquo;ï¼Œè½¬ä¸ºæœºå™¨è¯­è¨€ï¼Œè¿™æ · CPU å¯ä»¥æŒ‰ç»™å®šæŒ‡ä»¤æ‰§è¡Œç¨‹åºã€‚C è¯­è¨€ç¼–è¯‘å™¨ç”¨äºæŠŠæºä»£ç ç¼–è¯‘æˆæœ€ç»ˆçš„å¯æ‰§è¡Œç¨‹åºã€‚ğŸ¤\nå®‰è£… é¦–å…ˆ,åˆ°ï¼šhttps://sourceforge.net/projects/mingw-w64/files/latest/downloadï¼Œä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ MinGW å®‰è£…ç¨‹\nç„¶åï¼Œè¿è¡Œ Download mingw-get-setup.exe ,ç‚¹å‡»\u0026quot;è¿è¡Œ\u0026rdquo;ï¼Œcontinueç­‰ï¼Œæ³¨æ„è®°ä½å®‰è£…çš„ç›®å½•ï¼Œä¹‹åéœ€è¦é…ç½®ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚D:\\MinGW\\bin\nå‡å¦‚ç½‘é€Ÿä¸å¥½ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„é“¾æ¥è¿›è¡Œç¦»çº¿ä¸‹è½½ï¼Œä¸‹è½½å®Œæˆä¹‹åä½¿ç”¨7Zipè§£å‹ï¼Œç„¶åæŠŠè§£å‹çš„æ–‡ä»¶ç§»åŠ¨åˆ°å®‰è£…è·¯å¾„å³å¯ã€‚\nhttps://pan.baidu.com/s/1W4fHsUeaw1C9vp1lvRygbw\næ³¨ï¼šä½¿ç”¨è¿™ç§æ–¹å¼ä¸‹é¢çš„æ­¥éª¤ä¸éœ€è¦æ‰§è¡Œäº†ï¼Œå·²ç»åœ¨ç¦»çº¿åŒ…ä¸­é›†æˆäº†ã€‚å¯ç›´æ¥è¾“å…¥gcc -væŸ¥çœ‹gccç‰ˆæœ¬ã€‚\n éªŒè¯å®‰è£…ï¼š\nåœ¨å¼€å§‹èœå•ä¸­ï¼Œç‚¹å‡»\u0026quot;è¿è¡Œ\u0026rdquo;ï¼Œè¾“å…¥ cmd,æ‰“å¼€å‘½ä»¤è¡Œ:è¾“å…¥ mingw-get,å¦‚æœå¼¹å‡º MinGw installation manager çª—å£ï¼Œè¯´æ˜å®‰è£…æ­£å¸¸ï¼Œç„¶åå…³é—­çª—å£ã€‚\nå®‰è£…GCCç­‰ç¼–è¯‘å™¨ åœ¨cmdä¸­è¾“å…¥å¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š\nå®‰è£…gcc\n1  mingw-get install gcc   å®‰è£…g++\n1  mingw-get install g++   å®‰è£…gdb\n1  mingw-get install gdb   ä½¿ç”¨ åœ¨æ¡Œé¢åˆ›å»ºä¸€ä¸ªhello.cçš„ç¨‹åº\n1 2 3 4 5 6 7 8 9  #include \u0026lt;iostream\u0026gt;using namespace std; int main() { cout \u0026lt;\u0026lt; \u0026#34;Hello!\u0026#34; \u0026lt;\u0026lt; endl; return 0; }   åœ¨ cmd ä¸­è¾“å…¥å‘½ä»¤\n1  gcc hello.c   åœ¨å½“å‰ç›®å½•ä¸‹(è®°ä½æ˜¯å‘½ä»¤çš„å½“å‰ç›®å½•)ä¼šç”Ÿæˆ a.exe çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåœ¨ cmd ä¸­è¾“å…¥ a.exe å°±å¯ä»¥æ‰§è¡Œç¨‹åºäº†ã€‚\n","description":"","id":122,"section":"posts","tags":["gcc","MinGW"],"title":"windowsä¸‹gccçš„å®‰è£…å’Œä½¿ç”¨","uri":"https://hugo.jiahongw.com/zh/posts/settings/gcc-windows/"},{"content":"æˆ‘æ˜¯ä¸€ä¸ªä¸å¤Ÿä¸¥è°¨çš„ç¨‹åºå‘˜ğŸ™‰.\næˆ‘å–œæ¬¢ğŸ“–,è¿˜æœ‰ğŸ“.\næˆ–è®¸æœ‰æ—¶å€™æˆ‘æƒ³çš„ä¸å¤Ÿè¿œï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘æƒ³çš„å¾ˆæ·±å…¥ã€‚\næˆ‘æœ€å–œæ¬¢çš„ Aaron Swartz è¯­å½•:\n åœ¨é•¿å¤§çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ‰æ…¢æ…¢å‘ç°ï¼Œæˆ‘èº«è¾¹çš„æ‰€æœ‰äº‹ï¼Œåˆ«äººè·Ÿæˆ‘è¯´çš„æ‰€æœ‰äº‹ï¼Œé‚£äº›æ‰€è°“æœ¬æ¥å¦‚æ­¤ï¼Œæ³¨å®šå¦‚æ­¤çš„äº‹ï¼Œå®ƒä»¬å…¶å®æ²¡æœ‰éå¾—å¦‚æ­¤ï¼Œäº‹æƒ…æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæœ‰äº›äº‹æ—¢ç„¶é”™äº†ï¼Œé‚£å°±è¯¥åšå‡ºæ”¹å˜ã€‚\næˆ‘å¯¹å­¦æ ¡ååˆ†å¤±æœ›ï¼Œæˆ‘è§‰å¾—è€å¸ˆä»¬æ ¹æœ¬ä¸æ‡‚è‡ªå·±æ‰€è®²çš„æ˜¯ä»€ä¹ˆï¼Œä»–ä»¬å±…é«˜ä¸´ä¸‹ï¼Œç®¡è¿™ç®¡é‚£ï¼›ä½œä¸šå°±åƒæ˜¯ç§æŠŠæˆï¼Œå°±å¥½åƒçŸ¥è¯†ä¸€ç§å¼ºåˆ¶æ‰€æœ‰å­¦ç”Ÿä¸€èµ·åº¸åº¸ç¢Œç¢Œçš„æ‰‹æ®µã€‚äºæ˜¯æˆ‘å°±å¼€å§‹å»é˜…è¯»é‚£äº›å…³äºæ•™è‚²å²å’Œè¿™å¥—æ•™è‚²ä½“ç³»æ¼”å˜çš„ä¹¦ç±ã€‚ç„¶åä½ å°±èƒ½å‘ç°ï¼Œå¦‚æœè¦çœŸæ­£å­¦åˆ°ä¸œè¥¿ï¼Œé‚£å°±ä¸èƒ½æœºæ¢°é‡å¤è€å¸ˆæ‰€æ•™çš„ï¼Œè¿™æœ‰ç‚¹å„¿ä½¿å¾—æˆ‘æ¸æ¸å­¦ä¼šäº†è´¨ç–‘ã€‚æˆ‘è´¨ç–‘æˆ‘æ‰€ä¸Šçš„å­¦æ ¡ï¼Œæˆ‘è´¨ç–‘ç®€å†è¿™æ‰€å­¦æ ¡çš„è¿™ä¸ªç¤¾ä¼šï¼Œæˆ‘è´¨ç–‘å­¦æ ¡æ•™äººä»¬è¿½æ±‚çš„é‚£å¥—äº‹ç†ï¼Œæˆ‘è´¨ç–‘å»ºç«‹èµ·è¿™æ•´ä¸ªä½“ç³»çš„æ”¿åºœã€‚\næˆ‘æ€»æ˜¯æ·±å…¥æ€è€ƒï¼Œæˆ‘å¸Œæœ›åˆ«äººä¹Ÿèƒ½æƒ³è¿œä¸€ç‚¹ã€‚æˆ‘ä¸ºç†æƒ³è€Œå·¥ä½œï¼Œå¹¶ä»åˆ«äººèº«ä¸Šå­¦ä¹ ï¼Œæˆ‘ä¸å–œæ¬¢æ‹’äººäºå¤–ã€‚æˆ‘æ˜¯ä¸ªå®Œç¾ä¸»ä¹‰è€…ï¼Œä½†æˆ‘ä¸ä¼šè¦æ±‚å‡ºç‰ˆç•Œä¹Ÿç²¾ç›Šæ±‚ç²¾ã€‚é™¤äº†æ•™è‚²å’Œå¨±ä¹ä»¥å¤–ï¼Œæˆ‘ä¸ä¼šæµªè´¹æ—¶é—´åœ¨é‚£äº›ä¸ä¼šæœ‰å½±å“çš„äº‹æƒ…ä¸Šã€‚æˆ‘è¯•ç€å’Œæ¯ä¸ªäººéƒ½å‹å¥½ç›¸å¤„ï¼Œä½†æˆ‘è®¨åŒäººä»¬ä¸è®¤çœŸå¯¹å¾…æˆ‘ã€‚æˆ‘ä¸è®°æ¨ä»–äººï¼Œå› ä¸ºè¿™äºåˆ›é€ æ— ç›Šã€‚ä½†æˆ‘ä»è‡ªèº«ç»å†ä¸­å­¦ä¹ ï¼Œæˆ‘æƒ³è®©ä¸–ç•Œå˜å¾—æ›´ç¾å¥½ã€‚\næˆ‘æ·±æ·±åœ°è§‰å¾—ï¼Œå…‰å®‰ç”Ÿä¸å½“ä¸‹è¿™ä¸–ç•Œæ˜¯ä¸å¤Ÿçš„ï¼Œé‚£æ ·å­çŸ¥è¯†åˆ«äººç»™ä»€ä¹ˆä½ å°±ç…§æ”¶ï¼Œå¤§äººä»¬è¯´ä»€ä¹ˆä½ å°±ç…§åšï¼Œä½ ç…§ç€çˆ¶æ¯è¯´çš„å»åšï¼Œç…§ç€ç¤¾ä¼šè¯´çš„å»åšã€‚æˆ‘è§‰å¾—ä½ åº”è¯¥æ€»æŒæœ‰è´¨ç–‘ï¼Œæˆ‘è§‰å¾—ä»ç§‘å­¦çš„è§’åº¦çœ‹ï¼Œä½ æ‰€å­¦çš„ä¸€åˆ‡éƒ½çŸ¥è¯†æš‚æ—¶æ€§çš„ï¼Œä»»ä½•æ‰€å­¦éƒ½æœ‰æ”¹å£ã€é©³æ–¥ã€è´¨ç–‘çš„ä½™åœ°ã€‚æˆ‘è§‰å¾—è¿™æƒ…å†µå¯¹ç¤¾ä¼šä¹Ÿé€‚ç”¨ã€‚å½“æˆ‘æ„è¯†åˆ°ç¤¾ä¼šä¸Šæœ‰ç€æˆ‘èƒ½å°½ä»½åŠ›å»è§£å†³çš„çœŸæ­£ä¸¥é‡çš„ã€åŸºç¡€æ€§çš„é—®é¢˜æ—¶ï¼Œæˆ‘æ²¡æ³•å»é—å¿˜å®ƒã€å›é¿å®ƒã€‚\n ","description":"Zzo about page","id":123,"section":"","tags":null,"title":"About","uri":"https://hugo.jiahongw.com/zh/about/"},{"content":"ç›’å­ æ”¯æŒMarkdownè¯­æ³•çš„ç›’å­ è¯­æ³•ï¼š\næˆ–è€…ï¼š\n1  \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;This is \u0026lt;strong\u0026gt;boxmd\u0026lt;/strong\u0026gt; shortcode\u0026lt;/div\u0026gt;   æ¸²æŸ“æ˜¾ç¤ºï¼š\nThis is boxmd shortcode ç®€å•ç›’å­ è¯­æ³•ï¼š\næ¸²æŸ“æ˜¾ç¤ºï¼š\nThis is **box** shortcode  ä»£ç é€‰é¡¹å¡ å¯ä»¥åœ¨ä¸åŒçš„ä»£ç å—ä¹‹é—´åˆ‡æ¢ï¼Œè¯­æ³•ï¼š\næ¸²æŸ“æ˜¾ç¤ºï¼š\njava javascript  1  System.out.println(\u0026#39;Hello World!\u0026#39;);     1  console.log(\u0026#39;Hello World!\u0026#39;);       'use strict'; var containerId = JSON.parse(\"\\\"bbfc6d359a06a39f\\\"\"); var containerElem = document.getElementById(containerId); var codetabLinks = null; var codetabContents = null; var ids = []; if (containerElem) { codetabLinks = containerElem.querySelectorAll('.codetab__link'); codetabContents = containerElem.querySelectorAll('.codetab__content'); } for (var i = 0; i 0) { codetabContents[0].style.display = 'block'; }  å¸¸è§„é€‰é¡¹å¡ è¿™ä¸ªå’Œä»£ç é€‰é¡¹å¡ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ï¼Œè¿™ç§é€‰é¡¹å¡æ›´åŠ â€œå¸¸è§„â€ã€‚è¯­æ³•ï¼š\næ¸²æŸ“æ˜¾ç¤ºï¼š\nWindows MacOS Ubuntu  Windows section 1  console.log(\u0026#39;Hello World!\u0026#39;);   âš ï¸Becareful that the content in the tab should be different from each other. The tab makes unique id hashes depending on the tab contents. So, If you just copy-paste the tabs with multiple times, since it has the same contents, the tab will not work.\n MacOS section Hello world!  Ubuntu section Great!    'use strict'; var containerId = JSON.parse(\"\\\"f09fb25fccaa3686\\\"\"); var containerElem = document.getElementById(containerId); var tabLinks = null; var tabContents = null; var ids = []; if (containerElem) { tabLinks = containerElem.querySelectorAll('.tab__link'); tabContents = containerElem.querySelectorAll('.tab__content'); } for (var i = 0; i 0) { tabContents[0].style.display = 'block'; }  å±•å¼€æ  è¯­æ³•ï¼š\næ¸²æŸ“æ˜¾ç¤ºï¼š\n  Expand me  Title contents     Expand me2  Title2 contents2   å½©è‰²æ–‡æœ¬æ¡† è¯­æ³•ï¼š\næ¸²æŸ“æ˜¾ç¤ºï¼š\nthis is a text this is a text this is a text this is a text å½©è‰²æ³¨æ„æ¡† è¯­æ³•ï¼š\næ¸²æŸ“æ˜¾ç¤ºï¼š\nsuccess text  info text  warning text  error text  å›¾ç‰‡æè¿° ä½¿ç”¨è¯­æ³•ï¼š\næ¸²æŸ“æ˜¾ç¤ºï¼š\n Sample Image: Image with title, caption, alt, ...   æŒ‰é’® è¯­æ³•ï¼š\nç®€å•æŒ‰é’®ï¼š\nbutton   è®¾ç½®å®½åº¦é«˜åº¦ï¼š\nbutton   è®¾ç½®é¢œè‰²ï¼š\nbutton   ","description":"tabs, code-tabs, expand, alert, warning, notice, img, box","id":124,"section":"posts","tags":["shortcode"],"title":"Shortcodesä½¿ç”¨","uri":"https://hugo.jiahongw.com/zh/posts/hugo/shortcodes/"},{"content":"A Short Videoï¼š  â€”â€”ä»¥ä¸‹ Aaron Swartzçš„å®£è¨€ï¼Œæˆ‘æƒ³è¿™æ‰æ˜¯ä¿¡æ¯é©å‘½çš„çœŸè°›â€”â€”\nä¿¡æ¯å°±æ˜¯åŠ›é‡ã€‚ä½†å°±åƒæ‰€æœ‰åŠ›é‡ä¸€æ ·ï¼Œæœ‰äº›äººåªæƒ³å ä¸ºå·±æœ‰ã€‚ä¸–ç•Œä¸Šæ‰€æœ‰çš„ç§‘å­¦å’Œæ–‡åŒ–é—äº§ï¼Œå·²åœ¨ä¹¦ç±å’ŒæœŸåˆŠä¸Šå‘å¸ƒäº†æ•°ä¸ªä¸–çºªï¼Œæ­£æ¸æ¸åœ°è¢«å°‘æ•°ç§æœ‰çš„å…¬å¸æ•°å­—åŒ–å¹¶ä¸Šé”ã€‚æƒ³è¦é˜…è¯»é‚£äº›æœ‰ç€æœ€è‘—åç ”ç©¶æˆæœçš„è®ºæ–‡ï¼Ÿä½ å¿…é¡»æ”¯ä»˜ç»™å¦‚ Reed Elsevier è¿™æ ·çš„å‡ºç‰ˆå•†å¤§æŠŠé’±ã€‚\næœ‰äººåŠªåŠ›å»æ”¹å˜è¿™ç§çŠ¶å†µã€‚å¼€æ”¾è®¿é—®è¿åŠ¨ (Open Access Movement) å¥‹å‹‡æ–—äº‰ï¼Œç¡®ä¿ç§‘å­¦å®¶ä»¬æ²¡æœ‰å°†ä»–ä»¬çš„ç‰ˆæƒç­¾ç½²ç»™åˆ«äººï¼Œè€Œæ˜¯å°†ä»–ä»¬çš„æˆæœå‘å¸ƒåˆ°ç½‘ç»œä¸Šï¼Œå…è®¸ä»»ä½•äººè®¿é—®å®ƒä»¬ã€‚ä½†å³ä¾¿æ˜¯æœ€å¥½çš„æƒ…å†µï¼Œä»–ä»¬çš„è¡Œä¸ºä¹Ÿåªä½œç”¨äºæœªæ¥å‘å¸ƒçš„ä¸œè¥¿ã€‚ä¹‹å‰çš„éƒ½å°†å¤±å»ã€‚\nè¿™æ ·çš„ä»£ä»·å®åœ¨å¤ªé«˜ã€‚å¼ºåˆ¶å­¦è€…ä»˜é’±ä»¥é˜…è¯»ä»–ä»¬åŒè¡Œçš„æˆæœï¼Ÿæ‰«ææ•´ä¸ªå›¾ä¹¦é¦†å´åªå…è®¸ Google çš„äººé˜…è¯»å®ƒä»¬ï¼Ÿæä¾›ç§‘å­¦æ–‡ç« ç»™é‚£äº›ç¬¬ä¸€ä¸–ç•Œçš„ç²¾è‹±å¤§å­¦ï¼Œå´ä¸ç»™èº«åœ¨å—åŠçƒçš„å„¿ç«¥ï¼Ÿè¿™å®åœ¨è›®æ¨ªä¸”æ— æ³•æ¥å—ã€‚\nâ€œæˆ‘åŒæ„ï¼Œâ€æœ‰äº›äººå°±è¯´äº†ï¼Œâ€œä½†æ˜¯æˆ‘ä»¬èƒ½åšä»€ä¹ˆå‘¢ï¼Ÿé‚£äº›å…¬å¸æ¡æœ‰ç‰ˆæƒï¼Œä»–ä»¬é é™åˆ¶è®¿é—®èµšå–å¤§æŠŠçš„é’±ï¼Œè€Œä¸”è¿™æ˜¯å®Œå…¨åˆæ³•çš„ - æˆ‘ä»¬æ²¡æœ‰åŠæ³•é˜»æ­¢ä»–ä»¬ã€‚â€ä½†æœ‰äº›äº‹æˆ‘ä»¬èƒ½åšï¼Œè¿™äº›äº‹æˆ‘ä»¬å·²ç»åœ¨åšï¼šæˆ‘ä»¬å¯ä»¥åå‡»ã€‚\né‚£äº›èƒ½å¤Ÿè®¿é—®è¿™äº›èµ„æºçš„äºº - å­¦ç”Ÿï¼Œå›¾ä¹¦ç®¡ç†å‘˜ï¼Œç§‘å­¦å®¶ - ä½ ä»¬è¢«èµ‹äºˆäº†ç‰¹æƒã€‚ä½ ä»¬èƒ½äº«å—åˆ°è¿™çŸ¥è¯†çš„ç››å®´ï¼Œè€Œå…¶ä»–äººå´è¢«æ’é™¤åœ¨å¤–ã€‚ä½†æ˜¯ä½ ä»¬ä¸å¿… - äº‹å®ä¸Šï¼Œä»é“ä¹‰å±‚é¢æ¥è¯´ï¼Œä½ ä»¬ä¸èƒ½ - ä¸ºä¿ç•™è‡ªå·±ä¿ç•™è¿™ä»½ç‰¹æƒã€‚ä½ ä»¬æœ‰ä¹‰åŠ¡å’Œå…¨ä¸–ç•Œåˆ†äº«å®ƒã€‚è€Œä¸”ä½ ä»¬å·²ç»åœ¨åšäº†ï¼šå’ŒåŒè¡Œä»¬äº¤æ¢å¯†ç ï¼Œå›åº”æœ‹å‹ä»¬çš„ä¸‹è½½è¯·æ±‚ã€‚\nåŒæ—¶ï¼Œé‚£äº›è¢«æ‹’ä¹‹é—¨å¤–çš„äººä»¬å¹¶æ²¡æœ‰è¢–æ‰‹æ—è§‚ã€‚ä½ ä»¬æºœè¿‡æ´ç©´ï¼Œç¿»è¶Šå›´å¢™ï¼Œè§£æ”¾é‚£äº›è¢«å‡ºç‰ˆå•†å°é”çš„ä¿¡æ¯å¹¶åˆ†äº«ç»™ä½ çš„æœ‹å‹ä»¬ã€‚\nä½†æ‰€æœ‰è¿™äº›è¡ŒåŠ¨éƒ½æ˜¯åœ¨é»‘æš—ä¸­è¿›è¡Œï¼Œéšè—äºåœ°åº•ã€‚å®ƒä»¬è¢«ç§°ä½œå·çªƒæˆ–ç›—ç‰ˆï¼Œä»¿ä½›åˆ†äº«å¤§é‡çš„çŸ¥è¯†ç²¾ç¥ä¸Šç­‰åŒäºæŠ¢åŠ«ä¸€è‰˜èˆ¹åªå¹¶è°‹æ€å…¶èˆ¹å‘˜ã€‚ä½†æ˜¯åˆ†äº«ç»éä¸é“å¾·çš„ï¼Œå®ƒæ˜¯ä¸€ç§é“å¾·ä½¿å‘½ã€‚åªæœ‰é‚£äº›åˆ©æ¬²ç†å¿ƒçš„äººæ‰ä¼šæ‹’ç»è®©æœ‹å‹å¤åˆ¶ä¸€ä»½ã€‚\nå¤§å…¬å¸ï¼Œå½“ç„¶ï¼Œå°±æ˜¯åˆ©æ¬²ç†å¿ƒã€‚ä½¿å®ƒä»¬è¿è½¬çš„æ³•å¾‹è¦æ±‚ä½¿ç„¶ - ç¨å¾®å‡ºç‚¹äº‹æŠ•èµ„äººå°±å¾—å›ä¹±ã€‚å®ƒä»¬æ”¶ä¹°çš„æ”¿æ²»å®¶ä»¬æ”¯æŒå®ƒä»¬ï¼Œé€šè¿‡æ³•æ¡ˆè®©å®ƒä»¬æ‹¥æœ‰ä¸“å±çš„æƒåŠ›å†³å®šè°å¯ä»¥å¤åˆ¶ã€‚\néµä»ä¸å…¬æ­£çš„æ³•å¾‹ä¸ä¼šå¸¦æ¥å…¬æ­£ã€‚æ­¥å…¥å…‰æ˜çš„æ—¶å€™åˆ°äº†ï¼Œåœ¨å…¬æ°‘ä¸æœä»çš„ä¼Ÿå¤§ä¼ ç»Ÿä¸‹ï¼Œå®£å‘Šæˆ‘ä»¬å¯¹è¿™ç§ç§äººç›—çªƒå…¬å…±æ–‡åŒ–çš„åæŠ—ã€‚\næˆ‘ä»¬è¦å¤ºå›ä¿¡æ¯ï¼Œæ— è®ºå®ƒä»¬è¢«å­˜åœ¨ä½•å¤„ï¼Œåˆ¶ä½œæˆ‘ä»¬çš„å‰¯æœ¬å¹¶å’Œå…¨ä¸–ç•Œåˆ†äº«ã€‚æˆ‘ä»¬è¦å–åˆ°ç‰ˆæƒåˆ°æœŸçš„ä¸œè¥¿å¹¶å°†å®ƒä»¬å½’æ¡£ï¼Œæˆ‘ä»¬è¦ä¹°ä¸‹ç§˜å¯†çš„èµ„æ–™åº“å¹¶å°†å®ƒä»¬æ”¾åˆ°ç½‘ä¸Šã€‚æˆ‘ä»¬è¦ä¸‹è½½ç§‘å­¦æœŸåˆŠå¹¶å°†å®ƒä»¬ä¸Šä¼ åˆ°æ–‡ä»¶åˆ†äº«ç½‘ç»œã€‚æˆ‘ä»¬è¦ä¸ºæ¸¸å‡»é˜Ÿå¼€æ”¾è®¿é—®è€Œæˆ˜ã€‚\nåªè¦å…¨ä¸–ç•Œæœ‰è¶³å¤Ÿå¤šçš„æˆ‘ä»¬ï¼Œé‚£å°±ä¸ä»…æ˜¯ä¼ è¾¾äº†ä¸€ä¸ªåå¯¹çŸ¥è¯†ç§æœ‰åŒ–çš„å¼ºæœ‰åŠ›ä¿¡å·ï¼Œæˆ‘ä»¬è¿˜å°†è®©å®ƒæˆä¸ºè¿‡å»ã€‚ä½ æ„¿æ„å’Œæˆ‘ä»¬ä¸€èµ·å—ï¼Ÿ\näºšä¼¦Â·æ–¯æ²ƒèŒ¨ (Aaron Swartz)\n2008 å¹´ 7 æœˆï¼Œæ„å¤§åˆ© Eremo\nInformation is power. But like all power, there are those who want to keep it for themselves. The world\u0026rsquo;s entire scientific and cultural heritage, published over centuries in books and journals, is increasingly being digitized and locked up by a handful of private corporations. Want to read the papers featuring the most famous results of the sciences? You\u0026rsquo;ll need to send enormous amounts to\npublishers like Reed Elsevier.\nThere are those struggling to change this. The Open Access Movement has fought valiantly to ensure that scientists do not sign their copyrights away but instead ensure their work is published on the Internet, under terms that allow anyone to access it. But even under the best scenarios, their work will only apply to things published in the future. Everything up until now will have been lost.\nThat is too high a price to pay. Forcing academics to pay money to read the work of their colleagues? Scanning entire libraries but only allowing the folks at Google to read them? Providing scientific articles to those at elite universities in the First World, but not to children in the Global South? It\u0026rsquo;s outrageous and unacceptable.\n\u0026ldquo;I agree,\u0026rdquo; many say, \u0026ldquo;but what can we do? The companies hold the copyrights, they make enormous amounts of money by charging for access, and it\u0026rsquo;s perfectly legal - there\u0026rsquo;s nothing we can do to stop them.\u0026rdquo; But there is something we can, something that\u0026rsquo;s already being done: we can fight back.\nThose with access to these resources - students, librarians, scientists - you have been given a privilege. You get to feed at this banquet of knowledge while the rest of the world is locked out. But you need not - indeed, morally, you cannot - keep this privilege for yourselves. You have a duty to share it with the world. And you have: trading passwords with colleagues, filling download requests for friends.\nMeanwhile, those who have been locked out are not standing idly by. You have been sneaking through holes and climbing over fences, liberating the information locked up by the publishers and sharing them with your friends.\nBut all of this action goes on in the dark, hidden underground. It\u0026rsquo;s called stealing or piracy, as if sharing a wealth of knowledge were the moral equivalent of plundering a ship and murdering its crew. But sharing isn\u0026rsquo;t immoral - it\u0026rsquo;s a moral imperative. Only those blinded by greed would refuse to let a friend make a copy.\nLarge corporations, of course, are blinded by greed. The laws under which they operate require it - their shareholders would revolt at anything less. And the politicians they have bought off back them, passing laws giving them the exclusive power to decide who can make copies.\nThere is no justice in following unjust laws. It\u0026rsquo;s time to come into the light and, in the grand tradition of civil disobedience, declare our opposition to this private theft of public culture.\nWe need to take information, wherever it is stored, make our copies and share them with the world. We need to take stuff that\u0026rsquo;s out of copyright and add it to the archive. We need to buy secret databases and put them on the Web. We need to download scientific journals and upload them to file sharing networks. We need\nto fight for Guerilla Open Access.\nWith enough of us, around the world, we\u0026rsquo;ll not just send a strong message opposing the privatization of knowledge - we\u0026rsquo;ll make it a thing of the past.\nWill you join us?\nAaron Swartz\nJuly 2008, Eremo, Italy\n","description":"","id":125,"section":"talks","tags":[""],"title":"My Awesome links","uri":"https://hugo.jiahongw.com/zh/talks/mylinks/"},{"content":"Sample images about life.\n","description":"my gallery","id":127,"section":"gallery","tags":[""],"title":"life","uri":"https://hugo.jiahongw.com/zh/gallery/life/"},{"content":"between 70 and 240 in movies\ngood moviesï¼ğŸ¥\n","description":"my gallery","id":128,"section":"gallery","tags":[""],"title":"movie","uri":"https://hugo.jiahongw.com/zh/gallery/movie/"},{"content":"ä¸€ä¸ªæµ‹è¯•è§†é¢‘:  ","description":"","id":132,"section":"talks","tags":[""],"title":"Bç«™è§†é¢‘","uri":"https://hugo.jiahongw.com/zh/talks/blibli/"}]