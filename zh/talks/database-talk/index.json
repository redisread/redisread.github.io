[{"content":"å“ˆå¤«æ›¼ç¼–ç ç®—æ³•ç”¨å­—ç¬¦åœ¨æ–‡ä»¶ä¸­å‡ºç°çš„é¢‘ç‡è¡¨æ¥å»ºç«‹ä¸€ä¸ªç”¨0ï¼Œ1ä¸²è¡¨ç¤ºå„å­—ç¬¦çš„æœ€ä¼˜è¡¨ç¤ºæ–¹å¼ã€‚ç»™å‡ºç°é¢‘ç‡é«˜çš„å­—ç¬¦è¾ƒçŸ­çš„ç¼–ç ï¼Œå‡ºç°é¢‘ç‡è¾ƒä½çš„å­—ç¬¦ä»¥è¾ƒé•¿çš„ç¼–ç ï¼Œå¯ä»¥å¤§å¤§ç¼©çŸ­æ€»ç é•¿ã€‚\nHuffman Codingä¸¤ä¸ªæ­¥éª¤  ç¼–ç (ä»è¾“å…¥çš„å­—ç¬¦æ•°æ®æ„å»ºä¸€é¢—å“ˆå¤«æ›¼æ ‘ï¼Œå¹¶å°†å­—ç¬¦ä¸²è½¬åŒ–ä½01ç¼–ç ) è§£ç (éå†å“ˆå¤«æ›¼æ ‘å°†01ç¼–ç è½¬åŒ–ä¸ºå­—ç¬¦)  æ„å»ºå“ˆå¤«æ›¼æ ‘çš„è¿‡ç¨‹  è®¡ç®—è¾“å…¥æ•°æ®çš„æ¯ä¸€ä¸ªå­—ç¬¦çš„å‡ºç°é¢‘ç‡ã€‚ ä»æœ€å°å †ä¸­æå–ä¸¤ä¸ªé¢‘ç‡æœ€å°çš„å­—ç¬¦ã€‚ åˆ›å»ºä¸€ä¸ªé¢‘ç‡ç­‰äºä¸¤ä¸ªèŠ‚ç‚¹é¢‘ç‡ä¹‹å’Œçš„æ–°å†…éƒ¨èŠ‚ç‚¹ã€‚ä½¿ç¬¬ä¸€ä¸ªæå–çš„èŠ‚ç‚¹ä¸ºå…¶å·¦å­èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªæå–çš„èŠ‚ç‚¹ä¸ºå…¶å³å­èŠ‚ç‚¹ã€‚å°†æ­¤èŠ‚ç‚¹æ·»åŠ åˆ°æœ€å°å †ä¸­ã€‚ é‡å¤step2å’Œstep3ç›´åˆ°æœ€å°å †ä¸ºç©ºã€‚  å‡å¦‚æœ‰å¦‚ä¸‹å‡ ä¸ªå­—æ¯åŠå®ƒä»¬å‡ºç°çš„æ¬¡æ•°(é¢‘ç‡):\n   å­—ç¬¦ å­—æ•°     a 5   b 4   c 3   d 2   e 1    åœ¨çº¿æ¼”ç¤ºéœå¤«æ›¼æ ‘çš„æ„å»ºï¼šhttps://people.ok.ubc.ca/ylucet/DS/Huffman.html\nC++ä½¿ç”¨STLå®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110  // C++ program for Huffman Coding #include \u0026lt;bits/stdc++.h\u0026gt; using namespace std; // A Huffman tree node struct MinHeapNode { // One of the input characters \tchar data; // Frequency of the character \tunsigned freq; // Left and right child \tMinHeapNode *left, *right; MinHeapNode(char data, unsigned freq) { left = right = NULL; this-\u0026gt;data = data; this-\u0026gt;freq = freq; } }; // For comparison of // two heap nodes (needed in min heap) struct compare { bool operator()(MinHeapNode* l, MinHeapNode* r) { return (l-\u0026gt;freq \u0026gt; r-\u0026gt;freq); } }; // Prints huffman codes from // the root of Huffman Tree. void printCodes(struct MinHeapNode* root, string str) { if (!root) return; if (root-\u0026gt;data != \u0026#39;$\u0026#39;) cout \u0026lt;\u0026lt; root-\u0026gt;data \u0026lt;\u0026lt; \u0026#34;: \u0026#34; \u0026lt;\u0026lt; str \u0026lt;\u0026lt; \u0026#34;\\n\u0026#34;; printCodes(root-\u0026gt;left, str + \u0026#34;0\u0026#34;); printCodes(root-\u0026gt;right, str + \u0026#34;1\u0026#34;); } // The main function that builds a Huffman Tree and // print codes by traversing the built Huffman Tree void HuffmanCodes(char data[], int freq[], int size) { struct MinHeapNode *left, *right, *top; // Create a min heap \u0026amp; inserts all characters of data[] \tpriority_queue\u0026lt;MinHeapNode*, vector\u0026lt;MinHeapNode*\u0026gt;, compare\u0026gt; minHeap; for (int i = 0; i \u0026lt; size; ++i) minHeap.push(new MinHeapNode(data[i], freq[i])); // Iterate while size of heap doesn\u0026#39;t become 1 \twhile (minHeap.size() != 1) { // Extract the two minimum \t// freq items from min heap \tleft = minHeap.top(); minHeap.pop(); right = minHeap.top(); minHeap.pop(); // Create a new internal node with \t// frequency equal to the sum of the \t// two nodes frequencies. Make the \t// two extracted node as left and right children \t// of this new node. Add this node \t// to the min heap \u0026#39;$\u0026#39; is a special value \t// for internal nodes, not used \ttop = new MinHeapNode(\u0026#39;$\u0026#39;, left-\u0026gt;freq + right-\u0026gt;freq); top-\u0026gt;left = left; top-\u0026gt;right = right; minHeap.push(top); } // Print Huffman codes using \t// the Huffman tree built above \tprintCodes(minHeap.top(), \u0026#34;\u0026#34;); } // Driver program to test above functions int main() { char arr[] = { \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;f\u0026#39; }; int freq[] = { 5, 9, 12, 13, 16, 45 }; int size = sizeof(arr) / sizeof(arr[0]); HuffmanCodes(arr, freq, size); return 0; } // This code is contributed by Aditya Goel   Reference:\n å“ˆå¤«æ›¼ç¼–ç çš„ç†è§£(Huffman Coding) å“ˆå¤«æ›¼ç¼–ç  Huffman Coding | Greedy Algo-3  ","description":"å“ˆå¤«æ›¼ç¼–ç ç®—æ³•ç”¨å­—ç¬¦åœ¨æ–‡ä»¶ä¸­å‡ºç°çš„é¢‘ç‡è¡¨æ¥å»ºç«‹ä¸€ä¸ªç”¨0ï¼Œ1ä¸²è¡¨ç¤ºå„å­—ç¬¦çš„æœ€ä¼˜è¡¨ç¤ºæ–¹å¼ã€‚","id":2,"section":"posts","tags":["huffman"],"title":"Huffman Treeæ˜¯å¦‚ä½•ç¼–ç çš„ï¼Ÿ","uri":"https://hugo.jiahongw.com/zh/posts/algorithmstructure/huffman-coding/"},{"content":"å‚è€ƒåœ°å€ï¼š\n cloudflare.com ä½¿ç”¨Cloudflareå’ŒNginxæ¥æ‰˜ç®¡ç½‘ç«™ ç®¡ç† Cloudflare Origin CA è¯ä¹¦ å·²å®‰è£…nginxæ”¯æŒhttpsé…ç½® nginxå¯åŠ¨ã€é‡å¯ã€å…³é—­ nginxé…ç½®sslå®ç°httpsè®¿é—®  ç‚¹å‡»SSL/TLSï¼Œå¹¶ä¸”ç‚¹å‡»æºæœåŠ¡å™¨\nè¿›å…¥ä¸‹é¢çš„é¡µé¢ï¼Œç‚¹å‡»ä¸‹é¢çš„åˆ›å»ºè¯ä¹¦ï¼Œæ¥ä¸‹æ¥æŒ‰ç…§ä¸‹é¢é“¾æ¥çš„æŒ‡å¯¼è¿›è¡Œæ“ä½œï¼š\nä½¿ç”¨Cloudflareå’ŒNginxæ¥æ‰˜ç®¡ç½‘ç«™\nåŒæ—¶åœ¨NginxæœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶nginx.confä¸­è®¾ç½®ç›¸å…³çš„é…ç½®\nnginxé…ç½®sslå®ç°httpsè®¿é—®\nå‡å¦‚Nginxæç¤ºthe \u0026quot;ssl\u0026quot; parameter requires ngx_http_ssl_module,è¡¨ç¤ºNginxæ²¡æœ‰å®‰è£…SSLæ¨¡å—ï¼ŒæŒ‰ç…§ä¸‹é¢çš„é“¾æ¥æŒ‡å¯¼è¿›è¡Œæ“ä½œ\nå·²å®‰è£…nginxæ”¯æŒhttpsé…ç½®\næ¥ä¸‹æ¥åœ¨CloudFlareä¸­è®¾ç½®å®Œå…¨ä¸¥æ ¼\næœ€åå°±å¯ä»¥çœ‹åˆ°å°é”å¤´å•¦\n","description":"ä½¿ç”¨Nginxé…åˆCloudFlareè®¾ç½®æœåŠ¡å™¨ä½¿ç”¨Httpsè¯ä¹¦ã€‚","id":3,"section":"posts","tags":["Nginx","https"],"title":"CloudFlare+Nginxé…ç½®HTTPSè¿æ¥","uri":"https://hugo.jiahongw.com/zh/posts/settings/https-set/"},{"content":"ğŸ‚ HTTPæŠ¥æ–‡ è¯·æ±‚æŠ¥æ–‡ HTTP è¯·æ±‚æŠ¥æ–‡ç”±3éƒ¨åˆ†ç»„æˆ(è¯·æ±‚è¡Œ+è¯·æ±‚å¤´+è¯·æ±‚ä½“)\nè¯·æ±‚è¡ŒåŒ…æ‹¬ï¼šè¯·æ±‚æ–¹æ³•ã€è¯·æ±‚URLã€HTTPåè®®åŠç‰ˆæœ¬ï¼š\nGETå’ŒPOSTæ˜¯æœ€å¸¸è§çš„HTTPæ–¹æ³•,åˆæ¬¡ä»¥å¤–è¿˜åŒ…æ‹¬ DELETEã€HEADã€OPTIONSã€PUTã€TRACEï¼Œä¸è¿‡ç°åœ¨å¤§éƒ¨åˆ†çš„æµè§ˆå™¨åªæ”¯æŒGETå’ŒPOST\nè¯·æ±‚å¯¹åº”çš„URLåœ°å€,ä»–å’ŒæŠ¥æ–‡å¤´çš„Hostå±æ€§,ç»„åˆèµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚URL\næŠ¥æ–‡å¤´æ˜¯ä¸€äº›å‚æ•°ä¿¡æ¯ï¼š\næœ‰è‹¥å¹²ä¸ªå±æ€§,å½¢å¼ä¸ºkey:val,æœåŠ¡ç«¯æ®æ­¤è·å–å®¢æˆ·ç«¯ä¿¡æ¯\næŠ¥æ–‡ä½“æ˜¯å…·ä½“ä¼ è¾“çš„å†…å®¹ã€‚\nå“åº”æŠ¥æ–‡ å“åº”æŠ¥æ–‡ä¸è¯·æ±‚æŠ¥æ–‡ä¸€æ ·,ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ(å“åº”è¡Œ,å“åº”å¤´,å“åº”ä½“)\nå‚è€ƒï¼šHTTPè¯·æ±‚å¤´å’Œå“åº”å¤´è¯¦è§£\nğŸš‰ HTTPçŠ¶æ€ç ï¼š  1xxï¼šè¡¨ç¤ºé€šçŸ¥ä¿¡æ¯ï¼Œå¦‚è¯·æ±‚æ”¶åˆ°äº†æˆ–æ­£åœ¨è¿›è¡Œå¤„ç†  100 Continueï¼šç»§ç»­ï¼Œå®¢æˆ·ç«¯åº”ç»§ç»­å…¶è¯·æ±‚ 101 Switching Protocols åˆ‡æ¢åè®®ã€‚æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ‡æ¢åè®®ã€‚åªèƒ½åˆ‡æ¢åˆ°æ›´é«˜çº§çš„åè®®ï¼Œä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ° HTTP çš„æ–°ç‰ˆæœ¬åè®®   2xxï¼šè¡¨ç¤ºæˆåŠŸï¼Œå¦‚æ¥æ”¶æˆ–çŸ¥é“äº†  200 OK: è¯·æ±‚æˆåŠŸ   3xxï¼šè¡¨ç¤ºé‡å®šå‘ï¼Œå¦‚è¦å®Œæˆè¯·æ±‚è¿˜å¿…é¡»é‡‡å–è¿›ä¸€æ­¥çš„è¡ŒåŠ¨  301 Moved Permanently: æ°¸ä¹…ç§»åŠ¨ã€‚è¯·æ±‚çš„èµ„æºå·²è¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°æ–° URLï¼Œè¿”å›ä¿¡æ¯ä¼šåŒ…æ‹¬æ–°çš„ URLï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®šå‘åˆ°æ–° URLã€‚ä»Šåä»»ä½•æ–°çš„è¯·æ±‚éƒ½åº”ä½¿ç”¨æ–°çš„ URL ä»£æ›¿   4xxï¼šè¡¨ç¤ºå®¢æˆ·çš„å·®é”™ï¼Œå¦‚è¯·æ±‚ä¸­æœ‰é”™è¯¯çš„è¯­æ³•æˆ–ä¸èƒ½å®Œæˆ  400 Bad Request: å®¢æˆ·ç«¯è¯·æ±‚çš„è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£ 401 Unauthorized: è¯·æ±‚è¦æ±‚ç”¨æˆ·çš„èº«ä»½è®¤è¯ 403 Forbidden: æœåŠ¡å™¨ç†è§£è¯·æ±‚å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œæ­¤è¯·æ±‚ï¼ˆæƒé™ä¸å¤Ÿï¼‰ 404 Not Found: æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚é€šè¿‡æ­¤ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯è®¾ç½® â€œæ‚¨æ‰€è¯·æ±‚çš„èµ„æºæ— æ³•æ‰¾åˆ°â€ çš„ä¸ªæ€§é¡µé¢ 408 Request Timeout: æœåŠ¡å™¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ—¶é—´è¿‡é•¿ï¼Œè¶…æ—¶   5xxï¼šè¡¨ç¤ºæœåŠ¡å™¨çš„å·®é”™ï¼Œå¦‚æœåŠ¡å™¨å¤±æ•ˆæ— æ³•å®Œæˆè¯·æ±‚  500 Internal Server Error: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ 503 Service Unavailable: ç”±äºè¶…è½½æˆ–ç³»ç»Ÿç»´æŠ¤ï¼ŒæœåŠ¡å™¨æš‚æ—¶çš„æ— æ³•å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å»¶æ—¶çš„é•¿åº¦å¯åŒ…å«åœ¨æœåŠ¡å™¨çš„ Retry-After å¤´ä¿¡æ¯ä¸­ 504 Gateway Timeout: å……å½“ç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼ŒæœªåŠæ—¶ä»è¿œç«¯æœåŠ¡å™¨è·å–è¯·æ±‚    âœ‹ HTTPçš„ä¸»è¦æ–¹æ³•   ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯æŸ¥è¯¢HTTPæœåŠ¡å™¨ç«¯æ”¯æŒçš„HTTPæ–¹æ³•ç§ç±»ã€‚\n  å‚è€ƒï¼šHTTPè¯·æ±‚å¤´å’Œå“åº”å¤´è¯¦è§£\n","description":"Httpæ˜¯å®šä¹‰åœ¨TCPä¸Šçš„ä¸€ç§ä¼ è¾“åè®®ï¼Œè¦ä¼ è¾“æ¶ˆæ¯å°±å¿…é¡»éµå®ˆè§„å®šï¼Œæœ¬æ–‡æ˜¯ä½¿ç”¨Httpçš„å‘é€æ¶ˆæ¯ä¸æ¥å—æ¶ˆæ¯çš„æŠ¥æ–‡è§„å®šåŠæ–¹æ³•ã€‚","id":4,"section":"posts","tags":["http"],"title":"HttpæŠ¥æ–‡æ ¼å¼åŠHttpæ–¹æ³•","uri":"https://hugo.jiahongw.com/zh/posts/network/http-message/"},{"content":"åŒæ­¥å¼‚æ­¥ä¸é˜»å¡éé˜»å¡ ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´ æ“ä½œç³»ç»Ÿä¸ºäº†æ”¯æŒå¤šä¸ªåº”ç”¨åŒæ—¶è¿è¡Œï¼Œéœ€è¦ä¿è¯ä¸åŒè¿›ç¨‹ä¹‹é—´ç›¸å¯¹ç‹¬ç«‹ï¼ˆä¸€ä¸ªè¿›ç¨‹çš„å´©æºƒä¸ä¼šå½±å“å…¶ä»–çš„è¿›ç¨‹ ï¼Œ æ¶æ„è¿›ç¨‹ä¸èƒ½ç›´æ¥è¯»å–å’Œä¿®æ”¹å…¶ä»–è¿›ç¨‹è¿è¡Œæ—¶çš„ä»£ç å’Œæ•°æ®ï¼‰ã€‚ å› æ­¤æ“ä½œç³»ç»Ÿå†…æ ¸éœ€è¦æ‹¥æœ‰é«˜äºæ™®é€šè¿›ç¨‹çš„æƒé™ï¼Œ ä»¥æ­¤æ¥è°ƒåº¦å’Œç®¡ç†ç”¨æˆ·çš„åº”ç”¨ç¨‹åºã€‚\näºæ˜¯å†…å­˜ç©ºé—´è¢«åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†ä¸ºå†…æ ¸ç©ºé—´ï¼Œä¸€éƒ¨åˆ†ä¸ºç”¨æˆ·ç©ºé—´ï¼Œå†…æ ¸ç©ºé—´å­˜å‚¨çš„ä»£ç å’Œæ•°æ®å…·æœ‰æ›´é«˜çº§åˆ«çš„æƒé™ã€‚å†…å­˜è®¿é—®çš„ç›¸å…³ç¡¬ä»¶åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ä¼šè¿›è¡Œè®¿é—®æ§åˆ¶ï¼ˆ Access Controlï¼‰ï¼Œä½¿å¾—ç”¨æˆ·ç©ºé—´çš„ç¨‹åºä¸èƒ½ç›´æ¥è¯»å†™å†…æ ¸ç©ºé—´çš„å†…å­˜ã€‚\nè¿›ç¨‹åˆ‡æ¢ ä¸Šå›¾å±•ç¤ºäº†è¿›ç¨‹åˆ‡æ¢ä¸­å‡ ä¸ªæœ€é‡è¦çš„æ­¥éª¤ï¼š\n å½“ä¸€ä¸ªç¨‹åºæ­£åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œ ä¸­æ–­ï¼ˆinterruptï¼‰ æˆ– ç³»ç»Ÿè°ƒç”¨ï¼ˆsystem callï¼‰ å‘ç”Ÿå¯ä»¥ä½¿å¾— CPU çš„æ§åˆ¶æƒä¼šä»å½“å‰è¿›ç¨‹è½¬ç§»åˆ°æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚ æ“ä½œç³»ç»Ÿå†…æ ¸è´Ÿè´£ä¿å­˜è¿›ç¨‹ i åœ¨ CPU ä¸­çš„ä¸Šä¸‹æ–‡ï¼ˆç¨‹åºè®¡æ•°å™¨ï¼Œ å¯„å­˜å™¨ï¼‰åˆ° PCBi ï¼ˆæ“ä½œç³»ç»Ÿåˆ†é…ç»™è¿›ç¨‹çš„ä¸€ä¸ªå†…å­˜å—ï¼‰ä¸­ã€‚ ä» PCBj å–å‡ºè¿›ç¨‹ j çš„CPU ä¸Šä¸‹æ–‡ï¼Œ å°† CPU æ§åˆ¶æƒè½¬ç§»ç»™è¿›ç¨‹ j ï¼Œ å¼€å§‹æ‰§è¡Œè¿›ç¨‹ j çš„æŒ‡ä»¤ã€‚   å¯ä»¥çœ‹å‡ºæ¥ï¼Œ æ“ä½œç³»ç»Ÿåœ¨è¿›è¡Œè¿›åˆ‡æ¢æ—¶ï¼Œéœ€è¦è¿›è¡Œä¸€ç³»åˆ—çš„å†…å­˜è¯»å†™æ“ä½œï¼Œ è¿™å¸¦æ¥äº†ä¸€å®šçš„å¼€é”€\n è¿›ç¨‹é˜»å¡ ä¸Šå›¾å±•ç¤ºäº†ä¸€ä¸ªè¿›ç¨‹çš„ä¸åŒçŠ¶æ€ï¼š\n New. è¿›ç¨‹æ­£åœ¨è¢«åˆ›å»º. Running. è¿›ç¨‹çš„æŒ‡ä»¤æ­£åœ¨è¢«æ‰§è¡Œ Waiting. è¿›ç¨‹æ­£åœ¨ç­‰å¾…ä¸€äº›äº‹ä»¶çš„å‘ç”Ÿï¼ˆä¾‹å¦‚ I/O çš„å®Œæˆæˆ–è€…æ”¶åˆ°æŸä¸ªä¿¡å·ï¼‰ Ready. è¿›ç¨‹åœ¨ç­‰å¾…è¢«æ“ä½œç³»ç»Ÿè°ƒåº¦ Terminated. è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ï¼ˆå¯èƒ½æ˜¯è¢«å¼ºè¡Œç»ˆæ­¢çš„ï¼‰  æˆ‘ä»¬æ‰€è¯´çš„ â€œé˜»å¡â€æ˜¯æŒ‡è¿›ç¨‹åœ¨å‘èµ·äº†ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼ˆSystem Callï¼‰ åï¼Œ ç”±äºè¯¥ç³»ç»Ÿè°ƒç”¨çš„æ“ä½œä¸èƒ½ç«‹å³å®Œæˆï¼Œéœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œäºæ˜¯å†…æ ¸å°†è¿›ç¨‹æŒ‚èµ·ä¸º**ç­‰å¾… ï¼ˆwaitingï¼‰**çŠ¶æ€ï¼Œ ä»¥ç¡®ä¿å®ƒä¸ä¼šè¢«è°ƒåº¦æ‰§è¡Œï¼Œ å ç”¨ CPU èµ„æºã€‚\né˜»å¡çš„åŸç†\né˜»å¡çš„åŸç†ï¼Ÿ\nå¯¹äºSocketæ¥è¯´ï¼š\nå½“å‘ç”Ÿé˜»å¡æ—¶å€™ï¼Œè°ƒç”¨é˜»å¡ç¨‹åºï¼Œè€Œé˜»å¡ç¨‹åºæœ€é‡è¦çš„ä¸€ä¸ªæ“ä½œå°±æ˜¯å°†è¿›ç¨‹ä»å·¥ä½œé˜Ÿåˆ—ç§»é™¤ï¼Œå¹¶ä¸”å°†å…¶åŠ åˆ°ç­‰å¾…é˜Ÿåˆ—ã€‚\nå½“å‘ç”Ÿä¸­æ–­æ—¶å€™ï¼Œè°ƒç”¨ä¸­æ–­ç¨‹åºï¼Œè€Œä¸­æ–­ç¨‹åºæœ€é‡è¦çš„ä¸€ä¸ªæ“ä½œå°±æ˜¯å°†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„è¿›ç¨‹é‡æ–°ç§»å›å·¥ä½œé˜Ÿåˆ—ï¼Œç»§ç»­åˆ†é…ç³»ç»Ÿçš„CPUèµ„æºã€‚\næ–‡ä»¶æè¿°ç¬¦ æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„å¥æŸ„æ˜¯0ã€1ã€2ä¸‰ä¸ªï¼Œ0æ˜¯æ ‡å‡†è¾“å…¥ï¼Œ1æ˜¯æ ‡å‡†è¾“å‡ºï¼Œ2æ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºã€‚0ã€1ã€2æ˜¯æ•´æ•°è¡¨ç¤ºçš„ï¼Œå¯¹åº”çš„FILE *ç»“æ„çš„è¡¨ç¤ºå°±æ˜¯stdinã€stdoutã€stderrï¼Œ0å°±æ˜¯stdinï¼Œ1å°±æ˜¯stdoutï¼Œ2å°±æ˜¯stderrã€‚\n1 2 3 4 5 6 7 8 9 10 11  #include \u0026lt;stdio.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;#include \u0026lt;string.h\u0026gt;int main(int argc, char **argv) { char buf[10] = \u0026#34;\u0026#34;; read(0, buf, 9);\t/* ä»æ ‡å‡†è¾“å…¥ 0 è¯»å…¥å­—ç¬¦ */ // fprintf(stdout, \u0026#34;%s\\n\u0026#34;, buf); /* å‘æ ‡å‡†è¾“å‡º stdout å†™å­—ç¬¦ */ \twrite(1, buf, strlen(buf)); return 0; }   åŒæ­¥ åŒæ­¥å°±æ˜¯ä¸€ä¸ªä»»åŠ¡çš„å®Œæˆéœ€è¦ä¾èµ–å¦å¤–ä¸€ä¸ªä»»åŠ¡æ—¶ï¼Œåªæœ‰ç­‰å¾…è¢«ä¾èµ–çš„ä»»åŠ¡å®Œæˆåï¼Œä¾èµ–çš„ä»»åŠ¡æ‰èƒ½ç®—å®Œæˆï¼Œè¿™æ˜¯ä¸€ç§å¯é çš„ä»»åŠ¡åºåˆ—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè°ƒç”¨ä¼šç­‰å¾…è¿”å›ç»“æœè®¡ç®—å®Œæˆæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚\nå¼‚æ­¥ å¼‚æ­¥æ˜¯ä¸éœ€è¦ç­‰å¾…è¢«ä¾èµ–çš„ä»»åŠ¡å®Œæˆï¼Œåªæ˜¯é€šçŸ¥è¢«ä¾èµ–çš„ä»»åŠ¡è¦å®Œæˆä»€ä¹ˆå·¥ä½œï¼Œä¾èµ–çš„ä»»åŠ¡ä¹Ÿç«‹å³æ‰§è¡Œï¼Œåªè¦è‡ªå·±å®Œæˆäº†æ•´ä¸ªä»»åŠ¡å°±ç®—å®Œæˆäº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶å®å¼‚æ­¥è°ƒç”¨ä¼šç›´æ¥è¿”å›ï¼Œä½†æ˜¯è¿™ä¸ªç»“æœä¸æ˜¯è®¡ç®—çš„ç»“æœï¼Œå½“ç»“æœè®¡ç®—å‡ºæ¥ä¹‹åï¼Œæ‰é€šçŸ¥è¢«è°ƒç”¨çš„ç¨‹åºã€‚\n ä¸¾ä¸ªé€šä¿—çš„ä¾‹å­ï¼š\nä½ æ‰“ç”µè¯é—®ä¹¦åº—è€æ¿æœ‰æ²¡æœ‰ã€Šåˆ†å¸ƒå¼ç³»ç»Ÿã€‹è¿™æœ¬ä¹¦ï¼Œå¦‚æœæ˜¯åŒæ­¥é€šä¿¡æœºåˆ¶ï¼Œä¹¦åº—è€æ¿ä¼šè¯´ï¼Œä½ ç¨ç­‰ï¼Œâ€æˆ‘æŸ¥ä¸€ä¸‹\u0026rdquo;ï¼Œç„¶åå¼€å§‹æŸ¥å•ŠæŸ¥ï¼Œç­‰æŸ¥å¥½äº†ï¼ˆå¯èƒ½æ˜¯5ç§’ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€å¤©ï¼‰å‘Šè¯‰ä½ ç»“æœï¼ˆè¿”å›ç»“æœï¼‰ã€‚\nè€Œå¼‚æ­¥é€šä¿¡æœºåˆ¶ï¼Œä¹¦åº—è€æ¿ç›´æ¥å‘Šè¯‰ä½ æˆ‘æŸ¥ä¸€ä¸‹å•Šï¼ŒæŸ¥å¥½äº†æ‰“ç”µè¯ç»™ä½ ï¼Œç„¶åç›´æ¥æŒ‚ç”µè¯äº†ï¼ˆä¸è¿”å›ç»“æœï¼‰ã€‚ç„¶åæŸ¥å¥½äº†ï¼Œä»–ä¼šä¸»åŠ¨æ‰“ç”µè¯ç»™ä½ ã€‚åœ¨è¿™é‡Œè€æ¿é€šè¿‡â€œå›ç”µâ€è¿™ç§æ–¹å¼æ¥å›è°ƒã€‚\n é˜»å¡ é˜»å¡è°ƒç”¨æ˜¯æŒ‡è°ƒç”¨ç»“æœè¿”å›ä¹‹å‰ï¼Œå½“å‰çº¿ç¨‹ä¼šè¢«æŒ‚èµ·ï¼Œä¸€ç›´å¤„äºç­‰å¾…æ¶ˆæ¯é€šçŸ¥ï¼Œä¸èƒ½å¤Ÿæ‰§è¡Œå…¶ä»–ä¸šåŠ¡ã€‚\néé˜»å¡ ä¸ç®¡å¯ä¸å¯ä»¥è¯»å†™ï¼Œå®ƒéƒ½ä¼šç«‹å³è¿”å›ï¼Œè¿”å›æˆåŠŸè¯´æ˜è¯»å†™æ“ä½œå®Œæˆäº†ï¼Œè¿”å›å¤±è´¥ä¼šè®¾ç½®ç›¸åº”errnoçŠ¶æ€ç ï¼Œæ ¹æ®è¿™ä¸ªerrnoå¯ä»¥è¿›ä¸€æ­¥æ‰§è¡Œå…¶ä»–å¤„ç†ã€‚å®ƒä¸ä¼šåƒé˜»å¡IOé‚£æ ·ï¼Œå¡åœ¨é‚£é‡Œä¸åŠ¨ã€‚\n é˜»å¡å’Œéé˜»å¡å…³æ³¨çš„æ˜¯ç¨‹åºåœ¨ç­‰å¾…è°ƒç”¨ç»“æœï¼ˆæ¶ˆæ¯ï¼Œè¿”å›å€¼ï¼‰æ—¶çš„çŠ¶æ€.\n å¯ä»¥è¿™ä¹ˆç†è§£ä¹ˆï¼Ÿé˜»å¡å’Œéé˜»å¡ï¼Œåº”è¯¥æè¿°çš„æ˜¯ä¸€ç§çŠ¶æ€ï¼ŒåŒæ­¥ä¸éåŒæ­¥æè¿°çš„æ˜¯è¡Œä¸ºæ–¹å¼.\nå¤šè·¯å¤ç”¨ ==IOå¤šè·¯å¤ç”¨æ˜¯æŒ‡å†…æ ¸ä¸€æ—¦å‘ç°è¿›ç¨‹æŒ‡å®šçš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªIOæ¡ä»¶å‡†å¤‡è¯»å–ï¼Œå®ƒå°±é€šçŸ¥è¯¥è¿›ç¨‹==ã€‚\nåœ¨å¤„ç† IO çš„æ—¶å€™ï¼Œé˜»å¡å’Œéé˜»å¡éƒ½æ˜¯åŒæ­¥ IOã€‚\nåªæœ‰ä½¿ç”¨äº†ç‰¹æ®Šçš„ API æ‰æ˜¯å¼‚æ­¥ IOã€‚\nselectã€pollã€epollä¹‹é—´çš„åŒºåˆ«ï¼š\n   \\ select poll epoll     æ“ä½œæ–¹å¼ éå† éå† å›è°ƒ   åº•å±‚å®ç° æ•°ç»„ é“¾è¡¨ å“ˆå¸Œè¡¨   IOæ•ˆç‡ æ¯æ¬¡è°ƒç”¨éƒ½è¿›è¡Œçº¿æ€§éå†ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n) æ¯æ¬¡è°ƒç”¨éƒ½è¿›è¡Œçº¿æ€§éå†ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n) äº‹ä»¶é€šçŸ¥æ–¹å¼ï¼Œæ¯å½“fdå°±ç»ªï¼Œç³»ç»Ÿæ³¨å†Œçš„å›è°ƒå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ï¼Œå°†å°±ç»ªfdæ”¾åˆ°rdllisté‡Œé¢ã€‚æ—¶é—´å¤æ‚åº¦O(1)   æœ€å¤§è¿æ¥æ•° 1024ï¼ˆx86ï¼‰æˆ– 2048ï¼ˆx64ï¼‰ æ— ä¸Šé™ æ— ä¸Šé™   fdæ‹·è´ æ¯æ¬¡è°ƒç”¨selectï¼Œéƒ½éœ€è¦æŠŠfdé›†åˆä»ç”¨æˆ·æ€æ‹·è´åˆ°å†…æ ¸æ€ æ¯æ¬¡è°ƒç”¨pollï¼Œéƒ½éœ€è¦æŠŠfdé›†åˆä»ç”¨æˆ·æ€æ‹·è´åˆ°å†…æ ¸æ€ è°ƒç”¨epoll_ctlæ—¶æ‹·è´è¿›å†…æ ¸å¹¶ä¿å­˜ï¼Œä¹‹åæ¯æ¬¡epoll_waitä¸æ‹·è´    Select åŸºäºselectè°ƒç”¨çš„I/Oå¤ç”¨æ¨¡å‹å¦‚ä¸‹ï¼š\næµç¨‹ ä¼ ç»Ÿselect/pollçš„å¦ä¸€ä¸ªè‡´å‘½å¼±ç‚¹å°±æ˜¯å½“ä½ æ‹¥æœ‰ä¸€ä¸ªå¾ˆå¤§çš„socketé›†åˆï¼Œç”±äºç½‘ç»œå¾—å»¶æ—¶ï¼Œä½¿å¾—ä»»ä¸€æ—¶é—´åªæœ‰éƒ¨åˆ†çš„socketæ˜¯\u0026quot;æ´»è·ƒ\u0026rdquo; çš„ï¼Œè€Œselect/pollæ¯æ¬¡è°ƒç”¨éƒ½ä¼šçº¿æ€§æ‰«æå…¨éƒ¨çš„é›†åˆï¼Œå¯¼è‡´æ•ˆç‡å‘ˆç°çº¿æ€§ä¸‹é™ã€‚\nä½†æ˜¯epollä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œå®ƒåªä¼šå¯¹\u0026quot;æ´»è·ƒ\u0026quot;çš„socketè¿› è¡Œæ“ä½œ\u0026mdash;è¿™æ˜¯å› ä¸ºåœ¨å†…æ ¸å®ç°ä¸­epollæ˜¯æ ¹æ®æ¯ä¸ªfdä¸Šé¢çš„callbackå‡½æ•°å®ç°çš„ã€‚äºæ˜¯ï¼Œåªæœ‰\u0026quot;æ´»è·ƒ\u0026quot;çš„socketæ‰ä¼šä¸»åŠ¨å»è°ƒç”¨ callbackå‡½æ•°ï¼Œå…¶ä»–idleçŠ¶æ€çš„socketåˆ™ä¸ä¼šï¼Œåœ¨è¿™ç‚¹ä¸Šï¼Œepollå®ç°äº†ä¸€ä¸ª\u0026ldquo;ä¼ª\u0026quot;AIOï¼Œå› ä¸ºè¿™æ—¶å€™æ¨åŠ¨åŠ›åœ¨oså†…æ ¸ã€‚\nè¿‡ç¨‹\nå½“è¿›ç¨‹Aè°ƒç”¨selectè¯­å¥çš„æ—¶å€™ï¼Œä¼šå°†è¿›ç¨‹Aæ·»åŠ åˆ°å¤šä¸ªç›‘å¬socketçš„ç­‰å¾…é˜Ÿåˆ—ä¸­\nå½“ç½‘å¡æ¥æ”¶åˆ°æ•°æ®ï¼Œç„¶åç½‘å¡é€šè¿‡ä¸­æ–­ä¿¡å·é€šçŸ¥cpuæœ‰æ•°æ®åˆ°è¾¾ï¼Œæ‰§è¡Œä¸­æ–­ç¨‹åºï¼Œä¸­æ–­ç¨‹åºä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼š\n å°†ç½‘ç»œæ•°æ®å†™å…¥åˆ°å¯¹åº”socketçš„æ¥æ”¶ç¼“å†²åŒºé‡Œé¢ å”¤é†’é˜Ÿåˆ—ä¸­çš„ç­‰å¾…è¿›ç¨‹(A),é‡æ–°å°†è¿›ç¨‹Aæ”¾å…¥å·¥ä½œé˜Ÿåˆ—ä¸­.  å¦‚ä¸‹å›¾ï¼Œå°†æ‰€æœ‰ç­‰å¾…é˜Ÿåˆ—çš„è¿›ç¨‹ç§»é™¤ï¼Œå¹¶ä¸”æ·»åŠ åˆ°å·¥ä½œé˜Ÿåˆ—ä¸­ã€‚\n ä¸Šé¢åªæ˜¯ä¸€ç§æƒ…å†µï¼Œå½“ç¨‹åºè°ƒç”¨ Select æ—¶ï¼Œå†…æ ¸ä¼šå…ˆéå†ä¸€é Socketï¼Œå¦‚æœæœ‰ä¸€ä¸ªä»¥ä¸Šçš„ Socket æ¥æ”¶ç¼“å†²åŒºæœ‰æ•°æ®ï¼Œé‚£ä¹ˆ Select ç›´æ¥è¿”å›ï¼Œä¸ä¼šé˜»å¡ã€‚\n é—®é¢˜ï¼š\n æ¯æ¬¡è°ƒç”¨ Select éƒ½éœ€è¦å°†è¿›ç¨‹åŠ å…¥åˆ°æ‰€æœ‰ç›‘è§† Socket çš„ç­‰å¾…é˜Ÿåˆ—ï¼Œæ¯æ¬¡å”¤é†’éƒ½éœ€è¦ä»æ¯ä¸ªé˜Ÿåˆ—ä¸­ç§»é™¤ã€‚è¿™é‡Œæ¶‰åŠäº†ä¸¤æ¬¡éå†ï¼Œè€Œä¸”æ¯æ¬¡éƒ½è¦å°†æ•´ä¸ª FDS åˆ—è¡¨ä¼ é€’ç»™å†…æ ¸ï¼Œæœ‰ä¸€å®šçš„å¼€é”€ã€‚ è¿›ç¨‹è¢«å”¤é†’åï¼Œç¨‹åºå¹¶ä¸çŸ¥é“å“ªäº› Socket æ”¶åˆ°æ•°æ®ï¼Œè¿˜éœ€è¦éå†ä¸€æ¬¡   selectå’Œpollåœ¨å†…éƒ¨æœºåˆ¶æ–¹é¢å¹¶æ²¡æœ‰å¤ªå¤§çš„å·®å¼‚ã€‚ç›¸æ¯”äºselectæœºåˆ¶ï¼Œpollåªæ˜¯å–æ¶ˆäº†æœ€å¤§ç›‘æ§æ–‡ä»¶æè¿°ç¬¦æ•°é™åˆ¶ï¼Œå¹¶æ²¡æœ‰ä»æ ¹æœ¬ä¸Šè§£å†³selectå­˜åœ¨çš„é—®é¢˜ã€‚\n Slect API è½®è¯¢æ‰€æœ‰çš„å¥æŸ„ï¼Œæ‰¾åˆ°æœ‰å¤„ç†çŠ¶æ€çš„å¥æŸ„å¹¶ä¸”è¿›è¡Œæ“ä½œã€‚\nä¸»è¦å‡½æ•°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  /* According to POSIX.1-2001 */ #include \u0026lt;sys/select.h\u0026gt; /* According to earlier standards */ #include \u0026lt;sys/time.h\u0026gt;#include \u0026lt;sys/types.h\u0026gt;#include \u0026lt;unistd.h\u0026gt; int select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, struct timeval *timeout); /** nfds: ç›‘æ§çš„æ–‡ä»¶æè¿°ç¬¦é›†é‡Œæœ€å¤§æ–‡ä»¶æè¿°ç¬¦åŠ 1ï¼Œå› ä¸ºæ­¤å‚æ•°ä¼šå‘Šè¯‰å†…æ ¸æ£€æµ‹å‰å¤šå°‘ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„çŠ¶æ€ readfdsï¼š ç›‘æ§æœ‰è¯»æ•°æ®åˆ°è¾¾æ–‡ä»¶æè¿°ç¬¦é›†åˆï¼Œä¼ å…¥ä¼ å‡ºå‚æ•° writefdsï¼š ç›‘æ§å†™æ•°æ®åˆ°è¾¾æ–‡ä»¶æè¿°ç¬¦é›†åˆï¼Œä¼ å…¥ä¼ å‡ºå‚æ•° exceptfdsï¼š ç›‘æ§å¼‚å¸¸å‘ç”Ÿè¾¾æ–‡ä»¶æè¿°ç¬¦é›†åˆ,å¦‚å¸¦å¤–æ•°æ®åˆ°è¾¾å¼‚å¸¸ï¼Œä¼ å…¥ä¼ å‡ºå‚æ•° timeoutï¼š å®šæ—¶é˜»å¡ç›‘æ§æ—¶é—´ï¼Œ3ç§æƒ…å†µ 1.NULLï¼Œæ°¸è¿œç­‰ä¸‹å» 2.è®¾ç½®timevalï¼Œç­‰å¾…å›ºå®šæ—¶é—´ 3.è®¾ç½®timevalé‡Œæ—¶é—´å‡ä¸º0ï¼Œæ£€æŸ¥æè¿°å­—åç«‹å³è¿”å›ï¼Œè½®è¯¢ struct timeval { long tv_sec; // seconds long tv_usec; // microseconds }; */ void FD_CLR(int fd, fd_set *set);\t// æŠŠæ–‡ä»¶æè¿°ç¬¦é›†åˆé‡Œfdæ¸…0 int FD_ISSET(int fd, fd_set *set); // æµ‹è¯•æ–‡ä»¶æè¿°ç¬¦é›†åˆé‡Œfdæ˜¯å¦ç½®1 void FD_SET(int fd, fd_set *set); // æŠŠæ–‡ä»¶æè¿°ç¬¦é›†åˆé‡Œfdä½ç½®1 void FD_ZERO(fd_set *set);\t//æŠŠæ–‡ä»¶æè¿°ç¬¦é›†åˆé‡Œæ‰€æœ‰ä½æ¸…0   Selectä¾‹å­ æœåŠ¡å™¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215  /************************************************************************* \u0026gt; File Name: server.cpp \u0026gt; Author: SongLee \u0026gt; E-mail: lisong.shine@qq.com \u0026gt; Created Time: 2016å¹´04æœˆ28æ—¥ æ˜ŸæœŸå›› 22æ—¶02åˆ†43ç§’ \u0026gt; Personal Blog: http://songlee24.github.io/ ************************************************************************/ #include \u0026lt;netinet/in.h\u0026gt; // sockaddr_in#include \u0026lt;sys/types.h\u0026gt; // socket#include \u0026lt;sys/socket.h\u0026gt; // socket#include \u0026lt;arpa/inet.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;#include \u0026lt;sys/select.h\u0026gt; // select#include \u0026lt;sys/ioctl.h\u0026gt;#include \u0026lt;sys/time.h\u0026gt;#include \u0026lt;iostream\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;string\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; #define BUFFER_SIZE 1024 struct PACKET_HEAD { int length; }; class Server { private: struct sockaddr_in server_addr; socklen_t server_addr_len; int listen_fd; // ç›‘å¬çš„fd  int max_fd; // æœ€å¤§çš„fd  fd_set master_set; // æ‰€æœ‰fdé›†åˆï¼ŒåŒ…æ‹¬ç›‘å¬fdå’Œå®¢æˆ·ç«¯fd  fd_set working_set; // å·¥ä½œé›†åˆ  struct timeval timeout; public: Server(int port); ~Server(); void Bind(); void Listen(int queue_len = 20); void Accept(); void Run(); void Recv(int nums); }; Server::Server(int port) { bzero(\u0026amp;server_addr, sizeof(server_addr)); server_addr.sin_family = AF_INET; server_addr.sin_addr.s_addr = htons(INADDR_ANY); server_addr.sin_port = htons(port); // create socket to listen  listen_fd = socket(PF_INET, SOCK_STREAM, 0); if (listen_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Create Socket Failed!\u0026#34;; exit(1); } int opt = 1; // å…è®¸é‡ç”¨æœ¬åœ°åœ°å€å’Œç«¯å£  setsockopt(listen_fd, SOL_SOCKET, SO_REUSEADDR, \u0026amp;opt, sizeof(opt)); } Server::~Server() { for (int fd = 0; fd \u0026lt;= max_fd; ++fd) { if (FD_ISSET(fd, \u0026amp;master_set)) { close(fd); } } } void Server::Bind() { if (-1 == (bind(listen_fd, (struct sockaddr *)\u0026amp;server_addr, sizeof(server_addr)))) { cout \u0026lt;\u0026lt; \u0026#34;Server Bind Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Bind Successfully.\\n\u0026#34;; } void Server::Listen(int queue_len) { if (-1 == listen(listen_fd, queue_len)) { cout \u0026lt;\u0026lt; \u0026#34;Server Listen Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Listen Successfully.\\n\u0026#34;; } void Server::Accept() { struct sockaddr_in client_addr; socklen_t client_addr_len = sizeof(client_addr); int new_fd = accept(listen_fd, (struct sockaddr *)\u0026amp;client_addr, \u0026amp;client_addr_len); if (new_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Server Accept Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;new connection was accepted.\\n\u0026#34;; // å°†æ–°å»ºç«‹çš„è¿æ¥çš„fdåŠ å…¥master_set  FD_SET(new_fd, \u0026amp;master_set); if (new_fd \u0026gt; max_fd) { max_fd = new_fd; } } void Server::Run() { max_fd = listen_fd; // åˆå§‹åŒ–max_fd  FD_ZERO(\u0026amp;master_set); FD_SET(listen_fd, \u0026amp;master_set); // æ·»åŠ ç›‘å¬fd  while (1) { FD_ZERO(\u0026amp;working_set); memcpy(\u0026amp;working_set, \u0026amp;master_set, sizeof(master_set)); timeout.tv_sec = 30; timeout.tv_usec = 0; int nums = select(max_fd + 1, \u0026amp;working_set, NULL, NULL, \u0026amp;timeout); if (nums \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;select() error!\u0026#34;; exit(1); } if (nums == 0) { //cout \u0026lt;\u0026lt; \u0026#34;select() is timeout!\u0026#34;;  continue; } if (FD_ISSET(listen_fd, \u0026amp;working_set)) Accept(); // æœ‰æ–°çš„å®¢æˆ·ç«¯è¯·æ±‚  else Recv(nums); // æ¥æ”¶å®¢æˆ·ç«¯çš„æ¶ˆæ¯  } } void Server::Recv(int nums) { for (int fd = 0; fd \u0026lt;= max_fd; ++fd) { if (FD_ISSET(fd, \u0026amp;working_set)) { bool close_conn = false; // æ ‡è®°å½“å‰è¿æ¥æ˜¯å¦æ–­å¼€äº†  PACKET_HEAD head; recv(fd, \u0026amp;head, sizeof(head), 0); // å…ˆæ¥å—åŒ…å¤´ï¼Œå³æ•°æ®æ€»é•¿åº¦  // std::cout \u0026lt;\u0026lt; head.length \u0026lt;\u0026lt; std::endl;  char *buffer = new char[head.length]; bzero(buffer, head.length); int total = 0; while (total \u0026lt; head.length) { int len = recv(fd, buffer + total, head.length - total, 0); if (len \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;recv() error!\u0026#34;; close_conn = true; break; } total = total + len; } if (total == head.length) // å°†æ”¶åˆ°çš„æ¶ˆæ¯åŸæ ·å‘å›ç»™å®¢æˆ·ç«¯  { int ret1 = send(fd, \u0026amp;head, sizeof(head), 0); int ret2 = send(fd, buffer, head.length, 0); if (ret1 \u0026lt; 0 || ret2 \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;send() error!\u0026#34;; close_conn = true; } } delete buffer; if (close_conn) // å½“å‰è¿™ä¸ªè¿æ¥æœ‰é—®é¢˜ï¼Œå…³é—­å®ƒ  { close(fd); FD_CLR(fd, \u0026amp;master_set); if (fd == max_fd) // éœ€è¦æ›´æ–°max_fd;  { while (FD_ISSET(max_fd, \u0026amp;master_set) == false) --max_fd; } } } } } int main() { Server server(15000); server.Bind(); server.Listen(); server.Run(); return 0; }   å®¢æˆ·ç«¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127  /************************************************************************* \u0026gt; File Name: client.cpp \u0026gt; Author: SongLee \u0026gt; E-mail: lisong.shine@qq.com \u0026gt; Created Time: 2016å¹´04æœˆ28æ—¥ æ˜ŸæœŸå›› 23æ—¶10åˆ†15ç§’ \u0026gt; Personal Blog: http://songlee24.github.io/ ************************************************************************/ #include\u0026lt;netinet/in.h\u0026gt; // sockaddr_in#include\u0026lt;sys/types.h\u0026gt; // socket#include\u0026lt;sys/socket.h\u0026gt; // socket#include\u0026lt;arpa/inet.h\u0026gt;#include\u0026lt;sys/ioctl.h\u0026gt;#include\u0026lt;unistd.h\u0026gt;#include\u0026lt;iostream\u0026gt;#include\u0026lt;string\u0026gt;#include\u0026lt;cstdlib\u0026gt;#include\u0026lt;cstdio\u0026gt;#include\u0026lt;cstring\u0026gt;using namespace std; #define BUFFER_SIZE 1024 struct PACKET_HEAD { int length; }; class Client { private: struct sockaddr_in server_addr; socklen_t server_addr_len; int fd; public: Client(string ip, int port); ~Client(); void Connect(); void Send(string str); string Recv(); }; Client::Client(string ip, int port) { bzero(\u0026amp;server_addr, sizeof(server_addr)); server_addr.sin_family = AF_INET; if(inet_pton(AF_INET, ip.c_str(), \u0026amp;server_addr.sin_addr) == 0) { cout \u0026lt;\u0026lt; \u0026#34;Server IP Address Error!\u0026#34;; exit(1); } server_addr.sin_port = htons(port); server_addr_len = sizeof(server_addr); // create socket  fd = socket(AF_INET, SOCK_STREAM, 0); if(fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Create Socket Failed!\u0026#34;; exit(1); } } Client::~Client() { close(fd); } void Client::Connect() { cout \u0026lt;\u0026lt; \u0026#34;Connecting......\u0026#34; \u0026lt;\u0026lt; endl; if(connect(fd, (struct sockaddr*)\u0026amp;server_addr, server_addr_len) \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Can not Connect to Server IP!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Connect to Server successfully.\u0026#34; \u0026lt;\u0026lt; endl; } void Client::Send(string str) { PACKET_HEAD head; head.length = str.size()+1; // æ³¨æ„è¿™é‡Œéœ€è¦+1  int ret1 = send(fd, \u0026amp;head, sizeof(head), 0); int ret2 = send(fd, str.c_str(), head.length, 0); if(ret1 \u0026lt; 0 || ret2 \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Send Message Failed!\u0026#34;; exit(1); } } string Client::Recv() { PACKET_HEAD head; recv(fd, \u0026amp;head, sizeof(head), 0); char* buffer = new char[head.length]; bzero(buffer, head.length); int total = 0; while(total \u0026lt; head.length) { int len = recv(fd, buffer + total, head.length - total, 0); if(len \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;recv() error!\u0026#34;; break; } total = total + len; } string result(buffer); delete buffer; return result; } int main() { Client client(\u0026#34;127.0.0.1\u0026#34;, 15000); client.Connect(); while(1) { string msg; getline(cin, msg); if(msg == \u0026#34;exit\u0026#34;) break; client.Send(msg); cout \u0026lt;\u0026lt; client.Recv() \u0026lt;\u0026lt; endl; } return 0; }   è¯´æ˜ï¼š\n ç›‘å¬socketä¹Ÿç”±selectæ¥è½®è¯¢ï¼Œä¸éœ€è¦å•ç‹¬çš„çº¿ç¨‹ï¼› working_setæ¯æ¬¡éƒ½è¦é‡æ–°è®¾ç½®ï¼Œå› ä¸ºselectè°ƒç”¨åå®ƒæ‰€æ£€æµ‹çš„é›†åˆworking_setä¼šè¢«ä¿®æ”¹ï¼› æ¥æ”¶å¾ˆé•¿ä¸€æ®µæ•°æ®æ—¶ï¼Œéœ€è¦å¾ªç¯å¤šæ¬¡recvã€‚ä½†æ˜¯recvå‡½æ•°ä¼šé˜»å¡ï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰åŒ…å¤´ï¼ˆä¿å­˜æ•°æ®é•¿åº¦ï¼‰  Poll pollçš„æœºåˆ¶ä¸selectç±»ä¼¼ï¼Œä¸selectåœ¨æœ¬è´¨ä¸Šæ²¡æœ‰å¤šå¤§å·®åˆ«ï¼Œç®¡ç†å¤šä¸ªæè¿°ç¬¦ä¹Ÿæ˜¯è¿›è¡Œè½®è¯¢ï¼Œæ ¹æ®æè¿°ç¬¦çš„çŠ¶æ€è¿›è¡Œå¤„ç†ï¼Œä½†æ˜¯pollæ²¡æœ‰æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°é‡çš„é™åˆ¶ã€‚pollå’ŒselectåŒæ ·å­˜åœ¨ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯ï¼ŒåŒ…å«å¤§é‡æ–‡ä»¶æè¿°ç¬¦çš„æ•°ç»„è¢«æ•´ä½“å¤åˆ¶äºç”¨æˆ·æ€å’Œå†…æ ¸çš„åœ°å€ç©ºé—´ä¹‹é—´ï¼Œè€Œä¸è®ºè¿™äº›æ–‡ä»¶æè¿°ç¬¦æ˜¯å¦å°±ç»ªï¼Œå®ƒçš„å¼€é”€éšç€æ–‡ä»¶æè¿°ç¬¦æ•°é‡çš„å¢åŠ è€Œçº¿æ€§å¢å¤§ã€‚\nç›¸å…³çš„å‡½æ•°ï¼š\n1 2  #include \u0026lt;poll.h\u0026gt;int poll(struct pollfd fds[], nfds_t nfds, int timeout)ï¼›   å‚æ•°æè¿°ï¼š\n è¯¥poll()å‡½æ•°è¿”å›fdsé›†åˆä¸­å°±ç»ªçš„è¯»ã€å†™ï¼Œæˆ–å‡ºé”™çš„æè¿°ç¬¦æ•°é‡ï¼Œè¿”å›0è¡¨ç¤ºè¶…æ—¶ï¼Œè¿”å›-1è¡¨ç¤ºå‡ºé”™ï¼› fdsæ˜¯ä¸€ä¸ªstruct pollfdç±»å‹çš„æ•°ç»„ï¼Œç”¨äºå­˜æ”¾éœ€è¦æ£€æµ‹å…¶çŠ¶æ€çš„socketæè¿°ç¬¦ï¼Œå¹¶ä¸”è°ƒç”¨pollå‡½æ•°ä¹‹åfdsæ•°ç»„ä¸ä¼šè¢«æ¸…ç©ºï¼› nfdsï¼šè®°å½•æ•°ç»„fdsä¸­æè¿°ç¬¦çš„æ€»æ•°é‡ï¼› timeoutï¼šè°ƒç”¨pollå‡½æ•°é˜»å¡çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼›  å…¶ä¸­pollfdç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š\n1 2 3 4 5  typedef struct pollfd { int fd; /* éœ€è¦è¢«æ£€æµ‹æˆ–é€‰æ‹©çš„æ–‡ä»¶æè¿°ç¬¦*/ short events; /* å¯¹æ–‡ä»¶æè¿°ç¬¦fdä¸Šæ„Ÿå…´è¶£çš„äº‹ä»¶ */ short revents; /* æ–‡ä»¶æè¿°ç¬¦fdä¸Šå½“å‰å®é™…å‘ç”Ÿçš„äº‹ä»¶*/ } pollfd_t;   ä¸€ä¸ªpollfdç»“æ„ä½“è¡¨ç¤ºä¸€ä¸ªè¢«ç›‘è§†çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡ä¼ é€’fds[]æŒ‡ç¤º poll() ç›‘è§†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå…¶ä¸­ï¼š\n ç»“æ„ä½“çš„eventsåŸŸæ˜¯ç›‘è§†è¯¥æ–‡ä»¶æè¿°ç¬¦çš„äº‹ä»¶æ©ç ï¼Œç”±ç”¨æˆ·æ¥è®¾ç½®è¿™ä¸ªåŸŸã€‚ ç»“æ„ä½“çš„reventsåŸŸæ˜¯æ–‡ä»¶æè¿°ç¬¦çš„æ“ä½œç»“æœäº‹ä»¶æ©ç ï¼Œå†…æ ¸åœ¨è°ƒç”¨è¿”å›æ—¶è®¾ç½®è¿™ä¸ªåŸŸã€‚  eventsåŸŸä¸­è¯·æ±‚çš„ä»»ä½•äº‹ä»¶éƒ½å¯èƒ½åœ¨reventsåŸŸä¸­è¿”å›ã€‚åˆæ³•çš„äº‹ä»¶å¦‚ä¸‹ï¼š\n   å¸¸é‡ è¯´æ˜     POLLIN æ™®é€šæˆ–ä¼˜å…ˆçº§å¸¦æ•°æ®å¯è¯»   POLLRDNORM æ™®é€šæ•°æ®å¯è¯»   POLLRDBAND ä¼˜å…ˆçº§å¸¦æ•°æ®å¯è¯»   POLLPRI é«˜ä¼˜å…ˆçº§æ•°æ®å¯è¯»   POLLOUT æ™®é€šæ•°æ®å¯å†™   POLLWRNORM æ™®é€šæ•°æ®å¯å†™   POLLWRBAND ä¼˜å…ˆçº§å¸¦æ•°æ®å¯å†™   POLLERR å‘ç”Ÿé”™è¯¯   POLLHUP å‘ç”ŸæŒ‚èµ·   POLLNVAL æè¿°å­—ä¸æ˜¯ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶    å½“éœ€è¦ç›‘å¬å¤šä¸ªäº‹ä»¶æ—¶ï¼Œä½¿ç”¨POLLIN | POLLRDNORMè®¾ç½® events åŸŸï¼›å½“pollè°ƒç”¨ä¹‹åæ£€æµ‹æŸäº‹ä»¶æ˜¯å¦å°±ç»ªæ—¶ï¼Œfds[i].revents \u0026amp; POLLINè¿›è¡Œåˆ¤æ–­ã€‚\nPollä¾‹å­ æœåŠ¡å™¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213  #include \u0026lt;netinet/in.h\u0026gt; // sockaddr_in#include \u0026lt;sys/types.h\u0026gt; // socket#include \u0026lt;sys/socket.h\u0026gt; // socket#include \u0026lt;arpa/inet.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;#include \u0026lt;poll.h\u0026gt; // poll#include \u0026lt;sys/ioctl.h\u0026gt;#include \u0026lt;sys/time.h\u0026gt;#include \u0026lt;iostream\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;string\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; #define BUFFER_SIZE 1024#define MAX_FD 1000 struct PACKET_HEAD { int length; }; class Server { private: struct sockaddr_in server_addr; socklen_t server_addr_len; int listen_fd; // ç›‘å¬çš„fd  struct pollfd fds[MAX_FD]; // fdæ•°ç»„ï¼Œå¤§å°ä¸º1000  int nfds; public: Server(int port); ~Server(); void Bind(); void Listen(int queue_len = 20); void Accept(); void Run(); void Recv(); }; Server::Server(int port) { bzero(\u0026amp;server_addr, sizeof(server_addr)); server_addr.sin_family = AF_INET; server_addr.sin_addr.s_addr = htons(INADDR_ANY); server_addr.sin_port = htons(port); // create socket to listen  listen_fd = socket(PF_INET, SOCK_STREAM, 0); if (listen_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Create Socket Failed!\u0026#34;; exit(1); } int opt = 1; setsockopt(listen_fd, SOL_SOCKET, SO_REUSEADDR, \u0026amp;opt, sizeof(opt)); } Server::~Server() { for (int i = 0; i \u0026lt; MAX_FD; ++i) { if (fds[i].fd \u0026gt;= 0) { close(fds[i].fd); } } } void Server::Bind() { if (-1 == (bind(listen_fd, (struct sockaddr *)\u0026amp;server_addr, sizeof(server_addr)))) { cout \u0026lt;\u0026lt; \u0026#34;Server Bind Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Bind Successfully.\\n\u0026#34;; } void Server::Listen(int queue_len) { if (-1 == listen(listen_fd, queue_len)) { cout \u0026lt;\u0026lt; \u0026#34;Server Listen Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Listen Successfully.\\n\u0026#34;; } void Server::Accept() { struct sockaddr_in client_addr; socklen_t client_addr_len = sizeof(client_addr); int new_fd = accept(listen_fd, (struct sockaddr *)\u0026amp;client_addr, \u0026amp;client_addr_len); if (new_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Server Accept Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;new connection was accepted.\\n\u0026#34;; // å°†æ–°å»ºç«‹çš„è¿æ¥çš„fdåŠ å…¥fds[]  int i; for (i = 1; i \u0026lt; MAX_FD; ++i) { if (fds[i].fd \u0026lt; 0) { fds[i].fd = new_fd; break; } } // è¶…è¿‡æœ€å¤§è¿æ¥æ•°  if (i == MAX_FD) { cout \u0026lt;\u0026lt; \u0026#34;Too many clients.\\n\u0026#34;; exit(1); } fds[i].events = POLLIN; // è®¾ç½®æ–°æè¿°ç¬¦çš„è¯»äº‹ä»¶  nfds = i \u0026gt; nfds ? i : nfds; // æ›´æ–°è¿æ¥æ•° } void Server::Run() { fds[0].fd = listen_fd; // æ·»åŠ ç›‘å¬æè¿°ç¬¦  fds[0].events = POLLIN; nfds = 0; for (int i = 1; i \u0026lt; MAX_FD; ++i) fds[i].fd = -1; while (1) { int nums = poll(fds, nfds + 1, -1); if (nums \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;poll() error!\u0026#34;; exit(1); } if (nums == 0) { continue; } if (fds[0].revents \u0026amp; POLLIN) Accept(); // æœ‰æ–°çš„å®¢æˆ·ç«¯è¯·æ±‚  else Recv(); } } void Server::Recv() { for (int i = 1; i \u0026lt; MAX_FD; ++i) { if (fds[i].fd \u0026lt; 0) continue; if (fds[i].revents \u0026amp; POLLIN) // è¯»å°±ç»ª  { int fd = fds[i].fd; bool close_conn = false; // æ ‡è®°å½“å‰è¿æ¥æ˜¯å¦æ–­å¼€äº†  PACKET_HEAD head; recv(fd, \u0026amp;head, sizeof(head), 0); // å…ˆæ¥å—åŒ…å¤´ï¼Œå³æ•°æ®æ€»é•¿åº¦  char *buffer = new char[head.length]; bzero(buffer, head.length); int total = 0; while (total \u0026lt; head.length) { int len = recv(fd, buffer + total, head.length - total, 0); if (len \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;recv() error!\u0026#34;; close_conn = true; break; } total = total + len; } if (total == head.length) // å°†æ”¶åˆ°çš„æ¶ˆæ¯åŸæ ·å‘å›ç»™å®¢æˆ·ç«¯  { int ret1 = send(fd, \u0026amp;head, sizeof(head), 0); int ret2 = send(fd, buffer, head.length, 0); if (ret1 \u0026lt; 0 || ret2 \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;send() error!\u0026#34;; close_conn = true; } } delete buffer; if (close_conn) // å½“å‰è¿™ä¸ªè¿æ¥æœ‰é—®é¢˜ï¼Œå…³é—­å®ƒ  { close(fd); fds[i].fd = -1; } } } } int main() { Server server(15000); server.Bind(); server.Listen(); server.Run(); return 0; }   å®¢æˆ·ç«¯\næ ¸Selectå®¢æˆ·ç«¯ä¸€æ ·\nEpoll epollå¯ä»¥ç†è§£ä¸ºevent poll(åŸºäºäº‹ä»¶çš„è½®è¯¢)ã€‚\nä½¿ç”¨åœºåˆï¼š   å½“å®¢æˆ·å¤„ç†å¤šä¸ªæè¿°ç¬¦æ—¶ï¼ˆä¸€èˆ¬æ˜¯äº¤äº’å¼è¾“å…¥å’Œç½‘ç»œå¥—æ¥å£ï¼‰ï¼Œå¿…é¡»ä½¿ç”¨I/Oå¤ç”¨ã€‚\n  å½“ä¸€ä¸ªå®¢æˆ·åŒæ—¶å¤„ç†å¤šä¸ªå¥—æ¥å£æ—¶ï¼Œè€Œè¿™ç§æƒ…å†µæ˜¯å¯èƒ½çš„ï¼Œä½†å¾ˆå°‘å‡ºç°ã€‚\n  å¦‚æœä¸€ä¸ªTCPæœåŠ¡å™¨æ—¢è¦å¤„ç†ç›‘å¬å¥—æ¥å£ï¼Œåˆè¦å¤„ç†å·²è¿æ¥å¥—æ¥å£ï¼Œä¸€èˆ¬ä¹Ÿè¦ç”¨åˆ°I/Oå¤ç”¨ã€‚\n  å¦‚æœä¸€ä¸ªæœåŠ¡å™¨å³è¦å¤„ç†TCPï¼Œåˆè¦å¤„ç†UDPï¼Œä¸€èˆ¬è¦ä½¿ç”¨I/Oå¤ç”¨ã€‚\n  å¦‚æœä¸€ä¸ªæœåŠ¡å™¨è¦å¤„ç†å¤šä¸ªæœåŠ¡æˆ–å¤šä¸ªåè®®ï¼Œä¸€èˆ¬è¦ä½¿ç”¨I/Oå¤ç”¨ã€‚\n   I/Oå¤šè·¯å¤ç”¨æœ‰å¾ˆå¤šç§å®ç°ã€‚åœ¨linuxä¸Šï¼Œ2.4å†…æ ¸å‰ä¸»è¦æ˜¯selectå’Œpollï¼Œè‡ªLinux 2.6å†…æ ¸æ­£å¼å¼•å…¥epollä»¥æ¥ï¼Œepollå·²ç»æˆä¸ºäº†ç›®å‰å®ç°é«˜æ€§èƒ½ç½‘ç»œæœåŠ¡å™¨çš„å¿…å¤‡æŠ€æœ¯ã€‚å°½ç®¡ä»–ä»¬çš„ä½¿ç”¨æ–¹æ³•ä¸å°½ç›¸åŒï¼Œä½†æ˜¯æœ¬è´¨ä¸Šå´æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚\n EpollåŸç† ä¸åŒäºselect/pollï¼ŒEpollæ­£æ˜¯ä¿å­˜äº†é‚£äº›æ”¶åˆ°æ•°æ®çš„Socketåˆ°ä¸€ä¸ªåŒå‘é“¾è¡¨ä¸­ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±å°‘äº†ä¸€æ¬¡éå†ã€‚epoll = å‡å°‘éå† + ä¿å­˜å°±ç»ªSocket\n å‡å°‘éå†  å°†æ§åˆ¶ä¸é˜»å¡åˆ†ç¦»ã€‚\nä¿å­˜å°±ç»ªSocket  ç»´æŠ¤ä¸€ä¸ªrdlistä»¥åŠrb_treeï¼Œç±»ä¼¼äºåŒå‘é“¾è¡¨æ“ä½œã€‚\né€šè¿‡ epoll_ctl æ·»åŠ  Sock1ã€Sock2 å’Œ Sock3 çš„ç›‘è§†ï¼Œå†…æ ¸ä¼šå°† eventpollçš„å¼•ç”¨ æ·»åŠ åˆ°è¿™ä¸‰ä¸ª Socket çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚\nepoll åœ¨ Linux å†…æ ¸ä¸­ç”³è¯·äº†ä¸€ä¸ªç®€æ˜“çš„æ–‡ä»¶ç³»ç»Ÿï¼Œç”¨äºå­˜å‚¨ç›¸å…³çš„å¯¹è±¡ï¼Œæ¯ä¸€ä¸ª epoll å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ eventpoll ç»“æ„ä½“ï¼Œè¿™ä¸ªç»“æ„ä½“ä¼šåœ¨å†…æ ¸ç©ºé—´ä¸­åˆ›é€ ç‹¬ç«‹çš„å†…å­˜ï¼Œç”¨äºå­˜å‚¨ä½¿ç”¨epoll_ctl æ–¹æ³•å‘ epoll å¯¹è±¡ä¸­æ·»åŠ è¿›æ¥çš„äº‹ä»¶ã€‚è¿™äº›äº‹ä»¶éƒ½ä¼šæŒ‚åˆ° rbr çº¢é»‘æ ‘ä¸­ï¼Œè¿™æ ·ï¼Œé‡å¤æ·»åŠ çš„äº‹ä»¶å°±å¯ä»¥é€šè¿‡çº¢é»‘æ ‘è€Œé«˜æ•ˆåœ°è¯†åˆ«å‡ºæ¥ã€‚\nepollåº•å±‚å®ç°æœ€é‡è¦çš„ä¸¤ä¸ªæ•°æ®ç»“æ„:epitemå’Œeventpollã€‚å¯ä»¥ç®€å•çš„è®¤ä¸ºepitemæ˜¯å’Œæ¯ä¸ªç”¨æˆ·æ€ç›‘æ§IOçš„fdå¯¹åº”çš„,eventpollæ˜¯ç”¨æˆ·æ€åˆ›å»ºçš„ç®¡ç†æ‰€æœ‰è¢«ç›‘æ§fdçš„ç»“æ„ï¼Œè¯¦ç»†çš„å®šä¹‰å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  struct epitem { struct rb_node rbn; struct list_head rdllink; struct epitem *next; struct epoll_filefd ffd; int nwait; struct list_head pwqlist; struct eventpoll *ep; struct list_head fllink; struct epoll_event event; }; struct eventpoll { spin_lock_t lock; struct mutex mtx; wait_queue_head_t wq; wait_queue_head_t poll_wait; struct list_head rdllist; //å°±ç»ªé“¾è¡¨  struct rb_root rbr; //çº¢é»‘æ ‘æ ¹èŠ‚ç‚¹  struct epitem *ovflist; };   epollè¿‡ç¨‹\nè°ƒç”¨epoll_createï¼Œå†…æ ¸ä¼šåˆ›å»ºä¸€ä¸ªeventpollå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯ç¨‹åºä¸­epfdæ‰€ä»£è¡¨çš„å¯¹è±¡ï¼‰ã€‚eventpollå¯¹è±¡ä¹Ÿæ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€å‘˜ï¼Œå’Œsocketä¸€æ ·ï¼Œå®ƒä¹Ÿä¼šæœ‰ç­‰å¾…é˜Ÿåˆ—ã€‚\né€šè¿‡ epoll_ctl æ·»åŠ  Sock1ã€Sock2 å’Œ Sock3 çš„ç›‘è§†ï¼Œå†…æ ¸ä¼šå°† eventpollçš„å¼•ç”¨ æ·»åŠ åˆ°è¿™ä¸‰ä¸ª Socket çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚\nå½“Socketæ”¶åˆ°æ•°æ®ä¹‹åï¼Œä¸­æ–­ç¨‹åºä¼šæ‰§è¡Œå°†Socketçš„å¼•ç”¨æ·»åŠ åˆ°eventpollå¯¹è±¡çš„rdlistå°±ç»ªåˆ—è¡¨ä¸­ã€‚\nå‡è®¾è®¡ç®—æœºä¸­æ­£åœ¨è¿è¡Œè¿›ç¨‹ A å’Œè¿›ç¨‹ Bã€Cï¼Œåœ¨æŸæ—¶åˆ»è¿›ç¨‹ A è¿è¡Œåˆ°äº† epoll_wait è¯­å¥ï¼Œä¼šå°†è¿›ç¨‹Aæ·»åŠ åˆ°eventpollçš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚\nå½“ Socket æ¥æ”¶åˆ°æ•°æ®ï¼Œä¸­æ–­ç¨‹åºä¸€æ–¹é¢ä¿®æ”¹ Rdlistï¼Œå¦ä¸€æ–¹é¢å”¤é†’ eventpoll ç­‰å¾…é˜Ÿåˆ—ä¸­çš„è¿›ç¨‹ï¼Œè¿›ç¨‹ A å†æ¬¡è¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚å› ä¸ºSoketåŒ…å«eventpollå¯¹è±¡çš„å¼•ç”¨ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ“ä½œeventpollå¯¹è±¡.\nepoll API\nepollçš„apiå®šä¹‰:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  //ç”¨æˆ·æ•°æ®è½½ä½“ typedef union epoll_data { void *ptr; int fd; uint32_t u32; uint64_t u64; } epoll_data_t; //fdè£…è½½å…¥å†…æ ¸çš„è½½ä½“  struct epoll_event { uint32_t events; /* Epoll events */ epoll_data_t data; /* User data variable */ }; //ä¸‰æ¿æ–§api int epoll_create(int size); int epoll_ctl(int epfd, int op, int fd, struct epoll_event *event); int epoll_wait(int epfd, struct epoll_event *events, int maxevents, int timeout);    poll_createæ˜¯åœ¨å†…æ ¸åŒºåˆ›å»ºä¸€ä¸ªepollç›¸å…³çš„ä¸€äº›åˆ—ç»“æ„ï¼Œå¹¶ä¸”å°†ä¸€ä¸ªå¥æŸ„fdè¿”å›ç»™ç”¨æˆ·æ€ï¼Œåç»­çš„æ“ä½œéƒ½æ˜¯åŸºäºæ­¤fdçš„ï¼Œå‚æ•°sizeæ˜¯å‘Šè¯‰å†…æ ¸è¿™ä¸ªç»“æ„çš„å…ƒç´ çš„å¤§å°ï¼Œç±»ä¼¼äºstlçš„vectoråŠ¨æ€æ•°ç»„ï¼Œå¦‚æœsizeä¸åˆé€‚ä¼šæ¶‰åŠå¤åˆ¶æ‰©å®¹ï¼Œä¸è¿‡è²Œä¼¼4.1.2å†…æ ¸ä¹‹åsizeå·²ç»æ²¡æœ‰å¤ªå¤§ç”¨é€”äº†ï¼› epoll_ctlæ˜¯å°†fdæ·»åŠ /åˆ é™¤äºepoll_createè¿”å›çš„epfdä¸­ï¼Œå…¶ä¸­epoll_eventæ˜¯ç”¨æˆ·æ€å’Œå†…æ ¸æ€äº¤äº’çš„ç»“æ„ï¼Œå®šä¹‰äº†ç”¨æˆ·æ€å…³å¿ƒçš„äº‹ä»¶ç±»å‹å’Œè§¦å‘æ—¶æ•°æ®çš„è½½ä½“epoll_dataï¼› epoll_wait*æ˜¯é˜»å¡ç­‰å¾…å†…æ ¸è¿”å›çš„å¯è¯»å†™äº‹ä»¶ï¼Œepfdè¿˜æ˜¯epoll_createçš„è¿”å›å€¼ï¼Œeventsæ˜¯ä¸ªç»“æ„ä½“æ•°ç»„æŒ‡é’ˆå­˜å‚¨epoll_eventï¼Œä¹Ÿå°±æ˜¯å°†å†…æ ¸è¿”å›çš„å¾…å¤„ç†epoll_eventç»“æ„éƒ½å­˜å‚¨ä¸‹æ¥ï¼Œmaxeventså‘Šè¯‰å†…æ ¸æœ¬æ¬¡è¿”å›çš„æœ€å¤§fdæ•°é‡ï¼Œè¿™ä¸ªå’ŒeventsæŒ‡å‘çš„æ•°ç»„æ˜¯ç›¸å…³çš„ï¼› epoll_waitæ˜¯ç”¨æˆ·æ€éœ€ç›‘æ§fdçš„ä»£è¨€äººï¼Œåç»­ç”¨æˆ·ç¨‹åºå¯¹fdçš„æ“ä½œéƒ½æ˜¯åŸºäºæ­¤ç»“æ„çš„ï¼›  epollä¾‹å­ æœåŠ¡ç«¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194  #include \u0026lt;netinet/in.h\u0026gt; // sockaddr_in#include \u0026lt;sys/types.h\u0026gt; // socket#include \u0026lt;sys/socket.h\u0026gt; // socket#include \u0026lt;arpa/inet.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;#include \u0026lt;sys/epoll.h\u0026gt; // epoll#include \u0026lt;sys/ioctl.h\u0026gt;#include \u0026lt;sys/time.h\u0026gt;#include \u0026lt;iostream\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;string\u0026gt;#include \u0026lt;cstdlib\u0026gt;#include \u0026lt;cstdio\u0026gt;#include \u0026lt;cstring\u0026gt;using namespace std; #define BUFFER_SIZE 1024#define EPOLLSIZE 100 struct PACKET_HEAD { int length; }; class Server { private: struct sockaddr_in server_addr; socklen_t server_addr_len; int listen_fd; // ç›‘å¬çš„fd  int epfd; // epoll fd  struct epoll_event events[EPOLLSIZE]; // epoll_waitè¿”å›çš„å°±ç»ªäº‹ä»¶ public: Server(int port); ~Server(); void Bind(); void Listen(int queue_len = 20); void Accept(); void Run(); void Recv(int fd); }; Server::Server(int port) { bzero(\u0026amp;server_addr, sizeof(server_addr)); server_addr.sin_family = AF_INET; server_addr.sin_addr.s_addr = htons(INADDR_ANY); server_addr.sin_port = htons(port); // create socket to listen  listen_fd = socket(PF_INET, SOCK_STREAM, 0); if (listen_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Create Socket Failed!\u0026#34;; exit(1); } int opt = 1; setsockopt(listen_fd, SOL_SOCKET, SO_REUSEADDR, \u0026amp;opt, sizeof(opt)); } Server::~Server() { close(epfd); } void Server::Bind() { if (-1 == (bind(listen_fd, (struct sockaddr *)\u0026amp;server_addr, sizeof(server_addr)))) { cout \u0026lt;\u0026lt; \u0026#34;Server Bind Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Bind Successfully.\\n\u0026#34;; } void Server::Listen(int queue_len) { if (-1 == listen(listen_fd, queue_len)) { cout \u0026lt;\u0026lt; \u0026#34;Server Listen Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;Listen Successfully.\\n\u0026#34;; } void Server::Accept() { struct sockaddr_in client_addr; socklen_t client_addr_len = sizeof(client_addr); int new_fd = accept(listen_fd, (struct sockaddr *)\u0026amp;client_addr, \u0026amp;client_addr_len); if (new_fd \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;Server Accept Failed!\u0026#34;; exit(1); } cout \u0026lt;\u0026lt; \u0026#34;new connection was accepted.\\n\u0026#34;; // åœ¨epfdä¸­æ³¨å†Œæ–°å»ºç«‹çš„è¿æ¥  struct epoll_event event; event.data.fd = new_fd; event.events = EPOLLIN; epoll_ctl(epfd, EPOLL_CTL_ADD, new_fd, \u0026amp;event); } void Server::Run() { epfd = epoll_create(1); // åˆ›å»ºepollå¥æŸ„  struct epoll_event event; event.data.fd = listen_fd; event.events = EPOLLIN; epoll_ctl(epfd, EPOLL_CTL_ADD, listen_fd, \u0026amp;event); // æ³¨å†Œlisten_fd  while (1) { int nums = epoll_wait(epfd, events, EPOLLSIZE, -1); if (nums \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;poll() error!\u0026#34;; exit(1); } if (nums == 0) { continue; } for (int i = 0; i \u0026lt; nums; ++i) // éå†æ‰€æœ‰å°±ç»ªäº‹ä»¶  { int fd = events[i].data.fd; if ((fd == listen_fd) \u0026amp;\u0026amp; (events[i].events \u0026amp; EPOLLIN)) Accept(); // æœ‰æ–°çš„å®¢æˆ·ç«¯è¯·æ±‚  else if (events[i].events \u0026amp; EPOLLIN) Recv(fd); // è¯»æ•°æ®  else ; } } } void Server::Recv(int fd) { bool close_conn = false; // æ ‡è®°å½“å‰è¿æ¥æ˜¯å¦æ–­å¼€äº†  PACKET_HEAD head; recv(fd, \u0026amp;head, sizeof(head), 0); // å…ˆæ¥å—åŒ…å¤´ï¼Œå³æ•°æ®æ€»é•¿åº¦  char *buffer = new char[head.length]; bzero(buffer, head.length); int total = 0; while (total \u0026lt; head.length) { int len = recv(fd, buffer + total, head.length - total, 0); if (len \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;recv() error!\u0026#34;; close_conn = true; break; } total = total + len; } if (total == head.length) // å°†æ”¶åˆ°çš„æ¶ˆæ¯åŸæ ·å‘å›ç»™å®¢æˆ·ç«¯  { int ret1 = send(fd, \u0026amp;head, sizeof(head), 0); int ret2 = send(fd, buffer, head.length, 0); if (ret1 \u0026lt; 0 || ret2 \u0026lt; 0) { cout \u0026lt;\u0026lt; \u0026#34;send() error!\u0026#34;; close_conn = true; } } delete buffer; if (close_conn) // å½“å‰è¿™ä¸ªè¿æ¥æœ‰é—®é¢˜ï¼Œå…³é—­å®ƒ  { close(fd); struct epoll_event event; event.data.fd = fd; event.events = EPOLLIN; epoll_ctl(epfd, EPOLL_CTL_DEL, fd, \u0026amp;event); // Deleteä¸€ä¸ªfd  } } int main() { Server server(15000); server.Bind(); server.Listen(); server.Run(); return 0; }   æ€»ç»“ï¼š\næ¯æ¬¡è°ƒç”¨poll/selectç³»ç»Ÿè°ƒç”¨ï¼Œæ“ä½œç³»ç»Ÿéƒ½è¦æŠŠcurrentï¼ˆå½“å‰è¿›ç¨‹ï¼‰æŒ‚åˆ°fdå¯¹åº”çš„æ‰€æœ‰è®¾å¤‡çš„ç­‰å¾…é˜Ÿåˆ—ä¸Šï¼Œå¯ä»¥æƒ³è±¡ï¼Œfdå¤šåˆ°ä¸Šåƒçš„æ—¶å€™ï¼Œè¿™æ ·â€œæŒ‚â€æ³•å¾ˆè´¹äº‹ï¼›è€Œæ¯æ¬¡è°ƒç”¨epoll_waitåˆ™æ²¡æœ‰è¿™ä¹ˆç½—å—¦ï¼Œepollåªåœ¨epoll_ctlæ—¶æŠŠcurrentæŒ‚ä¸€éï¼ˆè¿™ç¬¬ä¸€éæ˜¯å…ä¸äº†çš„ï¼‰å¹¶ç»™æ¯ä¸ªfdä¸€ä¸ªå‘½ä»¤â€œå¥½äº†å°±è°ƒå›è°ƒå‡½æ•°â€ï¼Œå¦‚æœè®¾å¤‡æœ‰äº‹ä»¶äº†ï¼Œé€šè¿‡å›è°ƒå‡½æ•°ï¼Œä¼šæŠŠfdæ”¾å…¥rdllistï¼Œè€Œæ¯æ¬¡è°ƒç”¨epoll_waitå°±åªæ˜¯æ”¶é›†rdllisté‡Œçš„fdå°±å¯ä»¥äº†â€”â€”epollå·§å¦™çš„åˆ©ç”¨å›è°ƒå‡½æ•°ï¼Œå®ç°äº†æ›´é«˜æ•ˆçš„äº‹ä»¶é©±åŠ¨æ¨¡å‹ã€‚\nepollå·¥ä½œæ¨¡å¼ LTæ¨¡å¼ LT(level triggered)æ˜¯ç¼ºçœçš„å·¥ä½œæ–¹å¼ï¼Œå¹¶ä¸”åŒæ—¶æ”¯æŒblockå’Œno-block socketã€‚åœ¨è¿™ç§åšæ³•ä¸­ï¼Œå†…æ ¸å‘Šè¯‰ä½ ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦æ˜¯å¦å°±ç»ªäº†ï¼Œç„¶åä½ å¯ä»¥å¯¹è¿™ä¸ªå°±ç»ªçš„fdè¿›è¡ŒIOæ“ä½œã€‚å¦‚æœä½ ä¸ä½œä»»ä½•æ“ä½œï¼Œå†…æ ¸è¿˜æ˜¯ä¼šç»§ç»­é€šçŸ¥ä½ çš„ï¼Œæ‰€ä»¥ï¼Œè¿™ç§æ¨¡å¼ç¼–ç¨‹å‡ºé”™è¯¯å¯èƒ½æ€§è¦å°ä¸€ç‚¹ã€‚ä¼ ç»Ÿçš„select/polléƒ½æ˜¯è¿™ç§æ¨¡å‹çš„ä»£è¡¨ã€‚\nETæ¨¡å¼ ET (edge-triggered) æ˜¯é«˜é€Ÿå·¥ä½œæ–¹å¼ï¼Œåªæ”¯æŒno-block socket(éé˜»å¡)ã€‚ åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå½“æè¿°ç¬¦ä»æœªå°±ç»ªå˜ä¸ºå°±ç»ªæ—¶ï¼Œå†…æ ¸å°±é€šè¿‡epollå‘Šè¯‰ä½ ï¼Œç„¶åå®ƒä¼šå‡è®¾ä½ çŸ¥é“æ–‡ä»¶æè¿°ç¬¦å·²ç»å°±ç»ªï¼Œå¹¶ä¸”ä¸ä¼šå†ä¸ºé‚£ä¸ªæ–‡ä»¶æè¿°ç¬¦å‘é€æ›´å¤šçš„ å°±ç»ªé€šçŸ¥ï¼Œç›´åˆ°ä½ åšäº†æŸäº›æ“ä½œè€Œå¯¼è‡´é‚£ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¸å†æ˜¯å°±ç»ªçŠ¶æ€(æ¯”å¦‚ ä½ åœ¨å‘é€ï¼Œæ¥æ”¶æˆ–æ˜¯æ¥å—è¯·æ±‚ï¼Œæˆ–è€…å‘é€æ¥æ”¶çš„æ•°æ®å°‘äºä¸€å®šé‡æ—¶å¯¼è‡´äº†ä¸€ä¸ªEWOULDBLOCK é”™è¯¯)ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼Œå¦‚æœä¸€ç›´ä¸å¯¹è¿™ä¸ªfdä½œIOæ“ä½œ(ä»è€Œå¯¼è‡´å®ƒå†æ¬¡å˜æˆæœªå°±ç»ª)ï¼Œå†…æ ¸å°±ä¸ä¼šå‘é€æ›´å¤šçš„é€šçŸ¥(only once)ã€‚ä¸è¿‡åœ¨TCPåè®®ä¸­ï¼ŒETæ¨¡å¼çš„åŠ é€Ÿæ•ˆç”¨ä»éœ€è¦æ›´å¤šçš„benchmarkç¡®è®¤ã€‚\nå‚è€ƒï¼š\n IOå¤šè·¯å¤ç”¨ä¹‹selectæ€»ç»“ IOå¤šè·¯å¤ç”¨ä¹‹pollæ€»ç»“ IOå¤šè·¯å¤ç”¨ä¹‹epollæ€»ç»“ Linux IOæ¨¡å¼åŠ selectã€pollã€epollè¯¦è§£ selectè¯¦è§£ Linuxä¸‹çš„I/Oå¤ç”¨ä¸epollè¯¦è§£ èŠèŠåŒæ­¥ã€å¼‚æ­¥ã€é˜»å¡ä¸éé˜»å¡ èŠèŠLinux äº”ç§IOæ¨¡å‹ èŠèŠIOå¤šè·¯å¤ç”¨ä¹‹selectã€pollã€epollè¯¦è§£ Linux IOæ¨¡å¼åŠ selectã€pollã€epollè¯¦è§£ å½»åº•å­¦ä¼šä½¿ç”¨epoll(ä¸€)â€”â€”ETæ¨¡å¼å®ç°åˆ†æ epoll æˆ–è€… kqueue çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ epolläº‹ä»¶å¤„ç†æœºåˆ¶è¯¦è§£ å¦‚æœè¿™ç¯‡æ–‡ç« è¯´ä¸æ¸…epollçš„æœ¬è´¨ï¼Œé‚£å°±è¿‡æ¥ææ­»æˆ‘å§ selectã€pollã€epollæ•´ç†æ€»ç»“  ","description":"æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¤šè·¯å¤ç”¨ä¸­çš„ä¸‰ç§æ¨¡å‹ï¼Œå®ƒä»¬æ˜¯è¿­ä»£æ›´æ–°çš„ç»“æœã€‚ç°åœ¨å¸¸ç”¨çš„ä¼šæ˜¯Epollã€‚","id":5,"section":"posts","tags":["Epoll","Select","Poll"],"title":"Select Poll Epoll è¯¦è§£","uri":"https://hugo.jiahongw.com/zh/posts/linux/select-poll-epoll/"},{"content":"è™šæ‹Ÿå­˜å‚¨å™¨ä½œä¸ºç°ä»£æ“ä½œç³»ç»Ÿä¸­å­˜å‚¨å™¨ç®¡ç†çš„ä¸€é¡¹é‡è¦æŠ€æœ¯ï¼Œå®ç°äº†å†…å­˜æ‰©å……åŠŸèƒ½ã€‚**ä½†è¯¥åŠŸèƒ½å¹¶éæ˜¯ä»ç‰©ç†ä¸Šå®é™…åœ°æ‰©å¤§å†…å­˜çš„å®¹é‡ï¼Œè€Œæ˜¯ä»é€»è¾‘ä¸Šå®ç°å¯¹å†…å­˜å®¹é‡çš„æ‰©å……ï¼Œè®©ç”¨æˆ·æ‰€æ„Ÿè§‰åˆ°çš„å†…å­˜å®¹é‡æ¯”å®é™…å†…å­˜å®¹é‡å¤§å¾—å¤šã€‚**äºæ˜¯ä¾¿å¯ä»¥è®©æ¯”å†…å­˜ç©ºé—´æ›´å¤§çš„ç¨‹åºè¿è¡Œï¼Œæˆ–è€…è®©æ›´å¤šçš„ç”¨æˆ·ç¨‹åºå¹¶å‘è¿è¡Œã€‚è¿™æ ·æ—¢æ»¡è¶³äº†ç”¨æˆ·çš„éœ€è¦ï¼Œåˆæ”¹å–„äº†ç³»ç»Ÿçš„æ€§èƒ½ã€‚\nè™šæ‹Ÿå†…å­˜æ˜¯æ“ä½œç³»ç»Ÿç‰©ç†å†…å­˜å’Œè¿›ç¨‹ä¹‹é—´çš„ä¸­é—´å±‚ï¼Œå®ƒä¸ºè¿›ç¨‹éšè—äº†ç‰©ç†å†…å­˜è¿™ä¸€æ¦‚å¿µï¼Œä¸ºè¿›ç¨‹æä¾›äº†æ›´åŠ ç®€æ´å’Œæ˜“ç”¨çš„æ¥å£ä»¥åŠæ›´åŠ å¤æ‚çš„åŠŸèƒ½ã€‚\næˆ‘ä»¬å¯ä»¥å°†è™šæ‹Ÿå†…å­˜çœ‹ä½œæ˜¯åœ¨ç£ç›˜ä¸Šä¸€ç‰‡ç©ºé—´ï¼Œå½“è¿™ç‰‡ç©ºé—´ä¸­çš„ä¸€éƒ¨åˆ†è®¿é—®æ¯”è¾ƒé¢‘ç¹æ—¶ï¼Œè¯¥éƒ¨åˆ†æ•°æ®ä¼šä»¥é¡µä¸ºå•ä½è¢«ç¼“å­˜åˆ°ä¸»å­˜ä¸­ä»¥åŠ é€Ÿ CPU è®¿é—®æ•°æ®çš„æ€§\nèƒ½ï¼Œè™šæ‹Ÿå†…å­˜åˆ©ç”¨ç©ºé—´è¾ƒå¤§çš„ç£ç›˜å­˜å‚¨ä½œä¸ºã€å†…å­˜ã€å¹¶ä½¿ç”¨ä¸»å­˜å‚¨ç¼“å­˜è¿›è¡ŒåŠ é€Ÿï¼Œè®©ä¸Šå±‚è®¤ä¸ºæ“ä½œç³»ç»Ÿçš„å†…å­˜å¾ˆå¤§è€Œä¸”å¾ˆå¿«ï¼Œç„¶è€ŒåŒºåŸŸå¾ˆå¤§çš„ç£ç›˜å¹¶ä¸å¿«ï¼Œè€Œå¾ˆå¿«çš„å†…å­˜ä¹Ÿå¹¶ä¸å¤§ã€‚\nLinuxä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿå†…å­˜:\n ä¸ºåº”ç”¨ç¨‹åºæä¾›çœ‹èµ·æ¥å®¹é‡è¶³å¤Ÿå¤§ä¸”è®¿é—®è¶³å¤Ÿå¿«çš„å­˜å‚¨ã€‚ é€šè¿‡å…±äº«ä»£ç åº“ä»¥å‡å°‘ç‰©ç†å†…å­˜çš„å¼€é”€ã€‚è®©æ”¹åŠ¨å°½å¯èƒ½çš„å°‘ã€‚ é€šè¿‡åˆ†é…è¿ç»­çš„è™šæ‹Ÿå†…å­˜ï¼ˆç‰©ç†å†…å­˜ä¸Šä¸ä¸€å®šè¿ç»­ï¼‰ ç®€åŒ–å†…å­˜çš„è¿æ¥ã€åˆ†é…è¿‡ç¨‹ã€‚ é€šè¿‡ç»™å„ä¸ªè¿›ç¨‹åˆ†é…ä¸åŒçš„è™šæ‹Ÿå†…å­˜ç©ºé—´å®ç°å†…å­˜è®¿é—®ä¸Šçš„éš”ç¦»ï¼Œæä¾›äº†ä¸€å®šçš„å®‰å…¨æ€§ã€‚   æ‹“å±•ï¼š\nâ€‹\tå½“æˆ‘ä»¬åœ¨ Linux ä¸­è°ƒç”¨ fork åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œå®é™…ä¸Šåªå¤åˆ¶äº†çˆ¶è¿›ç¨‹çš„é¡µè¡¨ã€‚\n é—®é¢˜â“  å½“æœ‰ä¸€ä¸ªä½œä¸šå¾ˆå¤§ï¼Œè¶…è¿‡äº†å†…å­˜çš„æ€»å®¹é‡ï¼Œä½œä¸šä¸èƒ½å…¨éƒ¨è£…å…¥å†…å­˜æ€ä¹ˆåŠï¼Ÿ æœ‰å¤§é‡ä½œä¸šéœ€è¦è¿è¡Œï¼Œä½†æ˜¯ç”±äºå†…å­˜å®¹é‡ä¸è¶³ä»¥å®¹çº³è¿™äº›æ‰€æœ‰çš„ä½œä¸šæ€ä¹ˆåŠï¼Ÿ(å…ˆæ‰§è¡Œä¸€éƒ¨åˆ†)  è§£å†³åŠæ³•ï¼š\n å¢åŠ ç‰©ç†å†…å­˜å®¹é‡ é€»è¾‘ä¸Šæ‰©å……å†…å­˜å®¹é‡(è™šæ‹Ÿå†…å­˜æ–¹æ³•)  å±€éƒ¨æ€§åŸç†ğŸ¥‡ ç¨‹åºåœ¨æ‰§è¡Œæ—¶å°†å‘ˆç°å‡ºå±€éƒ¨æ€§è§„å¾‹ï¼Œå³åœ¨ä¸€è¾ƒçŸ­çš„æ—¶é—´å†…ï¼Œç¨‹åºçš„æ‰§è¡Œä»…å±€é™äºæŸä¸ªéƒ¨åˆ†ï¼Œç›¸åº”åœ°ï¼Œå®ƒæ‰€è®¿é—®çš„å­˜å‚¨ç©ºé—´ä¹Ÿå±€é™äºæŸä¸ªåŒºåŸŸã€‚\n æ—¶é—´å±€éƒ¨æ€§ï¼šè®¿é—®æœ€è¿‘è®¿é—®è¿‡çš„ç©ºé—´çš„å¯èƒ½æ€§è¾ƒå¤§ã€‚ ç©ºé—´å±€éƒ¨æ€§ï¼šè®¿é—®å½“å‰ç©ºé—´å‘¨å›´çš„ç©ºé—´çš„å¯èƒ½è¾ƒå¤§ã€‚   å±€éƒ¨æ€§åŸç†ä½¿å¾—è™šæ‹Ÿå­˜å‚¨æŠ€æœ¯çš„å®ç°æˆä¸ºå¯èƒ½ã€‚\n åŸºäºå±€éƒ¨æ€§åŸç†å¯çŸ¥ï¼Œåº”ç”¨ç¨‹åºåœ¨è¿è¡Œä¹‹å‰æ²¡æœ‰å¿…è¦å°†ä¹‹å…¨éƒ¨è£…å…¥å†…å­˜ï¼Œè€Œä»…é¡»å°†é‚£äº›å½“å‰è¦è¿è¡Œçš„å°‘æ•°é¡µé¢æˆ–æ®µå…ˆè£…å…¥å†…å­˜ä¾¿å¯è¿è¡Œï¼Œå…¶ä½™éƒ¨åˆ†æš‚ç•™åœ¨ç›˜ä¸Šã€‚ç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œå¦‚æœå®ƒæ‰€è¦è®¿é—®çš„é¡µ(æ®µ)å·²è°ƒå…¥å†…å­˜ï¼Œä¾¿å¯ç»§ç»­æ‰§è¡Œä¸‹å»ï¼›ä½†å¦‚æœç¨‹åºæ‰€è¦è®¿é—®çš„é¡µ(æ®µ)å°šæœªè°ƒå…¥å†…å­˜(ç§°ä¸ºç¼ºé¡µæˆ–ç¼ºæ®µ)ï¼Œä¾¿å‘å‡ºç¼ºé¡µ(æ®µ)ä¸­æ–­è¯·æ±‚ï¼Œæ­¤æ—¶ OS å°†åˆ©ç”¨è¯·æ±‚è°ƒé¡µ(æ®µ)åŠŸèƒ½å°†å®ƒä»¬è°ƒå…¥å†…å­˜ï¼Œä»¥ä½¿è¿›ç¨‹èƒ½ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚å¦‚æœæ­¤æ—¶å†…å­˜å·²æ»¡ï¼Œæ— æ³•å†è£…å…¥æ–°çš„é¡µ(æ®µ)ï¼ŒOS è¿˜é¡»å†åˆ©ç”¨é¡µ(æ®µ)çš„ç½®æ¢åŠŸèƒ½ï¼Œå°†å†…å­˜ä¸­æš‚æ—¶ä¸ç”¨çš„é¡µ(æ®µ)è°ƒè‡³ç›˜ä¸Šï¼Œè…¾å‡ºè¶³å¤Ÿçš„å†…å­˜ç©ºé—´åï¼Œå†å°†è¦è®¿é—®çš„é¡µ(æ®µ)è°ƒå…¥å†…å­˜ï¼Œä½¿ç¨‹åºç»§ç»­æ‰§è¡Œä¸‹å»ã€‚è¿™æ ·ï¼Œä¾¿å¯ä½¿ä¸€ä¸ªå¤§çš„ç”¨æˆ·ç¨‹åºåœ¨è¾ƒå°çš„å†…å­˜ç©ºé—´ä¸­è¿è¡Œï¼Œä¹Ÿå¯åœ¨å†…å­˜ä¸­åŒæ—¶è£…å…¥æ›´å¤šçš„è¿›ç¨‹ï¼Œä½¿å®ƒä»¬å¹¶å‘æ‰§è¡Œã€‚\nè™šæ‹Ÿå­˜å‚¨å™¨ğŸ“ å®šä¹‰ **æ‰€è°“è™šæ‹Ÿå­˜å‚¨å™¨ï¼Œæ˜¯æŒ‡å…·æœ‰è¯·æ±‚è°ƒå…¥åŠŸèƒ½å’Œç½®æ¢åŠŸèƒ½ï¼Œèƒ½ä»é€»è¾‘ä¸Šå¯¹å†…å­˜å®¹é‡åŠ ä»¥æ‰©å……çš„ä¸€ç§å­˜å‚¨å™¨ç³»ç»Ÿã€‚**å…¶é€»è¾‘å®¹é‡ç”±å†…å­˜å®¹é‡å’Œå¤–å­˜å®¹é‡ä¹‹å’Œæ‰€å†³å®šï¼Œå…¶è¿è¡Œé€Ÿåº¦æ¥è¿‘äºå†…å­˜é€Ÿåº¦ï¼Œè€Œæ¯ä½çš„æˆæœ¬å´åˆæ¥è¿‘äºå¤–å­˜ã€‚\n å½“ç”¨æˆ·çœ‹åˆ°è‡ªå·±çš„ç¨‹åºèƒ½åœ¨ç³»ç»Ÿä¸­æ­£å¸¸è¿è¡Œæ—¶ï¼Œä»–ä¼šè®¤ä¸ºï¼Œè¯¥ç³»ç»Ÿæ‰€å…·æœ‰çš„å†…å­˜å®¹é‡ä¸€å®šæ¯”è‡ªå·±çš„ç¨‹åºå¤§ï¼Œæˆ–è€…è¯´ï¼Œç”¨æˆ·æ‰€æ„Ÿè§‰åˆ°çš„å†…å­˜å®¹é‡ä¼šæ¯”å®é™…å†…å­˜å®¹é‡å¤§å¾—å¤šã€‚ä½†ç”¨æˆ·æ‰€çœ‹åˆ°çš„å¤§å®¹é‡åªæ˜¯ä¸€ç§é”™è§‰ï¼Œæ˜¯è™šçš„ï¼Œæ•…äººä»¬æŠŠè¿™æ ·çš„å­˜å‚¨å™¨ç§°ä¸ºè™šæ‹Ÿå­˜å‚¨å™¨ã€‚\n è™šæ‹Ÿå­˜å‚¨å™¨å¹¶éå¯ä»¥æ— é™å¤§ï¼Œå…¶å®¹é‡å—å¤–å­˜å¤§å°å’ŒæŒ‡ä»¤ä¸­åœ°å€é•¿åº¦ä¸¤æ–¹é¢çš„é™åˆ¶ã€‚\nç‰¹å¾  å¤šæ¬¡æ€§ å¯¹æ¢æ€§ è™šæ‹Ÿæ€§  å®ç°æ–¹æ³• æ‰€æœ‰çš„è™šæ‹Ÿå­˜å‚¨å™¨éƒ½æ˜¯é‡‡ç”¨ä¸‹è¿°æ–¹å¼ä¹‹ä¸€å®ç°çš„ï¼š\n è¯·æ±‚åˆ†é¡µç³»ç»Ÿ è¯·æ±‚åˆ†æ®µç³»ç»Ÿ  è¯·æ±‚åˆ†é¡µå­˜å‚¨ç®¡ç†æ–¹å¼ è¯·æ±‚åˆ†é¡µç³»ç»Ÿæ˜¯å»ºç«‹åœ¨åŸºæœ¬åˆ†é¡µåŸºç¡€ä¸Šçš„ï¼Œä¸ºäº†èƒ½æ”¯æŒè™šæ‹Ÿå­˜å‚¨å™¨åŠŸèƒ½ï¼Œè€Œå¢åŠ äº†è¯·æ±‚è°ƒé¡µåŠŸèƒ½å’Œé¡µé¢ç½®æ¢åŠŸèƒ½ã€‚ç›¸åº”åœ°ï¼Œæ¯æ¬¡è°ƒå…¥å’Œæ¢å‡ºçš„åŸºæœ¬å•ä½éƒ½æ˜¯é•¿åº¦å›ºå®šçš„é¡µé¢ï¼Œè¿™ä½¿å¾—è¯·æ±‚åˆ†é¡µç³»ç»Ÿåœ¨å®ç°ä¸Šè¦æ¯”è¯·æ±‚åˆ†æ®µç³»ç»Ÿç®€å•(åè€…åœ¨æ¢è¿›å’Œæ¢å‡ºæ—¶æ˜¯å¯å˜é•¿åº¦çš„æ®µ)ã€‚å› æ­¤ï¼Œè¯·æ±‚åˆ†é¡µä¾¿æˆä¸ºç›®å‰æœ€å¸¸ç”¨çš„ä¸€ç§å®ç°è™šæ‹Ÿå­˜å‚¨å™¨çš„æ–¹å¼ã€‚\nè¯·æ±‚é¡µè¡¨æœºåˆ¶(åŸºæœ¬åŸç†) åœ¨è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­éœ€è¦çš„ä¸»è¦æ•°æ®ç»“æ„æ˜¯è¯·æ±‚é¡µè¡¨ï¼Œå…¶åŸºæœ¬ä½œç”¨ä»ç„¶æ˜¯å°†ç”¨æˆ·åœ°å€ç©ºé—´ä¸­çš„é€»è¾‘åœ°å€æ˜ å°„ä¸ºå†…å­˜ç©ºé—´ä¸­çš„ç‰©ç†åœ°å€ã€‚ä¸ºäº†æ»¡è¶³é¡µé¢æ¢è¿›æ¢å‡ºçš„éœ€è¦ï¼Œåœ¨è¯·æ±‚é¡µè¡¨ä¸­åˆå¢åŠ äº†å››ä¸ªå­—æ®µã€‚è¿™æ ·ï¼Œåœ¨è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­çš„æ¯ä¸ªé¡µè¡¨åº”å«ä»¥ä¸‹è¯¸é¡¹(é…åˆclockç½®æ¢ç®—æ³•)ï¼š\nå­—æ®µè¯´æ˜ï¼š\n çŠ¶æ€ä½(P)ï¼šç”¨äºæŒ‡ç¤ºè¯¥é¡µæ˜¯å¦å·²è°ƒå…¥å†…å­˜ï¼Œä¾›ç¨‹åºè®¿é—®æ—¶å‚è€ƒã€‚ è®¿é—®å­—æ®µ(A)ï¼šè®°å½•æœ¬é¡µåœ¨ä¸€æ®µæ—¶é—´å†…è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæˆ–è€…è®°å½•æœ¬é¡µæœ€è¿‘å·²æœ‰å¤šä¹…æ—¶é—´æœªè¢«è®¿é—®ï¼Œä¾›ç½®æ¢ç®—æ³•åœ¨é€‰æ‹©æ¢å‡ºé¡µé¢æ—¶å‚è€ƒã€‚ ä¿®æ”¹ä½(M)ï¼šè¡¨ç¤ºè¯¥é¡µåœ¨è°ƒå…¥å†…å­˜ä¹‹åæœ‰æ²¡æœ‰è¢«ä¿®æ”¹ã€‚ä¾›ç½®æ¢é¡µé¢æ—¶å‚è€ƒã€‚æœªä¿®æ”¹åˆ™æ— éœ€å†™å…¥å¤–å­˜ã€‚ å¤–å­˜åœ°å€ï¼šç”¨äºæŒ‡å‡ºè¯¥é¡µåœ¨å¤–å­˜ä¸Šçš„åœ°å€ï¼Œé€šå¸¸æ˜¯ç‰©ç†å—å·åœ°å€ï¼Œä¾›è°ƒå…¥è¯¥é¡µæ—¶å‚è€ƒã€‚  ç¼ºé¡µä¸­æ–­æœºæ„ åœ¨è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­ï¼Œæ¯å½“æ‰€è¦è®¿é—®çš„é¡µé¢ä¸åœ¨å†…å­˜æ—¶ï¼Œä¾¿äº§ç”Ÿä¸€ç¼ºé¡µä¸­æ–­ï¼Œè¯·æ±‚ OSå°†ç¼ºçš„é¡µè°ƒå…¥å†…å­˜ã€‚\n**ç¼ºé¡µä¸­æ–­ä½œä¸ºä¸­æ–­ï¼Œå®ƒä»¬åŒæ ·éœ€è¦ç»å†è¯¸å¦‚ä¿æŠ¤ CPU ç¯å¢ƒã€åˆ†æä¸­æ–­åŸå› ã€è½¬å…¥ç¼ºé¡µä¸­æ–­å¤„ç†ç¨‹åºè¿›è¡Œå¤„ç†ï¼Œä»¥åŠåœ¨ä¸­æ–­å¤„ç†å®Œæˆåå†æ¢å¤ CPU ç¯å¢ƒç­‰å‡ ä¸ªæ­¥éª¤ã€‚**ä½†ç¼ºé¡µä¸­æ–­åˆæ˜¯ä¸€ç§ç‰¹æ®Šçš„ä¸­æ–­ï¼Œå®ƒä¸ä¸€èˆ¬çš„ä¸­æ–­ç›¸æ¯”æœ‰ç€æ˜æ˜¾çš„åŒºåˆ«ï¼Œä¸»è¦è¡¨ç°åœ¨ä¸‹é¢ä¸¤ä¸ªæ–¹é¢ï¼š\n åœ¨æŒ‡ä»¤æ‰§è¡ŒæœŸé—´äº§ç”Ÿå’Œå¤„ç†ä¸­æ–­ä¿¡å·ã€‚ ä¸€æ¡æŒ‡ä»¤åœ¨æ‰§è¡ŒæœŸé—´å¯èƒ½äº§ç”Ÿå¤šæ¬¡ç¼ºé¡µä¸­æ–­ã€‚  åœ°å€å˜æ¢æœºæ„ è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­çš„åœ°å€å˜æ¢æœºæ„æ˜¯åœ¨åˆ†é¡µç³»ç»Ÿåœ°å€å˜æ¢æœºæ„çš„åŸºç¡€ä¸Šï¼Œä¸ºå®ç°è™šæ‹Ÿå­˜å‚¨å™¨ï¼Œå†å¢åŠ äº†æŸäº›åŠŸèƒ½æ‰€å½¢æˆçš„ï¼Œå¦‚äº§ç”Ÿå’Œå¤„ç†ç¼ºé¡µä¸­æ–­ï¼Œä»¥åŠä»å†…å­˜ä¸­æ¢å‡ºä¸€é¡µçš„åŠŸèƒ½ç­‰ç­‰ã€‚ä¸‹å›¾ç¤ºå‡ºäº†è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­çš„åœ°å€å˜æ¢è¿‡ç¨‹ï¼š\nåœ¨è¿›è¡Œåœ°å€å˜æ¢æ—¶ï¼Œé¦–å…ˆæ£€ç´¢å¿«è¡¨ï¼Œè¯•å›¾ä»ä¸­æ‰¾å‡ºæ‰€è¦è®¿é—®çš„é¡µã€‚è‹¥æ‰¾åˆ°ï¼Œä¾¿ä¿®æ”¹é¡µè¡¨é¡¹ä¸­çš„è®¿é—®ä½ï¼Œä¾›ç½®æ¢ç®—æ³•é€‰æ¢å‡ºé¡µé¢æ—¶å‚è€ƒã€‚å¯¹äºå†™æŒ‡ä»¤ï¼Œè¿˜é¡»å°†ä¿®æ”¹ä½ç½®æˆâ€œ1â€,è¡¨ç¤ºè¯¥é¡µåœ¨è°ƒå…¥å†…å­˜åå·²è¢«ä¿®æ”¹ã€‚ç„¶ååˆ©ç”¨é¡µè¡¨é¡¹ä¸­ç»™å‡ºçš„ç‰©ç†å—å·å’Œé¡µå†…åœ°å€å½¢æˆç‰©ç†åœ°å€ã€‚åœ°å€å˜æ¢è¿‡ç¨‹åˆ°æ­¤ç»“æŸã€‚\nå¦‚æœåœ¨å¿«è¡¨ä¸­æœªæ‰¾åˆ°è¯¥é¡µçš„é¡µè¡¨é¡¹ï¼Œåˆ™åº”åˆ°å†…å­˜ä¸­å»æŸ¥æ‰¾é¡µè¡¨ï¼Œå†ä»æ‰¾åˆ°çš„é¡µè¡¨é¡¹ä¸­çš„çŠ¶æ€ä½ P æ¥äº†è§£è¯¥é¡µæ˜¯å¦å·²è°ƒå…¥å†…å­˜ã€‚è‹¥è¯¥é¡µå·²è°ƒå…¥å†…å­˜ï¼Œè¿™æ—¶åº”å°†è¯¥é¡µçš„é¡µè¡¨é¡¹å†™å…¥å¿«è¡¨ã€‚å½“å¿«è¡¨å·²æ»¡æ—¶ï¼Œåˆ™åº”å…ˆè°ƒå‡ºæŒ‰æŸç§ç®—æ³•æ‰€ç¡®å®šçš„é¡µçš„é¡µè¡¨é¡¹ï¼Œç„¶åå†å†™å…¥è¯¥é¡µçš„é¡µè¡¨é¡¹ï¼›è‹¥è¯¥é¡µå°šæœªè°ƒå…¥å†…å­˜ï¼Œè¿™æ—¶åº”äº§ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œè¯·æ±‚ OS ä»å¤–å­˜æŠŠè¯¥é¡µè°ƒå…¥å†…å­˜ã€‚\nè¯·æ±‚åˆ†é¡µçš„å†…å­˜åˆ†é… ä¸‰ä¸ªé—®é¢˜ï¼š\n  æœ€å°ç‰©ç†å—æ•°çš„ç¡®å®šã€‚å…ˆåˆ†é…ç»™è¿›ç¨‹å¤šå°‘ç‰©ç†ç©ºé—´å®ƒæ‰èƒ½å…ˆæ­£å¸¸è¿è¡Œã€‚\n  å†…å­˜åˆ†é…ç­–ç•¥ã€‚\n  å›ºå®šåˆ†é…å±€éƒ¨ç½®æ¢\næ‰€è°“å›ºå®šåˆ†é…ï¼Œæ˜¯æŒ‡ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€ç»„å›ºå®šæ•°ç›®çš„ç‰©ç†å—ï¼Œåœ¨è¿›ç¨‹è¿è¡ŒæœŸé—´ä¸å†æ”¹å˜ã€‚æ‰€è°“å±€éƒ¨ç½®æ¢ï¼Œæ˜¯æŒ‡å¦‚æœè¿›ç¨‹åœ¨è¿è¡Œä¸­å‘ç°ç¼ºé¡µï¼Œåˆ™åªèƒ½ä»åˆ†é…ç»™è¯¥è¿›ç¨‹çš„ n ä¸ªé¡µè€Œä¸­é€‰å‡ºä¸€é¡µæ¢å‡ºï¼Œç„¶åå†è°ƒå…¥ä¸€é¡µï¼Œä»¥ä¿è¯åˆ†é…ç»™è¯¥è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸å˜ã€‚\n  å¯å˜åˆ†é…å…¨å±€ç½®æ¢\næ‰€è°“å¯å˜åˆ†é…ï¼Œæ˜¯æŒ‡å…ˆä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€å®šæ•°ç›®çš„ç‰©ç†å—ï¼Œåœ¨è¿›ç¨‹è¿è¡ŒæœŸé—´ï¼Œå¯æ ¹æ®æƒ…å†µåšé€‚å½“çš„å¢åŠ æˆ–å‡å°‘ã€‚æ‰€è°“å…¨å±€ç½®æ¢ï¼Œæ˜¯æŒ‡å¦‚æœè¿›ç¨‹åœ¨è¿è¡Œä¸­å‘ç°ç¼ºé¡µï¼Œåˆ™å°† OS æ‰€ä¿ç•™çš„ç©ºé—²ç‰©ç†å—(ä¸€èˆ¬ç»„ç»‡ä¸ºä¸€ä¸ªç©ºé—²ç‰©ç†å—é˜Ÿåˆ—)å–å‡ºä¸€å—åˆ†é…ç»™è¯¥è¿›ç¨‹ï¼Œæˆ–è€…ä»¥æ‰€æœ‰è¿›ç¨‹çš„å…¨éƒ¨ç‰©ç†å—ä¸ºæ ‡çš„ï¼Œé€‰æ‹©ä¸€å—æ¢å‡ºï¼Œç„¶åå°†æ‰€ç¼ºä¹‹é¡µè°ƒå…¥ã€‚è¿™æ ·ï¼Œåˆ†é…ç»™è¯¥è¿›ç¨‹çš„å†…å­˜ç©ºé—´å°±éšä¹‹å¢åŠ ã€‚\n  å¯å˜åˆ†é…å±€éƒ¨ç½®æ¢\nè¯¥ç­–ç•¥åŒæ ·æ˜¯åŸºäºè¿›ç¨‹çš„ç±»å‹æˆ–æ ¹æ®ç¨‹åºå‘˜çš„è¦æ±‚ï¼Œä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€å®šæ•°ç›®çš„ç‰©ç†å—ï¼Œä½†å½“æŸè¿›ç¨‹å‘ç°ç¼ºé¡µæ—¶ï¼Œåªå…è®¸ä»è¯¥è¿›ç¨‹åœ¨å†…å­˜çš„é¡µé¢ä¸­é€‰æ‹©ä¸€é¡µæ¢å‡ºï¼Œè¿™æ ·å°±ä¸ä¼šå½±å“å…¶å®ƒè¿›ç¨‹çš„è¿è¡Œã€‚å¦‚æœè¿›ç¨‹åœ¨è¿è¡Œä¸­é¢‘ç¹åœ°å‘ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œåˆ™ç³»ç»Ÿé¡»å†ä¸ºè¯¥è¿›ç¨‹åˆ†é…è‹¥å¹²é™„åŠ çš„ç‰©ç†å—ï¼Œç›´è‡³è¯¥è¿›ç¨‹çš„ç¼ºé¡µç‡å‡å°‘åˆ°é€‚å½“ç¨‹åº¦ä¸ºæ­¢ã€‚åä¹‹ï¼Œè‹¥ä¸€ä¸ªè¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­çš„ç¼ºé¡µç‡ç‰¹åˆ«ä½ï¼Œåˆ™æ­¤æ—¶å¯é€‚å½“å‡å°‘åˆ†é…ç»™è¯¥è¿›ç¨‹çš„ç‰©ç†å—æ•°ï¼Œä½†ä¸åº”å¼•èµ·å…¶ç¼ºé¡µç‡çš„æ˜æ˜¾å¢åŠ ã€‚\n    ç‰©ç†å—åˆ†é…ç®—æ³•\n å¹³å‡åˆ†é…ç®—æ³• æ¯”ä¾‹åˆ†é…ç®—æ³• è€ƒè™‘ä¼˜å…ˆæƒçš„åˆ†é…ç®—æ³•    é¡µé¢è°ƒå…¥ç­–ç•¥ é—®é¢˜ï¼š\n  ä½•æ—¶è°ƒå…¥é¡µé¢\n é¢„è°ƒé¡µç­–ç•¥ï¼Œä¸€æ¬¡è°ƒå…¥è‹¥å¹²ä¸ªç›¸é‚»çš„é¡µé¢ã€‚ è¯·æ±‚è°ƒé¡µæœºåˆ¶ï¼Œå½“è¯·æ±‚çš„é¡µé¢ä¸å­˜åœ¨å†…å­˜ï¼Œç”±OSå°†æ‰€éœ€é¡µé¢è°ƒå…¥å†…å­˜ã€‚    ä½•å¤„è°ƒå…¥é¡µé¢\nå°†è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­çš„å¤–å­˜åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šç”¨äºå­˜æ”¾æ–‡ä»¶çš„æ–‡ä»¶åŒºå’Œç”¨äºå­˜æ”¾å¯¹æ¢é¡µè€Œçš„å¯¹æ¢åŒºã€‚é€šå¸¸ï¼Œç”±äºå¯¹æ¢åŒºæ˜¯é‡‡ç”¨è¿ç»­åˆ†é…æ–¹å¼ï¼Œè€Œæ–‡ä»¶åŒºæ˜¯é‡‡ç”¨ç¦»æ•£åˆ†é…æ–¹å¼ï¼Œæ‰€ä»¥å¯¹æ¢åŒºçš„æ•°æ®å­˜å–(ç£ç›˜ I/O)é€Ÿåº¦æ¯”æ–‡ä»¶åŒºçš„é«˜ã€‚\n ç³»ç»Ÿæ‹¥æœ‰è¶³å¤Ÿçš„å¯¹æ¢åŒºç©ºé—´ï¼Œè¿™æ—¶å¯ä»¥å…¨éƒ¨ä»å¯¹æ¢åŒºè°ƒå…¥æ‰€éœ€é¡µé¢ï¼Œä»¥æé«˜è°ƒé¡µé€Ÿåº¦ã€‚ä¸ºæ­¤ï¼Œåœ¨è¿›ç¨‹è¿è¡Œå‰ï¼Œä¾¿é¡»å°†ä¸è¯¥è¿›ç¨‹æœ‰å…³çš„æ–‡ä»¶ä»æ–‡ä»¶åŒºæ‹·è´åˆ°å¯¹æ¢åŒºã€‚ ç³»ç»Ÿç¼ºå°‘è¶³å¤Ÿçš„å¯¹æ¢åŒºç©ºé—´ï¼Œè¿™æ—¶å‡¡æ˜¯ä¸ä¼šè¢«ä¿®æ”¹çš„æ–‡ä»¶ï¼Œéƒ½ç›´æ¥ä»æ–‡ä»¶åŒºè°ƒå…¥ï¼›è€Œå½“æ¢å‡ºè¿™äº›é¡µé¢æ—¶ï¼Œç”±äºå®ƒä»¬æœªè¢«ä¿®æ”¹ï¼Œåˆ™ä¸å¿…å†å°†å®ƒä»¬é‡å†™åˆ°ç£ç›˜(æ¢å‡º)ï¼Œä»¥åå†è°ƒå…¥æ—¶ï¼Œä»ä»æ–‡ä»¶åŒºç›´æ¥è°ƒå…¥ã€‚ä½†å¯¹äºé‚£äº›å¯èƒ½è¢«ä¿®æ”¹çš„éƒ¨åˆ†ï¼Œåœ¨å°†å®ƒä»¬æ¢å‡ºæ—¶ä¾¿é¡»è°ƒåˆ°å¯¹æ¢åŒºï¼Œä»¥åéœ€è¦æ—¶å†ä»å¯¹æ¢åŒºè°ƒå…¥ã€‚ UNIX æ–¹å¼ã€‚ç”±äºä¸è¿›ç¨‹æœ‰å…³çš„æ–‡ä»¶éƒ½æ”¾åœ¨æ–‡ä»¶åŒºï¼Œæ•…å‡¡æ˜¯æœªè¿è¡Œè¿‡çš„é¡µé¢ï¼Œéƒ½åº”ä»æ–‡ä»¶åŒºè°ƒå…¥ã€‚è€Œå¯¹äºæ›¾ç»è¿è¡Œè¿‡ä½†åˆè¢«æ¢å‡ºçš„é¡µé¢ï¼Œç”±äºæ˜¯è¢«æ”¾åœ¨å¯¹æ¢åŒºï¼Œå› æ­¤åœ¨ä¸‹æ¬¡è°ƒå…¥æ—¶åº”ä»å¯¹æ¢åŒºè°ƒå…¥ã€‚ç”±äº UNIX ç³»ç»Ÿå…è®¸é¡µé¢å…±äº«ï¼Œå› æ­¤ï¼ŒæŸè¿›ç¨‹æ‰€è¯·æ±‚çš„é¡µé¢æœ‰å¯èƒ½å·²è¢«å…¶å®ƒè¿›ç¨‹è°ƒå…¥å†…å­˜ï¼Œæ­¤æ—¶ä¹Ÿå°±æ— éœ€å†ä»å¯¹æ¢åŒºè°ƒå…¥ã€‚    é¡µé¢è°ƒå…¥è¿‡ç¨‹\næ¯å½“ç¨‹åºæ‰€è¦è®¿é—®çš„é¡µé¢æœªåœ¨å†…å­˜æ—¶(å­˜åœ¨ä½ä¸ºâ€œ0â€)ï¼Œä¾¿å‘ CPU å‘å‡ºä¸€ç¼ºé¡µä¸­æ–­ï¼Œä¸­æ–­å¤„ç†ç¨‹åºé¦–å…ˆä¿ç•™ CPU ç¯å¢ƒï¼Œåˆ†æä¸­æ–­åŸå› åè½¬å…¥ç¼ºé¡µä¸­æ–­å¤„ç†ç¨‹åºã€‚è¯¥ç¨‹åºé€šè¿‡æ³æ‰¾é¡µè¡¨å¾—åˆ°è¯¥é¡µåœ¨å¤–å­˜çš„ç‰©ç†å—åï¼Œå¦‚æœæ­¤æ—¶å†…å­˜èƒ½å®¹çº³æ–°é¡µï¼Œåˆ™å¯åŠ¨ç£ç›˜ I/Oï¼Œå°†æ‰€ç¼ºä¹‹é¡µè°ƒå…¥å†…å­˜ï¼Œç„¶åä¿®æ”¹é¡µè¡¨ã€‚å¦‚æœå†…å­˜å·²æ»¡ï¼Œåˆ™é¡»å…ˆæŒ‰ç…§æŸç§ç½®æ¢ç®—æ³•ï¼Œä»å†…å­˜ä¸­é€‰å‡ºä¸€é¡µå‡†å¤‡æ¢å‡ºï¼›å¦‚æœè¯¥é¡µæœªè¢«ä¿®æ”¹è¿‡(ä¿®æ”¹ä½ä¸ºâ€œ0â€)ï¼Œå¯ä¸å¿…å°†è¯¥é¡µå†™å›ç£ç›˜ï¼›ä½†å¦‚æœæ­¤é¡µå·²è¢«ä¿®æ”¹(ä¿®æ”¹ä½ä¸ºâ€œ1â€)ï¼Œåˆ™å¿…é¡»å°†å®ƒå†™å›ç£ç›˜ï¼Œç„¶åå†æŠŠæ‰€ç¼ºçš„é¡µè°ƒå…¥å†…å­˜ï¼Œå¹¶ä¿®æ”¹é¡µè¡¨ä¸­çš„ç›¸åº”è¡¨é¡¹ï¼Œç½®å…¶å­˜åœ¨ä½ä¸ºâ€œ1â€ï¼Œå¹¶å°†æ­¤é¡µè¡¨é¡¹å†™å…¥å¿«è¡¨ä¸­ã€‚åœ¨ç¼ºé¡µè°ƒå…¥å†…å­˜åï¼Œåˆ©ç”¨ä¿®æ”¹åçš„é¡µè¡¨å½¢æˆæ‰€è¦è®¿é—®æ•°æ®çš„ç‰©ç†åœ°å€ï¼Œå†å»è®¿é—®å†…å­˜æ•°æ®ã€‚æ•´ä¸ªé¡µé¢çš„è°ƒå…¥è¿‡ç¨‹å¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ã€‚\n  é¡µé¢ç½®æ¢ç®—æ³• ä¸é€‚å½“çš„ç®—æ³•å¯èƒ½ä¼šå¯¼è‡´è¿›ç¨‹å‘ç”Ÿâ€œæŠ–åŠ¨â€(Thrashing)ï¼Œå³åˆšè¢«æ¢å‡ºçš„é¡µå¾ˆå¿«åˆè¦è¢«è®¿é—®ï¼Œéœ€è¦å°†å®ƒé‡æ–°è°ƒå…¥ï¼Œæ­¤æ—¶åˆéœ€è¦å†é€‰ä¸€é¡µè°ƒå‡ºï¼›è€Œæ­¤åˆšè¢«è°ƒå‡ºçš„é¡µå¾ˆå¿«åˆè¢«è®¿é—®,åˆéœ€å°†å®ƒè°ƒå…¥ï¼Œå¦‚æ­¤é¢‘ç¹åœ°æ›´æ¢é¡µé¢ï¼Œä»¥è‡´ä¸€ä¸ªè¿›ç¨‹åœ¨è¿è¡Œä¸­æŠŠå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±è´¹åœ¨é¡µé¢ç½®æ¢å·¥ä½œä¸Šï¼Œæˆ‘ä»¬ç§°è¯¥è¿›ç¨‹å‘ç”Ÿäº†â€œæŠ–åŠ¨â€ã€‚\nå‡å®šç³»ç»Ÿä¸ºæŸè¿›ç¨‹åˆ†é…äº†ä¸‰ä¸ªç‰©ç†å—ï¼Œå¹¶è€ƒè™‘æœ‰ä»¥ä¸‹çš„é¡µé¢å·å¼•ç”¨ä¸²ï¼š\n7,0,1,2,0,3,0,4,2,3,0,3,2,1,2,0,1,7,0,1 æœ€ä½³ç½®æ¢ç®—æ³• æ˜¯ä¸€ç§ç†æƒ³åŒ–çš„ç®—æ³•ï¼Œå…·æœ‰æœ€å¥½çš„æ€§èƒ½ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯å®ç°ä¸äº†çš„ï¼Œä½†æ˜¯å¯ä»¥ä½œä¸ºè¯„ä¼°å…¶ä»–ç®—æ³•çš„ä¼˜åŠ£ã€‚é‡‡ç”¨è¿™ç§ç®—æ³•å¯ä»¥è·å–æœ€ä½çš„ç¼ºé¡µç‡ã€‚\nå…ˆè¿›å…ˆå‡ºç½®æ¢ç®—æ³• è¯¥ç®—æ³•æ€»æ˜¯æ·˜æ±°æœ€å…ˆè¿›å…¥å†…å­˜çš„é¡µé¢ï¼Œå³é€‰æ‹©åœ¨å†…å­˜ä¸­é©»ç•™æ—¶é—´æœ€ä¹…çš„é¡µé¢äºˆä»¥æ·˜æ±°ã€‚ç”¨é“¾è¡¨å°±èƒ½å¤Ÿå¾ˆå®¹æ˜“çš„å®ç°ã€‚\næœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç½®æ¢ç®—æ³•(LRU) FIFO ç½®æ¢ç®—æ³•çš„æ€§èƒ½ä¹‹æ‰€ä»¥è¾ƒå·®ï¼Œæ˜¯å› ä¸ºå®ƒæ‰€ä¾æ®çš„æ¡ä»¶æ˜¯å„ä¸ªé¡µé¢è°ƒå…¥å†…å­˜çš„æ—¶é—´ï¼Œè€Œé¡µé¢è°ƒå…¥çš„å…ˆåå¹¶ä¸èƒ½åæ˜ é¡µé¢çš„ä½¿ç”¨æƒ…å†µã€‚æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨(LRU)çš„é¡µé¢ç½®æ¢ç®—æ³•æ˜¯æ ¹æ®é¡µé¢è°ƒå…¥å†…å­˜åçš„ä½¿ç”¨æƒ…å†µåšå‡ºå†³ç­–çš„ã€‚ç”±äºæ— æ³•é¢„æµ‹å„é¡µé¢å°†æ¥çš„ä½¿ç”¨æƒ…å†µï¼Œåªèƒ½åˆ©ç”¨â€œæœ€è¿‘çš„è¿‡å»â€ä½œä¸ºâ€œæœ€è¿‘çš„å°†æ¥â€çš„è¿‘ä¼¼ï¼Œå› æ­¤ï¼ŒLRU ç½®æ¢ç®—æ³•æ˜¯é€‰æ‹©æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢äºˆä»¥æ·˜æ±°ã€‚è¯¥ç®—æ³•èµ‹äºˆæ¯ä¸ªé¡µé¢ä¸€ä¸ªè®¿é—®å­—æ®µï¼Œç”¨æ¥è®°å½•ä¸€ä¸ªé¡µè€Œè‡ªä¸Šæ¬¡è¢«è®¿é—®ä»¥æ¥æ‰€ç»å†çš„æ—¶é—´ tã€‚å½“éœ€æ·˜æ±°ä¸€ä¸ªé¡µé¢æ—¶ï¼Œé€‰æ‹©ç°æœ‰é¡µé¢ä¸­å…¶ t å€¼æœ€å¤§çš„ï¼Œå³æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢äºˆä»¥æ·˜æ±°ã€‚\nç®—æ³•å®ç°(ç¡¬ä»¶æ”¯æŒ)ï¼š\n  å¯„å­˜å™¨\nä¸ºäº†è®°å½•æŸè¿›ç¨‹åœ¨å†…å­˜ä¸­å„é¡µçš„ä½¿ç”¨æƒ…å†µï¼Œé¡»ä¸ºæ¯ä¸ªåœ¨å†…å­˜ä¸­çš„é¡µé¢é…ç½®ä¸€ä¸ªç§»ä½å¯„å­˜å™¨ï¼Œå¯è¡¨ç¤ºä¸ºï¼š\n$$\nR = R_{n-1}R_{n-2}R_{n-3} â€¦ R_2R_1R_0\n$$\nå½“è¿›ç¨‹è®¿é—®æŸç‰©ç†å—æ—¶ï¼Œè¦å°†ç›¸åº”å¯„å­˜å™¨çš„ $R_{n-1}$ä½ç½®æˆ 1ã€‚æ­¤æ—¶ï¼Œå®šæ—¶ä¿¡å·å°†æ¯éš”ä¸€å®šæ—¶é—´(ä¾‹å¦‚ 100 ms)å°†å¯„å­˜å™¨å³ç§»ä¸€ä½ã€‚å¦‚æœæˆ‘ä»¬æŠŠ n ä½å¯„å­˜å™¨çš„æ•°çœ‹ä½œæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œé‚£ä¹ˆï¼Œå…·æœ‰æœ€å°æ•°å€¼çš„å¯„å­˜å™¨æ‰€å¯¹åº”çš„é¡µé¢ï¼Œå°±æ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢ã€‚ä¸‹å›¾ä¸­ç¬¬ä¸‰ä¸ªå†…å­˜é¡µé¢çš„Rå€¼æœ€å°ï¼Œç¼ºé¡µæ—¶å› è¯¥è¢«æ¢å‡ºï¼š\n  ç‰¹æ®Šçš„æ ˆ\nå¯åˆ©ç”¨ä¸€ä¸ªç‰¹æ®Šçš„æ ˆä¿å­˜å½“å‰ä½¿ç”¨çš„å„ä¸ªé¡µé¢çš„é¡µé¢å·ã€‚æ¯å½“è¿›ç¨‹è®¿é—®æŸé¡µè€Œæ—¶ï¼Œä¾¿å°†è¯¥é¡µé¢çš„é¡µé¢å·ä»æ ˆä¸­ç§»å‡ºï¼Œå°†å®ƒå‹å…¥æ ˆé¡¶ã€‚å› æ­¤ï¼Œæ ˆé¡¶å§‹ç»ˆæ˜¯æœ€æ–°è¢«è®¿é—®é¡µé¢çš„ç¼–å·,è€Œæ ˆåº•åˆ™æ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨é¡µé¢çš„é¡µé¢å·ã€‚\n  map + åŒå‘é“¾è¡¨å®ç°LRUç®—æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75  struct MyNode { int k, v; MyNode(int tk = 0, int tv = 0) { k = tk; v = tv; } }; // @lc code=start class LRUCache { private: map\u0026lt;int, int\u0026gt; hashtable; list\u0026lt;MyNode *\u0026gt; cache; unsigned int capacity; public: LRUCache(int capacity) { this-\u0026gt;capacity = capacity; } int get(int key) { if (hashtable.find(key) != hashtable.end()) { MyNode *node = new MyNode(key, hashtable[key]); for (list\u0026lt;MyNode *\u0026gt;::iterator it = cache.begin(); it != cache.end(); it++) { if ((*it)-\u0026gt;k == key) { cache.erase(it); break; } } cache.push_front(node); return hashtable[key]; } return -1; } void put(int key, int value) { MyNode *node = new MyNode(key, value); if (hashtable.find(key) == hashtable.end()) { // ä¸å­˜åœ¨è¿™ä¸ªKey  if (hashtable.size() \u0026gt;= capacity) { // è¶…è¿‡å®¹é‡ï¼Œç§»é™¤é˜Ÿå°¾å…ƒç´   MyNode *rnode = cache.back(); cache.pop_back(); hashtable.erase(rnode-\u0026gt;k); } hashtable[key] = value; cache.push_front(node); } else { // å­˜åœ¨è¿™ä¸ªkey  // ç§»é™¤  for (list\u0026lt;MyNode *\u0026gt;::iterator it = cache.begin(); it != cache.end(); it++) { if ((*it)-\u0026gt;k == key) { cache.erase(it); break; } } cache.push_front(node); hashtable[key] = value; } } };     æœ€å°‘ä½¿ç”¨ç½®æ¢ç®—æ³•(LFU) LFUï¼ˆLeast Frequently Usedï¼‰æœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•ã€‚å®ƒæ˜¯åŸºäºâ€œå¦‚æœä¸€ä¸ªæ•°æ®åœ¨æœ€è¿‘ä¸€æ®µæ—¶é—´å†…ä½¿ç”¨æ¬¡æ•°å¾ˆå°‘ï¼Œé‚£ä¹ˆåœ¨å°†æ¥ä¸€æ®µæ—¶é—´å†…è¢«ä½¿ç”¨çš„å¯èƒ½æ€§ä¹Ÿå¾ˆå°â€çš„æ€è·¯ã€‚\næ³¨æ„LFUå’ŒLRUç®—æ³•çš„ä¸åŒä¹‹å¤„ï¼ŒLRUçš„æ·˜æ±°è§„åˆ™æ˜¯åŸºäºè®¿é—®æ—¶é—´ï¼Œè€ŒLFUæ˜¯åŸºäºè®¿é—®æ¬¡æ•°çš„ã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š\nä¸ºäº†èƒ½å¤Ÿæ·˜æ±°æœ€å°‘ä½¿ç”¨çš„æ•°æ®ï¼Œå› æ­¤LFUç®—æ³•æœ€ç®€å•çš„ä¸€ç§è®¾è®¡æ€è·¯å°±æ˜¯ åˆ©ç”¨ä¸€ä¸ªæ•°ç»„å­˜å‚¨ æ•°æ®é¡¹ï¼Œç”¨hashmapå­˜å‚¨æ¯ä¸ªæ•°æ®é¡¹åœ¨æ•°ç»„ä¸­å¯¹åº”çš„ä½ç½®ï¼Œç„¶åä¸ºæ¯ä¸ªæ•°æ®é¡¹è®¾è®¡ä¸€ä¸ªè®¿é—®é¢‘æ¬¡ï¼Œå½“æ•°æ®é¡¹è¢«å‘½ä¸­æ—¶ï¼Œè®¿é—®é¢‘æ¬¡è‡ªå¢ï¼Œåœ¨æ·˜æ±°çš„æ—¶å€™æ·˜æ±°è®¿é—®é¢‘æ¬¡æœ€å°‘çš„æ•°æ®ã€‚è¿™æ ·ä¸€æ¥çš„è¯ï¼Œåœ¨æ’å…¥æ•°æ®å’Œè®¿é—®æ•°æ®çš„æ—¶å€™éƒ½èƒ½è¾¾åˆ°O(1)çš„æ—¶é—´å¤æ‚åº¦ï¼Œåœ¨æ·˜æ±°æ•°æ®çš„æ—¶å€™ï¼Œé€šè¿‡é€‰æ‹©ç®—æ³•å¾—åˆ°åº”è¯¥æ·˜æ±°çš„æ•°æ®é¡¹åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•ï¼Œå¹¶å°†è¯¥ç´¢å¼•ä½ç½®çš„å†…å®¹æ›¿æ¢ä¸ºæ–°æ¥çš„æ•°æ®å†…å®¹å³å¯ï¼Œè¿™æ ·çš„è¯ï¼Œæ·˜æ±°æ•°æ®çš„æ“ä½œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚\nClockç½®æ¢ç®—æ³• ç®€å•Clockç½®æ¢ç®—æ³• æ¯é¡µè®¾ç½®ä¸€ä¸ªè®¿é—®ä½ï¼Œå–å€¼ä¸º0å’Œ1ï¼Œå½“è¯¥é¡µè¢«è®¿é—®æ—¶ï¼Œè®¿é—®ä½ç½®ä¸º1ã€‚\nå½“åˆ©ç”¨ç®€å• Clock ç®—æ³•æ—¶ï¼Œåªéœ€ä¸ºæ¯é¡µè®¾ç½®ä¸€ä½è®¿é—®ä½ï¼Œå†å°†å†…å­˜ä¸­çš„æ‰€æœ‰é¡µé¢éƒ½é€šè¿‡é“¾æ¥æŒ‡é’ˆé“¾æ¥æˆä¸€ä¸ªå¾ªç¯é˜Ÿåˆ—ã€‚å½“æŸé¡µè¢«è®¿é—®æ—¶ï¼Œå…¶è®¿é—®ä½è¢«ç½® 1ã€‚ç½®æ¢ç®—æ³•åœ¨é€‰æ‹©ä¸€é¡µæ·˜æ±°æ—¶ï¼Œåªéœ€æ£€æŸ¥é¡µçš„è®¿é—®ä½ã€‚å¦‚æœæ˜¯ Oï¼Œå°±é€‰æ‹©è¯¥é¡µæ¢å‡ºï¼›è‹¥ä¸º 1ï¼Œåˆ™é‡æ–°å°†å®ƒç½® Oï¼Œæš‚ä¸æ¢å‡ºï¼Œç»™äºˆè¯¥é¡µç¬¬äºŒæ¬¡é©»ç•™å†…å­˜çš„æœºä¼šï¼Œå†æŒ‰ç…§ FIFO ç®—æ³•æ£€æŸ¥ä¸‹ä¸€ä¸ªé¡µé¢ã€‚å½“æ£€æŸ¥åˆ°é˜Ÿåˆ—ä¸­çš„æœ€åä¸€ä¸ªé¡µé¢æ—¶ï¼Œè‹¥å…¶è®¿é—®ä½ä»ä¸º 1ï¼Œåˆ™å†è¿”å›åˆ°é˜Ÿé¦–å»æ£€æŸ¥ç¬¬ä¸€ä¸ªé¡µé¢ã€‚\næ”¹è¿›Clockç½®æ¢ç®—æ³• è®¾ç½®ä¸¤ä¸ªå…³é”®ä½ï¼Œä¸€ä¸ªä¸ºè®¿é—®ä½ï¼Œä¸€ä¸ªä¸ºä¿®æ”¹ä½ã€‚\né¡µé¢ã€‚ç”±è®¿é—®ä½ A å’Œä¿®æ”¹ä½ M å¯ä»¥ç»„åˆæˆä¸‹é¢å››ç§ç±»å‹çš„é¡µé¢ï¼š\n1 ç±»(A=0ï¼ŒM=0)ï¼šè¡¨ç¤ºè¯¥é¡µæœ€è¿‘æ—¢æœªè¢«è®¿é—®ï¼Œåˆæœªè¢«ä¿®æ”¹ï¼Œæ˜¯æœ€ä½³æ·˜æ±°é¡µã€‚\n2 ç±»(A=0ï¼ŒM=1ï¼‰ï¼šè¡¨ç¤ºè¯¥é¡µæœ€è¿‘æœªè¢«è®¿é—®ï¼Œä½†å·²è¢«ä¿®æ”¹ï¼Œå¹¶ä¸æ˜¯å¾ˆå¥½çš„æ·˜æ±°é¡µã€‚\n3 ç±»(A=1ï¼ŒM=O)ï¼šè¡¨ç¤ºæœ€è¿‘å·²è¢«è®¿é—®ï¼Œä½†æœªè¢«ä¿®æ”¹ï¼Œè¯¥é¡µæœ‰å¯èƒ½å†è¢«è®¿é—®ã€‚\n4 ç±»(A=1ï¼ŒM=1)ï¼šè¡¨ç¤ºæœ€è¿‘å·²è¢«è®¿é—®ä¸”è¢«ä¿®æ”¹ï¼Œè¯¥é¡µå¯èƒ½å†è¢«è®¿é—®ã€‚\né¢ä¸­çš„å“ªä¸€ç§ã€‚å…¶æ‰§è¡Œè¿‡ç¨‹å¯åˆ†æˆä»¥ä¸‹ä¸‰æ­¥:\n ä»æŒ‡é’ˆæ‰€æŒ‡ç¤ºçš„å½“å‰ä½ç½®å¼€å§‹ï¼Œæ‰«æå¾ªç¯é˜Ÿåˆ—ï¼Œå¯»æ‰¾ A=0 ä¸” M=0 çš„ç¬¬ä¸€ç±»é¡µé¢ï¼Œå°†æ‰€é‡åˆ°çš„ç¬¬ä¸€ä¸ªé¡µé¢ä½œä¸ºæ‰€é€‰ä¸­çš„æ·˜æ±°é¡µã€‚åœ¨ç¬¬ä¸€æ¬¡æ‰«ææœŸé—´ä¸æ”¹å˜è®¿é—®ä½ Aã€‚ å¦‚æœç¬¬ä¸€æ­¥å¤±è´¥ï¼Œå³æŸ¥æ‰¾ä¸€è½®åæœªé‡åˆ°ç¬¬ä¸€ç±»é¡µé¢ï¼Œåˆ™å¼€å§‹ç¬¬äºŒè½®æ‰«æï¼Œå¯»æ‰¾ä¸” M=1 çš„ç¬¬äºŒç±»é¡µé¢ï¼Œå°†æ‰€é‡åˆ°çš„ç¬¬ä¸€ä¸ªè¿™ç±»é¡µé¢ä½œä¸ºæ·˜æ±°é¡µã€‚åœ¨ç¬¬äºŒè½®æ‰«ææœŸé—´ï¼Œå°†æ‰€æœ‰æ‰«æè¿‡çš„é¡µé¢çš„è®¿é—®ä½éƒ½ç½® 0ã€‚ å¦‚æœç¬¬äºŒæ­¥ä¹Ÿå¤±è´¥ï¼Œäº¦å³æœªæ‰¾åˆ°ç¬¬äºŒç±»é¡µé¢ï¼Œåˆ™å°†æŒ‡é’ˆè¿”å›åˆ°å¼€å§‹çš„ä½ç½®ï¼Œå¹¶å°†æ‰€æœ‰çš„è®¿é—®ä½å¤ 0ã€‚ç„¶åé‡å¤ç¬¬ä¸€æ­¥ï¼Œå³å¯»æ‰¾ A=O ä¸” M=O çš„ç¬¬ä¸€ç±»é¡µé¢ï¼Œå¦‚æœä»å¤±è´¥ï¼Œå¿…è¦æ—¶å†é‡å¤ç¬¬äºŒæ­¥ï¼Œå¯»æ‰¾ A=0 ä¸” M=1 çš„ç¬¬äºŒç±»é¡µé¢ï¼Œæ­¤æ—¶å°±ä¸€å®šèƒ½æ‰¾åˆ°è¢«æ·˜æ±°çš„é¡µã€‚  è¯¥ç®—æ³•ä¸ç®€å• Clock ç®—æ³•æ¯”è¾ƒï¼Œå¯å‡å°‘ç£ç›˜çš„ I/O æ“ä½œæ¬¡æ•°ã€‚ä½†ä¸ºäº†æ‰¾åˆ°ä¸€ä¸ªå¯ç½®æ¢çš„é¡µï¼Œå¯èƒ½é¡»ç»è¿‡å‡ è½®æ‰«æã€‚æ¢è¨€ä¹‹ï¼Œå®ç°è¯¥ç®—æ³•æœ¬èº«çš„å¼€é”€å°†æœ‰æ‰€å¢åŠ ã€‚\nå‚è€ƒé“¾æ¥ï¼š\n ä¸ºä»€ä¹ˆ Linux éœ€è¦è™šæ‹Ÿå†…å­˜ ã€Šæ“ä½œç³»ç»Ÿã€‹- ç¬¬å››ç‰ˆ  ","description":"è™šæ‹Ÿå†…å­˜æ˜¯æ“ä½œç³»ç»Ÿç‰©ç†å†…å­˜å’Œè¿›ç¨‹ä¹‹é—´çš„ä¸­é—´å±‚ï¼Œå®ƒä¸ºè¿›ç¨‹éšè—äº†ç‰©ç†å†…å­˜è¿™ä¸€æ¦‚å¿µï¼Œä¸ºè¿›ç¨‹æä¾›äº†æ›´åŠ ç®€æ´å’Œæ˜“ç”¨çš„æ¥å£ä»¥åŠæ›´åŠ å¤æ‚çš„åŠŸèƒ½ã€‚","id":6,"section":"posts","tags":["è™šæ‹Ÿå†…å­˜"],"title":"Linuxè™šæ‹Ÿå†…å­˜ä¸åˆ†é¡µå­˜å‚¨ç®¡ç†","uri":"https://hugo.jiahongw.com/zh/posts/linux/virtual-memory/"},{"content":"ä»ä»Šå¤©å¼€å§‹ï¼Œå‡†å¤‡è®°å½•ä»¥ä¸‹è‡ªå·±å¹³æ—¶çš„æƒ³æ³•ã€‚å› ä¸ºæœ‰è¶£çš„æƒ³æ³•å¯èƒ½ä¸€ç¬é—´å°±æ¶ˆå¤±äº†ã€‚å¦‚æœæ²¡æœ‰å°†è¿™äº›æƒ³æ³•åŠè¿‡ç¨‹è®°å½•ä¸‹æ¥ï¼Œåé¢å¯èƒ½è¢«ä»€ä¹ˆäº‹æƒ…ç»™è€½æäº†ï¼Œå¾ˆå¿«å°±ä¼šå¿˜è®°ã€‚è¿™æ ·å‰é¢çš„æƒ³æ³•å°±åªèƒ½è¿›è¡Œåˆ°ä¸€åŠï¼Œæ²¡æœ‰åç»­äº†ã€‚æˆ‘å¸Œæœ›ä»¥åèƒ½å¤Ÿç»å¸¸è®°å½•è‡ªå·±çš„æƒ³æ³•ï¼Œå› ä¸ºè‡ªå·±çš„è®°å¿†åŠ›å…¶å®ä¸å¤ªå¥½ï¼Œè¿™ä¹Ÿè®¸æ˜¯ä¸€ç§æ–¹æ³•èƒ½å¤Ÿè®©æˆ‘åšæŒä¸‹å»åšæŸä¸€ä»¶äº‹æƒ…å§\nå¹¶ä¸”æˆ‘è¿˜æƒ³åˆ°çš„ä¸€ä»¶äº‹æƒ…å°±æ˜¯ï¼Œå…¶å®å¤šå†™å…³äºè‡ªå·±çš„æƒ³æ³•è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯èƒ½å¤Ÿæ‹“å®½è‡ªå·±çš„æ€ç»´ã€‚å› ä¸ºæˆ‘åœ¨å†™ä¸œè¥¿çš„æ—¶å€™ä¹Ÿå–œæ¬¢å’Œè‡ªå·±è¿›è¡Œå¯¹è¯ï¼Œè¿™æ ·èƒ½å¤Ÿå¾—å‡ºå¾ˆå¤šä¸ä¸€æ ·çš„idea. ğŸ¤ \n","description":"æŠŠæœ‰è¶£çš„ä¸œè¥¿è®°å½•ä¸‹æ¥ï¼Œæ‰èƒ½è®°ä½å½“ä¸‹è‡ªå·±åœ¨åšä»€ä¹ˆï¼","id":7,"section":"posts","tags":["life"],"title":"åšå®¢å°è®°","uri":"https://hugo.jiahongw.com/zh/posts/life/begin/"},{"content":"æ•°æ®åº“äº‹åŠ¡ äº‹åŠ¡ï¼ˆTransactionï¼‰æ˜¯ç”±ä¸€ç³»åˆ—å¯¹ç³»ç»Ÿä¸­æ•°æ®è¿›è¡Œè®¿é—®ä¸æ›´æ–°çš„æ“ä½œæ‰€ç»„æˆçš„ä¸€ä¸ªç¨‹åºæ‰§è¡Œé€»è¾‘å•å…ƒã€‚äº‹åŠ¡æ˜¯DBMSä¸­æœ€åŸºç¡€çš„å•ä½ï¼Œäº‹åŠ¡ä¸å¯åˆ†å‰²ã€‚\næ•°æ®åº“äº‹åŠ¡å››å¤§ç‰¹æ€§(ACID)  åŸå­æ€§ï¼šä¸å¯åˆ†å‰²ï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆæäº¤ï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»š ä¸€è‡´æ€§ï¼šä¸€è‡´æ€§æ˜¯æŒ‡äº‹åŠ¡å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜æ¢åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œä¹‹å‰å’Œæ‰§è¡Œä¹‹åéƒ½å¿…é¡»å¤„äºä¸€è‡´æ€§çŠ¶æ€ã€‚ éš”ç¦»æ€§ï¼šå¤šç”¨æˆ·ä¸€èµ·è¿›è¡Œäº‹åŠ¡æ“ä½œäº’ä¸å½±å“ï¼Œç›¸äº’éš”ç¦»ã€‚ æŒä¹…æ€§ï¼šä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤äº†ï¼Œé‚£ä¹ˆå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œå³ä¾¿æ˜¯åœ¨æ•°æ®åº“ç³»ç»Ÿé‡åˆ°æ•…éšœçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±æäº¤äº‹åŠ¡çš„æ“ä½œã€‚  æ•°æ®åº“äº‹åŠ¡éš”ç¦»çº§åˆ« è¯»å–çš„é—®é¢˜\nusers    id name age     1 Joe 20   2 Jill 25      è„è¯»\nå½“ä¸€ä¸ªäº‹åŠ¡å…è®¸è¯»å–å¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹ä½†æœªæäº¤çš„æ•°æ®æ—¶ï¼Œå°±å¯èƒ½å‘ç”Ÿè„è¯»ã€‚\nä¾‹å­ä¸­ï¼Œäº‹åŠ¡2ä¿®æ”¹äº†ä¸€è¡Œï¼Œä½†æ˜¯æ²¡æœ‰æäº¤ï¼Œäº‹åŠ¡1è¯»äº†è¿™ä¸ªæ²¡æœ‰æäº¤çš„æ•°æ®ã€‚ç°åœ¨å¦‚æœäº‹åŠ¡2å›æ»šäº†åˆšæ‰çš„ä¿®æ”¹æˆ–è€…åšäº†å¦å¤–çš„ä¿®æ”¹çš„è¯ï¼Œäº‹åŠ¡1ä¸­æŸ¥åˆ°çš„æ•°æ®å°±æ˜¯ä¸æ­£ç¡®çš„äº†ã€‚\n  ä¸å¯é‡å¤è¯»\nåœ¨ä¸€æ¬¡äº‹åŠ¡ä¸­ï¼Œå½“ä¸€è¡Œæ•°æ®è·å–ä¸¤éå¾—åˆ°ä¸åŒçš„ç»“æœè¡¨ç¤ºå‘ç”Ÿäº†â€œä¸å¯é‡å¤è¯»â€.\nåœ¨åŸºäºé”çš„å¹¶å‘æ§åˆ¶ä¸­â€œä¸å¯é‡å¤è¯»â€ç°è±¡å‘ç”Ÿåœ¨å½“æ‰§è¡ŒSELECT æ“ä½œæ—¶æ²¡æœ‰è·å¾—è¯»é”æˆ–è€…SELECTæ“ä½œæ‰§è¡Œå®Œåé©¬ä¸Šé‡Šæ”¾äº†è¯»é”ï¼› å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ä¸­å½“æ²¡æœ‰è¦æ±‚ä¸€ä¸ªæäº¤å†²çª(commit conflict)çš„äº‹åŠ¡å›æ»šä¹Ÿä¼šå‘ç”Ÿâ€œä¸å¯é‡å¤è¯»â€ç°è±¡ã€‚\nè¿™ä¸ªä¾‹å­ä¸­ï¼Œäº‹åŠ¡2æäº¤æˆåŠŸï¼Œå› æ­¤ä»–å¯¹idä¸º1çš„è¡Œçš„ä¿®æ”¹å°±å¯¹å…¶ä»–äº‹åŠ¡å¯è§äº†ã€‚ä½†æ˜¯äº‹åŠ¡1åœ¨æ­¤å‰å·²ç»ä»è¿™è¡Œè¯»åˆ°äº†å¦å¤–ä¸€ä¸ªâ€œageâ€çš„å€¼ã€‚åœ¨å¯åºåˆ—åŒ–ï¼ˆSERIALIZABLEï¼‰å’Œå¯é‡å¤è¯»çš„éš”ç¦»çº§åˆ«ï¼Œæ•°æ®åº“åœ¨ç¬¬äºŒæ¬¡SELECTè¯·æ±‚çš„æ—¶å€™åº”è¯¥è¿”å›äº‹åŠ¡2æ›´æ–°ä¹‹å‰çš„å€¼ã€‚åœ¨æäº¤è¯»å’Œæœªæäº¤è¯»ï¼Œè¿”å›çš„æ˜¯æ›´æ–°ä¹‹åçš„å€¼ï¼Œè¿™ä¸ªç°è±¡å°±æ˜¯ä¸å¯é‡å¤è¯»ã€‚\n è§£å†³ä¸å¯é‡å¤è¯»ï¼š\n è¦æ±‚äº‹åŠ¡2å»¶è¿Ÿåˆ°äº‹åŠ¡1æäº¤æˆ–è€…å›æ»šä¹‹åå†æ‰§è¡Œã€‚è¿™ç§æ–¹å¼å®ç°äº†T1, T2 çš„ä¸²è¡ŒåŒ–è°ƒåº¦ã€‚ä¸²è¡ŒåŒ–è°ƒåº¦å¯ä»¥æ”¯æŒå¯é‡å¤è¯»ã€‚ å¦ä¸€ç§ç­–ç•¥æ˜¯å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ã€‚ä¸ºäº†å¾—åˆ°æ›´å¥½çš„å¹¶å‘æ€§èƒ½ï¼Œå…è®¸äº‹åŠ¡2å…ˆæäº¤ã€‚ä½†å› ä¸ºäº‹åŠ¡1åœ¨äº‹åŠ¡2ä¹‹å‰å¼€å§‹ï¼Œäº‹åŠ¡1å¿…é¡»åœ¨å…¶å¼€å§‹æ‰§è¡Œæ—¶é—´ç‚¹çš„æ•°æ®åº“çš„å¿«ç…§ä¸Šé¢æ“ä½œã€‚å½“äº‹åŠ¡1æœ€ç»ˆæäº¤æ—¶å€™ï¼Œæ•°æ®åº“ä¼šæ£€æŸ¥å…¶ç»“æœæ˜¯å¦ç­‰ä»·äºT1, T2ä¸²è¡Œè°ƒåº¦ã€‚å¦‚æœç­‰ä»·ï¼Œåˆ™å…è®¸äº‹åŠ¡1æäº¤ï¼Œå¦‚æœä¸ç­‰ä»·ï¼Œäº‹åŠ¡1éœ€è¦å›æ»šå¹¶æŠ›å‡ºä¸ªä¸²è¡ŒåŒ–å¤±è´¥çš„é”™è¯¯     å¹»è¯»\nåœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“ä¸¤ä¸ªå®Œå…¨ç›¸åŒçš„æŸ¥è¯¢è¯­å¥æ‰§è¡Œå¾—åˆ°ä¸åŒçš„ç»“æœé›†ã€‚è¿™ç§ç°è±¡ç§°ä¸ºâ€œå¹»å½±è¯»ï¼ˆphantom readï¼‰â€\nå½“äº‹åŠ¡æ²¡æœ‰è·å–*èŒƒå›´é”*çš„æƒ…å†µä¸‹æ‰§è¡Œ*SELECT \u0026hellip; WHERE*æ“ä½œå¯èƒ½ä¼šå‘ç”Ÿâ€œå¹»å½±è¯»â€ã€‚\nâ€œå¹»å½±è¯»â€æ˜¯ä¸å¯é‡å¤è¯»çš„ä¸€ç§ç‰¹æ®Šåœºæ™¯ï¼šå½“äº‹åŠ¡1ä¸¤æ¬¡æ‰§è¡ŒSELECT \u0026hellip; WHEREæ£€ç´¢ä¸€å®šèŒƒå›´å†…æ•°æ®çš„æ“ä½œä¸­é—´ï¼Œäº‹åŠ¡2åœ¨è¿™ä¸ªè¡¨ä¸­åˆ›å»ºäº†(å¦‚INSERT)äº†ä¸€è¡Œæ–°æ•°æ®ï¼Œè¿™æ¡æ–°æ•°æ®æ­£å¥½æ»¡è¶³äº‹åŠ¡1çš„â€œWHEREâ€å­å¥ã€‚\néœ€è¦æŒ‡å‡ºçš„æ˜¯äº‹åŠ¡1æ‰§è¡Œäº†ä¸¤éåŒæ ·çš„æŸ¥è¯¢è¯­å¥ã€‚å¦‚æœè®¾äº†æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œä¸¤æ¬¡ä¼šå¾—åˆ°åŒæ ·çš„ç»“æœé›†ï¼Œè¿™ä¹Ÿæ­£æ˜¯æ•°æ®åº“åœ¨å¯åºåˆ—åŒ–ï¼ˆSERIALIZABLEï¼‰éš”ç¦»çº§åˆ«ä¸Šéœ€è¦æ»¡è¶³çš„ã€‚ä½†æ˜¯åœ¨è¾ƒä½çš„éš”ç¦»çº§åˆ«ä¸Šï¼Œç¬¬äºŒæ¬¡æŸ¥è¯¢å¯èƒ½ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœé›†ã€‚\n   äº‹åŠ¡éš”ç¦»å…¶å®å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šé¢æåˆ°çš„è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»è¿™å‡ ä¸ªé—®é¢˜\n éš”ç¦»çº§åˆ«\n  è¯»æœªæäº¤ï¼ˆREAD UNCOMMITTEDï¼‰\næœªæäº¤è¯»ï¼ˆREAD UNCOMMITTEDï¼‰æ˜¯æœ€ä½çš„éš”ç¦»çº§åˆ«ã€‚å…è®¸â€œè„è¯»â€ï¼ˆdirty readsï¼‰ï¼Œäº‹åŠ¡å¯ä»¥çœ‹åˆ°å…¶ä»–äº‹åŠ¡â€œå°šæœªæäº¤â€çš„ä¿®æ”¹ã€‚\n  è¯»æäº¤ ï¼ˆREAD COMMITTEDï¼‰\nåœ¨æäº¤è¯»ï¼ˆREAD COMMITTEDï¼‰çº§åˆ«ä¸­ï¼ŒåŸºäºé”æœºåˆ¶å¹¶å‘æ§åˆ¶çš„DBMSéœ€è¦å¯¹é€‰å®šå¯¹è±¡çš„å†™é”ä¸€ç›´ä¿æŒåˆ°äº‹åŠ¡ç»“æŸï¼Œä½†æ˜¯è¯»é”åœ¨SELECTæ“ä½œå®Œæˆåé©¬ä¸Šé‡Šæ”¾ã€‚\n  å¯é‡å¤è¯» ï¼ˆREPEATABLE READï¼‰\nåœ¨å¯é‡å¤è¯»ï¼ˆREPEATABLE READSï¼‰éš”ç¦»çº§åˆ«ä¸­ï¼ŒåŸºäºé”æœºåˆ¶å¹¶å‘æ§åˆ¶çš„DBMSéœ€è¦å¯¹é€‰å®šå¯¹è±¡çš„è¯»é”ï¼ˆread locksï¼‰å’Œå†™é”ï¼ˆwrite locksï¼‰ä¸€ç›´ä¿æŒåˆ°äº‹åŠ¡ç»“æŸã€‚\n ä¸ºäº†è§£å†³ä¸å¯é‡å¤è¯»ï¼Œæˆ–è€…ä¸ºäº†å®ç°å¯é‡å¤è¯»ï¼ŒMySQL é‡‡ç”¨äº† MVVC (å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶) çš„æ–¹å¼ã€‚\n æˆ‘ä»¬åœ¨æ•°æ®åº“è¡¨ä¸­çœ‹åˆ°çš„ä¸€è¡Œè®°å½•å¯èƒ½å®é™…ä¸Šæœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œæ¯ä¸ªç‰ˆæœ¬çš„è®°å½•é™¤äº†æœ‰æ•°æ®æœ¬èº«å¤–ï¼Œè¿˜è¦æœ‰ä¸€ä¸ªè¡¨ç¤ºç‰ˆæœ¬çš„å­—æ®µï¼Œè®°ä¸º row trx_idï¼Œè€Œè¿™ä¸ªå­—æ®µå°±æ˜¯ä½¿å…¶äº§ç”Ÿçš„äº‹åŠ¡çš„ idï¼Œäº‹åŠ¡ ID è®°ä¸º transaction idï¼Œå®ƒåœ¨äº‹åŠ¡å¼€å§‹çš„æ—¶å€™å‘äº‹åŠ¡ç³»ç»Ÿç”³è¯·ï¼ŒæŒ‰æ—¶é—´å…ˆåé¡ºåºé€’å¢ã€‚\næŒ‰ç…§ä¸Šé¢è¿™å¼ å›¾ç†è§£ï¼Œä¸€è¡Œè®°å½•ç°åœ¨æœ‰ 3 ä¸ªç‰ˆæœ¬ï¼Œæ¯ä¸€ä¸ªç‰ˆæœ¬éƒ½è®°å½•è¿™ä½¿å…¶äº§ç”Ÿçš„äº‹åŠ¡ IDï¼Œæ¯”å¦‚äº‹åŠ¡Açš„transaction id æ˜¯100ï¼Œé‚£ä¹ˆç‰ˆæœ¬1çš„row trx_id å°±æ˜¯ 100ï¼ŒåŒç†ç‰ˆæœ¬2å’Œç‰ˆæœ¬3ã€‚\nè¯»æäº¤å’Œå¯é‡å¤è¯»çš„æ—¶å€™éƒ½æåˆ°äº†ä¸€ä¸ªè¯ï¼Œå«åšå¿«ç…§ï¼Œå­¦åå«åšä¸€è‡´æ€§è§†å›¾ï¼Œè¿™ä¹Ÿæ˜¯å¯é‡å¤è¯»å’Œä¸å¯é‡å¤è¯»çš„å…³é”®ã€‚å¯é‡å¤è¯»æ˜¯åœ¨äº‹åŠ¡å¼€å§‹çš„æ—¶å€™ç”Ÿæˆä¸€ä¸ªå½“å‰äº‹åŠ¡å…¨å±€æ€§çš„å¿«ç…§ï¼Œè€Œè¯»æäº¤åˆ™æ˜¯æ¯æ¬¡æ‰§è¡Œè¯­å¥çš„æ—¶å€™éƒ½é‡æ–°ç”Ÿæˆä¸€æ¬¡å¿«ç…§ã€‚\n  ä¸²è¡ŒåŒ– ï¼ˆSERIALIZABLEï¼‰\nä¸²è¡ŒåŒ–æ˜¯4ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸­éš”ç¦»æ•ˆæœæœ€å¥½çš„ï¼Œè§£å†³äº†è„è¯»ã€å¯é‡å¤è¯»ã€å¹»è¯»çš„é—®é¢˜ï¼Œä½†æ˜¯æ•ˆæœæœ€å·®ï¼Œå®ƒå°†äº‹åŠ¡çš„æ‰§è¡Œå˜ä¸ºé¡ºåºæ‰§è¡Œï¼Œä¸å…¶ä»–ä¸‰ä¸ªéš”ç¦»çº§åˆ«ç›¸æ¯”ï¼Œå®ƒå°±ç›¸å½“äºå•çº¿ç¨‹ï¼Œåä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œå¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªäº‹åŠ¡ç»“æŸã€‚è¯»çš„æ—¶å€™åŠ å…±äº«é”ï¼Œä¹Ÿå°±æ˜¯å…¶ä»–äº‹åŠ¡å¯ä»¥å¹¶å‘è¯»ï¼Œä½†æ˜¯ä¸èƒ½å†™ã€‚å†™çš„æ—¶å€™åŠ æ’å®ƒé”ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å¹¶å‘å†™ä¹Ÿä¸èƒ½å¹¶å‘è¯»ã€‚\n åœ¨åŸºäºé”æœºåˆ¶å¹¶å‘æ§åˆ¶çš„DBMSå®ç°å¯ä¸²è¡ŒåŒ–ï¼Œè¦æ±‚åœ¨é€‰å®šå¯¹è±¡ä¸Šçš„è¯»é”å’Œå†™é”ä¿æŒç›´åˆ°äº‹åŠ¡ç»“æŸåæ‰èƒ½é‡Šæ”¾ã€‚åœ¨SELECT çš„æŸ¥è¯¢ä¸­ä½¿ç”¨ä¸€ä¸ªâ€œWHEREâ€å­å¥æ¥æè¿°ä¸€ä¸ªèŒƒå›´æ—¶åº”è¯¥è·å¾—ä¸€ä¸ªâ€œèŒƒå›´é”â€ï¼ˆrange-locksï¼‰ã€‚è¿™ç§æœºåˆ¶å¯ä»¥é¿å…â€œå¹»è¯»â€ï¼ˆphantom readsï¼‰ç°è±¡\n   å¹¶å‘å†™é—®é¢˜\nå­˜åœ¨è¿™çš„æƒ…å†µï¼Œä¸¤ä¸ªäº‹åŠ¡ï¼Œå¯¹åŒä¸€æ¡æ•°æ®åšä¿®æ”¹ã€‚æœ€åç»“æœåº”è¯¥æ˜¯å“ªä¸ªäº‹åŠ¡çš„ç»“æœå‘¢ï¼Œè‚¯å®šè¦æ˜¯æ—¶é—´é åçš„é‚£ä¸ªã€‚\nå‡è®¾äº‹åŠ¡Aæ‰§è¡Œ update æ“ä½œï¼Œ update çš„æ—¶å€™è¦å¯¹æ‰€ä¿®æ”¹çš„è¡ŒåŠ è¡Œé”ï¼Œè¿™ä¸ªè¡Œé”ä¼šåœ¨æäº¤ä¹‹åæ‰é‡Šæ”¾ã€‚è€Œåœ¨äº‹åŠ¡Aæäº¤ä¹‹å‰ï¼Œäº‹åŠ¡Bä¹Ÿæƒ³ update è¿™è¡Œæ•°æ®ï¼Œäºæ˜¯ç”³è¯·è¡Œé”ï¼Œä½†æ˜¯ç”±äºå·²ç»è¢«äº‹åŠ¡Aå æœ‰ï¼Œäº‹åŠ¡Bæ˜¯ç”³è¯·ä¸åˆ°çš„ï¼Œæ­¤æ—¶ï¼Œäº‹åŠ¡Bå°±ä¼šä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°äº‹åŠ¡Aæäº¤ï¼Œäº‹åŠ¡Bæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œå¦‚æœäº‹åŠ¡Açš„æ—¶é—´å¤ªé•¿ï¼Œé‚£ä¹ˆäº‹åŠ¡Bå¾ˆæœ‰å¯èƒ½å‡ºç°è¶…æ—¶å¼‚å¸¸ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåŠ å…¥æŸ¥è¯¢çš„å­—æ®µè®¾ç½®äº†ç´¢å¼•ï¼Œé‚£ä¹ˆæ•°æ®åº“ç³»ç»Ÿå¯ä»¥å¾ˆæ–¹ä¾¿çš„ç»™è¯¥è¡Œæ•°æ®åŠ ä¸Šä¸€ä¸ªè¡Œé”ï¼›åŠ å…¥æ²¡æœ‰è®¾ç½®ç´¢å¼•çš„è¯ï¼Œæ•°æ®åº“ç³»ç»Ÿä¼šç›´æ¥å°†è¯¥è¡¨çš„æ‰€æœ‰è¡ŒåŠ ä¸Šè¡Œé”ï¼Œç„¶åå†éå†ä¸€éï¼Œé‡Šæ”¾æ‰æ²¡ç”¨çš„è¡Œé”ã€‚\nè§£å†³å¹»è¯»\nå¹¶å‘å†™é—®é¢˜çš„è§£å†³æ–¹å¼å°±æ˜¯è¡Œé”ï¼Œè€Œè§£å†³å¹»è¯»ç”¨çš„ä¹Ÿæ˜¯é”ï¼Œå«åšé—´éš™é”ï¼ŒMySQL æŠŠè¡Œé”å’Œé—´éš™é”åˆå¹¶åœ¨ä¸€èµ·ï¼Œè§£å†³äº†å¹¶å‘å†™å’Œå¹»è¯»çš„é—®é¢˜ï¼Œè¿™ä¸ªé”å«åš Next-Keyé”ã€‚\nåœ¨æ•°æ®åº“ä¸­ä¼šä¸ºç´¢å¼•ç»´æŠ¤ä¸€å¥—B+æ ‘ï¼Œç”¨æ¥å¿«é€Ÿå®šä½è¡Œè®°å½•ã€‚B+ç´¢å¼•æ ‘æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥ä¼šæŠŠè¿™å¼ è¡¨çš„ç´¢å¼•åˆ†å‰²æˆå‡ ä¸ªåŒºé—´ã€‚å¯èƒ½ä¼šæœ‰å¦‚ä¸‹çš„B+æ ‘ï¼š\nå¦‚å›¾æ‰€ç¤ºï¼Œåˆ†æˆäº†3 ä¸ªåŒºé—´ï¼Œ(è´Ÿæ— ç©·,10]ã€(10,30]ã€(30,æ­£æ— ç©·]ï¼Œåœ¨è¿™3ä¸ªåŒºé—´æ˜¯å¯ä»¥åŠ é—´éš™é”çš„ã€‚\nåœ¨äº‹åŠ¡Aæäº¤ä¹‹å‰ï¼Œäº‹åŠ¡Bçš„æ’å…¥æ“ä½œåªèƒ½ç­‰å¾…ï¼Œè¿™å°±æ˜¯é—´éš™é”èµ·å¾—ä½œç”¨ã€‚å½“äº‹åŠ¡Aæ‰§è¡Œupdate user set name='é£ç­2å·â€™ where age = 10; çš„æ—¶å€™ï¼Œç”±äºæ¡ä»¶ where age = 10 ï¼Œæ•°æ®åº“ä¸ä»…åœ¨ age =10 çš„è¡Œä¸Šæ·»åŠ äº†è¡Œé”ï¼Œè€Œä¸”åœ¨è¿™æ¡è®°å½•çš„ä¸¤è¾¹ï¼Œä¹Ÿå°±æ˜¯(è´Ÿæ— ç©·,10]ã€(10,30]è¿™ä¸¤ä¸ªåŒºé—´åŠ äº†é—´éš™é”ï¼Œä»è€Œå¯¼è‡´äº‹åŠ¡Bæ’å…¥æ“ä½œæ— æ³•å®Œæˆï¼Œåªèƒ½ç­‰å¾…äº‹åŠ¡Aæäº¤ã€‚ä¸ä»…æ’å…¥ age = 10 çš„è®°å½•éœ€è¦ç­‰å¾…äº‹åŠ¡Aæäº¤ï¼Œage\u0026lt;10ã€10\u0026lt;age\u0026lt;30 çš„è®°å½•é¡µæ— æ³•å®Œæˆï¼Œè€Œå¤§äºç­‰äº30çš„è®°å½•åˆ™ä¸å—å½±å“ï¼Œè¿™è¶³ä»¥è§£å†³å¹»è¯»é—®é¢˜äº†ã€‚\n è¿™æ˜¯æœ‰ç´¢å¼•çš„æƒ…å†µï¼Œå¦‚æœ age ä¸æ˜¯ç´¢å¼•åˆ—ï¼Œé‚£ä¹ˆæ•°æ®åº“ä¼šä¸ºæ•´ä¸ªè¡¨åŠ ä¸Šé—´éš™é”ã€‚æ‰€ä»¥ï¼Œå¦‚æœæ˜¯æ²¡æœ‰ç´¢å¼•çš„è¯ï¼Œä¸ç®¡ age æ˜¯å¦å¤§äºç­‰äº30ï¼Œéƒ½è¦ç­‰å¾…äº‹åŠ¡Aæäº¤æ‰å¯ä»¥æˆåŠŸæ’å…¥ã€‚\n éš”ç¦»çº§åˆ«vsè¯»ç°è±¡\n   éš”ç¦»çº§åˆ« è„è¯» ä¸å¯é‡å¤è¯» å¹»å½±è¯»     æœªæäº¤è¯» å¯èƒ½å‘ç”Ÿ å¯èƒ½å‘ç”Ÿ å¯èƒ½å‘ç”Ÿ   æäº¤è¯» - å¯èƒ½å‘ç”Ÿ å¯èƒ½å‘ç”Ÿ   å¯é‡å¤è¯» - - å¯èƒ½å‘ç”Ÿ   å¯åºåˆ—åŒ– - - -    å¯åºåˆ—åŒ–ï¼ˆSerializableï¼‰éš”ç¦»çº§åˆ«ä¸ç­‰åŒäºå¯ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ã€‚å¯ä¸²è¡ŒåŒ–è°ƒåº¦æ˜¯é¿å…ä»¥ä¸Šä¸‰ç§ç°è±¡çš„å¿…è¦æ¡ä»¶ï¼Œä½†ä¸æ˜¯å……åˆ†æ¡ä»¶ã€‚\n â€œå¯èƒ½å‘ç”Ÿâ€è¡¨ç¤ºè¿™ä¸ªéš”ç¦»çº§åˆ«ä¼šå‘ç”Ÿå¯¹åº”çš„ç°è±¡ï¼Œâ€œ-â€è¡¨ç¤ºä¸ä¼šå‘ç”Ÿã€‚é‡‡ç”¨å“ªç§éš”ç¦»çº§åˆ«è¦æ ¹æ®ç³»ç»Ÿéœ€æ±‚æƒè¡¡å†³å®šï¼Œå…¶ä¸­ï¼Œå¯é‡å¤è¯»æ˜¯ MySQL çš„é»˜è®¤çº§åˆ«ã€‚\n éš”ç¦»çº§åˆ«vs é”æŒç»­æ—¶é—´\nåœ¨åŸºäºé”çš„å¹¶å‘æ§åˆ¶ä¸­ï¼Œéš”ç¦»çº§åˆ«å†³å®šäº†é”çš„æŒæœ‰æ—¶é—´ã€‚\u0026ldquo;C\u0026rdquo;-è¡¨ç¤ºé”ä¼šæŒç»­åˆ°äº‹åŠ¡æäº¤ã€‚ \u0026ldquo;S\u0026rdquo; â€“è¡¨ç¤ºé”æŒç»­åˆ°å½“å‰è¯­å¥æ‰§è¡Œå®Œæ¯•ã€‚å¦‚æœé”åœ¨è¯­å¥æ‰§è¡Œå®Œæ¯•å°±é‡Šæ”¾åˆ™å¦å¤–ä¸€ä¸ªäº‹åŠ¡å°±å¯ä»¥åœ¨è¿™ä¸ªäº‹åŠ¡æäº¤å‰ä¿®æ”¹é”å®šçš„æ•°æ®ï¼Œä»è€Œé€ æˆæ··ä¹±\n   éš”ç¦»çº§åˆ« å†™æ“ä½œ è¯»æ“ä½œ èŒƒå›´æ“ä½œ (\u0026hellip;where\u0026hellip;)     æœªæäº¤è¯» S S S   æäº¤è¯» C S S   å¯é‡å¤è¯» C C S   å¯åºåˆ—åŒ– C C C    MySQLéš”ç¦»æ“ä½œï¼š\n æŸ¥çœ‹Mysqlé»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼š  1 2 3 4 5 6 7  mysql\u0026gt; show variables like \u0026#39;transaction_isolation\u0026#39;; +-----------------------+-----------------+ | Variable_name | Value | +-----------------------+-----------------+ | transaction_isolation | REPEATABLE-READ | +-----------------------+-----------------+ 1 row in set, 1 warning (0.11 sec)   å¯ä»¥å‘ç°Mysqlé»˜è®¤çš„éš”ç¦»çº§åˆ«ä¸ºå¯é‡å¤è¯»\nä¿®æ”¹æ”¹æ•°æ®åº“çš„éš”ç¦»çº§åˆ«ï¼šset [ä½œç”¨åŸŸ] transaction isolation level [äº‹åŠ¡éš”ç¦»çº§åˆ«]ï¼Œå…·ä½“å¦‚ä¸‹ï¼š\n1  SET [SESSION | GLOBAL] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE}ã€‚   æ•°æ®åº“ç´¢å¼•(INDEX) æ•°æ®åº“ç´¢å¼•æ˜¯ä¸ºäº†å¢åŠ æŸ¥è¯¢é€Ÿåº¦è€Œå¯¹è¡¨å­—æ®µé™„åŠ çš„ä¸€ç§æ ‡è¯†ï¼Œæ˜¯å¯¹æ•°æ®åº“è¡¨ä¸­ä¸€åˆ—æˆ–å¤šåˆ—çš„å€¼è¿›è¡Œæ’åºçš„ä¸€ç§ç»“æ„ã€‚\nMysqlåˆ›å»ºç´¢å¼•ï¼š\n1  CREATE INDEX INDEX_NAME ON TABLE_NAME (COLUMN_LIST)   æ•°æ®åº“çš„ä¸‰å¤§èŒƒå¼ ç¬¬ä¸€èŒƒå¼\nå½“å…³ç³»æ¨¡å¼Rçš„æ‰€æœ‰å±æ€§éƒ½ä¸èƒ½å†åˆ†è§£ä¸ºæ›´åŸºæœ¬çš„æ•°æ®å•ä½æ—¶ï¼Œç§°Ræ˜¯æ»¡è¶³ç¬¬ä¸€èŒƒå¼ï¼Œå³å±æ€§ä¸å¯åˆ†\nç¬¬äºŒèŒƒå¼\nå¦‚æœå…³ç³»æ¨¡å¼Ræ»¡è¶³ç¬¬ä¸€èŒƒå¼ï¼Œå¹¶ä¸”Rå¾—æ‰€æœ‰éä¸»å±æ€§éƒ½å®Œå…¨ä¾èµ–äºRçš„æ¯ä¸€ä¸ªå€™é€‰å…³é”®å±æ€§ï¼Œç§°Ræ»¡è¶³ç¬¬äºŒèŒƒå¼\nç¬¬ä¸‰èŒƒå¼\nè®¾Ræ˜¯ä¸€ä¸ªæ»¡è¶³ç¬¬ä¸€èŒƒå¼æ¡ä»¶çš„å…³ç³»æ¨¡å¼ï¼ŒXæ˜¯Rçš„ä»»æ„å±æ€§é›†ï¼Œå¦‚æœXéä¼ é€’ä¾èµ–äºRçš„ä»»æ„ä¸€ä¸ªå€™é€‰å…³é”®å­—ï¼Œç§°Ræ»¡è¶³ç¬¬ä¸‰èŒƒå¼ï¼Œå³éä¸»å±æ€§ä¸ä¼ é€’ä¾èµ–äºé”®ç \nå‚è€ƒé“¾æ¥ï¼š\n https://www.cnblogs.com/fengzheng/p/12557762.html https://zh.wikipedia.org/wiki/%E4%BA%8B%E5%8B%99%E9%9A%94%E9%9B%A2#%E8%84%8F%E8%AF%BB  mysqlçš„MVCCæœºåˆ¶ MVCCçš„ç»´åŸºç™¾ç§‘è§£é‡Šï¼šå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶(Multiversion concurrency controlï¼Œ MCC æˆ– MVCC)ï¼Œæ˜¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå¸¸ç”¨çš„ä¸€ç§å¹¶å‘æ§åˆ¶ï¼Œä¹Ÿç”¨äºç¨‹åºè®¾è®¡è¯­è¨€å®ç°äº‹åŠ¡å†…å­˜ã€‚\n MVCCæ˜¯ä¸€ç§å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼Œæ˜¯MySQLçš„InnoDBå­˜å‚¨å¼•æ“å®ç°éš”ç¦»çº§åˆ«çš„ä¸€ç§å…·ä½“æ–¹å¼ï¼Œç”¨äºå®ç°æäº¤è¯»å’Œå¯é‡å¤è¯»è¿™ä¸¤ç§éš”ç¦»çº§åˆ«\n MVCCä½œç”¨\nMVCCæ„å›¾è§£å†³è¯»å†™é”é€ æˆçš„å¤šä¸ªã€é•¿æ—¶é—´çš„è¯»æ“ä½œé¥¿æ­»å†™æ“ä½œé—®é¢˜ã€‚æ‰€ä»¥MVCCé€šè¿‡ä¿å­˜æŸä¸ªæ—¶é—´ç‚¹çš„å¿«ç…§æ¥å®ç°è¯¥æœºåˆ¶ï¼Œæ¯ä¸ªäº‹åŠ¡è¯»åˆ°çš„æ•°æ®é¡¹éƒ½æ˜¯ä¸€ä¸ªå†å²å¿«ç…§ï¼ˆsnapshot)å¹¶ä¾èµ–äºå®ç°çš„éš”ç¦»çº§åˆ«ã€‚å†™æ“ä½œä¸è¦†ç›–å·²æœ‰æ•°æ®é¡¹ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œç›´è‡³æ‰€åœ¨æ“ä½œæäº¤æ—¶æ‰å˜ä¸ºå¯è§ã€‚å¿«ç…§éš”ç¦»ä½¿å¾—äº‹ç‰©çœ‹åˆ°å®ƒå¯åŠ¨æ—¶çš„æ•°æ®çŠ¶æ€ã€‚\n MVCCå¯ä»¥æ— é”å®ç°ã€‚\n å¸¸è§çš„æ•°æ®åº“ä¼˜åŒ–æ–¹æ³•  æˆ–è€…ç´¢å¼•ç›¸å…³çš„ç‚¹ä½ å…¨éƒ¨éƒ½çŸ¥é“ä¹ˆï¼Ÿèšç°‡ç´¢å¼•ï¼Œéèšç°‡ç´¢å¼•ï¼Œæ™®é€šç´¢å¼•ï¼Œå”¯ä¸€ç´¢å¼•ï¼Œchange bufferï¼Œè¡¨é”ã€è¡Œé”ã€é—´éš™é”ä»¥åŠè¡Œé”å¹¶å‘æƒ…å†µä¸‹çš„æœ€å¤§TPSæ˜¯å¤šå°‘ï¼Ÿè¿˜æœ‰ç´¢å¼•ä¸ºå•¥ä¼šé€‰æ‹©é”™è¯¯ï¼Ÿè¿™äº›å¤§å®¶çŸ¥é“å˜›ï¼Ÿ\n æ•°æ®åº“çš„ç»„æˆç»“æ„å›¾ï¼š\næˆ‘ä»¬æ‰€è°“çš„è°ƒä¼˜ä¹Ÿå°±æ˜¯åœ¨ï¼Œæ‰§è¡Œå™¨æ‰§è¡Œä¹‹å‰çš„åˆ†æå™¨ï¼Œä¼˜åŒ–å™¨é˜¶æ®µå®Œæˆçš„ã€‚\n  å…ˆè·‘sql explain\nMySQL æä¾›äº†ä¸€ä¸ª EXPLAIN å‘½ä»¤, å®ƒå¯ä»¥å¯¹ SELECT è¯­å¥è¿›è¡Œåˆ†æ, å¹¶è¾“å‡º SELECT æ‰§è¡Œçš„è¯¦ç»†ä¿¡æ¯, ä»¥ä¾›å¼€å‘äººå‘˜é’ˆå¯¹æ€§ä¼˜åŒ–.\nEXPLAIN å‘½ä»¤ç”¨æ³•ååˆ†ç®€å•, åœ¨ SELECT è¯­å¥å‰åŠ ä¸Š Explain å°±å¯ä»¥äº†, ä¾‹å¦‚:\n1  EXPLAIN SELECT * from user_info WHERE id \u0026lt; 300;   EXPLAIN å‘½ä»¤çš„è¾“å‡ºå†…å®¹å¤§è‡´å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  mysql\u0026gt; explain select * from user_info where id = 2\\G *************************** 1. row *************************** id: 1 select_type: SIMPLE table: user_info partitions: NULL type: const possible_keys: PRIMARY key: PRIMARY key_len: 8 ref: const rows: 1 filtered: 100.00 Extra: NULL 1 row in set, 1 warning (0.00 sec)   å„åˆ—çš„å«ä¹‰å¦‚ä¸‹:\n  id: SELECT æŸ¥è¯¢çš„æ ‡è¯†ç¬¦. æ¯ä¸ª SELECT éƒ½ä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦.\n  select_type: SELECT æŸ¥è¯¢çš„ç±»å‹.\nå®ƒçš„å¸¸ç”¨å–å€¼æœ‰:\n SIMPLE, è¡¨ç¤ºæ­¤æŸ¥è¯¢ä¸åŒ…å« UNION æŸ¥è¯¢æˆ–å­æŸ¥è¯¢ PRIMARY, è¡¨ç¤ºæ­¤æŸ¥è¯¢æ˜¯æœ€å¤–å±‚çš„æŸ¥è¯¢ UNION, è¡¨ç¤ºæ­¤æŸ¥è¯¢æ˜¯ UNION çš„ç¬¬äºŒæˆ–éšåçš„æŸ¥è¯¢ DEPENDENT UNION, UNION ä¸­çš„ç¬¬äºŒä¸ªæˆ–åé¢çš„æŸ¥è¯¢è¯­å¥, å–å†³äºå¤–é¢çš„æŸ¥è¯¢ UNION RESULT, UNION çš„ç»“æœ SUBQUERY, å­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ª SELECT DEPENDENT SUBQUERY: å­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ª SELECT, å–å†³äºå¤–é¢çš„æŸ¥è¯¢. å³å­æŸ¥è¯¢ä¾èµ–äºå¤–å±‚æŸ¥è¯¢çš„ç»“æœ.    table: æŸ¥è¯¢çš„æ˜¯å“ªä¸ªè¡¨\n  partitions: åŒ¹é…çš„åˆ†åŒº\n  type: join ç±»å‹\ntype å­—æ®µæ¯”è¾ƒé‡è¦, å®ƒæä¾›äº†åˆ¤æ–­æŸ¥è¯¢æ˜¯å¦é«˜æ•ˆçš„é‡è¦ä¾æ®ä¾æ®. é€šè¿‡ type å­—æ®µ, æˆ‘ä»¬åˆ¤æ–­æ­¤æ¬¡æŸ¥è¯¢æ˜¯ å…¨è¡¨æ‰«æ è¿˜æ˜¯ ç´¢å¼•æ‰«æ ç­‰.\ntype å¸¸ç”¨çš„å–å€¼æœ‰:\n system: è¡¨ä¸­åªæœ‰ä¸€æ¡æ•°æ®. è¿™ä¸ªç±»å‹æ˜¯ç‰¹æ®Šçš„ const ç±»å‹. const: é’ˆå¯¹ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•çš„ç­‰å€¼æŸ¥è¯¢æ‰«æ, æœ€å¤šåªè¿”å›ä¸€è¡Œæ•°æ®. const æŸ¥è¯¢é€Ÿåº¦éå¸¸å¿«, å› ä¸ºå®ƒä»…ä»…è¯»å–ä¸€æ¬¡å³å¯.    possible_keys: æ­¤æ¬¡æŸ¥è¯¢ä¸­å¯èƒ½é€‰ç”¨çš„ç´¢å¼•\npossible_keys è¡¨ç¤º MySQL åœ¨æŸ¥è¯¢æ—¶, èƒ½å¤Ÿä½¿ç”¨åˆ°çš„ç´¢å¼•. æ³¨æ„, å³ä½¿æœ‰äº›ç´¢å¼•åœ¨ possible_keys ä¸­å‡ºç°, ä½†æ˜¯å¹¶ä¸è¡¨ç¤ºæ­¤ç´¢å¼•ä¼šçœŸæ­£åœ°è¢« MySQL ä½¿ç”¨åˆ°. MySQL åœ¨æŸ¥è¯¢æ—¶å…·ä½“ä½¿ç”¨äº†å“ªäº›ç´¢å¼•, ç”± key å­—æ®µå†³å®š.\n  key: æ­¤æ¬¡æŸ¥è¯¢ä¸­ç¡®åˆ‡ä½¿ç”¨åˆ°çš„ç´¢å¼•.\n  ref: å“ªä¸ªå­—æ®µæˆ–å¸¸æ•°ä¸ key ä¸€èµ·è¢«ä½¿ç”¨\n  rows: æ˜¾ç¤ºæ­¤æŸ¥è¯¢ä¸€å…±æ‰«æäº†å¤šå°‘è¡Œ. è¿™ä¸ªæ˜¯ä¸€ä¸ªä¼°è®¡å€¼.\nrows ä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦çš„å­—æ®µ. MySQL æŸ¥è¯¢ä¼˜åŒ–å™¨æ ¹æ®ç»Ÿè®¡ä¿¡æ¯, ä¼°ç®— SQL è¦æŸ¥æ‰¾åˆ°ç»“æœé›†éœ€è¦æ‰«æè¯»å–çš„æ•°æ®è¡Œæ•°.\nè¿™ä¸ªå€¼éå¸¸ç›´è§‚æ˜¾ç¤º SQL çš„æ•ˆç‡å¥½å, åŸåˆ™ä¸Š rows è¶Šå°‘è¶Šå¥½.\n  filtered: è¡¨ç¤ºæ­¤æŸ¥è¯¢æ¡ä»¶æ‰€è¿‡æ»¤çš„æ•°æ®çš„ç™¾åˆ†æ¯”\n  extra: é¢å¤–çš„ä¿¡æ¯\n    æ’é™¤ç¼“å­˜å¹²æ‰°(Mysql8.0ä¹‹å‰éœ€è¦éœ€è¦æ’é™¤)\næˆ‘ä»¬åœ¨æ‰§è¡ŒSQLçš„æ—¶å€™ï¼Œè®°å¾—åŠ ä¸ŠSQL NoCacheå»è·‘SQLï¼Œè¿™æ ·è·‘å‡ºæ¥çš„æ—¶é—´å°±æ˜¯çœŸå®çš„æŸ¥è¯¢æ—¶é—´äº†ã€‚\n ä¸ºä»€ä¹ˆç¼“å­˜ä¼šå¤±æ•ˆï¼Œè€Œä¸”æ˜¯ç»å¸¸å¤±æ•ˆï¼Ÿ\nç¼“å­˜å¤±æ•ˆæ¯”è¾ƒé¢‘ç¹çš„åŸå› å°±æ˜¯ï¼Œåªè¦æˆ‘ä»¬ä¸€å¯¹è¡¨è¿›è¡Œæ›´æ–°ï¼Œé‚£è¿™ä¸ªè¡¨æ‰€æœ‰çš„ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºï¼Œå…¶å®æˆ‘ä»¬å¾ˆå°‘å­˜åœ¨ä¸æ›´æ–°çš„è¡¨ã€‚\n   è¦†ç›–ç´¢å¼•\næˆ‘ä»¬åœ¨æ•°æ®åº“æŸ¥è¯¢çš„æ“ä½œä¸­ï¼Œå¯èƒ½æœ‰å›è¡¨çš„æ“ä½œï¼Œæˆ‘ä»¬å¸Œæœ›ä¸è¿›è¡Œå›è¡¨æ“ä½œï¼Œåœ¨è‡ªå·±çš„ç´¢å¼•ä¸Šå°±æŸ¥åˆ°è‡ªå·±æƒ³è¦çš„ï¼Œä¸è¿›è¡Œä¸»é”®ç´¢å¼•æŸ¥æ‰¾ã€‚\nå¦‚æœåœ¨æˆ‘ä»¬å»ºç«‹çš„ç´¢å¼•ä¸Šå°±å·²ç»æœ‰æˆ‘ä»¬éœ€è¦çš„å­—æ®µï¼Œå°±ä¸éœ€è¦å›è¡¨äº†ï¼Œåœ¨ç”µå•†é‡Œé¢ä¹Ÿæ˜¯å¾ˆå¸¸è§çš„ï¼Œæˆ‘ä»¬éœ€è¦å»å•†å“è¡¨é€šè¿‡å„ç§ä¿¡æ¯æŸ¥è¯¢åˆ°å•†å“idï¼Œidä¸€èˆ¬éƒ½æ˜¯ä¸»é”®ï¼Œå¯èƒ½sqlç±»ä¼¼è¿™æ ·ï¼š\n1  select itemId from itemCenter where size between 1 and 6   å› ä¸ºå•†å“id itemIdä¸€èˆ¬éƒ½æ˜¯ä¸»é”®ï¼Œåœ¨sizeç´¢å¼•ä¸Šè‚¯å®šä¼šæœ‰æˆ‘ä»¬è¿™ä¸ªå€¼ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¸éœ€è¦å›ä¸»é”®è¡¨å»æŸ¥è¯¢idä¿¡æ¯äº†ã€‚\nç”±äºè¦†ç›–ç´¢å¼•å¯ä»¥å‡å°‘æ ‘çš„æœç´¢æ¬¡æ•°ï¼Œæ˜¾è‘—æå‡æŸ¥è¯¢æ€§èƒ½ï¼Œæ‰€ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µã€‚\n  è”åˆç´¢å¼•â€”â€”æ„å»ºä¸¤ä¸ªå±æ€§ä¹‹é—´çš„å¿«é€ŸæŸ¥è¯¢\nè¿˜æ˜¯å•†å“è¡¨ä¸¾ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä»–çš„åç§°ï¼Œå»æŸ¥ä»–çš„åº“å­˜ï¼Œå‡è®¾è¿™æ˜¯ä¸€ä¸ªå¾ˆé«˜é¢‘çš„æŸ¥è¯¢è¯·æ±‚ï¼Œä½ ä¼šæ€ä¹ˆå»ºç«‹ç´¢å¼•å‘¢ï¼Ÿ\n æ€è€ƒå›è¡¨çš„æ¶ˆè€—å¯¹SQLè¿›è¡Œä¼˜åŒ–ã€‚\n å»ºç«‹ä¸€ä¸ªï¼Œåç§°å’Œåº“å­˜çš„è”åˆç´¢å¼•ï¼Œè¿™æ ·åç§°æŸ¥å‡ºæ¥å°±å¯ä»¥çœ‹åˆ°åº“å­˜äº†ï¼Œä¸éœ€è¦æŸ¥å‡ºidä¹‹åå»å›è¡¨å†æŸ¥è¯¢åº“å­˜äº†ï¼Œè”åˆç´¢å¼•åœ¨æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯å¸¸è§çš„ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯å¯ä»¥ä¸€ç›´å»ºç«‹çš„ï¼Œå¤§å®¶è¦æ€è€ƒç´¢å¼•å æ®çš„ç©ºé—´ã€‚\n  æœ€å·¦åŒ¹é…åŸåˆ™\nå¦‚æœåˆ©ç”¨ä¸€ä¸ªæ¨¡ç³ŠæŸ¥è¯¢ itemname like â€™æ•–ä¸™%â€˜ï¼Œè¿™æ ·è¿˜æ˜¯èƒ½åˆ©ç”¨åˆ°è¿™ä¸ªç´¢å¼•çš„ï¼Œè€Œä¸”å¦‚æœæœ‰è¿™æ ·çš„è”åˆç´¢å¼•ï¼Œå¤§å®¶ä¹Ÿæ²¡å¿…è¦å»æ–°å»ºä¸€ä¸ªå•†å“åç§°å•ç‹¬çš„ç´¢å¼•äº†ã€‚\n å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ç´¢å¼•å¯èƒ½æ²¡å»ºå¯¹ï¼Œé‚£ä½ è°ƒæ•´ä¸€ä¸‹é¡ºåºï¼Œå¯èƒ½å°±å¯ä»¥ä¼˜åŒ–åˆ°æ•´ä¸ªSQLäº†ã€‚\n   ç´¢å¼•ä¸‹æ¨\nçŸ¥é“äº†å‰ç¼€ç´¢å¼•è§„åˆ™ï¼Œé‚£æˆ‘å°±è¯´ä¸€ä¸ªå®˜æ–¹å¸®æˆ‘ä»¬ä¼˜åŒ–çš„ä¸œè¥¿ï¼Œç´¢å¼•ä¸‹æ¨ã€‚\n1  select * from itemcenter where name like \u0026#39;æ•–%\u0026#39; and size=22 and age = 20;   æ‰€ä»¥è¿™ä¸ªè¯­å¥åœ¨æœç´¢ç´¢å¼•æ ‘çš„æ—¶å€™ï¼Œåªèƒ½ç”¨ â€œæ•–â€ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½•ID1ï¼Œå½“ç„¶ï¼Œè¿™è¿˜ä¸é”™ï¼Œæ€»æ¯”å…¨è¡¨æ‰«æè¦å¥½ã€‚\nç„¶åæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ç´¢å¼•ä¸‹æ¨è¿›è¡Œä¼˜åŒ–ï¼š\nåœ¨MySQL 5.6ä¹‹å‰ï¼Œåªèƒ½ä»ID1å¼€å§‹ä¸€ä¸ªä¸ªå›è¡¨ï¼Œåˆ°ä¸»é”®ç´¢å¼•ä¸Šæ‰¾å‡ºæ•°æ®è¡Œï¼Œå†å¯¹æ¯”å­—æ®µå€¼ã€‚\nè€ŒMySQL 5.6 å¼•å…¥çš„ç´¢å¼•ä¸‹æ¨ä¼˜åŒ–ï¼ˆindex condition pushdown)ï¼Œ å¯ä»¥åœ¨ç´¢å¼•éå†è¿‡ç¨‹ä¸­ï¼Œå¯¹ç´¢å¼•ä¸­åŒ…å«çš„å­—æ®µå…ˆåšåˆ¤æ–­ï¼Œç›´æ¥è¿‡æ»¤æ‰ä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå‡å°‘å›è¡¨æ¬¡æ•°ã€‚\n  å”¯ä¸€ç´¢å¼•æ™®é€šç´¢å¼•é€‰æ‹©\nå½“éœ€è¦æ›´æ–°ä¸€ä¸ªæ•°æ®é¡µæ—¶ï¼Œå¦‚æœæ•°æ®é¡µåœ¨å†…å­˜ä¸­å°±ç›´æ¥æ›´æ–°ï¼Œè€Œå¦‚æœè¿™ä¸ªæ•°æ®é¡µè¿˜æ²¡æœ‰åœ¨å†…å­˜ä¸­çš„è¯ï¼Œåœ¨ä¸å½±å“æ•°æ®ä¸€è‡´æ€§çš„å‰æä¸‹ï¼ŒInooDBä¼šå°†è¿™äº›æ›´æ–°æ“ä½œç¼“å­˜åœ¨change bufferä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä»ç£ç›˜ä¸­è¯»å…¥è¿™ä¸ªæ•°æ®é¡µäº†ã€‚\nåœ¨ä¸‹æ¬¡æŸ¥è¯¢éœ€è¦è®¿é—®è¿™ä¸ªæ•°æ®é¡µçš„æ—¶å€™ï¼Œå°†æ•°æ®é¡µè¯»å…¥å†…å­˜ï¼Œç„¶åæ‰§è¡Œchange bufferä¸­ä¸è¿™ä¸ªé¡µæœ‰å…³çš„æ“ä½œï¼Œé€šè¿‡è¿™ç§æ–¹å¼å°±èƒ½ä¿è¯è¿™ä¸ªæ•°æ®é€»è¾‘çš„æ­£ç¡®æ€§ã€‚\n å°†change bufferä¸­çš„æ“ä½œåº”ç”¨åˆ°åŸæ•°æ®é¡µï¼Œå¾—åˆ°æœ€æ–°ç»“æœçš„è¿‡ç¨‹ç§°ä¸ºmergeã€‚é™¤äº†è®¿é—®è¿™ä¸ªæ•°æ®é¡µä¼šè§¦å‘mergeå¤–ï¼Œç³»ç»Ÿæœ‰åå°çº¿ç¨‹ä¼šå®šæœŸmergeã€‚åœ¨æ•°æ®åº“æ­£å¸¸å…³é—­ï¼ˆshutdownï¼‰çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šæ‰§è¡Œmergeæ“ä½œã€‚\n é‚£ä¹ˆï¼Œä»€ä¹ˆæ¡ä»¶ä¸‹å¯ä»¥ä½¿ç”¨change bufferå‘¢ï¼Ÿ\nå¯¹äºå”¯ä¸€ç´¢å¼•æ¥è¯´ï¼Œæ‰€æœ‰çš„æ›´æ–°æ“ä½œéƒ½è¦å…ˆåˆ¤æ–­è¿™ä¸ªæ“ä½œæ˜¯å¦è¿åå”¯ä¸€æ€§çº¦æŸã€‚\nè¦åˆ¤æ–­è¡¨ä¸­æ˜¯å¦å­˜åœ¨è¿™ä¸ªæ•°æ®ï¼Œè€Œè¿™å¿…é¡»è¦å°†æ•°æ®é¡µè¯»å…¥å†…å­˜æ‰èƒ½åˆ¤æ–­ï¼Œå¦‚æœéƒ½å·²ç»è¯»å…¥åˆ°å†…å­˜äº†ï¼Œé‚£ç›´æ¥æ›´æ–°å†…å­˜ä¼šæ›´å¿«ï¼Œå°±æ²¡å¿…è¦ä½¿ç”¨change bufferäº†ã€‚\nå› æ­¤ï¼Œå”¯ä¸€ç´¢å¼•çš„æ›´æ–°å°±ä¸èƒ½ä½¿ç”¨change bufferï¼Œå®é™…ä¸Šä¹Ÿåªæœ‰æ™®é€šç´¢å¼•å¯ä»¥ä½¿ç”¨ã€‚\nchange bufferç”¨çš„æ˜¯buffer poolé‡Œçš„å†…å­˜ï¼Œå› æ­¤ä¸èƒ½æ— é™å¢å¤§ï¼Œchange bufferçš„å¤§å°ï¼Œå¯ä»¥é€šè¿‡å‚æ•°innodb_change_buffer_max_sizeæ¥åŠ¨æ€è®¾ç½®ï¼Œè¿™ä¸ªå‚æ•°è®¾ç½®ä¸º50çš„æ—¶å€™ï¼Œè¡¨ç¤ºchange bufferçš„å¤§å°æœ€å¤šåªèƒ½å ç”¨buffer poolçš„50%ã€‚\nå°†æ•°æ®ä»ç£ç›˜è¯»å…¥å†…å­˜æ¶‰åŠéšæœºIOçš„è®¿é—®ï¼Œæ˜¯æ•°æ®åº“é‡Œé¢æˆæœ¬æœ€é«˜çš„æ“ä½œä¹‹ä¸€ï¼Œchange bufferå› ä¸ºå‡å°‘äº†éšæœºç£ç›˜è®¿é—®ï¼Œæ‰€ä»¥å¯¹æ›´æ–°æ€§èƒ½çš„æå‡æ˜¯ä¼šå¾ˆæ˜æ˜¾çš„ã€‚\n  å‰ç¼€ç´¢å¼•\næˆ‘ä»¬å­˜åœ¨é‚®ç®±ä½œä¸ºç”¨æˆ·åçš„æƒ…å†µï¼Œæ¯ä¸ªäººçš„é‚®ç®±éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥åœ¨é‚®ç®±ä¸Šå»ºç«‹ç´¢å¼•ï¼Œä½†æ˜¯é‚®ç®±è¿™ä¹ˆé•¿ï¼Œæˆ‘ä»¬æ€ä¹ˆå»å»ºç«‹ç´¢å¼•å‘¢ï¼Ÿ\nMySQLæ˜¯æ”¯æŒå‰ç¼€ç´¢å¼•çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥å®šä¹‰å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ä½œä¸ºç´¢å¼•ã€‚é»˜è®¤åœ°ï¼Œå¦‚æœä½ åˆ›å»ºç´¢å¼•çš„è¯­å¥ä¸æŒ‡å®šå‰ç¼€é•¿åº¦ï¼Œé‚£ä¹ˆç´¢å¼•å°±ä¼šåŒ…å«æ•´ä¸ªå­—ç¬¦ä¸²ã€‚\n  Mysqlå„ç§å¼•æ“å’ŒåŒºåˆ«  MySQLä¸­çš„æ•°æ®ç”¨å„ç§ä¸åŒçš„æŠ€æœ¯å­˜å‚¨åœ¨æ–‡ä»¶ï¼ˆæˆ–è€…å†…å­˜ï¼‰ä¸­ã€‚è¿™äº›æŠ€æœ¯ä¸­çš„æ¯ä¸€ç§æŠ€æœ¯éƒ½ä½¿ç”¨ä¸åŒçš„å­˜å‚¨æœºåˆ¶ã€ç´¢å¼•æŠ€å·§ã€é”å®šæ°´å¹³å¹¶ä¸”æœ€ç»ˆæä¾›å¹¿æ³›çš„ä¸åŒçš„åŠŸèƒ½å’Œèƒ½åŠ›ã€‚é€šè¿‡é€‰æ‹©ä¸åŒçš„æŠ€æœ¯ï¼Œä½ èƒ½å¤Ÿè·å¾—é¢å¤–çš„é€Ÿåº¦æˆ–è€…åŠŸèƒ½ï¼Œä»è€Œæ”¹å–„ä½ çš„åº”ç”¨çš„æ•´ä½“åŠŸèƒ½ã€‚\n MySQLå­˜å‚¨å¼•æ“ä¸»è¦æœ‰ï¼š MyIsamã€InnoDBã€Memoryã€Blackholeã€CSVã€Performance_Schemaã€Archiveã€Federatedã€Mrg_Myisamã€‚\nä½†æ˜¯æœ€å¸¸ç”¨çš„æ˜¯InnoDBå’ŒMylsamã€‚\nInnoDB\nInnoDBæ˜¯ä¸€ä¸ªäº‹åŠ¡å‹çš„å­˜å‚¨å¼•æ“ï¼Œæœ‰è¡Œçº§é”å®šå’Œå¤–é”®çº¦æŸã€‚\nInnodbå¼•æ“æä¾›äº†å¯¹æ•°æ®åº“ACIDäº‹åŠ¡çš„æ”¯æŒï¼Œå¹¶ä¸”å®ç°äº†SQLæ ‡å‡†çš„å››ç§éš”ç¦»çº§åˆ«ï¼Œå…³äºæ•°æ®åº“äº‹åŠ¡ä¸å…¶éš”ç¦»çº§åˆ«çš„å†…å®¹è¯·è§æ•°æ®åº“äº‹åŠ¡ä¸å…¶éš”ç¦»çº§åˆ«è¿™ç±»å‹çš„æ–‡ç« ã€‚è¯¥å¼•æ“è¿˜æä¾›äº†è¡Œçº§é”å’Œå¤–é”®çº¦æŸï¼Œå®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯å¤„ç†å¤§å®¹é‡æ•°æ®åº“ç³»ç»Ÿï¼Œå®ƒæœ¬èº«å…¶å®å°±æ˜¯åŸºäºMySQLåå°çš„å®Œæ•´æ•°æ®åº“ç³»ç»Ÿï¼ŒMySQLè¿è¡Œæ—¶Innodbä¼šåœ¨å†…å­˜ä¸­å»ºç«‹ç¼“å†²æ± ï¼Œç”¨äºç¼“å†²æ•°æ®å’Œç´¢å¼•ã€‚ä½†æ˜¯è¯¥å¼•æ“ä¸æ”¯æŒFULLTEXTç±»å‹çš„ç´¢å¼•ï¼Œè€Œä¸”å®ƒæ²¡æœ‰ä¿å­˜è¡¨çš„è¡Œæ•°ï¼Œå½“SELECT COUNT(*) FROM TABLEæ—¶éœ€è¦æ‰«æå…¨è¡¨ã€‚å½“éœ€è¦ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡æ—¶ï¼Œè¯¥å¼•æ“å½“ç„¶æ˜¯é¦–é€‰ã€‚ç”±äºé”çš„ç²’åº¦æ›´å°ï¼Œå†™æ“ä½œä¸ä¼šé”å®šå…¨è¡¨ï¼Œæ‰€ä»¥åœ¨å¹¶å‘è¾ƒé«˜æ—¶ï¼Œä½¿ç”¨Innodbå¼•æ“ä¼šæå‡æ•ˆç‡ã€‚ä½†æ˜¯ä½¿ç”¨è¡Œçº§é”ä¹Ÿä¸æ˜¯ç»å¯¹çš„ï¼Œå¦‚æœåœ¨æ‰§è¡Œä¸€ä¸ªSQLè¯­å¥æ—¶MySQLä¸èƒ½ç¡®å®šè¦æ‰«æçš„èŒƒå›´ï¼ŒInnoDBè¡¨åŒæ ·ä¼šé”å…¨è¡¨ã€‚\n é€‚ç”¨åœºæ™¯ï¼š\nç»å¸¸æ›´æ–°çš„è¡¨ï¼Œé€‚åˆå¤„ç†å¤šé‡å¹¶å‘çš„æ›´æ–°è¯·æ±‚ã€‚\n ç´¢å¼•ç»“æ„ï¼šInnoDBæ˜¯B+Treeeç´¢å¼•ç»“æ„ã€‚å¹¶ä¸”Innodbçš„ç´¢å¼•æ–‡ä»¶æœ¬èº«å°±æ˜¯æ•°æ®æ–‡ä»¶ï¼Œå³B+Treeçš„æ•°æ®åŸŸå­˜å‚¨çš„å°±æ˜¯å®é™…çš„æ•°æ®ï¼Œè¿™ç§ç´¢å¼•å°±æ˜¯èšé›†ç´¢å¼•ã€‚\n InnoDBçš„è¾…åŠ©ç´¢å¼•æ•°æ®åŸŸå­˜å‚¨çš„ä¹Ÿæ˜¯ç›¸åº”è®°å½•ä¸»é”®çš„å€¼è€Œä¸æ˜¯åœ°å€ï¼Œæ‰€ä»¥å½“ä»¥è¾…åŠ©ç´¢å¼•æŸ¥æ‰¾æ—¶ï¼Œä¼šå…ˆæ ¹æ®è¾…åŠ©ç´¢å¼•æ‰¾åˆ°ä¸»é”®ï¼Œå†æ ¹æ®ä¸»é”®ç´¢å¼•æ‰¾åˆ°å®é™…çš„æ•°æ®ã€‚æ‰€ä»¥Innodbä¸å»ºè®®ä½¿ç”¨è¿‡é•¿çš„ä¸»é”®ï¼Œå¦åˆ™ä¼šä½¿è¾…åŠ©ç´¢å¼•å˜å¾—è¿‡å¤§ã€‚å»ºè®®ä½¿ç”¨è‡ªå¢çš„å­—æ®µä½œä¸ºä¸»é”®ï¼Œè¿™æ ·B+Treeçš„æ¯ä¸€ä¸ªç»“ç‚¹éƒ½ä¼šè¢«é¡ºåºçš„å¡«æ»¡ï¼Œè€Œä¸ä¼šé¢‘ç¹çš„åˆ†è£‚è°ƒæ•´ï¼Œä¼šæœ‰æ•ˆçš„æå‡æ’å…¥æ•°æ®çš„æ•ˆç‡ã€‚\n Mylsam\nMyIASMæ˜¯MySQLé»˜è®¤çš„å¼•æ“ï¼Œä½†æ˜¯å®ƒæ²¡æœ‰æä¾›å¯¹æ•°æ®åº“äº‹åŠ¡çš„æ”¯æŒï¼Œä¹Ÿä¸æ”¯æŒè¡Œçº§é”å’Œå¤–é”®ï¼Œå› æ­¤å½“INSERTæˆ–UPDATEæ•°æ®æ—¶å³å†™æ“ä½œéœ€è¦é”å®šæ•´ä¸ªè¡¨ï¼Œæ•ˆç‡ä¾¿ä¼šä½ä¸€äº›ã€‚MyIsam å­˜å‚¨å¼•æ“ç‹¬ç«‹äºæ“ä½œç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åœ¨windowsä¸Šä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥æ¯”è¾ƒç®€å•çš„å°†æ•°æ®è½¬ç§»åˆ°linuxæ“ä½œç³»ç»Ÿä¸Šå»ã€‚\n é€‚ç”¨åœºæ™¯ï¼š\nä¸æ”¯æŒäº‹åŠ¡çš„è®¾è®¡ï¼Œä½†æ˜¯å¹¶ä¸ä»£è¡¨ç€æœ‰äº‹åŠ¡æ“ä½œçš„é¡¹ç›®ä¸èƒ½ç”¨MyIsamå­˜å‚¨å¼•æ“ï¼Œå¯ä»¥åœ¨serviceå±‚è¿›è¡Œæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡éœ€æ±‚è¿›è¡Œç›¸åº”çš„æ§åˆ¶ã€‚\nä¸æ”¯æŒå¤–é”®çš„è¡¨è®¾è®¡ã€‚\næŸ¥è¯¢é€Ÿåº¦å¾ˆå¿«ï¼Œå¦‚æœæ•°æ®åº“insertå’Œupdateçš„æ“ä½œæ¯”è¾ƒå¤šçš„è¯æ¯”è¾ƒé€‚ç”¨ã€‚\næ•´å¤©å¯¹è¡¨è¿›è¡ŒåŠ é”çš„åœºæ™¯ã€‚\nMyISAMæåº¦å¼ºè°ƒå¿«é€Ÿè¯»å–æ“ä½œã€‚\n ç´¢å¼•ç»“æ„ï¼šMyISAMç´¢å¼•ç”¨çš„B+ treeæ¥å‚¨å­˜æ•°æ®ï¼ŒMyISAMç´¢å¼•çš„æŒ‡é’ˆæŒ‡å‘çš„æ˜¯é”®å€¼çš„åœ°å€ï¼Œåœ°å€å­˜å‚¨çš„æ˜¯æ•°æ®ã€‚B+Treeçš„æ•°æ®åŸŸå­˜å‚¨çš„å†…å®¹ä¸ºå®é™…æ•°æ®çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒçš„ç´¢å¼•å’Œå®é™…çš„æ•°æ®æ˜¯åˆ†å¼€çš„ï¼Œåªä¸è¿‡æ˜¯ç”¨ç´¢å¼•æŒ‡å‘äº†å®é™…çš„æ•°æ®ï¼Œè¿™ç§ç´¢å¼•å°±æ˜¯æ‰€è°“çš„éèšé›†ç´¢å¼•ã€‚\nInnoDBå’ŒMyISAMçš„åŒºåˆ«\n  äº‹åŠ¡ï¼šMyISAMç±»å‹ä¸æ”¯æŒäº‹åŠ¡å¤„ç†ç­‰é«˜çº§å¤„ç†ï¼Œè€ŒInnoDBç±»å‹æ”¯æŒï¼Œæä¾›äº‹åŠ¡æ”¯æŒå·²ç»å¤–éƒ¨é”®ç­‰é«˜çº§æ•°æ®åº“åŠŸèƒ½\n  æ€§èƒ½ï¼šMyISAMç±»å‹çš„è¡¨å¼ºè°ƒçš„æ˜¯æ€§èƒ½ï¼Œå…¶æ‰§è¡Œæ•°åº¦æ¯”InnoDBç±»å‹æ›´å¿«ã€‚\n  è¡Œæ•°ä¿å­˜ï¼šInnoDB ä¸­ä¸ä¿å­˜è¡¨çš„å…·ä½“è¡Œæ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰§è¡Œselect count() fromtableæ—¶ï¼ŒInnoDBè¦æ‰«æä¸€éæ•´ä¸ªè¡¨æ¥è®¡ç®—æœ‰å¤šå°‘è¡Œï¼Œä½†æ˜¯MyISAMåªè¦ç®€å•çš„è¯»å‡ºä¿å­˜å¥½çš„è¡Œæ•°å³å¯ã€‚æ³¨æ„çš„æ˜¯ï¼Œå½“count()è¯­å¥åŒ…å«whereæ¡ä»¶æ—¶ï¼Œä¸¤ç§è¡¨çš„æ“ä½œæ˜¯ä¸€æ ·çš„ã€‚\n  ç´¢å¼•å­˜å‚¨ï¼šå¯¹äºAUTO_INCREMENTç±»å‹çš„å­—æ®µï¼ŒInnoDBä¸­å¿…é¡»åŒ…å«åªæœ‰è¯¥å­—æ®µçš„ç´¢å¼•ï¼Œä½†æ˜¯åœ¨MyISAMè¡¨ä¸­ï¼Œå¯ä»¥å’Œå…¶ä»–å­—æ®µä¸€èµ·å»ºç«‹è”åˆç´¢å¼•ã€‚MyISAMæ”¯æŒå…¨æ–‡ç´¢å¼•ï¼ˆFULLTEXTï¼‰ã€å‹ç¼©ç´¢å¼•ï¼ŒInnoDBä¸æ”¯æŒã€‚\nMyISAMçš„ç´¢å¼•å’Œæ•°æ®æ˜¯åˆ†å¼€çš„ï¼Œå¹¶ä¸”ç´¢å¼•æ˜¯æœ‰å‹ç¼©çš„ï¼Œå†…å­˜ä½¿ç”¨ç‡å°±å¯¹åº”æé«˜äº†ä¸å°‘ã€‚èƒ½åŠ è½½æ›´å¤šç´¢å¼•ï¼Œè€ŒInnodbæ˜¯ç´¢å¼•å’Œæ•°æ®æ˜¯ç´§å¯†æ†ç»‘çš„ï¼Œæ²¡æœ‰ä½¿ç”¨å‹ç¼©ä»è€Œä¼šé€ æˆInnodbæ¯”MyISAMä½“ç§¯åºå¤§ä¸å°ã€‚\nInnoDBå­˜å‚¨å¼•æ“è¢«å®Œå…¨ä¸MySQLæœåŠ¡å™¨æ•´åˆï¼ŒInnoDBå­˜å‚¨å¼•æ“ä¸ºåœ¨ä¸»å†…å­˜ä¸­ç¼“å­˜æ•°æ®å’Œç´¢å¼•è€Œç»´æŒå®ƒè‡ªå·±çš„ç¼“å†²æ± ã€‚InnoDBå­˜å‚¨å®ƒçš„è¡¨ï¼†ç´¢å¼•åœ¨ä¸€ä¸ªè¡¨ç©ºé—´ä¸­ï¼Œè¡¨ç©ºé—´å¯ä»¥åŒ…å«æ•°ä¸ªæ–‡ä»¶ï¼ˆæˆ–åŸå§‹ç£ç›˜åˆ†åŒºï¼‰ã€‚è¿™ä¸MyISAMè¡¨ä¸åŒï¼Œæ¯”å¦‚åœ¨MyISAMè¡¨ä¸­æ¯ä¸ªè¡¨è¢«å­˜åœ¨åˆ†ç¦»çš„æ–‡ä»¶ä¸­ã€‚InnoDB è¡¨å¯ä»¥æ˜¯ä»»ä½•å°ºå¯¸ï¼Œå³ä½¿åœ¨æ–‡ä»¶å°ºå¯¸è¢«é™åˆ¶ä¸º2GBçš„æ“ä½œç³»ç»Ÿä¸Šã€‚\n  æœåŠ¡å™¨æ•°æ®å¤‡ä»½ï¼šInnoDBå¿…é¡»å¯¼å‡ºSQLæ¥å¤‡ä»½ï¼ŒLOAD TABLE FROM MASTERæ“ä½œå¯¹InnoDBæ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œè§£å†³æ–¹æ³•æ˜¯é¦–å…ˆæŠŠInnoDBè¡¨æ”¹æˆMyISAMè¡¨ï¼Œå¯¼å…¥æ•°æ®åå†æ”¹æˆInnoDBè¡¨ï¼Œä½†æ˜¯å¯¹äºä½¿ç”¨çš„é¢å¤–çš„InnoDBç‰¹æ€§(ä¾‹å¦‚å¤–é”®)çš„è¡¨ä¸é€‚ç”¨ã€‚\nMyISAMåº”å¯¹é”™è¯¯ç¼–ç å¯¼è‡´çš„æ•°æ®æ¢å¤é€Ÿåº¦å¿«ã€‚MyISAMçš„æ•°æ®æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜å‚¨ï¼Œæ‰€ä»¥åœ¨è·¨å¹³å°çš„æ•°æ®è½¬ç§»ä¸­ä¼šå¾ˆæ–¹ä¾¿ã€‚åœ¨å¤‡ä»½å’Œæ¢å¤æ—¶å¯å•ç‹¬é’ˆå¯¹æŸä¸ªè¡¨è¿›è¡Œæ“ä½œã€‚\nInnoDBæ˜¯æ‹·è´æ•°æ®æ–‡ä»¶ã€å¤‡ä»½ binlogï¼Œæˆ–è€…ç”¨ mysqldumpï¼Œåœ¨æ•°æ®é‡è¾¾åˆ°å‡ åGçš„æ—¶å€™å°±ç›¸å¯¹ç—›è‹¦äº†ã€‚\n  é”çš„æ”¯æŒï¼šMyISAMåªæ”¯æŒè¡¨é”ã€‚InnoDBæ”¯æŒè¡¨é”ã€è¡Œé” è¡Œé”å¤§å¹…åº¦æé«˜äº†å¤šç”¨æˆ·å¹¶å‘æ“ä½œçš„æ–°èƒ½ã€‚ä½†æ˜¯InnoDBçš„è¡Œé”ï¼Œåªæ˜¯åœ¨WHEREçš„ä¸»é”®æ˜¯æœ‰æ•ˆçš„ï¼Œéä¸»é”®çš„WHEREéƒ½ä¼šé”å…¨è¡¨çš„ã€‚\n  å‚è€ƒé“¾æ¥ï¼š\n æœ‰å“ªäº›å¸¸è§çš„æ•°æ®åº“ä¼˜åŒ–æ–¹æ³•ï¼Ÿ MySQL æ€§èƒ½ä¼˜åŒ–ç¥å™¨ Explain ä½¿ç”¨åˆ†æ  ","description":"","id":8,"section":"talks","tags":[""],"title":"Database Talk","uri":"https://hugo.jiahongw.com/zh/talks/database-talk/"},{"content":"546. ç§»é™¤ç›’å­ ç»™å‡ºä¸€äº›ä¸åŒé¢œè‰²çš„ç›’å­ï¼Œç›’å­çš„é¢œè‰²ç”±æ•°å­—è¡¨ç¤ºï¼Œå³ä¸åŒçš„æ•°å­—è¡¨ç¤ºä¸åŒçš„é¢œè‰²ã€‚\nä½ å°†ç»è¿‡è‹¥å¹²è½®æ“ä½œå»å»æ‰ç›’å­ï¼Œç›´åˆ°æ‰€æœ‰çš„ç›’å­éƒ½å»æ‰ä¸ºæ­¢ã€‚æ¯ä¸€è½®ä½ å¯ä»¥ç§»é™¤å…·æœ‰ç›¸åŒé¢œè‰²çš„è¿ç»­ k ä¸ªç›’å­ï¼ˆk \u0026gt;= 1ï¼‰ï¼Œè¿™æ ·ä¸€è½®ä¹‹åä½ å°†å¾—åˆ° k*k ä¸ªç§¯åˆ†ã€‚\nå½“ä½ å°†æ‰€æœ‰ç›’å­éƒ½å»æ‰ä¹‹åï¼Œæ±‚ä½ èƒ½è·å¾—çš„æœ€å¤§ç§¯åˆ†å’Œã€‚\nç¤ºä¾‹ï¼š\nè¾“å…¥ï¼šboxes = [1,3,2,2,2,3,4,3,1] è¾“å‡ºï¼š23 è§£é‡Šï¼š [1, 3, 2, 2, 2, 3, 4, 3, 1] ----\u0026gt; [1, 3, 3, 4, 3, 1] (3*3=9 åˆ†) ----\u0026gt; [1, 3, 3, 3, 1] (1*1=1 åˆ†) ----\u0026gt; [1, 1] (3*3=9 åˆ†) ----\u0026gt; [] (2*2=4 åˆ†) æç¤ºï¼š\n 1 \u0026lt;= boxes.length \u0026lt;= 100 1 \u0026lt;= boxes[i] \u0026lt;= 100  åˆ†æ ä¸€èˆ¬æ¥è¯´ï¼Œæ±‚æœ€å€¼çš„é—®é¢˜å‡ ä¹å’ŒåŠ¨æ€è§„åˆ’æœ‰å…³ç³»ï¼Œé‚£ä¹ˆè¿™é¢˜ä¹Ÿæ˜¯ä»åŠ¨æ€è§„åˆ’çš„è§’åº¦å»æ€è€ƒè§£å†³æ–¹æ¡ˆã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  class Solution { int len; int removeBoxes(vector\u0026lt;int\u0026gt;\u0026amp; boxes,int i,int j,int k,vector\u0026lt;vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;\u0026gt;\u0026amp; dp) { if(i \u0026gt; j) return 0; if(dp[i][j][k] \u0026gt; 0) return dp[i][j][k]; for(;i+1 \u0026lt;= j \u0026amp;\u0026amp; boxes[i+1] == boxes[i];++i,++k); int res = (k+1) * (k+1) + removeBoxes(boxes,i+1,j,0,dp); for(int m = i + 1;m \u0026lt;= j;++m) if(boxes[m] == boxes[i]) res = max(res,removeBoxes(boxes,i+1,m-1,0,dp) + removeBoxes(boxes,m,j,k+1,dp)); return dp[i][j][k] = res; } public: int removeBoxes(vector\u0026lt;int\u0026gt;\u0026amp; boxes) { len = boxes.size(); // dp[i][j][k] è¡¨ç¤ºä»iåˆ°jçš„èŒƒå›´æœ‰kä¸ªç›¸åŒé¢œè‰²çš„æ•°å­—åœ¨içš„å‰é¢ï¼Œå¹¶ä¸”ä¸‹æ ‡içš„é¢œè‰²ä¹Ÿä¸å®ƒä»¬ç›¸åŒ  vector\u0026lt;vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;\u0026gt; dp(len+1,vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;(len+1,vector\u0026lt;int\u0026gt;(len+1,0))); return removeBoxes(boxes,0,len-1,0,dp); } };   5490. åƒæ‰ N ä¸ªæ©˜å­çš„æœ€å°‘å¤©æ•° å¨æˆ¿é‡Œæ€»å…±æœ‰ n ä¸ªæ©˜å­ï¼Œä½ å†³å®šæ¯ä¸€å¤©é€‰æ‹©å¦‚ä¸‹æ–¹å¼ä¹‹ä¸€åƒè¿™äº›æ©˜å­ï¼š\n åƒæ‰ä¸€ä¸ªæ©˜å­ã€‚ å¦‚æœå‰©ä½™æ©˜å­æ•° n èƒ½è¢« 2 æ•´é™¤ï¼Œé‚£ä¹ˆä½ å¯ä»¥åƒæ‰ n/2 ä¸ªæ©˜å­ã€‚ å¦‚æœå‰©ä½™æ©˜å­æ•° n èƒ½è¢« 3 æ•´é™¤ï¼Œé‚£ä¹ˆä½ å¯ä»¥åƒæ‰ 2*(n/3) ä¸ªæ©˜å­ã€‚  æ¯å¤©ä½ åªèƒ½ä»ä»¥ä¸Š 3 ç§æ–¹æ¡ˆä¸­é€‰æ‹©ä¸€ç§æ–¹æ¡ˆã€‚\nè¯·ä½ è¿”å›åƒæ‰æ‰€æœ‰ n ä¸ªæ©˜å­çš„æœ€å°‘å¤©æ•°ã€‚\nç¤ºä¾‹ 1ï¼š\nè¾“å…¥ï¼šn = 10 è¾“å‡ºï¼š4 è§£é‡Šï¼šä½ æ€»å…±æœ‰ 10 ä¸ªæ©˜å­ã€‚ ç¬¬ 1 å¤©ï¼šåƒ 1 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 10 - 1 = 9ã€‚ ç¬¬ 2 å¤©ï¼šåƒ 6 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 9 - 2*(9/3) = 9 - 6 = 3ã€‚ï¼ˆ9 å¯ä»¥è¢« 3 æ•´é™¤ï¼‰ ç¬¬ 3 å¤©ï¼šåƒ 2 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 3 - 2*(3/3) = 3 - 2 = 1ã€‚ ç¬¬ 4 å¤©ï¼šåƒæ‰æœ€å 1 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 1 - 1 = 0ã€‚ ä½ éœ€è¦è‡³å°‘ 4 å¤©åƒæ‰ 10 ä¸ªæ©˜å­ã€‚ ç¤ºä¾‹ 2ï¼š\nè¾“å…¥ï¼šn = 6 è¾“å‡ºï¼š3 è§£é‡Šï¼šä½ æ€»å…±æœ‰ 6 ä¸ªæ©˜å­ã€‚ ç¬¬ 1 å¤©ï¼šåƒ 3 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 6 - 6/2 = 6 - 3 = 3ã€‚ï¼ˆ6 å¯ä»¥è¢« 2 æ•´é™¤ï¼‰ ç¬¬ 2 å¤©ï¼šåƒ 2 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 3 - 2*(3/3) = 3 - 2 = 1ã€‚ï¼ˆ3 å¯ä»¥è¢« 3 æ•´é™¤ï¼‰ ç¬¬ 3 å¤©ï¼šåƒæ‰å‰©ä½™ 1 ä¸ªæ©˜å­ï¼Œå‰©ä½™æ©˜å­æ•° 1 - 1 = 0ã€‚ ä½ è‡³å°‘éœ€è¦ 3 å¤©åƒæ‰ 6 ä¸ªæ©˜å­ã€‚ ç¤ºä¾‹ 3ï¼š\nè¾“å…¥ï¼šn = 1 è¾“å‡ºï¼š1 ç¤ºä¾‹ 4ï¼š\nè¾“å…¥ï¼šn = 56 è¾“å‡ºï¼š6 æç¤ºï¼š\n 1 \u0026lt;= n \u0026lt;= 2*10^9  åˆ†æ æ•´ä¸ªé—®é¢˜å°±æ˜¯ä¸€ä¸ªæ±‚æœ€å€¼çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨é€’å½’è¿›è¡Œæ·±åº¦ä¼˜å…ˆåˆ¤æ–­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’å»ºç«‹ä¸€ä¸ªdpæ•°ç»„è¿›è¡Œæ±‚è§£ï¼š\nä»£ç  é€’å½’æ±‚è§£(è¶…æ—¶)ï¼š\n1 2 3 4 5 6 7 8 9  int solve(int n) { if(n == 0) return 0; if(n == 1) return 1; int r1 = minDays(n - 1); int r2 = n%2==0? minDays(n - n/2):INT_MAX; int r3 = n%3==0? minDays(n -2*(n/3)):INT_MAX; return min(min(r1,r2),r3) + 1; }   åŠ ä¸Šå“ˆå¸Œè¡¨(å †æ ˆæº¢å‡º)ï¼š\n1 2 3 4 5 6 7 8 9 10 11  unordered_map\u0026lt;int,int\u0026gt; table; int solve(int n) { if(n == 0) return 0; if(n == 1) return 1; if(table.find(n) != table.end()) return table[n]; int r1 = minDays(n - 1); int r2 = n%2==0? minDays(n - n/2):INT_MAX; int r3 = n%3==0? minDays(n -2*(n/3)):INT_MAX; return table[n] = min(min(r1,r2),r3) + 1; }   åŠ¨æ€è§„åˆ’(è¶…å‡ºæ—¶é—´é™åˆ¶)ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  int minDays(int n) { vector\u0026lt;int\u0026gt; dp(n+1,0); for(int i = 1;i \u0026lt;= n;++i) { if(i % 6 == 0) { dp[i] = min(min(dp[i - 2*(i/3)],dp[i-1]),dp[i - i/2]) + 1; } else if(i % 2 == 0) dp[i] = min(dp[i - i/2],dp[i-1]) + 1; else if(i % 3 == 0) dp[i] = min(dp[i - 2*(i/3)],dp[i-1]) + 1; else dp[i] = dp[i-1] + 1; } return dp[n]; }   ç¦»æ•£åŒ–é€’å½’ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  class Solution { unordered_map\u0026lt;int,int\u0026gt; table; int solve(int n) { if(n == 0 || n == 1) return n; if(table.find(n) != table.end()) return table[n]; table[n] = min((n\u0026amp;1) + solve(n/2),(n%3) + solve(n/3))+1; return table[n]; } public: int minDays(int n) { return solve(n); } };   743. ç½‘ç»œå»¶è¿Ÿæ—¶é—´ æœ‰ N ä¸ªç½‘ç»œèŠ‚ç‚¹ï¼Œæ ‡è®°ä¸º 1 åˆ° Nã€‚\nç»™å®šä¸€ä¸ªåˆ—è¡¨ timesï¼Œè¡¨ç¤ºä¿¡å·ç»è¿‡æœ‰å‘è¾¹çš„ä¼ é€’æ—¶é—´ã€‚ times[i] = (u, v, w)ï¼Œå…¶ä¸­ u æ˜¯æºèŠ‚ç‚¹ï¼Œv æ˜¯ç›®æ ‡èŠ‚ç‚¹ï¼Œ w æ˜¯ä¸€ä¸ªä¿¡å·ä»æºèŠ‚ç‚¹ä¼ é€’åˆ°ç›®æ ‡èŠ‚ç‚¹çš„æ—¶é—´ã€‚\nç°åœ¨ï¼Œæˆ‘ä»¬ä»æŸä¸ªèŠ‚ç‚¹ K å‘å‡ºä¸€ä¸ªä¿¡å·ã€‚éœ€è¦å¤šä¹…æ‰èƒ½ä½¿æ‰€æœ‰èŠ‚ç‚¹éƒ½æ”¶åˆ°ä¿¡å·ï¼Ÿå¦‚æœä¸èƒ½ä½¿æ‰€æœ‰èŠ‚ç‚¹æ”¶åˆ°ä¿¡å·ï¼Œè¿”å› -1ã€‚\nç¤ºä¾‹ï¼š\nè¾“å…¥ï¼štimes = [[2,1,1],[2,3,1],[3,4,1]], N = 4, K = 2 è¾“å‡ºï¼š2 æ³¨æ„:\n N çš„èŒƒå›´åœ¨ [1, 100] ä¹‹é—´ã€‚ K çš„èŒƒå›´åœ¨ [1, N] ä¹‹é—´ã€‚ times çš„é•¿åº¦åœ¨ [1, 6000] ä¹‹é—´ã€‚ æ‰€æœ‰çš„è¾¹ times[i] = (u, v, w) éƒ½æœ‰ 1 \u0026lt;= u, v \u0026lt;= N ä¸” 0 \u0026lt;= w \u0026lt;= 100ã€‚  åˆ†æ æœ¬é¢˜ä¸ºä¸€ä¸ªå›¾ç®—æ³•é¢˜ï¼Œä¸¤ç‚¹ä¹‹é—´çš„æ—¶é—´å¯ä»¥æŠ½è±¡æˆè·¯ç¨‹ï¼Œé‚£ä¹ˆæœ¬é¢˜ç›¸å½“äºæ±‚æŸä¸€ç‚¹åˆ°å…¶ä»–å„ç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œç„¶åæ±‚å‡ºå„ç‚¹æœ€çŸ­è·¯å¾„çš„æœ€å¤§å€¼ã€‚\nå¸¸è§çš„æœ€çŸ­è·¯é—®é¢˜åˆ†ä¸ºä¸¤ç±»ï¼šå•æºæœ€çŸ­è·¯å’Œå¤šæºæœ€çŸ­è·¯ã€‚å‰è€…åªéœ€è¦æ±‚ä¸€ä¸ªå›ºå®šçš„èµ·ç‚¹åˆ°å„ä¸ªé¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œåè€…åˆ™è¦æ±‚å¾—å‡ºä»»æ„ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ã€‚\nDijkstraç®—æ³• Dijkstra(è¿ªæ°æ–¯ç‰¹æ‹‰)ç®—æ³•æ˜¯å…¸å‹çš„å•æºæœ€çŸ­è·¯å¾„ç®—æ³•ï¼Œç”¨äºè®¡ç®—ä¸€ä¸ªèŠ‚ç‚¹åˆ°å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚ä¸»è¦ç‰¹ç‚¹æ˜¯ä»¥èµ·å§‹ç‚¹ä¸ºä¸­å¿ƒå‘å¤–å±‚å±‚æ‰©å±•ï¼Œç›´åˆ°æ‰©å±•åˆ°ç»ˆç‚¹ä¸ºæ­¢ã€‚ç®—æ³•ä¸»è¦çš„æ€æƒ³æ˜¯è´ªå¿ƒæ³•ã€‚\né€‚ç”¨èŒƒå›´\n 1ã€ä¸èƒ½å¤„ç†è´Ÿæƒè¾¹æˆ–ç¯ 2ã€å¯ä»¥å¤„ç†æ­£æƒè¾¹ 3ã€å¯ä»¥å¤„ç†æ— å‘å›¾å’Œæœ‰å‘å›¾  ä½¿ç”¨æ­¥éª¤\n åˆå§‹åŒ–é‚»æ¥çŸ©é˜µ åˆå§‹åŒ–è¿˜æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹åˆ—è¡¨ åŒé‡å¾ªç¯ï¼š\næœ€å¤–å±‚ä¸ºé™¤æºç‚¹ä¹‹å¤–çš„å…¶ä»–èŠ‚ç‚¹çš„éå†\né‡Œé¢ä¸ºéå†å’Œæ›´æ–°æœªç¡®å®šè·ç¦»çš„èŠ‚ç‚¹åˆ—è¡¨çš„éå†\n3.1ã€ä»è¿˜æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹åˆ—è¡¨ä¸­æ‰¾å‡ºè·ç¦»æºç‚¹æœ€è¿‘çš„èŠ‚ç‚¹\n3.2ã€æ›´æ–°è¿˜æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹åˆ—è¡¨\n3.3ã€æ ¹æ®æ‰¾åˆ°çš„è¿™ä¸ªæœ€çŸ­è·¯å¾„èŠ‚ç‚¹ï¼Œæ›´æ–°æ¯ä¸€ä¸ªè¿˜æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹åˆ°æºç‚¹çš„è·ç¦» æ ¹æ®é¢˜ç›®è¦æ±‚è®¡ç®—ç»“æœ  Floydç®—æ³• Floydç®—æ³•æ˜¯ä¸€ä¸ªç»å…¸çš„åŠ¨æ€è§„åˆ’ç®—æ³•ã€‚æ˜¯è§£å†³ä»»æ„ä¸¤ç‚¹é—´çš„æœ€çŸ­è·¯å¾„(ç§°ä¸ºå¤šæºæœ€çŸ­è·¯å¾„é—®é¢˜)çš„ä¸€ç§ç®—æ³•ï¼Œå¯ä»¥æ­£ç¡®å¤„ç†æœ‰å‘å›¾æˆ–è´Ÿæƒçš„æœ€çŸ­è·¯å¾„é—®é¢˜ã€‚\nå…¶æ ¸å¿ƒæ€æƒ³å°±æ˜¯ä»ä»»æ„èŠ‚ç‚¹uåˆ°ä»»æ„èŠ‚ç‚¹vçš„æœ€çŸ­è·¯å¾„æœ‰2ç§ï¼š\n æ˜¯ç›´æ¥ä»uåˆ°v æ˜¯ä»uç»è¿‡è‹¥å¹²ä¸ªèŠ‚ç‚¹kåˆ°v  æ‰€ä»¥ï¼Œæˆ‘ä»¬å‡è®¾graph(u,v)ä¸ºèŠ‚ç‚¹uåˆ°èŠ‚ç‚¹vçš„æœ€çŸ­è·¯å¾„çš„è·ç¦»(å½“ç„¶ï¼Œä¸åŒçš„é¢˜ç›®ä»£è¡¨çš„ä¸ä¸€æ ·ï¼Œæ¯”å¦‚æœ‰çš„å¯èƒ½æ˜¯èŠ±è´¹ï¼Œéœ€è¦çµæ´»å˜é€š)ï¼Œå¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹k(1~Nä¸ªèŠ‚ç‚¹)ï¼Œæˆ‘ä»¬æ£€æŸ¥graph(u,k) + graph(k,v) \u0026lt; graph(u,v)æ˜¯å¦æˆç«‹ï¼Œå¦‚æœæˆç«‹ï¼Œè¯æ˜ä»uåˆ°kå†åˆ°vçš„è·¯å¾„æ¯”uç›´æ¥åˆ°vçš„è·¯å¾„çŸ­ï¼Œæˆ‘ä»¬ä¾¿è®¾ç½®graph(u,v) = graph(u,k) + graph(k,v)ï¼Œå½“æˆ‘ä»¬éå†å®Œæ‰€æœ‰èŠ‚ç‚¹kï¼Œgraph(u,v)ä¸­è®°å½•çš„ä¾¿æ˜¯uåˆ°vçš„æœ€çŸ­è·¯å¾„çš„è·ç¦»ã€‚\né€‚ç”¨èŒƒå›´\n 1ã€å¯ä»¥å¤„ç†è´Ÿæƒè¾¹ 2ã€ä¸èƒ½å¤„ç†è´Ÿæƒç¯ 3ã€å¯ä»¥å¤„ç†æ— å‘å›¾å’Œæœ‰å‘å›¾  ä½¿ç”¨æ­¥éª¤\n  åˆå§‹åŒ–é‚»æ¥çŸ©é˜µ\n  ä¸‰é‡å¾ªç¯ï¼š\n æœ€å¤–å±‚ä¸ºä¸­é—´èŠ‚ç‚¹kçš„éå†\né‡Œé¢ä¸¤å±‚åˆ†åˆ«ä¸ºèŠ‚ç‚¹uå’ŒèŠ‚ç‚¹vçš„éå†\n 2.1ã€æ ¹æ®kä¸ºä¸­é—´è·³èŠ‚ç‚¹æ›´æ–°(u, v)çš„æœ€çŸ­è·ç¦»\n  æ ¹æ®é¢˜ç›®è¦æ±‚è®¡ç®—ç»“æœ\n  ä»£ç  Dijkstraç®—æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  class Solution { public: int networkDelayTime(vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;\u0026amp; times, int N, int K) { const int INF = 102; vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; graph(N+1,vector\u0026lt;int\u0026gt;(N+1,INF)); for(auto\u0026amp; v:times) graph[v[0]][v[1]] = v[2]; vector\u0026lt;int\u0026gt; dist(N + 1,INF); vector\u0026lt;bool\u0026gt; st(N + 1,false); // è®¾ç½®èµ·å§‹ç‚¹  dist[K] = 0; for(int i = 1;i \u0026lt; N;++i) // å¤–å±‚å¾ªç¯N-1æ¬¡  { int t = -1; int tmin = INF; for(int j = 1;j \u0026lt;= N;++j) { // ä»è¿˜æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹åˆ—è¡¨ä¸­æ‰¾å‡ºè·ç¦»æºç‚¹æœ€è¿‘çš„èŠ‚ç‚¹  if(!st[j] \u0026amp;\u0026amp; (dist[j] \u0026lt; tmin)) { t = j; tmin = dist[j]; } } st[t] = true; // æ ‡è®°ç¡®å®šæœ€çŸ­è·¯å¾„  // ç”¨tæ›´æ–°å…¶ä»–ç‚¹çš„è·ç¦»  for(int j = 1;j \u0026lt;= N;++j) dist[j] = min(dist[j],dist[t] + graph[t][j]); } int r = *max_element(dist.begin() + 1,dist.end()); return r == INF ? -1:r; } };   Floydç®—æ³•(ååˆ†æš´åŠ›)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  int Floyd(vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;\u0026amp; times, int N, int K) { const int INF = 102; vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; dist(N+1,vector\u0026lt;int\u0026gt;(N+1,INF)); for(int i = 1;i \u0026lt;= N;++i) dist[i][i] = 0; for(auto\u0026amp; v:times) dist[v[0]][v[1]] = min(dist[v[0]][v[1]],v[2]); for(int k = 1;k \u0026lt;= N;++k) for(int i = 1;i \u0026lt;= N;++i) for(int j = 1;j \u0026lt;= N;++j) if(i != j) dist[i][j] = min(dist[i][j],dist[i][k]+dist[k][j]); int r = 0; for(int i = 1;i \u0026lt;= N;++i) r = max(r,dist[K][i]); return r == INF?-1:r; }   å †ä¼˜åŒ–ç‰ˆçš„Dijkstraç®—æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  class Solution { public: int networkDelayTime(vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt;\u0026amp; times, int N, int K) { const int INF = 0x3f3f3f3f; typedef pair\u0026lt;int, int\u0026gt; PII; // first:è·ç¦»; second: å‡ å·ç‚¹  vector\u0026lt;bool\u0026gt; st(N+1, false); // æ˜¯å¦å·²å¾—åˆ°æœ€çŸ­è·ç¦»  vector\u0026lt;int\u0026gt; dist(N+1, INF); // è·ç¦»èµ·å§‹ç‚¹çš„æœ€çŸ­è·ç¦»  unordered_map\u0026lt;int, vector\u0026lt;PII\u0026gt;\u0026gt; graph; // é‚»æ¥è¡¨ï¼›u-\u0026gt;v,æƒé‡w  priority_queue\u0026lt;PII, vector\u0026lt;PII\u0026gt;, greater\u0026lt;PII\u0026gt;\u0026gt; heap; // å°é¡¶å †ï¼›ç»´æŠ¤åˆ°èµ·å§‹ç‚¹çš„æœ€çŸ­è·ç¦»å’Œç‚¹  for (auto \u0026amp;t: times){ // åˆå§‹åŒ–é‚»æ¥è¡¨  graph[t[0]].push_back({t[2],t[1]}); } heap.push({0, K}); dist[K] = 0; while(heap.size()){ auto t = heap.top(); heap.pop(); int ver = t.second, distance = t.first; if (st[ver]) continue; // ä¹‹å‰æ›´æ–°è¿‡ï¼Œæ˜¯å†—ä½™å¤‡ä»½  st[ver] = true; for (auto \u0026amp;p: graph[ver]){ if (dist[p.second] \u0026gt; distance + p.first){ // ç”¨tå»æ›´æ–°å…¶ä»–ç‚¹åˆ°èµ·å§‹ç‚¹çš„æœ€çŸ­è·ç¦»  dist[p.second] = distance + p.first; heap.push({dist[p.second], p.second}); } } } int ans = *max_element(dist.begin()+1, dist.end()); return ans == INF ? -1: ans; } };   å‚è€ƒé“¾æ¥ï¼š\n å­¦å›¾è®ºï¼Œä½ çœŸçš„äº†è§£æœ€çŸ­è·¯å—ï¼Ÿ https://leetcode-cn.com/problems/network-delay-time/solution/csetban-dui-you-hua-dijkstra-by-ray-152/  109. æœ‰åºé“¾è¡¨è½¬æ¢äºŒå‰æœç´¢æ ‘ ç»™å®šä¸€ä¸ªå•é“¾è¡¨ï¼Œå…¶ä¸­çš„å…ƒç´ æŒ‰å‡åºæ’åºï¼Œå°†å…¶è½¬æ¢ä¸ºé«˜åº¦å¹³è¡¡çš„äºŒå‰æœç´¢æ ‘ã€‚\næœ¬é¢˜ä¸­ï¼Œä¸€ä¸ªé«˜åº¦å¹³è¡¡äºŒå‰æ ‘æ˜¯æŒ‡ä¸€ä¸ªäºŒå‰æ ‘æ¯ä¸ªèŠ‚ç‚¹ çš„å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡ 1ã€‚\nç¤ºä¾‹:\nç»™å®šçš„æœ‰åºé“¾è¡¨ï¼š [-10, -3, 0, 5, 9], ä¸€ä¸ªå¯èƒ½çš„ç­”æ¡ˆæ˜¯ï¼š[0, -3, 9, -10, null, 5], å®ƒå¯ä»¥è¡¨ç¤ºä¸‹é¢è¿™ä¸ªé«˜åº¦å¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼š 0 / \\ -3 9 / / -10 5 åˆ†æ æ„å»ºä¸€ä¸ªå¹³è¡¡äºŒå‰æ ‘çš„å…³é”®å°±æ˜¯å·¦å³å­æ ‘çš„é«˜åº¦å·®ä¸è¶…è¿‡1ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ¯æ¬¡å–é“¾è¡¨ä¸­é—´çš„èŠ‚ç‚¹ä½œä¸ºå½“å‰å­æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œç„¶åé€’å½’é“¾è¡¨å·¦è¾¹çš„å­é“¾è¡¨å’Œå³è¾¹çš„å­é“¾è¡¨è¿›è¡Œé€’å½’æ±‚è§£ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  class Solution { public: TreeNode* sortedListToBST(ListNode* head) { if(head == nullptr) return nullptr; // ç©ºé“¾è¡¨æƒ…å†µ  if(head-\u0026gt;next == nullptr) // é“¾è¡¨é•¿åº¦ä¸º1  { TreeNode *tt = new TreeNode(head-\u0026gt;val); return tt; } ListNode *slow = head; ListNode * fast = head; ListNode *slow_pre = nullptr; // ä¸‹é¢å¿«æ…¢æŒ‡é’ˆæ‰¾åˆ°é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹  while(fast-\u0026gt;next \u0026amp;\u0026amp; fast-\u0026gt;next-\u0026gt;next) { slow_pre = slow; slow = slow-\u0026gt;next; fast = fast-\u0026gt;next-\u0026gt;next; } TreeNode *t; // åˆ¤æ–­å¹¶ä¸”é€’å½’æ±‚è§£  if(slow_pre == nullptr) { t = new TreeNode(slow-\u0026gt;next-\u0026gt;val); slow-\u0026gt;next = nullptr; t-\u0026gt;left = sortedListToBST(head); t-\u0026gt;right = nullptr; } else { t = new TreeNode(slow-\u0026gt;val); slow_pre-\u0026gt;next = nullptr; t-\u0026gt;left = sortedListToBST(head); t-\u0026gt;right = sortedListToBST(slow-\u0026gt;next); } return t; } };   647. å›æ–‡å­ä¸² ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½ çš„ä»»åŠ¡æ˜¯è®¡ç®—è¿™ä¸ªå­—ç¬¦ä¸²ä¸­æœ‰å¤šå°‘ä¸ªå›æ–‡å­ä¸²ã€‚\nå…·æœ‰ä¸åŒå¼€å§‹ä½ç½®æˆ–ç»“æŸä½ç½®çš„å­ä¸²ï¼Œå³ä½¿æ˜¯ç”±ç›¸åŒçš„å­—ç¬¦ç»„æˆï¼Œä¹Ÿä¼šè¢«è§†ä½œä¸åŒçš„å­ä¸²ã€‚\nç¤ºä¾‹ 1ï¼š\nè¾“å…¥ï¼š\u0026quot;abc\u0026quot; è¾“å‡ºï¼š3 è§£é‡Šï¼šä¸‰ä¸ªå›æ–‡å­ä¸²: \u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;, \u0026quot;c\u0026quot; ç¤ºä¾‹ 2ï¼š\nè¾“å…¥ï¼š\u0026quot;aaa\u0026quot; è¾“å‡ºï¼š6 è§£é‡Šï¼š6ä¸ªå›æ–‡å­ä¸²: \u0026quot;a\u0026quot;, \u0026quot;a\u0026quot;, \u0026quot;a\u0026quot;, \u0026quot;aa\u0026quot;, \u0026quot;aa\u0026quot;, \u0026quot;aaa\u0026quot; æç¤ºï¼š\n è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ä¸ä¼šè¶…è¿‡ 1000 ã€‚  åˆ†æ ä¸­å¿ƒæ‹“å±•æ³•ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  class Solution { public: int countSubstrings(string s) { int r = 0; int len = s.length(); // å¥‡æ•°ç±»å‹  for(int i = 0;i \u0026lt; len;++i) { ++r; int left = i - 1; int right = i + 1; while(left \u0026gt;= 0 \u0026amp;\u0026amp; right \u0026lt; len \u0026amp;\u0026amp; s[left] == s[right]) { ++r; --left; ++right; } left = i; right = i + 1; // å¶æ•°ç±»å‹  while(left \u0026gt;= 0 \u0026amp;\u0026amp; right \u0026lt; len \u0026amp;\u0026amp; s[left] == s[right]) { ++r; --left; ++right; } } return r; } };   28. å®ç° strStr() å®ç° strStr() å‡½æ•°ã€‚\nç»™å®šä¸€ä¸ª haystack å­—ç¬¦ä¸²å’Œä¸€ä¸ª needle å­—ç¬¦ä¸²ï¼Œåœ¨ haystack å­—ç¬¦ä¸²ä¸­æ‰¾å‡º needle å­—ç¬¦ä¸²å‡ºç°çš„ç¬¬ä¸€ä¸ªä½ç½® (ä»0å¼€å§‹)ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å› -1ã€‚\nç¤ºä¾‹ 1:\nè¾“å…¥: haystack = \u0026quot;hello\u0026quot;, needle = \u0026quot;ll\u0026quot; è¾“å‡º: 2 ç¤ºä¾‹ 2:\nè¾“å…¥: haystack = \u0026quot;aaaaa\u0026quot;, needle = \u0026quot;bba\u0026quot; è¾“å‡º: -1 è¯´æ˜:\nå½“ needle æ˜¯ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œæˆ‘ä»¬åº”å½“è¿”å›ä»€ä¹ˆå€¼å‘¢ï¼Ÿè¿™æ˜¯ä¸€ä¸ªåœ¨é¢è¯•ä¸­å¾ˆå¥½çš„é—®é¢˜ã€‚\nå¯¹äºæœ¬é¢˜è€Œè¨€ï¼Œå½“ needle æ˜¯ç©ºå­—ç¬¦ä¸²æ—¶æˆ‘ä»¬åº”å½“è¿”å› 0 ã€‚è¿™ä¸Cè¯­è¨€çš„ strstr() ä»¥åŠ Javaçš„ indexOf() å®šä¹‰ç›¸ç¬¦ã€‚\nåˆ†æ ä½¿ç”¨KMPç®—æ³•ã€‚\nKMPç®—æ³•\nKMP æ˜¯ä¸€ç§æ¨¡å¼åŒ¹é…ç®—æ³•ï¼Œè¦è§£å†³çš„é—®é¢˜å¯ä»¥å½¢å¼åŒ–ä¸ºï¼šç»™å®šæ¨¡å¼ä¸² T ä¸ç›®æ ‡ä¸² Sï¼Œæˆ‘ä»¬è¦åœ¨ç›®æ ‡ä¸² S ä¸­å¯»æ‰¾ T çš„æ‰€æœ‰å‡ºç°ã€‚\nä½¿ç”¨KMPç®—æ³•æœ€å…³é”®çš„ä¸€æ­¥æ˜¯æ„å»ºnextæ•°ç»„ã€‚next[i]å‚¨å­˜çš„æ˜¯stringä¸­å‰i+1ä½å­—ç¬¦ä¸²å‰ç¼€å’Œåç¼€çš„æœ€é•¿é•¿åº¦ã€‚å¦‚abadefgï¼Œnext[2]å­˜çš„æ˜¯abaè¿™ä¸ªå­—ç¬¦ä¸²å‰ç¼€å’Œåç¼€çš„æœ€é•¿é•¿åº¦ã€‚ä½†æ˜¯è¿™é‡Œä¸ºäº†å’Œä»£ç ç›¸å¯¹åº”ï¼Œå°†nextæ•°ç»„çš„å¤§å°è®¾ç½®ä¸ºå­—ç¬¦ä¸²çš„é•¿åº¦åŠ 1ã€‚\nå‡å¦‚æˆ‘ä»¬ç°åœ¨æ±‚å­—ç¬¦ä¸²\u0026quot;abababac\u0026quot;çš„nextæ•°ç»„:\nåœ¨ä¸‹æ ‡ä¸º0çš„æ—¶å€™è®¾ç½®next[0] = -1;å¹¶ä¸”i = 0ï¼Œj = -1\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1            ä¸€ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²çš„æœ€é•¿ç›¸åŒå‰ç¼€å’Œåç¼€çš„é•¿åº¦ä¸º0ï¼Œæ­¤æ—¶i = 1,j = 0\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0           æ¥ä¸‹æ¥str[j] != str[i]ï¼Œjçš„å€¼åˆå˜ä¸ºnext[j] = next[0] = -1ï¼›ç„¶åç»§ç»­æ‰§è¡Œå¾—åˆ°next[++i] = ++jï¼Œå³next[2] = 0,æ­¤æ—¶i = 2,j = 0;\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0          æ¥ä¸‹æ¥str[j] == str[i] ,next[++i] = ++jï¼Œå³next[30] = 1ï¼Œæ­¤æ—¶i = 3,j = 1\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1         æ¥ä¸‹æ¥str[i] == str[j]ï¼Œåˆ™next[++i] = ++jï¼Œå³next[4] = 2ï¼Œæ­¤æ—¶i = 4,j = 2\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1 2        æ¥ä¸‹æ¥str[i] == str[j]ï¼Œåˆ™next[++i] = ++jï¼Œå³next[5] = 3ï¼Œæ­¤æ—¶i = 5,j = 3\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1 2 3       æ¥ä¸‹æ¥str[i] == str[j]ï¼Œåˆ™next[++i] = ++jï¼Œå³next[6] = 4ï¼Œæ­¤æ—¶i = 6,j = 4\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1 2 3 4      æ¥ä¸‹æ¥str[i] == str[j]ï¼Œåˆ™next[++i] = ++jï¼Œå³next[7] = 5ï¼Œæ­¤æ—¶i = 7,j = 5\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1 2 3 4 5     æ¥ä¸‹æ¥str[i] != str[j]ï¼Œj = next[j] = next[5] = 3;i = 7;æ­¤æ—¶str[3] != str[7],j = next[j] = next[3] = 1;æ­¤æ—¶str[1] != str[7],j = next[j] = next[1] = 0;æ­¤æ—¶str[0] != str[7],j = next[j] = next[0] = -1;æ¥ä¸‹æ¥next[++i] = next[8] = ++j = 0\n   index 0 1 2 3 4 5 6 7 8     str NULL a b a b a b a c   next -1 0 0 1 2 3 4 5 0    åŒ¹é…å­—ç¬¦ä¸²çš„æ€è·¯ä¸æ„å»ºnextæ•°ç»„çš„æ€è·¯ç±»ä¼¼ã€‚\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  class Solution { public: int strStr(string haystack, string needle) { if(needle == \u0026#34;\u0026#34;) return 0; int n = haystack.length(); // æ„å»ºnextæ•°ç»„  int m = needle.length(); vector\u0026lt;int\u0026gt; next(m + 1,0); for(int i = 0,j = next[0] = -1;i \u0026lt; m;next[++i] = ++j) while(~j \u0026amp;\u0026amp; needle[j] != needle[i]) j = next[j]; // æœç´¢  for(int i = 0,j = 0;i \u0026lt; n;++i) { while(j \u0026gt; 0 \u0026amp;\u0026amp; haystack[i] != needle[j]) j = next[j]; if(haystack[i] == needle[j]) ++j; if(j == m) return (i - m + 1); } return -1; } };   å‚è€ƒé“¾æ¥ï¼š\n ã€ç®—æ³•ABCã€‘KMP ç®—æ³• åŠ¨æ€è§„åˆ’ä¹‹KMPå­—ç¬¦åŒ¹é…ç®—æ³• ä»å¤´åˆ°å°¾å½»åº•ç†è§£KMP  459. é‡å¤çš„å­å­—ç¬¦ä¸² ç»™å®šä¸€ä¸ªéç©ºçš„å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦å¯ä»¥ç”±å®ƒçš„ä¸€ä¸ªå­ä¸²é‡å¤å¤šæ¬¡æ„æˆã€‚ç»™å®šçš„å­—ç¬¦ä¸²åªå«æœ‰å°å†™è‹±æ–‡å­—æ¯ï¼Œå¹¶ä¸”é•¿åº¦ä¸è¶…è¿‡10000ã€‚\nç¤ºä¾‹ 1:\nè¾“å…¥: \u0026quot;abab\u0026quot; è¾“å‡º: True è§£é‡Š: å¯ç”±å­å­—ç¬¦ä¸² \u0026quot;ab\u0026quot; é‡å¤ä¸¤æ¬¡æ„æˆã€‚ ç¤ºä¾‹ 2:\nè¾“å…¥: \u0026quot;aba\u0026quot; è¾“å‡º: False ç¤ºä¾‹ 3:\nè¾“å…¥: \u0026quot;abcabcabcabc\u0026quot; è¾“å‡º: True è§£é‡Š: å¯ç”±å­å­—ç¬¦ä¸² \u0026quot;abc\u0026quot; é‡å¤å››æ¬¡æ„æˆã€‚ (æˆ–è€…å­å­—ç¬¦ä¸² \u0026quot;abcabc\u0026quot; é‡å¤ä¸¤æ¬¡æ„æˆã€‚) åˆ†æ å‡å¦‚æœ‰é‡å¤ï¼Œé‚£ä¹ˆè‡³å°‘é‡å¤ä¸¤ä¸ªç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œå‡å¦‚Aæ˜¯ç›¸åŒçš„å­—ç¬¦ä¸²ï¼ŒAAæ˜¯ä¸€ä¸ªæœ€å°é‡å¤çš„å­—ç¬¦ä¸²ï¼Œå³s = AAï¼Œå½“æˆ‘ä»¬æ‰§è¡Œs + sçš„æ—¶å€™ï¼Œå¾—åˆ°AAAAï¼Œæˆ‘ä»¬åœ¨ä¸­é—´ä¹Ÿå¯ä»¥æ‰¾åˆ°ä¸åŸæ¥å­—ç¬¦ä¸²ç›¸ç­‰çš„å­ä¸²AAï¼Œé‚£ä¹ˆä¹Ÿå°±è¯æ˜äº†sä¸­å­˜åœ¨é‡å¤çš„å­ä¸²ï¼Œå…¶ä¸­å­ä¸²åŒ¹é…çš„æ–¹æ³•å¯ä»¥ä½¿ç”¨KMPç®—æ³•ã€‚å‚è€ƒ\nä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  class Solution { public: bool repeatedSubstringPattern(string s) { string str = s.substr(1) + s.substr(0,s.length()-1); string pattern = s; int n = str.length(); int m = pattern.length(); vector\u0026lt;int\u0026gt; next(m+1); for(int i = 0,j = next[0] = -1;i \u0026lt; m;next[++i] = ++j) { while(~j \u0026amp;\u0026amp; pattern[i] != pattern[j]) j = next[j]; } for(int i = 0,j = 0;i \u0026lt; n;++i) { while(j \u0026gt; 0 \u0026amp;\u0026amp; str[i] != pattern[j]) j = next[j]; if(str[i] == pattern[j]) ++j; if(j == m) return true; } return false; } };   ","description":"","id":9,"section":"talks","tags":[""],"title":"Leetcode Problem Solve","uri":"https://hugo.jiahongw.com/zh/talks/leetcode/"},{"content":"å“ˆå¸Œè¡¨ ä»€ä¹ˆæ˜¯å“ˆå¸Œè¡¨ï¼Ÿ\nå“ˆå¸Œè¡¨ï¼ˆHash tableï¼Œä¹Ÿå«æ•£åˆ—è¡¨ï¼‰ï¼Œæ˜¯æ ¹æ®å…³é”®ç å€¼(Key value)è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡æŠŠå…³é”®ç å€¼æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®¿é—®è®°å½•ï¼Œä»¥åŠ å¿«æŸ¥æ‰¾çš„é€Ÿåº¦ã€‚è¿™ä¸ªæ˜ å°„å‡½æ•°å«åšæ•£åˆ—å‡½æ•°ï¼Œå­˜æ”¾è®°å½•çš„æ•°ç»„å«åšæ•£åˆ—è¡¨ã€‚\n å“ˆå¸Œè¡¨hashtable(keyï¼Œvalue) å°±æ˜¯æŠŠKeyé€šè¿‡ä¸€ä¸ªå›ºå®šçš„ç®—æ³•å‡½æ•°æ—¢æ‰€è°“çš„å“ˆå¸Œå‡½æ•°è½¬æ¢æˆä¸€ä¸ªæ•´å‹æ•°å­—ï¼Œç„¶åå°±å°†è¯¥æ•°å­—å¯¹æ•°ç»„é•¿åº¦è¿›è¡Œå–ä½™ï¼Œå–ä½™ç»“æœå°±å½“ä½œæ•°ç»„çš„ä¸‹æ ‡ï¼Œå°†valueå­˜å‚¨åœ¨ä»¥è¯¥æ•°å­—ä¸ºä¸‹æ ‡çš„æ•°ç»„ç©ºé—´é‡Œã€‚ï¼ˆæˆ–è€…ï¼šæŠŠä»»æ„é•¿åº¦çš„è¾“å…¥ï¼ˆåˆå«åšé¢„æ˜ å°„ï¼Œ pre-imageï¼‰ï¼Œé€šè¿‡æ•£åˆ—ç®—æ³•ï¼Œå˜æ¢æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ã€‚è¿™ç§è½¬æ¢æ˜¯ä¸€ç§å‹ç¼©æ˜ å°„ï¼Œä¹Ÿå°±æ˜¯ï¼Œæ•£åˆ—å€¼çš„ç©ºé—´é€šå¸¸è¿œå°äºè¾“å…¥çš„ç©ºé—´ï¼Œä¸åŒçš„è¾“å…¥å¯èƒ½ä¼šæ•£åˆ—æˆç›¸åŒçš„è¾“å‡ºï¼Œè€Œä¸å¯èƒ½ä»æ•£åˆ—å€¼æ¥å”¯ä¸€çš„ç¡®å®šè¾“å…¥å€¼ã€‚ç®€å•çš„è¯´å°±æ˜¯ä¸€ç§å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯å‹ç¼©åˆ°æŸä¸€å›ºå®šé•¿åº¦çš„æ¶ˆæ¯æ‘˜è¦çš„å‡½æ•°ã€‚ï¼‰\n å…¶ä¸­ï¼Œè®°å½•çš„ä½ç½® = H(å…³é”®å­—)ï¼ŒHç§°ä¸ºå“ˆå¸Œå‡½æ•°ã€‚\nå“ˆå¸Œæ„é€ æ–¹æ³•   ç›´æ¥å®šå€æ³•\nä¾‹å¦‚å¦‚æœæˆ‘ä»¬ç°åœ¨è¦å¯¹0-100å²çš„äººå£æ•°å­—ç»Ÿè®¡è¡¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹å¹´é¾„è¿™ä¸ªå…³é”®å­—å°±å¯ä»¥ç›´æ¥ç”¨å¹´é¾„çš„æ•°å­—ä½œä¸ºåœ°å€ã€‚æ­¤æ—¶f(key) = keyã€‚\n è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºè¿™ä¹ˆä¸ªå“ˆå¸Œå‡½æ•°ï¼šf(0) = 0ï¼Œf(1) = 1ï¼Œâ€¦â€¦ï¼Œf(20) = 20ã€‚è¿™ä¸ªæ˜¯æ ¹æ®æˆ‘ä»¬è‡ªå·±è®¾å®šçš„ç›´æ¥å®šå€æ¥çš„ã€‚äººæ•°æˆ‘ä»¬å¯ä»¥ä¸ç®¡ï¼Œæˆ‘ä»¬å…³å¿ƒçš„æ˜¯å¦‚ä½•é€šè¿‡å…³é”®å­—æ‰¾åˆ°åœ°å€ã€‚\n   é™¤ç•™ä½™æ•°æ³•\né™¤ç•™ä½™æ•°æ³•æ­¤æ–¹æ³•ä¸ºæœ€å¸¸ç”¨çš„æ„é€ æ•£åˆ—å‡½æ•°æ–¹æ³•ã€‚å¯¹äºæ•£åˆ—è¡¨é•¿ä¸ºmçš„æ•£åˆ—å‡½æ•°å…¬å¼ä¸ºï¼š\n$$\nf( key ) = key \\mod p ( p â‰¤ m )\n$$\n modæ˜¯å–æ¨¡ï¼ˆæ±‚ä½™æ•°ï¼‰çš„æ„æ€ã€‚äº‹å®ä¸Šï¼Œè¿™æ–¹æ³•ä¸ä»…å¯ä»¥å¯¹å…³é”®å­—ç›´æ¥å–æ¨¡ï¼Œä¹Ÿå¯åœ¨æŠ˜å ã€å¹³æ–¹å–ä¸­åå†å–æ¨¡ã€‚\n   æ•°å­—åˆ†ææ³•\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæœ‰80ä¸ªè®°å½•ï¼Œæ¯ä¸€è¡Œä¸ºä¸€ä¸ªè®°å½•ä¸­çš„é”®ï¼Œå‡è®¾è¡¨é•¿ä¸º100ï¼Œåˆ™å¯å–ä¸¤ä½åè¿›åˆ¶æ•°ç»„æˆå“ˆå¸Œåœ°å€ã€‚\n  æŠ˜å æ³•\nå°†å…³é”®å­—åˆ†æˆä½æ•°ç›¸åŒçš„å‡ éƒ¨åˆ†ï¼ˆæœ€åä¸€ä½å¯ä»¥ä¸åŒï¼‰ï¼Œç„¶åå–å åŠ å’Œä½œä¸ºå“ˆå¸Œåœ°å€ï¼Œè¿™ä¸€æ–¹æ³•è¢«ç§°ä¸ºæŠ˜å æ³•ã€‚å½“è¡¨çš„é”®ä½æ•°å¾ˆå¤šï¼Œè€Œä¸”æ¯ä¸€ä½ä¸Šæ•°å­—åˆ†å¸ƒæ¯”è¾ƒå‡åŒ€çš„æ—¶å€™ï¼Œ å¯ä»¥è€ƒè™‘é‡‡ç”¨è¿™ä¸€æ–¹æ³•ã€‚ æŠ˜å æ³•æœ‰ç§»ä½å åŠ å’Œé—´ä½å åŠ ä¸¤ç§æ–¹æ³•ä¾‹å¦‚å›½é™…æ ‡å‡†å›¾ä¹¦ç¼–å·0-442-20586-4çš„å“ˆå¸Œåœ°å€å¯ä»¥ç”¨è¿™ä¸¤ç§æ–¹æ³•è¡¨ç¤ºä¸º\n  å¹³æ–¹å–ä¸­æ³•\nå–å…³é”®å­—å¹³æ–¹åçš„ä¸­é—´å‡ ä½ä¸ºå“ˆå¸Œåœ°å€ï¼Œè¿™ç§æ–¹æ³•å«åšå¹³æ–¹å–ä¸­æ³•ã€‚å®ƒå¼¥è¡¥äº†æ•°å­—åˆ†ææ³•çš„ä¸€äº›ç¼ºé™·ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰æ—¶å¹¶ä¸èƒ½çŸ¥é“é”®çš„å…¨éƒ¨æƒ…å†µï¼Œå–å…¶ä¸­å‡ ä½ä¹Ÿä¸ä¸€å®šåˆé€‚ï¼Œè€Œä¸€ä¸ªæ•°å¹³æ–¹åçš„ä¸­é—´å‡ ä¸ªæ•°å’ŒåŸæ•°çš„æ¯ä¸€ä½éƒ½ç›¸å…³ï¼Œç”±æ­¤æˆ‘ä»¬å°±èƒ½å¾—åˆ°éšæœºæ€§æ›´å¼ºçš„å“ˆå¸Œåœ°å€å–çš„ä½æ•°ç”±è¡¨é•¿å†³å®šã€‚\n  å“ˆå¸Œè¡¨å¤„ç†å†²çªçš„æ–¹æ³•   é“¾åœ°å€æ³•\nå†²çªçš„å…³é”®å­—å­˜å‚¨åœ¨ä¸€ä¸ªé“¾è¡¨ä¸­ï¼ŒæŸ¥æ‰¾çš„æ—¶å€™å¯èƒ½éœ€è¦éå†é“¾è¡¨ã€‚ä¾‹å¦‚ä¸‹é¢ï¼š\n  å¼€æ”¾åœ°å€æ³•\nå¼€æ”¾å®šå€æ³•æ˜¯æŒ‡å¯å­˜æ”¾æ–°è¡¨é¡¹çš„ç©ºé—²åœ°å€ï¼Œæ—¢å‘å®ƒçš„åŒä¹‰è¯è¡¨é¡¹å¼€æ”¾ï¼Œåˆå‘å®ƒçš„éåŒä¹‰è¯è¡¨é¡¹å¼€æ”¾ã€‚\nä¸€èˆ¬æœ‰ä¸€ä¸ªé€’æ¨å…¬å¼:l\n$$H_i = (H(key) + d_i) % m$$\nå¼ä¸­ï¼Œi = 1ï¼Œ2ï¼Œâ€¦ï¼Œkï¼Œmä¸ºæ•£åˆ—è¡¨è¡¨é•¿ï¼Œ$d_i$ä¸ºå¢é‡åºåˆ—ã€‚$d_i$é€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§å–æ³•ï¼š\n å½“$d_i = 1ï¼Œ2ï¼Œâ€¦ï¼Œm - 1$æ—¶ï¼Œç§°ä¸º**çº¿æ€§æ¢æµ‹æ³•ã€‚**å…¶ç‰¹ç‚¹æ˜¯ï¼Œå†²çªå‘ç”Ÿæ—¶é¡ºåºæŸ¥çœ‹è¡¨ä¸­ä¸‹ä¸€ä¸ªå•å…ƒï¼Œç›´åˆ°æ‰¾å‡ºä¸€ä¸ªç©ºå•å…ƒæˆ–æŸ¥éå…¨è¡¨ã€‚ å½“$d_i = 1^2ï¼Œ-1^2ï¼Œ2^2ï¼Œ-2^2ï¼Œâ€¦ï¼Œk^2ï¼Œ-k2$æ—¶ï¼Œåˆç§°ä¸ºäºŒæ¬¡æ¢æµ‹æ³•ã€‚ å½“$d_i$ = ä¼ªéšæœºæ•°åºåˆ—æ—¶ï¼Œç§°ä¸ºä¼ªéšæœºæ¢æµ‹æ³•ã€‚    å†æ•£åˆ—æ³•\nå½“å‘ç”Ÿå†²çªæ—¶ï¼Œå†åˆ©ç”¨ä¸€ä¸ªæ–°çš„å“ˆå¸Œå‡½æ•°è®¡ç®—å¾—åˆ°ä¸€ä¸ªæ–°çš„åœ°å€ï¼Œç›´åˆ°ä¸å‘ç”Ÿå†²çªæ—¶è¿›è¡Œå­˜æ”¾ã€‚\n  å…¬å…±æº¢å‡ºåŒº\næ‰€æœ‰å‘ç”Ÿå†²çªçš„å…³é”®å­—éƒ½å­˜å‚¨åœ¨è¿™ä¸ªå…¬å…±æº¢å‡ºåŒºï¼Œå½“æŸ¥æ‰¾ä¸åˆ°çš„æ—¶å€™æ¥è¿™é‡ŒæŸ¥æ‰¾ã€‚\n  å“ˆå¸Œè¡¨çš„ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ï¼šä¸è®ºå“ˆå¸Œè¡¨ä¸­æœ‰å¤šå°‘æ•°æ®ï¼ŒæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤ï¼ˆæœ‰æ—¶åŒ…æ‹¬åˆ é™¤ï¼‰åªéœ€è¦æ¥è¿‘å¸¸é‡çš„æ—¶é—´å³0(1ï¼‰çš„æ—¶é—´çº§ã€‚å®é™…ä¸Šï¼Œè¿™åªéœ€è¦å‡ æ¡æœºå™¨æŒ‡ä»¤ã€‚\nå“ˆå¸Œè¡¨è¿ç®—å¾—éå¸¸å¿«ï¼Œåœ¨è®¡ç®—æœºç¨‹åºä¸­ï¼Œå¦‚æœéœ€è¦åœ¨ä¸€ç§’ç§å†…æŸ¥æ‰¾ä¸Šåƒæ¡è®°å½•é€šå¸¸ä½¿ç”¨å“ˆå¸Œè¡¨ï¼ˆä¾‹å¦‚æ‹¼å†™æ£€æŸ¥å™¨)å“ˆå¸Œè¡¨çš„é€Ÿåº¦æ˜æ˜¾æ¯”æ ‘å¿«ï¼Œæ ‘çš„æ“ä½œé€šå¸¸éœ€è¦O(N)çš„æ—¶é—´çº§ã€‚å“ˆå¸Œè¡¨ä¸ä»…é€Ÿåº¦å¿«ï¼Œç¼–ç¨‹å®ç°ä¹Ÿç›¸å¯¹å®¹æ˜“ã€‚\nå¦‚æœä¸éœ€è¦æœ‰åºéå†æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥æå‰é¢„æµ‹æ•°æ®é‡çš„å¤§å°ã€‚é‚£ä¹ˆå“ˆå¸Œè¡¨åœ¨é€Ÿåº¦å’Œæ˜“ç”¨æ€§æ–¹é¢æ˜¯æ— ä¸ä¼¦æ¯”çš„ã€‚\nç¼ºç‚¹ï¼šå®ƒæ˜¯åŸºäºæ•°ç»„çš„ï¼Œæ•°ç»„åˆ›å»ºåéš¾äºæ‰©å±•ï¼ŒæŸäº›å“ˆå¸Œè¡¨è¢«åŸºæœ¬å¡«æ»¡æ—¶ï¼Œæ€§èƒ½ä¸‹é™å¾—éå¸¸ä¸¥é‡ï¼Œæ‰€ä»¥ç¨‹åºå‘˜å¿…é¡»è¦æ¸…æ¥šè¡¨ä¸­å°†è¦å­˜å‚¨å¤šå°‘æ•°æ®ï¼ˆæˆ–è€…å‡†å¤‡å¥½å®šæœŸåœ°æŠŠæ•°æ®è½¬ç§»åˆ°æ›´å¤§çš„å“ˆå¸Œè¡¨ä¸­ï¼Œè¿™æ˜¯ä¸ªè´¹æ—¶çš„è¿‡ç¨‹ï¼‰ã€‚\næ•°æ®ç»“æ„åŠå›¾ç¤º çº¿æ€§æ¢æµ‹çš„å“ˆå¸Œè¡¨æ•°æ®ç»“æ„å’Œå›¾ç‰‡\n1 2 3 4 5 6 7 8 9 10 11 12  typedef char KeyType; typedef struct { KeyType key; }RcdType; typedef struct { RcdType *rcd; int size; int count; bool *tag; }HashTable;   å“ˆå¸Œè¡¨å®ç°ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177  #include\u0026lt;stdio.h\u0026gt;#include\u0026lt;stdlib.h\u0026gt; #define SUCCESS 1#define UNSUCCESS 0#define OVERFLOW -1#define OK 1#define ERROR -1#define MAXNUM 9999\t// ç”¨äºåˆå§‹åŒ–å“ˆå¸Œè¡¨çš„è®°å½• key  typedef int Status; typedef int KeyType; // å“ˆå¸Œè¡¨ä¸­çš„è®°å½•ç±»å‹ typedef struct { KeyType key; }RcdType; // å“ˆå¸Œè¡¨ç±»å‹ typedef struct { RcdType *rcd; int size; int count; int *tag; }HashTable; // å“ˆå¸Œè¡¨æ¯æ¬¡é‡å»ºå¢é•¿åçš„å¤§å° int hashsize[] = { 11, 31, 61, 127, 251, 503 }; int index = 0; // åˆå§‹å“ˆå¸Œè¡¨ Status InitHashTable(HashTable \u0026amp;H, int size) { int i; H.rcd = (RcdType *)malloc(sizeof(RcdType)*size); H.tag = (int *)malloc(sizeof(int)*size); if (NULL == H.rcd || NULL == H.tag) return OVERFLOW; KeyType maxNum = MAXNUM; for (i = 0; i \u0026lt; size; i++) { H.tag[i] = 0; H.rcd[i].key = maxNum; } H.size = size; H.count = 0; return OK; } // å“ˆå¸Œå‡½æ•°ï¼šé™¤ç•™ä½™æ•°æ³• int Hash(KeyType key, int m) { return (3 * key) % m; } // å¤„ç†å“ˆå¸Œå†²çªï¼šçº¿æ€§æ¢æµ‹ void collision(int \u0026amp;p, int m) { p = (p + 1) % m; } // åœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥è¯¢ Status SearchHash(HashTable H, KeyType key, int \u0026amp;p, int \u0026amp;c) { p = Hash(key, H.size); int h = p; c = 0; while ((1 == H.tag[p] \u0026amp;\u0026amp; H.rcd[p].key != key) || -1 == H.tag[p]) { collision(p, H.size); c++; } if (1 == H.tag[p] \u0026amp;\u0026amp; key == H.rcd[p].key) return SUCCESS; else return UNSUCCESS; } //æ‰“å°å“ˆå¸Œè¡¨ void printHash(HashTable H) { int i; printf(\u0026#34;key : \u0026#34;); for (i = 0; i \u0026lt; H.size; i++) printf(\u0026#34;%3d \u0026#34;, H.rcd[i].key); printf(\u0026#34;\\n\u0026#34;); printf(\u0026#34;tag : \u0026#34;); for (i = 0; i \u0026lt; H.size; i++) printf(\u0026#34;%3d \u0026#34;, H.tag[i]); printf(\u0026#34;\\n\\n\u0026#34;); } // å‡½æ•°å£°æ˜ï¼šæ’å…¥å“ˆå¸Œè¡¨ Status InsertHash(HashTable \u0026amp;H, KeyType key); // é‡å»ºå“ˆå¸Œè¡¨ Status recreateHash(HashTable \u0026amp;H) { RcdType *orcd; int *otag, osize, i; orcd = H.rcd; otag = H.tag; osize = H.size; InitHashTable(H, hashsize[index++]); //æŠŠæ‰€æœ‰å…ƒç´ ï¼ŒæŒ‰ç…§æ–°å“ˆå¸Œå‡½æ•°æ”¾åˆ°æ–°è¡¨ä¸­ \tfor (i = 0; i \u0026lt; osize; i++) { if (1 == otag[i]) { InsertHash(H, orcd[i].key); } } return OK; } // æ’å…¥å“ˆå¸Œè¡¨ Status InsertHash(HashTable \u0026amp;H, KeyType key) { int p, c; if (UNSUCCESS == SearchHash(H, key, p, c)) { //æ²¡æœ‰ç›¸åŒkey \tif (c*1.0 / H.size \u0026lt; 0.5) { //å†²çªæ¬¡æ•°æœªè¾¾åˆ°ä¸Šçº¿ \t//æ’å…¥ä»£ç  \tH.rcd[p].key = key; H.tag[p] = 1; H.count++; return SUCCESS; } else recreateHash(H); //é‡æ„å“ˆå¸Œè¡¨ \t} return UNSUCCESS; } // åˆ é™¤å“ˆå¸Œè¡¨ Status DeleteHash(HashTable \u0026amp;H, KeyType key) { int p, c; if (SUCCESS == SearchHash(H, key, p, c)) { //åˆ é™¤ä»£ç  \tH.tag[p] = -1; H.count--; return SUCCESS; } else return UNSUCCESS; } int main() { printf(\u0026#34;-----å“ˆå¸Œè¡¨-----\\n\u0026#34;); HashTable H; int i; int size = 11; KeyType array[8] = { 22, 41, 53, 46, 30, 13, 12, 67 }; KeyType key; //åˆå§‹åŒ–å“ˆå¸Œè¡¨ \tprintf(\u0026#34;åˆå§‹åŒ–å“ˆå¸Œè¡¨\\n\u0026#34;); if (SUCCESS == InitHashTable(H, hashsize[index++])) printf(\u0026#34;åˆå§‹åŒ–æˆåŠŸ\\n\u0026#34;); //æ’å…¥å“ˆå¸Œè¡¨ \tprintf(\u0026#34;æ’å…¥å“ˆå¸Œè¡¨\\n\u0026#34;); for (i = 0; i \u0026lt;= 7; i++) { key = array[i]; InsertHash(H, key); printHash(H); } //åˆ é™¤å“ˆå¸Œè¡¨ \tprintf(\u0026#34;åˆ é™¤å“ˆå¸Œè¡¨ä¸­keyä¸º12çš„å…ƒç´ \\n\u0026#34;); int p, c; if (SUCCESS == DeleteHash(H, 12)) { printf(\u0026#34;åˆ é™¤æˆåŠŸï¼Œæ­¤æ—¶å“ˆå¸Œè¡¨ä¸ºï¼š\\n\u0026#34;); printHash(H); } //æŸ¥è¯¢å“ˆå¸Œè¡¨ \tprintf(\u0026#34;æŸ¥è¯¢å“ˆå¸Œè¡¨ä¸­keyä¸º67çš„å…ƒç´ \\n\u0026#34;); if (SUCCESS == SearchHash(H, 67, p, c)) printf(\u0026#34;æŸ¥è¯¢æˆåŠŸ\\n\u0026#34;); //å†æ¬¡æ’å…¥ï¼Œæµ‹è¯•å“ˆå¸Œè¡¨çš„é‡å»º \tprintf(\u0026#34;å†æ¬¡æ’å…¥ï¼Œæµ‹è¯•å“ˆå¸Œè¡¨çš„é‡å»ºï¼š\\n\u0026#34;); KeyType array1[8] = { 27, 47, 57, 47, 37, 17, 93, 67 }; for (i = 0; i \u0026lt;= 7; i++) { key = array1[i]; InsertHash(H, key); printHash(H); } getchar(); return 0; }   å‚è€ƒé“¾æ¥ï¼š\n å“ˆå¸Œè¡¨ï¼ˆæ•£åˆ—è¡¨ï¼‰åŸç†è¯¦è§£ ã€ç®—æ³•ã€‘å“ˆå¸Œè¡¨çš„è¯ç”Ÿ  ","description":"å“ˆå¸Œè¡¨ï¼ˆHash tableï¼Œä¹Ÿå«æ•£åˆ—è¡¨ï¼‰ï¼Œæ˜¯æ ¹æ®å…³é”®ç å€¼(Key value)è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚ã€‚","id":10,"section":"posts","tags":["æ•°æ®ç»“æ„","å“ˆå¸Œè¡¨"],"title":"å“ˆå¸Œè¡¨","uri":"https://hugo.jiahongw.com/zh/posts/algorithmstructure/hash/"},{"content":"å…³äºç¨‹åºçš„è£…å…¥   ç»å¯¹è£…å…¥ï¼šç»å¯¹æ˜ å°„ï¼Œç¨‹åºä¸­é€»è¾‘åœ°å€ä¸å†…å­˜ç‰©ç†åœ°å€å®Œå…¨ç›¸åŒ ï¼ˆå•ç‰‡æœº)\n  å¯é‡å®šä½è£…å…¥ï¼šé™æ€æ˜ å°„ï¼Œåœ¨è£…å…¥æ—¶å¯¹é€»è¾‘åœ°å€è¿›è¡Œä¿®æ”¹\n  åŠ¨æ€è¿è¡Œæ—¶è£…å…¥ï¼šé€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰æ‰§è¡Œ (ç°ä»£PCæœº)\n  è€ŒåŠ¨æ€é‡å®šä½å¦‚ä¸‹ï¼š\n é™æ€é‡å®šä½çš„ç‰¹ç‚¹æ˜¯åœ¨ä¸€ä¸ªä½œä¸šè£…å…¥å†…å­˜æ—¶ï¼Œå¿…é¡»åˆ†é…å…¶è¦æ±‚çš„å…¨éƒ¨å†…å­˜ç©ºé—´ï¼Œå¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œå°±ä¸èƒ½è£…å…¥è¯¥ä½œä¸šã€‚æ­¤å¤–ï¼Œä½œä¸šä¸€æ—¦è¿›å…¥å†…å­˜åï¼Œåœ¨æ•´ä¸ªè¿è¡ŒæœŸé—´ä¸èƒ½åœ¨å†…å­˜ä¸­ç§»åŠ¨ï¼Œä¹Ÿä¸èƒ½å†ç”³è¯·å†…å­˜ç©ºé—´ã€‚\n å…³äºç¨‹åºçš„é“¾æ¥   é™æ€é“¾æ¥æ–¹å¼(Static Linking)\nåœ¨ç¨‹åºè¿è¡Œä¹‹å‰ï¼Œå…ˆå°†å„ç›®æ ‡æ¨¡å—åŠå®ƒä»¬æ‰€éœ€çš„åº“å‡½æ•°é“¾æ¥æˆä¸€ä¸ªå®Œæ•´çš„å¯æ‰§è¡Œç¨‹åºï¼Œä»¥åä¸å†æ‹†å¼€ã€‚\n  è£…å…¥æ—¶åŠ¨æ€é“¾æ¥(Load time Dynamic Linking)\nå°†ç”¨æˆ·æºç¨‹åºç¼–è¯‘åæ‰€å¾—åˆ°çš„ä¸€ç»„ç›®æ ‡æ¨¡å—ï¼Œåœ¨è£…å…¥å†…å­˜æ—¶ï¼Œé‡†ç”¨è¾¹è£…å…¥è¾¹é“¾æ¥çš„é“¾æ¥æ–¹å¼ã€‚\n  è¿è¡Œæ—¶åŠ¨æ€é“¾æ¥(Run-time Dynamic Linkingï¼‰\nå¯¹æŸäº›ç›®æ ‡æ¨¡å—çš„é“¾æ¥ï¼Œæ˜¯åœ¨ç¨‹åºæ‰§è¡Œä¸­éœ€è¦è¯¥ç›®æ ‡æ¨¡å—æ—¶ï¼Œæ‰å¯¹å®ƒè¿›è¡Œçš„é“¾æ¥ã€‚å…¶ä¼˜ç‚¹æ˜¯ä¾¿äºä¿®æ”¹å’Œæ›´æ–°ï¼Œä¾¿äºå®ç°å¯¹ç›®æ ‡æ¨¡å—çš„å…±äº«ã€‚\n  è¿ç»­åˆ†é…æ–¹å¼ å•ä¸€è¿ç»­åˆ†é… åªèƒ½ç”¨äºå•ç”¨æˆ·ã€å•ä»»åŠ¡çš„æ“ä½œç³»ç»Ÿä¸­ã€‚é‡‡ç”¨è¿™ç§å­˜å‚¨ç®¡ç†æ–¹å¼æ—¶ï¼Œå¯æŠŠå†…å­˜åˆ†ä¸ºç³»ç»ŸåŒºå’Œç”¨æˆ·åŒºä¸¤éƒ¨åˆ†ï¼Œç³»ç»ŸåŒºä»…æä¾›ç»™ OS ä½¿ç”¨ï¼Œé€šå¸¸æ˜¯æ”¾åœ¨å†…å­˜çš„ä½å€éƒ¨åˆ†ï¼›ç”¨æˆ·åŒºæ˜¯æŒ‡é™¤ç³»ç»ŸåŒºä»¥å¤–çš„å…¨éƒ¨å†…å­˜ç©ºé—´ï¼Œæä¾›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚\nå›ºå®šåˆ†åŒºè¿ç»­åˆ†é… å°†å†…å­˜ç”¨æˆ·ç©ºé—´åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªå›ºå®šå¤§å°çš„åŒºåŸŸï¼Œåœ¨æ¯ä¸ªåˆ†åŒºä¸­åªè£…å…¥ä¸€é“ä½œä¸šï¼Œè¿™æ ·ï¼ŒæŠŠç”¨æˆ·ç©ºé—´åˆ’åˆ†ä¸ºå‡ ä¸ªåˆ†åŒºï¼Œä¾¿å…è®¸æœ‰å‡ é“ä½œä¸šå¹¶å‘è¿è¡Œã€‚å½“æœ‰ä¸€ç©ºé—²åˆ†åŒºæ—¶ï¼Œä¾¿å¯ä»¥å†ä»å¤–å­˜çš„åå¤‡ä½œä¸šé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªé€‚å½“å¤§å°çš„ä½œä¸šè£…å…¥è¯¥åˆ†åŒºï¼Œå½“è¯¥ä½œä¸šç»“æŸæ—¶ï¼Œåˆå¯å†ä»åå¤‡ä½œä¸šé˜Ÿåˆ—ä¸­æ‰¾å‡ºå¦ä¸€ä½œä¸šè°ƒå…¥è¯¥åˆ†åŒºã€‚\nåˆ’åˆ†åˆ†åŒºçš„æ–¹æ³•ï¼š\n åˆ†åŒºå¤§å°ç›¸ç­‰ åˆ†åŒºå¤§å°ä¸ç›¸ç­‰  å¦å¤–å¯ä»¥è®¾ç½®åˆ†åŒºå¤§å°ä¸ç­‰çš„ä¸€äº›åˆ†åŒºï¼Œå¦‚ä¸‹ï¼š\nå›ºå®šåˆ†åŒºåˆ†é…çš„ç¼ºç‚¹ï¼š\n é€ æˆå­˜å‚¨ç©ºé—´çš„æµªè´¹ æ‹“å±•æ€§å·®  åŠ¨æ€åˆ†åŒºåˆ†é… åŠ¨æ€åˆ†åŒºåˆ†é…æ•°æ®ç»“æ„ï¼š\n  ç©ºé—²åˆ†åŒºè¡¨\nåœ¨ç³»ç»Ÿä¸­è®¾ç½®ä¸€å¼ ç©ºé—²åˆ†åŒºè¡¨ï¼Œç”¨äºè®°å½•æ¯ä¸ªç©ºé—²åˆ†åŒºçš„æƒ…å†µã€‚æ¯ä¸ªç©ºé—²åˆ†åŒºå ä¸€ä¸ªè¡¨ç›®ï¼Œè¡¨ç›®ä¸­åŒ…æ‹¬åˆ†åŒºåºå·ã€åˆ†åŒºå§‹å€åŠåˆ†åŒºçš„å¤§å°ç­‰æ•°æ®é¡¹ã€‚\n  ç©ºé—²åˆ†åŒºé“¾\nä¸ºäº†å®ç°å¯¹ç©ºé—²åˆ†åŒºçš„åˆ†é…å’Œé“¾æ¥ï¼Œåœ¨æ¯ä¸ªåˆ†åŒºçš„èµ·å§‹éƒ¨åˆ†ï¼Œè®¾ç½®ä¸€äº›ç”¨äºæ§åˆ¶åˆ†åŒºåˆ†é…çš„ä¿¡æ¯ï¼Œä»¥åŠç”¨äºé“¾æ¥å„åˆ†åŒºæ‰€ç”¨çš„å‰å‘æŒ‡é’ˆï¼›åœ¨åˆ†åŒºå°¾éƒ¨åˆ™è®¾ç½®ä¸€åå‘æŒ‡é’ˆï¼Œé€šè¿‡å‰ã€åå‘é“¾æ¥æŒ‡é’ˆï¼Œå¯å°†æ‰€æœ‰çš„ç©ºé—²åˆ†åŒºé“¾æ¥æˆä¸€ä¸ªåŒå‘é“¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n  å†…å­˜åˆ†é…åˆ†é…ç®—æ³• åŸºäºé¡ºåºæœç´¢ï¼š(é€‚åˆä¸å¤ªå¤§çš„ç³»ç»Ÿ)   é¦–æ¬¡é€‚åº”ç®—æ³•(FF)\nåœ¨åˆ†é…å†…å­˜æ—¶ï¼Œä»é“¾é¦–å¼€å§‹é¡ºåºæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå¤§å°èƒ½æ»¡è¶³çš„ç©ºé—²åˆ†åŒºå³å¯ã€‚ç„¶åå†å†æŒ‰ç…§ä½œä¸šçš„å¤§å°ï¼Œä»ç©ºé—´åˆ†åŒºä¸­åˆ’åˆ†å‡ºä¸ä½œä¸šå¤§å°ç›¸åŒçš„ç©ºé—´ç»™ä½œä¸šä½¿ç”¨ï¼Œä½™ä¸‹çš„ç©ºé—´ç•™åœ¨ç©ºé—²åˆ†åŒºé“¾ä¸­ã€‚\n é¦–æ¬¡é€‚åº”ç®—æ³•è¦æ±‚ç©ºé—²åˆ†åŒºé“¾ä»¥åœ°å€é€’å¢çš„æ¬¡åºé“¾æ¥ã€‚\n ç¼ºç‚¹ï¼šç©ºé—²åˆ†åŒºé“¾çš„ä½åœ°å€éƒ¨åˆ†ä¸æ–­è¢«åˆ’åˆ†ï¼Œä¼šæœ‰è®¸å¤šç»†å°çš„ç¢ç‰‡ç©ºé—´éš¾ä»¥åˆ©ç”¨ã€‚æ¯æ¬¡éƒ½æ˜¯ä»ä½åœ°å€å¼€å§‹æ‰¾ç©ºé—²åˆ†åŒºï¼ŒæŸ¥æ‰¾çš„æ•ˆç‡ä½ã€‚\n  å¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•(NF)\nå¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•åœ¨ä¸ºè¿›ç¨‹åˆ†é…å†…å­˜ç©ºé—´æ—¶ï¼Œä¸å†æ˜¯æ¯æ¬¡éƒ½ä»é“¾é¦–å¼€å§‹æŸ¥æ‰¾ï¼Œè€Œæ˜¯ä»ä¸Šæ¬¡æ‰¾åˆ°çš„ç©ºé—²åˆ†åŒºçš„ä¸‹ä¸€ä¸ªç©ºé—²åˆ†åŒºå¼€å§‹æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªèƒ½å¤Ÿæ»¡è¶³è¿›ç¨‹çš„ç©ºé—²åˆ†åŒºä¸ºæ­¢ï¼Œæœ€åä»ç©ºé—²åˆ†åŒºåˆ’åˆ†å‡ºä¸è¯·æ±‚å¤§å°ç›¸ç­‰çš„ç©ºé—´ç»™ä½œä¸šã€‚\n å¾ªç¯åˆ°é“¾è¡¨æœ«å°¾åˆä»æ–°ä»é“¾é¦–å¼€å§‹æŸ¥æ‰¾ã€‚\n ç¼ºç‚¹ï¼šç¼ºå°‘å¯ç”¨çš„å¤§ç©ºé—´ç©ºé—²åˆ†åŒºã€‚\n  æœ€ä½³é€‚åº”ç®—æ³•(BF)\næœ€ä½³é€‚åº”ç®—æ³•åœ¨åˆ†é…å†…å­˜çš„æ—¶å€™ï¼ŒæŠŠæ»¡è¶³è¦æ±‚å¹¶ä¸”åˆæ˜¯æœ€å°çš„ç©ºé—²åˆ†åŒºç»™ä½œä¸šã€‚ä¸ºäº†åŠ é€Ÿå¯»æ‰¾ï¼Œè¯¥ç®—æ³•éœ€è¦å¯¹ç©ºé—²åˆ†åŒºé“¾æŒ‰ç…§ç©ºé—²åˆ†åŒºå¤§å°è¿›è¡Œä»å°åˆ°å¤§æ’åºã€‚\nç¼ºç‚¹ï¼šä¼šäº§ç”Ÿè®¸å¤šç»†å°çš„ç¢ç‰‡\n  æœ€å·®é€‚åº”ç®—æ³•(WF)\næœ€å·®é€‚åº”ç®—æ³•æ¯æ¬¡åˆ†é…å†…å­˜çš„æ—¶å€™ï¼ŒæŠŠæ»¡è¶³è¦æ±‚çš„æœ€å¤§çš„ç©ºé—²åˆ†åŒºç»™ä½œä¸šï¼Œå°†ä¸ä½œä¸šç”³è¯·å¤§å°çš„ç©ºé—´åˆ’åˆ†å‡ºæ¥ï¼Œå‰©ä½™çš„ç©ºé—´ç•™åœ¨ç©ºé—²åˆ†åŒºä¸­ï¼Œå¹¶ä¸”æ›´æ–°ç©ºé—²åˆ†åŒºé“¾ã€‚è¯¥ç®—æ³•éœ€è¦å¯¹ç©ºé—²åˆ†åŒºé“¾æŒ‰ç…§ç©ºé—²åˆ†åŒºå¤§å°è¿›è¡Œä»å¤§åˆ°å°æ’åºã€‚\nä¼˜ç‚¹ï¼šæŸ¥æ‰¾æ•ˆç‡å—ï¼Œäº§ç”Ÿç¢ç‰‡å°‘ã€‚\nç¼ºç‚¹ï¼šç¼ºå°‘å¤§çš„ç©ºé—²åˆ†åŒº\n  ä¾‹å­ï¼š\nå‡è®¾æœ‰æ–°ç¨‹åºFè£…å…¥ï¼Œå¤§å°ä¸º32Kï¼Œå½“å‰å·²æœ‰ç¨‹åºBå’ŒDï¼Œæœ€è¿‘ä¸€æ¬¡ç©ºé—´åˆ†é…æ˜¯Dï¼š\nåŸºäºç´¢å¼•æœç´¢ï¼š(é€‚åˆæ¯”è¾ƒå¤§çš„ç³»ç»Ÿ)   å¿«é€Ÿé€‚åº”ç®—æ³•(QF)\nè¯¥ç®—æ³•åˆå«åšåˆ†ç±»æœç´¢æ³•ï¼Œæ˜¯å°†ç©ºé—²åˆ†åŒºæ ¹æ®å…¶å®¹é‡å¤§å°è¿›è¡Œåˆ†ç±»ï¼Œå¯¹äºæ¯ä¸€ç±»å…·æœ‰ç›¸åŒå®¹é‡çš„æ‰€æœ‰ç©ºé—²åˆ†åŒºï¼Œå•ç‹¬è®¾ç½®ä¸€ä¸ªç©ºé—²åˆ†åŒºé“¾ï¼Œè¿™æ ·ç³»ç»Ÿå­˜åœ¨å¤šä¸ªç©ºé—²åˆ†åŒºé“¾ã€‚åŒæ—¶ï¼Œè¿˜éœ€è¦åœ¨å†…å­˜ä¸­è®¾ç«‹ä¸€å¼ ç®¡ç†ç´¢å¼•è¡¨ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªç´¢å¼•è¡¨é¡¹å¯¹åº”äº†ä¸€ç§ç©ºé—²åˆ†åŒºç±»å‹ï¼Œå¹¶è®°å½•äº†è¯¥ç±»å‹ç©ºé—²åˆ†åŒºé“¾è¡¨è¡¨å¤´æŒ‡é’ˆã€‚\n ç©ºé—²åˆ†åŒºçš„åˆ†ç±»æ˜¯æ ¹æ®è¿›ç¨‹å¸¸ç”¨çš„ç©ºé—²å¤§å°è¿›è¡Œåˆ’åˆ†çš„ï¼Œå¦‚2KBã€4KBã€8KBç­‰ï¼Œå¯¹äºå…¶ä»–å¤§å°çš„ç©ºé—²åˆ†åŒºåƒ7KBçš„ç©ºé—²åˆ†åŒºï¼Œæ—¢å¯ä»¥æ”¾åœ¨8KBçš„é“¾è¡¨ä¸­ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨ä¸€ä¸ªç‰¹æ®Šçš„ç©ºé—²é“¾è¡¨ä¸­ã€‚\n   ä¼™ä¼´ç³»ç»Ÿ\nè¯¥ç®—æ³•è§„å®šï¼Œæ— è®ºæ˜¯åˆ†é…åˆ†åŒºè¿˜æ˜¯ç©ºé—²åˆ†åŒºï¼Œå…¶å¤§å°å‡ä¸º2çš„kæ¬¡å¹‚(kä¸ºæ•´æ•°ä¸”1\u0026lt;=k\u0026lt;=m)ã€‚é€šå¸¸$2^m$æ˜¯æ•´ä¸ªå¯åˆ†é…å†…å­˜çš„å¤§å°ã€‚\n  å“ˆå¸Œç®—æ³•\nå“ˆå¸Œç®—æ³•æ˜¯åˆ©ç”¨å“ˆå¸Œå¿«é€ŸæŸ¥æ‰¾çš„ä¼˜ç‚¹ï¼Œä»¥åŠç©ºé—²åˆ†åŒºåœ¨å¯åˆ©ç”¨ç©ºé—²åˆ†åŒºè¡¨ä¸­çš„åˆ†å¸ƒè§„å¾‹ï¼Œå»ºç«‹å“ˆå¸Œå‡½æ•°ï¼Œæ„é€ ä¸€å¼ ä»¥ç©ºé—²åˆ†åŒºå¤§å°ä¸ºå…³é”®å­—çš„å“ˆå¸Œè¡¨ï¼Œè¯¥è¡¨çš„æ¯ä¸€ä¸ªè¡¨é¡¹è®°å½•äº†ä¸€ä¸ªå¯¹åº”çš„ç©ºé—²åˆ†åŒºé“¾è¡¨è¡¨å¤´æŒ‡é’ˆã€‚\n  åŠ¨æ€é‡å®šä½åˆ†åŒºåˆ†é… ç´§å‡‘\nå¯¹å†…å­˜ä¸­æ­£åœ¨ä½¿ç”¨çš„åˆ†åŒºè¿›è¡Œæ¬è¿ï¼Œä½¿å¤šä¸ªå°çš„ç©ºé—²åˆ†åŒºï¼ˆç¢ç‰‡ï¼‰åˆå¹¶ä¸ºä¸€ä¸ªå¤§çš„ç©ºé—²åˆ†åŒº\nåŠ¨æ€é‡å®šä½\nç®—æ³•ï¼š\nä»€ä¹ˆæ˜¯å†…å­˜ç¢ç‰‡ï¼Ÿ\nå†…éƒ¨ç¢ç‰‡æ˜¯æŒ‡å·²ç»åˆ†é…ç»™ä½œä¸šä½†ä¸èƒ½è¢«åˆ©ç”¨çš„å†…å­˜ç©ºé—´ï¼Œå¤–éƒ¨ç¢ç‰‡æ˜¯æŒ‡ç³»ç»Ÿä¸­è¿˜æ²¡æœ‰åˆ†é…ç»™ä½œä¸šï¼Œä½†ç”±äºç¢ç‰‡å¤ªå°è€Œæ— æ³•åˆ†é…ç»™ç”³è¯·å†…å­˜ç©ºé—´çš„æ–°è¿›ç¨‹çš„å­˜å‚¨å—ã€‚é€šä¿—ç‚¹çš„ç†è§£å°±æ˜¯ï¼ŒæŸä¸ªä½œä¸šæ‰€å ç”¨çš„å†…å­˜åŒºåŸŸå¦‚æœæ²¡æœ‰è£…æ»¡ï¼Œå°±æ˜¯å†…éƒ¨ç¢ç‰‡ï¼Œè€Œä½œä¸šä¸ä½œä¸šä¹‹é—´ï¼Œå¦‚æœæœ‰å†…å­˜åŒºåŸŸæ²¡æœ‰åˆ†é…ç»™æŸä¸ªä½œä¸šï¼Œä½†åˆä¸èƒ½åˆ†é…ç»™ä»»ä½•ä½œä¸šï¼Œå°±æ˜¯å¤–éƒ¨ç¢ç‰‡ã€‚\n è¿ç»­åˆ†é…: ä¸ºç”¨æˆ·è¿›ç¨‹åˆ†é…çš„å¿…é¡»æ˜¯ä¸€ä¸ªè¿ç»­çš„å†…å­˜ç©ºé—´ã€‚\néè¿ç»­åˆ†é…: ä¸ºç”¨æˆ·è¿›ç¨‹åˆ†é…çš„å¯ä»¥æ˜¯ä¸€äº›åˆ†æ•£çš„å†…å­˜ç©ºé—´ã€‚\n éè¿ç»­åˆ†é…æ–¹å¼(ç¦»æ•£åˆ†é…æ–¹å¼) æ€æƒ³\nå‡è®¾è¿›ç¨‹Aå¤§å°ä¸º23MB,ä½†æ˜¯æ¯ä¸ªåˆ†åŒºå¤§å°åªæœ‰10MB,å¦‚æœè¿›ç¨‹åªèƒ½å ç”¨ä¸€ä¸ªåˆ†åŒº,é‚£æ˜¾ç„¶æ”¾ä¸ä¸‹ã€‚\nè§£å†³æ€è·¯:\nå¦‚æœå…è®¸è¿›ç¨‹å ç”¨å¤šä¸ªåˆ†åŒº,é‚£ä¹ˆå¯ä»¥æŠŠè¿›ç¨‹æ‹†åˆ†æˆ10MB+10MB+3MBä¸‰ä¸ªéƒ¨å¤–,å†æŠŠè¿™ä¸‰ä¸ªéƒ¨åˆ†åˆ†åˆ«æ”¾åˆ°ä¸‰ä¸ªåˆ†åŒºä¸­(è¿™äº›åˆ†åŒºä¸è¦æ±‚è¿ç»­)\u0026hellip;\nè¿›ç¨‹Açš„æœ€åä¸€ä¸ªéƒ¨åˆ†æ˜¯3MB,æ”¾å…¥åˆ†åŒºåä¼šäº§ç”Ÿ7MBçš„å†…éƒ¨ç¢ç‰‡ï¼Œå¦‚æœæ¯ä¸ªåˆ†åŒºå¤§å°ä¸º2MB,é‚£ä¹ˆè¿›ç¨‹Aå¯ä»¥æ‹†åˆ†æˆ11*2MB +1MBå…±12ä¸ªéƒ¨åˆ†,åªæœ‰æœ€åä¸€éƒ¨åˆ†1MBå ä¸æ»¡åˆ†åŒº,å…±äº§ç”Ÿ1MBçš„å†…éƒ¨ç¢ç‰‡.\næ˜¾ç„¶,å¦‚æœæŠŠå¤–åŒºå¤§å°è®¾ç½®çš„æ›´å°ä¸€äº›,å†…éƒ¨ç¢ç‰‡ä¼šæ›´å°,å†…å­¦åˆ©ç”¨ç‡ä¼šæ›´é«˜.\nå…·æœ‰å¿«è¡¨çš„åœ°å€å˜æ¢æœºæ„ï¼šï¼ˆæ—¶é—´å±€éƒ¨æ€§ä¸ç©ºé—´å±€éƒ¨æ€§åŸç†ï¼‰\nå¿«è¡¨,åˆç§°è”æƒ³å¯„å­˜å™¨(TLB) ,æ˜¯ä¸€ç§è®¿é—®é€Ÿåº¦æ¯”å†…å­˜å¿«å¾ˆå¤šçš„é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨,ç”¨æ¥å­˜æ”¾å½“\u0026quot;å‰è®¿é—´çš„è‹¥å¹²é¡µè¡¨é¡¹,ä»¥åŠ é€Ÿåœ°å€å˜æ¢çš„è¿‡ç¨‹ã€‚ä¸æ­¤å¯¹åº”,å†…å­˜ä¸­çš„é¡µè¡¨å¸¸ç§°ä¸ºæ…¢è¡¨ã€‚\nå¤šçº§é¡µè¡¨\né—®é¢˜\nåŠ è½½ä¸€ä¸ªå¤§çš„é¡µè¡¨éœ€è¦å ç”¨å¾ˆå¤§çš„å†…å­˜\nè§£å†³\nå°†å¤§è¡¨åˆ†ä¸ºå‡ ä¸ªå°è¡¨ã€‚ç±»ä¼¼CIDRã€‚\nå¯å°†é•¿é•¿çš„é¡µè¡¨è¿›è¡Œåˆ†ç»„,ä½¿æ¯ä¸ªå†…å­˜å—åˆšå¥½å¯ä»¥æ”¾å…¥ä¸€ä¸ªåˆ†ç»„(æ¯”å¦‚ä¸Šä¸ªä¾§å­ä¸­,é¡µé¢å¤§å°4KB,æ¯ä¸ªé¡µè¡¨é¡¹48,æ¯ä¸ªé¡µé¢å¯å­˜æ”¾1Kä¸ªé¡µè¡¨é¡¹,å› æ­¤æ¯1Kä¸ªè¿ç»­çš„é¡µè¡¨é¡¹ä¸ºä¸€ç»„,æ¯ç»„åˆšå¥½å ä¸€ä¸ªå†…å­˜å—,å†è®²å„ç»„ç¦»æ•£åœ°æ”¾åˆ°å„ä¸ªå†…å­˜å—ä¸­)å¦å¤–,è¦ä¸ºç¦»æ•£åˆ†é…çš„é¡µè¡¨å†å»ºç«‹ä¸€å¼ é¡µè¡¨,ç§°ä¸ºé¡µç›®å½•è¡¨,æˆ–ç§°å¤–å±‚é¡µè¡¨,æˆ–ç§°é¡¶å±‚é¡µè¡¨\nå­˜å‚¨ç®¡ç†æ–¹å¼  æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å†…å­˜çš„åˆ’åˆ†æ–¹æ³•\n åˆ†é¡µå­˜å‚¨ç®¡ç† è¿™ç§æ–¹å¼ä¸­ï¼Œå°†ç”¨æˆ·ç¨‹åºçš„åœ°å€ç©ºé—´ï¼Œæ³¨æ„ï¼Œæ˜¯ç”¨æˆ·ç¨‹åºçš„åœ°å€ç©ºé—´åˆ†ä¸ºè‹¥å¹²ä¸ªå›ºå®šå¤§å°çš„åŒºåŸŸï¼Œæˆä¸ºâ€œé¡µâ€æˆ–â€œé¡µé¢â€ã€‚æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿™ä¹Ÿé¡µå…¶å®æ˜¯ä¸å­˜åœ¨çš„ï¼Œåªæ˜¯ä¸€ç§åˆ’åˆ†å†…å­˜ç©ºé—´çš„æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§æ–¹å¼å°†ç”¨æˆ·çš„ç¨‹åº**â€œè‚¢è§£â€**äº†ï¼Œåˆ†æˆå¾ˆå¤šä¸ªå°çš„éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†ç§°ä¸ºä¸€ä¸ªâ€œé¡µâ€ã€‚\né€»è¾‘åœ°å€ å°†é€»è¾‘åœ°å€çš„å‰nä½ä½œä¸ºé¡µå·ï¼Œåé¢32-nä½ä½œä¸ºé¡µå†…åç§»é‡ã€‚\né¡µå†…ç¢ç‰‡ ç”±äºè¿›ç¨‹çš„æœ€åä¸€é¡µç»å¸¸è£…ä¸æ»¡ä¸€ä¸ªå—ï¼Œä»è€Œå½¢æˆäº†ä¸å¯åˆ©ç”¨çš„ç¢ç‰‡ï¼Œç§°ä¹‹ä¸º**â€œé¡µå†…ç¢ç‰‡â€**ã€‚\né¡µè¡¨ ä½œç”¨ï¼šå®ç°é¡µå·åˆ°ç‰©ç†å·çš„åœ°å€æ˜ å°„ã€‚\né¡µè¡¨æ˜¯è®°å½•é€»è¾‘ç©ºé—´ï¼ˆè™šæ‹Ÿå†…å­˜ï¼‰ä¸­æ¯ä¸€é¡µåœ¨å†…å­˜ä¸­å¯¹åº”çš„ç‰©ç†å—å·ã€‚ä½†å¹¶éæ¯ä¸€é¡µé€»è¾‘ç©ºé—´éƒ½ä¼šå®é™…å¯¹åº”ç€ä¸€ä¸ªç‰©ç†å—ï¼Œåªæœ‰å®é™…é©»ç•™åœ¨ç‰©ç†å†…å­˜ç©ºé—´ä¸­çš„é¡µæ‰ä¼šå¯¹åº”ç€ç‰©ç†å—ã€‚\nç³»ç»Ÿä¼šä¸ºæ¯ä¸€ä¸ªè¿›ç¨‹å»ºç«‹ä¸€å¼ é¡µè¡¨ï¼Œé¡µè¡¨æ˜¯éœ€è¦ä¸€ç›´é©»ç•™åœ¨ç‰©ç†å†…å­˜ä¸­çš„ï¼ˆå¤šçº§é¡µè¡¨é™¤å¤–ï¼‰ï¼Œå¦å¤–é¡µè¡¨çš„èµ·å€å’Œé•¿åº¦å­˜æ”¾åœ¨ PCBï¼ˆProcess Control Blockï¼‰è¿›ç¨‹æ§åˆ¶ç»“æ„ä½“ä¸­ã€‚\nå¯ä»¥åœ¨é¡µè¡¨çš„è¡¨é¡¹ä¸­è®¾ç½®ç›¸å…³çš„æƒé™æ§åˆ¶å­—æ®µï¼Œä¾‹å¦‚è®¾ç½®å­˜å–æ§åˆ¶å­—æ®µï¼Œç”¨äºä¿æŠ¤è¯¥å­˜å‚¨å—çš„è¯»å†™ï¼›è‹¥å­˜å–æ§åˆ¶å­—æ®µä¸º2ä½ï¼Œåˆ™å¯ä»¥è®¾ç½®è¯»/å†™ã€åªè¯»å’Œåªæ‰§è¡Œç­‰å­˜å–æ–¹å¼ã€‚\nç‰©ç†å— ç‰©ç†å—æ˜¯å®å®åœ¨åœ¨å­˜åœ¨äºå†…å­˜ä¸­çš„ï¼š\nåœ°å€å˜æ¢æœºæ„ ç”±äºæ‰§è¡Œé¢‘ç‡é«˜ï¼Œè¦æ±‚æ•ˆç‡æ¯”è¾ƒé«˜ï¼Œéœ€è¦ä½¿ç”¨ç¡¬ä»¶å®ç°ã€‚\nåœ¨ç³»ç»Ÿä¸­è®¾ç½®ä¸€ä¸ªé¡µè¡¨å¯„å­˜å™¨(PTR),å…¶ä¸­å­˜æ”¾é¡µè¡¨åœ¨å†…å­˜çš„èµ·å§‹åœ°å€å’Œé¡µè¡¨çš„é•¿åº¦ã€‚å¹³æ—¶è¿›ç¨‹æœªæ‰§è¡Œçš„æ—¶å€™ï¼Œé¡µè¡¨çš„èµ·å§‹åœ°å€å’Œé¡µè¡¨é•¿åº¦æ”¾åœ¨æœ¬è¿›ç¨‹çš„PCBä¸­ã€‚å½“è°ƒåº¦ç¨‹åºè°ƒåº¦åˆ°æŸä¸ªè¿›ç¨‹çš„æ—¶å€™ï¼Œæ‰å°†è¿™ä¸¤ä¸ªæ•°æ®è£…å…¥é¡µè¡¨å¯„å­˜å™¨ã€‚\n æ³¨æ„ï¼Œå½“åˆ›å»ºä¸€ä¸ªè¿›ç¨‹çš„æ—¶å€™ï¼Œå®ƒçš„é¡µè¡¨ä¹ŸåŒæ—¶åˆ›å»ºäº†ï¼Œåªä¸è¿‡åªåœ¨PCBå­˜å‚¨äº†é¡µè¡¨çš„èµ·å§‹åœ°å€å’Œé•¿åº¦ã€‚\n å˜æ¢è¿‡ç¨‹ï¼š\n è¿›ç¨‹è®¿é—®æŸä¸ªé€»è¾‘åœ°å€æ—¶ï¼Œåˆ†é¡µåœ°å€æœºæ„è‡ªåŠ¨å°†é€»è¾‘åœ°å€åˆ†ä¸ºé¡µå·å’Œé¡µå†…åœ°å€ é¡µå·å¤§äºé¡µè¡¨é•¿åº¦ï¼Œè¶Šç•Œé”™è¯¯;å¦åˆ™ç»§ç»­ä¸‹é¢çš„æ­¥éª¤ é¡µè¡¨é¡¹çš„åœ°å€ p = é¡µè¡¨èµ·å§‹åœ°å€ F + é¡µå· P * è¡¨é¡¹å¤§å° Sï¼Œä»è€Œå¾—åˆ°å¯¹åº”çš„ç‰©ç†å—å· B é¡µå’Œç‰©ç†å—çš„å¤§å°æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥ é¡µå†…åœ°å€=å—å†…åœ°å€ ç„¶å ç‰©ç†åœ°å€ = ç‰©ç†å—å· B * é¡µå¤§å° L + é¡µå†…åœ°å€ æ ¹æ®ç‰©ç†åœ°å€è¯»å–æ•°æ®  å¿«è¡¨çš„å˜æ¢æœºæ„\n åŸºç¡€çš„åœ°å€å˜æ¢æœºæ„çš„ç¼ºç‚¹ï¼š\nç”±äºé¡µè¡¨æ˜¯å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè¿™ä½¿å¾—CPUåœ¨æ¯å­˜å–ä¸€ä¸ªæ•°æ®æ—¶ï¼Œéƒ½éœ€è¦ä¸¤æ¬¡è®¿é—®å†…å­˜ã€‚ç¬¬ä¸€æ¬¡æ—¶è®¿é—®å†…å­˜ä¸­çš„é¡µè¡¨ï¼Œè·å–ç‰©ç†å—å·ï¼Œäºåç§»å€¼æ‹¼æ¥å¾—åˆ°ç‰©ç†åœ°å€ï¼Œç¬¬äºŒæ¬¡æ˜¯ä»ç¬¬ä¸€æ¬¡æ‰€å¾—ç‰©ç†åœ°å€è·å–æ‰€éœ€æ•°æ®(æˆ–è€…å‘è¯¥åœ°å€å†™å…¥æ•°æ®)ã€‚è¿™æ ·è®¡ç®—æœºçš„å¤„ç†é€Ÿåº¦å‡ ä¹é™ä½äº†1/2ï¼›\n ä¸ºäº†æé«˜åœ°å€å˜æ¢é€Ÿåº¦ï¼Œå¯åœ¨åœ°å€å˜æ¢æœºæ„ä¸­å¢è®¾ä¸€ä¸ªå…·æœ‰å¹¶è¡ŒæŸ¥è¯¢èƒ½åŠ›çš„ç‰¹æ®Šé«˜é€Ÿç¼“å†²å¯„å­˜å™¨ï¼Œåˆç§°ä¸º\u0026quot;è”æƒ³å¯„å­˜å™¨\u0026quot;æˆ–è€…â€œå¿«è¡¨â€ã€‚ä¿—ç§°TLBã€‚\nå¿«è¡¨ä¸é¡µè¡¨çš„åŠŸèƒ½ç±»ä¼¼ï¼Œå…¶å®å°±æ˜¯å°†ä¸€éƒ¨åˆ†é¡µè¡¨å­˜åˆ° CPU å†…éƒ¨çš„é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨ Cacheã€‚CPU å¯»å€æ—¶å…ˆåˆ°å¿«è¡¨æŸ¥è¯¢ç›¸åº”çš„é¡µè¡¨é¡¹å½¢æˆç‰©ç†åœ°å€ï¼Œå¦‚æœæŸ¥è¯¢ä¸åˆ°ï¼Œåˆ™åˆ°å†…å­˜ä¸­æŸ¥è¯¢ï¼Œå¹¶å°†å¯¹åº”é¡µè¡¨é¡¹è°ƒå…¥åˆ°å¿«è¡¨ä¸­ã€‚ä½†ï¼Œå¦‚æœå¿«è¡¨çš„å­˜å‚¨ç©ºé—´å·²æ»¡ï¼Œåˆ™éœ€è¦é€šè¿‡ç®—æ³•æ‰¾åˆ°ä¸€ä¸ªæš‚æ—¶ä¸å†éœ€è¦çš„é¡µè¡¨é¡¹ï¼Œå°†å®ƒæ¢å‡ºå†…å­˜ã€‚\nç”±äºæˆæœ¬çš„å…³ç³»ï¼Œå¿«è¡¨ä¸å¯èƒ½åšå¾—å¾ˆå¤§ï¼Œé€šå¸¸åªå­˜æ”¾ 16~512 ä¸ªé¡µè¡¨é¡¹ï¼Œè¿™å¯¹ä¸­ã€å°å‹ä½œä¸šæ¥è¯´ï¼Œå·²æœ‰å¯èƒ½æŠŠå…¨éƒ¨é¡µè¡¨é¡¹æ”¾åœ¨å¿«è¡¨ä¸­ï¼›ä½†å¯¹äºå¤§å‹ä½œä¸šè€Œè¨€ï¼Œåˆ™åªèƒ½å°†å…¶ä¸€éƒ¨åˆ†é¡µè¡¨é¡¹æ”¾å…¥å…¶ä¸­ã€‚ç”±äºå¯¹ç¨‹åºå’Œæ•°æ®çš„è®¿é—®å¾€å¾€å¸¦æœ‰å±€é™æ€§ï¼Œå› æ­¤ï¼Œæ®ç»Ÿè®¡ï¼Œä»å¿«è¡¨ä¸­èƒ½æ‰¾åˆ°æ‰€éœ€é¡µè¡¨é¡¹çš„æ¦‚ç‡å¯è¾¾ 90% ä»¥ä¸Šã€‚è¿™æ ·ï¼Œç”±äºå¢åŠ äº†åœ°å€å˜æ¢æœºæ„è€Œé€ æˆçš„é€Ÿåº¦æŸå¤±å¯å‡å°‘åˆ° 10% ä»¥ä¸‹ï¼Œè¾¾åˆ°äº†å¯æ¥å—çš„ç¨‹åº¦ã€‚\nä¸¤çº§é¡µè¡¨  ä¸€çº§é¡µè¡¨çš„ç¼ºé™·ï¼šç”±äºé¡µè¡¨å¿…é¡»è¿ç»­å­˜æ”¾ï¼Œå¹¶ä¸”éœ€è¦å¸¸é©»ç‰©ç†å†…å­˜ï¼Œå½“é€»è¾‘åœ°å€ç©ºé—´å¾ˆå¤§æ—¶ï¼Œå¯¼è‡´é¡µè¡¨å ç”¨å†…å­˜ç©ºé—´å¾ˆå¤§ã€‚\n æˆ‘ä»¬å¯ä»¥é‡‡ç”¨è¿™æ ·ä¸¤ä¸ªæ–¹æ³•æ¥è§£å†³è¿™ä¸€é—®é¢˜ï¼š\nâ‘  å¯¹äºé¡µè¡¨æ‰€éœ€çš„å†…å­˜ç©ºé—´ï¼Œå¯é‡‡ç”¨ç¦»æ•£åˆ†é…æ–¹å¼ï¼Œä»¥è§£å†³éš¾ä»¥æ‰¾åˆ°ä¸€å—è¿ç»­çš„å¤§å†…å­˜ç©ºé—´çš„é—®é¢˜ï¼›\nâ‘¡ åªå°†å½“å‰éœ€è¦çš„éƒ¨åˆ†é¡µè¡¨é¡¹è°ƒå…¥å†…å­˜ï¼Œå…¶ä½™çš„é¡µè¡¨é¡¹ä»é©»ç•™åœ¨ç£ç›˜ä¸Šï¼Œéœ€è¦æ—¶å†è°ƒå…¥ã€‚\näºŒçº§é¡µè¡¨çš„é¡µè¡¨é¡¹ï¼š\nè¿‡ç¨‹ï¼š\n å¤–å±‚é¡µè¡¨å¯„å­˜å™¨ä¸­ä¿å­˜äº†å¤–å±‚é¡µè¡¨çš„å§‹å€ï¼Œæ ¹æ®å¤–å±‚é¡µå·æŸ¥æ‰¾åˆ°å†…å±‚é¡µå·ã€‚ æ‰¾åˆ°æŒ‡å®šé¡µè¡¨åˆ†é¡µçš„å§‹å€ï¼Œæ ¹æ®å†…å±‚é¡µå·æ‰¾åˆ°ç‰©ç†å—å·ã€‚ ç‰©ç†å—å·På’Œé¡µå†…åœ°å€dç»„è£…æˆä¸€ä¸ªå®é™…çš„ç‰©ç†åœ°å€ã€‚  åœ¨é‡‡ç”¨ä¸¤çº§é¡µè¡¨ç»“æ„çš„æƒ…å†µä¸‹ï¼Œå¯¹äºæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œå¿…é¡»å°†å…¶å¤–å±‚é¡µè¡¨è°ƒå…¥å†…å­˜ï¼Œè€Œå¯¹äºå†…é¡µè¡¨åˆ™åªéœ€è°ƒå…¥ä¸€é¡µæˆ–å‡ é¡µã€‚ä¸ºäº†è¡¨å¾æŸé¡µçš„é¡µè¡¨æ˜¯å¦å·²ç»è°ƒå…¥å†…å­˜ï¼Œè¿˜åº”åœ¨å¤–å±‚é¡µè¡¨é¡¹ä¸­å¢è®¾ä¸€ä¸ªçŠ¶æ€ä½ Sï¼Œå…¶å€¼è‹¥ä¸º 0ï¼Œè¡¨ç¤ºè¯¥é¡µè¡¨åˆ†é¡µä¸åœ¨å†…å­˜ä¸­ï¼Œå¦åˆ™è¯´æ˜å…¶åˆ†é¡µå·²è°ƒå…¥å†…å­˜ã€‚è¿›ç¨‹è¿è¡Œæ—¶ï¼Œåœ°å€å˜æ¢æœºæ„æ ¹æ®é€»è¾‘åœ°å€ä¸­çš„ P1å»æŸ¥æ‰¾å¤–å±‚é¡µè¡¨ï¼›è‹¥æ‰€æ‰¾åˆ°çš„é¡µè¡¨é¡¹ä¸­çš„çŠ¶æ€ä½ä¸º 0ï¼Œåˆ™äº§ç”Ÿä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œè¯·æ±‚ OS å°†è¯¥é¡µè¡¨åˆ†é¡µè°ƒå…¥å†…å­˜ã€‚\nå¤šçº§é¡µè¡¨ å¤šçº§é¡µè¡¨å’ŒäºŒçº§é¡µè¡¨ç±»ä¼¼ã€‚å¤šçº§é¡µè¡¨å’ŒäºŒçº§é¡µè¡¨æ˜¯ä¸ºäº†èŠ‚çœç‰©ç†å†…å­˜ç©ºé—´ã€‚ä½¿å¾—é¡µè¡¨å¯ä»¥åœ¨å†…å­˜ä¸­ç¦»æ•£å­˜å‚¨ã€‚ï¼ˆå•çº§é¡µè¡¨ä¸ºäº†éšæœºè®¿é—®å¿…é¡»è¿ç»­å­˜å‚¨ï¼Œå¦‚æœè™šæ‹Ÿå†…å­˜ç©ºé—´å¾ˆå¤§ï¼Œå°±éœ€è¦å¾ˆå¤šé¡µè¡¨é¡¹ï¼Œå°±éœ€è¦å¾ˆå¤§çš„è¿ç»­å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯å¤šçº§é¡µè¡¨ä¸éœ€è¦ã€‚ï¼‰\n åˆ†é¡µå¼ç®¡ç†å¾ˆå¥½çš„é¿å…äº†å¤–éƒ¨ç¢ç‰‡ï¼Œä½†æ˜¯è¿˜æ˜¯å­˜åœ¨å†…éƒ¨ç¢ç‰‡ï¼Œå› ä¸ºç¨‹åºå¤§å°ä¸å¯èƒ½æ€»æ˜¯2çš„næ¬¡å¹‚ã€‚å¤šçº§é¡µè¡¨ä½¿å¾—é¡µè¡¨æ•°æ®å¯ä»¥ä¸éœ€è¦è¿ç»­å­˜å‚¨ï¼Œå³å®ç°äº†é¡µè¡¨çš„ç¦»æ•£å¼å­˜å‚¨ã€‚å¹¶ä¸”åœ¨å½“å¯¹åº”ç¨‹åºè¿è¡Œæ‰å°†å†…é¡µè¡¨æ•°æ®è°ƒå…¥å†…å­˜ä¹Ÿå‡å°‘äº†é¡µè¡¨æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ã€‚æœ¬è´¨ä¸Šæ˜¯æé«˜å†…å­˜åˆ©ç”¨ç‡ã€‚\n åˆ†æ®µå­˜å‚¨ç®¡ç†  ä¸ºäº†æ»¡è¶³ç”¨æˆ·è¦æ±‚çš„ä¸€ç§å­˜å‚¨ç®¡ç†çš„æ–¹å¼\n ä¸ºä»€ä¹ˆå¼•å…¥åˆ†æ®µå­˜å‚¨ç®¡ç†ï¼Ÿ\n é€šå¸¸çš„ç¨‹åºéƒ½å¯ä»¥åˆ†ä¸ºè‹¥å¹²ä¸ªæ®µï¼Œå¦‚ä¸»ç¨‹åºæ®µã€å­ç¨‹åºæ®µAã€å­ç¨‹åºæ®µBã€\u0026hellip;ã€æ•°æ®æ®µå’Œæ ˆæ®µç­‰ç­‰ã€‚ å®ç°å’Œæ»¡è¶³ä¿¡æ¯å…±äº«ã€ä¿¡æ¯ä¿æŠ¤ã€åŠ¨æ€é“¾æ¥ä»¥åŠä¿¡æ¯çš„åŠ¨æ€å¢é•¿  å¼•å…¥æ•ˆæœï¼š\n  æ–¹ä¾¿ç¼–ç¨‹\nä½¿ç”¨ç¬¦å·ä½œä¸ºæ®µåœ°å€è¿›è¡Œä½¿ç”¨ã€‚(æ¯ä¸ªæ®µéƒ½æ˜¯ä» 0 å¼€å§‹çš„ç‹¬ç«‹é€»è¾‘åœ°å€ç©ºé—´ï¼›)\n  ä¿¡æ¯å…±äº«\nåœ¨å®ç°å¯¹ç¨‹åºå’Œæ•°æ®çš„å…±äº«æ—¶ï¼Œæ˜¯ä»¥ä¿¡æ¯çš„é€»è¾‘å•ä½ä¸ºåŸºç¡€çš„ã€‚æ¯”å¦‚ï¼Œä¸ºäº†å…±äº«æŸä¸ªè¿‡ç¨‹ã€å‡½æ•°æˆ–æ–‡ä»¶ã€‚åˆ†é¡µç³»ç»Ÿä¸­çš„â€œé¡µâ€åªæ˜¯å­˜æ”¾ä¿¡æ¯çš„ç‰©ç†å•ä½(å—)ï¼Œå¹¶æ— å®Œæ•´çš„é€»è¾‘æ„ä¹‰ï¼Œè¿™æ ·ï¼Œä¸€ä¸ªå¯è¢«å…±äº«çš„è¿‡ç¨‹å¾€å¾€å¯èƒ½éœ€è¦å ç”¨æ•°åä¸ªé¡µé¢ï¼Œè¿™ä¸ºå®ç°å…±äº«å¢åŠ äº†å›°éš¾ã€‚æ®µå¯ä»¥æ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºè¯¥è¢«å…±äº«è¿‡ç¨‹å»ºç«‹ä¸€ä¸ªç‹¬ç«‹çš„æ®µï¼Œè¿™å°±æå¤§åœ°ç®€åŒ–äº†å…±äº«çš„å®ç°ã€‚\n  ä¿¡æ¯ä¿æŠ¤\nä¿¡æ¯ä¿æŠ¤åŒæ ·æ˜¯ä»¥ä¿¡æ¯çš„é€»è¾‘å•ä½ä¸ºåŸºç¡€çš„ï¼Œè€Œä¸”ç»å¸¸æ˜¯ä»¥ä¸€ä¸ªè¿‡ç¨‹ã€å‡½æ•°æˆ–æ–‡ä»¶ä¸ºåŸºæœ¬å•ä½è¿›è¡Œä¿æŠ¤çš„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¸Œæœ›å‡½æ•° A ä»…å…è®¸è¿›ç¨‹æ‰§è¡Œï¼Œè€Œä¸å…è®¸è¯»ï¼Œæ›´ä¸å…è®¸å†™ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬åªé¡»åœ¨åŒ…å«äº†å‡½æ•° A çš„è¿™ä¸ªæ®µä¸Šæ ‡ä¸Šåªæ‰§è¡Œæ ‡å¿—å³å¯ã€‚ä½†æ˜¯åœ¨åˆ†é¡µç³»ç»Ÿä¸­ï¼Œå‡½æ•° A å¯èƒ½è¦å ç”¨è‹¥å¹²ä¸ªé¡µé¢ï¼Œè€Œä¸”å…¶ä¸­çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªé¡µé¢è¿˜ä¼šè£…æœ‰å…¶å®ƒç¨‹åºæ®µçš„æ•°æ®ï¼Œå®ƒä»¬å¯èƒ½æœ‰ç€ä¸åŒçš„ä¿æŠ¤å±æ€§ï¼Œå¦‚å¯ä»¥å…è®¸è¿›ç¨‹è¯»å†™ï¼Œè¿™æ ·å°±å¾ˆéš¾å¯¹è¿™äº›é¡µé¢å®æ–½ç»Ÿä¸€çš„ä¿æŠ¤ï¼Œå› æ­¤ï¼Œåˆ†æ®µç®¡ç†æ–¹å¼èƒ½æ›´æœ‰æ•ˆå’Œæ–¹ä¾¿åœ°å®ç°å¯¹ä¿¡æ¯çš„ä¿æŠ¤åŠŸèƒ½ã€‚\n  åŠ¨æ€å¢é•¿\nåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¾€å¾€å­˜åœ¨ç€ä¸€äº›æ®µï¼Œå°¤å…¶æ˜¯æ•°æ®æ®µï¼Œåœ¨å®ƒä»¬çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œç”±äºæ•°æ®é‡çš„ä¸æ–­å¢åŠ ï¼Œè€Œä½¿æ•°æ®æ®µåŠ¨æ€å¢é•¿ï¼Œç›¸åº”åœ°å®ƒæ‰€éœ€è¦çš„å­˜å‚¨ç©ºé—´ä¹Ÿä¼šåŠ¨æ€å¢åŠ ã€‚ç„¶è€Œï¼Œå¯¹äºæ•°æ®æ®µç©¶ç«Ÿä¼šå¢é•¿åˆ°å¤šå¤§ï¼Œäº‹å…ˆåˆå¾ˆéš¾ç¡®åˆ‡åœ°çŸ¥é“ã€‚å¯¹æ­¤ï¼Œå¾ˆéš¾é‡‡å–é¢„å…ˆå¤šåˆ†é…çš„æ–¹æ³•è¿›è¡Œè§£å†³ã€‚å‰è¿°çš„å…¶å®ƒå‡ ç§å­˜å‚¨ç®¡ç†æ–¹å¼éƒ½éš¾ä»¥åº”ä»˜è¿™ç§åŠ¨æ€å¢é•¿çš„æƒ…å†µï¼Œè€Œåˆ†æ®µå­˜å‚¨ç®¡ç†æ–¹å¼å´èƒ½è¾ƒå¥½åœ°è§£å†³è¿™ä¸€é—®é¢˜ã€‚\n  åŠ¨æ€é“¾æ¥\nåŠ¨æ€é“¾æ¥åœ¨ä½œä¸šè¿è¡Œä¹‹å‰ï¼Œå¹¶ä¸æ˜¯æŠŠæ‰€æœ‰çš„ç›®æ ‡ç¨‹åºæ®µéƒ½é“¾æ¥èµ·æ¥ã€‚å½“ç¨‹åºè¦è¿è¡Œæ—¶ï¼Œé¦–å…ˆå°†ä¸»ç¨‹åºå’Œå®ƒç«‹å³éœ€è¦ç”¨åˆ°çš„ç›®æ ‡ç¨‹åºè£…å…¥å†…å­˜ï¼Œå³å¯åŠ¨è¿è¡Œã€‚è€Œåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“éœ€è¦è°ƒç”¨æŸä¸ªç›®æ ‡ç¨‹åºæ—¶ï¼Œæ‰å°†è¯¥æ®µ(ç›®æ ‡ç¨‹åº)è°ƒå…¥å†…å­˜å¹¶è¿›è¡Œé“¾æ¥ã€‚å¯è§ï¼ŒåŠ¨æ€é“¾æ¥è¦æ±‚çš„æ˜¯ä»¥ç›®æ ‡ç¨‹åº(å³æ®µ)ä½œä¸ºé“¾æ¥çš„åŸºæœ¬å•ä½,å› æ­¤ï¼Œåˆ†æ®µå­˜å‚¨ç®¡ç†æ–¹å¼éå¸¸é€‚åˆäºåŠ¨æ€é“¾æ¥ã€‚\n  å®ƒå°†ç”¨æˆ·ç¨‹åºçš„åœ°å€ç©ºé—´åˆ†ä¸ºè‹¥å¹²ä¸ªå¤§å°ä¸åŒçš„çš„æ®µï¼Œæ¯ä¸ªæ®µå¯ä»¥å®šä¹‰ä¸€ç»„å®Œæ•´çš„ä¿¡æ¯ã€‚\nåˆ†æ®µåœ°å€ æ®µå·è¡¨ç¤ºæ®µåï¼Œæ¯ä¸ªæ®µéƒ½ä»0å¼€å§‹ç¼–å€ï¼Œå¹¶ä¸”é‡‡ç”¨ä¸€æ®µè¿ç»­çš„åœ°å€ç©ºé—´ã€‚\nåœ¨è¯¥åœ°å€ç»“æ„ä¸­ï¼Œå…è®¸ä¸€ä¸ªä½œä¸šæœ€é•¿æœ‰64Kä¸ªæ®µï¼Œæ¯ä¸ªæ®µçš„æœ€å¤§é•¿åº¦ä¸º64KBã€‚\nåœ¨åˆ†æ®µå¼å­˜å‚¨ç®¡ç†ç³»ç»Ÿä¸­ï¼Œä¸ºæ¯ä¸€ä¸ªåˆ†æ®µåˆ†é…ä¸€ä¸ªè¿ç»­çš„åˆ†åŒºã€‚è¿›ç¨‹çš„å„ä¸ªæ®µï¼Œå¯ä»¥ç¦»æ•£åœ°è£…å…¥å†…å­˜ä¸­ä¸åŒçš„åˆ†åŒºä¸­ã€‚\næ®µè¡¨ ä½œç”¨ï¼šå®ç°ä»é€»è¾‘åœ°å€åˆ°ç‰©ç†å†…å­˜åŒºçš„æ˜ å°„ã€‚\nä¸ºäº†ä¿è¯ç¨‹åºèƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼Œå°±å¿…é¡»èƒ½å¤Ÿä»ç‰©ç†å†…å­˜ä¸­æ‰¾å‡ºæ¯ä¸ªé€»è¾‘æ®µæ‰€å¯¹åº”çš„ä½ç½®ã€‚ä¸ºæ­¤åœ¨ç³»ç»Ÿä¸­ä¼šä¸ºæ¯ä¸€ä¸ªè¿›ç¨‹å»ºç«‹ä¸€å¼ æ®µè¡¨ã€‚æ¯ä¸ªæ®µåœ¨è¡¨ä¸­æœ‰ä¸€ä¸ªè¡¨é¡¹ï¼Œå…¶ä¸­è®°å½•äº†è¯¥æ®µåœ¨å†…å­˜ä¸­çš„èµ·å§‹åœ°å€å’Œæ®µçš„é•¿åº¦ã€‚ä¸€èˆ¬å°†æ®µè¡¨ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚\nåœ¨é…ç½®äº†æ®µè¡¨ä¹‹åï¼Œæ‰§è¡Œçš„è¿‡ç¨‹å¯ä»¥é€šè¿‡æŸ¥æ‰¾æ®µè¡¨ï¼Œæ‰¾åˆ°æ¯ä¸€ä¸ªæ®µæ‰€å¯¹åº”çš„å†…å­˜åŒºã€‚\nåœ°å€å˜æ¢æœºæ„ ä¸ºäº†å®ç°è¿›ç¨‹ä»é€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„å˜æ¢åŠŸèƒ½ï¼Œåœ¨ç³»ç»Ÿè®¾ç½®äº†æ®µè¡¨å¯„å­˜å™¨ï¼Œç”¨äºå­˜æ”¾æ®µè¡¨çš„èµ·å§‹åœ°å€å’Œæ®µè¡¨é•¿åº¦TLã€‚\nåœ¨è¿›è¡Œåœ°å€å˜æ¢æ—¶ï¼Œç³»ç»Ÿå°†é€»è¾‘åœ°å€ä¸­çš„æ®µå·ä¸æ®µè¡¨é•¿åº¦TL è¿›è¡Œæ¯”è¾ƒã€‚è‹¥ S \u0026gt; TLï¼Œè¡¨ç¤ºæ®µå·å¤ªå¤§ï¼Œæ˜¯è®¿é—®è¶Šç•Œï¼Œäºæ˜¯äº§ç”Ÿè¶Šç•Œä¸­æ–­ä¿¡å·ã€‚è‹¥æœªè¶Šç•Œï¼Œåˆ™æ ¹æ®æ®µè¡¨çš„å§‹å€å’Œè¯¥æ®µçš„æ®µå·ï¼Œè®¡ç®—å‡ºè¯¥æ®µå¯¹åº”æ®µè¡¨é¡¹çš„ä½ç½®ï¼Œä»ä¸­è¯»å‡ºè¯¥æ®µåœ¨å†…å­˜çš„èµ·å§‹åœ°å€ã€‚ç„¶åï¼Œå†æ£€æŸ¥æ®µå†…åœ°å€ d æ˜¯å¦è¶…è¿‡è¯¥æ®µçš„æ®µé•¿ SLã€‚è‹¥è¶…è¿‡ï¼Œå³ d\u0026gt;SLï¼ŒåŒæ ·å‘å‡ºè¶Šç•Œä¸­æ–­ä¿¡å·ã€‚è‹¥æœªè¶Šç•Œï¼Œåˆ™å°†è¯¥æ®µçš„åŸºå€ d ä¸æ®µå†…åœ°å€ç›¸åŠ ï¼Œå³å¯å¾—åˆ°è¦è®¿é—®çš„å†…å­˜ã€‚\n åƒåˆ†é¡µç³»ç»Ÿä¸€æ ·ï¼Œå½“æ®µè¡¨æ”¾åœ¨å†…å­˜ä¸­æ—¶ï¼Œæ¯è¦è®¿é—®ä¸€ä¸ªæ•°æ®ï¼Œéƒ½é¡»è®¿é—®ä¸¤æ¬¡å†…å­˜ï¼Œä»è€Œæˆå€åœ°é™ä½äº†è®¡ç®—æœºçš„é€Ÿç‡ã€‚è§£å†³çš„æ–¹æ³•å’Œåˆ†é¡µç³»ç»Ÿç±»ä¼¼ï¼Œä¹Ÿå¢è®¾ä¸€ä¸ªè”ç›¸å­˜å‚¨å™¨ï¼Œç”¨äºä¿å­˜æœ€è¿‘å¸¸ç”¨çš„æ®µè¡¨é¡¹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”±äºæ˜¯æ®µæ¯”é¡µå¤§ï¼Œå› è€Œæ®µè¡¨é¡¹çš„æ•°ç›®æ¯”é¡µè¡¨é¡¹çš„æ•°ç›®å°‘ï¼Œå…¶æ‰€éœ€çš„è”æƒ³å­˜å‚¨å™¨ä¹Ÿç›¸å¯¹è¾ƒå°ï¼Œæ‰€ä»¥å¯ä»¥æ˜¾è‘—åœ°å‡å°‘å­˜å–æ•°æ®çš„æ—¶é—´ï¼Œä¸æ²¡æœ‰åœ°å€å˜æ¢çš„å¸¸è§„å­˜å‚¨å™¨ç›¸æ¯”è€Œè¨€ï¼Œå…¶å­˜å–é€Ÿåº¦çº¦æ…¢ 10%~15%ã€‚\n æ®µé¡µå¼å­˜å‚¨ç®¡ç† åˆ†é¡µå’Œåˆ†æ®µçš„åŒºåˆ« åˆ†é¡µå’Œåˆ†æ®µç³»ç»Ÿç›¸ä¼¼ä¹‹å¤„ï¼šä¸¤è€…éƒ½é‡‡ç”¨ç¦»æ•£åˆ†é…æ–¹å¼ï¼Œä¸”éƒ½æ˜¯é€šè¿‡åœ°å€æ˜ å°„æœºæ„å®ç°åœ°å€å˜æ¢ã€‚\nä½†åœ¨æ¦‚å¿µä¸Šä¸¤è€…å®Œå…¨ä¸åŒï¼Œä¸»è¦è¡¨ç°åœ¨ä¸‹è¿°ä¸‰ä¸ªæ–¹é¢ï¼š\n é¡µæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ï¼Œæ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ã€‚ é¡µçš„å¤§å°ç¡®å®šä¸”åˆç³»ç»Ÿå†³å®šï¼›æ®µçš„é•¿åº¦ä¸å›ºå®šï¼Œå†³å®šäºç”¨æˆ·æ‰€ç¼–å†™çš„ç¨‹åºã€‚ åˆ†é¡µçš„ç”¨æˆ·ç¨‹åºåœ°å€ç©ºé—´æ˜¯ä¸€ç»´çš„ï¼Œåªéœ€è¦ä¸€ä¸ªè®°å¿†ç¬¦å°±èƒ½å¤Ÿè¡¨ç¤ºä¸€ä¸ªåœ°å€ï¼›åˆ†æ®µçš„ç”¨æˆ·ç¨‹åºåœ°å€ç©ºé—´æ˜¯äºŒç»´çš„ï¼Œæ—¢éœ€è¦æ®µåï¼Œåˆéœ€è¦æ®µå†…åœ°å€ã€‚  æ®µé¡µå¼ åˆ†é¡µç³»ç»Ÿä»¥é¡µé¢ä½œä¸ºå†…å­˜åˆ†é…çš„åŸºæœ¬å•ä½ï¼Œèƒ½æœ‰æ•ˆåœ°æé«˜å†…å­˜åˆ©ç”¨ç‡ï¼Œè€Œåˆ†æ®µç³»ç»Ÿä»¥æ®µä½œä¸ºå†…å­˜åˆ†é…çš„åŸºæœ¬å•ä½ï¼Œå®ƒèƒ½å¤Ÿæ›´å¥½åœ°æ»¡è¶³ç”¨æˆ·å¤šæ–¹é¢çš„éœ€è¦ã€‚\næ®µé¡µå¼åœ°å€ç»“æ„ æ®µé¡µå¼åœ°å€ç»“æ„ç”±æ®µå·ã€æ®µå†…é¡µå·åŠé¡µå†…åœ°å€ä¸‰éƒ¨åˆ†æ‰€ç»„æˆ\næ®µé¡µå¼ç³»ç»Ÿçš„åŸºæœ¬åŸç†æ˜¯åˆ†æ®µå’Œåˆ†é¡µåŸç†çš„ç»“åˆï¼Œå³å…ˆå°†ç”¨æˆ·ç¨‹åºåˆ†æˆè‹¥å¹²ä¸ªæ®µï¼Œå†æŠŠæ¯ä¸ªæ®µåˆ†æˆè‹¥å¹²ä¸ªé¡µï¼Œå¹¶ä¸ºæ¯ä¸€ä¸ªæ®µèµ‹äºˆä¸€ä¸ªæ®µåã€‚å¦‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªä½œä¸šåœ°å€ç©ºé—´çš„ç»“æ„ã€‚è¯¥ä½œä¸šæœ‰ä¸‰ä¸ªæ®µï¼šä¸»ç¨‹åºæ®µã€å­ç¨‹åºæ®µå’Œæ•°æ®æ®µï¼›é¡µé¢å¤§å°ä¸º 4 KBï¼š\nåœ¨æ®µé¡µå¼ç³»ç»Ÿä¸­ï¼Œä¸ºäº†å®ç°ä»é€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„å˜æ¢ï¼Œç³»ç»Ÿä¸­éœ€è¦åŒæ—¶é…ç½®æ®µè¡¨å’Œé¡µè¡¨ã€‚æ®µè¡¨çš„å†…å®¹ä¸åˆ†æ®µç³»ç»Ÿç•¥æœ‰ä¸åŒï¼Œå®ƒä¸å†æ˜¯å†…å­˜å§‹å€å’Œæ®µé•¿ï¼Œè€Œæ˜¯é¡µè¡¨å§‹å€å’Œé¡µè¡¨é•¿åº¦ã€‚ä¸‹å›¾å±•ç¤ºå‡ºäº†åˆ©ç”¨æ®µè¡¨å’Œé¡µè¡¨è¿›è¡Œä»ç”¨æˆ·åœ°å€ç©ºé—´åˆ°ç‰©ç†(å†…å­˜)ç©ºé—´çš„æ˜ å°„ã€‚\nåœ°å€å˜æ¢è¿‡ç¨‹ åœ¨æ®µé¡µå¼ç³»ç»Ÿä¸­ï¼Œä¸ºäº†ä¾¿äºå®ç°åœ°å€å˜æ¢ï¼Œé¡»é…ç½®ä¸€ä¸ªæ®µè¡¨å¯„å­˜å™¨ï¼Œå…¶ä¸­å­˜æ”¾æ®µè¡¨å§‹å€å’Œæ®µé•¿ TLã€‚è¿›è¡Œåœ°å€å˜æ¢æ—¶ï¼Œé¦–å…ˆåˆ©ç”¨æ®µå· Sï¼Œå°†å®ƒä¸æ®µé•¿ TL è¿›è¡Œæ¯”è¾ƒã€‚è‹¥ S \u0026lt; TLï¼Œè¡¨ç¤ºæœªè¶Šç•Œï¼Œäºæ˜¯åˆ©ç”¨æ®µè¡¨å§‹å€å’Œæ®µå·æ¥æ±‚å‡ºè¯¥æ®µæ‰€å¯¹åº”çš„æ®µè¡¨é¡¹åœ¨æ®µè¡¨ä¸­çš„ä½ç½®ï¼Œä»ä¸­å¾—åˆ°è¯¥æ®µçš„é¡µè¡¨å§‹å€ï¼Œå¹¶åˆ©ç”¨é€»è¾‘åœ°å€ä¸­çš„æ®µå†…é¡µå· P æ¥è·å¾—å¯¹åº”é¡µçš„é¡µè¡¨é¡¹ä½ç½®ï¼Œä»ä¸­è¯»å‡ºè¯¥è´æ‰€åœ¨çš„ç‰©ç†å—å· bï¼Œå†åˆ©ç”¨å—å· b å’Œé¡µå†…åœ°å€æ¥æ„æˆç‰©ç†åœ°å€ã€‚\nåœ¨æ®µé¡µå¼ç³»ç»Ÿä¸­ï¼Œä¸ºäº†è·å¾—ä¸€æ¡æŒ‡ä»¤æˆ–æ•°æ®ï¼Œé¡»ä¸‰æ¬¡è®¿é—®å†…å­˜ã€‚ç¬¬ä¸€æ¬¡è®¿é—®æ˜¯è®¿é—®å†…å­˜ä¸­çš„æ®µè¡¨ï¼Œä»ä¸­å–å¾—é¡µè¡¨å§‹å€ï¼›ç¬¬äºŒæ¬¡è®¿é—®æ˜¯è®¿é—®å†…å­˜ä¸­çš„é¡µè¡¨ï¼Œä»ä¸­å–å‡ºè¯¥é¡µæ‰€åœ¨çš„ç‰©ç†å—å·ï¼Œå¹¶å°†è¯¥å—å·ä¸é¡µå†…åœ°å€ä¸€èµ·å½¢æˆæŒ‡ä»¤æˆ–æ•°æ®çš„ç‰©ç†åœ°å€ï¼›ç¬¬ä¸‰æ¬¡è®¿é—®æ‰æ˜¯çœŸæ­£ä»ç¬¬äºŒæ¬¡è®¿é—®æ‰€å¾—çš„åœ°å€ä¸­å–å‡ºæŒ‡ä»¤æˆ–æ•°æ®ã€‚\næ˜¾ç„¶ï¼Œè¿™ä½¿è®¿é—®å†…å­˜çš„æ¬¡æ•°å¢åŠ äº†è¿‘ä¸¤å€ã€‚ä¸ºäº†æé«˜æ‰§è¡Œé€Ÿåº¦ï¼Œåœ¨åœ°å€å˜æ¢æœºæ„ä¸­å¢è®¾ä¸€ä¸ªé«˜é€Ÿç¼“å†²å¯„å­˜å™¨ã€‚æ¯æ¬¡è®¿é—®å®ƒæ—¶ï¼Œéƒ½é¡»åŒæ—¶åˆ©ç”¨æ®µå·å’Œé¡µå·å»æ£€ç´¢é«˜é€Ÿç¼“å­˜ï¼Œè‹¥æ‰¾åˆ°åŒ¹é…çš„è¡¨é¡¹ï¼Œä¾¿å¯ä»ä¸­å¾—åˆ°ç›¸åº”é¡µçš„ç‰©ç†å—å·ï¼Œç”¨æ¥ä¸é¡µå†…åœ°å€ä¸€èµ·å½¢æˆç‰©ç†åœ°å€ï¼šè‹¥æœªæ‰¾åˆ°åŒ¹é…è¡¨é¡¹ï¼Œåˆ™ä»éœ€ç¬¬ä¸‰æ¬¡è®¿é—®å†…å­˜ã€‚\nå‚è€ƒé“¾æ¥ï¼š\n ã€æ“ä½œç³»ç»Ÿ - 4ã€‘åŠ¨æ€åˆ†åŒºåˆ†é…ç®—æ³• ç¨‹åºçš„é“¾æ¥çš„ä¸‰ç§æ–¹å¼ è¿ç»­åˆ†é…ç®¡ç†æ–¹å¼ æ·±å…¥ç†è§£æ“ä½œç³»ç»Ÿä¹‹â€”â€”åˆ†é¡µå¼å­˜å‚¨ç®¡ç† ã€Šè®¡ç®—æœºæ“ä½œç³»ç»Ÿã€‹(ç¬¬å››ç‰ˆ)  ","description":"","id":12,"section":"posts","tags":["Linux"],"title":"Linuxå†…å­˜ç®¡ç†","uri":"https://hugo.jiahongw.com/zh/posts/linux/memory-control/"},{"content":"ç½‘ç»œå±‚ ç½‘é™…åè®®IPæ˜¯TCP/IPä½“ç³»ä¸­ä¸¤ä¸ªæœ€ä¸»è¦çš„åè®®ä¹‹ä¸€[STEV94][COME06][FORO10]ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„å› ç‰¹ç½‘æ ‡å‡†åè®®ä¹‹ä¸€ã€‚\nä¸IPåè®®é…å¥—ä½¿ç”¨çš„è¿˜æœ‰ä¸‰ä¸ªåè®®ï¼š\n åœ°å€è§£æåè®®ARP (Address Resolution Protocol) ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP (Internet Control Message Protocol) ç½‘é™…ç»„ç®¡ç†åè®®IGMP (Internet Group Management Protocol)  åœ¨è¿™ä¸€å±‚ä¸­ï¼ŒARPç”»åœ¨æœ€ä¸‹é¢ï¼Œå› ä¸ºIPç»å¸¸è¦ä½¿ç”¨è¿™ä¸ªåè®®ã€‚ICMPå’ŒIGMPç”»åœ¨è¿™ä¸€å±‚çš„ä¸Šéƒ¨ï¼Œå› ä¸ºå®ƒä»¬è¦ä½¿ç”¨IPåè®®ã€‚ç”±äºç½‘é™…åè®®IPæ˜¯ç”¨æ¥ä½¿äº’è¿èµ·æ¥çš„è®¸å¤šè®¡ç®—æœºç½‘ç»œèƒ½å¤Ÿè¿›è¡Œé€šä¿¡ï¼Œå› æ­¤TCP/IPä½“ç³»ä¸­çš„ç½‘ç»œå±‚å¸¸å¸¸ç§°ä¸ºç½‘é™…å±‚(internet layer)ï¼Œæˆ–IPå±‚ã€‚\nè™šæ‹Ÿäº’è¿ç½‘ç»œ  ä»ä¸€èˆ¬çš„æ¦‚å¿µæ¥è®²ï¼Œå°†ç½‘ç»œäº’ç›¸è¿æ¥èµ·æ¥è¦ä½¿ç”¨ä¸€äº›ä¸­é—´è®¾å¤‡ã€‚æ ¹æ®ä¸­é—´è®¾å¤‡æ‰€åœ¨çš„å±‚æ¬¡ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹å››ç§ä¸åŒçš„ä¸­é—´è®¾å¤‡ï¼š\n(1) ç‰©ç†å±‚ä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšè½¬å‘å™¨(repeater)ã€‚\n(2) æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšç½‘æ¡¥æˆ–æ¡¥æ¥å™¨(bridge)ã€‚\n(3) ç½‘ç»œå±‚ä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšè·¯ç”±å™¨(router)[æ’å›¾]ã€‚\n(4) åœ¨ç½‘ç»œå±‚ä»¥ä¸Šä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšç½‘å…³(gateway)ã€‚\nç”¨ç½‘å…³è¿æ¥ä¸¤ä¸ªä¸å…¼å®¹çš„ç³»ç»Ÿéœ€è¦åœ¨é«˜å±‚è¿›è¡Œåè®®çš„è½¬æ¢ã€‚\n IPç½‘ï¼š\nå¼‚æ„çš„äº’è”ç½‘é“¾è·¯\nH1â†’R1â†’R2â†’R3â†’R4â†’R5â†’H2\nARPåè®®  å·²ç»çŸ¥é“äº†ä¸€ä¸ªæœºå™¨ï¼ˆä¸»æœºæˆ–è·¯ç”±å™¨ï¼‰çš„IPåœ°å€ï¼Œéœ€è¦æ‰¾å‡ºå…¶ç›¸åº”çš„ç¡¬ä»¶åœ°å€\n ARPåè®®å·¥ä½œåŸç†ï¼š\nå½“ä¸»æœºAè¦å‘æœ¬å±€åŸŸç½‘ä¸Šçš„æŸä¸ªä¸»æœºBå‘é€IPæ•°æ®æŠ¥æ—¶ï¼Œå°±å…ˆåœ¨å…¶ARPé«˜é€Ÿç¼“å­˜ä¸­æŸ¥çœ‹æœ‰æ— ä¸»æœºBçš„IPåœ°å€ã€‚å¦‚æœ‰ï¼Œå°±åœ¨ARPé«˜é€Ÿç¼“å­˜ä¸­æŸ¥å‡ºå…¶å¯¹åº”çš„ç¡¬ä»¶åœ°å€ï¼Œå†æŠŠè¿™ä¸ªç¡¬ä»¶åœ°å€å†™å…¥MACå¸§ï¼Œç„¶åé€šè¿‡å±€åŸŸç½‘æŠŠè¯¥MACå¸§å‘å¾€æ­¤ç¡¬ä»¶åœ°å€ã€‚\nå½“æ‰¾ä¸åˆ°æ—¶ï¼Œæ‰§è¡Œä¸‹é¢çš„æ“ä½œï¼š\n ARPè¿›ç¨‹åœ¨æœ¬å±€åŸŸç½‘ä¸Šå¹¿æ’­å‘é€ä¸€ä¸ªARPè¯·æ±‚åˆ†ç»„ åœ¨æœ¬å±€åŸŸç½‘ä¸Šçš„æ‰€æœ‰ä¸»æœºä¸Šè¿è¡Œçš„ARPè¿›ç¨‹éƒ½æ”¶åˆ°æ­¤ARPè¯·æ±‚åˆ†ç»„ ä¸»æœºBçš„IPåœ°å€ä¸ARPè¯·æ±‚åˆ†ç»„ä¸­è¦æŸ¥è¯¢çš„IPåœ°å€ä¸€è‡´ï¼Œå°±æ”¶ä¸‹è¿™ä¸ªARPè¯·æ±‚åˆ†ç»„ï¼Œå¹¶å‘ä¸»æœºAå‘é€ARPå“åº”åˆ†ç»„ï¼Œå¹¶åœ¨è¿™ä¸ªARPå“åº”åˆ†ç»„ä¸­å†™å…¥è‡ªå·±çš„ç¡¬ä»¶åœ°å€ã€‚  åœ¨ç½‘ç»œé“¾è·¯ä¸Šä¼ é€çš„å¸§æœ€ç»ˆæ˜¯æŒ‰ç…§ç¡¬ä»¶åœ°å€æ‰¾åˆ°ç›®çš„ä¸»æœºçš„ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ç›´æ¥ä½¿ç”¨ç¡¬ä»¶åœ°å€è¿›è¡Œé€šä¿¡ï¼Œè€Œæ˜¯è¦ä½¿ç”¨æŠ½è±¡çš„IPåœ°å€å¹¶è°ƒç”¨ARPæ¥å¯»æ‰¾å‡ºç›¸åº”çš„ç¡¬ä»¶åœ°å€å‘¢ï¼Ÿ\nç”±äºå…¨ä¸–ç•Œå­˜åœ¨ç€å„å¼å„æ ·çš„ç½‘ç»œï¼Œå®ƒä»¬ä½¿ç”¨ä¸åŒçš„ç¡¬ä»¶åœ°å€ã€‚è¦ä½¿è¿™äº›å¼‚æ„ç½‘ç»œèƒ½å¤Ÿäº’ç›¸é€šä¿¡å°±å¿…é¡»è¿›è¡Œéå¸¸å¤æ‚çš„ç¡¬ä»¶åœ°å€è½¬æ¢å·¥ä½œï¼Œå› æ­¤ç”±ç”¨æˆ·æˆ–ç”¨æˆ·ä¸»æœºæ¥å®Œæˆè¿™é¡¹å·¥ä½œå‡ ä¹æ˜¯ä¸å¯èƒ½çš„äº‹ã€‚ä½†ç»Ÿä¸€çš„IPåœ°å€æŠŠè¿™ä¸ªå¤æ‚é—®é¢˜è§£å†³äº†ã€‚è¿æ¥åˆ°å› ç‰¹ç½‘çš„ä¸»æœºåªéœ€æ‹¥æœ‰ç»Ÿä¸€çš„IPåœ°å€ï¼Œå®ƒä»¬ä¹‹é—´çš„é€šä¿¡å°±åƒè¿æ¥åœ¨åŒä¸€ä¸ªç½‘ç»œä¸Šé‚£æ ·ç®€å•æ–¹ä¾¿ï¼Œå› ä¸ºä¸Šè¿°çš„è°ƒç”¨ARPçš„å¤æ‚è¿‡ç¨‹éƒ½æ˜¯ç”±è®¡ç®—æœºè½¯ä»¶è‡ªåŠ¨è¿›è¡Œçš„ï¼Œå¯¹ç”¨æˆ·æ¥è¯´æ˜¯çœ‹ä¸è§è¿™ç§è°ƒç”¨è¿‡ç¨‹çš„ã€‚\nIPæ•°æ®æŠ¥ IPæŠ¥æ–‡æ ¼å¼ï¼š\nç‰‡åç§»çš„åˆ—å­ï¼š\nä¸€æ•°æ®æŠ¥çš„æ€»é•¿åº¦ä¸º3 820å­—èŠ‚ï¼Œå…¶æ•°æ®éƒ¨åˆ†ä¸º3 800å­—èŠ‚é•¿ï¼ˆä½¿ç”¨å›ºå®šé¦–éƒ¨ï¼‰ï¼Œéœ€è¦åˆ†ç‰‡ä¸ºé•¿åº¦ä¸è¶…è¿‡1 420å­—èŠ‚çš„æ•°æ®æŠ¥ç‰‡ã€‚å› å›ºå®šé¦–éƒ¨é•¿åº¦ä¸º20å­—èŠ‚ï¼Œå› æ­¤æ¯ä¸ªæ•°æ®æŠ¥ç‰‡çš„æ•°æ®éƒ¨åˆ†é•¿åº¦ä¸èƒ½è¶…è¿‡1 400å­—èŠ‚ã€‚äºæ˜¯åˆ†ä¸º3ä¸ªæ•°æ®æŠ¥ç‰‡ï¼Œå…¶æ•°æ®éƒ¨åˆ†çš„é•¿åº¦åˆ†åˆ«ä¸º1 400ï¼Œ1 400å’Œ1000å­—èŠ‚ã€‚åŸå§‹æ•°æ®æŠ¥é¦–éƒ¨è¢«å¤åˆ¶ä¸ºå„æ•°æ®æŠ¥ç‰‡çš„é¦–éƒ¨ï¼Œä½†å¿…é¡»ä¿®æ”¹æœ‰å…³å­—æ®µçš„å€¼ã€‚ä¸‹å¦‚ç»™å‡ºåˆ†ç‰‡åå¾—å‡ºçš„ç»“æœï¼ˆè¯·æ³¨æ„ç‰‡åç§»çš„æ•°å€¼ï¼‰\nä¸‹é¢æ˜¯æ•°æ®æŠ¥é¦–éƒ¨ä¸åˆ†ç‰‡æœ‰å…³çš„å­—æ®µä¸­çš„æ•°å€¼ï¼Œå…¶ä¸­æ ‡è¯†å­—æ®µçš„å€¼æ˜¯ä»»æ„ç»™å®šçš„ï¼ˆ12345ï¼‰ã€‚å…·æœ‰ç›¸åŒæ ‡è¯†çš„æ•°æ®æŠ¥ç‰‡åœ¨ç›®çš„ç«™å°±å¯æ— è¯¯åœ°é‡è£…æˆåŸæ¥çš„æ•°æ®æŠ¥ã€‚\né¦–éƒ¨æ£€éªŒå’Œ å 16ä½ã€‚è¿™ä¸ªå­—æ®µåªæ£€éªŒæ•°æ®æŠ¥çš„é¦–éƒ¨ï¼Œä½†ä¸åŒ…æ‹¬æ•°æ®éƒ¨åˆ†\nè¿™æ˜¯å› ä¸ºæ•°æ®æŠ¥æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨ï¼Œè·¯ç”±å™¨éƒ½è¦é‡æ–°è®¡ç®—ä¸€ä¸‹é¦–éƒ¨æ£€éªŒå’Œï¼ˆä¸€äº›å­—æ®µï¼Œå¦‚ç”Ÿå­˜æ—¶é—´ã€æ ‡å¿—ã€ç‰‡åç§»ç­‰éƒ½å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼‰ã€‚ä¸æ£€éªŒæ•°æ®éƒ¨åˆ†å¯å‡å°‘è®¡ç®—çš„å·¥ä½œé‡ã€‚ä¸ºäº†è¿›ä¸€æ­¥å‡å°è®¡ç®—æ£€éªŒå’Œçš„å·¥ä½œé‡ï¼ŒIPé¦–éƒ¨çš„æ£€éªŒå’Œä¸é‡‡ç”¨å¤æ‚çš„CRCæ£€éªŒç è€Œé‡‡ç”¨ä¸‹é¢çš„ç®€å•è®¡ç®—æ–¹æ³•ï¼šåœ¨å‘é€æ–¹ï¼Œå…ˆæŠŠIPæ•°æ®æŠ¥é¦–éƒ¨åˆ’åˆ†ä¸ºè®¸å¤š16ä½å­—çš„åºåˆ—ï¼Œå¹¶æŠŠæ£€éªŒå’Œå­—æ®µç½®é›¶ã€‚ç”¨åç ç®—æœ¯è¿ç®—[æ’å›¾]æŠŠæ‰€æœ‰16ä½å­—ç›¸åŠ åï¼Œå°†å¾—åˆ°çš„å’Œçš„åç å†™å…¥æ£€éªŒå’Œå­—æ®µã€‚æ¥æ”¶æ–¹æ”¶åˆ°æ•°æ®æŠ¥åï¼Œå°†é¦–éƒ¨çš„æ‰€æœ‰16ä½å­—å†ä½¿ç”¨åç ç®—æœ¯è¿ç®—ç›¸åŠ ä¸€æ¬¡ã€‚å°†å¾—åˆ°çš„å’Œå–åç ï¼Œå³å¾—å‡ºæ¥æ”¶æ–¹æ£€éªŒå’Œçš„è®¡ç®—ç»“æœã€‚è‹¥é¦–éƒ¨æœªå‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œåˆ™æ­¤ç»“æœå¿…ä¸º0ï¼Œäºæ˜¯å°±ä¿ç•™è¿™ä¸ªæ•°æ®æŠ¥ã€‚å¦åˆ™å³è®¤ä¸ºå‡ºå·®é”™ï¼Œå¹¶å°†æ­¤æ•°æ®æŠ¥ä¸¢å¼ƒã€‚\nIPå±‚è½¬å‘åˆ†ç»„ ç½‘ç»œæ‹“æ‰‘å›¾ï¼š\nåœ¨ç®€åŒ–å›¾ä¸­ï¼Œç½‘ç»œå˜æˆäº†ä¸€æ¡é“¾è·¯ï¼Œä½†æ¯ä¸€ä¸ªè·¯ç”±å™¨æ—è¾¹éƒ½æ³¨æ˜å…¶IPåœ°å€ã€‚ä½¿ç”¨è¿™æ ·çš„ç®€åŒ–å›¾ï¼Œå¯ä»¥ä½¿æˆ‘ä»¬ä¸ç”¨å…³å¿ƒæŸä¸ªç½‘ç»œå†…éƒ¨çš„å…·ä½“æ‹“æ‰‘ä»¥åŠè¿æ¥åœ¨è¯¥ç½‘ç»œä¸Šæœ‰å¤šå°‘å°è®¡ç®—æœºï¼Œå› ä¸ºè¿™äº›å¯¹äºç ”ç©¶åˆ†ç»„è½¬å‘é—®é¢˜å¹¶æ²¡æœ‰ä»€ä¹ˆå…³ç³»ã€‚è¿™æ ·çš„ç®€åŒ–å›¾å¼ºè°ƒäº†åœ¨äº’è”ç½‘ä¸Šè½¬å‘åˆ†ç»„æ—¶ï¼Œæ˜¯ä»ä¸€ä¸ªè·¯ç”±å™¨è½¬å‘åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ã€‚\næ€»ä¹‹ï¼Œåœ¨è·¯ç”±è¡¨ä¸­ï¼Œå¯¹æ¯ä¸€æ¡è·¯ç”±æœ€ä¸»è¦çš„æ˜¯ä»¥ä¸‹ä¸¤ä¸ªä¿¡æ¯ï¼š\nï¼ˆç›®çš„ç½‘ç»œåœ°å€ï¼Œä¸‹ä¸€è·³åœ°å€ï¼‰\näºæ˜¯ï¼Œæˆ‘ä»¬å°±æ ¹æ®ç›®çš„ç½‘ç»œåœ°å€æ¥ç¡®å®šä¸‹ä¸€è·³è·¯ç”±å™¨ï¼Œè¿™æ ·åšå¾—å‡ºä»¥ä¸‹çš„ç»“æœã€‚\n(1) IPæ•°æ®æŠ¥æœ€ç»ˆä¸€å®šå¯ä»¥æ‰¾åˆ°ç›®çš„ä¸»æœºæ‰€åœ¨ç›®çš„ç½‘ç»œä¸Šçš„è·¯ç”±å™¨ï¼ˆå¯èƒ½è¦é€šè¿‡å¤šæ¬¡çš„é—´æ¥äº¤ä»˜ï¼‰ã€‚\n(2) åªæœ‰åˆ°è¾¾æœ€åä¸€ä¸ªè·¯ç”±å™¨æ—¶ï¼Œæ‰è¯•å›¾å‘ç›®çš„ä¸»æœºè¿›è¡Œç›´æ¥äº¤ä»˜ã€‚\nç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP ä¸ºäº†æ›´æœ‰æ•ˆåœ°è½¬å‘IPæ•°æ®æŠ¥å’Œæé«˜äº¤ä»˜æˆåŠŸçš„æœºä¼šï¼Œåœ¨ç½‘é™…å±‚ä½¿ç”¨äº†ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMPã€‚\n ICMPå…è®¸ä¸»æœºæˆ–è·¯ç”±å™¨æŠ¥å‘Šå·®é”™æƒ…å†µå’Œæä¾›æœ‰å…³å¼‚å¸¸æƒ…å†µçš„æŠ¥å‘Š.ä¸€ä¸ªæ–°æ­å»ºå¥½çš„ç½‘ç»œï¼Œå¾€å¾€éœ€è¦å…ˆè¿›è¡Œä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼Œæ¥éªŒè¯ç½‘ç»œæ˜¯å¦ç•…é€šï¼›ä½†æ˜¯IPåè®®å¹¶ä¸æä¾›å¯é ä¼ è¾“ã€‚å¦‚æœä¸¢åŒ…äº†ï¼ŒIPåè®®å¹¶ä¸èƒ½é€šçŸ¥ä¼ è¾“å±‚æ˜¯å¦ä¸¢åŒ…ä»¥åŠä¸¢åŒ…çš„åŸå› ã€‚æ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦ä¸€ç§åè®®æ¥å®Œæˆè¿™æ ·çš„åŠŸèƒ½â€“ICMPåè®®ã€‚\n ICMPæŠ¥æ–‡æ ¼å¼\nICMPæŠ¥æ–‡çš„ç§ç±»æœ‰ä¸¤ç§ï¼Œå³ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡å’ŒICMPè¯¢é—®æŠ¥æ–‡ã€‚\nå‡ ç§å¸¸ç”¨çš„ICMPæŠ¥æ–‡ç±»å‹\nICMPæŠ¥æ–‡çš„ä»£ç å­—æ®µæ˜¯ä¸ºäº†è¿›ä¸€æ­¥åŒºåˆ†æŸç§ç±»å‹ä¸­çš„å‡ ç§ä¸åŒçš„æƒ…å†µã€‚æ£€éªŒå’Œå­—æ®µç”¨æ¥æ£€éªŒæ•´ä¸ªICMPæŠ¥æ–‡ã€‚æˆ‘ä»¬åº”å½“è¿˜è®°å¾—ï¼ŒIPæ•°æ®æŠ¥é¦–éƒ¨çš„æ£€éªŒå’Œå¹¶ä¸æ£€éªŒIPæ•°æ®æŠ¥çš„å†…å®¹ï¼Œå› æ­¤ä¸èƒ½ä¿è¯ç»è¿‡ä¼ è¾“çš„ICMPæŠ¥æ–‡ä¸äº§ç”Ÿå·®é”™ã€‚\nICMPå·®é”™æŠ¥å‘Š ICMPå·®é”™æŠ¥æ–‡å…±æœ‰äº”ç§ï¼Œå³ï¼š\n  ç»ˆç‚¹ä¸å¯è¾¾ å½“è·¯ç”±å™¨æˆ–ä¸»æœºä¸èƒ½äº¤ä»˜æ•°æ®æŠ¥æ—¶å°±å‘æºç‚¹å‘é€ç»ˆç‚¹ä¸å¯è¾¾æŠ¥æ–‡ã€‚\n  æºç‚¹æŠ‘åˆ¶ å½“è·¯ç”±å™¨æˆ–ä¸»æœºç”±äºæ‹¥å¡è€Œä¸¢å¼ƒæ•°æ®æŠ¥æ—¶ï¼Œå°±å‘æºç‚¹å‘é€æºç‚¹æŠ‘åˆ¶æŠ¥æ–‡ï¼Œä½¿æºç‚¹çŸ¥é“åº”å½“æŠŠæ•°æ®æŠ¥çš„å‘é€é€Ÿç‡æ”¾æ…¢ã€‚\n  æ—¶é—´è¶…è¿‡ å½“è·¯ç”±å™¨æ”¶åˆ°ç”Ÿå­˜æ—¶é—´ä¸ºé›¶çš„æ•°æ®æŠ¥æ—¶ï¼Œé™¤ä¸¢å¼ƒè¯¥æ•°æ®æŠ¥å¤–ï¼Œè¿˜è¦å‘æºç‚¹å‘é€æ—¶é—´è¶…è¿‡æŠ¥æ–‡ã€‚å½“ç»ˆç‚¹åœ¨é¢„å…ˆè§„å®šçš„æ—¶é—´å†…ä¸èƒ½æ”¶åˆ°ä¸€ä¸ªæ•°æ®æŠ¥çš„å…¨éƒ¨æ•°æ®æŠ¥ç‰‡æ—¶ï¼Œå°±æŠŠå·²æ”¶åˆ°çš„æ•°æ®æŠ¥ç‰‡éƒ½ä¸¢å¼ƒï¼Œå¹¶å‘æºç‚¹å‘é€æ—¶é—´è¶…è¿‡æŠ¥æ–‡ã€‚\n  å‚æ•°é—®é¢˜ å½“è·¯ç”±å™¨æˆ–ç›®çš„ä¸»æœºæ”¶åˆ°çš„æ•°æ®æŠ¥çš„é¦–éƒ¨ä¸­æœ‰çš„å­—æ®µçš„å€¼ä¸æ­£ç¡®æ—¶ï¼Œå°±ä¸¢å¼ƒè¯¥æ•°æ®æŠ¥ï¼Œå¹¶å‘æºç‚¹å‘é€å‚æ•°é—®é¢˜æŠ¥æ–‡ã€‚\n  æ”¹å˜è·¯ç”±ï¼ˆé‡å®šå‘ï¼‰ è·¯ç”±å™¨æŠŠæ”¹å˜è·¯ç”±æŠ¥æ–‡å‘é€ç»™ä¸»æœºï¼Œè®©ä¸»æœºçŸ¥é“ä¸‹æ¬¡åº”å°†æ•°æ®æŠ¥å‘é€ç»™å¦å¤–çš„è·¯ç”±å™¨ï¼ˆå¯é€šè¿‡æ›´å¥½çš„è·¯ç”±ï¼‰ã€‚\nå¦‚æœé»˜è®¤è·¯ç”±å™¨å‘ç°ä¸»æœºå‘å¾€æŸä¸ªç›®çš„åœ°å€çš„æ•°æ®æŠ¥çš„æœ€ä½³è·¯ç”±ä¸åº”å½“ç»è¿‡é»˜è®¤è·¯ç”±å™¨è€Œæ˜¯åº”å½“ç»è¿‡ç½‘ç»œä¸Šçš„å¦ä¸€ä¸ªè·¯ç”±å™¨Ræ—¶ï¼Œå°±ç”¨æ”¹å˜è·¯ç”±æŠ¥æ–‡æŠŠè¿™æƒ…å†µå‘Šè¯‰ä¸»æœºã€‚äºæ˜¯ï¼Œè¯¥ä¸»æœºå°±åœ¨å…¶è·¯ç”±è¡¨ä¸­å¢åŠ ä¸€ä¸ªé¡¹ç›®ï¼šåˆ°æŸæŸç›®çš„åœ°å€åº”ç»è¿‡è·¯ç”±å™¨R ï¼ˆè€Œä¸æ˜¯é»˜è®¤è·¯ç”±å™¨ï¼‰ã€‚\n  æ‰€æœ‰çš„ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ä¸­çš„æ•°æ®å­—æ®µéƒ½å…·æœ‰åŒæ ·çš„æ ¼å¼ï¼š\nä¸‹é¢æ˜¯ä¸åº”å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡çš„å‡ ç§æƒ…å†µã€‚\nâ— å¯¹ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ä¸å†å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚\nâ— å¯¹ç¬¬ä¸€ä¸ªåˆ†ç‰‡çš„æ•°æ®æŠ¥ç‰‡çš„æ‰€æœ‰åç»­æ•°æ®æŠ¥ç‰‡éƒ½ä¸å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚\nâ— å¯¹å…·æœ‰å¤šæ’­åœ°å€çš„æ•°æ®æŠ¥éƒ½ä¸å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚\nâ— å¯¹å…·æœ‰ç‰¹æ®Šåœ°å€ï¼ˆå¦‚127.0.0.0æˆ–0.0.0.0ï¼‰çš„æ•°æ®æŠ¥ä¸å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚\nICMPè¯¢é—®æŠ¥æ–‡ å¸¸ç”¨çš„ICMPè¯¢é—®æŠ¥æ–‡æœ‰ä¸¤ç§ï¼Œå³:\n å›é€è¯·æ±‚å’Œå›ç­” ICMPå›é€è¯·æ±‚æŠ¥æ–‡æ˜¯ç”±ä¸»æœºæˆ–è·¯ç”±å™¨å‘ä¸€ä¸ªç‰¹å®šçš„ç›®çš„ä¸»æœºå‘å‡ºçš„è¯¢é—®ã€‚æ”¶åˆ°æ­¤æŠ¥æ–‡çš„ä¸»æœºå¿…é¡»ç»™æºä¸»æœºæˆ–è·¯ç”±å™¨å‘é€ICMPå›é€å›ç­”æŠ¥æ–‡ã€‚è¿™ç§è¯¢é—®æŠ¥æ–‡ç”¨æ¥æµ‹è¯•ç›®çš„ç«™æ˜¯å¦å¯è¾¾ä»¥åŠäº†è§£å…¶æœ‰å…³çŠ¶æ€ã€‚ æ—¶é—´æˆ³è¯·æ±‚å’Œå›ç­” ICMPæ—¶é—´æˆ³è¯·æ±‚æŠ¥æ–‡æ˜¯è¯·æŸä¸ªä¸»æœºæˆ–è·¯ç”±å™¨å›ç­”å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ã€‚åœ¨ICMPæ—¶é—´æˆ³å›ç­”æŠ¥æ–‡ä¸­æœ‰ä¸€ä¸ª32ä½çš„å­—æ®µï¼Œå…¶ä¸­å†™å…¥çš„æ•´æ•°ä»£è¡¨ä»1900å¹´1æœˆ1æ—¥èµ·åˆ°å½“å‰æ—¶åˆ»ä¸€å…±æœ‰å¤šå°‘ç§’ã€‚æ—¶é—´æˆ³è¯·æ±‚ä¸å›ç­”å¯ç”¨æ¥è¿›è¡Œæ—¶é’ŸåŒæ­¥å’Œæµ‹é‡æ—¶é—´ã€‚  åº”ç”¨ ping ICMPæŠ¥æ–‡çš„ä¸€ä¸ªæœ€å¤§ç”¨é€”å°±æ˜¯pingå‘½ä»¤ï¼Œç”¨æ¥æµ‹è¯•ä¸¤ä¸ªä¸»æœºä¹‹é—´çš„è¿é€šæ€§ï¼š\ntracert Tracerouteä»æºä¸»æœºå‘ç›®çš„ä¸»æœºå‘é€ä¸€è¿ä¸²çš„IPæ•°æ®æŠ¥ï¼Œæ•°æ®æŠ¥ä¸­å°è£…çš„æ˜¯æ— æ³•äº¤ä»˜çš„UDPç”¨æˆ·æ•°æ®æŠ¥[æ’å›¾]ã€‚ç¬¬ä¸€ä¸ªæ•°æ®æŠ¥P1çš„ç”Ÿå­˜æ—¶é—´TTLè®¾ç½®ä¸º1ã€‚å½“P1åˆ°è¾¾è·¯å¾„ä¸Šçš„ç¬¬ä¸€ä¸ªè·¯ç”±å™¨R1æ—¶ï¼Œè·¯ç”±å™¨R1å…ˆæ”¶ä¸‹å®ƒï¼Œæ¥ç€æŠŠTTLçš„å€¼å‡1ã€‚ç”±äºTTLç­‰äºé›¶äº†ï¼ŒR1å°±æŠŠP1ä¸¢å¼ƒäº†ï¼Œå¹¶å‘æºä¸»æœºå‘é€ä¸€ä¸ªICMPæ—¶é—´è¶…è¿‡å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚æºä¸»æœºæ¥ç€å‘é€ç¬¬äºŒä¸ªæ•°æ®æŠ¥P2ï¼Œå¹¶æŠŠTTLè®¾ç½®ä¸º2ã€‚P2å…ˆåˆ°è¾¾è·¯ç”±å™¨R1ï¼ŒR1æ”¶ä¸‹åæŠŠTTLå‡1å†è½¬å‘ç»™è·¯ç”±å™¨R2ã€‚R2æ”¶åˆ°P2æ—¶TTLä¸º1ï¼Œä½†å‡1åTTLå˜ä¸ºé›¶äº†ã€‚R2å°±ä¸¢å¼ƒP2ï¼Œå¹¶å‘æºä¸»æœºå‘é€ä¸€ä¸ªICMPæ—¶é—´è¶…è¿‡å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚è¿™æ ·ä¸€ç›´ç»§ç»­ä¸‹å»ã€‚å½“æœ€åä¸€ä¸ªæ•°æ®æŠ¥åˆšåˆšåˆ°è¾¾ç›®çš„ä¸»æœºæ—¶ï¼Œæ•°æ®æŠ¥çš„TTLæ˜¯1ã€‚ä¸»æœºä¸è½¬å‘æ•°æ®æŠ¥ï¼Œä¹Ÿä¸æŠŠTTLå€¼å‡1ã€‚ä½†å› IPæ•°æ®æŠ¥ä¸­å°è£…çš„æ˜¯æ— æ³•äº¤ä»˜çš„è¿è¾“å±‚çš„UDPç”¨æˆ·æ•°æ®æŠ¥ï¼Œå› æ­¤ç›®çš„ä¸»æœºè¦å‘æºä¸»æœºå‘é€ICMPç»ˆç‚¹ä¸å¯è¾¾å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚\nè¿™æ ·ï¼Œæºä¸»æœºè¾¾åˆ°äº†è‡ªå·±çš„ç›®çš„ï¼Œå› ä¸ºè¿™äº›è·¯ç”±å™¨å’Œæœ€åç›®çš„ä¸»æœºå‘æ¥çš„ICMPæŠ¥æ–‡æ­£å¥½ç»™å‡ºäº†æºä¸»æœºæƒ³çŸ¥é“çš„è·¯ç”±ä¿¡æ¯â€”â€”åˆ°è¾¾ç›®çš„ä¸»æœºæ‰€ç»è¿‡çš„è·¯ç”±å™¨çš„IPåœ°å€ï¼Œä»¥åŠåˆ°è¾¾å…¶ä¸­çš„æ¯ä¸€ä¸ªè·¯ç”±å™¨çš„å¾€è¿”æ—¶é—´\n","description":"ç½‘ç»œå±‚æµ…æ","id":13,"section":"posts","tags":["è®¡ç®—æœºç½‘ç»œ","ç½‘ç»œå±‚"],"title":"ç½‘ç»œå±‚","uri":"https://hugo.jiahongw.com/zh/posts/network/net-level/"},{"content":" å…¬å¸\tå²—ä½\té¢˜ç›®\tå¸–å­æ—¶é—´\n==å­—èŠ‚è·³åŠ¨\tjava\tå‰‘æŒ‡ Offer 53 - II. 0ï½n-1ä¸­ç¼ºå¤±çš„æ•°å­—\t2020.07.18== ï¼ˆåŒæŒ‡é’ˆï¼‰\n==å­—èŠ‚è·³åŠ¨\tjava\tå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå•é“¾è¡¨æ˜¯ä¸æ˜¯æœ‰ç¯\t2020.07.18== ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰\n==å­—èŠ‚è·³åŠ¨\tjava\tç»™ä½ ä¸€ä¸ªæ•°ç»„ï¼Œæ±‚ä¸‰ä¸ªæ•°å­—ä¹‹å’Œä¸º100.\t2020.07.18== ï¼ˆè°ƒç”¨ä¸¤æ•°ä¹‹å’Œï¼Œå“ˆå¸Œï¼‰\n==å­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tç®—æ³•é¢˜ï¼ˆåˆå¹¶é“¾è¡¨\t2020.07.18==\n==å­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ±‚å²›å±¿ä¸ªæ•°\t2020.07.18==\n==å­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ ‘æ‰¾ä¸¤èŠ‚ç‚¹æœ€é•¿è·ç¦»\t2020.07.18==\nå­—èŠ‚è·³åŠ¨\tjava\t1243534543634äº¤æ¢å„ä½çš„æ•°å­—ï¼Œæ‰¾å‡ºå¤§äºç›®å‰è¿™ä¸ªæ•°çš„æœ€å°çš„ä¸€ä¸ªæ•°ã€‚\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå¯¹ä¸€ä¸ªå¥‡æ•°ä½å‡åºï¼Œå¶æ•°ä½é™åºçš„é“¾è¡¨ï¼Œè¿›è¡Œæ’åºï¼Œä¾‹å¦‚ 1-\u0026gt;100-\u0026gt;20-\u0026gt;80-\u0026gt;40-\u0026gt;30\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼š(1)è®¾è®¡sqtr(x)\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2ã€ç®—æ³•é¢˜ï¼š(1)åˆ¤æ–­å›æ–‡é“¾è¡¨\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\t(2)å¯¹äºç»™å®šçš„æ•°æ®ï¼Œæ‰¾å‡ºæ¯”è¿™ä¸ªæ•°å¤§çš„æœ€å°å›æ–‡æ•°ï¼ˆæ­£åè¯»éƒ½ä¸€æ ·çš„æ•°ï¼‰ï¼Œå¦‚ 12310 -\u0026gt; 12321\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç¬¬ä¸€é“ä»£ç ï¼šæ•°ç»„åªäº¤æ¢ä¸€æ¬¡æ±‚æœ€å¤§\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç¬¬äºŒé“ä»£ç ï¼š å•é“¾è¡¨åˆ¤æ–­æ˜¯å¦æœ‰ç¯\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tleetcodeåŸé¢˜ ä»ä¸€ä¸ªæ•° l ä¸€ç›´ ä¸ æ“ä½œåˆ° r ï¼Œæ€ä¹ˆåšæœ€å¿«ï¼Œå¤æ‚åº¦æœ€å°\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tkä¸ªä¸€ç»„åè½¬é“¾è¡¨\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\täºŒå‰æ ‘çš„éé€’å½’ååºéå†\t2020.07.18\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæ‹¬å·åŒ¹é…\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæŒ‰å­—å…¸åºå…¨æ’åˆ—è¾“å‡º\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tè·³å°é˜¶\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tå›¾å½¢/å›¾åƒå²—\tä¸€æ£µå®Œå…¨äºŒå‰æ ‘çš„æœ€åº•å±‚çš„æœ€å³èŠ‚ç‚¹\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæ±‚å­é›†\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\täºŒç»´æœ‰åºæ•°ç»„ï¼ˆä»å·¦åˆ°å³é€’å¢ï¼Œä»ä¸Šåˆ°ä¸‹ä¹Ÿé€’å¢ï¼‰ï¼Œæ‰¾ç›®æ ‡æ•°ï¼ˆæˆ‘å†™çš„äºŒåˆ†æ³•ï¼‰\t2020.07.17\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t1.åˆ¤æ–­å·¦å³æ‹¬å·æ˜¯å¦åˆç†\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t2.æœ´ç´ è´å¶æ–¯çš„ç®—æ³•å®ç°\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t3.ä¸¤ä¸ªå¾ˆå¤§çš„æ•°æ®é›†å­˜ç€url æ‰¾åˆ°ä¸¤ä¸ªæ•°æ®é›†å…±æœ‰çš„url\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t4.ä¸€ä¸ªäºŒç»´çŸ©é˜µç”±å°åˆ°å¤§æ’åˆ— æ‰¾targetæ•°å­—\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t5.äºŒå‰æ ‘æŒ‰è¡Œè¾“å‡º\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t1.ç»™äºŒå‰æ ‘å‰åºéå†å’Œä¸­åºéå† è¾“å‡ºè¿™ä¸ªæ ‘\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t2.ç¿»è½¬é“¾è¡¨\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t3. æŠŠåªåŒ…å«è´¨å› å­2ã€3å’Œ5çš„æ•°ç§°ä½œä¸‘æ•°ã€‚ä¾‹å¦‚6ã€8éƒ½æ˜¯ä¸‘æ•°ï¼Œä½†14ä¸æ˜¯ï¼Œå› ä¸ºå®ƒåŒ…å«è´¨å› å­7ã€‚ ä¹ æƒ¯ä¸Šæˆ‘ä»¬æŠŠ1å½“åšæ˜¯ç¬¬ä¸€ä¸ªä¸‘æ•°ã€‚æ±‚æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºçš„ç¬¬Nä¸ªä¸‘æ•°ã€‚\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tç»™ä¸€ä¸ªç±»ä¼¼æ ‘çš„ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥æœ‰å¤šä¸ªèŠ‚ç‚¹ï¼ˆä¸æ­¢ä¸¤ä¸ªæ ‘ï¼‰ç„¶åæ¯ä¸ªæ ¹èŠ‚ç‚¹å’Œå­—èŠ‚ç‚¹é—´çš„è·¯å¾„ä¸ä¸€æ ·ï¼Œæ±‚å¶å­ç»“ç‚¹åˆ°å¶å­ç»“ç‚¹çš„æœ€å¤§è·¯å¾„\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåç«¯\té“¾è¡¨æ¯kä¸ªç¿»è½¬\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåç«¯\tåˆ¤æ–­å•é“¾è¡¨æœ‰æ²¡æœ‰ç¯ï¼Œæœ‰çš„è¯æ‰¾å…¥å£\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tå®‰å“\t. ç®—æ³•é¢˜ï¼šæ ¹æ®å‰ä¸­åºé‡æ„äºŒå‰æ ‘\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tå®‰å“\tç®—æ³•ï¼šèºæ—‹çŸ©é˜µ\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tç»™å®šmå’Œnï¼Œè¾“å‡ºä»1~nä¸­ä»»æ„å¤šä¸ªæ•°å­—ï¼Œä¸”å’Œä¸ºmuçš„ç»„åˆ(æ•°å­—ä¸èƒ½é‡å¤ä½¿ç”¨)\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•é¢˜(æ±‚ç¬¬nä¸ªä¸‘æ•°,leetcodeåŸé¢˜,éš¾åº¦mid)\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tç¬¬ä¸€é¢˜æ˜¯æ±‚å¼€æ ¹å·nçš„å€¼\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tç¬¬äºŒé¢˜æ˜¯è¾“å‡ºäº¤é”™åçš„é“¾è¡¨(æ¯”å¦‚é“¾è¡¨a-b-c-d-e,äº¤é”™åè¾“å‡ºä¸ºa-e-b-d-c)\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tåè½¬é“¾è¡¨\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tåå°\tæ‰¾å³°å€¼\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t1. æœ‰ä¸¤ä¸ªå•é“¾è¡¨ï¼Œå…¶æœ‰äº¤å‰èŠ‚ç‚¹ï¼Œæ±‚äº¤å‰èŠ‚ç‚¹ã€‚\t2020.07.16\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2. LRUç®—æ³•ï¼Œç»™ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œè‹¥LRUçš„çª—å£å¤§å°æ˜¯4ï¼Œæ±‚ä¸‹ä¸€ä¸ªå…ƒç´ è¿›æ¥åå‰”é™¤å“ªä¸ªå…ƒç´ ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t3. æ±‚æœ€å°å­æ•°ç»„ï¼Œleetcode209é¢˜ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2Nçš„æ ¼å­ 12çš„æ ¼å­å¡«æ»¡å®ƒæœ‰å¤šå°‘ç§æ–¹æ³•ï¼Œ ç»™ä¸ªæ•°ç»„ï¼Œæ‰¾å‡ºå³è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå¤§çš„å…ƒç´ ï¼Œ é“¾è¡¨ä¸¤ä¸¤åè½¬\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tåˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬nä¸ª\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå¤§æ•°æ®\tç®—æ³•é¢˜1: è¯·å¯¹3ä¸ªæœ‰åºæ•°ç»„è¿›è¡Œå½’å¹¶æ’åº\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå¤§æ•°æ®\tç®—æ³•é¢˜2: æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ€é•¿ä¸é‡å¤å­ä¸²çš„é•¿åº¦\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\tç»™å®šä¸€ä¸ªintæ•°ç»„Aï¼Œæ•°ç»„ä¸­å…ƒç´ äº’ä¸é‡å¤ï¼Œç»™å®šä¸€ä¸ªæ•°xï¼Œæ±‚æ‰€æœ‰æ±‚å’Œèƒ½å¾—åˆ°xçš„æ•°å­—ç»„åˆï¼Œç»„åˆä¸­çš„å…ƒç´ æ¥è‡ªAï¼Œå¯é‡å¤ä½¿ç”¨ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæ‰‹æ’•ä»£ç :Zå­—å‹éå†äºŒå‰æ ‘ï¼ˆå‰‘æŒ‡offeråŸé¢˜ï¼ŒLeetCodeç¬¬1553é¢˜ï¼‰\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\ttopk\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tjava\tæ‰‹æ’•å¹³æ–¹æ ¹\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tåè½¬é“¾è¡¨ï¼Ÿ\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ ä¸¤ä¸ª æ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜1ï¼šå¾ˆå¤§é‡çš„intå‹æ•°ï¼Œè¾“å‡ºå‰100æœ€å¤§çš„æ•°ï¼ˆä¸­ç­‰ï¼‰\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜2ï¼šå•å‘é“¾è¡¨ï¼Œå¤´å°¾å¥‡å¶äº¤æ›¿è¾“å‡ºï¼ˆä¸­ç­‰ï¼‰\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå•é“¾è¡¨åè½¬\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå¹³è¡¡äºŒå‰æœç´¢æ ‘æ’å…¥ç®—æ³•\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2. ä¸€ä¸ªäºŒå‰æ ‘ï¼Œ æ±‚è·¯å¾„ä¹‹å’Œã€‚ã€‚ã€‚ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•ï¼šæ·éª°å­èµ°è·¯ï¼Œ1ï½6ï¼Œç»™å®šçš„è¾“å…¥nï¼Œèµ°åˆ°ç¬¬nä¸ªæ ¼å­æœ‰å¤šå°‘ç§èµ°æ³•\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•ï¼šé’è›™è·³æ ¼å­ï¼Œæ•°ç»„é‡Œå…ƒç´ è¡¨ç¤ºè¯¥ä½ç½®çŸ³å¤´ä¸ªæ•°ï¼Œæ¯æ¬¡è·³3-5æ ¼ï¼Œé—®è·³å‡ºæ•°ç»„æœ€å°‘è¸©å¤šå°‘çŸ³å¤´ã€‚\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•ï¼šç»™å®šé“¾è¡¨å’Œkï¼Œè¦æ±‚æ¯kä¸ªå…ƒç´ ç¿»è½¬ä¸€æ¬¡\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tè®¡ç®—æœºè§†è§‰å·¥ç¨‹å¸ˆ\tåšé“é¢˜å§ï¼ŒLeetCode4ï¼šä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ä¸­ä½æ•°\t2020.07.15\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•ï¼šæ‰¾å‡ºæ•°ç»„é‡Œå‡ºç°æ¬¡æ•°å¤§äºn/kçš„æ•°\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•åˆ¤æ–­æ ‘æ˜¯å¦å¯¹ç§°ï¼Œç”¨bfsåšäº†\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t11.æ‰‹æ’•ä»£ç ï¼š1ï¼‰ç»™å®šæ•°ç»„ï¼Œæ±‚è¿ç»­å­ä¸²çš„æœ€å¤§å’Œ\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2ï¼‰ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t10.æ‰‹æ’•ä»£ç ï¼š1ï¼‰ç»™å®šä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹éƒ½æ˜¯é€’å¢çš„ï¼ŒæŸ¥æ‰¾æŸä¸ªå…ƒç´ \t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2ï¼‰ç»™å®šä¸€ä¸ªçŸ©é˜µï¼Œæ¯æ¬¡åªèƒ½å‘å³æˆ–å‘ä¸‹èµ°ï¼Œä»å·¦ä¸Šè§’å¼€å§‹åˆ°å³ä¸‹è§’ä¸€å…±æœ‰å¤šå°‘ç§èµ°æ³•\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tï¼Œç¬¬ä¸€é¢˜å°±æ˜¯ç»™ä¸€ä¸ªçŸ©é˜µï¼Œä»å³ä¸Šè§’å¾€å·¦ä¸‹è§’ä¸€å±‚ä¸€å±‚æ–œç€éå†ï¼Œç±»ä¼¼äºè¿™æ ·ï¼š\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tå±‚æ¬¡éå†äºŒå‰æ ‘\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tleetcode 236\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tleetcode 62ï¼Œ\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\t1.ç»™ä¸€ä¸ªæ­£æ•´æ•°ï¼Œè¡¨ç¤ºæˆä¸€ä¸ªæˆ–å¤šä¸ªä¸åŒçš„æ­£æ•´æ•°çš„å’Œï¼Œè¾“å‡ºæ‰€æœ‰çš„è§£å†³æ–¹æ¡ˆï¼ˆæ·±æœï¼Œä½†æ˜¯æˆ‘å®ç°çš„æ—¶å€™å†™çš„ä¸å¥½ï¼‰\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\t2.ç»™ä¸€ä¸ªn*nçš„æ–¹é˜µï¼Œèºæ—‹å¡«å…¥æ•°å­—\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tandroid\tï¼ˆæ‰‹æ’•ï¼‰1ï¼š[2,3] è¡¨ç¤º å­©å­å’Œçˆ¶æ¯ã€‚è¾“å…¥ä¸€ç»„è¿™æ ·çš„æ•°æ®ï¼Œ ç»™ä¸¤ä¸ªæ•°ï¼Œé—®æ˜¯å¦æœ‰å…±åŒç¥–å…ˆã€‚\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\tåŠ›æ‰£ 124.\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç¬¬äºŒé¢˜ï¼šäºŒå‰æ ‘çš„å·¦è§†å›¾\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåå°\tç¬¬ä¸€é¢˜ï¼Œä¸€ä¸ªintæ•°ç»„ï¼Œæ‰¾å‡ºä¸¤ä¸ªå¼‚æˆ–æœ€å¤§çš„æ•°å­—ï¼Œæ—¶é—´è¦æ±‚O(n)\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåå°\tç¬¬äºŒé¢˜ï¼Œå››ä¸ªintæ•°ç»„ï¼Œä»æ¯ä¸ªæ•°ç»„é‡Œè¾¹æŒ‘ä¸€ä¸ªæ•°ï¼ŒåŠ èµ·æ¥ç­‰äºæŒ‡å®šæ•°ï¼Œè¦æ±‚æ‰“å°å‡ºæ‰€æœ‰éé‡å¤çš„ç»„åˆï¼Œè¦æ±‚æœ€å¤§n2ã€‚\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tjava\tä»£ç é¢˜ï¼šä¸å«é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²ï¼ˆleetcodeåŸé¢˜ï¼‰\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2.æœ€é•¿ä¸Šå‡å­åºåˆ—çš„çŠ¶æ€è½¬ç§»,æ—¶é—´å¤æ‚åº¦\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç»™å‡ºå‰åºå’Œä¸­åºæ•°ç»„,ç”Ÿæˆååºæ•°ç»„\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\t11.ç®—æ³•é¢˜ï¼šç»™ä¸€æ£µäºŒå‰æ ‘å’Œä¸€ä¸ªæ•´æ•°ï¼Œè¦æ±‚è¾“å‡ºäºŒå‰æ ‘ä¸­è·¯å¾„å’Œç­‰äºè¿™ä¸ªæ•´æ•°çš„è·¯å¾„ï¼Œå¦‚\t2020.07.14\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1ã€‚ç®—æ³•é¢˜ï¼Œä¸¤ä¸ªé“¾è¡¨äº†ç±»å‹çš„æ•´æ•°æ±‚å’Œï¼Œå¦‚1-\u0026gt;2-\u0026gt;5ä¸3-\u0026gt;6æ±‚å’Œå¾—åˆ°1-\u0026gt;4-\u0026gt;1ã€‚ç”¨æ ˆæˆ–è€…åè½¬é“¾è¡¨\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼šæ‰¾æ³¢è°·æ•°ï¼›\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼šå¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„å•å‘é“¾è¡¨ï¼›\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\t14. ç®—æ³•é¢˜ï¼šæ‰¾åˆ°ä¸¤ä¸ªé“¾è¡¨çš„å…¬å…±èŠ‚ç‚¹\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1. ç»™å®šä¸¤ä¸ªå•é“¾è¡¨ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å…¬å…±èŠ‚ç‚¹\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\t3. æ±‚å­—ç¬¦æ•°ç»„çš„å…¨æ’åˆ—ï¼ˆç”¨çš„äº¤æ¢çš„æ–¹å¼ï¼Œä½†æ˜¯é¢è¯•å®˜é—®æ€è·¯å´æœ‰ç‚¹ç´§å¼ ï¼Œæ²¡å›ç­”å¥½ï¼Œç„¶åä»–é—®æˆ‘leetcodeåˆ·äº†å¤šå°‘é“é¢˜ï¼Œå…«æˆè®¤ä¸ºæˆ‘æ˜¯ç›´æ¥èƒŒçš„é¢˜äº†ï¼Œéš¾å—ï¼‰\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæŸ¥æ‰¾æœ‰åºæ•°ç»„ä¸­ä¸€ä¸ªç›®æ ‡å€¼å‡ºç°çš„ç¬¬ä¸€æ¬¡ä½ç½®ï¼Œæ²¡æœ‰æ‰¾åˆ°è¿”å› -1\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\t5. ç®—æ³•ï¼šæ»‘åŠ¨çª—å£å¯»æ‰¾æ»¡è¶³çš„å­—ç¬¦ä¸²\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tçˆ¬æ¥¼æ¢¯\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tleetcode 93 æ²¡å†™å‡ºæ¥ã€‚ã€‚é¢è¯•å®˜è¯´æˆ‘æ€ç»ªæ··ä¹± å¯¼è‡´åé¢è„‘å­ç©ºç™½\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\täºŒå‰æ ‘å±‚åºéå†\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tè¯´æ€è·¯ï¼šå®ç°ä¸€ä¸ªæ ˆï¼Œo(1)æ—¶é—´æ‰¾æœ€å¤§å€¼\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå†™ä»£ç ï¼šçŸ©é˜µä»å·¦ä¸Šåˆ°å³ä¸‹æ‰¾æœ€å°è·¯å¾„\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tè¯´æ€è·¯ï¼šåˆ é™¤å•é“¾è¡¨çš„å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tç¼–ç¨‹ï¼šåˆ¤æ–­ä¸¤ä¸ªé“¾è¡¨æ˜¯å¦ç›¸äº¤å¹¶è¿”å›äº¤ç‚¹ï¼›\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tä»£ç ï¼šæ— é‡å¤æœ€é•¿å­—ä¸²\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t10ã€ç®—æ³•ï¼šæ±‚æ•°ç»„ä¸­å‡åºçš„å­åºåˆ—\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t11ã€ç®—æ³•ï¼šä¸¤ä¸ªé“¾è¡¨æ‰¾å…¬å…±èŠ‚ç‚¹\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tMerge ä¸¤ä¸ªæœ‰åºçš„é“¾è¡¨\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\t1. å¦‚ä½•ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ï¼Ÿå¦‚ä½•ä¼˜åŒ–å‰é¢è¯´çš„é‚£ç§æ€è·¯ï¼Ÿ\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\t2. ç¼–ç¨‹é¢˜ï¼šä¸Šå°é˜¶(é‚£ä¸ªç®€å•çš„fabonacci)ç„¶åå°±åˆæ¥äº†ä¸€é“\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\t3. ç¼–ç¨‹é¢˜ï¼šåŒºé—´åˆå¹¶æ±‚å¹¶é›†\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\tç®—æ³•é¢˜ï¼šè¿ç»­å­æ•°ç»„çš„æœ€å¤§å’Œ\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\t1. äºŒåˆ†æŸ¥æ‰¾åœ¨å‡åºæ•°ç»„ä¸­æ‰¾å‡ºç»å¯¹å€¼æœ€å°çš„é‚£ä¸ªæ•°\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tios\t2. 8ä¸ªæ¡¶(æ¯ä¸ªæ¡¶åªèƒ½æ”¾ä¸€ä¸ªçƒ)ï¼Œ5ä¸ªçƒï¼Œä¸‰ä¸ªè¿ç»­çš„æƒ…å†µæœ‰å‡ ç§ã€‚ä¸€èˆ¬æƒ…å†µä¸‹å‘¢\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tmerge k list\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tLeetCode 25. Kä¸ªä¸€ç»„åè½¬é“¾è¡¨\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tLeetCode 53.æœ€å¤§å­åºå’Œ\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tç»™å®šä¸€ä¸ªåŒ…å«å¤§å†™è‹±æ–‡å­—æ¯å’Œæ•°å­—çš„å¥å­ï¼Œæ‰¾å‡ºè¿™ä¸ªå¥å­æ‰€åŒ…å«çš„æœ€å¤§çš„åå…­è¿›åˆ¶æ•´æ•°ï¼Œè¿”å›è¿™ä¸ªæ•´æ•°çš„å€¼ã€‚æ•°æ®ä¿è¯è¯¥æ•´æ•°åœ¨intè¡¨ç¤ºèŒƒå›´å†…ã€‚\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\t01çŸ©é˜µæœ€å¤§æ­£æ–¹å½¢,ç»å…¸é¢˜äº†,dpé€‰å·¦ä¸Šæœ€å°+1,éšä¾¿å†™äº†ä¸€ä¸‹,æ²¡è®©è·‘test.\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\täºŒå‰æ ‘æ‰¾targetè·¯å¾„\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\täºŒå‰æ ‘è½¬å•é“¾è¡¨,å¸¸è§„é¢˜,é€’å½’ä¸€ä¸‹å®Œäº‹äº†.\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼šä»å·¦ä¸Šè§’èµ°åˆ°å³ä¸‹è§’æœ‰å¤šå°‘ç§ä¸åŒçš„è·¯çº¿\t2020.07.13\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\t10.leetcode å¥‡å¶é“¾è¡¨\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\täºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\tåè½¬å­—ç¬¦ä¸²\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæ¸¸æˆå®¢æˆ·ç«¯\tå­—ç¬¦ä¸²æ•°ç»„ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€å°è·ç¦»ï¼ˆeasyï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæ¸¸æˆå®¢æˆ·ç«¯\tåšé¢˜ï¼Œæ•°ç»„ä¸­å’Œæœ€å¤§çš„è¿ç»­å­æ•°ç»„ï¼ˆmidï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t189. æ—‹è½¬æ•°ç»„\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæ¸¸æˆå®¢æˆ·ç«¯\tæ‰‹æ’• æ— åºæ•°ç»„ä¸¤æ•°ä¹‹å’Œ\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæ¸¸æˆå®¢æˆ·ç«¯\tæ‰‹æ’•ä»£ç  ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæ¸¸æˆå®¢æˆ·ç«¯\tæ‰‹æ’•ä»£ç  å®ç°æ´—ç‰Œç®—æ³•\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\täºŒå‰æ ‘å­è·¯å¾„å’Œä¸ºkçš„è·¯å¾„ä¸ªæ•°\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t1. æ±‚å’Œä¸ºkçš„å­æ•°ç»„ä¸ªæ•°\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t2. åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸ªæ•°è¶…è¿‡æ•°ç»„é•¿åº¦ä¸€åŠçš„æ•°\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t10ã€ç®€åŒ–è·¯å¾„ï¼ˆç®—æ³•æï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t11ã€äºŒå‰æ ‘çš„å³è§†å›¾ï¼ˆç®—æ³•é¢˜ï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tandriod\tä»£ç é¢˜ï¼šæ—‹è½¬æ•°ç»„\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tandriod\tä»£ç é¢˜ï¼šä¸¤æ•°ç›¸åŠ ï¼ˆé“¾è¡¨ï¼Œè¦æ±‚åŸåœ°å®ç°ï¼Œç©ºé—´å¤æ‚åº¦O(1)ï¼Œè¿™ä¸ªçŠ¯è ¢æ’•äº†å¥½ä¹…ç»“æœè¿˜æ˜¯é å¼ºè¡Œæ‰“å°å‘ç°çš„é—®é¢˜ï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tandriod\tä»£ç é¢˜ï¼ša) èºæ—‹éå†çŸ©é˜µ\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tandriod\tï¼›b)ï¼ˆå˜ç§ï¼‰åŸåœ°æ—‹è½¬å›¾åƒ\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\tç®—æ³•é¢˜ åè½¬é“¾è¡¨ï¼ˆç™½ç»™ï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\tä¸¤ä¸ªæœ‰åºé“¾è¡¨åˆå¹¶\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç»™å®š2DçŸ©é˜µï¼Œæ±‚é‡Œé¢1æ„æˆçš„æ­£æ–¹å½¢çš„æœ€å¤§é¢ç§¯ã€‚\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼šæ¥é›¨æ°´\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t14.æ‰¾å‡ºä¸¤ä¸ªé“¾è¡¨çš„äº¤å‰ç‚¹ï¼ˆ\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t10.æ‰‹æ’•ä»£ç ï¼šä»æ— åºæ•°ç»„ä¸­æ‰¾åˆ°å³è¾¹ç¬¬ä¸€ä¸ªå¤§çš„æ•°ï¼ˆä¸leetcode 739 æ¯æ—¥ä½“æ¸©ç±»ä¼¼ï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t22.æŠ›ç¡¬å¸ï¼ˆä¸€ä¸ª0.3 ä¸€ä¸ª0.7 å¦‚ä½•ä¿è¯å…¬å¹³ï¼‰\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t23 zå­—å½¢æ‰“å°äºŒå‰æ ‘\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t- ä¸€é¢—æœç´¢äºŒå‰æ ‘æœ‰ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯é¢ å€’çš„ï¼Œæ¢å¤æˆæ­£ç¡®çš„\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t- å•é“¾è¡¨é«˜ä½åœ¨å‰ã€ä½ä½åœ¨åï¼Œå¤§æ•°è®¡ç®—\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t- é˜¶ä¹˜\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tåç«¯\t- ä¸€ä¸ªæœ‰åºã€æœ‰é‡å¤å…ƒç´ æ•°ç»„æ‰¾åˆ°æœ‰å¤šå°‘æ»¡è¶³ a + b = targetçš„\t2020.07.12\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t1.æ–æ³¢é‚£å¥‘ é€’å½’å®ç°/dpå®ç°/ç©ºé—´ä¼˜åŒ–\t2020.07.11\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t. ç®—æ³•é¢˜ æ‰¾å‡ºsumå¤§äºç­‰äºtargetçš„æœ€çŸ­è¿ç»­æ•°ç»„çš„é•¿åº¦ è¦é€šè¿‡æ‰€æœ‰æµ‹è¯•æ•°æ® ï¼ˆæ‰¾bugæ‰¾åŠå¤©ï¼Œé¢è¯•å®˜ä¸€ç›´æ¸©æŸ”çš„è¯´åˆ«ç€æ€¥å“ˆå“ˆï¼‰\t2020.07.11\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t10.ä»£ç :é“¾è¡¨çš„é€†åºè¾“å‡º\t2020.07.11\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t11.ä»£ç :åˆ¤æ–­å›æ–‡\t2020.07.11\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\tä¸¤ä¸¤åè½¬é“¾è¡¨\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\tç®—æ³•ï¼šåˆ¤æ–­ä¸¤ä¸ªé“¾è¡¨æ˜¯å¦ç›¸äº¤\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tC++å®¢æˆ·ç«¯\tç®—æ³•ï¼šæŸ¥æ‰¾äºŒå‰æ ‘ä¸­ä¸¤ä¸ªèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t7.ç®—æ³•ï¼šåˆå¹¶æœ‰åºæ•°ç»„\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t12 ç®—æ³•ï¼šé€†åºè¾“å‡ºæ•°å­—ã€‚\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæ‰‹æ’•ï¼šå±‚åºéå†\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\täºŒå‰æ ‘ä¸­åºéå†\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæ‰‹æ’• lru\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tç¬¬Kå¤§ä¸ªæ•°\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\té“¾è¡¨æ‰¾ç¯\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tåˆå¹¶æ•°ç»„\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç¼–ç¨‹é¢˜ï¼šå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°ï¼Œleetcodeç¬¬67é¢˜\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\t3 sum\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tå­—ç¬¦ä¸²åè½¬\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå…ˆé—®ä¸¤ä¸ªæ— åºæ•°ç»„æ€ä¹ˆæ‰¾äº¤é›†ã€‚\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰‹æ’•æ•°ç»„A-æ•°ç»„B\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰‹æ’•æ—‹è½¬çŸ©é˜µ90åº¦\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tc++ã€\tæ‰‹æ’•ä»£ç  æ±‚mä¸ªæ•°ä¸­æœ€å¤§çš„nä¸ªæ•°\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\t7.æ‰‹æ’•ä»£ç ï¼Œä¸€é“æ—‹è½¬é“¾è¡¨çš„é¢˜ç›®ï¼Œleetcode easyæ°´å¹³\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\t8.æ‰‹æ’•ä»£ç ï¼Œä¸€é“çŸ©é˜µç›¸ä¹˜ï¼Œä¹Ÿå¾ˆç®€å•ã€‚\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œæ±‚è¿ç»­å­åºåˆ—ä¹˜ç§¯ä¸ºå®Œå…¨å¹³æ–¹æ•°çš„æœ€å¤§é•¿åº¦\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tåˆ¤æ–­ç»™å®šåºåˆ—æ˜¯å¦ä¸ºäºŒå‰æœç´¢æ ‘çš„å‰åºéå†\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tç®—æ³•é¢˜ï¼šæ•°ç»„å»é‡\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tçˆ¬æ¥¼æ¢¯\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tç®—æ³•é¢˜ï¼Œæœ€é•¿è¿ç»­ç›¸åŒå­—ç¬¦çš„å­ä¸²\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\tå†™ä¸ªé¢˜ï¼Œæ¯Kä¸ªèŠ‚ç‚¹ç¿»è½¬é“¾è¡¨\t2020.07.10\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1.åŸé¢˜ï¼Œå­—ç¬¦ä¸²å…¨æ’åˆ—\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2.åŸé¢˜ï¼ŒäºŒå‰æ ‘çš„æœ€å¤§è·¯å¾„å’Œ\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1ã€ç±»ä¼¼äºå¹¶æŸ¥é›†çš„é—®é¢˜ï¼Œæœ€ç»ˆæ±‚è¿é€šåˆ†é‡çš„æ•°é‡\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tç®—æ³•é¢˜ é•œåƒäºŒå‰æ ‘\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tç®—æ³•é¢˜ï¼š leetcode1636\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæˆ‘ä¸€é“leetcode 32\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæˆ‘ä¸€é“leetcode 1\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tLeetCode 20 æœ‰æ•ˆçš„æ‹¬å·\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tå¹³è¡¡äºŒå‰æ ‘\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tï¼ŒäºŒå‰æ ‘éå†\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tå›æ–‡ä¸²åˆ¤æ–­\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\täºŒå‰æœç´¢æ ‘è½¬é“¾è¡¨\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\täºŒå‰æ ‘æ±‚å’Œleetcode129-è®²ä¸€ä¸‹æ—¶é—´å¤æ‚åº¦\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\t1ï¼‰æ±‚é“¾è¡¨çš„å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tï¼ˆ2ï¼‰åºåˆ—åŒ–å’Œååºåˆ—åŒ–äºŒå‰æ ‘\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tï¼ˆ3ï¼‰æ±‚æ•°ç»„çš„æå€¼ç‚¹ï¼Œæ‰¾å‡ºä¸€ä¸ªæ»¡è¶³çš„å°±è¡Œï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tå‰åºéå†å’Œä¸­åºéå†é‡æ„äºŒå‰æ ‘ ï¼ˆä¸ç»™ç”¨HashMap å¥½åœ¨åšå‡ºæ¥äº†ï¼‰\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•é¢˜ï¼šåˆ¤æ–­å›æ–‡é“¾è¡¨ï¼ˆä¸­é—´æ‹†åˆ†ä¸¤æ¡é“¾è¡¨ åé¢çš„åè½¬é“¾è¡¨ å¯¹æ¯”æ•°å€¼æ˜¯å¦ç›¸ç­‰ï¼‰\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•é¢˜ï¼šå¥‡æ•°ä½å‡åºå¶æ•°ä½é™åºçš„é“¾è¡¨è¦æ±‚æ—¶é—´O(n)ç©ºé—´O(1)çš„æ’åºï¼Ÿï¼ˆå¥‡å¶æ‹†åˆ† å¶é“¾åè½¬ å½’å¹¶mergeï¼‰\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæ‰‹æ’•ä»£ç ï¼šæ±‚ä¸€ä¸ªæ•°ç»„çš„æ‰€æœ‰å­é›†\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæ‰‹æ’•ä»£ç ï¼šé©¼å³°æ•°ç»„æœ€å¤§å€¼\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\té—®äº†ä¸€é“é“¾è¡¨åè½¬ï¼›\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t1ã€åŠ›æ‰£åŸé¢˜113 è·¯å¾„ç»¼åˆ\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2ã€ç»™å®šä¸€ä¸ªå‡åºæ•°ç»„ï¼Œå¯èƒ½ä¼šæœ‰é‡å¤çš„æ•°å­—ï¼Œå°†æ•°ç»„é‡Œçš„æ•°å¹³æ–¹åï¼Œæœ‰å¤šå°‘ä¸åŒçš„æ•°ã€‚\t2020.07.09\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\täºŒå‰æ ‘æ‰€æœ‰æ ¹åˆ°å¶å­èŠ‚ç‚¹è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹ï¼Œç»„æˆçš„æ•°å­—ä¹‹å’Œ\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tåç«¯\tæ‰‹æ’•ä»£ç ï¼šé“¾è¡¨åŠ æ³•\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰‹å†™ç®—æ³•ï¼šé“¾è¡¨åˆå¹¶\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰‹å†™ç®—æ³•ï¼šåˆ¤æ–­ä¸€æ£µæ ‘æ˜¯å¦æ˜¯é•œåƒæ ‘\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t8ã€ ç®—æ³•é¢˜ï¼šåˆ¤æ–­ç»™å®šçš„ä¸€é¢—æ ‘æ˜¯å¦æ˜¯ äºŒå‰æŸ¥æ‰¾æ ‘\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t9ã€ç®—æ³•é¢˜ï¼šç»™å®šä¸€ä¸ªæ•°å­—æ•°ç»„ï¼ŒåŠæ•°å­—å‡ºç°æ¬¡æ•°ï¼Œ\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tå¦‚ä½•åˆ¤æ–­ä¸€é¢—æ ‘æ˜¯å¦æ˜¯å®Œå…¨äºŒå‰æ ‘\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tlru\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tios\tç®—æ³•é¢˜ï¼šæ±‚kå¤§æ•°\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tios\tleetcode1 ä¸¤æ•°ä¹‹å’Œ\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tios\tå‰‘æŒ‡offer 62 åœ†åœˆä¸­å‰©ä¸‹çš„æ•°å­—ï¼ˆçº¦ç‘Ÿå¤«ç¯é—®é¢˜ï¼‰\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tios\tleetcode 41 ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\tè¾“å‡ºæ•°ç»„ç¬¬kå¤§å…ƒç´ \t2020.07.08\nå­—èŠ‚è·³åŠ¨\tæœåŠ¡ç«¯\tæ‹¬å·åŒ¹é…\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tåç«¯\té“¾è¡¨çš„ä¸¤ä¸¤ç¿»è½¬\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tåç«¯\tLRu\t2020.07.08\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tç®—æ³•ï¼šè¿”å›ä¸€æ£µæ ‘çš„æœ€å¤§å¶èŠ‚ç‚¹è·ç¦»\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tå¯¹å«æœ‰é‡å¤æ•°å­—çš„æ•°ç»„å»é‡å¹¶æ’åºï¼Œæ‰‹æ’•å¿«æ’\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tç®—æ³•:ä¸¤ä¸ªå¤§æ•°å­—ç¬¦ä¸²æ±‚å’Œè¾“å‡ºå­—ç¬¦ä¸²\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tlru\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\tä¸€é¢ï¼šæœ€å¤§è¿ç»­å­åºåˆ—å’Œå’Œå›æ–‡é“¾è¡¨\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\täºŒé¢ï¼šä¸€ä¸ªå¥‡æ•°ä½å‡åºã€å¶æ•°ä½é™åºçš„å•å‘æ— ç¯é“¾è¡¨ï¼Œæ’æˆä¸€ä¸ªæœ‰åºé“¾è¡¨\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\tä¸‰é¢ï¼šSå‹æ‰“å°äºŒå‰æ ‘ï¼Œä¸¤æ¡å•å‘é“¾è¡¨çš„ç›¸äº¤èŠ‚ç‚¹ï¼Œä»»æ„æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªç¼ºå¤±çš„æ­£æ•´æ•°\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tå­—ç¬¦ä¸²åè½¬\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tæ¥ä¸ªç®€å•çš„â€”ç¬¬ä¸€é¢˜ï¼šæ±‚äºŒå‰æ ‘æœ€å¤§é•¿åº¦\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\tç¬¬äºŒé¢˜ï¼šç”¨Stringå­˜ä¸¤ä¸ªå¾ˆé•¿çš„æ•°ï¼Œæ±‚å’Œ\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1. ç¬¬ä¸€é¢˜ åˆ¤æ–­æ˜¯å¦å›æ–‡é“¾è¡¨\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2. ç¬¬äºŒé¢˜ æ±‚é€†æ•°å¯¹\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t3.ç¬¬ä¸‰é¢˜ åŠ¨æ€è§„åˆ’\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1.ç¬¬ä¸€é¢˜ æœ€å¤§åŒ–è‚¡ç¥¨äº¤æ˜“\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2.ç¬¬äºŒé¢˜ æœ€å¤§åŒ–è‚¡ç¥¨äº¤æ˜“ï¼ˆæœ‰é™äº¤æ˜“ï¼‰\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰‹æ’•ä»£ç  åè½¬é“¾è¡¨ã€‚\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t7.ä»£ç ï¼šé©¼å³°å­—ç¬¦ä¸²é—®é¢˜\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåå°\tç®—æ³•é¢˜ï¼šæ»‘åŠ¨çª—å£åŒ¹é…å­—ç¬¦ä¸²\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå‰ç«¯\t1. å®ç°æ–æ³¢çº³è¥¿æ•°åˆ—ï¼ˆ\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tä¸€ä¸ªlistï¼Œä¸€ä¸ªtargetï¼Œæ±‚listä¸­ä¸¤æ•°ä¹‹å’Œç­‰äºtargetçš„æ‰€æœ‰ç»„åˆï¼Œlistä¸­æœ‰é‡å¤çš„ï¼Œç®—mediumå§ã€‚\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\t1. Leetcode124\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\tè¡¥å……ï¼š8. å¤§æ•°é—®é¢˜ä¸­çš„topKé—®é¢˜\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\tè¡¥å……ï¼š9. ç»™æ•´æ•°æ•°ç»„åšæ•°å­—æ¬¡æ•°ç»Ÿè®¡ï¼Œç­”unordered_mapï¼Œè®©æˆ‘å†æƒ³å…¶ä»–æ–¹æ³•ï¼Œä¸ä¼šã€‚\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t1.ç»™ä½ ä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ªtargetï¼Œæ‰¾å‡ºå’Œæ˜¯targetæ•´æ•°å€çš„è¿ç»­å­ä¸²\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\t2.ä¸€ä¸ªæ‹¬å·å­—ç¬¦ä¸²ï¼Œæ‰¾å‡ºæœ€é•¿åˆæ³•é•¿åº¦ï¼ˆå†™å®Œäº†ï¼Œä¼˜åŒ–ä¸€ä¸‹ï¼Œä¼˜åŒ–äº†ï¼‰\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tç®—æ³•\tå­åºæœ€å¤§å’Œï¼ˆè¦æ±‚å­åºåˆ—é•¿åº¦å¤§äºç­‰äºkï¼‰\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tåç«¯\tLC128\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\tæ‰¾é“¾è¡¨äº¤ç‚¹ï¼Œ\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t1. åˆ¤æ–­äºŒå‰æ ‘æ˜¯å¦é•œåƒ\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t2. ç»™ä¸€ä¸ªåˆ†æ•°n/mï¼Œå¦‚æœè¿™ä¸ªåˆ†æ•°æ˜¯æ— çº¿å¾ªç¯å°æ•°ï¼Œæ‰¾å‡ºå¾ªç¯ä½ã€‚\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t3. I am student è¿”å› student am I\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tå®¢æˆ·ç«¯\t6.å…ˆå‡åé™æ•°ç»„ï¼Œæ‰¾å³°å€¼çš„åæ ‡ï¼ŒäºŒåˆ†æ³•\t2020.07.07\nå­—èŠ‚è·³åŠ¨\tæµ‹è¯•\t5. æ’•ä»£ç ç¯èŠ‚ï¼šé¢˜ç›®ä¸ºleetcodeç¬¬ä¸‰é¢˜ï¼Œæ±‚æœ€é•¿è¿ç»­ä¸å«é‡å¤å­—ç¬¦å­ä¸²\t2020.07.07\n","description":"","id":14,"section":"talks","tags":[""],"title":"Leetcodeé«˜é¢‘","uri":"https://hugo.jiahongw.com/zh/talks/leetcode-hot/"},{"content":"æè¿°ç¬¦çš„å°±ç»ªçŠ¶æ€æœ‰ä¸¤ç§åˆ¤æ–­æ–¹æ³•: è¾¹æ²¿è§¦å‘å’Œæ°´å¹³è§¦å‘ã€‚\næ°´å¹³è§¦å‘\næˆ‘è®¤ä¸ºè¿™æ˜¯â€œæ‹‰â€æ¨¡å¼æˆ–â€œæ°‘æ„è°ƒæŸ¥â€æ¨¡å¼ã€‚ä¸ºäº†ç¡®å®šæè¿°ç¬¦æ˜¯å¦å°±ç»ªï¼Œè¿›ç¨‹å°è¯•æ‰§è¡Œéé˜»å¡ I/O æ“ä½œã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥å¤šæ¬¡æ‰§è¡Œè¿™æ ·çš„æ“ä½œã€‚è¿™å…è®¸åœ¨å¤„ç†ä»»ä½•åç»­ I/O æ“ä½œæ–¹é¢æœ‰æ›´å¤§çš„çµæ´»æ€§ãƒ¼ä¾‹å¦‚ï¼Œå¦‚æœæè¿°ç¬¦å·²ç»å‡†å¤‡å¥½ï¼Œè¿›ç¨‹å¯ä»¥é€‰æ‹©è¯»å–æ‰€æœ‰å¯ç”¨çš„æ•°æ®æˆ–è€…æ ¹æœ¬ä¸æ‰§è¡Œä»»ä½• I/O æ“ä½œï¼Œæˆ–è€…é€‰æ‹©ä¸è¯»å–ç¼“å†²åŒºä¸­æ‰€æœ‰å¯ç”¨çš„è¾“å…¥æ•°æ®ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚\nåœ¨ t0æ—¶ï¼Œè¿›ç¨‹å¯ä»¥åœ¨éé˜»å¡æè¿°ç¬¦ä¸Šå°è¯• I/O æ“ä½œã€‚å¦‚æœ I/O æ“ä½œé˜»å¡ï¼Œç³»ç»Ÿè°ƒç”¨å°†è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚\nç„¶ååœ¨ t1æ—¶ï¼Œè¿›ç¨‹å¯ä»¥å†æ¬¡å°è¯•åœ¨æè¿°ç¬¦ä¸Šè¿›è¡Œ I/Oã€‚å‡è®¾è°ƒç”¨å†æ¬¡é˜»å¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚\nç„¶ååœ¨æ—¶é—´ t2ï¼Œè¿›ç¨‹å†æ¬¡å°è¯•æè¿°ç¬¦ä¸Šçš„ I/Oã€‚å‡è®¾è°ƒç”¨å†æ¬¡é˜»å¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚\nå‡è®¾åœ¨ t3æ—¶ï¼Œè¿›ç¨‹è½®è¯¢æè¿°ç¬¦çš„çŠ¶æ€ï¼Œæè¿°ç¬¦å°±ç»ªã€‚ç„¶åè¿›ç¨‹å¯ä»¥é€‰æ‹©å®é™…æ‰§è¡Œæ•´ä¸ª I/O æ“ä½œ(ä¾‹å¦‚ï¼Œè¯»å–å¥—æ¥å­—ä¸Šçš„æ‰€æœ‰å¯ç”¨æ•°æ®)ã€‚\nè®©æˆ‘ä»¬å‡è®¾åœ¨ t4æ—¶è¿›ç¨‹è½®è¯¢æè¿°ç¬¦çš„çŠ¶æ€ï¼Œè€Œæè¿°ç¬¦æ²¡æœ‰å‡†å¤‡å¥½ã€‚è°ƒç”¨å†æ¬¡é˜»å¡ï¼Œå¹¶ä¸” I/O æ“ä½œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚\nå‡è®¾åœ¨ t5æ—¶ï¼Œè¿›ç¨‹è½®è¯¢æè¿°ç¬¦çš„çŠ¶æ€ï¼Œæè¿°ç¬¦å°±ç»ªã€‚è¿›ç¨‹éšåå¯ä»¥é€‰æ‹©åªæ‰§è¡Œéƒ¨åˆ† I/O æ“ä½œ(ä¾‹å¦‚ï¼Œåªè¯»å–æ‰€æœ‰å¯ç”¨æ•°æ®çš„ä¸€åŠ)ã€‚\nâ€‹\tå‡è®¾åœ¨ t6æ—¶ï¼Œè¿›ç¨‹è½®è¯¢æè¿°ç¬¦çš„çŠ¶æ€ï¼Œæè¿°ç¬¦å°±ç»ªã€‚è¿™ä¸€æ¬¡ï¼Œè¿›ç¨‹å¯ä»¥é€‰æ‹©æ ¹æœ¬ä¸æ‰§è¡Œåç»­çš„ I/Oã€‚\nè¾¹ç¼˜è§¦å‘ æµç¨‹åªæœ‰åœ¨æ–‡ä»¶æè¿°ç¬¦â€œå°±ç»ªâ€æ—¶æ‰ä¼šæ”¶åˆ°é€šçŸ¥(é€šå¸¸æ˜¯åœ¨æ–‡ä»¶æè¿°ç¬¦ä¸Šæœ‰ä»»ä½•æ–°æ´»åŠ¨æ—¶ï¼Œå› ä¸ºå®ƒæ˜¯ä¸Šæ¬¡è¢«ç›‘è§†çš„)ã€‚æˆ‘è®¤ä¸ºè¿™å°±æ˜¯â€œæ¨é€â€æ¨¡å‹ï¼Œå› ä¸ºé€šçŸ¥è¢«æ¨é€åˆ°è¿›ç¨‹ä¸­ï¼Œè¯´æ˜æ–‡ä»¶æè¿°ç¬¦çš„å‡†å¤‡å°±ç»ªæƒ…å†µã€‚æ­¤å¤–ï¼Œå¯¹äº push æ¨¡å‹ï¼Œåªé€šçŸ¥è¿›ç¨‹è¯´æè¿°ç¬¦å·²ç»ä¸º I/O å‡†å¤‡å¥½äº†ï¼Œè€Œä¸æä¾›å…¶ä»–ä¿¡æ¯ï¼Œä¾‹å¦‚åˆ°è¾¾ socket ç¼“å†²åŒºçš„å­—èŠ‚æ•°ã€‚\nå› æ­¤ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹è¯•å›¾æ‰§è¡Œä»»ä½•åç»­ I/O æ“ä½œæ—¶ï¼Œå®ƒåªé…å¤‡äº†ä¸å®Œæ•´çš„æ•°æ®ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿›ç¨‹å¯ä»¥åœ¨æ¯æ¬¡è·å¾—æè¿°ç¬¦å‡†å¤‡å°±ç»ªé€šçŸ¥æ—¶ï¼Œå°è¯•æ‰§è¡Œå°½å¯èƒ½å¤§çš„ I/Oï¼Œå› ä¸ºå¦‚æœä¸è¿™æ ·åšï¼Œå°±æ„å‘³ç€è¿›ç¨‹å¿…é¡»ç­‰å¾…ä¸‹ä¸€ä¸ªé€šçŸ¥åˆ°æ¥ï¼Œå³ä½¿åœ¨ä¸‹ä¸€ä¸ªé€šçŸ¥åˆ°æ¥ä¹‹å‰ï¼Œåœ¨æè¿°ç¬¦ä¸Šå¯ä»¥è¿›è¡Œ I/Oã€‚\nå¼€å§‹ï¼š\nåœ¨ t2æ—¶ï¼Œè¿›ç¨‹å¾—åˆ°ä¸€ä¸ªå…³äºæè¿°ç¬¦å·²ç»å‡†å¤‡å¥½çš„é€šçŸ¥ã€‚\nå¯ç”¨äº I/O çš„å­—èŠ‚æµå­˜å‚¨åœ¨ç¼“å†²åŒºä¸­ã€‚å‡è®¾å½“è¿›ç¨‹åœ¨æ—¶é—´ t2è·å¾—é€šçŸ¥æ—¶ï¼Œæœ‰1024ä¸ªå­—èŠ‚å¯ä¾›è¯»å–ã€‚\nå‡è®¾è¯¥è¿›ç¨‹åªè¯»å–1024ä¸ªå­—èŠ‚ä¸­çš„500ä¸ªå­—èŠ‚ã€‚\nè¿™æ„å‘³ç€åœ¨ t3ã€ t4å’Œ t5æ—¶ï¼Œç¼“å†²åŒºä¸­ä»ç„¶æœ‰524ä¸ªå­—èŠ‚å¯ä¾›è¿›ç¨‹è¯»å–è€Œä¸ä¼šé˜»å¡ã€‚ä½†æ˜¯ï¼Œç”±äºè¿›ç¨‹åªèƒ½åœ¨è·å¾—ä¸‹ä¸€ä¸ªé€šçŸ¥åæ‰§è¡Œ I/Oï¼Œå› æ­¤åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œè¿™524ä¸ªå­—èŠ‚å°†ä¿ç•™åœ¨ç¼“å†²åŒºä¸­ã€‚\nå‡è®¾è¿›ç¨‹åœ¨æ—¶é—´ t6è·å¾—ä¸‹ä¸€ä¸ªé€šçŸ¥ï¼Œå½“é¢å¤–çš„1024ä¸ªå­—èŠ‚åˆ°è¾¾ç¼“å†²åŒºæ—¶ã€‚ç¼“å†²åŒºä¸Šå¯ç”¨çš„æ•°æ®æ€»é‡ç°åœ¨æ˜¯1548å­—èŠ‚ãƒ¼524å­—èŠ‚ï¼Œä»¥å‰æ²¡æœ‰è¯»è¿‡ï¼Œ1024å­—èŠ‚æ˜¯æ–°åˆ°çš„ã€‚\nå‡è®¾è¿›ç¨‹ç°åœ¨è¯»å–1024ä¸ªå­—èŠ‚ã€‚\nè¿™æ„å‘³ç€åœ¨ç¬¬äºŒæ¬¡ I/O æ“ä½œç»“æŸæ—¶ï¼Œ524ä¸ªå­—èŠ‚ä»ç„¶ä¿ç•™åœ¨ç¼“å†²åŒºä¸­ï¼Œåœ¨ä¸‹ä¸€ä¸ªé€šçŸ¥åˆ°è¾¾ä¹‹å‰ï¼Œè¿›ç¨‹å°†æ— æ³•è¯»å–è¿™ä¸ªç¼“å†²åŒºã€‚\nè™½ç„¶åœ¨é€šçŸ¥åˆ°è¾¾åç«‹å³æ‰§è¡Œæ‰€æœ‰ I/O å¯èƒ½æ˜¯ä¸´æ—¶çš„ï¼Œä½†è¿™æ ·åšä¼šäº§ç”Ÿä¸€äº›åæœã€‚å•ä¸ªæè¿°ç¬¦ä¸Šçš„å¤§å‹ I/O æ“ä½œå¯èƒ½ä¼šé¥¿æ­»å…¶ä»–æè¿°ç¬¦ã€‚æ­¤å¤–ï¼Œå³ä½¿åœ¨çº§åˆ«è§¦å‘é€šçŸ¥çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªéå¸¸å¤§çš„å†™æˆ–å‘é€è°ƒç”¨ä¹Ÿæœ‰å¯èƒ½é˜»å¡ã€‚\nMultiplexing I/O on descriptors æœ‰å‡ ç§åœ¨æè¿°ç¬¦ä¸Šå¤šè·¯ I/O çš„æ–¹æ³•:\nâ€” non-blocking I/O (the descriptor itself is marked as non-blocking, operations may finish partially)\nâ€” signal driven I/O (the process owning the descriptor is notified when the I/O state of the descriptor changes)\nâ€” polling I/O (with *select* or *poll* system calls, both of which provide level triggered notifications about the readiness of descriptors)\nâ€” BSD specific kernel event polling (with the *kevent* system call).\nå‚è€ƒï¼š\n https://medium.com/@copyconstruct/the-method-to-epolls-madness-d9d2d6378642  ","description":"","id":15,"section":"posts","tags":["Linux","epoll"],"title":"epollçš„æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘","uri":"https://hugo.jiahongw.com/zh/posts/linux/epoll-lt-et/"},{"content":"HTTPæ˜¯ä¸€ä¸ªå±äºåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ï¼Œç”±äºå…¶ç®€æ·ã€å¿«é€Ÿçš„æ–¹å¼ï¼Œé€‚ç”¨äºåˆ†å¸ƒå¼è¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿã€‚\nHTTP/0.9 HTTP æ˜¯åŸºäº TCP/IP åè®®çš„åº”ç”¨å±‚åè®®ã€‚å®ƒä¸æ¶‰åŠæ•°æ®åŒ…ï¼ˆpacketï¼‰ä¼ è¾“ï¼Œä¸»è¦è§„å®šäº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡æ ¼å¼ï¼Œé»˜è®¤ä½¿ç”¨80ç«¯å£ã€‚\n åè®®è§„å®šï¼ŒæœåŠ¡å™¨åªèƒ½å›åº”HTMLæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä¸èƒ½å›åº”åˆ«çš„æ ¼å¼ã€‚\n HTTP/1.x  åœ¨æ—©æœŸï¼ŒHTTP ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ¨¡å‹æ¥å¤„ç†è¿™æ ·çš„è¿æ¥ã€‚è¿™äº›è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸæ˜¯çŸ­æš‚çš„ï¼šæ¯å‘èµ·ä¸€ä¸ªè¯·æ±‚æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œå¹¶åœ¨æ”¶åˆ°åº”ç­”æ—¶ç«‹å³å…³é—­ã€‚è¿æ¥çš„æˆæœ¬è¾ƒé«˜ã€‚\n å½“è¯·æ±‚å‘èµ·æ—¶ï¼Œç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½éƒ½ä¼šå¯¹æ€§èƒ½é€ æˆå½±å“ã€‚ç°ä»£æµè§ˆå™¨å¾€å¾€è¦å‘èµ·å¾ˆå¤šæ¬¡è¯·æ±‚(åå‡ ä¸ªæˆ–è€…æ›´å¤š)æ‰èƒ½æ‹¿åˆ°æ‰€éœ€çš„å®Œæ•´ä¿¡æ¯ï¼Œè¯æ˜äº†è¿™ä¸ªæ—©æœŸæ¨¡å‹çš„æ•ˆç‡ä½ä¸‹ã€‚\nåœ¨ HTTP/1.x é‡Œæœ‰å¤šç§æ¨¡å‹ï¼šçŸ­è¿æ¥, é•¿è¿æ¥, å’Œ HTTP æµæ°´çº¿ã€‚\nçŸ­é“¾æ¥æ¨¡å‹ HTTP/1.0 çš„é»˜è®¤æ¨¡å‹ã€‚æ¯ä¸€ä¸ª HTTP è¯·æ±‚éƒ½ç”±å®ƒè‡ªå·±ç‹¬ç«‹çš„è¿æ¥å®Œæˆï¼›è¿™æ„å‘³ç€å‘èµ·æ¯ä¸€ä¸ª HTTP è¯·æ±‚ä¹‹å‰éƒ½ä¼šæœ‰ä¸€æ¬¡ TCP æ¡æ‰‹ï¼Œè€Œä¸”æ˜¯è¿ç»­ä¸æ–­çš„ã€‚\n åœ¨ HTTP/1.1 ä¸­ï¼Œåªæœ‰å½“ Connection è¢«è®¾ç½®ä¸º close æ—¶æ‰ä¼šç”¨åˆ°è¿™ä¸ªæ¨¡å‹\n é•¿è¿æ¥æ¨¡å‹ ä¿æŒè¿æ¥å»å®Œæˆå¤šæ¬¡è¿ç»­çš„è¯·æ±‚ï¼Œå‡å°‘äº†ä¸æ–­é‡æ–°æ‰“å¼€è¿æ¥çš„æ—¶é—´ã€‚åœ¨ HTTP/1.1 é‡Œï¼Œé»˜è®¤å°±æ˜¯é•¿è¿æ¥çš„ã€‚\n çŸ­è¿æ¥æœ‰ä¸¤ä¸ªæ¯”è¾ƒå¤§çš„é—®é¢˜ï¼šåˆ›å»ºæ–°è¿æ¥è€—è´¹çš„æ—¶é—´å°¤ä¸ºæ˜æ˜¾ï¼Œå¦å¤– TCP è¿æ¥çš„æ€§èƒ½åªæœ‰åœ¨è¯¥è¿æ¥è¢«ä½¿ç”¨ä¸€æ®µæ—¶é—´å(çƒ­è¿æ¥)æ‰èƒ½å¾—åˆ°æ”¹å–„ã€‚å¦å¤–æˆ‘ä»¬çŸ¥é“ï¼ŒTCPåè®®æœ‰ä¸ªæ»‘åŠ¨çª—å£ï¼Œæœ‰æ…¢å¯åŠ¨è¿™å›äº‹ï¼Œå°±æ˜¯è¯´æ¯æ¬¡å»ºç«‹æ–°è¿æ¥åï¼Œæ•°æ®å…ˆæ˜¯æ…¢æ…¢åœ°ä¼ ï¼Œç„¶åæ»‘åŠ¨çª—å£æ…¢æ…¢å˜å¤§ï¼Œæ‰èƒ½è¾ƒé«˜é€Ÿåº¦åœ°ä¼ ã€‚\n å…·ä½“æµç¨‹ï¼š\nä¸€ä¸ªé•¿è¿æ¥ä¼šä¿æŒä¸€æ®µæ—¶é—´ï¼Œé‡å¤ç”¨äºå‘é€ä¸€ç³»åˆ—è¯·æ±‚ï¼ŒèŠ‚çœäº†æ–°å»º TCP è¿æ¥æ¡æ‰‹çš„æ—¶é—´ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ TCP çš„æ€§èƒ½å¢å¼ºèƒ½åŠ›ã€‚å½“ç„¶è¿™ä¸ªè¿æ¥ä¹Ÿä¸ä¼šä¸€ç›´ä¿ç•™ç€ï¼šè¿æ¥åœ¨ç©ºé—²ä¸€æ®µæ—¶é—´åä¼šè¢«å…³é—­(æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ Keep-Alive åè®®å¤´æ¥æŒ‡å®šä¸€ä¸ªæœ€å°çš„è¿æ¥ä¿æŒæ—¶é—´)ã€‚\nç¼ºç‚¹ï¼š\nå°±ç®—æ˜¯åœ¨ç©ºé—²çŠ¶æ€ï¼Œå®ƒè¿˜æ˜¯ä¼šæ¶ˆè€—æœåŠ¡å™¨èµ„æºï¼Œè€Œä¸”åœ¨é‡è´Ÿè½½æ—¶ï¼Œè¿˜æœ‰å¯èƒ½é­å— DoS attacks æ”»å‡»ã€‚è¿™ç§åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨éé•¿è¿æ¥ï¼Œå³å°½å¿«å…³é—­é‚£äº›ç©ºé—²çš„è¿æ¥ï¼Œä¹Ÿèƒ½å¯¹æ€§èƒ½æœ‰æ‰€æå‡ã€‚\n é•¿è¿æ¥ä¸€ä¸ªä¼˜åŒ–çš„æ–¹æ³•å°±æ˜¯è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œä½†æ˜¯å…·ä½“è¿™ä¸ªæ—¶é—´æ˜¯å¤šå°‘ï¼Œåº”è¯¥é€šè¿‡æµ‹è¯•ä¹‹åå¾—å‡ºä¸€ä¸ªè¾ƒä¸ºå‡è¡¡çš„æ—¶é—´ã€‚\n æµæ°´çº¿æ¨¡å‹(ç®¡çº¿åŒ–) å¤šä¸ªè¿ç»­çš„è¯·æ±‚ç”šè‡³éƒ½ä¸ç”¨ç­‰å¾…ç«‹å³è¿”å›å°±å¯ä»¥è¢«å‘é€ã€‚HTTP æµæ°´çº¿åœ¨ç°ä»£æµè§ˆå™¨ä¸­å¹¶ä¸æ˜¯é»˜è®¤è¢«å¯ç”¨çš„ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼ŒHTTP è¯·æ±‚æ˜¯æŒ‰é¡ºåºå‘å‡ºçš„ã€‚ä¸‹ä¸€ä¸ªè¯·æ±‚åªæœ‰åœ¨å½“å‰è¯·æ±‚æ”¶åˆ°åº”ç­”è¿‡åæ‰ä¼šè¢«å‘å‡ºã€‚ç”±äºä¼šå—åˆ°ç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½çš„é™åˆ¶ï¼Œåœ¨ä¸‹ä¸€ä¸ªè¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´ã€‚\n**æµæ°´çº¿æ˜¯åœ¨åŒä¸€æ¡é•¿è¿æ¥ä¸Šå‘å‡ºè¿ç»­çš„è¯·æ±‚ï¼Œè€Œä¸ç”¨ç­‰å¾…åº”ç­”è¿”å›ã€‚è¿™æ ·å¯ä»¥é¿å…è¿æ¥å»¶è¿Ÿã€‚ç†è®ºä¸Šè®²ï¼Œæ€§èƒ½è¿˜ä¼šå› ä¸ºä¸¤ä¸ª HTTP è¯·æ±‚æœ‰å¯èƒ½è¢«æ‰“åŒ…åˆ°ä¸€ä¸ª TCP æ¶ˆæ¯åŒ…ä¸­è€Œå¾—åˆ°æå‡ã€‚**å°±ç®— HTTP è¯·æ±‚ä¸æ–­çš„ç»§ç»­ï¼Œå°ºå¯¸ä¼šå¢åŠ ï¼Œä½†è®¾ç½® TCP çš„ MSS(Maximum Segment Size) é€‰é¡¹ï¼Œä»ç„¶è¶³å¤ŸåŒ…å«ä¸€ç³»åˆ—ç®€å•çš„è¯·æ±‚ã€‚\n æ¯”å¦‚ï¼Œå½“è¯·æ±‚ä¸€ä¸ªåŒ…å«10å¼ å›¾ç‰‡çš„HTML Webé¡µé¢ï¼Œä¸æŒ¨ä¸ªè¿æ¥ç›¸æ¯”ï¼Œç”¨æŒä¹…è¿æ¥å¯ä»¥è®©è¯·æ±‚æ›´å¿«ç»“æŸã€‚è€Œç®¡çº¿åŒ–æŠ€æœ¯åˆ™æ¯”æŒä¹…è¿æ¥è¿˜è¦å¿«ã€‚è¯·æ±‚æ•°è¶Šå¤šï¼Œæ—¶é—´å·®å°±è¶Šæ˜æ˜¾ã€‚\n é˜Ÿå¤´é˜»å¡ åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒHTTPéµå®ˆâ€œè¯·æ±‚-å“åº”â€çš„æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯æ¯æ¬¡å‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯è¿”å›å“åº”ï¼Œè¿™ç§æ¨¡å¼å¾ˆç®€å•ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªè‡´å‘½ç¼ºé™·é‚£å°±æ˜¯é¡µé¢ä¸­æœ‰å¤šä¸ªè¯·æ±‚ï¼Œæ¯ä¸ªè¯·æ±‚å¿…é¡»ç­‰åˆ°å‰ä¸€ä¸ªè¯·æ±‚å“åº”ä¹‹åæ‰èƒ½å‘é€ï¼Œå¹¶ä¸”å½“å‰è¯·æ±‚çš„å“åº”è¿”å›ä¹‹åï¼Œå½“å‰è¯·æ±‚çš„ä¸‹ä¸€ä¸ªè¯·æ±‚æ‰èƒ½å‘é€ï¼Œæµç¨‹å¦‚ä¸‹å›¾\nåœ¨TCPé“¾æ¥ä¸­ï¼Œhttpè¯·æ±‚å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªè¯·æ±‚å“åº”ä¹‹åï¼Œæ‰èƒ½å‘é€ï¼Œåé¢çš„ä¾æ¬¡ç±»æ¨ï¼Œç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœåœ¨ä¸€ä¸ªtcpé€šé“ä¸­å¦‚æœæŸä¸ªhttpè¯·æ±‚çš„å“åº”å› ä¸ºæŸä¸ªåŸå› æ²¡æœ‰åŠæ—¶è¿”å›ï¼Œåé¢çš„å“åº”ä¼šè¢«é˜»å¡ï¼Œè¿™å°±æ˜¯é˜Ÿå¤´é˜»å¡ã€‚\n æ³¨æ„è¿™é‡Œè¯´çš„æ˜¯å“åº”ä¹‹åï¼Œå¹¶ä¸æ˜¯è¯·ä¹‹å!\n ä¸ºäº†æé«˜é€Ÿåº¦å’Œæ•ˆç‡ï¼Œåœ¨æŒä¹…è¿æ¥çš„åŸºç¡€ä¸Šï¼ŒHTTP1.1è¿›ä¸€æ­¥åœ°æ”¯æŒåœ¨æŒä¹…è¿æ¥ä¸Šä½¿ç”¨ç®¡é“åŒ–ï¼ˆpipeliningï¼‰ç‰¹æ€§ã€‚ç®¡é“åŒ–å…è®¸å®¢æˆ·ç«¯åœ¨å·²å‘é€çš„è¯·æ±‚æ”¶åˆ°æœåŠ¡ç«¯çš„å“åº”ä¹‹å‰å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œå€Ÿæ­¤æ¥å‡å°‘ç­‰å¾…æ—¶é—´æé«˜ååï¼Œå¦‚æœå¤šä¸ªè¯·æ±‚èƒ½åœ¨åŒä¸€ä¸ªTCPåˆ†èŠ‚å‘é€çš„è¯ï¼Œè¿˜èƒ½æé«˜ç½‘ç»œåˆ©ç”¨ç‡ï¼Œæµç¨‹å¦‚å›¾ï¼š\nåŒä¸€ä¸ªtcpè¿æ¥ä¸­å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªhttpè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯å¹¶å‘ï¼Œä½†æ˜¯åœ¨å“åº”çš„æ—¶å€™ï¼Œå¿…é¡»æ’é˜Ÿå“åº”ï¼Œè°å…ˆåˆ°è¾¾çš„è°å…ˆå“åº”ï¼Œç›¸æ¯”ä¸æ”¯æŒç®¡é“åŒ–çš„httpè¯·æ±‚ç¡®å®æé«˜äº†æ•ˆç‡ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å±€é™æ€§ï¼Œå‡å¦‚å…¶ä¸­æŸä¸ªå“åº”å› ä¸ºæŸç§åŸå› å»¶è¿Ÿäº†å‡ ç§’ï¼Œåé¢çš„å“åº”éƒ½ä¼šè¢«é˜»å¡ã€‚ä¸Šé¢ç®­å¤´æ‰€æŒ‡çš„å“åº”å¦‚æœé˜»å¡äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªä¹Ÿæ˜¯é˜Ÿå¤´é˜»å¡ã€‚\nå¹¶ä¸”ä½¿ç”¨HTTPç®¡é“åŒ–è¿˜æœ‰ä¸€äº›é™åˆ¶:\n1ã€ç®¡é“åŒ–è¦æ±‚æœåŠ¡ç«¯æŒ‰ç…§è¯·æ±‚å‘é€çš„é¡ºåºè¿”å›å“åº”ï¼ˆFIFOï¼‰ï¼ŒåŸå› å¾ˆç®€å•ï¼ŒHTTPè¯·æ±‚å’Œå“åº”å¹¶æ²¡æœ‰åºå·æ ‡è¯†ï¼Œæ— æ³•å°†ä¹±åºçš„å“åº”ä¸è¯·æ±‚å…³è”èµ·æ¥ã€‚\n2ã€å½“å®¢æˆ·ç«¯åœ¨æ”¯æŒç®¡é“åŒ–æ—¶éœ€è¦ä¿æŒæœªæ”¶åˆ°å“åº”çš„è¯·æ±‚ï¼Œå½“è¿æ¥æ„å¤–ä¸­æ–­æ—¶ï¼Œéœ€è¦é‡æ–°å‘é€è¿™éƒ¨åˆ†è¯·æ±‚ã€‚å¦‚æœè¿™ä¸ªè¯·æ±‚åªæ˜¯ä»æœåŠ¡å™¨è·å–æ•°æ®ï¼Œé‚£ä¹ˆå¹¶ä¸ä¼šå¯¹èµ„æºé€ æˆä»»ä½•å½±å“ï¼Œè€Œå¦‚æœæ˜¯ä¸€ä¸ªæäº¤ä¿¡æ¯çš„è¯·æ±‚å¦‚postè¯·æ±‚ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šé€ æˆèµ„æºå¤šæ¬¡æäº¤ä»è€Œæ”¹å˜èµ„æºï¼Œè¿™æ˜¯ä¸å…è®¸çš„ã€‚è€Œä¸ä¼šå¯¹æœåŠ¡å™¨èµ„æºäº§ç”Ÿå½±å“çš„è¯·æ±‚æœ‰ä¸ªä¸“ä¸šåè¯å«åšå¹‚ç­‰è¯·æ±‚ã€‚å®¢æˆ·ç«¯åœ¨ä½¿ç”¨ç®¡é“åŒ–çš„æ—¶å€™è¯·æ±‚æ–¹å¼å¿…é¡»æ˜¯å¹‚ç­‰è¯·æ±‚ã€‚\næ¯”è¾ƒï¼š\nä¸Šé¢çš„ç®¡çº¿åŒ–çš„æ¨¡å‹å°±æ˜¯åŠ é€Ÿäº†è¯·æ±‚çš„è¿‡ç¨‹ï¼Œä½†æ˜¯å“åº”çš„è¿‡ç¨‹è¿˜æ˜¯å­˜åœ¨é˜Ÿå¤´é˜»å¡ã€‚\n å› ä¸ºHTTPç®¡é“åŒ–æœ¬èº«å¯èƒ½ä¼šå¯¼è‡´é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ï¼Œä»¥åŠä¸Šé¢æåˆ°çš„ä¸€äº›é™åˆ¶ï¼Œç°ä»£æµè§ˆå™¨é»˜è®¤éƒ½å…³é—­äº†ç®¡é“åŒ–ï¼Œå¹¶ä¸”å¤§éƒ¨åˆ†æœåŠ¡å™¨ä¹Ÿæ˜¯é»˜è®¤ä¸æ”¯æŒç®¡é“åŒ–çš„ã€‚\n å¦‚ä½•è§£å†³é˜Ÿå¤´é˜»å¡ï¼Ÿ\nå®¢æˆ·ç«¯ä½¿ç”¨å¹¶å‘é•¿è¿æ¥ï¼Œæ³¨æ„è¿™ä¸ªå¹¶å‘æŒ‡çš„æ˜¯tcpå¹¶å‘è¿æ¥ã€‚\n å¹¶å‘é•¿è¿æ¥è™½ç„¶åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†httpçš„é˜Ÿå¤´é˜»å¡ï¼Œä½†æ˜¯ä¼šå¯¹æœåŠ¡å™¨çš„æ€§èƒ½æœ‰è¾ƒé«˜çš„è¦æ±‚\n HTTP/2  HTTP/1.1 ç‰ˆçš„å¤´ä¿¡æ¯è‚¯å®šæ˜¯æ–‡æœ¬ï¼ˆASCIIç¼–ç ï¼‰ï¼Œæ•°æ®ä½“å¯ä»¥æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯äºŒè¿›åˆ¶ã€‚HTTP/2 åˆ™æ˜¯ä¸€ä¸ªå½»åº•çš„äºŒè¿›åˆ¶åè®®ï¼Œå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”ç»Ÿç§°ä¸º\u0026quot;å¸§\u0026rdquo;ï¼ˆframeï¼‰ï¼šå¤´ä¿¡æ¯å¸§å’Œæ•°æ®å¸§ã€‚\n ğŸ˜† HTTP/2 æ²¡æœ‰æ”¹åŠ¨ HTTP çš„åº”ç”¨è¯­ä¹‰ã€‚ HTTP æ–¹æ³•ã€çŠ¶æ€ä»£ç ã€URI å’Œæ ‡å¤´å­—æ®µç­‰æ ¸å¿ƒæ¦‚å¿µä¸€å¦‚å¾€å¸¸ã€‚ ä¸è¿‡ï¼ŒHTTP/2 ä¿®æ”¹äº†æ•°æ®æ ¼å¼åŒ–ï¼ˆåˆ†å¸§ï¼‰ä»¥åŠåœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é—´ä¼ è¾“çš„æ–¹å¼ã€‚è¿™ä¸¤ç‚¹ç»Ÿå¸…å…¨å±€ï¼Œé€šè¿‡æ–°çš„åˆ†å¸§å±‚å‘æˆ‘ä»¬çš„åº”ç”¨éšè—äº†æ‰€æœ‰å¤æ‚æ€§ã€‚ å› æ­¤ï¼Œæ‰€æœ‰ç°æœ‰çš„åº”ç”¨éƒ½å¯ä»¥ä¸å¿…ä¿®æ”¹è€Œåœ¨æ–°åè®®ä¸‹è¿è¡Œã€‚\n ä¸ºä»€ä¹ˆä¸æ˜¯ HTTP/1.2ï¼Ÿ\nä¸ºäº†å®ç° HTTP å·¥ä½œç»„è®¾å®šçš„æ€§èƒ½ç›®æ ‡ï¼ŒHTTP/2 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚ï¼Œè¯¥å±‚æ— æ³•ä¸ä¹‹å‰çš„ HTTP/1.x æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å‘åå…¼å®¹ï¼Œå› æ­¤åè®®çš„ä¸»ç‰ˆæœ¬æå‡åˆ° HTTP/2ã€‚\n äºŒè¿›åˆ¶åˆ†å¸§å±‚ HTTP/2 æ‰€æœ‰æ€§èƒ½å¢å¼ºçš„æ ¸å¿ƒåœ¨äºæ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•å°è£… HTTP æ¶ˆæ¯å¹¶åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“ã€‚\nè¿™é‡Œæ‰€è°“çš„â€œå±‚â€ï¼ŒæŒ‡çš„æ˜¯ä½äºå¥—æ¥å­—æ¥å£ä¸åº”ç”¨å¯è§çš„é«˜çº§ HTTP API ä¹‹é—´ä¸€ä¸ªç»è¿‡ä¼˜åŒ–çš„æ–°ç¼–ç æœºåˆ¶ï¼šHTTP çš„è¯­ä¹‰ï¼ˆåŒ…æ‹¬å„ç§åŠ¨è¯ã€æ–¹æ³•ã€æ ‡å¤´ï¼‰éƒ½ä¸å—å½±å“ï¼Œä¸åŒçš„æ˜¯ä¼ è¾“æœŸé—´å¯¹å®ƒä»¬çš„ç¼–ç æ–¹å¼å˜äº†ã€‚ HTTP/1.x åè®®ä»¥æ¢è¡Œç¬¦ä½œä¸ºçº¯æ–‡æœ¬çš„åˆ†éš”ç¬¦ï¼Œè€Œ HTTP/2 å°†æ‰€æœ‰ä¼ è¾“çš„ä¿¡æ¯åˆ†å‰²ä¸ºæ›´å°çš„æ¶ˆæ¯å’Œå¸§ï¼Œå¹¶é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼å¯¹å®ƒä»¬ç¼–ç ã€‚\næ•°æ®æµã€æ¶ˆæ¯å’Œå¸§  æ•°æ®æµï¼šå·²å»ºç«‹çš„è¿æ¥å†…çš„åŒå‘å­—èŠ‚æµï¼Œå¯ä»¥æ‰¿è½½ä¸€æ¡æˆ–å¤šæ¡æ¶ˆæ¯ã€‚ æ¶ˆæ¯ï¼šä¸é€»è¾‘è¯·æ±‚æˆ–å“åº”æ¶ˆæ¯å¯¹åº”çš„å®Œæ•´çš„ä¸€ç³»åˆ—å¸§ã€‚ å¸§ï¼šHTTP/2 é€šä¿¡çš„æœ€å°å•ä½ï¼Œæ¯ä¸ªå¸§éƒ½åŒ…å«å¸§å¤´ï¼Œè‡³å°‘ä¹Ÿä¼šæ ‡è¯†å‡ºå½“å‰å¸§æ‰€å±çš„æ•°æ®æµã€‚  å…³ç³»ï¼š\n æ‰€æœ‰é€šä¿¡éƒ½åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸Šå®Œæˆï¼Œæ­¤è¿æ¥å¯ä»¥æ‰¿è½½ä»»æ„æ•°é‡çš„åŒå‘æ•°æ®æµã€‚(å¤šå·¥) æ¯ä¸ªæ•°æ®æµéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦å’Œå¯é€‰çš„ä¼˜å…ˆçº§ä¿¡æ¯ï¼Œç”¨äºæ‰¿è½½åŒå‘æ¶ˆæ¯ã€‚ æ¯æ¡æ¶ˆæ¯éƒ½æ˜¯ä¸€æ¡é€»è¾‘ HTTP æ¶ˆæ¯ï¼ˆä¾‹å¦‚è¯·æ±‚æˆ–å“åº”ï¼‰ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå¸§ã€‚ å¸§æ˜¯æœ€å°çš„é€šä¿¡å•ä½ï¼Œæ‰¿è½½ç€ç‰¹å®šç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚ HTTP æ ‡å¤´ã€æ¶ˆæ¯è´Ÿè½½ç­‰ç­‰ã€‚ æ¥è‡ªä¸åŒæ•°æ®æµçš„å¸§å¯ä»¥äº¤é”™å‘é€ï¼Œç„¶åå†æ ¹æ®æ¯ä¸ªå¸§å¤´çš„æ•°æ®æµæ ‡è¯†ç¬¦é‡æ–°ç»„è£…ã€‚  ç®€è¨€ä¹‹ï¼ŒHTTP/2 å°† HTTP åè®®é€šä¿¡åˆ†è§£ä¸ºäºŒè¿›åˆ¶ç¼–ç å¸§çš„äº¤æ¢ï¼Œè¿™äº›å¸§å¯¹åº”ç€ç‰¹å®šæ•°æ®æµä¸­çš„æ¶ˆæ¯ã€‚æ‰€æœ‰è¿™äº›éƒ½åœ¨ä¸€ä¸ª TCP è¿æ¥å†…å¤ç”¨ã€‚ è¿™æ˜¯ HTTP/2 åè®®æ‰€æœ‰å…¶ä»–åŠŸèƒ½å’Œæ€§èƒ½ä¼˜åŒ–çš„åŸºç¡€ã€‚\nHTTP/2 å¸§ç»“æ„å¦‚ä¸‹ï¼š\nå®é™…çš„ä¼ è¾“è¿‡ç¨‹å¯èƒ½æ˜¯ä¸‹é¢è¿™æ ·(ååé‡å¢å¤§)ï¼š\nè¯·æ±‚ä¸å“åº”å¤ç”¨ HTTP/2 ä¸­æ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚å®ç°äº†å®Œæ•´çš„è¯·æ±‚å’Œå“åº”å¤ç”¨ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥å°† HTTP æ¶ˆæ¯åˆ†è§£ä¸ºäº’ä¸ä¾èµ–çš„å¸§ï¼Œç„¶åäº¤é”™å‘é€ï¼Œæœ€åå†åœ¨å¦ä¸€ç«¯æŠŠå®ƒä»¬é‡æ–°ç»„è£…èµ·æ¥ã€‚\næ•°æ®æµä¼˜å…ˆçº§ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸Šå›¾ä¸­çš„å‡ ä¸ªæ“ä½œç¤ºä¾‹ã€‚ ä»å·¦åˆ°å³ä¾æ¬¡ä¸ºï¼š\n æ•°æ®æµ A å’Œæ•°æ®æµ B éƒ½æ²¡æœ‰æŒ‡å®šçˆ¶ä¾èµ–é¡¹ï¼Œä¾èµ–äºéšå¼â€œæ ¹æ•°æ®æµâ€ï¼›A çš„æƒé‡ä¸º 12ï¼ŒB çš„æƒé‡ä¸º 4ã€‚å› æ­¤ï¼Œæ ¹æ®æ¯”ä¾‹æƒé‡ï¼šæ•°æ®æµ B è·å¾—çš„èµ„æºæ˜¯ A æ‰€è·èµ„æºçš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ æ•°æ®æµ D ä¾èµ–äºæ ¹æ•°æ®æµï¼›C ä¾èµ–äº Dã€‚ å› æ­¤ï¼ŒD åº”å…ˆäº C è·å¾—å®Œæ•´èµ„æºåˆ†é…ã€‚ æƒé‡ä¸é‡è¦ï¼Œå› ä¸º C çš„ä¾èµ–å…³ç³»æ‹¥æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚ æ•°æ®æµ D åº”å…ˆäº C è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›C åº”å…ˆäº A å’Œ B è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›æ•°æ®æµ B è·å¾—çš„èµ„æºæ˜¯ A æ‰€è·èµ„æºçš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ æ•°æ®æµ D åº”å…ˆäº E å’Œ C è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›E å’Œ C åº”å…ˆäº A å’Œ B è·å¾—ç›¸åŒçš„èµ„æºåˆ†é…ï¼›A å’Œ B åº”åŸºäºå…¶æƒé‡è·å¾—æ¯”ä¾‹åˆ†é…ã€‚  æµæ§åˆ¶ æµæ§åˆ¶æ˜¯ä¸€ç§é˜»æ­¢å‘é€æ–¹å‘æ¥æ”¶æ–¹å‘é€å¤§é‡æ•°æ®çš„æœºåˆ¶ï¼Œä»¥å…è¶…å‡ºåè€…çš„éœ€æ±‚æˆ–å¤„ç†èƒ½åŠ›ï¼šå‘é€æ–¹å¯èƒ½éå¸¸ç¹å¿™ã€å¤„äºè¾ƒé«˜çš„è´Ÿè½½ä¹‹ä¸‹ï¼Œä¹Ÿå¯èƒ½ä»…ä»…å¸Œæœ›ä¸ºç‰¹å®šæ•°æ®æµåˆ†é…å›ºå®šé‡çš„èµ„æºã€‚ ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯å¯èƒ½è¯·æ±‚äº†ä¸€ä¸ªå…·æœ‰è¾ƒé«˜ä¼˜å…ˆçº§çš„å¤§å‹è§†é¢‘æµï¼Œä½†æ˜¯ç”¨æˆ·å·²ç»æš‚åœè§†é¢‘ï¼Œå®¢æˆ·ç«¯ç°åœ¨å¸Œæœ›æš‚åœæˆ–é™åˆ¶ä»æœåŠ¡å™¨çš„ä¼ è¾“ï¼Œä»¥å…æå–å’Œç¼“å†²ä¸å¿…è¦çš„æ•°æ®ã€‚ å†æ¯”å¦‚ï¼Œä¸€ä¸ªä»£ç†æœåŠ¡å™¨å¯èƒ½å…·æœ‰è¾ƒå¿«çš„ä¸‹æ¸¸è¿æ¥å’Œè¾ƒæ…¢çš„ä¸Šæ¸¸è¿æ¥ï¼Œå¹¶ä¸”ä¹Ÿå¸Œæœ›è°ƒèŠ‚ä¸‹æ¸¸è¿æ¥ä¼ è¾“æ•°æ®çš„é€Ÿåº¦ä»¥åŒ¹é…ä¸Šæ¸¸è¿æ¥çš„é€Ÿåº¦æ¥æ§åˆ¶å…¶èµ„æºåˆ©ç”¨ç‡ï¼›ç­‰ç­‰ã€‚ç±»ä¼¼TCPæµé‡æ§åˆ¶ã€‚\næœåŠ¡å™¨æ¨é€ HTTP/2 æ–°å¢çš„å¦ä¸€ä¸ªå¼ºå¤§çš„æ–°åŠŸèƒ½æ˜¯ï¼ŒæœåŠ¡å™¨å¯ä»¥å¯¹ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚å‘é€å¤šä¸ªå“åº”ã€‚ æ¢å¥è¯è¯´ï¼Œé™¤äº†å¯¹æœ€åˆè¯·æ±‚çš„å“åº”å¤–ï¼ŒæœåŠ¡å™¨è¿˜å¯ä»¥å‘å®¢æˆ·ç«¯æ¨é€é¢å¤–èµ„æºï¼ˆå›¾ 12-5ï¼‰ï¼Œè€Œæ— éœ€å®¢æˆ·ç«¯æ˜ç¡®åœ°è¯·æ±‚ã€‚\næ ‡å¤´å‹ç¼© æ¯ä¸ª HTTP ä¼ è¾“éƒ½æ‰¿è½½ä¸€ç»„æ ‡å¤´ï¼Œè¿™äº›æ ‡å¤´è¯´æ˜äº†ä¼ è¾“çš„èµ„æºåŠå…¶å±æ€§ã€‚ åœ¨ HTTP/1.x ä¸­ï¼Œæ­¤å…ƒæ•°æ®å§‹ç»ˆä»¥çº¯æ–‡æœ¬å½¢å¼ï¼Œé€šå¸¸ä¼šç»™æ¯ä¸ªä¼ è¾“å¢åŠ  500â€“800 å­—èŠ‚çš„å¼€é”€ã€‚å¦‚æœä½¿ç”¨ HTTP Cookieï¼Œå¢åŠ çš„å¼€é”€æœ‰æ—¶ä¼šè¾¾åˆ°ä¸Šåƒå­—èŠ‚ã€‚ä¸ºäº†å‡å°‘æ­¤å¼€é”€å’Œæå‡æ€§èƒ½ï¼ŒHTTP/2 ä½¿ç”¨ HPACK å‹ç¼©æ ¼å¼å‹ç¼©è¯·æ±‚å’Œå“åº”æ ‡å¤´å…ƒæ•°æ®ï¼Œè¿™ç§æ ¼å¼é‡‡ç”¨ä¸¤ç§ç®€å•ä½†æ˜¯å¼ºå¤§çš„æŠ€æœ¯ï¼š\n è¿™ç§æ ¼å¼æ”¯æŒé€šè¿‡é™æ€éœå¤«æ›¼ä»£ç å¯¹ä¼ è¾“çš„æ ‡å¤´å­—æ®µè¿›è¡Œç¼–ç ï¼Œä»è€Œå‡å°äº†å„ä¸ªä¼ è¾“çš„å¤§å°ã€‚ è¿™ç§æ ¼å¼è¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ—¶ç»´æŠ¤å’Œæ›´æ–°ä¸€ä¸ªåŒ…å«ä¹‹å‰è§è¿‡çš„æ ‡å¤´å­—æ®µçš„ç´¢å¼•åˆ—è¡¨ï¼ˆæ¢å¥è¯è¯´ï¼Œå®ƒå¯ä»¥å»ºç«‹ä¸€ä¸ªå…±äº«çš„å‹ç¼©ä¸Šä¸‹æ–‡ï¼‰ï¼Œæ­¤åˆ—è¡¨éšåä¼šç”¨ä½œå‚è€ƒï¼Œå¯¹ä¹‹å‰ä¼ è¾“çš„å€¼è¿›è¡Œæœ‰æ•ˆç¼–ç ã€‚  åˆ©ç”¨éœå¤«æ›¼ç¼–ç ï¼Œå¯ä»¥åœ¨ä¼ è¾“æ—¶å¯¹å„ä¸ªå€¼è¿›è¡Œå‹ç¼©ï¼Œè€Œåˆ©ç”¨ä¹‹å‰ä¼ è¾“å€¼çš„ç´¢å¼•åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ è¾“ç´¢å¼•å€¼çš„æ–¹å¼å¯¹é‡å¤å€¼è¿›è¡Œç¼–ç ï¼Œç´¢å¼•å€¼å¯ç”¨äºæœ‰æ•ˆæŸ¥è¯¢å’Œé‡æ„å®Œæ•´çš„æ ‡å¤´é”®å€¼å¯¹ã€‚\nå“ˆå¤«æ›¼æ ‘å¦‚ä½•å‹ç¼© æ–‡ä»¶å‹ç¼©çš„ä¸»è¦æ€æƒ³æ˜¯åˆ©ç”¨å“ˆå¤«æ›¼ç¼–ç æ¥å®ç°çš„ï¼Œä½†æ˜¯å¾—åˆ°ç¼–ç ä¹‹å‰æˆ‘ä»¬éœ€è¦æ„å»ºè¿™æ£µæ ‘ã€‚é‚£ä¹ˆåˆ©ç”¨ä»€ä¹ˆæ¥æ„å»ºæ ‘å‘¢ï¼Ÿï¼è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°ï¼Œç”¨æ¬¡æ•°æ¥æ„å»ºHuffmanTreeã€‚å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ª.txtçš„å°æ–‡ä»¶ï¼Œå†…å®¹æ˜¯\u0026quot;aaaabbbccd\u0026quot;ã€‚å­—ç¬¦å­˜åœ¨è®¡ç®—æœºä¸­æ—¶ä»¥å­—èŠ‚ä¸ºå•ä½çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†è¿™äº›å­—ç¬¦å‹ç¼©æˆ0ã€1è¡¨ç¤ºçš„ç¼–ç ï¼Œ0å’Œ1è¡¨ç¤ºå­—èŠ‚ä¸­çš„â€œä½â€ï¼Œè¿™æ ·èƒ½å¤§å¤§é™ä½æ–‡ä»¶çš„å¤§å°ã€‚\nä½“éªŒHTTP2 https://http2.akamai.com/demo\nå‚è€ƒé“¾æ¥ï¼š\n HTTP è¿æ¥ç®¡ç†è¿›åŒ–è®º https://developers.google.com/web/fundamentals/performance/http2?hl=zh-cn ç™½è¯httpé˜Ÿå¤´é˜»å¡  ","description":"httpåè®®è¿­ä»£äº†å¥½å‡ ä¸ªç‰ˆæœ¬ï¼Œä»ä¸€å¼€å§‹çš„çŸ­é“¾æ¥æ¨¡å‹åˆ°é•¿è¿æ¥æ¨¡å‹ï¼Œæœ€åè¿˜è¡ç”Ÿå‡ºäºŒè¿›åˆ¶å¸§å±‚......","id":16,"section":"posts","tags":["network","http","https"],"title":"Httpåè®®æµ…æ","uri":"https://hugo.jiahongw.com/zh/posts/network/http/"},{"content":"C/C++ â­•é¢å‘å¯¹è±¡ä¸é¢å‘è¿‡ç¨‹ Leetcodeå¯¹é¢å‘å¯¹è±¡çš„ç†è§£ï¼šé¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ–¹å¼ä½¿å¾—æ¯ä¸€ä¸ªç±»éƒ½åªåšä¸€ä»¶äº‹ã€‚é¢å‘è¿‡ç¨‹ä¼šè®©ä¸€ä¸ªç±»è¶Šæ¥è¶Šå…¨èƒ½ï¼Œå°±åƒä¸€ä¸ªç®¡å®¶ä¸€æ ·åšäº†æ‰€æœ‰çš„äº‹ã€‚è€Œé¢å‘å¯¹è±¡åƒæ˜¯é›‡ä½£äº†ä¸€ç¾¤èŒå‘˜ï¼Œæ¯ä¸ªäººåšä¸€ä»¶å°äº‹ï¼Œå„å¸å…¶èŒï¼Œæœ€ç»ˆåˆä½œå…±èµ¢ï¼\né¢å‘å¯¹è±¡çš„ç‰¹ç‚¹æ˜¯å¯ç»´æŠ¤ã€å¯å¤ç”¨ã€å¯æ‰©å±•ã€çµæ´»æ€§å¥½ï¼Œå®ƒçœŸæ­£å¼ºå¤§çš„åœ°æ–¹åœ¨äºï¼šéšç€ä¸šåŠ¡å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œé¢å‘å¯¹è±¡ä¾ç„¶èƒ½å¤Ÿä½¿å¾—ç¨‹åºç»“æ„è‰¯å¥½ï¼Œè€Œé¢å‘è¿‡ç¨‹å´ä¼šå¯¼è‡´ç¨‹åºè¶Šæ¥è¶Šè‡ƒè‚¿ã€‚\nè®©é¢å‘å¯¹è±¡ä¿æŒç»“æ„è‰¯å¥½çš„ç§˜è¯€å°±æ˜¯ è®¾è®¡æ¨¡å¼ã€‚\nâ•C++ç¨‹åºè®¾è®¡æ¨¡å‹ ç¨‹åºæ¨¡å‹(procedural model)\næŠ½è±¡æ•°æ®æ¨¡å‹(abstract data type model)\nä¾‹å¦‚std::string\né¢å‘å¯¹è±¡æ¨¡å‹(object-oriented model)\nâœ–å¤šæ€ å¤šæ€å¦‚ä½•å®ç°ï¼Ÿ\nè¦å®ç°C++ä¸­OOç¨‹åºè®¾è®¡çš„å¤šæ€æ€§è´¨ï¼Œåªæœ‰é€šè¿‡pointæˆ–è€…referenceçš„é—´æ¥å¤„ç†ã€‚\nå¤šæ€ç”¨é€”ï¼Ÿ\nç»ç”±ä¸€ä¸ªå…±åŒçš„æ¥å£æ¥å½±å“ç±»å‹çš„å°è£…ï¼Œè¿™ä¸ªæ¥å£é€šå¸¸è¢«å®šä¹‰åœ¨ä¸€ä¸ªæŠ½è±¡çš„base classä¸­ã€‚\nè™šå‡½æ•°ä¸çº¯è™šå‡½æ•°\nå¼•å…¥è™šå‡½æ•°æ˜¯ä¸ºäº†åŠ¨æ€ç»‘å®š,å¼•å…¥è™šå‡½æ•°æ˜¯ä¸ºäº†åŠ¨æ€ç»‘å®šã€‚\nåŸºç±»éœ€è¦è™šææ„å‡½æ•°çš„åŸå› \nå½“derived classç»ç”±ä¸€ä¸ªbase classæŒ‡é’ˆè¢«åˆ é™¤è€Œè¯¥base classçš„ææ„å‡½æ•°ä¸ºnon-virtualæ—¶ï¼Œå°†å‘ç”Ÿæœªå®šä¹‰è¡Œä¸ºã€‚é€šå¸¸å°†å‘ç”Ÿèµ„æºæ³„æ¼ã€‚\nè§£å†³æ–¹æ³•å³ä¸ºï¼šä¸ºå¤šæ€åŸºç±»å£°æ˜ä¸€ä¸ªvirtual ææ„å‡½æ•°ã€‚\nğŸ– C++11æ–°ç‰¹æ€§  è‡ªåŠ¨ç±»å‹æ¨æ–­ auto åŒ¿åå‡½æ•° Lambda æ™ºèƒ½æŒ‡é’ˆ æ˜¾ç¤ºé‡å†™(è¦†ç›–)overrideå’Œfinal  ğŸ“‡const å…³é”®å­—constå‡ºç°åœ¨æ˜Ÿå·å·¦è¾¹ï¼Œè¡¨ç¤ºè¢«æŒ‡ç‰©æ˜¯å¸¸é‡ï¼›å¦‚æœå‡ºç°åœ¨æ˜Ÿå·å³è¾¹ï¼Œè¡¨ç¤ºæŒ‡é’ˆæœ¬èº«æ˜¯å¸¸é‡ï¼›å¦‚æœå‡ºç°åœ¨ä¸¤è¾¹ï¼Œè¡¨ç¤ºè¢«æŒ‡ç‰©å’ŒæŒ‡é’ˆéƒ½æ˜¯å¸¸é‡ã€‚\nä½œç”¨ï¼š\n ä¿®é¥°å˜é‡ï¼Œè¯´æ˜è¯¥å˜é‡ä¸å¯ä»¥è¢«æ”¹å˜ï¼› ä¿®é¥°æŒ‡é’ˆï¼Œåˆ†ä¸ºæŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆï¼ˆpointer to constï¼‰å’Œè‡ªèº«æ˜¯å¸¸é‡çš„æŒ‡é’ˆï¼ˆå¸¸é‡æŒ‡é’ˆï¼Œconst pointerï¼‰ï¼› ä¿®é¥°å¼•ç”¨ï¼ŒæŒ‡å‘å¸¸é‡çš„å¼•ç”¨ï¼ˆreference to constï¼‰ï¼Œç”¨äºå½¢å‚ç±»å‹ï¼Œå³é¿å…äº†æ‹·è´ï¼Œåˆé¿å…äº†å‡½æ•°å¯¹å€¼çš„ä¿®æ”¹ï¼› ä¿®é¥°æˆå‘˜å‡½æ•°ï¼Œè¯´æ˜è¯¥æˆå‘˜å‡½æ•°å†…ä¸èƒ½ä¿®æ”¹æˆå‘˜å˜é‡ã€‚  ğŸ—½Static   é™æ€å¸¸é‡æ•´æ•°æˆå‘˜å¯ä»¥åœ¨ç±»å†…è¿›è¡Œåˆå§‹åŒ–ï¼Œå…¶ä»–éœ€è¦åœ¨ç±»å¤–é¢è¿›è¡Œåˆå§‹åŒ–\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  #include \u0026lt;iostream\u0026gt;using namespace std; class A{ public: static const int val = 5; static int GG; }; int A::GG = 6; int main() { cout \u0026lt;\u0026lt; A::val \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; A::GG \u0026lt;\u0026lt; endl; return 0; }   5 6   C++æ”¯æŒé‡è½½ï¼ŒCä¸æ”¯æŒé‡è½½\nğŸ“¤ extern \u0026ldquo;C\u0026quot;ä½œç”¨ extern \u0026ldquo;C\u0026quot;çš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¸ºäº†èƒ½å¤Ÿæ­£ç¡®å®ç°C++ä»£ç è°ƒç”¨å…¶ä»–Cè¯­è¨€ä»£ç ã€‚åŠ ä¸Šextern \u0026ldquo;C\u0026quot;åï¼Œä¼šæŒ‡ç¤ºç¼–è¯‘å™¨è¿™éƒ¨åˆ†ä»£ç æŒ‰Cè¯­è¨€ï¼ˆè€Œä¸æ˜¯C++ï¼‰çš„æ–¹å¼è¿›è¡Œç¼–è¯‘ã€‚ç”±äºC++æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘å™¨ç¼–è¯‘å‡½æ•°çš„è¿‡ç¨‹ä¸­ä¼šå°†å‡½æ•°çš„å‚æ•°ç±»å‹ä¹ŸåŠ åˆ°ç¼–è¯‘åçš„ä»£ç ä¸­ï¼Œè€Œä¸ä»…ä»…æ˜¯å‡½æ•°åï¼›è€ŒCè¯­è¨€å¹¶ä¸æ”¯æŒå‡½æ•°é‡è½½ï¼Œå› æ­¤ç¼–è¯‘Cè¯­è¨€ä»£ç çš„å‡½æ•°æ—¶ä¸ä¼šå¸¦ä¸Šå‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œä¸€èˆ¬åªåŒ…æ‹¬å‡½æ•°åã€‚\nè¿™ä¸ªåŠŸèƒ½ååˆ†æœ‰ç”¨å¤„ï¼Œå› ä¸ºåœ¨C++å‡ºç°ä»¥å‰ï¼Œå¾ˆå¤šä»£ç éƒ½æ˜¯Cè¯­è¨€å†™çš„ï¼Œè€Œä¸”å¾ˆåº•å±‚çš„åº“ä¹Ÿæ˜¯Cè¯­è¨€å†™çš„ï¼Œä¸ºäº†æ›´å¥½çš„æ”¯æŒåŸæ¥çš„Cä»£ç å’Œå·²ç»å†™å¥½çš„Cè¯­è¨€åº“ï¼Œéœ€è¦åœ¨C++ä¸­å°½å¯èƒ½çš„æ”¯æŒCï¼Œè€Œextern \u0026ldquo;C\u0026quot;å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªç­–ç•¥ã€‚\n å¦‚æœC++è°ƒç”¨ä¸€ä¸ªCè¯­è¨€ç¼–å†™çš„.DLLæ—¶ï¼Œå½“åŒ…æ‹¬.DLLçš„å¤´æ–‡ä»¶æˆ–å£°æ˜æ¥å£å‡½æ•°æ—¶ï¼Œåº”åŠ extern \u0026ldquo;C\u0026rdquo; {ã€€}ã€‚  ğŸ“Œinlineå†…è”å‡½æ•° staticé™æ€å‡½æ•° æ™®é€šå‡½æ•°åŒºåˆ« é¢è¯•æ—¶å€™ä¸€èˆ¬åªä¼šé—®ä½ åŒºåˆ«ï¼Œæ‰€æœ‰æœ¬æ–‡åªè¯´åŒºåˆ«ã€‚\nå†…è”å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«ï¼š\nå†…è”å‡½æ•°å’Œæ™®é€šå‡½æ•°æœ€å¤§çš„åŒºåˆ«åœ¨äºå†…éƒ¨çš„å®ç°æ–¹é¢ï¼Œå½“æ™®é€šå‡½æ•°åœ¨è¢«è°ƒç”¨æ—¶ï¼Œç³»ç»Ÿé¦–å…ˆè·³è·ƒåˆ°è¯¥å‡½æ•°çš„å…¥å£åœ°å€ï¼Œæ‰§è¡Œå‡½æ•°ä½“ï¼Œæ‰§è¡Œå®Œæˆåï¼Œå†è¿”å›åˆ°å‡½æ•°è°ƒç”¨çš„åœ°æ–¹ï¼Œå‡½æ•°å§‹ç»ˆåªæœ‰ä¸€ä¸ªæ‹·è´ï¼› è€Œå†…è”å‡½æ•°åˆ™ä¸éœ€è¦è¿›è¡Œä¸€ä¸ªå¯»å€çš„è¿‡ç¨‹ï¼Œå½“æ‰§è¡Œåˆ°å†…è”å‡½æ•°æ—¶ï¼Œæ­¤å‡½æ•°å±•å¼€ï¼ˆå¾ˆç±»ä¼¼å®çš„ä½¿ç”¨ï¼‰ï¼Œå¦‚æœåœ¨ Nå¤„è°ƒç”¨äº†æ­¤å†…è”å‡½æ•°ï¼Œåˆ™æ­¤å‡½æ•°å°±ä¼šæœ‰Nä¸ªä»£ç æ®µçš„æ‹·è´ã€‚\né™æ€å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«ï¼š\nstaticå‡½æ•°å’Œæ™®é€šå‡½æ•°çš„æœ€å¤§çš„åŒºåˆ«åœ¨äºä½œç”¨åŸŸæ–¹é¢ï¼Œstaticå‡½æ•°é™å®šåœ¨æœ¬æºç æ–‡ä»¶ä¸­ï¼Œä¸èƒ½è¢«æœ¬æºç æ–‡ä»¶ä»¥å¤–çš„ä»£ç æ–‡ä»¶è°ƒç”¨ã€‚è€Œæ™®é€šçš„å‡½æ•°ï¼Œé»˜è®¤æ˜¯externçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥è¢«å…¶å®ƒä»£ç æ–‡ä»¶è°ƒç”¨è¯¥å‡½æ•°ã€‚åŒæ—¶staticå‡½æ•°åœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä»½ï¼Œæ™®é€šå‡½æ•°åœ¨æ¯ä¸ªè¢«è°ƒç”¨ä¸­ç»´æŒä¸€ä»½æ‹·è´ã€‚\ninlineä¸defineçš„åŒºåˆ«ï¼š\nå†…è”å‡½æ•°å’Œå®çš„åŒºåˆ«åœ¨äºï¼Œå®æ˜¯ç”±é¢„å¤„ç†å™¨å¯¹å®è¿›è¡Œæ›¿ä»£ï¼Œè€Œå†…è”å‡½æ•°æ˜¯é€šè¿‡ç¼–è¯‘å™¨æ§åˆ¶æ¥å®ç°çš„ã€‚è€Œä¸”å†…è”å‡½æ•°æ˜¯çœŸæ­£çš„å‡½æ•°ï¼Œåªæ˜¯åœ¨éœ€è¦ç”¨åˆ°çš„æ—¶å€™ï¼Œå†…è”å‡½æ•°åƒå®ä¸€æ ·çš„å±•å¼€ï¼Œæ‰€ä»¥å–æ¶ˆäº†å‡½æ•°çš„å‚æ•°å‹æ ˆï¼Œå‡å°‘äº†è°ƒç”¨çš„å¼€é”€ã€‚ä½ å¯ä»¥è±¡è°ƒç”¨å‡½æ•°ä¸€æ ·æ¥è°ƒç”¨å†…è”å‡½æ•°ï¼Œè€Œä¸å¿…æ‹…å¿ƒä¼šäº§ç”Ÿäºå¤„ç†å®çš„ä¸€äº›é—®é¢˜ã€‚å†…è”å‡½æ•°ä¸å¸¦å‚æ•°çš„å®å®šä¹‰è¿›è¡Œä¸‹æ¯”è¾ƒï¼Œå®ƒä»¬çš„ä»£ç æ•ˆç‡æ˜¯ä¸€æ ·ï¼Œä½†æ˜¯å†…è”æ¬¢å‡½æ•°è¦ä¼˜äºå®å®šä¹‰ï¼Œå› ä¸ºå†…è”å‡½æ•°éµå¾ªçš„ç±»å‹å’Œä½œç”¨åŸŸè§„åˆ™ï¼Œå®ƒä¸ä¸€èˆ¬å‡½æ•°æ›´ç›¸è¿‘ï¼Œåœ¨ä¸€äº›ç¼–è¯‘å™¨ä¸­ï¼Œä¸€æ—¦å…³ä¸Šå†…è”æ‰©å±•ï¼Œå°†ä¸ä¸€èˆ¬å‡½æ•°ä¸€æ ·è¿›è¡Œè°ƒç”¨ï¼Œæ¯”è¾ƒæ–¹ä¾¿ã€‚\ninlineä½¿ç”¨ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  // å£°æ˜1ï¼ˆåŠ  inlineï¼Œå»ºè®®ä½¿ç”¨ï¼‰ inline int functionName(int first, int second,...); // å£°æ˜2ï¼ˆä¸åŠ  inlineï¼‰ int functionName(int first, int second,...); // å®šä¹‰ inline int functionName(int first, int second,...) {/****/}; // ç±»å†…å®šä¹‰ï¼Œéšå¼å†…è” class A { int doA() { return 0; } // éšå¼å†…è” } // ç±»å¤–å®šä¹‰ï¼Œéœ€è¦æ˜¾å¼å†…è” class A { int doA(); } inline int A::doA() { return 0; } // éœ€è¦æ˜¾å¼å†…è”   ä¼˜ç¼ºç‚¹ï¼š\nä¼˜ç‚¹\n å†…è”å‡½æ•°åŒå®å‡½æ•°ä¸€æ ·å°†åœ¨è¢«è°ƒç”¨å¤„è¿›è¡Œä»£ç å±•å¼€ï¼Œçœå»äº†å‚æ•°å‹æ ˆã€æ ˆå¸§å¼€è¾Ÿä¸å›æ”¶ï¼Œç»“æœè¿”å›ç­‰ï¼Œä»è€Œæé«˜ç¨‹åºè¿è¡Œé€Ÿåº¦ã€‚ å†…è”å‡½æ•°ç›¸æ¯”å®å‡½æ•°æ¥è¯´ï¼Œåœ¨ä»£ç å±•å¼€æ—¶ï¼Œä¼šåšå®‰å…¨æ£€æŸ¥æˆ–è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆåŒæ™®é€šå‡½æ•°ï¼‰ï¼Œè€Œå®å®šä¹‰åˆ™ä¸ä¼šã€‚ åœ¨ç±»ä¸­å£°æ˜åŒæ—¶å®šä¹‰çš„æˆå‘˜å‡½æ•°ï¼Œè‡ªåŠ¨è½¬åŒ–ä¸ºå†…è”å‡½æ•°ï¼Œå› æ­¤å†…è”å‡½æ•°å¯ä»¥è®¿é—®ç±»çš„æˆå‘˜å˜é‡ï¼Œå®å®šä¹‰åˆ™ä¸èƒ½ã€‚ å†…è”å‡½æ•°åœ¨è¿è¡Œæ—¶å¯è°ƒè¯•ï¼Œè€Œå®å®šä¹‰ä¸å¯ä»¥ã€‚  ç¼ºç‚¹\n ä»£ç è†¨èƒ€ã€‚å†…è”æ˜¯ä»¥ä»£ç è†¨èƒ€ï¼ˆå¤åˆ¶ï¼‰ä¸ºä»£ä»·ï¼Œæ¶ˆé™¤å‡½æ•°è°ƒç”¨å¸¦æ¥çš„å¼€é”€ã€‚å¦‚æœæ‰§è¡Œå‡½æ•°ä½“å†…ä»£ç çš„æ—¶é—´ï¼Œç›¸æ¯”äºå‡½æ•°è°ƒç”¨çš„å¼€é”€è¾ƒå¤§ï¼Œé‚£ä¹ˆæ•ˆç‡çš„æ”¶è·ä¼šå¾ˆå°‘ã€‚å¦ä¸€æ–¹é¢ï¼Œæ¯ä¸€å¤„å†…è”å‡½æ•°çš„è°ƒç”¨éƒ½è¦å¤åˆ¶ä»£ç ï¼Œå°†ä½¿ç¨‹åºçš„æ€»ä»£ç é‡å¢å¤§ï¼Œæ¶ˆè€—æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚ inline å‡½æ•°æ— æ³•éšç€å‡½æ•°åº“å‡çº§è€Œå‡çº§ã€‚inlineå‡½æ•°çš„æ”¹å˜éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œä¸åƒ non-inline å¯ä»¥ç›´æ¥é“¾æ¥ã€‚ æ˜¯å¦å†…è”ï¼Œç¨‹åºå‘˜ä¸å¯æ§ã€‚å†…è”å‡½æ•°åªæ˜¯å¯¹ç¼–è¯‘å™¨çš„å»ºè®®ï¼Œæ˜¯å¦å¯¹å‡½æ•°å†…è”ï¼Œå†³å®šæƒåœ¨äºç¼–è¯‘å™¨ã€‚  å‚è€ƒï¼š\n inlineå†…è”å‡½æ•° staticé™æ€å‡½æ•° æ™®é€šå‡½æ•°åŒºåˆ« C++ inlineå’Œ#defineå®çš„åŒºåˆ«  ğŸ’ŸC++å†…å­˜å¸ƒå±€   å†…æ ¸ç©ºé—´\n  æ ˆ\n1ã€stackå­˜æ”¾å‡½æ•°çš„ä¸´æ—¶å˜é‡ã€å±€éƒ¨å˜é‡ã€å‡½æ•°å‚æ•°å’Œè¿”å›å€¼\n2ã€ç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾ã€‚\n  åŠ¨æ€é“¾æ¥åº“(å…±äº«æ˜ å°„åŒº)\nè°ƒç”¨çš„åº“æ–‡ä»¶ï¼Œä½äºå †å’Œæ ˆä¹‹é—´\n  å †\nheapç”¨æ¥åŠ¨æ€åˆ†é…å†…å­˜ï¼Œç”±ç¨‹åºå‘˜æ§åˆ¶ï¼Œäº¤ç”±ç¨‹åºè‡ªèº«å†³å®šå¼€è¾Ÿå’Œé‡Šæ”¾ã€‚\n  å…¨å±€æ•°æ®åŒº\n.bss\nbssæ®µç”¨æ¥å­˜æ”¾æ²¡æœ‰è¢«åˆå§‹åŒ–å’Œå·²ç»è¢«åˆå§‹åŒ–ä¸º0çš„å…¨å±€å˜é‡\n.data\ndataæ®µç”¨æ¥å­˜æ”¾å·²ç»è¢«åˆå§‹åŒ–ä¸ºé0çš„å…¨å±€å˜é‡\n  å¸¸é‡åŒº\n.rodata\nrodataæ®µç”¨æ¥å­˜æ”¾å¸¸é‡æ•°æ®ã€è¢«ç¼–è¯‘å™¨è‡ªåŠ¨å­˜æ”¾æ¥çš„å­—ç¬¦ä¸²å’ŒåŠ constå…³é”®å­—çš„å¸¸é‡æ•°æ®ã€‚\n  ä»£ç åŒº\n.text\ntextæ®µç”¨æ¥å­˜æ”¾ä»£ç å’Œéƒ¨åˆ†æ•´æ•°å¸¸é‡ï¼Œè¯¥æ®µæ˜¯å¯æ‰§è¡Œçš„ã€‚\n  ğŸ’± C++ç©ºç±»äº§ç”Ÿå“ªäº›æˆå‘˜å‡½æ•° æ„é€ ã€æ‹·è´æ„é€ ã€èµ‹å€¼ã€ææ„ã€å–åœ°å€ã€å–åœ°å€constï¼Œ\nC++ ç©ºç±»é»˜è®¤äº§ç”Ÿçš„ç±»æˆå‘˜å‡½æ•°\nâœˆ æŒ‡é’ˆå¸¸è§é”™è¯¯ é¢è¯•é¢˜Getmemory\nğŸš™ Cçš„å†…å­˜ç»“æ„ Cè¯­è¨€å†…å­˜å¸ƒå±€\nğŸ—¡ç¨‹åºè¿è¡Œæ—¶å†…å­˜åˆ†é… å˜é‡å’Œå‡½æ•°å ç”¨çš„å†…å­˜æ˜¯ç³»ç»Ÿåœ¨ç¨‹åºè¿è¡Œæ—¶ä¸ºç¨‹åºåˆ†é…çš„ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„å˜é‡å’Œå‡½æ•°éƒ½è¢«åˆ†é…åœ¨åŒä¸€å—å†…å­˜åŒºåŸŸä¸­ã€‚å¯¹äºä¸€ä¸ªC++ç¨‹åºæ¥è¯´ï¼Œç³»ç»Ÿä¸€èˆ¬é‡‡ç”¨3ç§æ–¹å¼ä¸ºç¨‹åºåˆ†é…å†…å­˜ï¼Œä¸‹é¢å°†åˆ†åˆ«ä»‹ç»è¿™3ç§æ–¹å¼ã€‚\n  ä»é™æ€å­˜å‚¨åŒºåŸŸåˆ†é…\n**è¿™éƒ¨åˆ†å†…å­˜åœ¨ç¨‹åºç¼–è¯‘çš„æ—¶å€™å°±å·²ç»åˆ†é…å¥½ï¼Œå¹¶ä¸”è¿™å—å†…å­˜åœ¨ç¨‹åºçš„æ•´ä¸ªè¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ã€‚ä¾‹å¦‚åœ¨å‡½æ•°å¤–å®šä¹‰çš„å…¨å±€å˜é‡ï¼Œä»¥åŠåœ¨åˆ›å»ºæ—¶ä½¿ç”¨staticä¿®é¥°ç¬¦çš„å˜é‡ã€‚**åœ¨è¯¥åŒºåŸŸå­˜å‚¨çš„å†…å®¹ä¸€èˆ¬æ˜¯å…¨å±€å˜é‡ï¼Œå…¶ä¸­å­˜å‚¨åœ¨æ•°æ®æ®µä¸­çš„å…¨å±€å˜é‡é€šå¸¸å·²ç»è¢«åˆå§‹åŒ–ã€‚\n  åœ¨æ ˆä¸Šè¿›è¡Œå†…å­˜åˆ†é…\nè¿™éƒ¨åˆ†åŒºåŸŸè¢«ç§°ä¸ºå †æ ˆï¼Œä½†è¿™åªæ˜¯ä¸€ç§ä¹ æƒ¯æ€§è¯´æ³•ï¼Œå¹¶ä¸æ˜¯å †å’Œæ ˆçš„ç»Ÿç§°ã€‚è¯¥éƒ¨åˆ†å­˜å‚¨çš„å˜é‡ä¸€èˆ¬æ˜¯åœ¨å‡½æ•°ä½“ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡ï¼ˆä¸åŒ…æ‹¬staticå£°æ˜çš„å˜é‡ï¼Œstaticæ„å‘³ç€å˜é‡å­˜æ”¾åœ¨æ•°æ®æ®µä¸­ï¼‰ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œç»å¸¸åœ¨æ ˆåŒºå‡ºç°çš„è¿˜æœ‰ä¼ é€’ç»™å‡½æ•°çš„å‚æ•°å’Œå‡½æ•°çš„è¿”å›å€¼ç­‰ã€‚æ ˆåŒºå˜é‡çš„ç”Ÿå­˜å‘¨æœŸæ˜¯åœ¨å…¥æ ˆå‰ï¼ˆå‡½æ•°å¼€å§‹è¢«è°ƒç”¨ï¼‰è·å¾—å†…å­˜ç©ºé—´ï¼Œè€Œåœ¨å‡ºæ ˆæ—¶ï¼ˆå‡½æ•°ç»“æŸè°ƒç”¨ï¼‰é‡Šæ”¾å†…å­˜ç©ºé—´ã€‚å› æ­¤å°½é‡ä¸è¦å°†å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ï¼Œå› ä¸ºåœ¨å‡½æ•°è°ƒç”¨ç»“æŸåï¼Œå±€éƒ¨å˜é‡å°±ä¸å­˜åœ¨äº†ï¼Œå†ä½¿ç”¨æ­¤å˜é‡çš„å€¼ä½œä¸ºè¿”å›å€¼ï¼Œä¼šä½¿ç¨‹åºè·å–çš„è¿”å›å€¼æœ‰å¯èƒ½ä¸ºéšæœºæ•°ã€‚åœ¨æ‰§è¡Œå‡½æ•°æ—¶ï¼Œå‡½æ•°ä½“å†…çš„å±€éƒ¨å˜é‡åœ¨æ ˆä¸Šè¢«è‡ªåŠ¨åˆ›å»ºï¼Œè€Œåœ¨å‡½æ•°æ‰§è¡Œç»“æŸæ—¶ï¼Œè¿™äº›å­˜å‚¨å•å…ƒè‡ªåŠ¨è¢«é‡Šæ”¾ã€‚æ ˆå†…å­˜åˆ†é…ç”±æ“ä½œç³»ç»Ÿå®Œæˆè€Œä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨å‚ä¸ã€‚å› æ­¤å…¶æ‰§è¡Œæ•ˆç‡éå¸¸é«˜ã€‚ä½†æ˜¯æ•´ä¸ªæ ˆåŒºå¯ä»¥è¢«åˆ†é…çš„å†…å­˜å®¹é‡æœ‰é™ã€‚å› æ­¤å®šä¹‰è¿‡å¤šçš„æœªä½¿ç”¨çš„å±€éƒ¨å˜é‡ä¼šä½¿ç¨‹åºæ‰§è¡Œå˜æ…¢ã€‚\n  ä»å †ä¸Šåˆ†é…\né€šå¸¸ç§°ä¸ºåŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œè¯¥éƒ¨åˆ†å†…å­˜åŒºåŸŸçš„å¤§å°å¹¶ä¸å›ºå®šï¼Œå½“ç¨‹åºè¿è¡Œæ—¶æœ‰ç¨‹åºå‘˜ç”¨ malloc() å‡½æ•°ç­‰å†…å­˜åˆ†é…å‡½æ•°æ¥åˆ†é…ï¼Œæˆ–ä½¿ç”¨ new æ“ä½œç¬¦ç­‰ç³»ç»Ÿæä¾›çš„å‡½æ•°æ¥åˆ†é…ã€‚è¯¥å†…å­˜çš„å¤§å°å¯ä»¥æ ¹æ®ç¨‹åºä¸­çš„å®é™…éœ€è¦æ¥æŒ‡å®šã€‚è¯¥éƒ¨åˆ†å†…å­˜ç©ºé—´ä¸ä¼šéšç€å‡½æ•°è¿è¡Œçš„ç»“æŸè€Œè¢«è‡ªåŠ¨å›æ”¶ï¼Œä¹Ÿä¸ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾ï¼Œéœ€è¦ç¨‹åºå‘˜è‡ªå·±ç”¨ free() å‡½æ•°æˆ– delete æ“ä½œç¬¦è¿›è¡Œå†…å­˜çš„å›æ”¶ã€‚åŠ¨æ€å†…å­˜çš„ç”Ÿå­˜æœŸç”±ç¨‹åºå‘˜è‡ªè¡Œå†³å®šï¼Œä½†å¦‚æœåˆ†é…äº†ç©ºé—´ï¼Œå°±å¿…é¡»å¯¹å…¶å›æ”¶ï¼Œå¦åˆ™è¿è¡Œçš„ç¨‹åºä¼šå‡ºç°å†…å­˜æ³„æ¼ï¼Œå¹¶ä¸”é¢‘ç¹åœ°åˆ†é…å’Œé‡Šæ”¾ä¸åŒå¤§å°çš„å †ç©ºé—´å°†ä¼šäº§ç”Ÿå †å†…ç¢å—ï¼Œé—´æ¥é™ä½å†…å­˜ç©ºé—´çš„ä½¿ç”¨ç‡ï¼Œä¸¥é‡æ—¶ä¼šäº§ç”Ÿå¤§é‡å†…å­˜ç¢ç‰‡ã€‚\n  ã€€ï¼ˆå†…å­˜ç¢ç‰‡æ˜¯ä¸€äº›åˆ†æ•£çš„å†…å­˜åŒºåŸŸï¼Œå¤§é‡å†…å­˜ç¢ç‰‡çš„å­˜åœ¨ä¼šé™ä½å†…å­˜çš„ä½¿ç”¨ç‡ã€‚ï¼‰\nğŸ‘½structå­—èŠ‚å¯¹é½é—®é¢˜ 1 2 3 4 5 6 7  typedef struct { char c1; short s; char c2; int i; } T_FOO;   ä¸Šé¢çš„ç»“æ„ä½“ä½¿ç”¨sizeofè¾“å‡ºå¤§å°ä¸º12ã€‚ï¼ˆå‡è®¾è¿™ä¸ªç»“æ„ä½“çš„æˆå‘˜åœ¨å†…å­˜ä¸­æ˜¯ç´§å‡‘æ’åˆ—çš„ï¼Œä¸”c1çš„èµ·å§‹åœ°å€æ˜¯0ï¼Œåˆ™sçš„åœ°å€å°±æ˜¯1ï¼Œc2çš„åœ°å€æ˜¯3ï¼Œiçš„åœ°å€æ˜¯4ï¼‰\nå­—èŠ‚å¯¹é½\nç°ä»£è®¡ç®—æœºä¸­ï¼Œå†…å­˜ç©ºé—´æŒ‰ç…§å­—èŠ‚åˆ’åˆ†ï¼Œç†è®ºä¸Šå¯ä»¥ä»ä»»ä½•èµ·å§‹åœ°å€è®¿é—®ä»»æ„ç±»å‹çš„å˜é‡ã€‚ä½†å®é™…ä¸­åœ¨è®¿é—®ç‰¹å®šç±»å‹å˜é‡æ—¶ç»å¸¸åœ¨ç‰¹å®šçš„å†…å­˜åœ°å€è®¿é—®ï¼Œè¿™å°±éœ€è¦å„ç§ç±»å‹æ•°æ®æŒ‰ç…§ä¸€å®šçš„è§„åˆ™åœ¨ç©ºé—´ä¸Šæ’åˆ—ï¼Œè€Œä¸æ˜¯é¡ºåºä¸€ä¸ªæ¥ä¸€ä¸ªåœ°å­˜æ”¾ï¼Œè¿™å°±æ˜¯å¯¹é½ã€‚\nå¯¹é½çš„åŸå› å’Œä½œç”¨\n  ä¸åŒç¡¬ä»¶å¹³å°å¯¹å­˜å‚¨ç©ºé—´çš„å¤„ç†ä¸Šå­˜åœ¨å¾ˆå¤§çš„ä¸åŒã€‚æŸäº›å¹³å°å¯¹ç‰¹å®šç±»å‹çš„æ•°æ®åªèƒ½ä»ç‰¹å®šåœ°å€å¼€å§‹å­˜å–ï¼Œè€Œä¸å…è®¸å…¶åœ¨å†…å­˜ä¸­ä»»æ„å­˜æ”¾ã€‚ä¾‹å¦‚Motorola 68000 å¤„ç†å™¨ä¸å…è®¸16ä½çš„å­—å­˜æ”¾åœ¨å¥‡åœ°å€ï¼Œå¦åˆ™ä¼šè§¦å‘å¼‚å¸¸ï¼Œå› æ­¤åœ¨è¿™ç§æ¶æ„ä¸‹ç¼–ç¨‹å¿…é¡»ä¿è¯å­—èŠ‚å¯¹é½ã€‚\n  ä½†æœ€å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œå¦‚æœä¸æŒ‰ç…§å¹³å°è¦æ±‚å¯¹æ•°æ®å­˜æ”¾è¿›è¡Œå¯¹é½ï¼Œä¼šå¸¦æ¥å­˜å–æ•ˆç‡ä¸Šçš„æŸå¤±ã€‚æ¯”å¦‚32ä½çš„Intelå¤„ç†å™¨é€šè¿‡æ€»çº¿è®¿é—®(åŒ…æ‹¬è¯»å’Œå†™)å†…å­˜æ•°æ®ã€‚æ¯ä¸ªæ€»çº¿å‘¨æœŸä»å¶åœ°å€å¼€å§‹è®¿é—®32ä½å†…å­˜æ•°æ®ï¼Œå†…å­˜æ•°æ®ä»¥å­—èŠ‚ä¸ºå•ä½å­˜æ”¾ã€‚å¦‚æœä¸€ä¸ª32ä½çš„æ•°æ®æ²¡æœ‰å­˜æ”¾åœ¨4å­—èŠ‚æ•´é™¤çš„å†…å­˜åœ°å€å¤„ï¼Œé‚£ä¹ˆå¤„ç†å™¨å°±éœ€è¦2ä¸ªæ€»çº¿å‘¨æœŸå¯¹å…¶è¿›è¡Œè®¿é—®ï¼Œæ˜¾ç„¶è®¿é—®æ•ˆç‡ä¸‹é™å¾ˆå¤šã€‚\nå› æ­¤ï¼Œé€šè¿‡åˆç†çš„å†…å­˜å¯¹é½å¯ä»¥æé«˜è®¿é—®æ•ˆç‡ã€‚ä¸ºä½¿CPUèƒ½å¤Ÿå¯¹æ•°æ®è¿›è¡Œå¿«é€Ÿè®¿é—®ï¼Œæ•°æ®çš„èµ·å§‹åœ°å€åº”å…·æœ‰â€œå¯¹é½â€ç‰¹æ€§ã€‚æ¯”å¦‚4å­—èŠ‚æ•°æ®çš„èµ·å§‹åœ°å€åº”ä½äº4å­—èŠ‚è¾¹ç•Œä¸Šï¼Œå³èµ·å§‹åœ°å€èƒ½å¤Ÿè¢«4æ•´é™¤\n  æ­¤å¤–ï¼Œåˆç†åˆ©ç”¨å­—èŠ‚å¯¹é½è¿˜å¯ä»¥æœ‰æ•ˆåœ°èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚ä½†è¦æ³¨æ„ï¼Œåœ¨32ä½æœºä¸­ä½¿ç”¨1å­—èŠ‚æˆ–2å­—èŠ‚å¯¹é½ï¼Œåè€Œä¼šé™ä½å˜é‡è®¿é—®é€Ÿåº¦ã€‚å› æ­¤éœ€è¦è€ƒè™‘å¤„ç†å™¨ç±»å‹ã€‚è¿˜åº”è€ƒè™‘ç¼–è¯‘å™¨çš„ç±»å‹ã€‚åœ¨VC/C++å’ŒGNU GCCä¸­éƒ½æ˜¯é»˜è®¤æ˜¯4å­—èŠ‚å¯¹é½ã€‚\n  å¯¹é½å‡†åˆ™\n  sizeofçš„æœ€ç»ˆç»“æœå¿…ç„¶æ˜¯ç»“æ„å†…éƒ¨æœ€å¤§æˆå‘˜çš„æ•´æ•°å€ï¼Œä¸å¤Ÿè¡¥é½ã€‚\n  ç»“æ„å†…éƒ¨å„ä¸ªæˆå‘˜çš„é¦–åœ°å€å¿…ç„¶æ˜¯è‡ªèº«å¤§å°çš„æ•´æ•°å€ã€‚\nå¦‚æœå®šä¹‰äº†#pragma pack(n)ï¼Œåˆ™ä¸Šè¿°ä¿©æ¡è§„åˆ™å¯å®šä¹‰ä¸ºï¼š\n1ã€æ•´ä¸ªsizeofçš„æœ€ç»ˆç»“æœå¿…ç„¶æ˜¯ min[n,ç»“æ„å†…éƒ¨æœ€å¤§æˆå‘˜] çš„æ•´æ•°å€ï¼Œä¸å¤Ÿè¡¥é½ã€‚\n2ã€ç»“æ„å†…éƒ¨å„ä¸ªæˆå‘˜çš„é¦–åœ°å€å¿…ç„¶æ˜¯min[n,è‡ªèº«å¤§å°]çš„æ•´æ•°å€ã€‚\n ç”±ä¸Šè¿°åŸåˆ™å¯çŸ¥ï¼Œåœ¨å†™ç»“æ„ä½“æ—¶ï¼Œæˆå‘˜å…ˆåä¸è¦éšæ„å†™å“¦ï¼Œåº”éµå¾ªä»å¤§åˆ°å°çš„åŸåˆ™ï¼Œè¿™æ ·æœ‰åŠ©äºèŠ‚çœç©ºé—´ã€‚\n   ä½¿ç”¨å››å­—èŠ‚å¯¹é½ï¼š\n1 2 3 4 5 6 7 8 9 10  #pragma pack(push)#pragma pack(4)typedef struct { char c1; short s; char c2; int i; } T_FOO; #pragma pack(pop)  å¯¹å…¶ä½¿ç”¨sizeofå¾—åˆ°çš„å¤§å°ä¸º12\nä¸ä½¿ç”¨å­—èŠ‚å¯¹é½ï¼Œå³ä½¿ç”¨1å­—èŠ‚å¯¹é½ï¼š\n1 2 3 4 5 6 7 8 9 10  #pragma pack(push)#pragma pack(1)typedef struct { char c1; short s; char c2; int i; } T_FOO; #pragma pack(pop)  å¤§å°ä¸º8\nå‚è€ƒï¼šCè¯­è¨€å­—èŠ‚å¯¹é½é—®é¢˜è¯¦è§£\nâ“œmallocä¸€æ¬¡æ€§æœ€å¤§èƒ½ç”³è¯·å¤šå¤§å†…å­˜ç©ºé—´ï¼Ÿ å…·ä½“æƒ…å†µåˆ†æ\nğŸ”¶å­—èŠ‚åºäº†è§£å—ï¼Ÿè®²ä¸€ä¸‹å¤§ç«¯å¯¹é½å’Œå°ç«¯å¯¹é½ ä¸»æœºå­—èŠ‚åºåˆå« CPU å­—èŠ‚åºï¼Œå…¶ä¸æ˜¯ç”±æ“ä½œç³»ç»Ÿå†³å®šçš„ï¼Œè€Œæ˜¯ç”± CPU æŒ‡ä»¤é›†æ¶æ„å†³å®šçš„ã€‚ä¸»æœºå­—èŠ‚åºåˆ†ä¸ºä¸¤ç§ï¼š\n å¤§ç«¯å­—èŠ‚åºï¼ˆBig Endianï¼‰ï¼šé«˜åºå­—èŠ‚å­˜å‚¨åœ¨ä½ä½åœ°å€ï¼Œä½åºå­—èŠ‚å­˜å‚¨åœ¨é«˜ä½åœ°å€ å°ç«¯å­—èŠ‚åºï¼ˆLittle Endianï¼‰ï¼šé«˜åºå­—èŠ‚å­˜å‚¨åœ¨é«˜ä½åœ°å€ï¼Œä½åºå­—èŠ‚å­˜å‚¨åœ¨ä½ä½åœ°å€  32 ä½æ•´æ•° 0x12345678 æ˜¯ä»èµ·å§‹ä½ç½®ä¸º 0x00 çš„åœ°å€å¼€å§‹å­˜æ”¾ï¼Œåˆ™ï¼š\n   å†…å­˜åœ°å€ 0x00 0x01 0x02 0x03     å¤§ç«¯ 12 34 56 78   å°ç«¯ 78 56 34 12    åˆ¤æ–­å¤§ç«¯å°ç«¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  #include \u0026lt;iostream\u0026gt;using namespace std; int main() { int i = 0x12345678; if (*((char*)\u0026amp;i) == 0x12) cout \u0026lt;\u0026lt; \u0026#34;å¤§ç«¯\u0026#34; \u0026lt;\u0026lt; endl; else cout \u0026lt;\u0026lt; \u0026#34;å°ç«¯\u0026#34; \u0026lt;\u0026lt; endl; return 0; }   ç½‘ç»œå­—èŠ‚é¡ºåºæ˜¯ TCP/IP ä¸­è§„å®šå¥½çš„ä¸€ç§æ•°æ®è¡¨ç¤ºæ ¼å¼ï¼Œå®ƒä¸å…·ä½“çš„ CPU ç±»å‹ã€æ“ä½œç³»ç»Ÿç­‰æ— å…³ï¼Œä»è€Œå¯ä»¥ä¿è¯æ•°æ®åœ¨ä¸åŒä¸»æœºä¹‹é—´ä¼ è¾“æ—¶èƒ½å¤Ÿè¢«æ­£ç¡®è§£é‡Šã€‚\nç½‘ç»œå­—èŠ‚é¡ºåºé‡‡ç”¨ï¼šå¤§ç«¯ï¼ˆBig Endianï¼‰æ’åˆ—æ–¹å¼ã€‚\nğŸ“å­—ç¬¦ä¸²ä¸å­—ç¬¦ä¸²æŒ‡é’ˆçš„å¤§å°  sizeof å¯¹æ•°ç»„ï¼Œå¾—åˆ°æ•´ä¸ªæ•°ç»„æ‰€å ç©ºé—´å¤§å°ã€‚ sizeof å¯¹æŒ‡é’ˆï¼Œå¾—åˆ°æŒ‡é’ˆæœ¬èº«æ‰€å ç©ºé—´å¤§å°ã€‚  å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9  char *a = \u0026#34;abcd\u0026#34;; cout \u0026lt;\u0026lt; \u0026#34;sizeof a = \u0026#34; \u0026lt;\u0026lt; sizeof(a) \u0026lt;\u0026lt; \u0026#34;\u0026#34; \u0026lt;\u0026lt; \u0026#34;strlen(a) = \u0026#34; \u0026lt;\u0026lt; strlen(a) \u0026lt;\u0026lt; endl; char b[] = \u0026#34;abcd\u0026#34;; cout \u0026lt;\u0026lt; \u0026#34;sizeof b = \u0026#34; \u0026lt;\u0026lt; sizeof(b) \u0026lt;\u0026lt; \u0026#34;\u0026#34; \u0026lt;\u0026lt; \u0026#34;strlen(b) = \u0026#34; \u0026lt;\u0026lt; strlen(b) \u0026lt;\u0026lt; endl; char c[10] = \u0026#34;abcd\u0026#34;; cout \u0026lt;\u0026lt; \u0026#34;sizeof c = \u0026#34; \u0026lt;\u0026lt; sizeof(c) \u0026lt;\u0026lt; \u0026#34;\u0026#34; \u0026lt;\u0026lt; \u0026#34;strlen(c) = \u0026#34; \u0026lt;\u0026lt; strlen(c) \u0026lt;\u0026lt; endl;   è¾“å‡ºä¸ºï¼š\nsizeof a = 8 strlen(a) = 4 sizeof b = 5 strlen(b) = 4 sizeof c = 10 strlen(c) = 4 strlen()çš„ç»“æœéƒ½ä¸€æ ·ï¼Œè¿”å›çš„æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦(ä¸è®¡\\0);ä½†æ˜¯sizeof()æ˜¯è¿”å›ç±»å‹çš„å¤§å°ï¼Œå‡å¦‚æ˜¯æŒ‡é’ˆï¼Œè¿”å›å½“å‰æ“ä½œç³»ç»Ÿåœ°å€æŒ‡é’ˆçš„å¤§å°ï¼›å‡å¦‚æ˜¯æ˜¾ç¤ºæ•°ç»„åˆå§‹åŒ–çš„æ•°ç»„ï¼Œå°±è¿”å›æ•°ç»„å®é™…å¤§å°çš„å­—èŠ‚æ•°ã€‚\nğŸ’ƒåŠ¨æ€é“¾æ¥å’Œé™æ€é“¾æ¥çš„åŒºåˆ« https://www.cnblogs.com/tracylee/archive/2012/10/15/2723816.html\né™æ€é“¾æ¥æ–¹å¼ï¼šåœ¨ç¨‹åºæ‰§è¡Œä¹‹å‰å®Œæˆæ‰€æœ‰çš„ç»„è£…å·¥ä½œï¼Œç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œçš„ç›®æ ‡æ–‡ä»¶ï¼ˆEXEæ–‡ä»¶ï¼‰ã€‚\nåŠ¨æ€é“¾æ¥æ–¹å¼ï¼šåœ¨ç¨‹åºå·²ç»ä¸ºäº†æ‰§è¡Œè¢«è£…å…¥å†…å­˜ä¹‹åå®Œæˆé“¾æ¥å·¥ä½œï¼Œå¹¶ä¸”åœ¨å†…å­˜ä¸­ä¸€èˆ¬åªä¿ç•™è¯¥ç¼–è¯‘å•å…ƒçš„ä¸€ä»½æ‹·è´ã€‚\nğŸ›©æ™ºèƒ½æŒ‡é’ˆçš„å¤šçº¿ç¨‹é—®é¢˜ ğŸª å…³äºtemplateçš„ä¸‰ä¸ªé—®é¢˜  templateçš„å£°æ˜ã€‚ å¦‚ä½•â€œå®ä¾‹åŒ–ï¼ˆinstantiatesï¼‰â€class objectã€inline nonmemberä»¥åŠ member templatefunctionsã€‚è¿™äº›æ˜¯â€œæ¯ä¸€ä¸ªç¼–è¯‘å•ä½éƒ½ä¼šæ‹¥æœ‰ä¸€ä»½å®ä¾‹â€çš„ä¸œè¥¿ã€‚ å¦‚ä½•â€œå®ä¾‹åŒ–ï¼ˆinstantiatesï¼‰â€nonmemberã€member template functionsä»¥åŠ static template class membersã€‚è¿™äº›éƒ½æ˜¯â€œæ¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­åªéœ€è¦ä¸€ä»½å®ä¾‹â€çš„ä¸œè¥¿ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸€èˆ¬è€Œè¨€ templateæ‰€å¸¦æ¥çš„é—®é¢˜ã€‚  ä»£ç æ ·ä¾‹ï¼š\né¦–å…ˆï¼Œå½“ç¼–è¯‘å™¨çœ‹åˆ°template class å£°æ˜æ—¶ï¼Œå®ƒä¼šåšå‡ºä»€ä¹ˆååº”ï¼Ÿåœ¨å®é™…ç¨‹åºä¸­ï¼Œä»€ä¹ˆååº”ä¹Ÿæ²¡æœ‰ï¼\né™æ€æˆå‘˜å˜é‡\nå¯¹äºæ¨¡æ¿ç±»é‡Œé¢çš„é™æ€æˆå‘˜å˜é‡ï¼Œå½“åˆå§‹åŒ–å®ƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢ä¸€æ¡è¯­å¥æ‰èƒ½ä½¿ç”¨ï¼š\n1  Point\u0026lt; float \u0026gt;::freeList;   ä¸èƒ½ä½¿ç”¨Point::freeList;ï¼Œæ­¤æ—¶ä¼šä½¿å…¶ä¸€ä»½å®ä¾‹ä¸ Point class çš„ float instantiationåœ¨ç¨‹åºä¸­äº§ç”Ÿå…³è”ã€‚\nå½“æˆ‘ä»¬å†è°ƒç”¨ä¸‹é¢çš„è¯­å¥æ—¶ï¼š\n1  Point\u0026lt; double \u0026gt;::freeList;   å°±ä¼šå‡ºç°ç¬¬äºŒä¸ªfreeListå®ä¾‹ï¼Œä¸Point classçš„double instantiationäº§ç”Ÿå…³è”ã€‚\nç±»å¯¹è±¡å®ä¾‹\næ‰€ä»¥ï¼Œä¸€ä¸ªclass object çš„å®šä¹‰ï¼Œä¸è®ºæ˜¯ç”±ç¼–è¯‘å™¨æš—ä¸­åœ°åšï¼ˆåƒç¨æ—©ç¨‹åºä»£ç ä¸­å‡ºç°è¿‡çš„temporaryï¼‰ï¼Œæˆ–æ˜¯ç”±ç¨‹åºå‘˜åƒä¸‹é¢è¿™æ ·æ˜¾å¼åœ°åšï¼š\n1  const Point\u0026lt; float \u0026gt; origin;   éƒ½ä¼šå¯¼è‡´template classçš„â€œå®ä¾‹åŒ–â€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œfloat instantiationçš„çœŸæ­£å¯¹è±¡å¸ƒå±€ä¼šè¢«äº§ç”Ÿå‡ºæ¥ã€‚\n å›é¡¾å…ˆå‰çš„ template å£°æ˜ï¼Œæˆ‘ä»¬çœ‹åˆ° Point æœ‰ä¸‰ä¸ª nonstatic membersï¼Œæ¯ä¸€ä¸ªçš„ç±»å‹éƒ½æ˜¯Typeã€‚Typeç°åœ¨è¢«ç»‘å®šä¸ºfloatï¼Œæ‰€ä»¥originçš„é…ç½®ç©ºé—´å¿…é¡»è¶³å¤Ÿå®¹çº³ä¸‰ä¸ªfloatæˆå‘˜ã€‚\n æˆå‘˜å‡½æ•°\nç„¶è€Œï¼Œmember functionsï¼ˆè‡³å°‘å¯¹äºé‚£äº›æœªè¢«ä½¿ç”¨è¿‡çš„ï¼‰ä¸åº”è¯¥è¢«â€œå®ä¾‹åŒ–â€ã€‚åªæœ‰åœ¨memberfunctionsè¢«ä½¿ç”¨çš„æ—¶å€™ï¼ŒC++Standardæ‰è¦æ±‚å®ƒä»¬è¢«â€œå®ä¾‹åŒ–â€ã€‚\nè¿™äº›å‡½æ•°åœ¨ä»€ä¹ˆæ—¶å€™â€œå®ä¾‹åŒ–â€ï¼Ÿç›®å‰æµè¡Œä¸¤ç§ç­–ç•¥ï¼š\n åœ¨ç¼–è¯‘çš„æ—¶å€™ã€‚é‚£ä¹ˆå‡½æ•°å°†â€œå®ä¾‹åŒ–â€äº originå’Œ på­˜åœ¨çš„é‚£ä¸ªæ–‡ä»¶ä¸­ã€‚ åœ¨é“¾æ¥çš„æ—¶å€™ã€‚é‚£ä¹ˆç¼–è¯‘å™¨ä¼šè¢«ä¸€äº›è¾…åŠ©å·¥å…·é‡æ–°æ¿€æ´»ã€‚template å‡½æ•°å®ä¾‹å¯èƒ½è¢«æ”¾åœ¨è¿™ä¸€æ–‡ä»¶ä¸­ã€åˆ«çš„æ–‡ä»¶ä¸­æˆ–ä¸€ä¸ªåˆ†ç¦»çš„å­˜å‚¨ä½ç½®ã€‚  æ¨¡æ¿é”™è¯¯æŠ¥å‘Šï¼š\ncfrontå¯¹templateçš„å¤„ç†æ˜¯å®Œå…¨è§£æï¼ˆparseï¼‰ä½†ä¸åšç±»å‹æ£€éªŒï¼›åªæœ‰åœ¨æ¯ä¸€ä¸ªå®ä¾‹åŒ–æ“ä½œï¼ˆinstantiationï¼‰å‘ç”Ÿæ—¶æ‰åšç±»å‹æ£€éªŒã€‚æ‰€ä»¥åœ¨ä¸€ä¸ªparsingç­–ç•¥ä¹‹ä¸‹ï¼Œæ‰€æœ‰è¯­æ±‡ï¼ˆlexingï¼‰é”™è¯¯å’Œè§£æï¼ˆparsingï¼‰é”™è¯¯éƒ½ä¼šåœ¨å¤„ç†templateå£°æ˜çš„è¿‡ç¨‹ä¸­è¢«æ ‡ç¤ºå‡ºæ¥ã€‚\nâ—c++çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ æ¬²æ”¯æŒexception handlingï¼Œç¼–è¯‘å™¨çš„ä¸»è¦å·¥ä½œå°±æ˜¯æ‰¾å‡ºcatchå­å¥ï¼Œä»¥å¤„ç†è¢«æŠ›å‡ºæ¥çš„exceptionã€‚\nä¸€èˆ¬è€Œè¨€ï¼Œexception handlingæœºåˆ¶éœ€è¦ä¸ç¼–è¯‘å™¨æ‰€äº§ç”Ÿçš„æ•°æ®ç»“æ„ä»¥åŠæ‰§è¡ŒæœŸçš„ä¸€ä¸ªexception libraryç´§å¯†åˆä½œã€‚åœ¨ç¨‹åºå¤§å°å’Œæ‰§è¡Œé€Ÿåº¦ä¹‹é—´ï¼Œç¼–è¯‘å™¨å¿…é¡»æœ‰æ‰€æŠ‰æ‹©ï¼š\n ä¸ºäº†ç»´æŠ¤æ‰§è¡Œé€Ÿåº¦ï¼Œç¼–è¯‘å™¨å¯ä»¥åœ¨ç¼–è¯‘æ—¶æœŸå»ºç«‹èµ·ç”¨äºæ”¯æŒçš„æ•°æ®ç»“æ„ã€‚è¿™ä¼šä½¿ç¨‹åºçš„å¤§å°å‘ç”Ÿè†¨èƒ€ï¼Œä½†ç¼–è¯‘å™¨å¯ä»¥å‡ ä¹å¿½ç•¥è¿™äº›ç»“æ„ï¼Œç›´åˆ°æœ‰ä¸ª exceptionè¢«æŠ›å‡ºæ¥ã€‚ ä¸ºäº†ç»´æŠ¤ç¨‹åºå¤§å°ï¼Œç¼–è¯‘å™¨å¯ä»¥åœ¨æ‰§è¡ŒæœŸå»ºç«‹èµ·ç”¨äºæ”¯æŒçš„æ•°æ®ç»“æ„ã€‚è¿™ä¼šå½±å“ç¨‹åºçš„æ‰§è¡Œé€Ÿåº¦ï¼Œä½†æ„å‘³ç€ç¼–è¯‘å™¨åªæœ‰åœ¨å¿…è¦çš„æ—¶å€™æ‰å»ºç«‹é‚£äº›æ•°æ®ç»“æ„ï¼ˆå¹¶ä¸”å¯ä»¥æŠ›å¼ƒä¹‹ï¼‰ã€‚  C++çš„exception handlingç”±ä¸‰ä¸ªä¸»è¦çš„è¯­æ±‡ç»„ä»¶æ„æˆï¼š\n ä¸€ä¸ª throw å­å¥ã€‚å®ƒåœ¨ç¨‹åºæŸå¤„å‘å‡ºä¸€ä¸ª exceptionã€‚è¢«æŠ›å‡ºå»çš„exceptionå¯ä»¥æ˜¯å†…å»ºç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä½¿ç”¨è€…è‡ªå®šç±»å‹ã€‚ ä¸€ä¸ªæˆ–å¤šä¸ª catchå­å¥ã€‚æ¯ä¸€ä¸ª catchå­å¥éƒ½æ˜¯ä¸€ä¸ª exception handlerã€‚å®ƒç”¨æ¥è¡¨ç¤ºè¯´ï¼Œè¿™ä¸ªå­å¥å‡†å¤‡å¤„ç†æŸç§ç±»å‹çš„ exceptionï¼Œå¹¶ä¸”åœ¨å°é—­çš„å¤§æ‹¬å·åŒºæ®µä¸­æä¾›å®é™…çš„å¤„ç†ç¨‹åºã€‚ ä¸€ä¸ª tryåŒºæ®µã€‚å®ƒè¢«å›´ç»•ä»¥ä¸€ç³»åˆ—çš„å™è¿°å¥ï¼ˆstatementsï¼‰ï¼Œè¿™äº›å™è¿°å¥å¯èƒ½ä¼šå¼•å‘ catchå­å¥èµ·ä½œç”¨ã€‚  å½“ä¸€ä¸ªexception è¢«æŠ›å‡ºå»æ—¶ï¼Œæ§åˆ¶æƒä¼šä»å‡½æ•°è°ƒç”¨ä¸­è¢«é‡Šæ”¾å‡ºæ¥ï¼Œå¹¶å¯»æ‰¾ä¸€ä¸ªå»åˆçš„catchå­å¥ã€‚å¦‚æœéƒ½æ²¡æœ‰å»åˆè€…ï¼Œé‚£ä¹ˆé»˜è®¤çš„å¤„ç†ä¾‹ç¨‹terminateï¼ˆï¼‰ä¼šè¢«è°ƒç”¨ã€‚å½“æ§åˆ¶æƒè¢«æ”¾å¼ƒåï¼Œå †æ ˆä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¹Ÿå°±è¢«æ¨ç¦»ï¼ˆpopped upï¼‰ã€‚è¿™ä¸ªç¨‹åºç§°ä¸ºunwinding the stackã€‚åœ¨æ¯ä¸€ä¸ªå‡½æ•°è¢«æ¨ç¦»å †æ ˆä¹‹å‰ï¼Œå‡½æ•°çš„local class objectsçš„destructorä¼šè¢«è°ƒç”¨ã€‚\nğŸƒæ‰§è¡ŒæœŸç±»å‹è¯†åˆ«ï¼ˆRuntime Type Identificationï¼ŒRTTIï¼‰  ç±»å‹å®‰å…¨çš„å‘ä¸‹è½¬å‹ï¼Œä¸€ä¸ªå®‰å…¨çš„å‘ä¸‹è½¬å‹éœ€è¦åœ¨æ‰§è¡ŒæœŸå¯ä»¥å¯¹æŒ‡é’ˆè¿›è¡ŒæŸ¥è¯¢ï¼Œç¡®å®šå¯ä»¥æ­£ç¡®ä¸”å®‰å…¨çš„å‘ä¸‹è½¬å‹ã€‚å› ä¸ºéœ€è¦æ”¯æŒæŸ¥è¯¢ï¼Œåˆ™éœ€è¦åœ¨è½¬å‹æ—¶çš„ç©ºé—´å’Œæ‰§è¡Œæ—¶é—´ä¸Šçš„é¢å¤–è´Ÿæ‹…ã€‚é¢å¤–è´Ÿæ‹…æœ‰ï¼š  ã€€1) é¢å¤–ç©ºé—´ä»¥å­˜å‚¨ç±»å‹ä¿¡æ¯ï¼Œé€šå¸¸ä¸ºä¸€ä¸ªæŒ‡å‘æŸç±»å‹ä¿¡æ¯èŠ‚ç‚¹çš„æŒ‡é’ˆï¼›\nã€€2) é¢å¤–æ—¶é—´ä»¥å†³å®šæ‰§è¡ŒæœŸçš„ç±»å‹ã€‚\nã€€C++åˆ©ç”¨è™šè¡¨ï¼Œå°†ç±»ç›¸å…³çš„RTTIå¯¹è±¡åœ°å€(å³type_infoå¯¹è±¡åœ°å€)æ”¾åœ¨è™šè¡¨ä¸­(ä¸€èˆ¬ä¸ºç¬¬ä¸€ä¸ªslot)ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™è®¾å®švtprå’Œè™šè¡¨å³å¯ï¼Œå½“éœ€è¦å‘ä¸‹è½¬å‹æ—¶åˆ©ç”¨RTTIå†³å®šæ‰§è¡ŒæœŸç±»å‹ç­‰ä¿¡æ¯ã€‚\n ç±»å‹å®‰å…¨çš„åŠ¨æ€è½¬æ¢dynamic_castå¯ä»¥ç¡®ä¿è½¬åŒ–åˆé€‚çš„ç±»å‹å¯¹è±¡ï¼Œè‹¥å¤±è´¥åˆ™è¿”å›ç©ºæŒ‡é’ˆ(å½“è½¬åŒ–ä¸ºæŒ‡é’ˆç±»å‹æ—¶)æˆ–è€…æŠ›å‡ºå¼‚å¸¸(å½“è½¬åŒ–ä¸ºå¼•ç”¨ç±»å‹æ—¶)ã€‚dynamic_castçš„æˆæœ¬åœ¨äºè¿è¡ŒæœŸçš„ç±»å‹è¯†åˆ«åˆ¤æ–­ã€‚\n  ä½¿ç”¨typeidè¿ç®—ç¬¦è·å–å¯¹è±¡çš„ç±»å‹ï¼Œå³type_infoï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡typeidæ¥ç¡®å®šæ˜¯å¦æ»¡è¶³æŸä¸ªç±»å‹ï¼Œç„¶åè°ƒç”¨static_castè½¬åŒ–å³å¯ã€‚å³if(typeid(someObj) == typeid(someType) ) {someType \u0026amp;rf = static_cast\u0026lt;someType\u0026amp;\u0026gt;(someObj);}ã€‚æ­¤å¤–RTTIä¸ä»…å¯ç”¨äºå¤šæ€ç±»ï¼Œä¹Ÿå¯ä»¥ç”¨äºå†…ç½®ç±»å‹å’Œéå¤šæ€çš„ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ã€‚\n  ğŸš§C++æ„é€ å‡½æ•°  å››ç§æƒ…å†µï¼Œé€ æˆâ€œç¼–è¯‘å™¨ä¼šä¸ºæœªå£°æ˜çš„constructorçš„classesåˆæˆä¸€ä¸ªdefault constructor\n   å¸¦æœ‰Default Constructor çš„Member Class Object\nå¦‚æœä¸€ä¸ªclassæ²¡æœ‰ä»»ä½•constructorï¼Œä½†å®ƒå†…å«ä¸€ä¸ªmember objectï¼Œè€Œåè€… æœ‰default constructorï¼Œé‚£ä¹ˆè¿™ä¸ªclassçš„implicit default constructor å°±æ˜¯ â€œnontrivialâ€,ç¼–è¯‘å™¨éœ€è¦ä¸ºæ­¤classåˆæˆå‡ºä¸€ä¸ªdefault constructorã€‚ä¸è¿‡è¿™ä¸ª åˆæˆæ“ä½œåªæœ‰åœ¨constructorçœŸæ­£éœ€è¦è¢«è°ƒç”¨æ—¶æ‰ä¼šå‘ç”Ÿã€‚\nä¾‹å­ï¼šBarä¼šç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„æ„é€ å‡½æ•°\n æç¤ºï¼šè¢«åˆæˆçš„é»˜è®¤æ„é€ å‡½æ•°åªæ˜¯æ»¡è¶³ç¼–è¯‘å™¨çš„éœ€è¦ï¼Œè€Œä¸æ˜¯ç¨‹åºçš„éœ€è¦ã€‚\n   â€œå¸¦æœ‰ Default Constructorâ€çš„ Base Class\nå¦‚æœä¸€ä¸ªæ²¡æœ‰ä»»ä½•constructorsçš„classæ´¾ç”Ÿè‡ªä¸€ä¸ªâ€œå¸¦æœ‰default constructorâ€çš„base class,é‚£ä¹ˆè¿™ä¸ªderived classçš„default constructorä¼šè¢«è§†ä¸ºnontrivialï¼Œå¹¶å› æ­¤éœ€è¦è¢«åˆæˆå‡ºæ¥ã€‚å®ƒå°†è°ƒç”¨ä¸Šä¸€å±‚base classesçš„default constructor(æ ¹æ®å®ƒä»¬çš„å£°æ˜æ¬¡åºï¼‰ã€‚å¯¹ä¸€ä¸ªåç»§æ´¾ç”Ÿçš„classè€Œè¨€ï¼Œè¿™ä¸ªåˆæˆçš„constructorå’Œä¸€ä¸ªâ€œè¢«æ˜ç¡®æä¾›çš„default constructorâ€æ²¡æœ‰ä»€ä¹ˆå·®å¼‚ã€‚\n  â€œå¸¦æœ‰ä¸€ä¸ª Virtual Functionâ€çš„Class\næ„é€ å‡½æ•°çš„æ„å»ºä¸»è¦æ˜¯ä¸ºäº†åˆå§‹åŒ–æˆ–è€…æ›´æ–°è™šå‡½æ•°æŒ‡é’ˆ\nä¾‹å­\n  â€œå¸¦æœ‰ä¸€ä¸ªVirtual Base Classâ€çš„Class\nä¾‹å­ï¼š\n  åœ¨åˆæˆçš„default constructorä¸­ï¼Œåªæœ‰base class subobjectså’Œmember classobjectsä¼šè¢«åˆå§‹åŒ–ã€‚æ‰€æœ‰å…¶å®ƒçš„ nonstatic data memberï¼Œå¦‚æ•´æ•°ã€æ•´æ•°æŒ‡é’ˆã€æ•´æ•°æ•°ç»„ç­‰ç­‰éƒ½ä¸ä¼šè¢«åˆå§‹åŒ–ã€‚è¿™äº›åˆå§‹åŒ–æ“ä½œå¯¹ç¨‹åºè€Œè¨€æˆ–è®¸æœ‰éœ€è¦ï¼Œä½†å¯¹ç¼–è¯‘å™¨åˆ™å¹¶éå¿…è¦ã€‚å¦‚æœç¨‹åºéœ€è¦ä¸€ä¸ªâ€œæŠŠæŸæŒ‡é’ˆè®¾ä¸º0â€çš„default constructor,é‚£ä¹ˆæä¾›å®ƒçš„äººåº”è¯¥æ˜¯ç¨‹åºå‘˜ã€‚\nğŸ‘®C++æ‹·è´æ„é€ å‡½æ•° æœ‰ä¸‰ç§æƒ…å†µï¼Œä¼šä»¥ä¸€ä¸ªobjectçš„å†…å®¹ä½œä¸ºå¦ä¸€ä¸ªclass objectçš„åˆå€¼:\n  å¯¹ä¸€ä¸ªobjectåšæ˜ç¡®çš„åˆå§‹åŒ–æ“ä½œï¼Œåƒè¿™æ ·ï¼š\n1 2 3 4  class X{...}; X x; //æ˜ç¡®åœ°ä»¥ä¸€ä¸ªobjectçš„å†…å®¹ä½œä¸ºå¦ä¸€ä¸ªclass objectçš„åˆå€¼ X xx = x;     å½“object è¢«å½“ä½œå‚æ•°äº¤ç»™æŸä¸ªå‡½æ•°æ—¶,ä¾‹å¦‚ï¼š\n1 2 3 4 5 6  extern void foo(X x); void test(){ X xx; foo(xx);\t//ä»¥xxä½œä¸ºfooï¼ˆï¼‰ç¬¬ä¸€ä¸ªå‚æ•°çš„åˆå€¼ï¼ˆä¸æ˜æ˜¾çš„åˆå§‹åŒ–æ“ä½œï¼‰ }     å½“å‡½æ•°ä¼ å›ä¸€ä¸ªclass objectæ—¶ï¼Œä¾‹å¦‚ï¼š\n1 2 3 4  X foo_bar(){ X xx; return xx; }     Default Memberwise Initialization å¦‚æœå‡½æ•°å¹¶æ²¡æœ‰æä¾›ä¸€ä¸ªexplicit copy constructorï¼Œé‚£ä¹ˆå…¶æ‹·è´åŒç±»å‹å¯¹è±¡çš„æ“ä½œç”±default memberwise initializationå®Œæˆï¼Œå…¶æ‰§è¡Œç­–ç•¥ä¸ºï¼šå¯¹æ¯ä¸€ä¸ªå†…å»ºæˆ–æ´¾ç”Ÿçš„data memberçš„å€¼ï¼Œä»æŸä¸€ä¸ªobjectæ‹·è´åˆ°å¦ä¸€ä¸ªobjectã€‚ä¸è¿‡å®ƒä¸ä¼šæ‹·è´å…¶ä¸­çš„member class objectï¼Œè€Œæ˜¯å®æ–½é€’å½’å¼çš„memberwise initialization(å¯¹æ¯ä¸€ä¸ªå¯¹è±¡ä¾æ¬¡æ‰§è¡Œdefault memberwise initializationï¼‰ã€‚\n Default constructors å’Œ copy constructorsåœ¨å¿…è¦çš„æ—¶å€™æ‰ç”±ç¼–è¯‘å™¨äº§ç”Ÿå‡ºæ¥ã€‚\n Bitwise Copy Semantics(ä½é€æ¬¡æ‹·è´ï¼‰ çœ‹çœ‹ä¸‹é¢çš„ç¨‹åºæ®µï¼š\n1 2 3 4 5 6  #include\u0026#34;Word.h\u0026#34;Word noun(\u0026#34;book\u0026#34;); void foo() { Word verb = noun; //... }   æˆ‘ä»¬ä¸å¯èƒ½é¢„æµ‹è¿™ä¸ªåˆå§‹åŒ–æ“ä½œçš„ç¨‹åºè¡Œä¸ºã€‚å¦‚æœclass Wordçš„è®¾è®¡è€…å®šä¹‰äº†ä¸€ä¸ªcopy constructorï¼Œverbçš„åˆå§‹åŒ–æ“ä½œä¼šè°ƒç”¨å®ƒã€‚ä½†å¦‚æœè¯¥class æ²¡æœ‰å®šä¹‰explicit copy constructor,é‚£ä¹ˆæ˜¯å¦ä¼šæœ‰ä¸€ä¸ªç¼–è¯‘å™¨åˆæˆçš„å®ä½“è¢«è°ƒç”¨å‘¢ï¼Ÿè¿™å°±å¾—è§†è¯¥class æ˜¯å¦å±•ç°\u0026quot;bitwise copy semanticsâ€è€Œå®šã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œå·²çŸ¥ä¸‹é¢çš„class Word å£°æ˜ï¼š\n1 2 3 4 5 6 7 8 9  //ä»¥ä¸‹å£°æ˜å±•ç°äº†bitwise copy semantics class Word{ public: Word(const char*); ~Word(){ delete []str;} //.. private: int cnt; char *str; }ï¼›   è¿™ç§æƒ…å†µä¸‹å¹¶ä¸éœ€è¦åˆæˆå‡ºä¸€ä¸ªdefault copy constructorï¼Œå› ä¸ºä¸Šè¿°å£°æ˜å±•ç°äº†â€œdefault copy semanticsâ€ã€‚\nå†å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9  //ä»¥ä¸‹å£°æ˜å¹¶æœªå±•ç°å‡ºbitwise copy semantics class Word{ public: Word(const String\u0026amp;); ~Word(){ delete []str;} //.. private: int cnt; String str; }ï¼›   å…¶ä¸­Stringå£°æ˜äº†ä¸€ä¸ªæ˜¾ç¤ºçš„æ‹·è´æ„é€ å‡½æ•°\n1 2 3 4 5 6  class String{ public: String(const char*); ~String(); //... };   åœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨å¿…é¡»åˆæˆå‡ºä¸€ä¸ªcopy constructor ä»¥ä¾¿è°ƒç”¨member class String objectçš„ copy constructor:\nä»€ä¹ˆæ—¶å€™ä¸€ä¸ªclassä¸å±•ç°å‡ºâ€œbitwise copy semanticsâ€å‘¢?æœ‰å››ç§æƒ…å†µï¼š\n å½“classå†…å«ä¸€ä¸ªmember objectè€Œåè€…çš„classå£°æ˜æœ‰ä¸€ä¸ªcopy constructoræ—¶ï¼ˆä¸è®ºæ˜¯è¢«class è®¾è®¡è€…æ˜ç¡®åœ°å£°æ˜ï¼Œå°±åƒå‰é¢çš„Stringé‚£æ ·ï¼›æˆ–æ˜¯è¢«ç¼–è¯‘å™¨åˆæˆï¼Œåƒclass Wordé‚£æ ·ï¼‰ã€‚ å½“classç»§æ‰¿è‡ªä¸€ä¸ªbase classè€Œåè€…å­˜åœ¨æœ‰ä¸€ä¸ªcopy constructoræ—¶ï¼ˆå†æ¬¡å¼ºè°ƒï¼Œä¸è®ºæ˜¯è¢«æ˜ç¡®å£°æ˜æˆ–æ˜¯è¢«åˆæˆè€Œå¾—ï¼‰ã€‚ å½“classå£°æ˜äº†ä¸€ä¸ªæˆ–å¤šä¸ªvirtual functionsæ—¶ã€‚ å½“classæ´¾ç”Ÿè‡ªä¸€ä¸ªç»§æ‰¿ä¸²é“¾ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªvirtual base classesæ—¶ã€‚  å‰ä¸¤ç¥æƒ…å†µä¸­ï¼Œç¼–è¯‘å™¨å¿…é¡»å°†memberæˆ–base classçš„â€œcopy constructorsè°ƒç”¨æ“ä½œâ€å®‰æ’åˆ°è¢«åˆæˆçš„copy constructorä¸­ã€‚\nè™šå‡½æ•°æŒ‡é’ˆ\nç¼–è¯‘æ—¶æœŸæœ‰ä¸¤ä¸ªç¨‹åºçš„æ‰©å¼ æ“ä½œï¼š\nâ–  å¢åŠ ä¸€ä¸ªvirtual function tableï¼ˆvtbl)ï¼Œå†…å«æ¯ä¸€ä¸ªæœ‰ä½œç”¨çš„ virtual functionçš„åœ°å€ã€‚\nâ–  å°†ä¸€ä¸ªæŒ‡å‘virtual function tableçš„æŒ‡é’ˆï¼ˆvptr)ï¼Œå®‰æ’åœ¨æ¯ä¸€ä¸ªclass objectå†…ã€‚\nå¾ˆæ˜¾ç„¶ï¼Œå¦‚æœç¼–è¯‘å™¨å¯¹äºæ¯ä¸€ä¸ªæ–°äº§ç”Ÿçš„class objectçš„vpträ¸èƒ½æˆåŠŸè€Œæ­£ç¡®åœ°è®¾å¥½å…¶åˆå€¼ï¼Œå°†å¯¼è‡´å¯æ€•çš„åæœã€‚å› æ­¤ï¼Œå½“ç¼–è¯‘å™¨å¯¼å…¥ä¸€ä¸ªvptråˆ°classä¹‹ä¸­æ—¶ï¼Œè¯¥classå°±ä¸å†å±•ç°bitwise semanticsäº†ã€‚ç°åœ¨ï¼Œç¼–è¯‘å™¨éœ€è¦åˆæˆå‡ºä¸€ä¸ªcopy constructorï¼Œä»¥æ±‚å°†vptré€‚å½“åœ°åˆå§‹åŒ–ï¼Œä¸‹é¢æ˜¯ä¸ªä¾‹å­ã€‚\nä»¥ä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡ä½œä¸ºå…¶çˆ¶ç±»å¯¹è±¡çš„åˆå§‹å€¼ï¼Œç¼–è¯‘å™¨éœ€è¦**â€åˆ¤æ–­â€œ**\nç¨‹åºè½¬åŒ–è¯­ä¹‰ ä¸‹é¢çš„ç¨‹åºï¼š\n1 2 3 4 5 6 7  #include \u0026lt;iostream\u0026gt; X foo(){ X xx; // ... \treturn xx; }   å¯èƒ½ä¼šåšå‡ºä»¥ä¸‹å‡è®¾ï¼š\n æ¯æ¬¡foo0è¢«è°ƒç”¨ï¼Œå°±ä¼ å›xxçš„å€¼ã€‚ å¦‚æœclass Xå®šä¹‰äº†ä¸€ä¸ªcopy constructorï¼Œé‚£ä¹ˆå½“foo0è¢«è°ƒç”¨æ—¶ï¼Œä¿è¯è¯¥copy constructor ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚   ç¬¬ä¸€ä¸ªå‡è®¾çš„çœŸå®æ€§ï¼Œå¿…é¡»è§†class Xå¦‚ä½•å®šä¹‰è€Œå®šã€‚ç¬¬äºŒä¸ªå‡è®¾çš„çœŸå®æ€§ï¼Œè™½ç„¶ä¹Ÿæœ‰éƒ¨åˆ†å¿…é¡»è§†class Xå¦‚ä½•å®šä¹‰è€Œå®šï¼Œä½†æœ€ä¸»è¦è¿˜æ˜¯è§†ä½ çš„C++ç¼–è¯‘å™¨æ‰€æä¾›çš„è¿›å–æ€§ä¼˜åŒ–ç¨‹åº¦ï¼ˆdegree of aggressive optimization)è€Œå®šã€‚ä½ ç”šè‡³å¯ä»¥å‡è®¾åœ¨ä¸€ä¸ªé«˜å“è´¨çš„C++ç¼–è¯‘å™¨ä¸­ï¼Œä¸Šè¿°ä¸¤ç‚¹å¯¹äºclass Xçš„nontrivial definitionséƒ½ä¸æ­£ç¡®ã€‚\n æ˜¾å¼åˆå§‹åŒ–æ“ä½œ(Explicit Initialization)\nä¸‹é¢çš„ä¾‹å­æ˜¯ä¸‰ç§æ˜¾ç¤ºçš„æ‹·è´æ„é€ æ“ä½œï¼š\n1 2 3 4 5 6  void test() { X x0; X x1(x0); // ç¬¬ä¸€ç§æ˜¾ç¤ºæ‹·è´æ„é€   X x2 = x0; // ç¬¬äºŒç§æ˜¾ç¤ºæ‹·è´æ„é€   X x3 = X(x0); // ç¬¬ä¸‰ç§æ˜¾ç¤ºæ‹·è´æ„é€  }   ä¸Šé¢çš„ç¨‹åºè½¬åŒ–å¯èƒ½ä¼šæœ‰ä¸¤ä¸ªé˜¶æ®µï¼š\n é‡å†™æ¯ä¸€ä¸ªå®šä¹‰ï¼Œå…¶ä¸­çš„åˆå§‹åŒ–æ“ä½œä¼šè¢«å‰¥é™¤ã€‚ classçš„copy constructor è°ƒç”¨æ“ä½œä¼šè¢«å®‰æ’è¿›å»ã€‚  å¯èƒ½ä¼šå˜æˆä¸‹é¢è¿™æ ·\n1 2 3 4 5 6 7 8 9 10  void test_Cpp() { // ... x0çš„æ„é€ å‡½æ•°  // ä¸‰ä¸ªå£°æ˜  X x1,x2,x3; // ä¸‰ä¸ªå®šä¹‰  x1.X::X(x0); x2.X::X(x0); x3.X::X(x0); }   å‚æ•°çš„åˆå§‹åŒ–ï¼ˆArgument Initialization)\nC++æ ‡å‡†è¯´ï¼ŒæŠŠä¸€ä¸ªclass object å½“åšå‚æ•°ä¼ ç»™ä¸€ä¸ªå‡½æ•°ï¼Œç›¸å½“äºä¸€ä¸‹å½¢å¼çš„åˆå§‹åŒ–æ“ä½œï¼š\n(å®šä¹‰ä¸€ä¸ªç±»Xï¼Œä½œä¸ºtestå‡½æ•°çš„å‚æ•°)\n1 2  X xx; test(xx);   å…¶ä¸­testå‡½æ•°çš„å£°æ˜å¦‚ä¸‹ï¼š\n1  void test(X x0);   ä¸Šé¢çš„å‚æ•°xxè¿™ä¸ªå˜é‡ä½œä¸ºå‚æ•°ä¼ åˆ°å‡½æ•°testä¸­ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œå¹¶ä¸”ä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°å°†è¿™ä¸ªä¸´æ—¶å¯¹è±¡åˆå§‹åŒ–ï¼Œç»è¿‡è¿™äº›æ­¥éª¤è¿™ä¸ªå‚æ•°æ‰çœŸæ­£ä¼ å…¥å‡½æ•°ä¸­è¿›è¡Œä½¿ç”¨ã€‚\næ‰€ä»¥ä¸Šé¢çš„ä»£ç å¯èƒ½ä¼šè½¬æ¢ä¸ºï¼š\n1 2 3  X __temp;\t// ä¸´æ—¶å¯¹è±¡äº§ç”Ÿ __temp.X::X(xx);\t//ç¼–è¯‘å™¨å¯¹æ‹·è´æ„é€ å‡½æ•°çš„è°ƒç”¨ test(__temp);\t//é‡æ–°æ”¹å†™å‡½æ•°çš„è°ƒç”¨æ“ä½œ   ç„¶è€Œä¸Šé¢çš„åšæ³•åªå®Œæˆäº†ä¸€èˆ¬ï¼Œå› ä¸ºå‡½æ•°xxçš„å£°æ˜è¿˜æ˜¯ä¸€ä¸ªä¼ å€¼çš„å‚æ•°ï¼Œtestçš„å£°æ˜ä¹Ÿä¹Ÿé¡»è¢«è½¬åŒ–ï¼Œå½¢å¼å‚æ•°å¿…é¡»ä»åŸå…ˆçš„ä¸€ä¸ªclass X objectæ”¹å˜ä¸ºä¸€ä¸ªclass X reference,åƒè¿™æ ·ï¼š\n1  void test(X\u0026amp; x0)ï¼›   è¿”å›å€¼çš„åˆå§‹åŒ–ï¼ˆReturn Value Initialization)\nä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š\n1 2 3 4 5  X test() { X xx; return xx; }   ç¼–è¯‘å™¨å¯èƒ½ä¼šåšå¦‚ä¸‹NRVä¼˜åŒ–ï¼š\n1 2 3 4 5 6  X __result; void test(X\u0026amp; __result) { __result.X::X()ï¼› return; }   å½“ç±»æ˜¾ç¤ºBitwiseçš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ä¸å»å®šä¹‰ä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°ï¼Œä½¿ç”¨ç¼–è¯‘å™¨åˆæˆå°±éå¸¸é«˜æ•ˆå’Œå®‰å…¨ï¼\nDataè¯­ä¹‰å­¦\nğŸ’½C++â€”â€”dataè¯­ä¹‰ æ¯ä¸€ä¸ªclass object å› æ­¤å¿…é¡»æœ‰è¶³å¤Ÿçš„å¤§å°ä»¥å®¹çº³å®ƒæ‰€æœ‰çš„ nonstatic datamembersã€‚æœ‰æ—¶å€™å…¶å€¼å¯èƒ½ä»¤ä½ åƒæƒŠï¼ˆæ­£å¦‚é‚£ä½æ³•å›½æ¥ä¿¡è€…ï¼‰ï¼Œå› ä¸ºå®ƒå¯èƒ½æ¯”ä½ æƒ³è±¡çš„è¿˜å¤§ï¼ŒåŸå› æ˜¯ï¼š\n ç”±ç¼–è¯‘å™¨è‡ªåŠ¨åŠ ä¸Šçš„é¢å¤–data membersï¼Œç”¨ä»¥æ”¯æŒæŸäº›è¯­è¨€ç‰¹æ€§ï¼ˆä¸»è¦æ˜¯å„ç§virtualç‰¹æ€§ï¼‰. å› ä¸ºalignmentï¼ˆè¾¹ç•Œè°ƒæ•´ï¼‰çš„éœ€è¦ã€‚  Data Memberçš„ç»‘å®š\nçœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12  //æŸä¸ªfoo.hå¤´æ–‡ä»¶ï¼Œä»æŸå¤„å«å…¥ extern float x; //ç¨‹åºå‘˜çš„Point3d.hæ–‡ä»¶ class Point3d{ public: Point3d(float,float,float); //é—®é¢˜ï¼šè¢«ä¼ å›å’Œè¢«è®¾å®šçš„xæ˜¯å“ªä¸€ä¸ªxå‘¢  float X() const { return x;} void X( float new x) const{x=new_x;} //..â€¦ private: float x,y,z; };   å¦‚æœæˆ‘é—®ä½ Point3d::X()ä¼ å›å“ªä¸€ä¸ªxï¼Ÿæ˜¯classå†…éƒ¨çš„é‚£ä¸ªxï¼Œè¿˜æ˜¯å¤–éƒ¨ï¼ˆextern)çš„é‚£ä¸ªxï¼Ÿä»Šå¤©æ¯ä¸ªäººéƒ½ä¼šå›ç­”æˆ‘æ˜¯å†…éƒ¨é‚£ä¸€ä¸ªã€‚è¿™ä¸ªç­”æ¡ˆæ˜¯æ­£ç¡®çš„ï¼Œä½†å¹¶ä¸æ˜¯ä»è¿‡å»ä»¥æ¥ä¸€ç›´éƒ½æ­£ç¡®ï¼\næ—©æœŸC++çš„ä¸¤ç§é˜²å¾¡æ€§ç¨‹åºè®¾è®¡é£æ ¼ï¼š\n æŠŠæ‰€æœ‰çš„data membersæ”¾åœ¨classå£°æ˜èµ·å¤´å¤„ï¼Œä»¥ç¡®ä¿æ­£ç¡®çš„ç»‘å®šï¼š æŠŠæ‰€æœ‰çš„inline functionsï¼Œä¸ç®¡å¤§å°éƒ½æ”¾åœ¨classå£°æ˜ä¹‹å¤–ï¼š  è¿™ä¸ªè¯­è¨€è§„åˆ™è¢«ç§°ä¸ºâ€œmember rewriting ruleâ€ï¼Œå¤§æ„æ˜¯â€œä¸€ä¸ªinlineå‡½æ•°å®ä½“ï¼Œåœ¨æ•´ä¸ª classå£°æ˜æœªè¢«å®Œå…¨çœ‹è§ä¹‹å‰ï¼Œæ˜¯ä¸ä¼šè¢«è¯„ä¼°æ±‚å€¼ï¼ˆevaluatedï¼‰çš„â€ã€‚C++Standard ä»¥â€œmember scope resolution rulesâ€æ¥ç²¾ç‚¼è¿™ä¸ªâ€œrewriting ruleâ€ï¼Œå…¶æ•ˆæœæ˜¯ï¼Œå¦‚æœä¸€ä¸ªinlineå‡½æ•°åœ¨classå£°æ˜ä¹‹åç«‹åˆ»è¢«å®šä¹‰çš„è¯ï¼Œé‚£ä¹ˆå°±è¿˜æ˜¯å¯¹å…¶è¯„ä¼°æ±‚å€¼ï¼ˆevaluate)ã€‚\nç„¶è€Œï¼Œè¿™å¯¹äºmember functionçš„argument list å¹¶ä¸ä¸ºçœŸã€‚Argument listä¸­çš„åç§°è¿˜æ˜¯ä¼šåœ¨å®ƒä»¬ç¬¬ä¸€æ¬¡é­é‡æ—¶è¢«é€‚å½“åœ°å†³è®®ï¼ˆresolvedï¼‰å®Œæˆã€‚å› æ­¤åœ¨externå’Œnested type namesä¹‹é—´çš„éç›´è§‰ç»‘å®šæ“ä½œè¿˜æ˜¯ä¼šå‘ç”Ÿã€‚ä¾‹å¦‚åœ¨ä¸‹é¢çš„ç¨‹åºç‰‡æ®µä¸­ï¼Œlengthçš„ç±»å‹åœ¨ä¸¤ä¸ªmember function signaturesä¸­éƒ½å†³è®®ï¼ˆresolve)ä¸ºglobal typedef,ä¹Ÿå°±æ˜¯int.å½“åç»­å†æœ‰lengthçš„nested typedef å£°æ˜å‡ºç°æ—¶ï¼ŒC+Standard å°±æŠŠç¨æ—©çš„ç»‘å®šæ ‡ç¤ºä¸ºéæ³•ï¼š\n1 2 3 4 5 6 7 8 9 10 11  typedef int length; class Point3D{ public: // 1ength è¢«å†³è®®(resolvedï¼‰ä¸ºglobal  void mumble(length val){_val = val;} length mumble() {return _val;} private: typedef float length; // 1ength è¢«å†³è®®(resolvedï¼‰ä¸ºlocal  length _val; };   ä¸Šè¿°è¿™ç§è¯­è¨€çŠ¶å†µï¼Œä»ç„¶éœ€è¦æŸç§é˜²å¾¡æ€§ç¨‹åºé£æ ¼ï¼šè¯·å§‹ç»ˆæŠŠâ€œnested typeå£°æ˜â€æ”¾åœ¨classçš„èµ·å§‹å¤„ã€‚åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå¦‚æœæŠŠlengthçš„nested typedefå®šä¹‰äºâ€œåœ¨classä¸­è¢«å‚è€ƒâ€ä¹‹å‰ï¼Œå°±å¯ä»¥ç¡®ä¿éç›´è§‰ç»‘å®šçš„æ­£ç¡®æ€§ã€‚\nData Memberçš„å¸ƒå±€ï¼ˆData Member Layout)\nData Memberçš„å­˜å–\næˆ‘ç”¨å®ƒä»¬æ¥å­˜å–data membersï¼Œåƒè¿™æ ·ï¼š\n1 2  origin.x=0.0; pt-\u0026gt;x=0.0;   é€šè¿‡originå­˜å–å’Œé€šè¿‡ptå­˜å–ï¼Œæœ‰ä»€ä¹ˆé‡å¤§å·®å¼‚å—ï¼Ÿ\nâ€œä»originå­˜å–â€å’Œâ€œä»ptå­˜å–â€æœ‰ä»€ä¹ˆé‡å¤§çš„å·®å¼‚ï¼Ÿç­”æ¡ˆæ˜¯â€œå½“Point3dæ˜¯ä¸€ä¸ªderived classï¼Œè€Œåœ¨å…¶ç»§æ‰¿ç»“æ„ä¸­æœ‰ä¸€ä¸ªvirtual base classï¼Œå¹¶ä¸”è¢«å­˜å–çš„member(å¦‚æœ¬ä¾‹çš„xï¼‰æ˜¯ä¸€ä¸ªä»è¯¥virtual base classç»§æ‰¿è€Œæ¥çš„memberæ—¶ï¼Œå°±ä¼šæœ‰é‡å¤§çš„å·®å¼‚â€ã€‚è¿™æ—¶å€™æˆ‘ä»¬ä¸èƒ½å¤Ÿè¯´ptå¿…ç„¶æŒ‡å‘å“ªä¸€ç§ class typeï¼ˆå› æ­¤æˆ‘ä»¬ä¹Ÿå°±ä¸çŸ¥é“ç¼–è¯‘æ—¶æœŸè¿™ä¸ªmemberçœŸæ­£çš„offsetä½ç½®ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªå­˜å–æ“ä½œå¿…é¡»å»¶è¿Ÿè‡³æ‰§è¡ŒæœŸï¼Œç»ç”±ä¸€ä¸ªé¢å¤–çš„é—´æ¥å¯¼å¼•ï¼Œæ‰èƒ½å¤Ÿè§£å†³ã€‚ä½†å¦‚æœä½¿ç”¨originï¼Œå°±ä¸ä¼šæœ‰è¿™äº›é—®é¢˜ï¼Œå…¶ç±»å‹æ— ç–‘æ˜¯Point3d classï¼Œè€Œå³ä½¿å®ƒç»§æ‰¿è‡ª virtual baseclassï¼Œmembersçš„offsetä½ç½®ä¹Ÿåœ¨ç¼–è¯‘æ—¶æœŸå°±å›ºå®šäº†ã€‚ä¸€ä¸ªç§¯æè¿›å–çš„ç¼–è¯‘å™¨ç”šè‡³å¯ä»¥é™æ€åœ°ç»ç”± originå°±è§£å†³æ‰å¯¹xçš„å­˜å–ã€‚â€œä»originå­˜å–â€å’Œâ€œä»ptå­˜å–â€æœ‰ä»€ä¹ˆé‡å¤§çš„å·®å¼‚ï¼Ÿç­”æ¡ˆæ˜¯â€œå½“Point3dæ˜¯ä¸€ä¸ªderived classï¼Œè€Œåœ¨å…¶ç»§æ‰¿ç»“æ„ä¸­æœ‰ä¸€ä¸ªvirtual base classï¼Œå¹¶ä¸”è¢«å­˜å–çš„member(å¦‚æœ¬ä¾‹çš„xï¼‰æ˜¯ä¸€ä¸ªä»è¯¥virtual base classç»§æ‰¿è€Œæ¥çš„memberæ—¶ï¼Œå°±ä¼šæœ‰é‡å¤§çš„å·®å¼‚â€ã€‚è¿™æ—¶å€™æˆ‘ä»¬ä¸èƒ½å¤Ÿè¯´ptå¿…ç„¶æŒ‡å‘å“ªä¸€ç§ class typeï¼ˆå› æ­¤æˆ‘ä»¬ä¹Ÿå°±ä¸çŸ¥é“ç¼–è¯‘æ—¶æœŸè¿™ä¸ªmemberçœŸæ­£çš„offsetä½ç½®ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªå­˜å–æ“ä½œå¿…é¡»å»¶è¿Ÿè‡³æ‰§è¡ŒæœŸï¼Œç»ç”±ä¸€ä¸ªé¢å¤–çš„é—´æ¥å¯¼å¼•ï¼Œæ‰èƒ½å¤Ÿè§£å†³ã€‚ä½†å¦‚æœä½¿ç”¨originï¼Œå°±ä¸ä¼šæœ‰è¿™äº›é—®é¢˜ï¼Œå…¶ç±»å‹æ— ç–‘æ˜¯Point3d classï¼Œè€Œå³ä½¿å®ƒç»§æ‰¿è‡ª virtual baseclassï¼Œmembersçš„offsetä½ç½®ä¹Ÿåœ¨ç¼–è¯‘æ—¶æœŸå°±å›ºå®šäº†ã€‚ä¸€ä¸ªç§¯æè¿›å–çš„ç¼–è¯‘å™¨ç”šè‡³å¯ä»¥é™æ€åœ°ç»ç”± originå°±è§£å†³æ‰å¯¹xçš„å­˜å–ã€‚\né™æ€æ•°æ®æˆå‘˜\nã€‚ã€‚ã€‚\néé™æ€æ•°æ®æˆå‘˜\nã€‚ã€‚ã€‚\nç»§æ‰¿ä¸æ•°æ®æˆå‘˜\næŒ‡å‘Data Membersçš„æŒ‡é’ˆï¼ˆPointer to Data Membersï¼‰\nå¦‚æœvptræ”¾åœ¨å¯¹è±¡çš„å°¾ç«¯ï¼Œä¸‰ä¸ªåæ ‡å€¼åœ¨å¯¹è±¡å¸ƒå±€ä¸­çš„offsetåˆ†åˆ«æ˜¯0ï¼Œ4ï¼Œ8ã€‚å¦‚æœvptræ”¾åœ¨å¯¹è±¡çš„èµ·å¤´ï¼Œä¸‰ä¸ªåæ ‡å€¼åœ¨å¯¹è±¡å¸ƒå±€ä¸­çš„offsetåˆ†åˆ«æ˜¯4ï¼Œ8ï¼Œ12ã€‚ç„¶è€Œä½ è‹¥å»å–data membersçš„åœ°å€ï¼Œä¼ å›çš„å€¼æ€»æ˜¯å¤š1ï¼Œä¹Ÿå°±æ˜¯1ï¼Œ5ï¼Œ9æˆ–5ï¼Œ9ï¼Œ13ç­‰ç­‰ã€‚ä½ çŸ¥é“ä¸ºä»€ä¹ˆBjarneå†³å®šè¦è¿™ä¹ˆåšå—ï¼Ÿ\nä¸ºäº†åŒºåˆ†ç¬¬ä¸€ä¸ªæ•°æ®æˆå‘˜ä¸æŒ‡å‘ç±»å¯¹è±¡çš„åœ°å€ã€‚\nğŸ–• Functionè¯­ä¹‰å­¦\nå¦‚æœæˆ‘æœ‰ä¸€ä¸ªPoint3dçš„æŒ‡é’ˆå’Œå¯¹è±¡ï¼š\n1 2  Point3d obj; Point3d *ptr = \u0026amp;obj;   å½“æˆ‘è¿™æ ·åšï¼š\n1 2  obj.normalize(); ptr-\u0026gt;normalize();   æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆäº‹ï¼Ÿå…¶ä¸­çš„Point3dï¼šï¼šnormalizeï¼ˆï¼‰å®šä¹‰å¦‚ä¸‹ï¼š\nMemberçš„å„ç§è°ƒç”¨æ–¹å¼\néé™æ€æˆå‘˜å‡½æ•°\nC++çš„è®¾è®¡å‡†åˆ™ä¹‹ä¸€å°±æ˜¯ï¼šnonstatic member function è‡³å°‘å¿…é¡»å’Œä¸€èˆ¬çš„nonmember functionæœ‰ç›¸åŒçš„æ•ˆç‡ã€‚\nä¾‹å¦‚ä¸‹é¢çš„ä¸¤ä¸ªå‡½æ•°ï¼š\n1 2  float magnitude(const Point3d *_this){...} float Point3d::magnitude(){...}   é€‰æ‹©member functionä¸åº”è¯¥å¸¦æ¥ä»€ä¹ˆé¢å¤–è´Ÿæ‹…ã€‚è¿™æ˜¯å› ä¸ºç¼–è¯‘å™¨å†…éƒ¨å·²å°†â€œmemberå‡½æ•°å®ä¾‹â€è½¬æ¢ä¸ºå¯¹ç­‰çš„â€œnonmemberå‡½æ•°å®ä¾‹â€ã€‚\nä¸‹é¢æ˜¯è½¬åŒ–æ­¥éª¤ï¼š\n  æ”¹å†™å‡½æ•°çš„ signatureï¼ˆè¯‘æ³¨ï¼šæ„æŒ‡å‡½æ•°åŸå‹ï¼‰ä»¥å®‰æ’ä¸€ä¸ªé¢å¤–çš„å‚æ•°åˆ°member functionä¸­ï¼Œç”¨ä»¥æä¾›ä¸€ä¸ªå­˜å–ç®¡é“ï¼Œä½¿ class objectå¾—ä»¥å°†æ­¤å‡½æ•°è°ƒç”¨ã€‚è¯¥é¢å¤–å‚æ•°è¢«ç§°ä¸º thisæŒ‡é’ˆï¼š\n1 2  //non-const nonstatic memberçš„æ‰©å¼ è¿‡ç¨‹ Point3d Point3d::magnitude(Point3d *const this)   å¦‚æœmember functionæ˜¯constï¼Œåˆ™å˜æˆ\n1 2  //non-const nonstatic memberçš„æ‰©å¼ è¿‡ç¨‹ Point3d Point3d::magnitude(const Point3d *const this)     å°†æ¯ä¸€ä¸ªâ€œå¯¹ nonstatic data member çš„å­˜å–æ“ä½œâ€æ”¹ä¸ºç»ç”± thisæŒ‡é’ˆæ¥å­˜å–ï¼š\n1 2 3 4 5 6  { return sqrt( this-\u0026gt;_x * this-\u0026gt;_x + this-\u0026gt;_y * this-\u0026gt;_y + this-\u0026gt;_z * this-\u0026gt;_z); }     å°† member functioné‡æ–°å†™æˆä¸€ä¸ªå¤–éƒ¨å‡½æ•°ã€‚å°†å‡½æ•°åç§°ç»è¿‡â€œmanglingâ€å¤„ç†ï¼Œä½¿å®ƒåœ¨ç¨‹åºä¸­æˆä¸ºç‹¬ä¸€æ— äºŒçš„è¯­æ±‡ï¼š\n1  extern magnitude_7Point3dFv( register Point3d *const this );     åç§°çš„ç‰¹æ®Šå¤„ç†\nä¸€èˆ¬è€Œè¨€ï¼Œmemberçš„åç§°å‰é¢ä¼šè¢«åŠ ä¸Šclassåç§°ï¼Œå½¢æˆç‹¬ä¸€æ— äºŒçš„å‘½åã€‚ä¾‹å¦‚ä¸‹é¢çš„å£°æ˜ï¼š\n1  class Bar {public:int ival;...};   å…¶ä¸­çš„ivalæœ‰å¯èƒ½å˜æˆè¿™æ ·ï¼š\n1 2  //member ç»è¿‡name-manglingä¹‹åçš„å¯èƒ½ç»“æœä¹‹ä¸€ ival__3Bar   é™æ€æˆå‘˜å‡½æ•°\nå…³äºtypedefçš„ç”¨æ³•æ€»ç»“ https://www.cnblogs.com/csyisong/archive/2009/01/09/1372363.html\nâœ’ æ™ºèƒ½æŒ‡é’ˆ unique_ptr std::unique_ptr æ˜¯é€šè¿‡æŒ‡é’ˆå æœ‰å¹¶ç®¡ç†å¦ä¸€å¯¹è±¡ï¼Œå¹¶åœ¨ unique_ptr ç¦»å¼€ä½œç”¨åŸŸæ—¶é‡Šæ”¾è¯¥å¯¹è±¡çš„æ™ºèƒ½æŒ‡é’ˆã€‚åœ¨ä¸‹åˆ—ä¸¤è€…ä¹‹ä¸€å‘ç”Ÿæ—¶ç”¨å…³è”çš„åˆ é™¤å™¨é‡Šæ”¾å¯¹è±¡ï¼š\n é”€æ¯äº†ç®¡ç†çš„ unique_ptr å¯¹è±¡ é€šè¿‡ operator= æˆ– reset() èµ‹å€¼å¦ä¸€æŒ‡é’ˆç»™ç®¡ç†çš„ unique_ptr å¯¹è±¡ã€‚  shared_ptr std::shared_ptr æ˜¯é€šè¿‡æŒ‡é’ˆä¿æŒå¯¹è±¡å…±äº«æ‰€æœ‰æƒçš„æ™ºèƒ½æŒ‡é’ˆã€‚å¤šä¸ª shared_ptr å¯¹è±¡å¯å æœ‰åŒä¸€å¯¹è±¡ã€‚ä¸‹åˆ—æƒ…å†µä¹‹ä¸€å‡ºç°æ—¶é”€æ¯å¯¹è±¡å¹¶è§£åˆ†é…å…¶å†…å­˜ï¼š\n æœ€åå‰©ä¸‹çš„å æœ‰å¯¹è±¡çš„ shared_ptr è¢«é”€æ¯ï¼› æœ€åå‰©ä¸‹çš„å æœ‰å¯¹è±¡çš„ shared_ptr è¢«é€šè¿‡ operator= æˆ– reset() èµ‹å€¼ä¸ºå¦ä¸€æŒ‡é’ˆã€‚  æ¯æ¬¡åˆ›å»ºç±»çš„æ–°å¯¹è±¡æ—¶ï¼Œåˆå§‹åŒ–æŒ‡é’ˆå¹¶å°†å¼•ç”¨è®¡æ•°ç½®ä¸º1ï¼›å½“å¯¹è±¡ä½œä¸ºå¦ä¸€å¯¹è±¡çš„å‰¯æœ¬è€Œåˆ›å»ºæ—¶ï¼Œå¼•ç”¨è®¡æ•°åŠ 1ï¼›å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œèµ‹å€¼æ—¶ï¼Œèµ‹å€¼æ“ä½œç¬¦å‡å°‘å·¦æ“ä½œæ•°æ‰€æŒ‡å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼ˆå¦‚æœå¼•ç”¨è®¡æ•°ä¸ºå‡è‡³0ï¼Œåˆ™åˆ é™¤å¯¹è±¡ï¼‰ï¼Œå¹¶å¢åŠ å³æ“ä½œæ•°æ‰€æŒ‡å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼›è°ƒç”¨ææ„å‡½æ•°æ—¶ï¼Œæ„é€ å‡½æ•°å‡å°‘å¼•ç”¨è®¡æ•°ï¼ˆå¦‚æœå¼•ç”¨è®¡æ•°å‡è‡³0ï¼Œåˆ™åˆ é™¤åŸºç¡€å¯¹è±¡ï¼‰ã€‚\nshared_ptrçš„å†…å­˜æ¨¡å‹ï¼š\nä¸‹é¢æ˜¯ç”¨ç±»æ¨¡æ¿ç®€å•å®ç°shared_ptr.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62  #include \u0026lt;iostream\u0026gt;using namespace std; template\u0026lt;typename T\u0026gt; class SmartPointer { private: T* p_; size_t* count_; public: SmartPointer(T* ptr = nullptr) : p_(ptr) { if (p_) { count_ = new size_t(1); } else { count_ = new size_t(0); } } SmartPointer(const SmartPointer\u0026amp; ptr) { p_ = ptr.p_; count_ = ptr.count_; (*count_)++; } SmartPointer\u0026amp; operator=(const SmartPointer\u0026amp; ptr) { if (p_ == ptr.p_) { return *this; } if (p_) { if (--(*count_) == 0) { delete p_; delete count_; } } p_ = ptr.p_; count_ = ptr.count_; (*count_)++; return *this; } ~SmartPointer() { if (--(*count_) == 0) { delete p_; delete count_; } } size_t use_count() { return *count_; } }; int main() { SmartPointer\u0026lt;int\u0026gt; sp1(new int(10)); SmartPointer\u0026lt;int\u0026gt; sp2(sp1); SmartPointer\u0026lt;int\u0026gt; sp3(new int(20)); sp2 = sp3; std::cout \u0026lt;\u0026lt; sp1.use_count() \u0026lt;\u0026lt; std::endl; std::cout \u0026lt;\u0026lt; sp3.use_count() \u0026lt;\u0026lt; std::endl; }   æ™ºèƒ½æŒ‡é’ˆå¸¦æ¥çš„æ€§èƒ½å½±å“:\n1ï¼‰shared_ptrçš„å°ºå¯¸æ˜¯è£¸æŒ‡é’ˆçš„ä¸¤å€ã€‚\n2ï¼‰ä¼šå¸¦æ¥æ§åˆ¶å—çš„å¼€é”€ã€‚\n3ï¼‰å¼•ç”¨è®¡æ•°çš„é€’å¢å’Œé€’å‡æ˜¯åŸå­æ“ä½œï¼ŒåŸå­æ“ä½œä¸€èˆ¬éƒ½æ¯”éåŸå­æ“ä½œæ…¢ã€‚\nweak_ptr weak_ptr æ˜¯ä¸€ç§ä¸æ§åˆ¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„æ™ºèƒ½æŒ‡é’ˆ, å®ƒæŒ‡å‘ä¸€ä¸ª shared_ptr ç®¡ç†çš„å¯¹è±¡. è¿›è¡Œè¯¥å¯¹è±¡çš„å†…å­˜ç®¡ç†çš„æ˜¯é‚£ä¸ªå¼ºå¼•ç”¨çš„ shared_ptr. weak_ptråªæ˜¯æä¾›äº†å¯¹ç®¡ç†å¯¹è±¡çš„ä¸€ä¸ªè®¿é—®æ‰‹æ®µã€‚weak_ptr è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºé…åˆ shared_ptr è€Œå¼•å…¥çš„ä¸€ç§æ™ºèƒ½æŒ‡é’ˆæ¥ååŠ© shared_ptr å·¥ä½œ, å®ƒåªå¯ä»¥ä»ä¸€ä¸ª shared_ptr æˆ–å¦ä¸€ä¸ª weak_ptr å¯¹è±¡æ„é€ , å®ƒçš„æ„é€ å’Œææ„ä¸ä¼šå¼•èµ·å¼•ç”¨è®°æ•°çš„å¢åŠ æˆ–å‡å°‘ã€‚weak_ptræ˜¯ç”¨æ¥è§£å†³shared_ptrç›¸äº’å¼•ç”¨æ—¶çš„æ­»é”é—®é¢˜,å¦‚æœè¯´ä¸¤ä¸ªshared_ptrç›¸äº’å¼•ç”¨,é‚£ä¹ˆè¿™ä¸¤ä¸ªæŒ‡é’ˆçš„å¼•ç”¨è®¡æ•°æ°¸è¿œä¸å¯èƒ½ä¸‹é™ä¸º0,èµ„æºæ°¸è¿œä¸ä¼šé‡Šæ”¾ã€‚å®ƒæ˜¯å¯¹å¯¹è±¡çš„ä¸€ç§å¼±å¼•ç”¨ï¼Œä¸ä¼šå¢åŠ å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼Œå’Œshared_pträ¹‹é—´å¯ä»¥ç›¸äº’è½¬åŒ–ï¼Œshared_ptrå¯ä»¥ç›´æ¥èµ‹å€¼ç»™å®ƒï¼Œå®ƒå¯ä»¥é€šè¿‡è°ƒç”¨lockå‡½æ•°æ¥è·å¾—shared_ptrã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39  #include \u0026lt;iostream\u0026gt;#include \u0026lt;vector\u0026gt;#include \u0026lt;memory\u0026gt;using namespace std; class B; class A { public: weak_ptr\u0026lt;B\u0026gt; pb_; ~A() { cout \u0026lt;\u0026lt; \u0026#34;A delete\\n\u0026#34;; } }; class B { public: shared_ptr\u0026lt;A\u0026gt; pa_; ~B() { cout \u0026lt;\u0026lt; \u0026#34;B delete\\n\u0026#34;; } }; void fun() { shared_ptr\u0026lt;B\u0026gt; pb(new B()); shared_ptr\u0026lt;A\u0026gt; pa(new A()); pb-\u0026gt;pa_ = pa; pa-\u0026gt;pb_ = pb; cout \u0026lt;\u0026lt; pb.use_count() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; pa.use_count() \u0026lt;\u0026lt; endl; } int main() { fun(); return 0; }    æ³¨æ„çš„æ˜¯æˆ‘ä»¬ä¸èƒ½é€šè¿‡weak_ptrç›´æ¥è®¿é—®å¯¹è±¡çš„æ–¹æ³•ï¼Œæ¯”å¦‚Bå¯¹è±¡ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•print(),æˆ‘ä»¬ä¸èƒ½è¿™æ ·è®¿é—®ï¼Œpa-\u0026gt;pb_-\u0026gt;print(); è‹±æ–‡pb_æ˜¯ä¸€ä¸ªweak_ptrï¼Œåº”è¯¥å…ˆæŠŠå®ƒè½¬åŒ–ä¸ºshared_ptr,å¦‚ï¼šshared_ptr p = pa-\u0026gt;pb_.lock(); p-\u0026gt;print();\n å¤šçº¿ç¨‹è¯»å†™shared_ptréœ€è¦åŠ é” åœ¨ç°ä»£C++ä¸­ï¼Œé€šè¿‡ä½¿ç”¨shared_ptrè¿™æ ·çš„æ™ºèƒ½æŒ‡é’ˆèƒ½å¤Ÿå¾ˆå¥½çš„é™ä½å†…å­˜æ³„æ¼çš„å¯èƒ½æ€§ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ä¸­æ— ä¿æŠ¤çš„è¯»å†™shared_ptråˆ™æœ‰å¯èƒ½å¸¦æ¥race conditionçš„æƒ…å†µã€‚\n ç«äº‰å±å®³ (race hazard) åˆåç«æ€æ¡ä»¶ (race condition)ã€‚æ—¨åœ¨æè¿°ä¸€ä¸ªç³»ç»Ÿæˆ–è€…è¿›ç¨‹çš„è¾“å‡ºå±•ç°æ— æ³•é¢„æµ‹çš„ã€å¯¹äº‹ä»¶é—´ç›¸å¯¹æ—¶é—´çš„æ’åˆ—é¡ºåºçš„è‡´å‘½ç›¸ä¾æ€§ã€‚\n å‚è€ƒï¼š\n C++11\u0026ndash;æ™ºèƒ½æŒ‡é’ˆè¯¦è§£åŠå®ç° å¤šçº¿ç¨‹è¯»å†™shared_ptréœ€è¦åŠ é”  é‡æŒ‡é’ˆ\né‡æŒ‡é’ˆå°±æ˜¯æŒ‡å‘ä¸€ä¸ªå·²åˆ é™¤çš„å¯¹è±¡æˆ–è€…æœªç”³è¯·è®¿é—®å—é™å†…å­˜åŒºåŸŸçš„æŒ‡é’ˆ\nC++å†…å­˜ç®¡ç†ä¸ç¨‹åºå†…å­˜åˆ†åŒº C++å†…å­˜åˆ†åŒº C++å­˜åœ¨å¦‚ä¸‹çš„å†…å­˜åˆ†åŒº\n1ï¼‰æ ˆåŒºï¼ˆstackï¼‰ï¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…é‡Šæ”¾ ï¼Œå­˜æ”¾å‡½æ•°çš„ å‚æ•°å€¼ï¼Œå±€éƒ¨å˜é‡çš„å€¼ç­‰ã€‚å…¶æ“ä½œæ–¹å¼ç±»ä¼¼äºæ•°æ®ç»“ æ„ä¸­çš„æ ˆã€‚\n2ï¼‰å †åŒºï¼ˆheapï¼‰ï¼šä¸€èˆ¬ç”±ç¨‹åºå‘˜åˆ†é…é‡Šæ”¾ï¼Œè‹¥ç¨‹åºå‘˜ä¸ é‡Šæ”¾ï¼Œç¨‹åºç»“æŸæ—¶å¯èƒ½ç”±OSå›æ”¶ã€‚æ³¨æ„å®ƒä¸æ•°æ®ç»“æ„ ä¸­çš„å †æ˜¯ä¸¤å›äº‹ï¼Œåˆ†é…æ–¹å¼å€’æ˜¯ç±»ä¼¼äºé“¾è¡¨ã€‚\n3ï¼‰å…¨å±€/é™æ€åŒº(staticï¼‰ï¼šå…¨å±€å˜é‡å’Œé™æ€å˜é‡çš„å­˜å‚¨æ˜¯ æ”¾åœ¨ä¸€å—çš„ï¼Œåœ¨ç¨‹åºç¼–è¯‘æ—¶åˆ†é…\n4ï¼‰æ–‡å­—å¸¸é‡åŒºï¼šå­˜æ”¾å¸¸é‡å­—ç¬¦ä¸²\n5ï¼‰ç¨‹åºä»£ç åŒºï¼šå­˜æ”¾å‡½æ•°ä½“ï¼ˆç±»çš„æˆå‘˜å‡½æ•°ã€å…¨å±€å‡½æ•°ï¼‰ çš„äºŒè¿›åˆ¶ä»£ç \nCè¯­è¨€ä¸­ï¼Œå†…å­˜åˆ†é…æœ‰ä¸‰ç§ï¼š\n é™æ€åŒºåŸŸåˆ†é…ï¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…ä¸é‡Šæ”¾ï¼Œå†…å­˜åœ¨ç¼–è¯‘çš„æ—¶å€™å·²ç»åˆ†é…å¥½ï¼Œè¿™å—å†…å­˜åœ¨æ•´ä¸ªç¨‹åºçš„è¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ç›´åˆ°ç¨‹åºç»“æŸæ—¶æ‰è¢«é‡Šæ”¾ï¼Œå¦‚å…¨å±€å˜é‡ä¸staticå˜é‡ã€‚ æ ˆåˆ†é…ï¼šç”±ç¼–è¯‘å™¨åœ¨ç¨‹åºè¿è¡Œæ—¶ä»æ ˆä¸Šåˆ†é…ï¼Œå‡½æ•°æ ˆé€€å‡ºæ—¶è‡ªåŠ¨é‡Šæ”¾ã€‚æ ˆåˆ†é…çš„è¿ç®—åœ¨å¤„ç†å™¨çš„æŒ‡ä»¤é›†ä¸­ï¼Œæ‰€ä»¥å®ƒçš„è¿è¡Œæ•ˆç‡å¾ˆé«˜ï¼Œä½†èƒ½åˆ†é…çš„å†…å®¹æ˜¯æœ‰é™çš„ã€‚ å †åˆ†é…ï¼šæœ‰ç¨‹åºå‘˜ä¸»åŠ¨è°ƒç”¨å†…å­˜åˆ†é…å‡½æ•°æ¥ç”³è¯·å†…å­˜ï¼Œä¸”ä½¿ç”¨å®Œæ¯•åç”±ç¨‹åºå‘˜è‡ªå·±é‡Šæ”¾ï¼Œå…¶ä½¿ç”¨éå¸¸çµæ´»ï¼Œä½†å…¶åˆ†é…æ–¹å¼æ˜¯é€šè¿‡è°ƒç”¨å‡½æ•°æ¥å®ç°ï¼Œæ•ˆç‡æ²¡æ ˆé«˜ã€‚malloc,allocç­‰  ç¨‹åºåœ¨å†…å­˜ä¸­çš„åˆ†å¸ƒ ä¸­æ–‡ç‰ˆ\n  å†…æ ¸ç©ºé—´\n  æ ˆ\n1ã€stackå­˜æ”¾å‡½æ•°çš„ä¸´æ—¶å˜é‡ã€å±€éƒ¨å˜é‡ã€å‡½æ•°å‚æ•°å’Œè¿”å›å€¼\n2ã€ç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾ã€‚\n  åŠ¨æ€é“¾æ¥åº“(å…±äº«æ˜ å°„åŒº)\nè°ƒç”¨çš„åº“æ–‡ä»¶ï¼Œä½äºå †å’Œæ ˆä¹‹é—´\n  å †\nheapç”¨æ¥åŠ¨æ€åˆ†é…å†…å­˜ï¼Œç”±ç¨‹åºå‘˜æ§åˆ¶ï¼Œäº¤ç”±ç¨‹åºè‡ªèº«å†³å®šå¼€è¾Ÿå’Œé‡Šæ”¾ã€‚\n  å…¨å±€æ•°æ®åŒº\n.bss\nbssæ®µç”¨æ¥å­˜æ”¾æ²¡æœ‰è¢«åˆå§‹åŒ–å’Œå·²ç»è¢«åˆå§‹åŒ–ä¸º0çš„å…¨å±€å˜é‡\n.data\ndataæ®µç”¨æ¥å­˜æ”¾å·²ç»è¢«åˆå§‹åŒ–ä¸ºé0çš„å…¨å±€å˜é‡\n  å¸¸é‡åŒº\n.rodata\nrodataæ®µç”¨æ¥å­˜æ”¾å¸¸é‡æ•°æ®ã€è¢«ç¼–è¯‘å™¨è‡ªåŠ¨å­˜æ”¾æ¥çš„å­—ç¬¦ä¸²å’ŒåŠ constå…³é”®å­—çš„å¸¸é‡æ•°æ®ã€‚\n  ä»£ç åŒº\n.text\ntextæ®µç”¨æ¥å­˜æ”¾ä»£ç å’Œéƒ¨åˆ†æ•´æ•°å¸¸é‡ï¼Œè¯¥æ®µæ˜¯å¯æ‰§è¡Œçš„ã€‚\n  å †ä¸æ ˆ æ ˆæ˜¯ä¸€ç§çš„â€œå…ˆè¿›åå‡ºâ€çš„å­˜å‚¨ç»“æ„ã€‚\nå †æ˜¯ä¸€ç§å®Œå…¨äºŒå‰æ ‘ã€‚èŠ‚ç‚¹ä»å·¦åˆ°å³å¡«æ»¡ï¼Œæœ€åä¸€å±‚çš„æ ‘å¶éƒ½åœ¨æœ€å·¦è¾¹ã€‚ï¼ˆå³å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ²¡æœ‰å·¦è¾¹å„¿å­ï¼Œé‚£ä¹ˆå®ƒä¸€å®šæ²¡æœ‰å³è¾¹å„¿å­ï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å°äºï¼ˆæˆ–è€…å¤§äºï¼‰å…¶å­èŠ‚ç‚¹çš„å€¼ï¼ˆå¤§é¡¶å †ã€å°é¡¶å †ï¼‰ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯å¯ä»¥ä½¿ç”¨ä¸€ç»´æ•°ç»„æ¥è¡¨ç¤ºã€‚å †çš„æ“ä½œä¹Ÿå¯é€šè¿‡æ•°æ®å…ƒç´ äº¤æ¢çš„å½¢å¼è§£å†³ï¼Œéå¸¸é€‚åˆå†…å­˜ç©ºé—´çº¿æ€§çš„ç‰¹ç‚¹ã€‚\nå‚è€ƒåœ°å€\n ç¨‹åºåœ¨å†…å­˜ä¸­çš„åˆ†å¸ƒ http://baijiahao.baidu.com/s?id=1664957369973450228\u0026amp;wfr=spider\u0026amp;for=pc  C++å†…å­˜æ³„æ¼  ç³»ç»Ÿèµ„æºæ³„éœ²ï¼ˆResource Leakï¼‰ã€‚ä¸»è¦æŒ‡ç¨‹åºä½¿ç”¨ç³»ç»Ÿåˆ†é…çš„èµ„æºæ¯”å¦‚ Bitmap,handle ,SOCKETç­‰æ²¡æœ‰ä½¿ç”¨ç›¸åº”çš„å‡½æ•°é‡Šæ”¾æ‰ï¼Œå¯¼è‡´ç³»ç»Ÿèµ„æºçš„æµªè´¹ï¼Œä¸¥é‡å¯å¯¼è‡´ç³»ç»Ÿæ•ˆèƒ½é™ä½ï¼Œç³»ç»Ÿè¿è¡Œä¸ç¨³å®šã€‚\n å†…å­˜æ³„æ¼ å†…å­˜æ³„æ¼æŒ‡ç”±äºç–å¿½æˆ–é”™è¯¯é€ æˆç¨‹åºæœªèƒ½é‡Šæ”¾å·²ç»ä¸å†ä½¿ç”¨çš„å†…å­˜çš„æƒ…å†µ\næ£€æµ‹å†…å­˜æ³„æ¼çš„åŸç† ä¸»è¦è¿˜æ˜¯è¿ç”¨äºŒè¿›åˆ¶æ’æ¡©ï¼Œè®°å½•èµ„æºçš„ç”³è¯·å’Œé‡Šæ”¾æ“ä½œï¼Œç„¶åå¯¹è®°å½•è¿›è¡ŒåŒ¹é…å‰”é™¤ï¼Œæœ€åå°±æ˜¯å‰©ä¸‹çš„æ³„æ¼çš„äº†ã€‚\næ£€æµ‹æ–¹æ³• æœ€ç®€å•çš„ åœ¨æ¯ä¸€å¤„ç”³è¯·/é‡Šæ”¾å†…å­˜çš„åœ°æ–¹è¿›è¡Œæ‰“ç‚¹ï¼Œç„¶ååŒ¹å¯¹ä¸€ä¸‹å°±çŸ¥é“å“ªé‡Œå†…å­˜æ³„éœ²äº†ã€‚\nWindowså¹³å°ä¸‹çš„å†…å­˜æ³„æ¼æ£€æµ‹ Windowså¹³å°ä¸‹é¢Visual Studio è°ƒè¯•å™¨å’Œ C è¿è¡Œæ—¶ (CRT) åº“ä¸ºæˆ‘ä»¬æä¾›äº†æ£€æµ‹å’Œè¯†åˆ«å†…å­˜æ³„æ¼çš„æœ‰æ•ˆæ–¹æ³•ï¼ŒåŸç†å¤§è‡´å¦‚ä¸‹ï¼šå†…å­˜åˆ†é…è¦é€šè¿‡CRTåœ¨è¿è¡Œæ—¶å®ç°ï¼Œåªè¦åœ¨åˆ†é…å†…å­˜å’Œé‡Šæ”¾å†…å­˜æ—¶åˆ†åˆ«åšå¥½è®°å½•ï¼Œç¨‹åºç»“æŸæ—¶å¯¹æ¯”åˆ†é…å†…å­˜å’Œé‡Šæ”¾å†…å­˜çš„è®°å½•å°±å¯ä»¥ç¡®å®šæ˜¯ä¸æ˜¯æœ‰å†…å­˜æ³„æ¼ã€‚åœ¨vsä¸­å¯ç”¨å†…å­˜æ£€æµ‹çš„æ–¹æ³•å¦‚ä¸‹ï¼š\n  åœ¨ç¨‹åºä¸­åŒ…æ‹¬ä»¥ä¸‹è¯­å¥ï¼š ï¼ˆ#include è¯­å¥å¿…é¡»é‡‡ç”¨ä¸Šæ–‡æ‰€ç¤ºé¡ºåºã€‚ å¦‚æœæ›´æ”¹äº†é¡ºåºï¼Œæ‰€ä½¿ç”¨çš„å‡½æ•°å¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œã€‚ï¼‰\n1 2 3  #define _CRTDBG_MAP_ALLOC#include \u0026lt;stdlib.h\u0026gt;#include \u0026lt;crtdbg.h\u0026gt;   é€šè¿‡åŒ…æ‹¬ crtdbg.hï¼Œå°† malloc å’Œ free å‡½æ•°æ˜ å°„åˆ°å®ƒä»¬çš„è°ƒè¯•ç‰ˆæœ¬ï¼Œå³ _malloc_dbg å’Œ _free_dbgï¼Œè¿™ä¸¤ä¸ªå‡½æ•°å°†è·Ÿè¸ªå†…å­˜åˆ†é…å’Œé‡Šæ”¾ã€‚ æ­¤æ˜ å°„åªåœ¨è°ƒè¯•ç‰ˆæœ¬ï¼ˆåœ¨å…¶ä¸­å®šä¹‰äº†**_DEBUG**ï¼‰ä¸­å‘ç”Ÿã€‚ å‘å¸ƒç‰ˆæœ¬ä½¿ç”¨æ™®é€šçš„ **malloc** å’Œ **free** å‡½æ•°ã€‚\n #define è¯­å¥å°† CRT å †å‡½æ•°çš„åŸºç‰ˆæœ¬æ˜ å°„åˆ°å¯¹åº”çš„â€œDebugâ€ç‰ˆæœ¬ã€‚ å¹¶éç»å¯¹éœ€è¦è¯¥è¯­å¥ï¼›ä½†å¦‚æœæ²¡æœ‰è¯¥è¯­å¥ï¼Œå†…å­˜æ³„æ¼è½¬å‚¨åŒ…å«çš„æœ‰ç”¨ä¿¡æ¯å°†è¾ƒå°‘ã€‚\n  åœ¨æ·»åŠ äº†ä¸Šè¿°è¯­å¥ä¹‹åï¼Œå¯ä»¥é€šè¿‡åœ¨ç¨‹åºä¸­åŒ…æ‹¬ä»¥ä¸‹è¯­å¥ï¼ˆé€šå¸¸åº”æ°å¥½æ”¾åœ¨ç¨‹åºé€€å‡ºä½ç½®ä¹‹å‰ï¼‰æ¥è½¬å‚¨å†…å­˜æ³„æ¼ä¿¡æ¯ï¼š\n1  _CrtDumpMemoryLeaks();   å¦‚æœæ²¡æœ‰ä½¿ç”¨ #define _CRTDBG_MAP_ALLOC è¯­å¥ï¼Œå†…å­˜æ³„æ¼è½¬å‚¨å°†å¦‚ä¸‹æ‰€ç¤º\n æœªå®šä¹‰ _CRTDBG_MAP_ALLOC æ—¶ï¼Œæ‰€æ˜¾ç¤ºçš„ä¼šæ˜¯ï¼š\n å†…å­˜åˆ†é…ç¼–å·ï¼ˆåœ¨å¤§æ‹¬å·å†…ï¼‰ã€‚ å—ç±»å‹ï¼ˆæ™®é€šã€å®¢æˆ·ç«¯æˆ– CRTï¼‰ã€‚     å®šä½åˆ°å…·ä½“çš„ä½ç½®\n  æœ€ç»ˆå®šä½ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  #define _CRTDBG_MAP_ALLOC#include \u0026lt;stdlib.h\u0026gt;#include \u0026lt;crtdbg.h\u0026gt; #include \u0026lt;iostream\u0026gt;using namespace std; _CrtMemState s1, s2, s3; void GetMemory(char *p, int num) { p = (char*)malloc(sizeof(char) * num); } int main(int argc,char** argv) { _CrtMemCheckpoint( \u0026amp;s1 ); char *str = NULL; GetMemory(str, 100); _CrtMemCheckpoint( \u0026amp;s2 ); if ( _CrtMemDifference( \u0026amp;s3, \u0026amp;s1, \u0026amp;s2) ) _CrtMemDumpStatistics( \u0026amp;s3 ); cout\u0026lt;\u0026lt;\u0026#34;Memory leak test!\u0026#34;\u0026lt;\u0026lt;endl; _CrtDumpMemoryLeaks(); return 0; }   Linuxå¹³å°ä¸‹çš„å†…å­˜æ³„æ¼æ£€æµ‹ Valgrindæ˜¯ä¸€å¥—Linuxä¸‹ï¼Œå¼€æ”¾æºä»£ç ï¼ˆGPL V2ï¼‰çš„ä»¿çœŸè°ƒè¯•å·¥å…·çš„é›†åˆã€‚Valgrindç”±å†…æ ¸ï¼ˆcoreï¼‰ä»¥åŠåŸºäºå†…æ ¸çš„å…¶ä»–è°ƒè¯•å·¥å…·ç»„æˆã€‚å†…æ ¸ç±»ä¼¼äºä¸€ä¸ªæ¡†æ¶ï¼ˆframeworkï¼‰ï¼Œå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªCPUç¯å¢ƒï¼Œå¹¶æä¾›æœåŠ¡ç»™å…¶ä»–å·¥å…·ï¼›è€Œå…¶ä»–å·¥å…·åˆ™ç±»ä¼¼äºæ’ä»¶ (plug-in)ï¼Œåˆ©ç”¨å†…æ ¸æä¾›çš„æœåŠ¡å®Œæˆå„ç§ç‰¹å®šçš„å†…å­˜è°ƒè¯•ä»»åŠ¡ã€‚Valgrindçš„ä½“ç³»ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nå‚è€ƒé“¾æ¥ï¼š\n C/C++å†…å­˜æ³„æ¼åŠæ£€æµ‹   C++å‡½æ•°æŒ‡é’ˆ å‡½æ•°æŒ‡é’ˆæ˜¯æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡ã€‚\næŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡çš„ä¸€èˆ¬å®šä¹‰å½¢å¼ä¸ºï¼š æ•°æ®ç±»å‹ (*æŒ‡é’ˆå˜é‡å)(å‚æ•°è¡¨);\nå‚è€ƒï¼šC++å‡½æ•°æŒ‡é’ˆè¯¦è§£\nmallocçš„åŸç† Mallocå‡½æ•°ç”¨äºåŠ¨æ€åˆ†é…å†…å­˜ã€‚ä¸ºäº†å‡å°‘å†…å­˜ç¢ç‰‡å’Œç³»ç»Ÿè°ƒç”¨çš„å¼€é”€ï¼Œmallocå…¶é‡‡ç”¨å†…å­˜æ± çš„æ–¹å¼ï¼Œå…ˆç”³è¯·å¤§å—å†…å­˜ä½œä¸ºå †åŒºï¼Œç„¶åå°†å †åŒºåˆ†ä¸ºå¤šä¸ªå†…å­˜å—ï¼Œä»¥å—ä½œä¸ºå†…å­˜ç®¡ç†çš„åŸºæœ¬å•ä½ã€‚å½“ç”¨æˆ·ç”³è¯·å†…å­˜æ—¶ï¼Œç›´æ¥ä»å †åŒºåˆ†é…ä¸€å—åˆé€‚çš„ç©ºé—²å—ã€‚Mallocé‡‡ç”¨éšå¼é“¾è¡¨ç»“æ„å°†å †åŒºåˆ†æˆè¿ç»­çš„ã€å¤§å°ä¸ä¸€çš„å—ï¼ŒåŒ…å«å·²åˆ†é…å—å’Œæœªåˆ†é…å—ï¼›åŒæ—¶mallocé‡‡ç”¨æ˜¾ç¤ºé“¾è¡¨ç»“æ„æ¥ç®¡ç†æ‰€æœ‰çš„ç©ºé—²å—ï¼Œå³ä½¿ç”¨ä¸€ä¸ªåŒå‘é“¾è¡¨å°†ç©ºé—²å—è¿æ¥èµ·æ¥ï¼Œæ¯ä¸€ä¸ªç©ºé—²å—è®°å½•äº†ä¸€ä¸ªè¿ç»­çš„ã€æœªåˆ†é…çš„åœ°å€ã€‚\nå½“è¿›è¡Œå†…å­˜åˆ†é…æ—¶ï¼ŒMallocä¼šé€šè¿‡éšå¼é“¾è¡¨éå†æ‰€æœ‰çš„ç©ºé—²å—ï¼Œé€‰æ‹©æ»¡è¶³è¦æ±‚çš„å—è¿›è¡Œåˆ†é…ï¼›å½“è¿›è¡Œå†…å­˜åˆå¹¶æ—¶ï¼Œmallocé‡‡ç”¨è¾¹ç•Œæ ‡è®°æ³•ï¼Œæ ¹æ®æ¯ä¸ªå—çš„å‰åå—æ˜¯å¦å·²ç»åˆ†é…æ¥å†³å®šæ˜¯å¦è¿›è¡Œå—åˆå¹¶ã€‚\nMallocåœ¨ç”³è¯·å†…å­˜æ—¶ï¼Œä¸€èˆ¬ä¼šé€šè¿‡brkæˆ–è€…mmapç³»ç»Ÿè°ƒç”¨è¿›è¡Œç”³è¯·ã€‚å…¶ä¸­å½“ç”³è¯·å†…å­˜å°äº128Kæ—¶ï¼Œä¼šä½¿ç”¨ç³»ç»Ÿå‡½æ•°brkåœ¨å †åŒºä¸­åˆ†é…ï¼›è€Œå½“ç”³è¯·å†…å­˜å¤§äº128Kæ—¶ï¼Œä¼šä½¿ç”¨ç³»ç»Ÿå‡½æ•°mmapåœ¨æ˜ å°„åŒºåˆ†é…ã€‚\nC++æ¨¡æ¿ https://www.cnblogs.com/gw811/archive/2012/10/25/2738929.html\næ¨¡æ¿æ˜¯ä¸€ç§å¯¹ç±»å‹è¿›è¡Œå‚æ•°åŒ–çš„å·¥å…·ï¼›é€šå¸¸æœ‰ä¸¤ç§å½¢å¼ï¼šå‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿ï¼›å‡½æ•°æ¨¡æ¿é’ˆå¯¹ä»…å‚æ•°ç±»å‹ä¸åŒçš„å‡½æ•°ï¼›ç±»æ¨¡æ¿é’ˆå¯¹ä»…æ•°æ®æˆå‘˜å’Œæˆå‘˜å‡½æ•°ç±»å‹ä¸åŒçš„ç±»ã€‚\nå‡½æ•°æ¨¡æ¿ å‡½æ•°æ¨¡æ¿æ ¼å¼ 1 2 3 4  template \u0026lt;class å½¢å‚åï¼Œclass å½¢å‚åï¼Œ......\u0026gt; è¿”å›ç±»å‹ å‡½æ•°å(å‚æ•°åˆ—è¡¨) { å‡½æ•°ä½“ }    å…¶ä¸­templateå’Œclassæ˜¯å…³è§å­—ï¼Œclasså¯ä»¥ç”¨typename å…³è§å­—ä»£æ›¿ï¼Œåœ¨è¿™é‡Œtypename å’Œclassæ²¡åŒºåˆ«\n ç±»æ¨¡æ¿ ç±»æ¨¡æ¿æ ¼å¼ 1 2  template\u0026lt;class å½¢å‚åï¼Œclass å½¢å‚åï¼Œâ€¦\u0026gt; class ç±»å { ... };   ç±»æ¨¡æ¿å¯¹è±¡çš„åˆ›å»º\næ¯”å¦‚ä¸€ä¸ªæ¨¡æ¿ç±»Aï¼Œåˆ™ä½¿ç”¨ç±»æ¨¡æ¿åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ä¸ºA m;åœ¨ç±»Aåé¢è·Ÿä¸Šä¸€ä¸ª\u0026lt;\u0026gt;å°–æ‹¬å·å¹¶åœ¨é‡Œé¢å¡«ä¸Šç›¸åº”çš„ç±»å‹ï¼Œè¿™æ ·çš„è¯ç±»Aä¸­å‡¡æ˜¯ç”¨åˆ°æ¨¡æ¿å½¢å‚çš„åœ°æ–¹éƒ½ä¼šè¢«int æ‰€ä»£æ›¿ã€‚å½“ç±»æ¨¡æ¿æœ‰ä¸¤ä¸ªæ¨¡æ¿å½¢å‚æ—¶åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ä¸ºA\u0026lt;int, double\u0026gt; m;ç±»å‹ä¹‹é—´ç”¨é€—å·éš”å¼€ã€‚\nåœ¨ç±»æ¨¡æ¿å¤–éƒ¨å®šä¹‰æˆå‘˜å‡½æ•°çš„æ–¹æ³•ä¸ºï¼š\n1  template\u0026lt;æ¨¡æ¿å½¢å‚åˆ—è¡¨\u0026gt; å‡½æ•°è¿”å›ç±»å‹ ç±»å\u0026lt;æ¨¡æ¿å½¢å‚å\u0026gt;::å‡½æ•°å(å‚æ•°åˆ—è¡¨){å‡½æ•°ä½“}ï¼Œ   ä¾‹å¦‚ï¼š\n1  template\u0026lt;class T1,class T2\u0026gt; void A\u0026lt;T1,T2\u0026gt;::h(){}ã€‚   C++å¼•ç”¨ å¼•ç”¨é™å®šç¬¦ï¼š \u0026amp; ä¸ \u0026amp;\u0026amp; ï¼Œæœ‰constçš„è¯ä¸¤ä¸ªé™å®šç¬¦å‡éœ€è¦åœ¨conståé¢\nç§»åŠ¨\nstd::move()\nè½¬å‘\nstd::forward()\nä¿æŒå®å‚çš„æºç±»å‹ä»¥åŠå€¼\næ ˆæˆ–è€…å †ä¸Šé¢åˆ›å»ºç±» åœ¨å †ä¸Šåˆ›å»ºç±»å¯¹è±¡ è®¾ç½®ææ„å‡½æ•°ä¸ºç§æœ‰ï¼š\n1 2 3 4 5 6 7  class HeapClass{ public: HeapClass(){} private: ~HeapClass(){} };   åœ¨æ ˆä¸Šåˆ›å»ºç±»å¯¹è±¡ é‡è½½newå’Œdeleteè¿ç®—ç¬¦ä¸ºç§æœ‰\n1 2 3 4 5 6 7 8 9  class StackClass{ public: StackClass(){} ~StackClass(){} private: void* operator new(size_t t){} void operator delete(void *ptr){} };   ä¸ä½¿ç”¨ç¬¬ä¸‰ä¸ªæ•°äº¤æ¢ä¸¤ä¸ªæ•° åŠ æ³• 1 2 3 4 5 6  void swap1(int \u0026amp;x,int \u0026amp;y) { x = x + y; y = x - y; x = x - y; }   å¼‚æˆ– 1 2 3 4 5 6  void swap2(int \u0026amp;x,int \u0026amp;y) { x = x ^ y; y = y ^ x; x = x ^ y; }   å›è°ƒå‡½æ•°ä¸ä»¿å‡½æ•° ä¸ºä»€ä¹ˆä½¿ç”¨ä»¿å‡½æ•°ï¼Ÿ\n è¿­ä»£å’Œè®¡ç®—é€»è¾‘åˆ†ç¦» å‚æ•°å¯è®¾ç½® æœ‰çŠ¶æ€ æ€§èƒ½(ç¼–è¯‘æ—¶æœŸå°±èƒ½å¤Ÿç¡®å®šè°ƒç”¨çš„å‡½æ•°)  å‡½æ•°æŒ‡é’ˆæœ‰ç¼ºç‚¹,æœ€é‡è¦çš„æ˜¯å®ƒæ— æ³•æŒæœ‰è‡ªå·±çš„çŠ¶æ€(æ‰€è°“å±€éƒ¨çŠ¶æ€,localstatesï¼‰ï¼Œä¹Ÿæ— æ³•è¾¾åˆ°ç»„ä»¶æŠ€æœ¯ä¸­çš„å¯é€‚é…æ€§ï¼ˆadaptabilityï¼‰â€”â€”ä¹Ÿå°±æ˜¯æ— æ³•å†å°†æŸäº›ä¿®é¥°æ¡ä»¶åŠ è¯¸äºå…¶ä¸Šè€Œæ”¹å˜å…¶çŠ¶æ€ã€‚\nä¸ºæ­¤ï¼ŒSTL ç®—æ³•çš„ç‰¹æ®Šç‰ˆæœ¬æ‰€æ¥å—çš„æ‰€è°“â€œæ¡ä»¶â€æˆ– â€œç­–ç•¥â€æˆ– â€œä¸€æ•´ç»„æ“ä½œâ€ï¼Œéƒ½ä»¥ä»¿å‡½æ•°å½¢å¼å‘ˆç°ã€‚æ‰€è°“ä»¿å‡½æ•°ï¼ˆfunctorï¼‰å°±æ˜¯ä½¿ç”¨èµ·æ¥åƒå‡½æ•°ä¸€æ ·çš„ä¸œè¥¿ã€‚å¦‚æœä½ é’ˆå¯¹æŸä¸ª class è¿›è¡Œ operator(ï¼‰é‡è½½ï¼Œå®ƒå°±æˆä¸ºä¸€ä¸ªä»¿å‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  #include \u0026lt;iostream\u0026gt;#include \u0026lt;algorithm\u0026gt;using namespace std; //å›è°ƒå‡½æ•° void call_back(char elem) { cout \u0026lt;\u0026lt; elem \u0026lt;\u0026lt; endl; } //ä»¿å‡½æ•° struct Functor { void operator() (char elem) { cout \u0026lt;\u0026lt; elem \u0026lt;\u0026lt; endl; } }; int main() { string strA = \u0026#34;hello\u0026#34;; string strB = \u0026#34;world\u0026#34;; for_each(strA.begin(),strA.end(),Functor()); cout\u0026lt;\u0026lt;\u0026#34;===========GAP===============\u0026#34;\u0026lt;\u0026lt;endl; for_each(strB.begin(),strB.end(),call_back); getchar(); return 0; }    ä»¿å‡½æ•°éœ€è¦ç»è¿‡3æ¬¡çš„æ„é€ å’Œææ„ã€‚\n ä»¿å‡½æ•°å’Œå›è°ƒå‡½æ•°åŒºåˆ«åœ¨äº:\n ä½¿ç”¨ä»¿å‡½æ•°å¯ä»¥å£°æ˜åœ¨ä¸šåŠ¡ç›¸å…³çš„ç±»å†…éƒ¨ ç¼©å°ä½œç”¨åŸŸ ä½¿ç”¨ä»¿å‡½æ•°å¯ä»¥ä½¿ç”¨ç±»çš„æˆå‘˜å±æ€§å’Œæˆå‘˜å‡½æ•° ä»¿å‡½æ•°æ˜¯ä¸€ä¸ªç±» å¯ä»¥ä½¿ç”¨é¢å‘å¯¹è±¡çš„å„ç§æœºåˆ¶(å°è£… ç»§æ‰¿ å¤šæ€) è‹¥ä½¿ç”¨å›è°ƒå‡½æ•° é‚£ä¹ˆåªèƒ½å£°æ˜ä¸ºæŸä¸ªç±»çš„é™æ€æˆå‘˜å‡½æ•°æˆ–å…¨å±€å‡½æ•°ï¼Œä½¿ç”¨ç±»å†…éƒ¨çš„èµ„æºéœ€è¦ç”¨ä¸€äº›æ‰‹æ®µä¼ å‚,æ²¡æœ‰ç›´æ¥ä½¿ç”¨æˆå‘˜å‡½æ•°ä¾¿æ·  å‚è€ƒï¼š\nhttps://my.oschina.net/mlgb/blog/290350\nC++ä»¿å‡½æ•°ï¼ˆfunctorï¼‰\nC++ææ„å‡½æ•°ä¸ºä»€ä¹ˆæ˜¯è™šå‡½æ•° åŸå› ï¼šåŸºç±»å¯¹è±¡çš„æŒ‡é’ˆæ“ä½œæ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œé˜²æ­¢ææ„å‡½æ•°åªè°ƒç”¨åŸºç±»çš„ï¼Œè€Œä¸è°ƒç”¨æ´¾ç”Ÿç±»çš„\nå‚è€ƒï¼š\n https://blog.csdn.net/zkangaroo/article/details/57000397  constå…³é”®å­—çš„ç”¨æ³•\nMallocçš„åŸç†\n+++++++++++++++++\nå®ç°memcpyğŸ“ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  void *my_memcpy(void *dst, void *src, int n) { char *d = (char *)(dst); char *s = (char *)(src); if (d \u0026gt; s \u0026amp;\u0026amp; d \u0026lt; s + n) { for(int i = n-1;i \u0026gt;= 0;--i) *(d + i) = *(s + i); } else { for(int i = 0;i \u0026lt; n;++i) *(d + i) = *(s + i); } return dst; }   memmoveä¸memcpyçš„åŒºåˆ«ï¼Ÿ strcpyä¸mencpyçš„åŒºåˆ«? å¿«é€Ÿæ’åºâ² 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  int partition(vector\u0026lt;int\u0026gt; \u0026amp;nums, int start, int end) { int p = nums[start]; while (start \u0026lt; end) { while (nums[end] \u0026gt;= p \u0026amp;\u0026amp; start \u0026lt; end) --end; nums[start] = nums[end]; while (nums[start] \u0026lt;= p \u0026amp;\u0026amp; start \u0026lt; end) ++start; nums[end] = nums[start]; } nums[start] = p; return start; } void quick_sort(vector\u0026lt;int\u0026gt; \u0026amp;nums, int left, int right) { if (left \u0026lt; right) { int p = partition(nums, left, right); quick_sort(nums, left, p - 1); quick_sort(nums, p + 1, right); } }   å †æ’åºğŸ³ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  void heap_sort(vector\u0026lt;int\u0026gt; \u0026amp;nums, int n) { if (n == 1) return; for (int i = n / 2 - 1; i \u0026gt;= 0; --i) { int left = 2 * i + 1, right = 2 * i + 2; int imax = i; if (left \u0026lt; n \u0026amp;\u0026amp; nums[left] \u0026gt; nums[imax]) imax = left; if (right \u0026lt; n \u0026amp;\u0026amp; nums[right] \u0026gt; nums[imax]) imax = right; if (imax != i) swap(nums[i], nums[imax]); } swap(nums[0], nums[n - 1]); heap_sort(nums, n - 1); }   ğŸ‘ å †TopK C++å®ç°æœ€å¤§å †å’Œæœ€å°å †\næœ€å°å † æ„å»ºã€æ’å…¥ã€åˆ é™¤çš„è¿‡ç¨‹å›¾è§£\n#Network\nå‚è€ƒï¼š\n æå®šè®¡ç®—æœºç½‘ç»œé¢è¯•ï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº†ï¼ˆè¡¥å……ç‰ˆï¼‰  å¤šé—®ä¸ºä»€ä¹ˆï¼ ğŸš ç½‘ç»œåˆ†å±‚ OSIä¸TCP/IPåˆ†å±‚æ¨¡å‹\nä¸ºä»€ä¹ˆç½‘ç»œéœ€è¦åˆ†å±‚ï¼Ÿ\n  å¤§éƒ¨åˆ†è½¯ä»¶ç³»ç»Ÿéƒ½æ˜¯åˆ†å±‚æ¶æ„çš„ï¼Œä¸ºäº†å·¥ç¨‹ä¸Šå®ç°/è°ƒè¯•/ç»´æŠ¤æ–¹ä¾¿ã€‚ç½‘ç»œç³»ç»Ÿåˆ†å¾—æ›´æ˜æ˜¾ä¸€ç‚¹ï¼Œå› ä¸ºå…¶ç³»ç»Ÿè®¾è®¡å†™æˆäº†åè®®ã€‚\n  æŠŠTCP/IPå±‚æ¬¡åŒ–æ˜¯æœ‰å¥½å¤„çš„ã€‚æ¯”å¦‚ï¼Œå¦‚æœäº’è”ç½‘åªç”±ä¸€ä¸ªåè®®ç»Ÿç­¹ï¼ŒæŸä¸ªåœ°æ–¹éœ€è¦æ”¹å˜è®¾è®¡æ—¶ï¼Œå°±å¿…é¡»æŠŠæ‰€æœ‰éƒ¨åˆ†æ•´ä½“æ›¿æ¢æ‰ã€‚è€Œåˆ†å±‚ä¹‹ååªéœ€æŠŠå˜åŠ¨çš„å±‚æ›¿æ¢æ‰å³å¯ã€‚æŠŠå„å±‚ä¹‹é—´çš„æ¥å£éƒ¨åˆ†è§„åˆ’å¥½ä¹‹åï¼Œæ¯ä¸ªå±‚æ¬¡å†…éƒ¨çš„è®¾è®¡å°±èƒ½å¤Ÿè‡ªç”±æ”¹åŠ¨äº†ã€‚\n  åˆ†å±‚æ¨¡å‹ä¼ è¾“è¿‡ç¨‹\nå‘é€ç«¯åœ¨å±‚ä¸å±‚ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶å¿…å®šä¼šè¢«æ‰“ä¸Šä¸€ä¸ªè¯¥å±‚æ‰€å±çš„é¦–éƒ¨ä¿¡æ¯ã€‚åä¹‹ï¼Œæ¥æ”¶ç«¯åœ¨å±‚ä¸å±‚ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶ä¼šæŠŠå¯¹åº”çš„é¦–éƒ¨æ¶ˆå»ã€‚\nå‚è€ƒï¼šä¸ºä»€ä¹ˆç½‘ç»œåè®®é€‰æ‹©åˆ†å±‚è®¾è®¡ï¼Ÿè¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ\nğŸ¥‰ ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ ä¸ºä»€ä¹ˆTCPå®¢æˆ·ç«¯æœ€åè¿˜è¦å‘é€ä¸€æ¬¡ç¡®è®¤å‘¢ï¼Ÿ\n  ä¸ºäº†é˜²æ­¢ å·²å¤±æ•ˆçš„é“¾æ¥è¯·æ±‚æŠ¥æ–‡çªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚\nå®¢æˆ·ç«¯å‘å‡ºçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡å¹¶æœªä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œèŠ‚ç‚¹é•¿æ—¶é—´æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°é“¾æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾Serverã€‚è¿™æ˜¯ï¼ŒServerè¯¯ä»¥ä¸ºè¿™æ˜¯Clientå‘å‡ºçš„ä¸€ä¸ªæ–°çš„é“¾æ¥è¯·æ±‚ï¼Œäºæ˜¯å°±å‘å®¢æˆ·ç«¯å‘é€ç¡®è®¤æ•°æ®åŒ…ï¼ŒåŒæ„å»ºç«‹é“¾æ¥ã€‚è‹¥ä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦Serverå‘å‡ºç¡®è®¤æ•°æ®åŒ…ï¼Œæ–°çš„é“¾æ¥å°±å»ºç«‹äº†ã€‚ç”±äºclientæ­¤æ—¶å¹¶æœªå‘å‡ºå»ºç«‹é“¾æ¥çš„è¯·æ±‚ï¼Œæ‰€ä»¥å…¶ä¸ä¼šç†ç¬Serverçš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¸Serveré€šä¿¡ï¼›è€Œè¿™æ—¶Serverä¸€ç›´åœ¨ç­‰å¾…Clientçš„è¯·æ±‚ï¼Œè¿™æ ·Serverå°±ç™½ç™½æµªè´¹äº†ä¸€å®šçš„èµ„æºã€‚è‹¥é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºServerç«¯æ²¡æœ‰æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„ç¡®è®¤ï¼Œåˆ™å°±ä¼šçŸ¥é“Clientå¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¯·æ±‚ï¼Œå°±ä¸ä¼šå»ºç«‹é“¾æ¥ã€‚\nå¦‚æœé‡‡ç”¨çš„æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå°±ç®—æ˜¯é‚£ä¸€æ¬¡å¤±æ•ˆçš„æŠ¥æ–‡ä¼ é€è¿‡æ¥äº†ï¼ŒæœåŠ¡ç«¯æ¥å—åˆ°äº†é‚£æ¡å¤±æ•ˆæŠ¥æ–‡å¹¶ä¸”å›å¤äº†ç¡®è®¤æŠ¥æ–‡ï¼Œä½†æ˜¯å®¢æˆ·ç«¯ä¸ä¼šå†æ¬¡å‘å‡ºç¡®è®¤ã€‚ç”±äºæœåŠ¡å™¨æ”¶ä¸åˆ°ç¡®è®¤ï¼Œå°±çŸ¥é“å®¢æˆ·ç«¯å¹¶æ²¡æœ‰è¯·æ±‚è¿æ¥ã€‚\n  å› ä¸ºåŒæ–¹éƒ½éœ€è¦ç¡®è®¤å¯¹æ–¹æ”¶åˆ°äº†è‡ªå·±å‘é€çš„åºåˆ—å·ï¼Œç¡®è®¤è¿‡ç¨‹æœ€å°‘è¦è¿›è¡Œä¸‰æ¬¡é€šä¿¡ã€‚\nå‚è€ƒï¼šçŸ¥ä¹ . TCP ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œä¸æ˜¯ä¸¤æ¬¡æˆ–å››æ¬¡ï¼Ÿ\n  å› ä¸ºä¿¡é“ä¸å¯é ï¼Œè€Œ TCP æƒ³åœ¨ä¸å¯é ä¿¡é“ä¸Šå»ºç«‹å¯é åœ°ä¼ è¾“ï¼Œé‚£ä¹ˆä¸‰æ¬¡é€šä¿¡æ˜¯ç†è®ºä¸Šçš„æœ€å°å€¼ã€‚ï¼ˆè€Œ UDP åˆ™ä¸éœ€å»ºç«‹å¯é ä¼ è¾“ï¼Œå› æ­¤ UDPä¸éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ã€‚ï¼‰\nå‚è€ƒï¼šGoogle Groups . TCP å»ºç«‹è¿æ¥ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ{æŠ€æœ¯}{ç½‘ç»œé€šä¿¡}\n   TCPä¼ äº† SYN,ä¸ºå•¥è¿˜è¦ä¼  ACKï¼Ÿ\nåŒæ–¹é€šä¿¡æ— è¯¯å¿…é¡»æ˜¯ä¸¤è€…äº’ç›¸å‘é€ä¿¡æ¯éƒ½æ— è¯¯ã€‚ä¼ äº† SYNï¼Œè¯æ˜å‘é€æ–¹åˆ°æ¥æ”¶æ–¹çš„é€šé“æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æ¥æ”¶æ–¹åˆ°å‘é€æ–¹çš„é€šé“è¿˜éœ€è¦ ACK ä¿¡å·æ¥è¿›è¡ŒéªŒè¯ã€‚\n âœ‹ ä¸ºä»€ä¹ˆæ˜¯å››æ¬¡æŒ¥æ‰‹ï¼Ÿ   è¿™ä¸ªæ˜¯ä¸€ä¸ªå…¨åŒå·¥çš„è¿æ¥ï¼Œä¸¤è¾¹éƒ½éœ€è¦æ–­å¼€ï¼Œæ¯æ¬¡çš„æ–­å¼€éƒ½éœ€è¦ä¸¤æ¬¡çš„æ¡æ‰‹ã€‚\nå»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œ æœåŠ¡å™¨åœ¨LISTENçŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°å»ºç«‹è¿æ¥è¯·æ±‚çš„SYNæŠ¥æ–‡åï¼ŒæŠŠACKå’ŒSYNæ”¾åœ¨ä¸€ä¸ªæŠ¥æ–‡é‡Œå‘é€ç»™å®¢æˆ·ç«¯ã€‚\nè€Œå…³é—­è¿æ¥æ—¶ï¼ŒæœåŠ¡å™¨æ”¶åˆ°å¯¹æ–¹çš„FINæŠ¥æ–‡æ—¶ï¼Œä»…ä»…è¡¨ç¤ºå¯¹æ–¹ä¸å†å‘é€æ•°æ®äº†ä½†æ˜¯è¿˜èƒ½æ¥æ”¶æ•°æ®ï¼Œè€Œè‡ªå·±ä¹Ÿæœªå¿…å…¨éƒ¨æ•°æ®éƒ½å‘é€ç»™å¯¹æ–¹äº†ï¼Œæ‰€ä»¥å·±æ–¹å¯ä»¥ç«‹å³å…³é—­ï¼Œä¹Ÿå¯ä»¥å‘é€ä¸€äº›æ•°æ®ç»™å¯¹æ–¹åï¼Œå†å‘é€FINæŠ¥æ–‡ç»™å¯¹æ–¹æ¥è¡¨ç¤ºåŒæ„ç°åœ¨å…³é—­è¿æ¥ï¼Œå› æ­¤ï¼Œå·±æ–¹ACKå’ŒFINä¸€èˆ¬éƒ½ä¼šåˆ†å¼€å‘é€ï¼Œä»è€Œå¯¼è‡´å¤šäº†ä¸€æ¬¡ã€‚å³å¦ä¸€æ–¹å¹¶ä¸éœ€è¦ä¹Ÿæ€¥ç€æ–­å¼€ï¼Œè¿˜å¯ä»¥ç»§ç»­å‘é€æ¶ˆæ¯ã€‚\n  æœåŠ¡å™¨å¯èƒ½è¿˜æœ‰æ•°æ®éœ€è¦ä¼ è¾“ç»™å®¢æˆ·ç«¯\nå› ä¸ºå®¢æˆ·ç«¯è¯·æ±‚é‡Šæ”¾æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½è¿˜æœ‰æ•°æ®éœ€è¦ä¼ è¾“ç»™å®¢æˆ·ç«¯ï¼Œå› æ­¤æœåŠ¡ç«¯è¦å…ˆå“åº”å®¢æˆ·ç«¯ FIN è¯·æ±‚ï¼ˆæœåŠ¡ç«¯å‘é€ ACKï¼‰ï¼Œç„¶åæ•°æ®ä¼ è¾“ï¼Œä¼ è¾“å®Œæˆåï¼ŒæœåŠ¡ç«¯å†æå‡º FIN è¯·æ±‚ï¼ˆæœåŠ¡ç«¯å‘é€ FINï¼‰ï¼›è€Œè¿æ¥æ—¶åˆ™æ²¡æœ‰ä¸­é—´çš„æ•°æ®ä¼ è¾“ï¼Œå› æ­¤è¿æ¥æ—¶å¯ä»¥ ACK å’Œ SYN ä¸€èµ·å‘é€ã€‚\n  ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯æœ€åè¿˜è¦ç­‰å¾…2MSLï¼Ÿ\nMSLï¼ˆMaximum Segment Lifetimeï¼‰ï¼ŒTCPå…è®¸ä¸åŒçš„å®ç°å¯ä»¥è®¾ç½®ä¸åŒçš„MSLå€¼ã€‚\nç¬¬ä¸€ï¼Œä¿è¯å®¢æˆ·ç«¯å‘é€çš„æœ€åä¸€ä¸ªACKæŠ¥æ–‡èƒ½å¤Ÿåˆ°è¾¾æœåŠ¡å™¨ï¼Œå› ä¸ºè¿™ä¸ªACKæŠ¥æ–‡å¯èƒ½ä¸¢å¤±ï¼Œç«™åœ¨æœåŠ¡å™¨çš„è§’åº¦çœ‹æ¥ï¼Œæˆ‘å·²ç»å‘é€äº†FIN+ACKæŠ¥æ–‡è¯·æ±‚æ–­å¼€äº†ï¼Œå®¢æˆ·ç«¯è¿˜æ²¡æœ‰ç»™æˆ‘å›åº”ï¼Œåº”è¯¥æ˜¯æˆ‘å‘é€çš„è¯·æ±‚æ–­å¼€æŠ¥æ–‡å®ƒæ²¡æœ‰æ”¶åˆ°ï¼Œäºæ˜¯æœåŠ¡å™¨åˆä¼šé‡æ–°å‘é€ä¸€æ¬¡ï¼Œè€Œå®¢æˆ·ç«¯å°±èƒ½åœ¨è¿™ä¸ª2MSLæ—¶é—´æ®µå†…æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„æŠ¥æ–‡ï¼Œæ¥ç€ç»™å‡ºå›åº”æŠ¥æ–‡ï¼Œå¹¶ä¸”ä¼šé‡å¯2MSLè®¡æ—¶å™¨ã€‚\nç¬¬äºŒï¼Œé˜²æ­¢ç±»ä¼¼ä¸â€œä¸‰æ¬¡æ¡æ‰‹â€ä¸­æåˆ°äº†çš„â€œå·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€å‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚å®¢æˆ·ç«¯å‘é€å®Œæœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡åï¼Œåœ¨è¿™ä¸ª2MSLæ—¶é—´ä¸­ï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·æ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°æ—§è¿æ¥çš„è¯·æ±‚æŠ¥æ–‡ã€‚\nå‚è€ƒï¼š\n ä¸¤å¼ åŠ¨å›¾-å½»åº•æ˜ç™½TCPçš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹  ğŸ‘ å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ TCPè¿˜è®¾æœ‰ä¸€ä¸ªä¿æ´»è®¡æ—¶å™¨ï¼Œæ˜¾ç„¶ï¼Œå®¢æˆ·ç«¯å¦‚æœå‡ºç°æ•…éšœï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¸€ç›´ç­‰ä¸‹å»ï¼Œç™½ç™½æµªè´¹èµ„æºã€‚æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·ç«¯çš„è¯·æ±‚åéƒ½ä¼šé‡æ–°å¤ä½è¿™ä¸ªè®¡æ—¶å™¨ï¼Œæ—¶é—´é€šå¸¸æ˜¯è®¾ç½®ä¸º2å°æ—¶ï¼Œè‹¥ä¸¤å°æ—¶è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ä»»ä½•æ•°æ®ï¼ŒæœåŠ¡å™¨å°±ä¼šå‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µï¼Œä»¥åæ¯éš”75ç§’å‘é€ä¸€æ¬¡ã€‚è‹¥ä¸€è¿å‘é€10ä¸ªæ¢æµ‹æŠ¥æ–‡ä»ç„¶æ²¡ååº”ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºäº†æ•…éšœï¼Œæ¥ç€å°±å…³é—­è¿æ¥ã€‚\nğŸ“‰ â€‹GET å’Œ POSTçš„åŒºåˆ«  GETç”¨æ¥è·å–æ•°æ®ï¼ŒPOSTç”¨æ¥æäº¤æ•°æ® GETè¯·æ±‚é€šè¿‡URLï¼ˆè¯·æ±‚è¡Œï¼‰æäº¤æ•°æ®ï¼Œåœ¨URLä¸­å¯ä»¥çœ‹åˆ°æ‰€ä¼ å‚æ•°ã€‚POSTé€šè¿‡â€œè¯·æ±‚ä½“â€ä¼ é€’æ•°æ®ï¼Œå‚æ•°ä¸ä¼šåœ¨urlä¸­æ˜¾ç¤º GETè¯·æ±‚æäº¤çš„æ•°æ®æœ‰é•¿åº¦é™åˆ¶ï¼ŒPOSTè¯·æ±‚æ²¡æœ‰é™åˆ¶ã€‚ GETè¯·æ±‚è¿”å›çš„å†…å®¹å¯ä»¥è¢«æµè§ˆå™¨ç¼“å­˜èµ·æ¥ã€‚è€Œæ¯æ¬¡æäº¤çš„POSTï¼Œæµè§ˆå™¨åœ¨ä½ æŒ‰ä¸‹F5çš„æ—¶å€™ä¼šè·³å‡ºç¡®è®¤æ¡†ï¼Œæµè§ˆå™¨ä¸ä¼šç¼“å­˜POSTè¯·æ±‚è¿”å›çš„å†…å®¹ã€‚ GETå¯¹æ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼ŒPOSTä¸»è¦å¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹ï¼ç®€å•è¯´ï¼ŒGETæ˜¯åªè¯»ï¼ŒPOSTæ˜¯å†™ã€‚ get è¯·æ±‚çš„urlæ˜¯åœ¨æœåŠ¡å™¨ä¸Šæœ‰æ—¥å¿—è®°å½•ï¼Œåœ¨æµè§ˆå™¨ä¹Ÿèƒ½æŸ¥åˆ°å†å²è®°å½•ï¼Œä½†æ˜¯postè¯·æ±‚çš„å‚æ•°éƒ½åœ¨bodyé‡Œé¢ï¼Œæµè§ˆå™¨å†å²è®°å½•ä¸åˆ°   å¦‚æœæ˜¯æŒ‡ç½‘ç»œå®‰å…¨ï¼Œé‚£ä¸¤è€…ä¸€æ ·ã€‚\nå¦‚æœè€ƒè™‘åˆ°æŸäº›æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„é»˜è®¤é…ç½®å’Œé»˜è®¤ä½¿ç”¨æ–¹å¼ï¼Œé‚£ä¹ˆPOSTåœ¨å¾ˆå¤šæ—¶å€™æ¯”GETå®‰å…¨ã€‚\nè€Œåœ¨HTTPçš„å®šä¹‰ä¸­ï¼ŒGETè¢«ç§°ä¸ºå®‰å…¨æ–¹æ³•ï¼ŒPOSTå´ä¸æ˜¯.\n æ„Ÿè§‰å¯¹äºæœåŠ¡å™¨æ›´å®‰å…¨çš„æ˜¯Getï¼Œå¯¹äºå®¢æˆ·ç«¯æ›´å®‰å…¨çš„æ˜¯Postã€‚\næœ¬è´¨ä¸Šï¼š\né¦–å…ˆgetå’Œpoståœ¨æœ¬è´¨ä¸Šéƒ½æ˜¯tcpé“¾æ¥ï¼Œä½†ç”±äºhttpåè®®å’Œæµè§ˆå™¨æˆ–è€…æœåŠ¡å™¨çš„é™åˆ¶ï¼Œä»è€Œä½¿å®ƒä»¬åœ¨åº”ç”¨è¿‡ç¨‹ä¸­äº§ç”Ÿäº†å·®åˆ«ï¼Œä½†æ˜¯å®ƒä»¬ä¸­è¿˜æœ‰ä¸€ä¸ªè¾ƒå¤§çš„åŒºåˆ«ï¼šgetåœ¨è¯·æ±‚æ—¶å‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œä¼šå°†headerå’Œdataä¸€èµ·å‘é€è¿‡å»ï¼Œè€Œpostä¼šäº§ç”Ÿä¸¤ä¸ªæ•°æ®åŒ…å…ˆå‘é€headerï¼ŒæœåŠ¡å™¨è¿”å›100ï¼Œç„¶ååœ¨å‘é€dataï¼ŒæœåŠ¡å™¨è¿”å›200\n æ‰€ä»¥å½“ä½ ä¸€å±‚ä¸€å±‚çš„æŠŠgetå’Œpostå‰–æåˆ°åº•ï¼Œä½ ä¼šå‘ç°ä»–ä»¬çš„æœ¬è´¨å°±æ˜¯tcpè¿æ¥ï¼Œæ²¡æœ‰å•¥åŒºåˆ«ï¼Œåªæ˜¯ç”±äºhttpåè®®è§„å®šå’Œæµè§ˆå™¨æˆ–è€…æœåŠ¡å™¨çš„é™åˆ¶ï¼Œå¯¼è‡´ä»–ä»¬åœ¨åº”ç”¨è¿‡ç¨‹ä¸­ä½“ç°å½¢å¼ä¸åŒã€‚\n RFCï¼š\n1.safeï¼ˆå®‰å…¨ï¼‰\n è¿™é‡Œçš„å®‰å…¨å’Œé€šå¸¸æ‰€ç†è§£çš„å®‰å…¨æ„ä¹‰ä¸åŒï¼Œå°±å¥½æ¯”å¦‚æœä¸€ä¸ªè¯·æ±‚çš„è¯­ä¹‰æœ¬è´¨ä¸Šå°±æ˜¯è·å–æ•°æ®ï¼ˆåªè¯»ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯·æ±‚å°±æ˜¯å®‰å…¨çš„ã€‚å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·çš„è¯·æ±‚å¦‚æœæ²¡æœ‰å¼•èµ·æœåŠ¡å™¨ç«¯ä»»ä½•çš„çŠ¶æ€å˜åŒ–ï¼Œé‚£ä¹ˆä»–å°±æ˜¯å®‰å…¨çš„è€Œpostè¯·æ±‚æ¥æäº¤æ•°æ®å¿…ç„¶ä¼šæ˜¯æœåŠ¡å™¨å‘ç”Ÿç›¸åº”çš„å˜åŒ–ã€‚ä»è¿™ä¸ªç»´åº¦æ¥çœ‹ï¼Œgetè¯·æ±‚ç›¸å¯¹æœåŠ¡å™¨è€Œè¨€ï¼Œæ˜¯å®‰å…¨çš„ï¼Œpoståˆ™ä¸å®‰å…¨çš„ã€‚\n ldempotendï¼ˆå¹‚ç­‰ï¼‰\n **å¹‚ç­‰é€šä¿—çš„æ¥è®²å°±æ˜¯æŒ‡åŒä¸€ä¸ªè¯·æ±‚æ‰§è¡Œå¤šæ¬¡å’Œä»…æ‰§è¡Œä¸€æ¬¡çš„æ•ˆæœå®Œå…¨ç›¸ç­‰ã€‚**è¿™é‡Œæ¥æ‰¯å‡ºå¹‚ç­‰ä¸»è¦æ˜¯ä¸ºäº†å¤„ç†åŒä¸€ä¸ªè¯·æ±‚é‡å¤å‘é€çš„æƒ…å†µï¼Œå‡å¦‚åœ¨è¯·æ±‚å“åº”ä¹‹å‰å¤±å»è¿æ¥ï¼Œå¦‚æœè¿™ä¸ªè¯·æ±‚æ—¶å¹‚ç­‰çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ”¾å¿ƒçš„é‡å‘ä¸€æ¬¡è¯·æ±‚ã€‚æ‰€ä»¥å¯ä»¥å¾—å‡ºgetè¯·æ±‚æ—¶å¹‚ç­‰çš„ï¼Œå¯ä»¥é‡å¤å‘é€è¯·æ±‚ï¼Œpostè¯·æ±‚æ—¶ä¸å¹‚ç­‰çš„ï¼Œé‡å¤è¯·æ±‚å¯èƒ½ä¼šå‘ç”Ÿæ— æ³•é¢„çŸ¥çš„åæœã€‚\n cacheableï¼ˆå¯ç¼“å­˜æ€§ï¼‰\n é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸€ä¸ªè¯·æ±‚æ˜¯å¦å¯ä»¥è¢«ç¼“å­˜ï¼Œç»å¤§å¤šæ•°éƒ¨åˆ†ï¼Œpostéƒ½æ˜¯ä¸å¯ç¼“å­˜çš„ï¼ˆæŸäº›æµè§ˆå™¨å¯èƒ½æ”¯æŒpostç¼“å­˜ï¼‰ï¼Œä½†getæ˜¯å¯ä»¥ç¼“å­˜çš„ã€‚\n å‹‰å¼ºç†è§£ä¸€ä¸‹å¤§æ¦‚å°±æ˜¯ï¼š\n getæ˜¯è¯·æ±‚è·å–æŒ‡å®šèµ„æºï¼Œgetæ–¹æ³•æ—¶å®‰å…¨ã€å¹‚ç­‰ã€å¯ç¼“å­˜çš„ï¼Œgetæ–¹æ³•çš„æŠ¥æ–‡ä¸»ä½“æ²¡æœ‰ä»»ä½•è¯­ä¹‰ã€‚\n  postæ˜¯æ ¹æ®æŠ¥æ–‡ä¸»ä½“æ¥å¯¹æŒ‡å®šèµ„æºåšå‡ºå¤„ç†ï¼Œpostä¸å®‰å…¨ï¼Œä¸å¹‚ç­‰ï¼Œä¸å¯ç¼“å­˜ï¼ˆå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼‰ã€‚\n å‚è€ƒï¼š\n éƒ½ 2019 å¹´äº†ï¼Œè¿˜é—® GET å’Œ POST çš„åŒºåˆ« POST æ–¹æ³•æ¯” GET æ–¹æ³•æ›´å®‰å…¨å—? ä¸ºä»€ä¹ˆ? getå’Œpostçš„åŒºåˆ«ï¼Ÿ  ğŸ‚ HTTPæŠ¥æ–‡ è¯·æ±‚æŠ¥æ–‡ HTTP è¯·æ±‚æŠ¥æ–‡ç”±3éƒ¨åˆ†ç»„æˆ(è¯·æ±‚è¡Œ+è¯·æ±‚å¤´+è¯·æ±‚ä½“)\nè¯·æ±‚è¡ŒåŒ…æ‹¬ï¼šè¯·æ±‚æ–¹æ³•ã€è¯·æ±‚URLã€HTTPåè®®åŠç‰ˆæœ¬ï¼š\nGETå’ŒPOSTæ˜¯æœ€å¸¸è§çš„HTTPæ–¹æ³•,åˆæ¬¡ä»¥å¤–è¿˜åŒ…æ‹¬ DELETEã€HEADã€OPTIONSã€PUTã€TRACEï¼Œä¸è¿‡ç°åœ¨å¤§éƒ¨åˆ†çš„æµè§ˆå™¨åªæ”¯æŒGETå’ŒPOST\nè¯·æ±‚å¯¹åº”çš„URLåœ°å€,ä»–å’ŒæŠ¥æ–‡å¤´çš„Hostå±æ€§,ç»„åˆèµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚URL\næŠ¥æ–‡å¤´æ˜¯ä¸€äº›å‚æ•°ä¿¡æ¯ï¼š\næœ‰è‹¥å¹²ä¸ªå±æ€§,å½¢å¼ä¸ºkey:val,æœåŠ¡ç«¯æ®æ­¤è·å–å®¢æˆ·ç«¯ä¿¡æ¯\næŠ¥æ–‡ä½“æ˜¯å…·ä½“ä¼ è¾“çš„å†…å®¹ã€‚\nå“åº”æŠ¥æ–‡ å“åº”æŠ¥æ–‡ä¸è¯·æ±‚æŠ¥æ–‡ä¸€æ ·,ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ(å“åº”è¡Œ,å“åº”å¤´,å“åº”ä½“)\nå‚è€ƒï¼šHTTPè¯·æ±‚å¤´å’Œå“åº”å¤´è¯¦è§£\nğŸš‰ HTTPçŠ¶æ€ç ï¼š  1xxï¼šè¡¨ç¤ºé€šçŸ¥ä¿¡æ¯ï¼Œå¦‚è¯·æ±‚æ”¶åˆ°äº†æˆ–æ­£åœ¨è¿›è¡Œå¤„ç†  100 Continueï¼šç»§ç»­ï¼Œå®¢æˆ·ç«¯åº”ç»§ç»­å…¶è¯·æ±‚ 101 Switching Protocols åˆ‡æ¢åè®®ã€‚æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ‡æ¢åè®®ã€‚åªèƒ½åˆ‡æ¢åˆ°æ›´é«˜çº§çš„åè®®ï¼Œä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ° HTTP çš„æ–°ç‰ˆæœ¬åè®®   2xxï¼šè¡¨ç¤ºæˆåŠŸï¼Œå¦‚æ¥æ”¶æˆ–çŸ¥é“äº†  200 OK: è¯·æ±‚æˆåŠŸ   3xxï¼šè¡¨ç¤ºé‡å®šå‘ï¼Œå¦‚è¦å®Œæˆè¯·æ±‚è¿˜å¿…é¡»é‡‡å–è¿›ä¸€æ­¥çš„è¡ŒåŠ¨  301 Moved Permanently: æ°¸ä¹…ç§»åŠ¨ã€‚è¯·æ±‚çš„èµ„æºå·²è¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°æ–° URLï¼Œè¿”å›ä¿¡æ¯ä¼šåŒ…æ‹¬æ–°çš„ URLï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®šå‘åˆ°æ–° URLã€‚ä»Šåä»»ä½•æ–°çš„è¯·æ±‚éƒ½åº”ä½¿ç”¨æ–°çš„ URL ä»£æ›¿   4xxï¼šè¡¨ç¤ºå®¢æˆ·çš„å·®é”™ï¼Œå¦‚è¯·æ±‚ä¸­æœ‰é”™è¯¯çš„è¯­æ³•æˆ–ä¸èƒ½å®Œæˆ  400 Bad Request: å®¢æˆ·ç«¯è¯·æ±‚çš„è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£ 401 Unauthorized: è¯·æ±‚è¦æ±‚ç”¨æˆ·çš„èº«ä»½è®¤è¯ 403 Forbidden: æœåŠ¡å™¨ç†è§£è¯·æ±‚å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œæ­¤è¯·æ±‚ï¼ˆæƒé™ä¸å¤Ÿï¼‰ 404 Not Found: æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚é€šè¿‡æ­¤ä»£ç ï¼Œç½‘ç«™è®¾è®¡äººå‘˜å¯è®¾ç½® â€œæ‚¨æ‰€è¯·æ±‚çš„èµ„æºæ— æ³•æ‰¾åˆ°â€ çš„ä¸ªæ€§é¡µé¢ 408 Request Timeout: æœåŠ¡å™¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ—¶é—´è¿‡é•¿ï¼Œè¶…æ—¶   5xxï¼šè¡¨ç¤ºæœåŠ¡å™¨çš„å·®é”™ï¼Œå¦‚æœåŠ¡å™¨å¤±æ•ˆæ— æ³•å®Œæˆè¯·æ±‚  500 Internal Server Error: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ 503 Service Unavailable: ç”±äºè¶…è½½æˆ–ç³»ç»Ÿç»´æŠ¤ï¼ŒæœåŠ¡å™¨æš‚æ—¶çš„æ— æ³•å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å»¶æ—¶çš„é•¿åº¦å¯åŒ…å«åœ¨æœåŠ¡å™¨çš„ Retry-After å¤´ä¿¡æ¯ä¸­ 504 Gateway Timeout: å……å½“ç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼ŒæœªåŠæ—¶ä»è¿œç«¯æœåŠ¡å™¨è·å–è¯·æ±‚    âœ‹ HTTPçš„ä¸»è¦æ–¹æ³•    æ–¹æ³• æ„ä¹‰     OPTIONS è¯·æ±‚ä¸€äº›é€‰é¡¹ä¿¡æ¯ï¼Œå…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½   GET è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“   HEAD ç±»ä¼¼äº get è¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´   POST å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POSTè¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹   PUT ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹   DELETE è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢   TRACE å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­      ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯æŸ¥è¯¢HTTPæœåŠ¡å™¨ç«¯æ”¯æŒçš„HTTPæ–¹æ³•ç§ç±»ã€‚\n  ğŸ’« HTTP2.0ä¸HTTP1.0çš„åŒºåˆ« ğŸ“¥ ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ SQLæ³¨å…¥å°±æ˜¯é€šè¿‡æŠŠSQLå‘½ä»¤æ’å…¥åˆ°Webè¡¨å•æäº¤æˆ–è¾“å…¥åŸŸåæˆ–é¡µé¢è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆè¾¾åˆ°æ¬ºéª—æœåŠ¡å™¨æ‰§è¡Œæ¶æ„çš„SQLå‘½ä»¤ã€‚\nSQLæ³¨å…¥çš„æ€è·¯ï¼š\n SQLæ³¨å…¥çš„ä½ç½® åˆ¤æ–­æœåŠ¡å™¨ç±»å‹å’Œåå°æ•°æ®ç±»å‹ é’ˆå¯¹ä¸é€šçš„æœåŠ¡å™¨å’Œæ•°æ®åº“ç‰¹ç‚¹è¿›è¡ŒSQLæ³¨å…¥æ”»å‡»  åº”å¯¹çš„æ–¹æ³•ï¼š\n å‚æ•°ç»‘å®šä½¿ç”¨é¢„ç¼–è¯‘æ‰‹æ®µï¼Œç»‘å®šå‚æ•°æ˜¯æœ€å¥½çš„é˜²SQLæ³¨å…¥çš„æ–¹æ³•ã€‚ç›®å‰è®¸å¤šçš„ORMæ¡†æ¶åŠJDBCç­‰éƒ½å®ç°äº†SQLé¢„ç¼–è¯‘å’Œå‚æ•°ç»‘å®šåŠŸèƒ½ï¼Œæ”»å‡»è€…çš„æ¶æ„SQLä¼šè¢«å½“åšSQLçš„å‚æ•°è€Œä¸æ˜¯SQLå‘½ä»¤è¢«æ‰§è¡Œã€‚åœ¨mybatisçš„mapperæ–‡ä»¶ä¸­ï¼Œå¯¹äºä¼ é€’çš„å‚æ•°æˆ‘ä»¬ä¸€èˆ¬æ˜¯ä½¿ç”¨#å’Œ$æ¥è·å–å‚æ•°å€¼ã€‚å½“ä½¿ç”¨#æ—¶ï¼Œå˜é‡æ˜¯å ä½ç¬¦ï¼Œå°±æ˜¯ä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨javajdbcçš„PrepareStatementæ—¶çš„å ä½ç¬¦ï¼Œæ‰€æœ‰å¯ä»¥é˜²æ­¢sqlæ³¨å…¥ï¼›å½“ä½¿ç”¨â€‹$æ—¶ï¼Œå˜é‡å°±æ˜¯ç›´æ¥è¿½åŠ åœ¨sqlä¸­ï¼Œä¸€èˆ¬ä¼šæœ‰sqlæ³¨å…¥é—®é¢˜ã€‚ ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ä¼ å…¥çš„å‚æ•°  ğŸª CookieæŠ€æœ¯ Cookie é€šè¿‡åœ¨è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å†™å…¥ Cookie ä¿¡æ¯æ¥æ§åˆ¶å®¢æˆ·ç«¯çš„çŠ¶æ€ã€‚\nç›¸å½“äºï¼Œåœ¨å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¼šä¸‹å‘ä¸€ä¸ªè£…æœ‰å®¢æˆ·ä¿¡æ¯çš„ã€Œå°è´´çº¸ã€ï¼Œåç»­å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ï¼Œå¸¦ä¸Šã€Œå°è´´çº¸ã€ï¼ŒæœåŠ¡å™¨å°±èƒ½è®¤å¾—äº†äº†ã€‚\n  æ²¡æœ‰Cookieä¿¡æ¯çŠ¶æ€ä¸‹çš„è¯·æ±‚\n  ç¬¬2æ¬¡ä»¥åï¼ˆå­˜æœ‰Cookieä¿¡æ¯çŠ¶æ€ï¼‰çš„è¯·æ±‚\n  åº•å±‚åŸç†\n  WEBæœåŠ¡å™¨é€šè¿‡åœ¨HTTPå“åº”æ¶ˆæ¯ä¸­å¢åŠ Set-Cookieå“åº”å¤´å­—æ®µå°†Cookieä¿¡æ¯å‘é€ç»™æµè§ˆå™¨ï¼Œ\n  æµè§ˆå™¨åˆ™é€šè¿‡åœ¨HTTPè¯·æ±‚æ¶ˆæ¯ä¸­å¢åŠ Cookieè¯·æ±‚å¤´å­—æ®µå°†Cookieå›ä¼ ç»™WEBæœåŠ¡å™¨ã€‚\n  Cookieçš„ä¼ é€è¿‡ç¨‹ç¤ºæ„å›¾\nCookieçš„ç¼ºé™·\n(1) cookieä¼šè¢«é™„åŠ åœ¨æ¯ä¸ªHTTPè¯·æ±‚ä¸­ï¼Œæ‰€ä»¥æ— å½¢ä¸­å¢åŠ äº†æµé‡ã€‚\n(2) ç”±äºåœ¨HTTPè¯·æ±‚ä¸­çš„cookieæ˜¯æ˜æ–‡ä¼ é€’çš„ï¼Œæ‰€ä»¥å®‰å…¨æ€§æˆé—®é¢˜ã€‚ï¼ˆé™¤éç”¨HTTPS)\n(3) Cookieçš„å¤§å°é™åˆ¶åœ¨4KBå·¦å³ã€‚å¯¹äºå¤æ‚çš„å­˜å‚¨éœ€æ±‚æ¥è¯´æ˜¯ä¸å¤Ÿç”¨çš„ã€‚\nå‚è€ƒï¼š\n ä¼šè¯æŠ€æœ¯â€”â€”Cookieså’ŒSessionè¯¦è§£  ğŸ’¬ SessionæŠ€æœ¯ ä»€ä¹ˆæ˜¯ä¼šè¯ï¼Ÿ\nä¼šè¯æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„å¤šæ¬¡è¯·æ±‚å’Œå“åº”ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨å¼€å§‹ï¼Œåˆ°è®¿é—®æœåŠ¡å™¨ç»“æŸï¼Œæµè§ˆå™¨å…³é—­ä¸ºæ­¢çš„è¿™æ®µæ—¶é—´å†…å®¹äº§ç”Ÿçš„å¤šæ¬¡è¯·æ±‚å’Œå“åº”ï¼Œåˆèµ·æ¥å«åšæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ä¸€æ¬¡ä¼šè¯ã€‚\nä¸ºä»€ä¹ˆä½¿ç”¨ä¼šè¯æŠ€æœ¯ï¼Ÿ\nå®é™…ä¸Šä¼šè¯é—®é¢˜è§£å†³çš„è¿˜æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡é—®é¢˜ï¼Œé€šè¿‡ä¸€äº›ä¼šè¯æŠ€æœ¯ï¼Œå¯ä»¥å°†æ¯ä¸ªç”¨æˆ·çš„æ•°æ®ä»¥ä¾‹å¦‚cookie/sessionçš„å½¢å¼å­˜å‚¨ï¼Œæ–¹ä¾¿ä»¥åç”¨æˆ·è®¿é—®webèµ„æºçš„æ—¶å€™ä½¿ç”¨\n å‡å®šåœºæ™¯ï¼šAå’ŒBä¸¤äººåœ¨æŸä¸ªç½‘ä¸Šè´­ç‰©å•†åœºç™»é™†è´¦å·åï¼ŒAä¹°äº†ä¸€ä¸ªHHKBçš„é”®ç›˜ï¼Œè€ŒBåˆ™è´­ä¹°äº†ä¸€æŠŠæ°‘è°£å‰ä»–ï¼Œè¿™äº›ä¿¡æ¯éƒ½ä¼šè¢«ä¿å­˜ä¸‹æ¥\nç”¨é€”æ˜¯ï¼šä¿å­˜è´¦æˆ·ä¿¡æ¯ï¼Œç™»å½•æ—¶è¯¢é—®æ—¥åæ˜¯å¦è‡ªåŠ¨ç™»å½•ï¼Œæˆ–è€…æ ¹æ®ä¹‹å‰æµè§ˆï¼Œè´­ä¹°è¿‡çš„å•†å“ï¼Œåˆ†æç”¨æˆ·å–œæ¬¢ä»€ä¹ˆç±»å‹çš„å•†å“ï¼Œåšå‡ºç²¾å‡†æ¨é€\n æœåŠ¡å™¨ä½¿ç”¨sessionæŠŠç”¨æˆ·çš„ä¿¡æ¯ä¸´æ—¶ä¿å­˜åœ¨äº†æœåŠ¡å™¨ä¸Šï¼Œç”¨æˆ·ç¦»å¼€ç½‘ç«™åsessionä¼šè¢«é”€æ¯ã€‚è¿™ç§ç”¨æˆ·ä¿¡æ¯å­˜å‚¨æ–¹å¼ç›¸å¯¹cookieæ¥è¯´æ›´å®‰å…¨ï¼Œå¯æ˜¯sessionæœ‰ä¸€ä¸ªç¼ºé™·ï¼šå¦‚æœwebæœåŠ¡å™¨åšäº†è´Ÿè½½å‡è¡¡ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæ“ä½œè¯·æ±‚åˆ°äº†å¦ä¸€å°æœåŠ¡å™¨çš„æ—¶å€™sessionä¼šä¸¢å¤±ã€‚\nå‚è€ƒï¼š\n ä¼šè¯æŠ€æœ¯â€”â€”Cookieså’ŒSessionè¯¦è§£ å½»åº•ç†è§£cookieï¼Œsessionï¼Œtoken è®¤è¯†HTTP\u0026mdash;-Cookieå’ŒSessionç¯‡  ğŸ“¸ Sessionå’ŒCookieçš„åŒºåˆ« ä»å­˜å‚¨æ–¹å¼ä¸Šæ¯”è¾ƒ\nCookieåªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ï¼Œå¦‚æœè¦å­˜å‚¨éASCIIå­—ç¬¦ä¸²è¿˜è¦å¯¹å…¶ç¼–ç ã€‚\nSessionå¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œå¯ä»¥æŠŠSessionçœ‹æˆæ˜¯ä¸€ä¸ªå®¹å™¨\nä»éšç§å®‰å…¨ä¸Šæ¯”è¾ƒ\nCookieå­˜å‚¨åœ¨æµè§ˆå™¨ä¸­ï¼Œå¯¹å®¢æˆ·ç«¯æ˜¯å¯è§çš„ã€‚ä¿¡æ¯å®¹æ˜“æ³„éœ²å‡ºå»ã€‚å¦‚æœä½¿ç”¨Cookieï¼Œæœ€å¥½å°†CookieåŠ å¯†\nSessionå­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¯¹å®¢æˆ·ç«¯æ˜¯é€æ˜çš„ã€‚ä¸å­˜åœ¨æ•æ„Ÿä¿¡æ¯æ³„éœ²é—®é¢˜ã€‚\nä»æœ‰æ•ˆæœŸä¸Šæ¯”è¾ƒ\nCookieä¿å­˜åœ¨ç¡¬ç›˜ä¸­ï¼Œåªéœ€è¦è®¾ç½®maxAgeå±æ€§ä¸ºæ¯”è¾ƒå¤§çš„æ­£æ•´æ•°ï¼Œå³ä½¿å…³é—­æµè§ˆå™¨ï¼ŒCookieè¿˜æ˜¯å­˜åœ¨çš„\nSessionçš„ä¿å­˜åœ¨æœåŠ¡å™¨ä¸­ï¼Œè®¾ç½®maxInactiveIntervalå±æ€§å€¼æ¥ç¡®å®šSessionçš„æœ‰æ•ˆæœŸã€‚å¹¶ä¸”Sessionä¾èµ–äºåä¸ºJSESSIONIDçš„Cookieï¼Œè¯¥Cookieé»˜è®¤çš„maxAgeå±æ€§ä¸º-1ã€‚å¦‚æœå…³é—­äº†æµè§ˆå™¨ï¼Œè¯¥Sessionè™½ç„¶æ²¡æœ‰ä»æœåŠ¡å™¨ä¸­æ¶ˆäº¡ï¼Œä½†ä¹Ÿå°±å¤±æ•ˆäº†ã€‚\nä»å¯¹æœåŠ¡å™¨çš„è´Ÿæ‹…æ¯”è¾ƒ\nSessionæ˜¯ä¿å­˜åœ¨æœåŠ¡å™¨çš„ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªSessionï¼Œå¦‚æœæ˜¯å¹¶å‘è®¿é—®çš„ç”¨æˆ·éå¸¸å¤šï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨Sessionçš„ï¼ŒSessionä¼šæ¶ˆè€—å¤§é‡çš„å†…å­˜ã€‚\nCookieæ˜¯ä¿å­˜åœ¨å®¢æˆ·ç«¯çš„ã€‚ä¸å ç”¨æœåŠ¡å™¨çš„èµ„æºã€‚åƒbaiduã€Sinaè¿™æ ·çš„å¤§å‹ç½‘ç«™ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨Cookieæ¥è¿›è¡Œä¼šè¯è·Ÿè¸ªã€‚\nä»æµè§ˆå™¨çš„æ”¯æŒä¸Šæ¯”è¾ƒ\nå¦‚æœæµè§ˆå™¨ç¦ç”¨äº†Cookieï¼Œé‚£ä¹ˆCookieæ˜¯æ— ç”¨çš„äº†ï¼\nå¦‚æœæµè§ˆå™¨ç¦ç”¨äº†Cookieï¼ŒSessionå¯ä»¥é€šè¿‡URLåœ°å€é‡å†™æ¥è¿›è¡Œä¼šè¯è·Ÿè¸ªã€‚\nä»è·¨åŸŸåä¸Šæ¯”è¾ƒ\nCookieå¯ä»¥è®¾ç½®domainå±æ€§æ¥å®ç°è·¨åŸŸå\nSessionåªåœ¨å½“å‰çš„åŸŸåå†…æœ‰æ•ˆï¼Œä¸å¯è·¨åŸŸå\nÂ© IPåè®® IPåè®®çš„ä½œç”¨æ˜¯æŠŠå„ç§æ•°æ®åŒ…ä¼ é€ç»™å¯¹æ–¹ã€‚è€Œè¦ä¿è¯ç¡®å®ä¼ é€åˆ°å¯¹æ–¹é‚£é‡Œï¼Œåˆ™éœ€è¦æ»¡è¶³å„ç±»æ¡ä»¶ã€‚å…¶ä¸­ä¸¤ä¸ªé‡è¦çš„æ¡ä»¶æ˜¯IPåœ°å€å’ŒMACåœ°å€ï¼ˆMedia Access Control Addressï¼‰ã€‚IPåœ°å€æŒ‡æ˜äº†èŠ‚ç‚¹è¢«åˆ†é…åˆ°çš„åœ°å€ï¼ŒMACåœ°å€æ˜¯æŒ‡ç½‘å¡æ‰€å±çš„å›ºå®šåœ°å€ã€‚IPåœ°å€å¯ä»¥å’ŒMACåœ°å€è¿›è¡Œé…å¯¹ã€‚IPåœ°å€å¯å˜æ¢ï¼Œä½†MACåœ°å€åŸºæœ¬ä¸Šä¸ä¼šæ›´æ”¹ã€‚\nä»€ä¹ˆæ˜¯MACåœ°å€ï¼Ÿ\nMACåœ°å€ä¹Ÿå«ç‰©ç†åœ°å€ã€ç¡¬ä»¶åœ°å€ï¼Œç”±ç½‘ç»œè®¾å¤‡åˆ¶é€ å•†ç”Ÿäº§æ—¶çƒ§å½•åœ¨ç½‘å¡çš„EPROM(ä¸€ç§é—ªå­˜èŠ¯ç‰‡ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡ç¨‹åºæ“¦å†™)ã€‚IPåœ°å€ä¸MACåœ°å€åœ¨è®¡ç®—æœºé‡Œéƒ½æ˜¯ä»¥äºŒè¿›åˆ¶è¡¨ç¤ºçš„ï¼ŒIPåœ°å€æ˜¯32ä½çš„ï¼Œè€ŒMACåœ°å€åˆ™æ˜¯48ä½çš„ ã€‚\næœ‰äº† IP åœ°å€ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨ MAC åœ°å€ IPåœ°å€å±äºç½‘ç»œå±‚ï¼Œè€ŒMACåœ°å€å±äºæ•°æ®é“¾è·¯å±‚ã€‚ ç½‘ç»œå±‚åè®®ä½¿æ•°æ®å¯ä»¥ä»ä¸€ä¸ªç½‘ç»œä¼ é€’åˆ°å¦ä¸€ä¸ªç½‘ç»œä¸Šï¼ˆARPæ ¹æ®ç›®çš„IPåœ°å€ï¼Œæ‰¾åˆ°ä¸­é—´èŠ‚ç‚¹çš„MACåœ°å€ï¼Œé€šè¿‡ä¸­é—´èŠ‚ç‚¹ä¼ é€ï¼Œä»è€Œæœ€ç»ˆåˆ°è¾¾ç›®çš„ç½‘ç»œï¼‰ï¼›æ•°æ®é“¾è·¯å±‚åè®®å¯ä»¥ä½¿æ•°æ®ä»ä¸€ä¸ªèŠ‚ç‚¹ä¼ é€’åˆ°ç›¸åŒé“¾è·¯çš„å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼ˆé€šè¿‡MACåœ°å€ï¼‰ã€‚\n  MACåœ°å€å¯»å€çš„æ—¶é—´å¤æ‚åº¦å¤ªå¤§\nå¦‚æœåªæœ‰MACåœ°å€ï¼Œæ˜¯æ— æ³•æ”¯æ’‘èµ·è¿™ä¹ˆå¤§çš„ç½‘ç»œçš„ï¼Œä½ è§‰å¾—ç›´æ¥è®¿é—®åˆ°MACåœ°å€å°±è¡Œäº†ï¼Œé—®é¢˜æ˜¯ä½ è®©è·¯ç”±å™¨æ€ä¹ˆç»™ä½ æ‰¾åˆ°è·¯çº¿å‘¢ï¼Ÿ\n  æ²¡æœ‰ç»Ÿä¸€çš„ç¡¬ä»¶åœ°å€\nç”±äºå…¨ä¸–ç•Œå­˜åœ¨ç€å„å¼å„æ ·çš„ç½‘ç»œï¼Œä»–ä»¬ä½¿ç”¨ä¸åŒçš„ç¡¬ä»¶åœ°å€ã€‚è¦ä½¿è¿™äº›å¼‚æ„ç½‘ç»œèƒ½å¤Ÿäº’ç›¸é€šä¿¡å°±å¿…é¡»è¿›è¡Œéå¸¸å¤æ‚çš„ç¡¬ä»¶åœ°å€è½¬åŒ–å·¥ä½œï¼Œå› æ­¤ç”±ç”¨æˆ·æˆ–ç”¨æˆ·ä¸»æœºæ¥å®Œæˆè¿™é¡¹å·¥ä½œå‡ ä¹æ˜¯ä¸å¯èƒ½çš„çš„äº‹ã€‚ä½†IPç¼–å€å°±æŠŠè¿™ä¸ªå¤æ‚çš„é—®é¢˜è§£å†³äº†ã€‚è¿æ¥åˆ°äº’è”ç½‘çš„ä¸»æœºåªéœ€è¦å„è‡ªæ‹¥æœ‰ä¸€ä¸ªå”¯ä¸€çš„IPåœ°å€ï¼Œä»–ä»¬ä¹‹é—´çš„é€šä¿¡å°±åƒè¿æ¥åœ¨åŒä¸€ä¸ªç½‘ç»œé‚£ä¹ˆç®€å•æ–¹ä¾¿ã€‚å› ä¸ºARPæ˜¯ç”±è®¡ç®—æœºè½¯ä»¶è‡ªåŠ¨è¿›è¡Œçš„ï¼Œå¯¹ç”¨æˆ·æ¥è¯´æ˜¯çœ‹ä¸è§è¿™ç§è°ƒç”¨è¿‡ç¨‹çš„ã€‚\n   IPåœ°å€æ˜¯é€»è¾‘åœ°å€ï¼Œéœ€è¦æ˜ å°„åˆ°ç‰©ç†åœ°å€MACåœ°å€æ‰èƒ½å°†æ•°æ®å†™å…¥å¯¹æ–¹çš„ç½‘å¡ã€‚\n å‚è€ƒï¼š\n æœ‰äº† IP åœ°å€ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨ MAC åœ°å€ ä¸ºä»€ä¹ˆæœ‰äº†Macåœ°å€ï¼Œè¿˜è¦IPåœ°å€  ğŸ›° DNSåè®® DNSï¼ˆDomain Name Systemï¼‰æœåŠ¡æ˜¯å’ŒHTTPåè®®ä¸€æ ·ä½äºåº”ç”¨å±‚çš„åè®®ã€‚å®ƒæä¾›åŸŸååˆ°IPåœ°å€ä¹‹é—´çš„è§£ææœåŠ¡ã€‚\nç®€å•çš„è¿‡ç¨‹ï¼š\nå¤æ‚è§£æè¿‡ç¨‹ï¼š\nå½“ä¸€ä¸ªåº”ç”¨è¿›ç¨‹éœ€è¦æŠŠä¸»æœºåè§£æä¸ºipåœ°å€æ—¶ï¼Œè¯¥åº”ç”¨è¿›ç¨‹å°±è°ƒç”¨è§£æç¨‹åºï¼Œå¹¶æˆä¸ºdnsçš„ä¸€ä¸ªå®¢æˆ·ï¼ŒæŠŠå¾…è§£æçš„åŸŸååœ¨dnsè¯·æ±‚æŠ¥æ–‡ä¸­ï¼Œä»¥udpç”¨æˆ·æ•°æ®æŠ¥æ–¹å¼å‘é€ç»™æœ¬åœ°åŸŸåæœåŠ¡å™¨ã€‚æœ¬åœ°åŸŸåæœåŠ¡å™¨åœ¨æŸ¥æ‰¾åŸŸååï¼ŒæŠŠå¯¹åº”çš„ipåœ°å€æ”¾åœ¨å›ç­”æŠ¥æ–‡ä¸­è¿”å›ã€‚åº”ç”¨è¿›ç¨‹è·å¾—ç›®çš„ä¸»æœºçš„ipåœ°å€åå³å¯è¿›è¡Œé€šä¿¡ã€‚\nè‹¥æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸èƒ½å›ç­”è¯¥è¯·æ±‚ï¼Œåˆ™æ­¤åŸŸåæœåŠ¡å™¨å°±æš‚æ—¶æˆä¸ºäº†dnsä¸­çš„å¦ä¸€ä¸ªå®¢æˆ·ï¼Œå¹¶å‘å…¶å®ƒåŸŸåæœåŠ¡å™¨å‘é€æŸ¥è¯¢è¯·æ±‚ã€‚è¿™ç§è¿‡ç¨‹ç›´è‡³æ‰¾åˆ°èƒ½å¤Ÿå›ç­”è¯¥è¯·æ±‚çš„åŸŸåæœåŠ¡å™¨ä¸ºæ­¢ã€‚\nåŸŸåæœåŠ¡è§£æçš„ä¸¤ç§æ–¹å¼ï¼š\nå®¢æˆ·ç«¯å‘å‡ºçš„æŸ¥è¯¢éƒ½æ˜¯é€’å½’æŸ¥è¯¢ï¼ŒDNSæœåŠ¡å™¨å‘å¤–å‘å‡ºçš„æŸ¥è¯¢ä¸€èˆ¬éƒ½æ˜¯è¿­ä»£æŸ¥è¯¢\n ğŸ—ƒ FTPåè®® æ–‡ä»¶ä¼ è¾“åè®®FTP(File Transfer Protocol)æ˜¯å› ç‰¹ç½‘ä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„æ–‡ä»¶ä¼ è¾“åè®®ã€‚FTPä½¿ç”¨äº¤äº’å¼çš„è®¿é—®ï¼Œå…è®¸å®¢æˆ·æŒ‡å®šæ–‡ä»¶çš„ç±»å‹å’Œæ ¼å¼(å¦‚æŒ‡æ˜æ˜¯å¦ä½¿ç”¨ASCIIç )ï¼Œå¹¶å…è®¸æ–‡ä»¶å…·æœ‰å­˜å–æƒé™(å¦‚è®¿é—®æ–‡ä»¶çš„ç”¨æˆ·å¿…é¡»ç»è¿‡æˆæƒï¼Œå¹¶è¾“å…¥æœ‰æ•ˆçš„å£ä»¤)ã€‚\næ–‡ä»¶ä¼ è¾“åè®®æœ‰åŸºäºTCPçš„FTPå’ŒåŸºäºUDPçš„ç®€å•æ–‡ä»¶ä¼ è¾“åè®®TFTPï¼Œå®ƒä»¬éƒ½æ˜¯æ–‡ä»¶å…±äº«åè®®ä¸­çš„ä¸€å¤§ç±»ï¼Œå³å¤åˆ¶æ•´ä¸ªæ–‡ä»¶ï¼Œå…¶ç‰¹ç‚¹æ˜¯ï¼šè‹¥è¦å­˜å–ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±å¿…é¡»å…ˆè·å¾—ä¸€ä¸ªæœ¬åœ°çš„æ–‡ä»¶å‰¯æœ¬ã€‚å¦‚æœè¦ä¿®æ”¹æ–‡ä»¶ï¼Œåªèƒ½å¯¹æ–‡ä»¶çš„å‰¯æœ¬è¿›è¡Œä¿®æ”¹ï¼Œç„¶åå†å°†ä¿®æ”¹åçš„æ–‡ä»¶ä¼ å›åˆ°åŸèŠ‚ç‚¹ã€‚\nä¸Telnetç±»ä¼¼ï¼ŒFTPæœ€æ—©çš„è®¾è®¡æ˜¯ç”¨äºä¸¤å°ä¸åŒçš„ä¸»æœºï¼Œè¿™ä¸¤ä¸ªä¸»æœºå¯èƒ½è¿è¡Œåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸‹ã€ä½¿ç”¨ä¸åŒçš„æ–‡ä»¶ç»“æ„ã€å¹¶å¯èƒ½ä½¿ç”¨ä¸åŒå­—ç¬¦é›†ã€‚ä½†ä¸åŒçš„æ˜¯ï¼ŒTelnetè·å¾—å¼‚æ„æ€§æ˜¯å¼ºåˆ¶ä¸¤ç«¯éƒ½é‡‡ç”¨åŒä¸€ä¸ªæ ‡å‡†ï¼šä½¿ç”¨7æ¯”ç‰¹ASCIIç çš„NVTã€‚è€ŒFTPæ˜¯é‡‡ç”¨å¦ä¸€ç§æ–¹æ³•æ¥å¤„ç†ä¸åŒç³»ç»Ÿé—´çš„å·®å¼‚ã€‚FTPæ”¯æŒæœ‰é™æ•°é‡çš„æ–‡ä»¶ç±»å‹ï¼ˆASCIIï¼ŒäºŒè¿›åˆ¶ï¼Œç­‰ç­‰ï¼‰å’Œæ–‡ä»¶ç»“æ„ï¼ˆé¢å‘å­—èŠ‚æµæˆ–è®°å½•ï¼‰\nFTPä¸æˆ‘ä»¬å·²æè¿°çš„å¦ä¸€ç§åº”ç”¨ä¸åŒï¼Œå®ƒé‡‡ç”¨ä¸¤ä¸ªTCPè¿æ¥æ¥ä¼ è¾“ä¸€ä¸ªæ–‡ä»¶ã€‚\n æ§åˆ¶è¿æ¥ä»¥é€šå¸¸çš„å®¢æˆ·æœåŠ¡å™¨æ–¹å¼å»ºç«‹ã€‚æœåŠ¡å™¨ä»¥è¢«åŠ¨æ–¹å¼æ‰“å¼€ä¼—æ‰€å‘¨çŸ¥çš„ç”¨äºFTPçš„ç«¯å£ï¼ˆ21ï¼‰ï¼Œç­‰å¾…å®¢æˆ·çš„è¿æ¥ã€‚å®¢æˆ·åˆ™ä»¥ä¸»åŠ¨æ–¹å¼æ‰“å¼€TCPç«¯å£21ï¼Œæ¥å»ºç«‹è¿æ¥ã€‚æ§åˆ¶è¿æ¥å§‹ç»ˆç­‰å¾…å®¢æˆ·ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚è¯¥è¿æ¥å°†å‘½ä»¤ä»å®¢æˆ·ä¼ ç»™æœåŠ¡å™¨ï¼Œå¹¶ä¼ å›æœåŠ¡å™¨çš„åº”ç­”ã€‚\nç”±äºå‘½ä»¤é€šå¸¸æ˜¯ç”±ç”¨æˆ·é”®å…¥çš„ï¼Œæ‰€ä»¥IPå¯¹æ§åˆ¶è¿æ¥çš„æœåŠ¡ç±»å‹å°±æ˜¯â€œæœ€å¤§é™åº¦åœ°å‡å°è¿Ÿå»¶â€ã€‚ æ¯å½“ä¸€ä¸ªæ–‡ä»¶åœ¨å®¢æˆ·ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ—¶ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ•°æ®è¿æ¥ã€‚ï¼ˆå…¶ä»–æ—¶é—´ä¹Ÿå¯ä»¥åˆ›å»ºï¼Œåé¢æˆ‘ä»¬å°†è¯´åˆ°ï¼‰ã€‚\nç”±äºè¯¥è¿æ¥ç”¨äºä¼ è¾“ç›®çš„ï¼Œæ‰€ä»¥IPå¯¹æ•°æ®è¿æ¥çš„æœåŠ¡ç‰¹ç‚¹å°±æ˜¯â€œæœ€å¤§é™åº¦æé«˜ååé‡â€ã€‚  è¿æ¥æƒ…å†µï¼š\nä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œäº¤äº’å¼ç”¨æˆ·é€šå¸¸ä¸å¤„ç†åœ¨æ§åˆ¶è¿æ¥ä¸­è½¬æ¢çš„å‘½ä»¤å’Œåº”ç­”ã€‚è¿™äº›ç»†èŠ‚å‡ç”±ä¸¤ä¸ªåè®®è§£é‡Šå™¨æ¥å®Œæˆã€‚æ ‡æœ‰â€œç”¨æˆ·æ¥å£â€çš„æ–¹æ¡†åŠŸèƒ½æ˜¯æŒ‰ç”¨æˆ·æ‰€éœ€æä¾›å„ç§äº¤äº’ç•Œé¢ï¼ˆå…¨å±å¹•èœå•é€‰æ‹©ï¼Œé€è¡Œè¾“å…¥å‘½ä»¤ï¼Œç­‰ç­‰ï¼‰ï¼Œå¹¶æŠŠå®ƒä»¬è½¬æ¢æˆåœ¨æ§åˆ¶è¿æ¥ä¸Šå‘é€çš„FTPå‘½ä»¤ã€‚ç±»ä¼¼åœ°ï¼Œä»æ§åˆ¶è¿æ¥ä¸Šä¼ å›çš„æœåŠ¡å™¨åº”ç­”ä¹Ÿè¢«è½¬æ¢æˆç”¨æˆ·æ‰€éœ€çš„äº¤äº’æ ¼å¼ã€‚\nå‚è€ƒï¼š\n æ·±å…¥ç†è§£FTPåè®® ç¬¬27ç«  FTP:æ–‡ä»¶ä¼ é€åè®®  X.509 æ•°å­—è¯ä¹¦ ç®€å•æ¥è¯´ï¼Œæ•°å­—è¯ä¹¦å°±æ˜¯ä¸€å¼ é™„å¸¦äº†æ•°å­—ç­¾åçš„ä¿¡æ¯è¡¨ã€‚\næ•°å­—è¯ä¹¦çš„ç­¾ç½² æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯å¯¹å…¬é’¥å’Œä¿¡æ¯è¿›è¡Œhashå¾—åˆ°æ‘˜è¦ï¼Œç„¶åä½¿ç”¨ç§é’¥å¯¹æ‘˜è¦è¿›è¡ŒåŠ å¯†å¾—åˆ°åŠ å¯†åçš„æ‘˜è¦ã€‚åŠ åŠ å¯†åçš„æ‘˜è¦å’Œå…¬é’¥ä»¥åŠä¿¡æ¯åŒ…è£…æˆä¸€ä¸ªè¯ä¹¦ã€‚\næ ¹è®¤è¯æœºæ„çš„æ„å»º ç®€è¦æµç¨‹\n æ ¹è®¤è¯æœºæ„ã€ŒCAã€ç”Ÿæˆå…¬é’¥ ca_KeyPub å’Œç§é’¥ ca_KeyPriï¼Œä»¥åŠåŸºæœ¬ä¿¡æ¯è¡¨ ca_Infoã€‚ca_Info ä¸­ä¸€èˆ¬åŒ…å«äº†ã€ŒCAã€çš„åç§°ã€è¯ä¹¦çš„æœ‰æ•ˆæœŸç­‰ä¿¡æ¯ã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€å¯¹ï¼ˆca_KeyPub + ca_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ ca_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€ä½¿ç”¨å…¶ç§é’¥ ca_KeyPri å¯¹ ca_Hash è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†çš„æ•£åˆ—å€¼ enc_ca_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€å°†ï¼ˆca_KeyPub + ca_Info + enc_ca_Hashï¼‰ç»„åˆç”Ÿæˆè‡ªç­¾åçš„æ•°å­—è¯ä¹¦**ã€Œca_Certã€**ã€‚è¿™å¼ è¯ä¹¦ç§°ä¹‹ä¸ºæ ¹è¯ä¹¦ã€‚  æ ¹è¯ä¹¦**ã€Œca_Certã€**åŒ…å«çš„å†…å®¹ï¼šca_KeyPub + ca_Info + enc_ca_Hashã€‚\n**ã€Œca_Certã€**å¯ç”¨äºç­¾ç½²ä¸‹ä¸€çº§çš„è¯ä¹¦ã€‚\nå•çº§è®¤è¯æœºæ„çš„è¯ä¹¦ç­¾ç½² ç®€è¦æµç¨‹\n æœåŠ¡å™¨ã€ŒSã€ç”Ÿæˆå…¬é’¥ s_KeyPub å’Œç§é’¥ s_KeyPriï¼Œä»¥åŠåŸºæœ¬ä¿¡æ¯è¡¨ s_Infoã€‚s_Info ä¸­ä¸€èˆ¬åŒ…å«äº†ã€ŒSã€çš„åç§°ã€è¯ä¹¦è¦æ±‚çš„æœ‰æ•ˆæœŸç­‰ä¿¡æ¯ã€‚ æœåŠ¡å™¨ã€ŒSã€å°† s_KeyPubã€s_Info é€ç»™æ ¹è®¤è¯æœºæ„ã€ŒCAã€ã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€é€šè¿‡æŸç§æ–¹å¼éªŒè¯ã€ŒSã€çš„èº«ä»½ä¹‹åï¼Œå†åŠ ä¸Šæ ¹è®¤è¯æœºæ„è‡ªå·±çš„ä¸€äº›ä¿¡æ¯ ca_Infoï¼Œç„¶åå¯¹å®ƒä»¬ï¼ˆs_KeyPub + s_Info + ca_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ s_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€ä½¿ç”¨å…¶ç§é’¥ ca_KeyPri å¯¹ s_Hash è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†çš„æ•£åˆ—å€¼ enc_s_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€å°†ï¼ˆs_KeyPub + s_Info + ca_Info + enc_s_Hashï¼‰ç»„åˆç­¾ç½²æˆæ•°å­—è¯ä¹¦**ã€Œs_Certã€**å¹¶å›é€ç»™ã€ŒSã€ã€‚  æœåŠ¡å™¨è¯ä¹¦**ã€Œs_Certã€**åŒ…å«çš„å†…å®¹ï¼šs_KeyPub + s_Info + ca_Info + enc_s_Hashã€‚\n**ã€Œs_Certã€**ä¸å¯ç”¨äºç­¾ç½²ä¸‹ä¸€çº§çš„è¯ä¹¦ã€‚\näºŒçº§ï¼ˆæˆ–ä»¥ä¸Šï¼‰è®¤è¯æœºæ„çš„æ„å»º  åœ¨ç°å®ä¸­ï¼Œä»…ä»…é ä¸€ä¸ªè®¤è¯æœºæ„æ˜¯æ»¡è¶³ä¸äº†æµ·é‡è¯ä¹¦ç­¾ç½²éœ€æ±‚çš„ï¼Œå› æ­¤éœ€è¦æ„å»ºåˆ†æ”¯è®¤è¯æœºæ„ã€‚\n ç®€è¦æµç¨‹\n äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€ç”Ÿæˆå…¬é’¥ ca2_KeyPub å’Œç§é’¥ ca2_KeyPriï¼Œä»¥åŠåŸºæœ¬ä¿¡æ¯è¡¨ ca2_Infoã€‚ca2_Info ä¸­ä¸€èˆ¬åŒ…å«äº†ã€ŒCA2ã€çš„åç§°ã€è¯ä¹¦è¦æ±‚çš„æœ‰æ•ˆæœŸç­‰ä¿¡æ¯ã€‚ äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€å°† ca2_KeyPubã€ca2_Info é€ç»™æ ¹è®¤è¯æœºæ„ã€ŒCAã€ã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€é€šè¿‡æŸç§æ–¹å¼éªŒè¯ã€ŒCA2ã€çš„èº«ä»½ä¹‹åï¼Œå†åŠ ä¸Šæ ¹è®¤è¯æœºæ„è‡ªå·±çš„ä¸€äº›ä¿¡æ¯ ca_Infoï¼Œç„¶åå¯¹å®ƒä»¬ï¼ˆca2_KeyPub + ca2_Info + ca_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ ca2_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€ä½¿ç”¨å…¶ç§é’¥ ca_KeyPri å¯¹ ca2_Hash è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†çš„æ•£åˆ—å€¼ enc_ca2_Hashã€‚ æ ¹è®¤è¯æœºæ„ã€ŒCAã€å°†ï¼ˆca2_KeyPub + ca2_Info + ca_Info + enc_ca2_Hashï¼‰ç»„åˆç­¾ç½²æˆæ•°å­—è¯ä¹¦**ã€Œca2_Certã€**å¹¶å›é€ç»™ã€ŒCA2ã€ã€‚  äºŒçº§è®¤è¯æœºæ„è¯ä¹¦**ã€Œca2_Certã€**åŒ…å«çš„å†…å®¹ï¼šca2_KeyPub + ca2_Info + ca_Info + enc_ca2_Hashã€‚\n**ã€Œca2_Certã€**å¯ç”¨äºç­¾ç½²ä¸‹ä¸€çº§çš„è¯ä¹¦ã€‚\nä¸‰çº§æˆ–æ›´å¤šçº§è®¤è¯æœºæ„çš„æ„å»ºæµç¨‹è·Ÿè¿™ä¸ªæµç¨‹å·®ä¸å¤šï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚\näºŒçº§ï¼ˆæˆ–ä»¥ä¸Šï¼‰è®¤è¯æœºæ„çš„è¯ä¹¦ç­¾ç½² ç®€è¦æµç¨‹\n æœåŠ¡å™¨ã€ŒS2ã€ç”Ÿæˆå…¬é’¥ s2_KeyPub å’Œç§é’¥ s2_KeyPriï¼Œä»¥åŠåŸºæœ¬ä¿¡æ¯è¡¨ s2_Infoã€‚s2_Info ä¸­ä¸€èˆ¬åŒ…å«äº†ã€ŒS2ã€çš„åç§°ã€è¯ä¹¦è¦æ±‚çš„æœ‰æ•ˆæœŸç­‰ä¿¡æ¯ã€‚ æœåŠ¡å™¨ã€ŒS2ã€å°† s2_KeyPubã€s2_Info é€ç»™äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€ã€‚ äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€é€šè¿‡æŸç§æ–¹å¼éªŒè¯ã€ŒS2ã€çš„èº«ä»½ä¹‹åï¼Œå†åŠ ä¸Šæ ¹è®¤è¯æœºæ„è‡ªå·±çš„ä¸€äº›ä¿¡æ¯ ca2_Infoï¼Œç„¶åå¯¹å®ƒä»¬ï¼ˆs2_KeyPub + s2_Info + ca2_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ s2_Hashã€‚ äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€ä½¿ç”¨å…¶ç§é’¥ ca2_KeyPri å¯¹ s2_Hash è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†çš„æ•£åˆ—å€¼ enc_s2_Hashã€‚ äºŒçº§è®¤è¯æœºæ„ã€ŒCA2ã€å°†ï¼ˆs2_KeyPub + s2_Info + ca2_Info + enc_s2_Hashï¼‰ç»„åˆç­¾ç½²æˆæ•°å­—è¯ä¹¦**ã€Œs2_Certã€**å¹¶å›é€ç»™ã€ŒS2ã€ã€‚  æœåŠ¡å™¨è¯ä¹¦**ã€Œs2_Certã€**åŒ…å«çš„å†…å®¹ï¼šs2_KeyPub + s2_Info + ca2_Info + enc_s2_Hashã€‚\n**ã€Œs2_Certã€**ä¸å¯ç”¨äºç­¾ç½²ä¸‹ä¸€çº§çš„è¯ä¹¦ã€‚\nä¸‰çº§æˆ–æ›´å¤šçº§è®¤è¯æœºæ„è¯ä¹¦ç­¾ç½²æµç¨‹è·Ÿè¿™ä¸ªæµç¨‹å·®ä¸å¤šï¼Œä¹Ÿä¸å†èµ˜è¿°äº†ã€‚\nä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œè¯ä¹¦ç­¾ç½²çš„æµç¨‹æ˜¯ï¼šã€Œca_Certã€-\u0026gt; ã€Œca2_Certã€-\u0026gt;**ã€Œs2_Certã€**ã€‚å®ƒæ˜¯ä¸€æ¡å®Œæ•´çš„é“¾æ¡ï¼Œæˆ‘ä»¬æŠŠå®ƒç§°ä¹‹ä¸ºã€Œè¯ä¹¦é“¾ã€ã€‚\nç°å®ä¸­çš„è¯ä¹¦ç­¾ç½² ç°å®ä¸­çš„è¯ä¹¦å¤§å¤šæ•°æ˜¯ç”±äºŒçº§è®¤è¯æœºæ„ç­¾ç½²çš„ã€‚\nå¹¶ä¸”ï¼Œä»¥æŸç§æ–¹å¼ï¼ˆå¦‚ DNSï¼‰å¯¹æœåŠ¡å™¨çš„èº«ä»½è¿›è¡ŒéªŒè¯ä¹‹åï¼Œä¸€èˆ¬æ— éœ€è®©æœåŠ¡å™¨æä¾›ä»»ä½•ä¿¡æ¯ï¼ˆCSR æ–‡ä»¶ï¼‰ã€‚\nè®¤è¯æœºæ„ä¼šæä¾›è¯ä¹¦ã€è¯ä¹¦é“¾ä»¥åŠç§é’¥ï¼ŒæœåŠ¡å™¨ç›´æ¥ä½¿ç”¨å°±å¥½äº†ã€‚\næœåŠ¡å™¨çš„é…ç½® å¦‚æœæœåŠ¡å™¨ã€ŒSã€ä½¿ç”¨çš„è¯ä¹¦æ˜¯ç”±æ ¹è®¤è¯æœºæ„ã€ŒCAã€ç›´æ¥ç­¾ç½²çš„ï¼Œé‚£ä¹ˆåªéœ€è¦å‘å®¢æˆ·ç«¯æä¾›**ã€Œs_Certã€**ï¼Œç„¶åè‡ªå·±ä½¿ç”¨ç§é’¥ s_KeyPri å³å¯å®ç°éå¯¹ç§°åŠ å¯†ã€‚\nå¦‚æœæœåŠ¡å™¨ã€ŒS2ã€ä½¿ç”¨çš„è¯ä¹¦ä¸æ˜¯ç”±æ ¹è®¤è¯æœºæ„ã€ŒCAã€ç›´æ¥ç­¾ç½²çš„ï¼Œåˆ™ä¸ä»…éœ€è¦å‘å®¢æˆ·ç«¯æä¾›**ã€Œs2_Certã€**ï¼Œè€Œä¸”è¿˜è¦æä¾›é™¤æ ¹è®¤è¯æœºæ„ã€ŒCAã€ä¹‹å¤–æ‰€æœ‰è®¤è¯æœºæ„çš„è¯ä¹¦ï¼ˆè¿™é‡Œè¿˜è¦æä¾›**ã€Œca2_Certã€**ï¼‰ï¼Œå¦åˆ™å®¢æˆ·ç«¯å¯èƒ½ä¼šæç¤ºè¯ä¹¦é“¾ä¸å®Œæ•´è€Œæ— æ³•é€šè¿‡éªŒè¯ã€‚æœåŠ¡å™¨è‡ªå·±ä½¿ç”¨ç§é’¥ s2_KeyPri å³å¯å®ç°éå¯¹ç§°åŠ å¯†ã€‚\nå®¢æˆ·ç«¯éªŒè¯æœåŠ¡å™¨çš„èº«ä»½ å•çº§è®¤è¯æœºæ„çš„éªŒè¯ ç®€è¦æµç¨‹\nï¼ˆå‡è®¾æ ¹è®¤è¯æœºæ„ã€ŒCAã€çš„æ ¹è¯ä¹¦**ã€Œca_Certã€**å·²ç»å®‰è£…åˆ°æ“ä½œç³»ç»Ÿä¸­ä¸”è¢«ä¿¡ä»»ã€‚ä¸‹åŒã€‚ï¼‰\n æœåŠ¡å™¨ã€ŒSã€ä¸‹å‘è¯ä¹¦**ã€Œs_Certã€**ç»™å®¢æˆ·ç«¯ã€ŒCã€ã€‚ å®¢æˆ·ç«¯ã€ŒCã€æ£€æŸ¥åˆ°**ã€Œs_Certã€**ä¸­çš„ ca_Infoï¼Œå‘ç°å®ƒæ˜¯ç”±ã€ŒCAã€ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€å–å‡º**ã€Œca_Certã€**ä¸­çš„ ca_KeyPubï¼Œå¯¹**ã€Œs_Certã€**ä¸­çš„ enc_s_Hash è¿›è¡Œè§£å¯†å¾—åˆ° s_Hashã€‚ å®¢æˆ·ç«¯ã€ŒCã€å¯¹**ã€Œs_Certã€**ä¸­çš„ï¼ˆs_KeyPub + s_Info + ca_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ s_Hash_tmpã€‚ å®¢æˆ·ç«¯ã€ŒCã€åˆ¤æ–­ s_Hash å’Œ s_Hash_tmp æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œåˆ™è¯æ˜**ã€Œs_Certã€**æ˜¯ç”±**ã€Œca_Certã€**ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€æ£€æŸ¥**ã€Œca_Certã€**ï¼Œå‘ç°è¯¥è¯ä¹¦æ˜¯æ ¹è¯ä¹¦ï¼Œä¸”å·²ç»è¢«ç³»ç»Ÿä¿¡ä»»ï¼Œèº«ä»½éªŒè¯é€šè¿‡ã€‚   å¦‚æœ**ã€Œca_Certã€**æ²¡æœ‰å®‰è£…åˆ°ç³»ç»Ÿä¸­ï¼Œé‚£ä¹ˆå°†æ— æ³•å¯¹ enc_s_Hash è¿›è¡Œè§£å¯†ï¼Œä¹Ÿå°±æ— æ³•éªŒè¯**ã€Œs_Certã€**çš„çœŸå®æ€§äº†ã€‚ä¸‹åŒã€‚\n äºŒçº§ï¼ˆæˆ–ä»¥ä¸Šï¼‰è®¤è¯æœºæ„çš„éªŒè¯ ç®€è¦æµç¨‹\n æœåŠ¡å™¨ã€ŒS2ã€ä¸‹å‘è¯ä¹¦**ã€Œs2_Certã€**ã€**ã€Œca2_Certã€**ç»™å®¢æˆ·ç«¯ã€ŒCã€ã€‚ å®¢æˆ·ç«¯ã€ŒCã€æ£€æŸ¥åˆ°**ã€Œs2_Certã€**ä¸­çš„ ca2_Infoï¼Œå‘ç°å®ƒæ˜¯ç”±ã€ŒCA2ã€ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€å–å‡º**ã€Œca2_Certã€**ä¸­çš„ ca2_KeyPubï¼Œå¯¹**ã€Œs2_Certã€**ä¸­çš„ enc_s2_Hash è¿›è¡Œè§£å¯†å¾—åˆ° s2_Hashã€‚ å®¢æˆ·ç«¯ã€ŒCã€å¯¹**ã€Œs2_Certã€**ä¸­çš„ï¼ˆs2_KeyPub + s2_Info + ca2_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ s2_Hash_tmpã€‚ å®¢æˆ·ç«¯ã€ŒCã€åˆ¤æ–­ s2_Hash å’Œ s2_Hash_tmp æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œåˆ™è¯æ˜**ã€Œs2_Certã€**æ˜¯ç”±**ã€Œca2_Certã€**ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€æ£€æŸ¥åˆ°**ã€Œca2_Certã€**ä¸­çš„ ca_Infoï¼Œå‘ç°å®ƒæ˜¯ç”±ã€ŒCAã€ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€å–å‡º**ã€Œca_Certã€**ä¸­çš„ ca_KeyPubï¼Œå¯¹**ã€Œca2_Certã€**ä¸­çš„ enc_ca2_Hash è¿›è¡Œè§£å¯†å¾—åˆ° ca2_Hashã€‚ å®¢æˆ·ç«¯ã€ŒCã€å¯¹**ã€Œca2_Certã€**ä¸­çš„ï¼ˆca2_KeyPub + ca2_Info + ca_Infoï¼‰è¿›è¡Œæ•£åˆ—è¿ç®—ï¼Œå¾—åˆ°æ•£åˆ—å€¼ ca2_Hash_tmpã€‚ å®¢æˆ·ç«¯ã€ŒCã€åˆ¤æ–­ ca2_Hash å’Œ ca2_Hash_tmp æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¯æ˜**ã€Œca2_Certã€**æ˜¯ç”±**ã€Œca_Certã€**ç­¾ç½²çš„ã€‚ å®¢æˆ·ç«¯ã€ŒCã€æ£€æŸ¥**ã€Œca_Certã€**ï¼Œå‘ç°è¯¥è¯ä¹¦æ˜¯æ ¹è¯ä¹¦ï¼Œä¸”å·²ç»è¢«ç³»ç»Ÿä¿¡ä»»ï¼Œèº«ä»½éªŒè¯é€šè¿‡ã€‚  ä¸‰çº§æˆ–æ›´å¤šçº§è®¤è¯æœºæ„è¯ä¹¦éªŒè¯æµç¨‹è·Ÿè¿™ä¸ªæµç¨‹å·®ä¸å¤šï¼Œå°±æ˜¯ä¸€ç¯æ‰£ä¸€ç¯åœ°éªŒè¯ä¸‹å»ã€‚\nåŠ å¯†ä¼ è¾“çš„æ•°æ® æœåŠ¡å™¨ã€ŒSã€çš„èº«ä»½å¾—åˆ°å®¢æˆ·ç«¯ã€ŒCã€çš„è®¤å¯ä¹‹åï¼ŒæœåŠ¡å™¨ã€ŒSã€å¯ä»¥ä½¿ç”¨ s_KeyPri å¯¹ä¼ å‡ºçš„æ•°æ®è¿›è¡ŒåŠ å¯†æˆ–è€…å¯¹ä¼ å…¥çš„æ•°æ®è¿›è¡Œè§£å¯†ã€‚\nåè¿‡æ¥ï¼Œå®¢æˆ·ç«¯ã€ŒCã€å¯ä»¥ä½¿ç”¨ s_KeyPub å¯¹ä¼ å‡ºçš„æ•°æ®è¿›è¡ŒåŠ å¯†æˆ–è€…å¯¹ä¼ å…¥çš„æ•°æ®è¿›è¡Œè§£å¯†ã€‚\nç”±äºéå¯¹ç§°åŠ å¯†çš„æ•ˆç‡è¾ƒä½ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨éå¯¹ç§°åŠ å¯†åå•†å¹¶äº¤æ¢ä¸€ä¸ªä¸´æ—¶çš„ä¼šè¯å¯†é’¥ä¹‹åï¼Œä½¿ç”¨ä¼šè¯å¯†é’¥è¿›è¡Œå¯¹ç§°åŠ å¯†ã€‚\nç°å®ä¸­çš„è¯ä¹¦éªŒè¯ ç°å®ä¸­ï¼Œä¸€äº›ä¼—æ‰€å‘¨çŸ¥ä¸”è¢«ä¿¡ä»»è¯ä¹¦è®¤è¯æœºæ„çš„æ ¹è¯ä¹¦éƒ½è¢«å†…ç½®åˆ°äº†æ“ä½œç³»ç»Ÿä¸­ã€‚\nè€Œå®¢æˆ·ç«¯åœ¨æ£€æŸ¥æœåŠ¡å™¨è¯ä¹¦çš„æ—¶å€™ï¼Œä¸€èˆ¬è¿˜ä¼šæ£€æŸ¥å®ƒçš„æœ‰æ•ˆæœŸä»¥åŠè¯¥è¯ä¹¦æ˜¯å¦åœ¨è®¤è¯æœºæ„çš„è¯ä¹¦åŠé”€åˆ—è¡¨ä¸­ã€‚è¯ä¹¦åŠé”€åˆ—è¡¨ä¸€èˆ¬æ˜¯åœ¨çº¿æ£€æŸ¥çš„ã€‚\nå‚è€ƒï¼š\n X.509æ•°å­—è¯ä¹¦çš„ç»“æ„ä¸è§£æ X.509 æ•°å­—è¯ä¹¦çš„åŸºæœ¬åŸç†åŠåº”ç”¨  HTTPæ¦‚è¿° HTTPæ˜¯ä¸€ä¸ªå±äºåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ï¼Œç”±äºå…¶ç®€æ·ã€å¿«é€Ÿçš„æ–¹å¼ï¼Œé€‚ç”¨äºåˆ†å¸ƒå¼è¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿã€‚\nHTTP/0.9 HTTP æ˜¯åŸºäº TCP/IP åè®®çš„åº”ç”¨å±‚åè®®ã€‚å®ƒä¸æ¶‰åŠæ•°æ®åŒ…ï¼ˆpacketï¼‰ä¼ è¾“ï¼Œä¸»è¦è§„å®šäº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡æ ¼å¼ï¼Œé»˜è®¤ä½¿ç”¨80ç«¯å£ã€‚\n åè®®è§„å®šï¼ŒæœåŠ¡å™¨åªèƒ½å›åº”HTMLæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä¸èƒ½å›åº”åˆ«çš„æ ¼å¼ã€‚\n HTTP/1.x  åœ¨æ—©æœŸï¼ŒHTTP ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ¨¡å‹æ¥å¤„ç†è¿™æ ·çš„è¿æ¥ã€‚è¿™äº›è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸæ˜¯çŸ­æš‚çš„ï¼šæ¯å‘èµ·ä¸€ä¸ªè¯·æ±‚æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œå¹¶åœ¨æ”¶åˆ°åº”ç­”æ—¶ç«‹å³å…³é—­ã€‚è¿æ¥çš„æˆæœ¬è¾ƒé«˜ã€‚\n å½“è¯·æ±‚å‘èµ·æ—¶ï¼Œç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½éƒ½ä¼šå¯¹æ€§èƒ½é€ æˆå½±å“ã€‚ç°ä»£æµè§ˆå™¨å¾€å¾€è¦å‘èµ·å¾ˆå¤šæ¬¡è¯·æ±‚(åå‡ ä¸ªæˆ–è€…æ›´å¤š)æ‰èƒ½æ‹¿åˆ°æ‰€éœ€çš„å®Œæ•´ä¿¡æ¯ï¼Œè¯æ˜äº†è¿™ä¸ªæ—©æœŸæ¨¡å‹çš„æ•ˆç‡ä½ä¸‹ã€‚\nåœ¨ HTTP/1.x é‡Œæœ‰å¤šç§æ¨¡å‹ï¼šçŸ­è¿æ¥, é•¿è¿æ¥, å’Œ HTTP æµæ°´çº¿ã€‚\nçŸ­é“¾æ¥æ¨¡å‹ HTTP/1.0 çš„é»˜è®¤æ¨¡å‹ã€‚æ¯ä¸€ä¸ª HTTP è¯·æ±‚éƒ½ç”±å®ƒè‡ªå·±ç‹¬ç«‹çš„è¿æ¥å®Œæˆï¼›è¿™æ„å‘³ç€å‘èµ·æ¯ä¸€ä¸ª HTTP è¯·æ±‚ä¹‹å‰éƒ½ä¼šæœ‰ä¸€æ¬¡ TCP æ¡æ‰‹ï¼Œè€Œä¸”æ˜¯è¿ç»­ä¸æ–­çš„ã€‚\n åœ¨ HTTP/1.1 ä¸­ï¼Œåªæœ‰å½“ Connection è¢«è®¾ç½®ä¸º close æ—¶æ‰ä¼šç”¨åˆ°è¿™ä¸ªæ¨¡å‹\n é•¿è¿æ¥æ¨¡å‹ ä¿æŒè¿æ¥å»å®Œæˆå¤šæ¬¡è¿ç»­çš„è¯·æ±‚ï¼Œå‡å°‘äº†ä¸æ–­é‡æ–°æ‰“å¼€è¿æ¥çš„æ—¶é—´ã€‚åœ¨ HTTP/1.1 é‡Œï¼Œé»˜è®¤å°±æ˜¯é•¿è¿æ¥çš„ã€‚\n çŸ­è¿æ¥æœ‰ä¸¤ä¸ªæ¯”è¾ƒå¤§çš„é—®é¢˜ï¼šåˆ›å»ºæ–°è¿æ¥è€—è´¹çš„æ—¶é—´å°¤ä¸ºæ˜æ˜¾ï¼Œå¦å¤– TCP è¿æ¥çš„æ€§èƒ½åªæœ‰åœ¨è¯¥è¿æ¥è¢«ä½¿ç”¨ä¸€æ®µæ—¶é—´å(çƒ­è¿æ¥)æ‰èƒ½å¾—åˆ°æ”¹å–„ã€‚å¦å¤–æˆ‘ä»¬çŸ¥é“ï¼ŒTCPåè®®æœ‰ä¸ªæ»‘åŠ¨çª—å£ï¼Œæœ‰æ…¢å¯åŠ¨è¿™å›äº‹ï¼Œå°±æ˜¯è¯´æ¯æ¬¡å»ºç«‹æ–°è¿æ¥åï¼Œæ•°æ®å…ˆæ˜¯æ…¢æ…¢åœ°ä¼ ï¼Œç„¶åæ»‘åŠ¨çª—å£æ…¢æ…¢å˜å¤§ï¼Œæ‰èƒ½è¾ƒé«˜é€Ÿåº¦åœ°ä¼ ã€‚\n å…·ä½“æµç¨‹ï¼š\nä¸€ä¸ªé•¿è¿æ¥ä¼šä¿æŒä¸€æ®µæ—¶é—´ï¼Œé‡å¤ç”¨äºå‘é€ä¸€ç³»åˆ—è¯·æ±‚ï¼ŒèŠ‚çœäº†æ–°å»º TCP è¿æ¥æ¡æ‰‹çš„æ—¶é—´ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ TCP çš„æ€§èƒ½å¢å¼ºèƒ½åŠ›ã€‚å½“ç„¶è¿™ä¸ªè¿æ¥ä¹Ÿä¸ä¼šä¸€ç›´ä¿ç•™ç€ï¼šè¿æ¥åœ¨ç©ºé—²ä¸€æ®µæ—¶é—´åä¼šè¢«å…³é—­(æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨ Keep-Alive åè®®å¤´æ¥æŒ‡å®šä¸€ä¸ªæœ€å°çš„è¿æ¥ä¿æŒæ—¶é—´)ã€‚\nç¼ºç‚¹ï¼š\nå°±ç®—æ˜¯åœ¨ç©ºé—²çŠ¶æ€ï¼Œå®ƒè¿˜æ˜¯ä¼šæ¶ˆè€—æœåŠ¡å™¨èµ„æºï¼Œè€Œä¸”åœ¨é‡è´Ÿè½½æ—¶ï¼Œè¿˜æœ‰å¯èƒ½é­å— DoS attacks æ”»å‡»ã€‚è¿™ç§åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨éé•¿è¿æ¥ï¼Œå³å°½å¿«å…³é—­é‚£äº›ç©ºé—²çš„è¿æ¥ï¼Œä¹Ÿèƒ½å¯¹æ€§èƒ½æœ‰æ‰€æå‡ã€‚\n é•¿è¿æ¥ä¸€ä¸ªä¼˜åŒ–çš„æ–¹æ³•å°±æ˜¯è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œä½†æ˜¯å…·ä½“è¿™ä¸ªæ—¶é—´æ˜¯å¤šå°‘ï¼Œåº”è¯¥é€šè¿‡æµ‹è¯•ä¹‹åå¾—å‡ºä¸€ä¸ªè¾ƒä¸ºå‡è¡¡çš„æ—¶é—´ã€‚\n æµæ°´çº¿æ¨¡å‹(ç®¡çº¿åŒ–) å¤šä¸ªè¿ç»­çš„è¯·æ±‚ç”šè‡³éƒ½ä¸ç”¨ç­‰å¾…ç«‹å³è¿”å›å°±å¯ä»¥è¢«å‘é€ã€‚HTTP æµæ°´çº¿åœ¨ç°ä»£æµè§ˆå™¨ä¸­å¹¶ä¸æ˜¯é»˜è®¤è¢«å¯ç”¨çš„ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼ŒHTTP è¯·æ±‚æ˜¯æŒ‰é¡ºåºå‘å‡ºçš„ã€‚ä¸‹ä¸€ä¸ªè¯·æ±‚åªæœ‰åœ¨å½“å‰è¯·æ±‚æ”¶åˆ°åº”ç­”è¿‡åæ‰ä¼šè¢«å‘å‡ºã€‚ç”±äºä¼šå—åˆ°ç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½çš„é™åˆ¶ï¼Œåœ¨ä¸‹ä¸€ä¸ªè¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´ã€‚\n**æµæ°´çº¿æ˜¯åœ¨åŒä¸€æ¡é•¿è¿æ¥ä¸Šå‘å‡ºè¿ç»­çš„è¯·æ±‚ï¼Œè€Œä¸ç”¨ç­‰å¾…åº”ç­”è¿”å›ã€‚è¿™æ ·å¯ä»¥é¿å…è¿æ¥å»¶è¿Ÿã€‚ç†è®ºä¸Šè®²ï¼Œæ€§èƒ½è¿˜ä¼šå› ä¸ºä¸¤ä¸ª HTTP è¯·æ±‚æœ‰å¯èƒ½è¢«æ‰“åŒ…åˆ°ä¸€ä¸ª TCP æ¶ˆæ¯åŒ…ä¸­è€Œå¾—åˆ°æå‡ã€‚**å°±ç®— HTTP è¯·æ±‚ä¸æ–­çš„ç»§ç»­ï¼Œå°ºå¯¸ä¼šå¢åŠ ï¼Œä½†è®¾ç½® TCP çš„ MSS(Maximum Segment Size) é€‰é¡¹ï¼Œä»ç„¶è¶³å¤ŸåŒ…å«ä¸€ç³»åˆ—ç®€å•çš„è¯·æ±‚ã€‚\n æ¯”å¦‚ï¼Œå½“è¯·æ±‚ä¸€ä¸ªåŒ…å«10å¼ å›¾ç‰‡çš„HTML Webé¡µé¢ï¼Œä¸æŒ¨ä¸ªè¿æ¥ç›¸æ¯”ï¼Œç”¨æŒä¹…è¿æ¥å¯ä»¥è®©è¯·æ±‚æ›´å¿«ç»“æŸã€‚è€Œç®¡çº¿åŒ–æŠ€æœ¯åˆ™æ¯”æŒä¹…è¿æ¥è¿˜è¦å¿«ã€‚è¯·æ±‚æ•°è¶Šå¤šï¼Œæ—¶é—´å·®å°±è¶Šæ˜æ˜¾ã€‚\n é˜Ÿå¤´é˜»å¡ åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒHTTPéµå®ˆâ€œè¯·æ±‚-å“åº”â€çš„æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯æ¯æ¬¡å‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯è¿”å›å“åº”ï¼Œè¿™ç§æ¨¡å¼å¾ˆç®€å•ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªè‡´å‘½ç¼ºé™·é‚£å°±æ˜¯é¡µé¢ä¸­æœ‰å¤šä¸ªè¯·æ±‚ï¼Œæ¯ä¸ªè¯·æ±‚å¿…é¡»ç­‰åˆ°å‰ä¸€ä¸ªè¯·æ±‚å“åº”ä¹‹åæ‰èƒ½å‘é€ï¼Œå¹¶ä¸”å½“å‰è¯·æ±‚çš„å“åº”è¿”å›ä¹‹åï¼Œå½“å‰è¯·æ±‚çš„ä¸‹ä¸€ä¸ªè¯·æ±‚æ‰èƒ½å‘é€ï¼Œæµç¨‹å¦‚ä¸‹å›¾\nåœ¨TCPé“¾æ¥ä¸­ï¼Œhttpè¯·æ±‚å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªè¯·æ±‚å“åº”ä¹‹åï¼Œæ‰èƒ½å‘é€ï¼Œåé¢çš„ä¾æ¬¡ç±»æ¨ï¼Œç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœåœ¨ä¸€ä¸ªtcpé€šé“ä¸­å¦‚æœæŸä¸ªhttpè¯·æ±‚çš„å“åº”å› ä¸ºæŸä¸ªåŸå› æ²¡æœ‰åŠæ—¶è¿”å›ï¼Œåé¢çš„å“åº”ä¼šè¢«é˜»å¡ï¼Œè¿™å°±æ˜¯é˜Ÿå¤´é˜»å¡ã€‚\n æ³¨æ„è¿™é‡Œè¯´çš„æ˜¯å“åº”ä¹‹åï¼Œå¹¶ä¸æ˜¯è¯·ä¹‹å!\n ä¸ºäº†æé«˜é€Ÿåº¦å’Œæ•ˆç‡ï¼Œåœ¨æŒä¹…è¿æ¥çš„åŸºç¡€ä¸Šï¼ŒHTTP1.1è¿›ä¸€æ­¥åœ°æ”¯æŒåœ¨æŒä¹…è¿æ¥ä¸Šä½¿ç”¨ç®¡é“åŒ–ï¼ˆpipeliningï¼‰ç‰¹æ€§ã€‚ç®¡é“åŒ–å…è®¸å®¢æˆ·ç«¯åœ¨å·²å‘é€çš„è¯·æ±‚æ”¶åˆ°æœåŠ¡ç«¯çš„å“åº”ä¹‹å‰å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œå€Ÿæ­¤æ¥å‡å°‘ç­‰å¾…æ—¶é—´æé«˜ååï¼Œå¦‚æœå¤šä¸ªè¯·æ±‚èƒ½åœ¨åŒä¸€ä¸ªTCPåˆ†èŠ‚å‘é€çš„è¯ï¼Œè¿˜èƒ½æé«˜ç½‘ç»œåˆ©ç”¨ç‡ï¼Œæµç¨‹å¦‚å›¾ï¼š\nåŒä¸€ä¸ªtcpè¿æ¥ä¸­å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªhttpè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯å¹¶å‘ï¼Œä½†æ˜¯åœ¨å“åº”çš„æ—¶å€™ï¼Œå¿…é¡»æ’é˜Ÿå“åº”ï¼Œè°å…ˆåˆ°è¾¾çš„è°å…ˆå“åº”ï¼Œç›¸æ¯”ä¸æ”¯æŒç®¡é“åŒ–çš„httpè¯·æ±‚ç¡®å®æé«˜äº†æ•ˆç‡ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å±€é™æ€§ï¼Œå‡å¦‚å…¶ä¸­æŸä¸ªå“åº”å› ä¸ºæŸç§åŸå› å»¶è¿Ÿäº†å‡ ç§’ï¼Œåé¢çš„å“åº”éƒ½ä¼šè¢«é˜»å¡ã€‚ä¸Šé¢ç®­å¤´æ‰€æŒ‡çš„å“åº”å¦‚æœé˜»å¡äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªä¹Ÿæ˜¯é˜Ÿå¤´é˜»å¡ã€‚\nå¹¶ä¸”ä½¿ç”¨HTTPç®¡é“åŒ–è¿˜æœ‰ä¸€äº›é™åˆ¶:\n1ã€ç®¡é“åŒ–è¦æ±‚æœåŠ¡ç«¯æŒ‰ç…§è¯·æ±‚å‘é€çš„é¡ºåºè¿”å›å“åº”ï¼ˆFIFOï¼‰ï¼ŒåŸå› å¾ˆç®€å•ï¼ŒHTTPè¯·æ±‚å’Œå“åº”å¹¶æ²¡æœ‰åºå·æ ‡è¯†ï¼Œæ— æ³•å°†ä¹±åºçš„å“åº”ä¸è¯·æ±‚å…³è”èµ·æ¥ã€‚\n2ã€å½“å®¢æˆ·ç«¯åœ¨æ”¯æŒç®¡é“åŒ–æ—¶éœ€è¦ä¿æŒæœªæ”¶åˆ°å“åº”çš„è¯·æ±‚ï¼Œå½“è¿æ¥æ„å¤–ä¸­æ–­æ—¶ï¼Œéœ€è¦é‡æ–°å‘é€è¿™éƒ¨åˆ†è¯·æ±‚ã€‚å¦‚æœè¿™ä¸ªè¯·æ±‚åªæ˜¯ä»æœåŠ¡å™¨è·å–æ•°æ®ï¼Œé‚£ä¹ˆå¹¶ä¸ä¼šå¯¹èµ„æºé€ æˆä»»ä½•å½±å“ï¼Œè€Œå¦‚æœæ˜¯ä¸€ä¸ªæäº¤ä¿¡æ¯çš„è¯·æ±‚å¦‚postè¯·æ±‚ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šé€ æˆèµ„æºå¤šæ¬¡æäº¤ä»è€Œæ”¹å˜èµ„æºï¼Œè¿™æ˜¯ä¸å…è®¸çš„ã€‚è€Œä¸ä¼šå¯¹æœåŠ¡å™¨èµ„æºäº§ç”Ÿå½±å“çš„è¯·æ±‚æœ‰ä¸ªä¸“ä¸šåè¯å«åšå¹‚ç­‰è¯·æ±‚ã€‚å®¢æˆ·ç«¯åœ¨ä½¿ç”¨ç®¡é“åŒ–çš„æ—¶å€™è¯·æ±‚æ–¹å¼å¿…é¡»æ˜¯å¹‚ç­‰è¯·æ±‚ã€‚\næ¯”è¾ƒï¼š\nä¸Šé¢çš„ç®¡çº¿åŒ–çš„æ¨¡å‹å°±æ˜¯åŠ é€Ÿäº†è¯·æ±‚çš„è¿‡ç¨‹ï¼Œä½†æ˜¯å“åº”çš„è¿‡ç¨‹è¿˜æ˜¯å­˜åœ¨é˜Ÿå¤´é˜»å¡ã€‚\n å› ä¸ºHTTPç®¡é“åŒ–æœ¬èº«å¯èƒ½ä¼šå¯¼è‡´é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ï¼Œä»¥åŠä¸Šé¢æåˆ°çš„ä¸€äº›é™åˆ¶ï¼Œç°ä»£æµè§ˆå™¨é»˜è®¤éƒ½å…³é—­äº†ç®¡é“åŒ–ï¼Œå¹¶ä¸”å¤§éƒ¨åˆ†æœåŠ¡å™¨ä¹Ÿæ˜¯é»˜è®¤ä¸æ”¯æŒç®¡é“åŒ–çš„ã€‚\n å¦‚ä½•è§£å†³é˜Ÿå¤´é˜»å¡ï¼Ÿ\nå®¢æˆ·ç«¯ä½¿ç”¨å¹¶å‘é•¿è¿æ¥ï¼Œæ³¨æ„è¿™ä¸ªå¹¶å‘æŒ‡çš„æ˜¯tcpå¹¶å‘è¿æ¥ã€‚\n å¹¶å‘é•¿è¿æ¥è™½ç„¶åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†httpçš„é˜Ÿå¤´é˜»å¡ï¼Œä½†æ˜¯ä¼šå¯¹æœåŠ¡å™¨çš„æ€§èƒ½æœ‰è¾ƒé«˜çš„è¦æ±‚\n HTTP/2  HTTP/1.1 ç‰ˆçš„å¤´ä¿¡æ¯è‚¯å®šæ˜¯æ–‡æœ¬ï¼ˆASCIIç¼–ç ï¼‰ï¼Œæ•°æ®ä½“å¯ä»¥æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯äºŒè¿›åˆ¶ã€‚HTTP/2 åˆ™æ˜¯ä¸€ä¸ªå½»åº•çš„äºŒè¿›åˆ¶åè®®ï¼Œå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”ç»Ÿç§°ä¸º\u0026quot;å¸§\u0026rdquo;ï¼ˆframeï¼‰ï¼šå¤´ä¿¡æ¯å¸§å’Œæ•°æ®å¸§ã€‚\n ğŸ˜† HTTP/2 æ²¡æœ‰æ”¹åŠ¨ HTTP çš„åº”ç”¨è¯­ä¹‰ã€‚ HTTP æ–¹æ³•ã€çŠ¶æ€ä»£ç ã€URI å’Œæ ‡å¤´å­—æ®µç­‰æ ¸å¿ƒæ¦‚å¿µä¸€å¦‚å¾€å¸¸ã€‚ ä¸è¿‡ï¼ŒHTTP/2 ä¿®æ”¹äº†æ•°æ®æ ¼å¼åŒ–ï¼ˆåˆ†å¸§ï¼‰ä»¥åŠåœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é—´ä¼ è¾“çš„æ–¹å¼ã€‚è¿™ä¸¤ç‚¹ç»Ÿå¸…å…¨å±€ï¼Œé€šè¿‡æ–°çš„åˆ†å¸§å±‚å‘æˆ‘ä»¬çš„åº”ç”¨éšè—äº†æ‰€æœ‰å¤æ‚æ€§ã€‚ å› æ­¤ï¼Œæ‰€æœ‰ç°æœ‰çš„åº”ç”¨éƒ½å¯ä»¥ä¸å¿…ä¿®æ”¹è€Œåœ¨æ–°åè®®ä¸‹è¿è¡Œã€‚\n ä¸ºä»€ä¹ˆä¸æ˜¯ HTTP/1.2ï¼Ÿ\nä¸ºäº†å®ç° HTTP å·¥ä½œç»„è®¾å®šçš„æ€§èƒ½ç›®æ ‡ï¼ŒHTTP/2 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚ï¼Œè¯¥å±‚æ— æ³•ä¸ä¹‹å‰çš„ HTTP/1.x æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å‘åå…¼å®¹ï¼Œå› æ­¤åè®®çš„ä¸»ç‰ˆæœ¬æå‡åˆ° HTTP/2ã€‚\n äºŒè¿›åˆ¶åˆ†å¸§å±‚ HTTP/2 æ‰€æœ‰æ€§èƒ½å¢å¼ºçš„æ ¸å¿ƒåœ¨äºæ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•å°è£… HTTP æ¶ˆæ¯å¹¶åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“ã€‚\nè¿™é‡Œæ‰€è°“çš„â€œå±‚â€ï¼ŒæŒ‡çš„æ˜¯ä½äºå¥—æ¥å­—æ¥å£ä¸åº”ç”¨å¯è§çš„é«˜çº§ HTTP API ä¹‹é—´ä¸€ä¸ªç»è¿‡ä¼˜åŒ–çš„æ–°ç¼–ç æœºåˆ¶ï¼šHTTP çš„è¯­ä¹‰ï¼ˆåŒ…æ‹¬å„ç§åŠ¨è¯ã€æ–¹æ³•ã€æ ‡å¤´ï¼‰éƒ½ä¸å—å½±å“ï¼Œä¸åŒçš„æ˜¯ä¼ è¾“æœŸé—´å¯¹å®ƒä»¬çš„ç¼–ç æ–¹å¼å˜äº†ã€‚ HTTP/1.x åè®®ä»¥æ¢è¡Œç¬¦ä½œä¸ºçº¯æ–‡æœ¬çš„åˆ†éš”ç¬¦ï¼Œè€Œ HTTP/2 å°†æ‰€æœ‰ä¼ è¾“çš„ä¿¡æ¯åˆ†å‰²ä¸ºæ›´å°çš„æ¶ˆæ¯å’Œå¸§ï¼Œå¹¶é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼å¯¹å®ƒä»¬ç¼–ç ã€‚\næ•°æ®æµã€æ¶ˆæ¯å’Œå¸§  æ•°æ®æµï¼šå·²å»ºç«‹çš„è¿æ¥å†…çš„åŒå‘å­—èŠ‚æµï¼Œå¯ä»¥æ‰¿è½½ä¸€æ¡æˆ–å¤šæ¡æ¶ˆæ¯ã€‚ æ¶ˆæ¯ï¼šä¸é€»è¾‘è¯·æ±‚æˆ–å“åº”æ¶ˆæ¯å¯¹åº”çš„å®Œæ•´çš„ä¸€ç³»åˆ—å¸§ã€‚ å¸§ï¼šHTTP/2 é€šä¿¡çš„æœ€å°å•ä½ï¼Œæ¯ä¸ªå¸§éƒ½åŒ…å«å¸§å¤´ï¼Œè‡³å°‘ä¹Ÿä¼šæ ‡è¯†å‡ºå½“å‰å¸§æ‰€å±çš„æ•°æ®æµã€‚  å…³ç³»ï¼š\n æ‰€æœ‰é€šä¿¡éƒ½åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸Šå®Œæˆï¼Œæ­¤è¿æ¥å¯ä»¥æ‰¿è½½ä»»æ„æ•°é‡çš„åŒå‘æ•°æ®æµã€‚(å¤šå·¥) æ¯ä¸ªæ•°æ®æµéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦å’Œå¯é€‰çš„ä¼˜å…ˆçº§ä¿¡æ¯ï¼Œç”¨äºæ‰¿è½½åŒå‘æ¶ˆæ¯ã€‚ æ¯æ¡æ¶ˆæ¯éƒ½æ˜¯ä¸€æ¡é€»è¾‘ HTTP æ¶ˆæ¯ï¼ˆä¾‹å¦‚è¯·æ±‚æˆ–å“åº”ï¼‰ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå¸§ã€‚ å¸§æ˜¯æœ€å°çš„é€šä¿¡å•ä½ï¼Œæ‰¿è½½ç€ç‰¹å®šç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚ HTTP æ ‡å¤´ã€æ¶ˆæ¯è´Ÿè½½ç­‰ç­‰ã€‚ æ¥è‡ªä¸åŒæ•°æ®æµçš„å¸§å¯ä»¥äº¤é”™å‘é€ï¼Œç„¶åå†æ ¹æ®æ¯ä¸ªå¸§å¤´çš„æ•°æ®æµæ ‡è¯†ç¬¦é‡æ–°ç»„è£…ã€‚  ç®€è¨€ä¹‹ï¼ŒHTTP/2 å°† HTTP åè®®é€šä¿¡åˆ†è§£ä¸ºäºŒè¿›åˆ¶ç¼–ç å¸§çš„äº¤æ¢ï¼Œè¿™äº›å¸§å¯¹åº”ç€ç‰¹å®šæ•°æ®æµä¸­çš„æ¶ˆæ¯ã€‚æ‰€æœ‰è¿™äº›éƒ½åœ¨ä¸€ä¸ª TCP è¿æ¥å†…å¤ç”¨ã€‚ è¿™æ˜¯ HTTP/2 åè®®æ‰€æœ‰å…¶ä»–åŠŸèƒ½å’Œæ€§èƒ½ä¼˜åŒ–çš„åŸºç¡€ã€‚\nHTTP/2 å¸§ç»“æ„å¦‚ä¸‹ï¼š\nå®é™…çš„ä¼ è¾“è¿‡ç¨‹å¯èƒ½æ˜¯ä¸‹é¢è¿™æ ·(ååé‡å¢å¤§)ï¼š\nè¯·æ±‚ä¸å“åº”å¤ç”¨ HTTP/2 ä¸­æ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚å®ç°äº†å®Œæ•´çš„è¯·æ±‚å’Œå“åº”å¤ç”¨ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥å°† HTTP æ¶ˆæ¯åˆ†è§£ä¸ºäº’ä¸ä¾èµ–çš„å¸§ï¼Œç„¶åäº¤é”™å‘é€ï¼Œæœ€åå†åœ¨å¦ä¸€ç«¯æŠŠå®ƒä»¬é‡æ–°ç»„è£…èµ·æ¥ã€‚\næ•°æ®æµä¼˜å…ˆçº§ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸Šå›¾ä¸­çš„å‡ ä¸ªæ“ä½œç¤ºä¾‹ã€‚ ä»å·¦åˆ°å³ä¾æ¬¡ä¸ºï¼š\n æ•°æ®æµ A å’Œæ•°æ®æµ B éƒ½æ²¡æœ‰æŒ‡å®šçˆ¶ä¾èµ–é¡¹ï¼Œä¾èµ–äºéšå¼â€œæ ¹æ•°æ®æµâ€ï¼›A çš„æƒé‡ä¸º 12ï¼ŒB çš„æƒé‡ä¸º 4ã€‚å› æ­¤ï¼Œæ ¹æ®æ¯”ä¾‹æƒé‡ï¼šæ•°æ®æµ B è·å¾—çš„èµ„æºæ˜¯ A æ‰€è·èµ„æºçš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ æ•°æ®æµ D ä¾èµ–äºæ ¹æ•°æ®æµï¼›C ä¾èµ–äº Dã€‚ å› æ­¤ï¼ŒD åº”å…ˆäº C è·å¾—å®Œæ•´èµ„æºåˆ†é…ã€‚ æƒé‡ä¸é‡è¦ï¼Œå› ä¸º C çš„ä¾èµ–å…³ç³»æ‹¥æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚ æ•°æ®æµ D åº”å…ˆäº C è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›C åº”å…ˆäº A å’Œ B è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›æ•°æ®æµ B è·å¾—çš„èµ„æºæ˜¯ A æ‰€è·èµ„æºçš„ä¸‰åˆ†ä¹‹ä¸€ã€‚ æ•°æ®æµ D åº”å…ˆäº E å’Œ C è·å¾—å®Œæ•´èµ„æºåˆ†é…ï¼›E å’Œ C åº”å…ˆäº A å’Œ B è·å¾—ç›¸åŒçš„èµ„æºåˆ†é…ï¼›A å’Œ B åº”åŸºäºå…¶æƒé‡è·å¾—æ¯”ä¾‹åˆ†é…ã€‚  æµæ§åˆ¶ æµæ§åˆ¶æ˜¯ä¸€ç§é˜»æ­¢å‘é€æ–¹å‘æ¥æ”¶æ–¹å‘é€å¤§é‡æ•°æ®çš„æœºåˆ¶ï¼Œä»¥å…è¶…å‡ºåè€…çš„éœ€æ±‚æˆ–å¤„ç†èƒ½åŠ›ï¼šå‘é€æ–¹å¯èƒ½éå¸¸ç¹å¿™ã€å¤„äºè¾ƒé«˜çš„è´Ÿè½½ä¹‹ä¸‹ï¼Œä¹Ÿå¯èƒ½ä»…ä»…å¸Œæœ›ä¸ºç‰¹å®šæ•°æ®æµåˆ†é…å›ºå®šé‡çš„èµ„æºã€‚ ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯å¯èƒ½è¯·æ±‚äº†ä¸€ä¸ªå…·æœ‰è¾ƒé«˜ä¼˜å…ˆçº§çš„å¤§å‹è§†é¢‘æµï¼Œä½†æ˜¯ç”¨æˆ·å·²ç»æš‚åœè§†é¢‘ï¼Œå®¢æˆ·ç«¯ç°åœ¨å¸Œæœ›æš‚åœæˆ–é™åˆ¶ä»æœåŠ¡å™¨çš„ä¼ è¾“ï¼Œä»¥å…æå–å’Œç¼“å†²ä¸å¿…è¦çš„æ•°æ®ã€‚ å†æ¯”å¦‚ï¼Œä¸€ä¸ªä»£ç†æœåŠ¡å™¨å¯èƒ½å…·æœ‰è¾ƒå¿«çš„ä¸‹æ¸¸è¿æ¥å’Œè¾ƒæ…¢çš„ä¸Šæ¸¸è¿æ¥ï¼Œå¹¶ä¸”ä¹Ÿå¸Œæœ›è°ƒèŠ‚ä¸‹æ¸¸è¿æ¥ä¼ è¾“æ•°æ®çš„é€Ÿåº¦ä»¥åŒ¹é…ä¸Šæ¸¸è¿æ¥çš„é€Ÿåº¦æ¥æ§åˆ¶å…¶èµ„æºåˆ©ç”¨ç‡ï¼›ç­‰ç­‰ã€‚ç±»ä¼¼TCPæµé‡æ§åˆ¶ã€‚\næœåŠ¡å™¨æ¨é€ HTTP/2 æ–°å¢çš„å¦ä¸€ä¸ªå¼ºå¤§çš„æ–°åŠŸèƒ½æ˜¯ï¼ŒæœåŠ¡å™¨å¯ä»¥å¯¹ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚å‘é€å¤šä¸ªå“åº”ã€‚ æ¢å¥è¯è¯´ï¼Œé™¤äº†å¯¹æœ€åˆè¯·æ±‚çš„å“åº”å¤–ï¼ŒæœåŠ¡å™¨è¿˜å¯ä»¥å‘å®¢æˆ·ç«¯æ¨é€é¢å¤–èµ„æºï¼ˆå›¾ 12-5ï¼‰ï¼Œè€Œæ— éœ€å®¢æˆ·ç«¯æ˜ç¡®åœ°è¯·æ±‚ã€‚\næ ‡å¤´å‹ç¼© æ¯ä¸ª HTTP ä¼ è¾“éƒ½æ‰¿è½½ä¸€ç»„æ ‡å¤´ï¼Œè¿™äº›æ ‡å¤´è¯´æ˜äº†ä¼ è¾“çš„èµ„æºåŠå…¶å±æ€§ã€‚ åœ¨ HTTP/1.x ä¸­ï¼Œæ­¤å…ƒæ•°æ®å§‹ç»ˆä»¥çº¯æ–‡æœ¬å½¢å¼ï¼Œé€šå¸¸ä¼šç»™æ¯ä¸ªä¼ è¾“å¢åŠ  500â€“800 å­—èŠ‚çš„å¼€é”€ã€‚å¦‚æœä½¿ç”¨ HTTP Cookieï¼Œå¢åŠ çš„å¼€é”€æœ‰æ—¶ä¼šè¾¾åˆ°ä¸Šåƒå­—èŠ‚ã€‚ä¸ºäº†å‡å°‘æ­¤å¼€é”€å’Œæå‡æ€§èƒ½ï¼ŒHTTP/2 ä½¿ç”¨ HPACK å‹ç¼©æ ¼å¼å‹ç¼©è¯·æ±‚å’Œå“åº”æ ‡å¤´å…ƒæ•°æ®ï¼Œè¿™ç§æ ¼å¼é‡‡ç”¨ä¸¤ç§ç®€å•ä½†æ˜¯å¼ºå¤§çš„æŠ€æœ¯ï¼š\n è¿™ç§æ ¼å¼æ”¯æŒé€šè¿‡é™æ€éœå¤«æ›¼ä»£ç å¯¹ä¼ è¾“çš„æ ‡å¤´å­—æ®µè¿›è¡Œç¼–ç ï¼Œä»è€Œå‡å°äº†å„ä¸ªä¼ è¾“çš„å¤§å°ã€‚ è¿™ç§æ ¼å¼è¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ—¶ç»´æŠ¤å’Œæ›´æ–°ä¸€ä¸ªåŒ…å«ä¹‹å‰è§è¿‡çš„æ ‡å¤´å­—æ®µçš„ç´¢å¼•åˆ—è¡¨ï¼ˆæ¢å¥è¯è¯´ï¼Œå®ƒå¯ä»¥å»ºç«‹ä¸€ä¸ªå…±äº«çš„å‹ç¼©ä¸Šä¸‹æ–‡ï¼‰ï¼Œæ­¤åˆ—è¡¨éšåä¼šç”¨ä½œå‚è€ƒï¼Œå¯¹ä¹‹å‰ä¼ è¾“çš„å€¼è¿›è¡Œæœ‰æ•ˆç¼–ç ã€‚  åˆ©ç”¨éœå¤«æ›¼ç¼–ç ï¼Œå¯ä»¥åœ¨ä¼ è¾“æ—¶å¯¹å„ä¸ªå€¼è¿›è¡Œå‹ç¼©ï¼Œè€Œåˆ©ç”¨ä¹‹å‰ä¼ è¾“å€¼çš„ç´¢å¼•åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ è¾“ç´¢å¼•å€¼çš„æ–¹å¼å¯¹é‡å¤å€¼è¿›è¡Œç¼–ç ï¼Œç´¢å¼•å€¼å¯ç”¨äºæœ‰æ•ˆæŸ¥è¯¢å’Œé‡æ„å®Œæ•´çš„æ ‡å¤´é”®å€¼å¯¹ã€‚\nå“ˆå¤«æ›¼æ ‘å¦‚ä½•å‹ç¼© æ–‡ä»¶å‹ç¼©çš„ä¸»è¦æ€æƒ³æ˜¯åˆ©ç”¨å“ˆå¤«æ›¼ç¼–ç æ¥å®ç°çš„ï¼Œä½†æ˜¯å¾—åˆ°ç¼–ç ä¹‹å‰æˆ‘ä»¬éœ€è¦æ„å»ºè¿™æ£µæ ‘ã€‚é‚£ä¹ˆåˆ©ç”¨ä»€ä¹ˆæ¥æ„å»ºæ ‘å‘¢ï¼Ÿï¼è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°ï¼Œç”¨æ¬¡æ•°æ¥æ„å»ºHuffmanTreeã€‚å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ª.txtçš„å°æ–‡ä»¶ï¼Œå†…å®¹æ˜¯\u0026quot;aaaabbbccd\u0026rdquo;ã€‚å­—ç¬¦å­˜åœ¨è®¡ç®—æœºä¸­æ—¶ä»¥å­—èŠ‚ä¸ºå•ä½çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†è¿™äº›å­—ç¬¦å‹ç¼©æˆ0ã€1è¡¨ç¤ºçš„ç¼–ç ï¼Œ0å’Œ1è¡¨ç¤ºå­—èŠ‚ä¸­çš„â€œä½â€ï¼Œè¿™æ ·èƒ½å¤§å¤§é™ä½æ–‡ä»¶çš„å¤§å°ã€‚\nä½“éªŒHTTP2 https://http2.akamai.com/demo\nå‚è€ƒé“¾æ¥ï¼š\n HTTP è¿æ¥ç®¡ç†è¿›åŒ–è®º https://developers.google.com/web/fundamentals/performance/http2?hl=zh-cn ç™½è¯httpé˜Ÿå¤´é˜»å¡  HTTPSè¯¦è§£ ä»€ä¹ˆæ˜¯HTTPSï¼Ÿ HTTPSæ˜¯åœ¨HTTPä¸Šå»ºç«‹SSLåŠ å¯†å±‚ï¼Œå¹¶å¯¹ä¼ è¾“æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œæ˜¯HTTPåè®®çš„å®‰å…¨ç‰ˆã€‚ç°åœ¨å®ƒè¢«å¹¿æ³›ç”¨äºä¸‡ç»´ç½‘ä¸Šå®‰å…¨æ•æ„Ÿçš„é€šè®¯ï¼Œä¾‹å¦‚äº¤æ˜“æ”¯ä»˜æ–¹é¢ã€‚\nHTTPåè®®å­˜åœ¨çš„é—®é¢˜ï¼Ÿ  é€šä¿¡ä½¿ç”¨æ˜æ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½è¢«çªƒå¬ æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥å¯èƒ½é­ç¯¡æ”¹ ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡ä¼ªè£…  HTTPSçš„ä¼˜åŠ¿ï¼Ÿ  æ•°æ®éšç§æ€§ï¼šå†…å®¹ç»è¿‡å¯¹ç§°åŠ å¯†ï¼Œæ¯ä¸ªè¿æ¥ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„åŠ å¯†å¯†é’¥ æ•°æ®å®Œæ•´æ€§ï¼šå†…å®¹ä¼ è¾“ç»è¿‡å®Œæ•´æ€§æ ¡éªŒ èº«ä»½è®¤è¯ï¼šç¬¬ä¸‰æ–¹æ— æ³•ä¼ªé€ æœåŠ¡ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰èº«ä»½  HTTPSåè®® HTTPSå¹¶éæ˜¯åº”ç”¨å±‚çš„ä¸€ç§æ–°åè®®ã€‚åªæ˜¯HTTPé€šä¿¡æ¥å£éƒ¨åˆ†ç”¨SSLå’ŒTLSåè®®ä»£æ›¿è€Œå·²ã€‚\né€šå¸¸ï¼ŒHTTPç›´æ¥å’ŒTCPé€šä¿¡ã€‚å½“ä½¿ç”¨SSLæ—¶ï¼Œåˆ™æ¼”å˜æˆå…ˆå’ŒSSLé€šä¿¡ï¼Œå†ç”±SSLå’ŒTCPé€šä¿¡äº†ã€‚ç®€è¨€ä¹‹ï¼Œæ‰€è°“HTTPSï¼Œå…¶å®å°±æ˜¯èº«æŠ«SSLåè®®è¿™å±‚å¤–å£³çš„HTTPã€‚\nåœ¨é‡‡ç”¨SSLåï¼ŒHTTPå°±æ‹¥æœ‰äº†HTTPSçš„åŠ å¯†ã€è¯ä¹¦å’Œå®Œæ•´æ€§ä¿æŠ¤è¿™äº›åŠŸèƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´HTTPåŠ ä¸ŠåŠ å¯†å¤„ç†å’Œè®¤è¯ä»¥åŠå®Œæ•´æ€§ä¿æŠ¤åå³æ˜¯HTTPSã€‚\nHTTPS åè®®çš„ä¸»è¦åŠŸèƒ½åŸºæœ¬éƒ½ä¾èµ–äº TLS/SSL åè®®ï¼ŒTLS/SSL çš„åŠŸèƒ½å®ç°ä¸»è¦ä¾èµ–äºä¸‰ç±»åŸºæœ¬ç®—æ³•ï¼šæ•£åˆ—å‡½æ•° ã€å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Œå…¶åˆ©ç”¨éå¯¹ç§°åŠ å¯†å®ç°èº«ä»½è®¤è¯å’Œå¯†é’¥åå•†ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†çš„å¯†é’¥å¯¹æ•°æ®åŠ å¯†ï¼ŒåŸºäºæ•£åˆ—å‡½æ•°éªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§ã€‚\næ•°å­—è¯ä¹¦ æ•°å­—è¯ä¹¦è®¤è¯æœºæ„å¤„äºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨åŒæ–¹éƒ½å¯ä¿¡èµ–çš„ç¬¬ä¸‰æ–¹æœºæ„çš„ç«‹åœºä¸Šã€‚\næ•°å­—è¯ä¹¦è®¤è¯æœºæ„çš„ä¸šåŠ¡æµç¨‹ï¼š\n æœåŠ¡å™¨çš„è¿è¥äººå‘˜å‘ç¬¬ä¸‰æ–¹æœºæ„CAæäº¤å…¬é’¥ã€ç»„ç»‡ä¿¡æ¯ã€ä¸ªäººä¿¡æ¯(åŸŸå)ç­‰ä¿¡æ¯å¹¶ç”³è¯·è®¤è¯; CAé€šè¿‡çº¿ä¸Šã€çº¿ä¸‹ç­‰å¤šç§æ‰‹æ®µéªŒè¯ç”³è¯·è€…æä¾›ä¿¡æ¯çš„çœŸå®æ€§ï¼Œå¦‚ç»„ç»‡æ˜¯å¦å­˜åœ¨ã€ä¼ä¸šæ˜¯å¦åˆæ³•ï¼Œæ˜¯å¦æ‹¥æœ‰åŸŸåçš„æ‰€æœ‰æƒç­‰; å¦‚ä¿¡æ¯å®¡æ ¸é€šè¿‡ï¼ŒCAä¼šå‘ç”³è¯·è€…ç­¾å‘è®¤è¯æ–‡ä»¶-è¯ä¹¦ã€‚è¯ä¹¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼šç”³è¯·è€…å…¬é’¥ã€ç”³è¯·è€…çš„ç»„ç»‡ä¿¡æ¯å’Œä¸ªäººä¿¡æ¯ã€ç­¾å‘æœºæ„ CAçš„ä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ã€è¯ä¹¦åºåˆ—å·ç­‰ä¿¡æ¯çš„æ˜æ–‡ï¼ŒåŒæ—¶åŒ…å«ä¸€ä¸ªç­¾åã€‚ å…¶ä¸­ç­¾åçš„äº§ç”Ÿç®—æ³•ï¼šé¦–å…ˆï¼Œä½¿ç”¨æ•£åˆ—å‡½æ•°è®¡ç®—å…¬å¼€çš„æ˜æ–‡ä¿¡æ¯çš„ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œé‡‡ç”¨ CAçš„ç§é’¥å¯¹ä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼Œå¯†æ–‡å³ç­¾å; å®¢æˆ·ç«¯ Client å‘æœåŠ¡å™¨ Server å‘å‡ºè¯·æ±‚æ—¶ï¼ŒServer è¿”å›è¯ä¹¦æ–‡ä»¶; å®¢æˆ·ç«¯ Client è¯»å–è¯ä¹¦ä¸­çš„ç›¸å…³çš„æ˜æ–‡ä¿¡æ¯ï¼Œé‡‡ç”¨ç›¸åŒçš„æ•£åˆ—å‡½æ•°è®¡ç®—å¾—åˆ°ä¿¡æ¯æ‘˜è¦ï¼Œç„¶åï¼Œåˆ©ç”¨å¯¹åº” CAçš„å…¬é’¥è§£å¯†ç­¾åæ•°æ®ï¼Œå¯¹æ¯”è¯ä¹¦çš„ä¿¡æ¯æ‘˜è¦ï¼Œå¦‚æœä¸€è‡´ï¼Œåˆ™å¯ä»¥ç¡®è®¤è¯ä¹¦çš„åˆæ³•æ€§ï¼Œå³æœåŠ¡å™¨çš„å…¬å¼€å¯†é’¥æ˜¯å€¼å¾—ä¿¡èµ–çš„ã€‚ å®¢æˆ·ç«¯è¿˜ä¼šéªŒè¯è¯ä¹¦ç›¸å…³çš„åŸŸåä¿¡æ¯ã€æœ‰æ•ˆæ—¶é—´ç­‰ä¿¡æ¯; å®¢æˆ·ç«¯ä¼šå†…ç½®ä¿¡ä»»CAçš„è¯ä¹¦ä¿¡æ¯(åŒ…å«å…¬é’¥)ï¼Œå¦‚æœCAä¸è¢«ä¿¡ä»»ï¼Œåˆ™æ‰¾ä¸åˆ°å¯¹åº” CAçš„è¯ä¹¦ï¼Œè¯ä¹¦ä¹Ÿä¼šè¢«åˆ¤å®šéæ³•ã€‚  HTTPSå·¥ä½œæµç¨‹   Clientå‘èµ·ä¸€ä¸ªHTTPSï¼ˆæ¯”å¦‚https://juejin.im/user/5a9a9cdcf265da238b7d771cï¼‰çš„è¯·æ±‚ï¼Œæ ¹æ®RFC2818çš„è§„å®šï¼ŒClientçŸ¥é“éœ€è¦è¿æ¥Serverçš„443ï¼ˆé»˜è®¤ï¼‰ç«¯å£ã€‚\n  ServeræŠŠäº‹å…ˆé…ç½®å¥½çš„å…¬é’¥è¯ä¹¦ï¼ˆpublic key certificateï¼‰è¿”å›ç»™å®¢æˆ·ç«¯ã€‚\n  ClientéªŒè¯å…¬é’¥è¯ä¹¦ï¼šæ¯”å¦‚æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…ï¼Œè¯ä¹¦çš„ç”¨é€”æ˜¯ä¸æ˜¯åŒ¹é…Clientè¯·æ±‚çš„ç«™ç‚¹ï¼Œæ˜¯ä¸æ˜¯åœ¨CRLåŠé”€åˆ—è¡¨é‡Œé¢ï¼Œå®ƒçš„ä¸Šä¸€çº§è¯ä¹¦æ˜¯å¦æœ‰æ•ˆï¼Œè¿™æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œç›´åˆ°éªŒè¯åˆ°æ ¹è¯ä¹¦ï¼ˆæ“ä½œç³»ç»Ÿå†…ç½®çš„Rootè¯ä¹¦æˆ–è€…Clientå†…ç½®çš„Rootè¯ä¹¦ï¼‰ã€‚å¦‚æœéªŒè¯é€šè¿‡åˆ™ç»§ç»­ï¼Œä¸é€šè¿‡åˆ™æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ã€‚\n  Clientä½¿ç”¨ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ç”ŸæˆåŠ å¯†æ‰€ä½¿ç”¨çš„å¯¹ç§°å¯†é’¥ï¼Œç„¶åç”¨è¯ä¹¦çš„å…¬é’¥åŠ å¯†è¿™ä¸ªå¯¹ç§°å¯†é’¥ï¼Œå‘ç»™Serverã€‚\n  Serverä½¿ç”¨è‡ªå·±çš„ç§é’¥ï¼ˆprivate keyï¼‰è§£å¯†è¿™ä¸ªæ¶ˆæ¯ï¼Œå¾—åˆ°å¯¹ç§°å¯†é’¥ã€‚è‡³æ­¤ï¼ŒClientå’ŒServeråŒæ–¹éƒ½æŒæœ‰äº†ç›¸åŒçš„å¯¹ç§°å¯†é’¥ã€‚\n  Serverä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†â€œæ˜æ–‡å†…å®¹Aâ€ï¼Œå‘é€ç»™Clientã€‚\n  Clientä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å“åº”çš„å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹Aâ€ã€‚\n  Clientå†æ¬¡å‘èµ·HTTPSçš„è¯·æ±‚ï¼Œä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†è¯·æ±‚çš„â€œæ˜æ–‡å†…å®¹Bâ€ï¼Œç„¶åServerä½¿ç”¨å¯¹ç§°å¯†é’¥è§£å¯†å¯†æ–‡ï¼Œå¾—åˆ°â€œæ˜æ–‡å†…å®¹Bâ€ã€‚\n  å‚è€ƒï¼š\n HTTPSçš„å®‰å…¨åŸç†  è™šæ‹ŸIPåŸç† è™šæ‹ŸIPæŠ€æœ¯ã€‚è™šæ‹ŸIPï¼Œå°±æ˜¯ä¸€ä¸ªæœªåˆ†é…ç»™çœŸå®ä¸»æœºçš„IPï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹å¤–æä¾›æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºé™¤äº†æœ‰ä¸€ä¸ªçœŸå®IPå¤–è¿˜æœ‰ä¸€ä¸ªè™šIPï¼Œä½¿ç”¨è¿™ä¸¤ä¸ªIPä¸­çš„ä»»æ„ä¸€ä¸ªéƒ½å¯ä»¥è¿æ¥åˆ°è¿™å°ä¸»æœºï¼Œæ‰€æœ‰é¡¹ç›®ä¸­æ•°æ®åº“é“¾æ¥ä¸€é¡¹é…ç½®çš„éƒ½æ˜¯è¿™ä¸ªè™šIPï¼Œå½“æœåŠ¡å™¨å‘ç”Ÿæ•…éšœæ— æ³•å¯¹å¤–æä¾›æœåŠ¡æ—¶ï¼ŒåŠ¨æ€å°†è¿™ä¸ªè™šIPåˆ‡æ¢åˆ°å¤‡ç”¨ä¸»æœºã€‚\nå…¶å®ç°åŸç†ä¸»è¦æ˜¯é  TCP/IP çš„ ARP åè®®ã€‚å› ä¸ºIPåœ°å€åªæ˜¯ä¸€ä¸ªé€»è¾‘åœ°å€ï¼Œåœ¨ä»¥å¤ªç½‘ä¸­ MAC åœ°å€æ‰æ˜¯çœŸæ­£ç”¨æ¥è¿›è¡Œæ•°æ®ä¼ è¾“çš„ç‰©ç†åœ°å€ï¼Œæ¯å°ä¸»æœºä¸­éƒ½æœ‰ä¸€ä¸ª ARP é«˜é€Ÿç¼“å­˜ï¼Œå­˜å‚¨åŒä¸€ä¸ªç½‘ç»œå†…çš„ IP åœ°å€ä¸ MAC åœ°å€çš„å¯¹åº”å…³ç³»ï¼Œä»¥å¤ªç½‘ä¸­çš„ä¸»æœºå‘é€æ•°æ®æ—¶ä¼šå…ˆä»è¿™ä¸ªç¼“å­˜ä¸­æŸ¥è¯¢ç›®æ ‡ IP å¯¹åº”çš„ MAC åœ°å€ï¼Œä¼šå‘è¿™ä¸ª MAC åœ°å€å‘é€æ•°æ®ã€‚æ“ä½œç³»ç»Ÿä¼šè‡ªåŠ¨ç»´æŠ¤è¿™ä¸ªç¼“å­˜ã€‚è¿™å°±æ˜¯æ•´ä¸ªå®ç°çš„å…³é”®ã€‚\nå‚è€ƒï¼š\n è™šæ‹ŸIPæŠ€æœ¯  ä¼ è¾“å±‚ğŸš™ TCPã€° TCPä¸­æµçš„è§£é‡Š TCPä¸­çš„â€œæµâ€(stream)æŒ‡çš„æ˜¯æµå…¥åˆ°è¿›ç¨‹æˆ–ä»è¿›ç¨‹æµå‡ºçš„å­—èŠ‚åºåˆ—ã€‚â€œé¢å‘å­—èŠ‚æµâ€çš„å«ä¹‰æ˜¯ï¼šè™½ç„¶åº”ç”¨ç¨‹åºå’ŒTCPçš„äº¤äº’æ˜¯ä¸€æ¬¡ä¸€ä¸ªæ•°æ®å—ï¼ˆå¤§å°ä¸ç­‰ï¼‰ï¼Œä½†TCPæŠŠåº”ç”¨ç¨‹åºäº¤ä¸‹æ¥çš„æ•°æ®çœ‹æˆä»…ä»…æ˜¯ä¸€è¿ä¸²çš„æ— ç»“æ„çš„å­—èŠ‚æµã€‚TCPå¹¶ä¸çŸ¥é“æ‰€ä¼ é€çš„å­—èŠ‚æµçš„å«ä¹‰ã€‚TCPä¸ä¿è¯æ¥æ”¶æ–¹åº”ç”¨ç¨‹åºæ‰€æ”¶åˆ°çš„æ•°æ®å—å’Œå‘é€æ–¹åº”ç”¨ç¨‹åºæ‰€å‘å‡ºçš„æ•°æ®å—å…·æœ‰å¯¹åº”å¤§å°çš„å…³ç³»ï¼ˆä¾‹å¦‚ï¼Œå‘é€æ–¹åº”ç”¨ç¨‹åºäº¤ç»™å‘é€æ–¹çš„TCPå…±10ä¸ªæ•°æ®å—ï¼Œä½†æ¥æ”¶æ–¹çš„TCPå¯èƒ½åªç”¨äº†4ä¸ªæ•°æ®å—å°±æŠŠæ”¶åˆ°çš„å­—èŠ‚æµäº¤ä»˜ä¸Šå±‚çš„åº”ç”¨ç¨‹åºï¼‰ã€‚ä½†æ¥æ”¶æ–¹åº”ç”¨ç¨‹åºæ”¶åˆ°çš„å­—èŠ‚æµå¿…é¡»å’Œå‘é€æ–¹åº”ç”¨ç¨‹åºå‘å‡ºçš„å­—èŠ‚æµå®Œå…¨ä¸€æ ·ã€‚å½“ç„¶ï¼Œæ¥æ”¶æ–¹çš„åº”ç”¨ç¨‹åºå¿…é¡»æœ‰èƒ½åŠ›è¯†åˆ«æ”¶åˆ°çš„å­—èŠ‚æµï¼ŒæŠŠå®ƒè¿˜åŸæˆæœ‰æ„ä¹‰çš„åº”ç”¨å±‚æ•°æ®ã€‚\nä¸€ä¸ªç®€å•çš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š\n TCPå’ŒUDPåœ¨å‘é€æŠ¥æ–‡æ—¶æ‰€é‡‡ç”¨çš„æ–¹å¼å®Œå…¨ä¸åŒã€‚TCPå¹¶ä¸å…³å¿ƒåº”ç”¨è¿›ç¨‹ä¸€æ¬¡æŠŠå¤šé•¿çš„æŠ¥æ–‡å‘é€åˆ°TCPçš„ç¼“å­˜ä¸­ï¼Œè€Œæ˜¯æ ¹æ®å¯¹æ–¹ç»™å‡ºçš„çª—å£å€¼å’Œå½“å‰ç½‘ç»œæ‹¥å¡çš„ç¨‹åº¦æ¥å†³å®šä¸€ä¸ªæŠ¥æ–‡æ®µåº”åŒ…å«å¤šå°‘ä¸ªå­—èŠ‚ï¼ˆUDPå‘é€çš„æŠ¥æ–‡é•¿åº¦æ˜¯åº”ç”¨è¿›ç¨‹ç»™å‡ºçš„ï¼‰ã€‚å¦‚æœåº”ç”¨è¿›ç¨‹ä¼ é€åˆ°TCPç¼“å­˜çš„æ•°æ®å—å¤ªé•¿ï¼ŒTCPå°±å¯ä»¥æŠŠå®ƒåˆ’åˆ†çŸ­ä¸€äº›å†ä¼ é€ã€‚å¦‚æœåº”ç”¨è¿›ç¨‹ä¸€æ¬¡åªå‘æ¥ä¸€ä¸ªå­—èŠ‚ï¼ŒTCPä¹Ÿå¯ä»¥ç­‰å¾…ç§¯ç´¯æœ‰è¶³å¤Ÿå¤šçš„å­—èŠ‚åå†æ„æˆæŠ¥æ–‡æ®µå‘é€å‡ºå»\n TCPæŠ¥æ–‡æ ¼å¼ è‹±æ–‡ç‰ˆï¼š\nTCPçš„å›ºå®šåŒ…å¤´ä¸º20ä¸ªå­—èŠ‚ï¼Œä¸‹é¢æ˜¯å‡ ä¸ªå‚æ•°ï¼š\n åºå·ï¼šå³SEQåºå·ã€‚TCPè¿æ¥ä¸­ä¼ é€çš„æ•°æ®æµä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½ç¼–ä¸Šä¸€ä¸ªåºå·ã€‚åºå·å­—æ®µçš„å€¼åˆ™æŒ‡çš„æ˜¯æœ¬æŠ¥æ–‡æ®µæ‰€å‘é€çš„æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ã€‚ ç¡®è®¤å·ï¼šå³ç¡®è®¤åºå·ï¼Œä¹Ÿå«ACKåºå·ã€‚æ˜¯æœŸæœ›æ”¶åˆ°å¯¹æ–¹çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ã€‚åªæœ‰ACKæ ‡å¿—ä½ä¸º1æ—¶ï¼Œç¡®è®¤åºå·å­—æ®µæ‰æœ‰æ•ˆï¼ŒACK=SEQ+1ã€‚ æ•°æ®åç§»ï¼šå®ƒæŒ‡å‡ºTCPæŠ¥æ–‡æ®µçš„æ•°æ®èµ·å§‹å¤„è·ç¦»TCPæŠ¥æ–‡æ®µçš„èµ·å§‹å¤„æœ‰å¤šè¿œã€‚è¯¥å­—æ®µé•¿ 4 ä½ï¼Œå•ä½ä¸º 4 å­—èŠ‚ã€‚è¡¨ç¤ºä¸º TCP é¦–éƒ¨çš„é•¿åº¦ã€‚æ‰€ä»¥ TCP é¦–éƒ¨é•¿åº¦æœ€å¤šä¸º 60 å­—èŠ‚ã€‚ æ ‡å¿—ä½ï¼šå…±6ä¸ªï¼Œå³URG(ç´§æ€¥æ¯”ç‰¹)ã€ACK(ç¡®è®¤æ¯”ç‰¹)ã€PSH(æ¨é€æ¯”ç‰¹)ã€RST(å¤ä½æ¯”ç‰¹)ã€SYN(åŒæ­¥æ¯”ç‰¹)ã€FIN(ç»“æŸæ¯”ç‰¹)ç­‰ã€‚ çª—å£å¤§å°ï¼šçª—å£å­—æ®µç”¨æ¥æ§åˆ¶å¯¹æ–¹å‘é€çš„æ•°æ®é‡ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚TCPè¿æ¥çš„ä¸€ç«¯æ ¹æ®è®¾ç½®çš„ç¼“å­˜ç©ºé—´å¤§å°ç¡®å®šè‡ªå·±çš„æ¥æ”¶çª—å£å¤§å°ï¼Œç„¶åé€šçŸ¥å¯¹æ–¹ä»¥ç¡®å®šå¯¹æ–¹çš„å‘é€çª—å£çš„ä¸Šã€‚ æ ¡éªŒå’Œï¼šæ£€éªŒå’Œå­—æ®µæ£€éªŒçš„èŒƒå›´åŒ…æ‹¬é¦–éƒ¨å’Œæ•°æ®è¿™ä¸¤éƒ¨åˆ†ã€‚åœ¨è®¡ç®—æ£€éªŒå’Œæ—¶ï¼Œè¦åœ¨TCPæŠ¥æ–‡æ®µçš„å‰é¢åŠ ä¸Š12å­—èŠ‚çš„ä¼ªé¦–éƒ¨ã€‚ ç´§æ€¥æŒ‡é’ˆï¼šç´§æ€¥æŒ‡é’ˆæŒ‡å‡ºåœ¨æœ¬æŠ¥æ–‡æ®µä¸­çš„ç´§æ€¥æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·ã€‚ é€‰é¡¹ï¼šTCPåªè§„å®šäº†ä¸€ç§é€‰é¡¹ï¼Œå³æœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦MSSï¼ˆMaximumSegment Sizeï¼‰ã€‚MSSå‘Šè¯‰å¯¹æ–¹TCPï¼šâ€œæˆ‘çš„ç¼“å­˜æ‰€èƒ½æ¥æ”¶çš„æŠ¥æ–‡æ®µçš„æ•°æ®å­—æ®µçš„æœ€å¤§é•¿åº¦æ˜¯MSS ä¸ªå­—èŠ‚ã€‚â€  å‡ ä¸ªæ§åˆ¶ä½ï¼š\n1 2 3 4 5 6 7 8  CWRï¼šç”¨äº IP é¦–éƒ¨çš„ ECN å­—æ®µã€‚ECE ä¸º 1 æ—¶ï¼Œåˆ™é€šçŸ¥å¯¹æ–¹å·²å°†æ‹¥å¡çª—å£ç¼©å°ã€‚ ECEï¼šåœ¨æ”¶åˆ°æ•°æ®åŒ…çš„ IP é¦–éƒ¨ä¸­ ECN ä¸º 1 æ—¶å°† TCP é¦–éƒ¨ä¸­çš„ ECE è®¾ç½®ä¸º 1ï¼Œè¡¨ç¤ºä»å¯¹æ–¹åˆ°è¿™è¾¹çš„ç½‘ç»œæœ‰æ‹¥å¡ã€‚ URGï¼šç´§æ€¥æ¨¡å¼ ACKï¼šç¡®è®¤ PSHï¼šæ¨é€ï¼Œæ¥æ”¶æ–¹åº”å°½å¿«ç»™åº”ç”¨ç¨‹åºä¼ é€è¿™ä¸ªæ•°æ®ã€‚æ²¡ç”¨åˆ° RSTï¼šè¯¥ä½ä¸º 1 è¡¨ç¤º TCP è¿æ¥ä¸­å‡ºç°å¼‚å¸¸å¿…é¡»å¼ºåˆ¶æ–­å¼€è¿æ¥ã€‚ SYNï¼šåˆå§‹åŒ–ä¸€ä¸ªè¿æ¥çš„åŒæ­¥åºåˆ—å· FINï¼šè¯¥ä½ä¸º 1 è¡¨ç¤ºä»Šåä¸ä¼šæœ‰æ•°æ®å‘é€ï¼Œå¸Œæœ›æ–­å¼€è¿æ¥   é€‰é¡¹ï¼ˆOptionsï¼‰ï¼š\nå— Data Offset æ§åˆ¶ï¼Œé•¿åº¦æœ€å¤§ä¸º 40 å­—èŠ‚ã€‚ä¸€èˆ¬ Option çš„æ ¼å¼ä¸º TLV ç»“æ„ï¼š\nå¸¸è§çš„ TCP Options æœ‰ï¼ŒSACK å­—æ®µå°±ä½äºè¯¥é€‰é¡¹ä¸­:\nSACK çš„å·¥ä½œåŸç†\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ æ¥æ”¶æ–¹æ”¶åˆ° 500-699 çš„æ•°æ®åŒ…ï¼Œä½†æ²¡æœ‰æ”¶åˆ° 300-499 çš„æ•°æ®åŒ…å°±ä¼šå› SACK(500-700) ç»™å‘é€ç«¯ï¼Œè¡¨ç¤ºæ”¶åˆ° 500-699 çš„æ•°æ®ã€‚\nä¸‰æ¬¡æ¡æ‰‹ï¼š  ä¸‰æ¬¡æ¡æ‰‹æ˜¯å¿…é¡»çš„â€”â€”TCP éœ€è¦ seq åºåˆ—å·æ¥åšå¯é é‡ä¼ æˆ–æ¥æ”¶ï¼Œè€Œé¿å…è¿æ¥å¤ç”¨æ—¶æ— æ³•åˆ†è¾¨å‡º seq æ˜¯å»¶è¿Ÿæˆ–è€…æ˜¯æ—§é“¾æ¥çš„ seqï¼Œå› æ­¤éœ€è¦ä¸‰æ¬¡æ¡æ‰‹æ¥çº¦å®šç¡®å®šåŒæ–¹çš„ ISNï¼ˆåˆå§‹ seq åºåˆ—å·ï¼‰ã€‚\n å››æ¬¡æŒ¥æ‰‹ å…¶ä¸­Aå‘é€çš„Xä¸ºå‰é¢å·²ä¼ é€è¿‡çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ 1ã€‚\nç¬¬ä¸€æ¬¡Aåˆ°Bæ–¹å‘ç»“æŸï¼Œç¬¬äºŒæ¬¡Båˆ°Aæ–¹å‘ç»“æŸã€‚\nç¬¬äºŒæ¬¡Bå‘é€çš„SEQ=Z(åœ¨åŠå…³é—­çŠ¶æ€Bå¯èƒ½åˆå‘é€äº†ä¸€äº›æ•°æ®),Bè¿˜å¿…é¡»é‡å¤ä¸Šæ¬¡å·²å‘é€è¿‡çš„ç¡®è®¤å·ACK = X+1ã€‚\n è¯·æ³¨æ„ï¼ŒTCPè§„å®šï¼ŒFINæŠ¥æ–‡æ®µå³ä½¿ä¸æºå¸¦æ•°æ®ï¼Œå®ƒä¹Ÿæ¶ˆè€—æ‰ä¸€ä¸ªåºå·ã€‚\nè¯·æ³¨æ„ï¼Œç°åœ¨TCPè¿æ¥è¿˜æ²¡æœ‰é‡Šæ”¾æ‰ã€‚å¿…é¡»ç»è¿‡æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨(TIME-WAIT timer)è®¾ç½®çš„æ—¶é—´2MSLåï¼ŒAæ‰è¿›å…¥åˆ°CLOSEDçŠ¶æ€ã€‚æ—¶é—´MSLå«åšæœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½(Maximum Segment Lifetime)ï¼ŒRFC 793å»ºè®®è®¾ä¸º2åˆ†é’Ÿã€‚ä½†è¿™å®Œå…¨æ˜¯ä»å·¥ç¨‹ä¸Šæ¥è€ƒè™‘ï¼Œå¯¹äºç°åœ¨çš„ç½‘ç»œï¼ŒMSL = 2åˆ†é’Ÿå¯èƒ½å¤ªé•¿äº†ä¸€äº›ã€‚å› æ­¤TCPå…è®¸ä¸åŒçš„å®ç°å¯æ ¹æ®å…·ä½“æƒ…å†µä½¿ç”¨æ›´å°çš„MSLå€¼ã€‚å› æ­¤ï¼Œä»Aè¿›å…¥åˆ°TIME-WAITçŠ¶æ€åï¼Œè¦ç»è¿‡4åˆ†é’Ÿæ‰èƒ½è¿›å…¥åˆ°CLOSEDçŠ¶æ€ï¼Œæ‰èƒ½å¼€å§‹å»ºç«‹ä¸‹ä¸€ä¸ªæ–°çš„è¿æ¥ã€‚å½“Aæ’¤é”€ç›¸åº”çš„ä¼ è¾“æ§åˆ¶å—TCBåï¼Œå°±ç»“æŸäº†è¿™æ¬¡çš„TCPè¿æ¥ã€‚\n ä¸ºä»€ä¹ˆAåœ¨TIME-WAITçŠ¶æ€(å‘é€æœ€åä¸€ä¸ªæ•°æ®åŒ…ä¹‹å)å¿…é¡»ç­‰å¾…2MSLçš„æ—¶é—´å‘¢ï¼Ÿè¿™æœ‰ä¸¤ä¸ªç†ç”±ã€‚\n  ç¬¬ä¸€ï¼Œä¸ºäº†ä¿è¯Aå‘é€çš„æœ€åä¸€ä¸ªACKæŠ¥æ–‡æ®µèƒ½å¤Ÿåˆ°è¾¾Bã€‚è¿™ä¸ªACKæŠ¥æ–‡æ®µæœ‰å¯èƒ½ä¸¢å¤±ï¼Œå› è€Œä½¿å¤„åœ¨LAST-ACKçŠ¶æ€çš„Bæ”¶ä¸åˆ°å¯¹å·²å‘é€çš„FIN + ACKæŠ¥æ–‡æ®µçš„ç¡®è®¤ã€‚Bä¼šè¶…æ—¶é‡ä¼ è¿™ä¸ªFIN + ACKæŠ¥æ–‡æ®µï¼Œè€ŒAå°±èƒ½åœ¨2MSLæ—¶é—´å†…æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„FIN + ACKæŠ¥æ–‡æ®µã€‚æ¥ç€Aé‡ä¼ ä¸€æ¬¡ç¡®è®¤ï¼Œé‡æ–°å¯åŠ¨2MSLè®¡æ—¶å™¨ã€‚æœ€åï¼ŒAå’ŒBéƒ½æ­£å¸¸è¿›å…¥åˆ°CLOSEDçŠ¶æ€ã€‚å¦‚æœAåœ¨TIME-WAITçŠ¶æ€ä¸ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œè€Œæ˜¯åœ¨å‘é€å®ŒACKæŠ¥æ–‡æ®µåç«‹å³é‡Šæ”¾è¿æ¥ï¼Œé‚£ä¹ˆå°±æ— æ³•æ”¶åˆ°Bé‡ä¼ çš„FIN + ACKæŠ¥æ–‡æ®µï¼Œå› è€Œä¹Ÿä¸ä¼šå†å‘é€ä¸€æ¬¡ç¡®è®¤æŠ¥æ–‡æ®µã€‚è¿™æ ·ï¼ŒBå°±æ— æ³•æŒ‰ç…§æ­£å¸¸æ­¥éª¤è¿›å…¥CLOSEDçŠ¶æ€ã€‚\n  ç¬¬äºŒï¼Œé˜²æ­¢ä¸Šä¸€èŠ‚æåˆ°çš„â€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€å‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚Aåœ¨å‘é€å®Œæœ€åä¸€ä¸ªACKæŠ¥æ–‡æ®µåï¼Œå†ç»è¿‡æ—¶é—´2MSLï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·å°±å¯ä»¥ä½¿ä¸‹ä¸€ä¸ªæ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°è¿™ç§æ—§çš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚Båªè¦æ”¶åˆ°äº†Aå‘å‡ºçš„ç¡®è®¤ï¼Œå°±è¿›å…¥CLOSEDçŠ¶æ€ã€‚åŒæ ·ï¼ŒBåœ¨æ’¤é”€ç›¸åº”çš„ä¼ è¾“æ§åˆ¶å—TCBåï¼Œå°±ç»“æŸäº†è¿™æ¬¡çš„TCPè¿æ¥ã€‚æˆ‘ä»¬æ³¨æ„åˆ°ï¼ŒBç»“æŸTCPè¿æ¥çš„æ—¶é—´è¦æ¯”Aæ—©ä¸€äº›ã€‚\n  TCPçš„4ä¸ªå®šæ—¶å™¨  é‡ä¼ å®šæ—¶å™¨ã€åšæŒå®šæ—¶å™¨ã€ä¿æŒå®šæ—¶å™¨ã€æ—¶é—´ç­‰å¾…å®šæ—¶å™¨\n é‡ä¼ è®¡æ—¶å™¨ï¼š\nå½“TCPå‘é€æŠ¥æ–‡æ®µæ—¶ï¼Œå°±åˆ›å»ºè¯¥ç‰¹å®šæŠ¥æ–‡æ®µçš„é‡ä¼ è®¡æ—¶å™¨ã€‚\n è‹¥åœ¨è®¡æ—¶å™¨æˆªæ­¢æ—¶é—´åˆ°(é€šå¸¸60ç§’)ä¹‹å‰æ”¶åˆ°äº†å¯¹æ­¤ç‰¹å®šæŠ¥æ–‡æ®µçš„ç¡®è®¤ï¼Œåˆ™æ’¤é”€æ­¤è®¡æ—¶å™¨ã€‚ è‹¥åœ¨è®¡æ—¶å™¨æˆªæ­¢æ—¶é—´ä¹‹å‰æ²¡æœ‰æ”¶åˆ°å¯¹æ­¤ç‰¹å®šæŠ¥æ–‡çš„ç¡®è®¤ï¼Œåˆ™å°±è®¤ä¸ºè¯¥æŠ¥æ–‡ä¸¢å¤±ï¼Œéœ€è¦é‡ä¼ æ­¤æŠ¥æ–‡æ®µï¼Œå¹¶å°†è®¡æ—¶å™¨å¤ä½ã€‚  åšæŒè®¡æ—¶å™¨-é˜²æ­¢æ”¶ä¸åˆ°é0çª—å£å¤§å°çš„æŠ¥æ–‡\n å‡è®¾TCPæ”¶åˆ°äº†ä¸€ä¸ªçª—å£å¤§å°ä¸º0æŠ¥æ–‡æ®µï¼Œå‘é€TCPå°±åœæ­¢ä¼ é€æŠ¥æ–‡æ®µï¼Œç›´åˆ°æ¥æ”¶TCPå‘é€ä¸€ä¸ªéé›¶çš„çª—å£å¤§å°ã€‚ä½†æ˜¯è¿™ä¸ªç¡®è®¤æœ‰å¯èƒ½ä¸¢å¤±ï¼Œè‹¥ç¡®è®¤ä¸¢äº†ï¼Œæ¥æ”¶TCPå¹¶ä¸ä¼šçŸ¥é“ï¼Œè€Œæ˜¯è®¤ä¸ºä»–å·²ç»å®Œæˆä»»åŠ¡äº†ã€‚ä½†æ˜¯å‘é€TCPç”±äºæ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œå°±ä¼šä¸€ç›´ç­‰å¾…æ¥æ”¶æ–¹å‘é€ç¡®è®¤æ¥é€šçŸ¥çª—å£çš„å¤§å°ã€‚åŒæ–¹çš„TCPè¿™æ—¶å°±ä¼šé€ æˆæ­»é”ï¼Œæ‰€ä»¥è¦ä½¿ç”¨ä¸€ä¸ªè®¡æ—¶å™¨æ¥é¿å…æ­»é”çš„å‘é€ã€‚\n  å½“TCPæ”¶åˆ°ä¸€ä¸ªçª—å£å¤§å°ä¸º0çš„ç¡®è®¤æ—¶ï¼Œå°±è¦å¯åŠ¨åšæŒè®¡æ—¶å™¨ã€‚å½“åšæŒè®¡æ—¶å™¨æœŸé™åˆ°æ—¶ï¼Œå‘é€TCPå°±å‘é€ä¸€ä¸ªç‰¹æ®Šçš„æ¢æµ‹æŠ¥æ–‡ï¼Œè¿™ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µåªæœ‰ä¸€ä¸ªå­—èŠ‚æ•°æ®ï¼Œå®ƒæœ‰ä¸€ä¸ªåºå·ï¼Œä½†æ˜¯å®ƒçš„åºå·æ°¸è¿œä¸éœ€è¦ç¡®è®¤ã€‚æ¢æµ‹æŠ¥æ–‡æ®µæé†’å¯¹ç«¯ï¼Œç¡®è®¤å·²ä¸¢å¤±ï¼Œå¿…é¡»é‡ä¼ ã€‚ åšæŒè®¡æ—¶å™¨çš„å€¼è®¾ç½®ä¸ºé‡ä¼ æ—¶é—´çš„æ•°å€¼ã€‚è‹¥æ²¡æœ‰æ”¶åˆ°ä»æ¥æ”¶ç«¯æ¥çš„å“åº”ï¼Œéœ€è¦å‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡ï¼Œå¹¶å°†åšæŒè®¡æ—¶å™¨çš„å€¼åŠ å€å’Œå¤ä½ï¼Œç›´åˆ°è¿™ä¸ªå€¼å¢å¤§åˆ°é—¨é™å€¼(é€šå¸¸60ç§’)ä¸ºæ­¢ã€‚åœ¨è¿™ä»¥åï¼Œå‘é€ç«¯æ¯éš”60ç§’å‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡ï¼Œç›´åˆ°çª—å£é‡æ–°æ‰“å¼€ã€‚  ä¿æ´»è®¡æ—¶å™¨\nä¿æ´»è®¡æ—¶å™¨ç”¨æ¥é˜²æ­¢ä¸¤ä¸ªTCPä¹‹é—´çš„è¿ç»­å‡ºç°é•¿æ—¶é—´çš„ç©ºé—²ã€‚\n å‡å®šå®¢æˆ·å·²ä¸»åŠ¨ä¸æœåŠ¡å™¨å»ºç«‹äº†TCPé“¾æ¥ã€‚ç„¶åè¿™ä¸ªå®¢æˆ·ç«¯å‡ºç°æ•…éšœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé“¾æ¥å°±ä¼šæ°¸è¿œçš„å¤„äºæ‰“å¼€çŠ¶æ€ã€‚è€ŒæœåŠ¡å™¨ç»´æŠ¤ä¸€ä¸ªé“¾æ¥ï¼Œä¹Ÿæ˜¯è¦è€—è´¹ä¸€å®šçš„èµ„æºçš„ï¼Œæ‰€ä»¥å¿…é¡»é‡‡å–æªæ–½ï¼Œä½¿æœåŠ¡å™¨ä¸èƒ½ç™½ç™½ç­‰ä¸‹å»ã€‚ è¦è§£å†³è¿™ç§é—®é¢˜ï¼Œå°±è¦å¯¹æœåŠ¡å™¨è®¾ç½®ä¿æ´»è®¡æ—¶å™¨ã€‚æ¯å½“æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·çš„ä¿¡æ¯ï¼Œå°±å°†è®¡æ—¶å™¨å¤ä½ï¼Œä¿æ´»æ—¶é—´é€šå¸¸è®¾ç½®ä¸º2å°æ—¶ã€‚è‹¥æœåŠ¡å™¨è¿‡äº†ä¸¤å°æ—¶è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·çš„ä¿¡æ¯ï¼Œä»–å°±å‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡ï¼Œä»¥åæ¯éš”75ç§’å°±å‘ä¸€æ¬¡ï¼Œè¿ç»­å‘é€10ä¸ªæ¢æµ‹æŠ¥æ–‡åå®¢æˆ·ç«¯ä»ç„¶æ²¡æœ‰å“åº”ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºç°äº†æ•…éšœï¼Œæ¥ç€å°±å…³é—­è¿™ä¸ªé“¾æ¥ã€‚  æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨\nå½“å®¢æˆ·ç«¯è¿›å…¥TIME-WAITçŠ¶æ€çš„æ—¶å€™ï¼Œé“¾æ¥è¿˜æ²¡æœ‰é‡Šæ”¾æ‰ï¼Œå¿…é¡»ç­‰å¾…2å€çš„MSL(æœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½)åï¼Œå®¢æˆ·ç«¯æ‰èƒ½å…³é—­è¿æ¥ã€‚åœ¨æ—¶é—´ç­‰å¾…æœŸé—´ï¼Œé“¾æ¥è¿˜å¤„äºä¸€ç§è¿‡æ¸¡çŠ¶æ€ã€‚è¿™å°±å¯ä»¥ä½¿é‡å¤çš„FINæŠ¥æ–‡æ®µ(è‹¥æœæœ‰çš„è¯)å¯ä»¥åˆ°è¾¾ç›®çš„ç«™å› è€Œå¯å°†å…¶ä¸¢å¼ƒã€‚\nä¿è¯ä¼ è¾“å¯é  ç†æƒ³çš„ä¼ è¾“æ¡ä»¶æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹ï¼š\n ä¼ è¾“ä¿¡é“ä¸äº§ç”Ÿå·®é”™ã€‚ ä¸ç®¡å‘é€æ–¹ä»¥å¤šå¿«çš„é€Ÿåº¦å‘é€æ•°æ®ï¼Œæ¥æ”¶æ–¹æ€»æ˜¯æ¥å¾—åŠå¤„ç†æ”¶åˆ°çš„æ•°æ®ã€‚   æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›å¯é ä¼ è¾“åè®®ï¼Œå½“å‡ºç°å·®é”™æ—¶è®©å‘é€æ–¹é‡ä¼ å‡ºç°å·®é”™çš„æ•°æ®ï¼ŒåŒæ—¶åœ¨æ¥æ”¶æ–¹æ¥ä¸åŠå¤„ç†æ”¶åˆ°çš„æ•°æ®æ—¶ï¼ŒåŠæ—¶å‘Šè¯‰å‘é€æ–¹é€‚å½“é™ä½å‘é€æ•°æ®çš„é€Ÿåº¦ã€‚è¿™æ ·ä¸€æ¥ï¼Œæœ¬æ¥æ˜¯ä¸å¯é çš„ä¼ è¾“ä¿¡é“å°±èƒ½å¤Ÿå®ç°å¯é ä¼ è¾“äº†ã€‚\n åºå·ä¸ç¡®è®¤å·\næœ‰ä¸€ä¸ªé—®é¢˜ï¼šè¿™æ¡è¿æ¥çªç„¶æ–­å¼€é‡è¿åï¼ŒTCP æ€ä¹ˆæ ·è¯†åˆ«ä¹‹å‰æ—§é“¾æ¥é‡å‘çš„åŒ…ï¼Ÿâ€”â€”è¿™å°±éœ€è¦ç‹¬ä¸€æ— äºŒçš„ ISNï¼ˆåˆå§‹åºåˆ—å·ï¼‰æœºåˆ¶ã€‚\nè¶…æ—¶é‡ä¼ \nè¶…æ—¶é‡ä¼ ï¼šå¯é ä¼ è¾“åè®®æ˜¯è¿™æ ·è®¾è®¡çš„ï¼šAåªè¦è¶…è¿‡äº†ä¸€æ®µæ—¶é—´ä»ç„¶æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œå°±è®¤ä¸ºåˆšæ‰å‘é€çš„åˆ†ç»„ä¸¢å¤±äº†ï¼Œå› è€Œé‡ä¼ å‰é¢å‘é€è¿‡çš„åˆ†ç»„ã€‚è¿™å°±å«åšè¶…æ—¶é‡ä¼ ã€‚\n è¦å®ç°è¶…æ—¶é‡ä¼ ï¼Œå°±è¦åœ¨æ¯å‘é€å®Œä¸€ä¸ªåˆ†ç»„è®¾ç½®ä¸€ä¸ªè¶…æ—¶è®¡æ—¶å™¨ã€‚å¦‚æœåœ¨è¶…æ—¶è®¡æ—¶å™¨åˆ°æœŸä¹‹å‰æ”¶åˆ°äº†å¯¹æ–¹çš„ç¡®è®¤ï¼Œå°±æ’¤é”€å·²è®¾ç½®çš„è¶…æ—¶è®¡æ—¶å™¨\n ç¡®è®¤ä¸¢å¤±ä¸ç¡®è®¤è¿Ÿåˆ°ï¼š\nåœæ­¢ç­‰å¾…åè®® - ç®€å•çš„ä¿è¯ä¼ è¾“çš„å¯é æ€§- ARQåè®®\nåœæ­¢ç­‰å¾…åè®®ï¼šâ€œåœæ­¢ç­‰å¾…â€å°±æ˜¯æ¯å‘é€å®Œä¸€ä¸ªåˆ†ç»„å°±åœæ­¢å‘é€ï¼Œç­‰å¾…å¯¹æ–¹çš„ç¡®è®¤ã€‚åœ¨æ”¶åˆ°ç¡®è®¤åå†å‘é€ä¸‹ä¸€ä¸ªåˆ†ç»„ã€‚(ä¿¡é“åˆ©ç”¨ç‡ä½)\nè¿ç»­ARQåè®®\nè¿ç»­ARQåè®®ï¼šå‘é€æ–¹æ¯æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°±\tæŠŠå‘é€çª—å£å‘å‰æ»‘åŠ¨ä¸€ä¸ªåˆ†ç»„çš„ä½ç½®ã€‚\næ¥æ”¶æ–¹ä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨ç´¯ç§¯ç¡®è®¤çš„æ–¹å¼ã€‚è¿™å°±æ˜¯è¯´ï¼Œæ¥æ”¶æ–¹ä¸å¿…å¯¹æ”¶åˆ°çš„åˆ†ç»„é€ä¸ªå‘é€ç¡®è®¤ï¼Œè€Œæ˜¯åœ¨æ”¶åˆ°å‡ ä¸ªåˆ†ç»„åï¼Œå¯¹æŒ‰åºåˆ°è¾¾çš„æœ€åä¸€ä¸ªåˆ†ç»„å‘é€ç¡®è®¤ï¼Œè¿™å°±è¡¨ç¤ºï¼šåˆ°è¿™ä¸ªåˆ†ç»„ä¸ºæ­¢çš„æ‰€æœ‰åˆ†ç»„éƒ½å·²æ­£ç¡®æ”¶åˆ°äº†ã€‚\næ»‘åŠ¨çª—å£\nå‘é€çª—å£è¡¨ç¤ºï¼šåœ¨æ²¡æœ‰æ”¶åˆ°Bçš„ç¡®è®¤çš„æƒ…å†µä¸‹ï¼ŒAå¯ä»¥è¿ç»­æŠŠçª—å£å†…çš„æ•°æ®éƒ½å‘é€å‡ºå»ã€‚å‡¡æ˜¯å·²ç»å‘é€è¿‡çš„æ•°æ®ï¼Œåœ¨æœªæ”¶åˆ°ç¡®è®¤ä¹‹å‰éƒ½å¿…é¡»æš‚æ—¶ä¿ç•™ï¼Œä»¥ä¾¿åœ¨è¶…æ—¶é‡ä¼ æ—¶ä½¿ç”¨\nä»ä»¥ä¸Šæ‰€è¿°å¯ä»¥çœ‹å‡ºï¼Œè¦æè¿°ä¸€ä¸ªå‘é€çª—å£çš„çŠ¶æ€éœ€è¦ä¸‰ä¸ªæŒ‡é’ˆï¼šP1ï¼ŒP2å’ŒP3ã€‚æŒ‡é’ˆéƒ½æŒ‡å‘å­—èŠ‚çš„åºå·ã€‚è¿™ä¸‰ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å‡ ä¸ªéƒ¨åˆ†çš„æ„ä¹‰å¦‚ä¸‹ï¼šå°äºP1çš„æ˜¯å·²å‘é€å¹¶å·²æ”¶åˆ°ç¡®è®¤çš„éƒ¨åˆ†ï¼Œè€Œå¤§äºP3çš„æ˜¯ä¸å…è®¸å‘é€çš„éƒ¨åˆ†ã€‚P3 - P1 = Açš„å‘é€çª—å£ï¼ˆåˆç§°ä¸ºé€šçŸ¥çª—å£ï¼‰P2 - P1 = å·²å‘é€ä½†å°šæœªæ”¶åˆ°ç¡®è®¤çš„å­—èŠ‚æ•°P3 - P2 = å…è®¸å‘é€ä½†å°šæœªå‘é€çš„å­—èŠ‚æ•°ï¼ˆåˆç§°ä¸ºå¯ç”¨çª—å£æˆ–æœ‰æ•ˆçª—å£ï¼‰\nå‘é€æ–¹çš„åº”ç”¨è¿›ç¨‹æŠŠå­—èŠ‚æµå†™å…¥TCPçš„å‘é€ç¼“å­˜ï¼Œæ¥æ”¶æ–¹çš„åº”ç”¨è¿›ç¨‹ä»TCPçš„æ¥æ”¶ç¼“å­˜ä¸­è¯»å–å­—èŠ‚æµã€‚ä¸‹å›¾è¡¨ç¤ºäº†å‘é€æ–¹ç»´æŒçš„å‘é€ç¼“å­˜å’Œå‘é€çª—å£ï¼Œä»¥åŠæ¥æ”¶æ–¹ç»´æŒçš„æ¥æ”¶ç¼“å­˜å’Œæ¥æ”¶çª—å£ã€‚\næ€»ç»“ï¼š\nå‘é€ç¼“å­˜ç”¨æ¥æš‚æ—¶å­˜æ”¾ï¼š\n å‘é€åº”ç”¨ç¨‹åºä¼ é€ç»™å‘é€æ–¹TCPå‡†å¤‡å‘é€çš„æ•°æ® TCPå·²å‘é€å‡ºä½†å°šæœªæ”¶åˆ°ç¡®è®¤çš„æ•°æ®ã€‚   å‘é€çª—å£é€šå¸¸åªæ˜¯å‘é€ç¼“å­˜çš„ä¸€éƒ¨åˆ†ã€‚å·²è¢«ç¡®è®¤çš„æ•°æ®åº”å½“ä»å‘é€ç¼“å­˜ä¸­åˆ é™¤ï¼Œå› æ­¤å‘é€ç¼“å­˜å’Œå‘é€çª—å£çš„åæ²¿æ˜¯é‡åˆçš„ã€‚å‘é€åº”ç”¨ç¨‹åºæœ€åå†™å…¥å‘é€ç¼“å­˜çš„å­—èŠ‚å‡å»æœ€åè¢«ç¡®è®¤çš„å­—èŠ‚ï¼Œå°±æ˜¯è¿˜ä¿ç•™åœ¨å‘é€ç¼“å­˜ä¸­çš„è¢«å†™å…¥çš„å­—èŠ‚æ•°ã€‚å‘é€åº”ç”¨ç¨‹åºå¿…é¡»æ§åˆ¶å†™å…¥ç¼“å­˜çš„é€Ÿç‡ï¼Œä¸èƒ½å¤ªå¿«ï¼Œå¦åˆ™å‘é€ç¼“å­˜å°±ä¼šæ²¡æœ‰å­˜æ”¾æ•°æ®çš„ç©ºé—´ã€‚\n æ¥æ”¶ç¼“å­˜ç”¨æ¥æš‚æ—¶å­˜æ”¾ï¼š\n æŒ‰åºåˆ°è¾¾çš„ã€ä½†å°šæœªè¢«æ¥æ”¶åº”ç”¨ç¨‹åºè¯»å–çš„æ•°æ® æœªæŒ‰åºåˆ°è¾¾çš„æ•°æ®ã€‚   å¦‚æœæ”¶åˆ°çš„åˆ†ç»„è¢«æ£€æµ‹å‡ºæœ‰å·®é”™ï¼Œåˆ™è¦ä¸¢å¼ƒã€‚å¦‚æœæ¥æ”¶åº”ç”¨ç¨‹åºæ¥ä¸åŠè¯»å–æ”¶åˆ°çš„æ•°æ®ï¼Œæ¥æ”¶ç¼“å­˜æœ€ç»ˆå°±ä¼šè¢«å¡«æ»¡ï¼Œä½¿æ¥æ”¶çª—å£å‡å°åˆ°é›¶ã€‚åä¹‹ï¼Œå¦‚æœæ¥æ”¶åº”ç”¨ç¨‹åºèƒ½å¤ŸåŠæ—¶ä»æ¥æ”¶ç¼“å­˜ä¸­è¯»å–æ”¶åˆ°çš„æ•°æ®ï¼Œæ¥æ”¶çª—å£å°±å¯ä»¥å¢å¤§ï¼Œä½†æœ€å¤§ä¸èƒ½è¶…è¿‡æ¥æ”¶ç¼“å­˜çš„å¤§å°ã€‚\n è¶…æ—¶é‡ä¼ çš„é€‰æ‹©\nTCPé‡‡ç”¨äº†ä¸€ç§è‡ªé€‚åº”ç®—æ³•ï¼Œå®ƒè®°å½•ä¸€ä¸ªæŠ¥æ–‡æ®µå‘å‡ºçš„æ—¶é—´ï¼Œä»¥åŠæ”¶åˆ°ç›¸åº”çš„ç¡®è®¤çš„æ—¶é—´ã€‚è¿™ä¸¤ä¸ªæ—¶é—´ä¹‹å·®å°±æ˜¯æŠ¥æ–‡æ®µçš„å¾€è¿”æ—¶é—´RTTã€‚TCPä¿ç•™äº†RTTçš„ä¸€ä¸ªåŠ æƒå¹³å‡å¾€è¿”æ—¶é—´ $RTT_S$ï¼ˆè¿™åˆç§°ä¸ºå¹³æ»‘çš„å¾€è¿”æ—¶é—´ï¼ŒSè¡¨ç¤ºSmoothedã€‚å› ä¸ºè¿›è¡Œçš„æ˜¯åŠ æƒå¹³å‡ï¼Œå› æ­¤å¾—å‡ºçš„ç»“æœæ›´åŠ å¹³æ»‘ï¼‰ã€‚æ¯å½“ç¬¬ä¸€æ¬¡æµ‹é‡åˆ°RTTæ ·æœ¬æ—¶ï¼ŒRTTSå€¼å°±å–ä¸ºæ‰€æµ‹é‡åˆ°çš„RTTæ ·æœ¬å€¼ã€‚ä½†ä»¥åæ¯æµ‹é‡åˆ°ä¸€ä¸ªæ–°çš„RTTæ ·æœ¬ï¼Œå°±æŒ‰ä¸‹å¼é‡æ–°è®¡ç®—ä¸€æ¬¡$RTT_S$\n RFC2988æ¨èçš„Î±å€¼ä¸º1/8ï¼Œå³0.125ã€‚ç”¨è¿™ç§æ–¹æ³•å¾—å‡ºçš„åŠ æƒå¹³å‡å¾€è¿”æ—¶é—´RTTSå°±æ¯”æµ‹é‡å‡ºçš„RTTå€¼æ›´åŠ å¹³æ»‘\n è¶…æ—¶è®¡æ—¶å™¨è®¾ç½®çš„è¶…æ—¶é‡ä¼ æ—¶é—´ RTO (RetransmissionTime-Out)åº”ç•¥å¤§äºä¸Šé¢å¾—å‡ºçš„åŠ æƒå¹³å‡å¾€è¿”æ—¶é—´$RTT_S$ã€‚RFC 2988å»ºè®®ä½¿ç”¨ä¸‹å¼è®¡ç®—RTOï¼š\n$$\nRTO = RTT_{S} + 4 \\times RTT_{D}\n$$\nè€Œ$RTT_D$æ˜¯RTTçš„åå·®çš„åŠ æƒå¹³å‡å€¼ï¼Œå®ƒä¸$RTT_S$å’Œæ–°çš„RTTæ ·æœ¬ä¹‹å·®æœ‰å…³ã€‚å½“ç¬¬ä¸€æ¬¡æµ‹é‡æ—¶ï¼ŒRTTDå€¼å–ä¸ºæµ‹é‡åˆ°çš„RTTæ ·æœ¬å€¼çš„ä¸€åŠã€‚åœ¨ä»¥åçš„æµ‹é‡ä¸­ï¼Œåˆ™ä½¿ç”¨ä¸‹å¼è®¡ç®—åŠ æƒå¹³å‡çš„RTTDï¼š\n è¿™é‡Œ Î² æ˜¯ä¸ªå°äº1çš„ç³»æ•°ï¼Œå®ƒçš„æ¨èå€¼æ˜¯1/4ï¼Œå³0.25ã€‚\n æ¥å—æ–¹æœ‰ä¸€ä¸ªåˆ¤æ–­æ¥å—çš„æŠ¥æ–‡æ—¶ä¹‹å‰å‘é€çš„è¿˜æ˜¯ä¹‹åé‡ä¼ çš„æŠ¥æ–‡çš„é—®é¢˜ï¼Œè¿™é‡Œæ¥å—æ–¹å¦‚ä½•åˆ¤æ–­ç»™å“ªä¸€ä¸ªæŠ¥æ–‡å‘é€ç¡®è®¤ï¼Ÿ\né€‰æ‹©ç¡®è®¤SACK\nè¿™å°±æ˜¯è‹¥æ”¶åˆ°çš„æŠ¥æ–‡æ®µæ— å·®é”™ï¼Œåªæ˜¯æœªæŒ‰åºå·ï¼Œä¸­é—´è¿˜ç¼ºå°‘ä¸€äº›åºå·çš„æ•°æ®ï¼Œé‚£ä¹ˆèƒ½å¦è®¾æ³•åªä¼ é€ç¼ºå°‘çš„æ•°æ®è€Œä¸é‡ä¼ å·²ç»æ­£ç¡®åˆ°è¾¾æ¥æ”¶æ–¹çš„æ•°æ®ï¼Ÿ\næµé‡æ§åˆ¶  æ‰€è°“æµé‡æ§åˆ¶(flow control)å°±æ˜¯è®©å‘é€æ–¹çš„å‘é€é€Ÿç‡ä¸è¦å¤ªå¿«ï¼Œè¦è®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶\n æ»‘åŠ¨çª—å£æµé‡æ§åˆ¶ï¼š\nç°åœ¨æˆ‘ä»¬è€ƒè™‘ä¸€ç§æƒ…å†µã€‚ã€Bå‘Aå‘é€äº†é›¶çª—å£çš„æŠ¥æ–‡æ®µåä¸ä¹…ï¼ŒBçš„æ¥æ”¶ç¼“å­˜åˆæœ‰äº†ä¸€äº›å­˜å‚¨ç©ºé—´ã€‚äºæ˜¯Bå‘Aå‘é€äº†rwnd = 400çš„æŠ¥æ–‡æ®µã€‚ç„¶è€Œè¿™ä¸ªæŠ¥æ–‡æ®µåœ¨ä¼ é€è¿‡ç¨‹ä¸­ä¸¢å¤±äº†ã€‚Aä¸€ç›´ç­‰å¾…æ”¶åˆ°Bå‘é€çš„éé›¶çª—å£çš„é€šçŸ¥ï¼Œè€ŒBä¹Ÿä¸€ç›´ç­‰å¾…Aå‘é€çš„æ•°æ®ã€‚å¦‚æœæ²¡æœ‰å…¶ä»–æªæ–½ï¼Œè¿™ç§äº’ç›¸ç­‰å¾…çš„æ­»é”å±€é¢å°†ä¸€ç›´å»¶ç»­ä¸‹å»ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦åšæŒè®¡æ—¶å™¨æ¥ä¿è¯äº†ã€‚\næ§åˆ¶TCPå‘é€æŠ¥æ–‡æ®µçš„æ—¶æœº æœ‰ä¸‰ç§å‘é€æŠ¥æ–‡æ®µçš„æ–¹æ³•ï¼š\n ç¬¬ä¸€ç§æœºåˆ¶æ˜¯TCPç»´æŒä¸€ä¸ªå˜é‡ï¼Œå®ƒç­‰äºæœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦MSSã€‚åªè¦ç¼“å­˜ä¸­å­˜æ”¾çš„æ•°æ®è¾¾åˆ°MSSå­—èŠ‚æ—¶ï¼Œå°±ç»„è£…æˆä¸€ä¸ªTCPæŠ¥æ–‡æ®µå‘é€å‡ºå»ã€‚ ç¬¬äºŒç§æœºåˆ¶æ˜¯ç”±å‘é€æ–¹çš„åº”ç”¨è¿›ç¨‹æŒ‡æ˜è¦æ±‚å‘é€æŠ¥æ–‡æ®µï¼Œå³TCPæ”¯æŒçš„æ¨é€(push)æ“ä½œ ç¬¬ä¸‰ç§æœºåˆ¶æ˜¯å‘é€æ–¹çš„ä¸€ä¸ªè®¡æ—¶å™¨æœŸé™åˆ°äº†ï¼Œè¿™æ—¶å°±æŠŠå½“å‰å·²æœ‰çš„ç¼“å­˜æ•°æ®è£…å…¥æŠ¥æ–‡æ®µï¼ˆä½†é•¿åº¦ä¸èƒ½è¶…è¿‡MSSï¼‰å‘é€å‡ºå»ã€‚  åœ¨TCPçš„å®ç°ä¸­å¹¿æ³›ä½¿ç”¨Nagleç®—æ³•ã€‚ç®—æ³•å¦‚ä¸‹ï¼šè‹¥å‘é€åº”ç”¨è¿›ç¨‹æŠŠè¦å‘é€çš„æ•°æ®é€ä¸ªå­—èŠ‚åœ°é€åˆ°TCPçš„å‘é€ç¼“å­˜ï¼Œåˆ™å‘é€æ–¹å°±æŠŠç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚å…ˆå‘é€å‡ºå»ï¼ŒæŠŠåé¢åˆ°è¾¾çš„æ•°æ®å­—èŠ‚éƒ½ç¼“å­˜èµ·æ¥ã€‚å½“å‘é€æ–¹æ”¶åˆ°å¯¹ç¬¬ä¸€ä¸ªæ•°æ®å­—ç¬¦çš„ç¡®è®¤åï¼Œå†æŠŠå‘é€ç¼“å­˜ä¸­çš„æ‰€æœ‰æ•°æ®ç»„è£…æˆä¸€ä¸ªæŠ¥æ–‡æ®µå‘é€å‡ºå»ï¼ŒåŒæ—¶ç»§ç»­å¯¹éšååˆ°è¾¾çš„æ•°æ®è¿›è¡Œç¼“å­˜ã€‚åªæœ‰åœ¨æ”¶åˆ°å¯¹å‰ä¸€ä¸ªæŠ¥æ–‡æ®µçš„ç¡®è®¤åæ‰ç»§ç»­å‘é€ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µã€‚å½“æ•°æ®åˆ°è¾¾è¾ƒå¿«è€Œç½‘ç»œé€Ÿç‡è¾ƒæ…¢æ—¶ï¼Œç”¨è¿™æ ·çš„æ–¹æ³•å¯æ˜æ˜¾åœ°å‡å°‘æ‰€ç”¨çš„ç½‘ç»œå¸¦å®½ã€‚Nagleç®—æ³•è¿˜è§„å®šï¼Œå½“åˆ°è¾¾çš„æ•°æ®å·²è¾¾åˆ°å‘é€çª—å£å¤§å°çš„ä¸€åŠæˆ–å·²è¾¾åˆ°æŠ¥æ–‡æ®µçš„æœ€å¤§é•¿åº¦æ—¶ï¼Œå°±ç«‹å³å‘é€ä¸€ä¸ªæŠ¥æ–‡æ®µã€‚è¿™æ ·åšï¼Œå°±å¯ä»¥æœ‰æ•ˆåœ°æé«˜ç½‘ç»œçš„ååé‡ã€‚\nå¦ä¸€ä¸ªé—®é¢˜å«åšç³Šæ¶‚çª—å£ç»¼åˆç—‡ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥è®©æ¥æ”¶æ–¹ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œä½¿å¾—æˆ–è€…æ¥æ”¶ç¼“å­˜å·²æœ‰è¶³å¤Ÿç©ºé—´å®¹çº³ä¸€ä¸ªæœ€é•¿çš„æŠ¥æ–‡æ®µï¼Œæˆ–è€…ç­‰åˆ°æ¥æ”¶ç¼“å­˜å·²æœ‰ä¸€åŠç©ºé—²çš„ç©ºé—´ã€‚åªè¦å‡ºç°è¿™ä¸¤ç§æƒ…å†µä¹‹ä¸€ï¼Œæ¥æ”¶æ–¹å°±å‘å‡ºç¡®è®¤æŠ¥æ–‡ï¼Œå¹¶å‘å‘é€æ–¹é€šçŸ¥å½“å‰çš„çª—å£å¤§å°ã€‚æ­¤å¤–ï¼Œå‘é€æ–¹ä¹Ÿä¸è¦å‘é€å¤ªå°çš„æŠ¥æ–‡æ®µï¼Œè€Œæ˜¯æŠŠæ•°æ®ç§¯ç´¯æˆè¶³å¤Ÿå¤§çš„æŠ¥æ–‡æ®µï¼Œæˆ–è¾¾åˆ°æ¥æ”¶æ–¹ç¼“å­˜çš„ç©ºé—´çš„ä¸€åŠå¤§å°ã€‚\næ‹¥å¡æ§åˆ¶  æµé‡æ§åˆ¶ä¸æ‹¥å¡æ§åˆ¶çš„åŒºåˆ«ï¼š\næ‹¥å¡æ§åˆ¶ä¸æµé‡æ§åˆ¶çš„å…³ç³»å¯†åˆ‡ï¼Œå®ƒä»¬ä¹‹é—´ä¹Ÿå­˜åœ¨ç€ä¸€äº›å·®åˆ«ã€‚æ‰€è°“æ‹¥å¡æ§åˆ¶å°±æ˜¯é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚\nç›¸åï¼Œæµé‡æ§åˆ¶å¾€å¾€æŒ‡ç‚¹å¯¹ç‚¹é€šä¿¡é‡çš„æ§åˆ¶ï¼Œæ˜¯ä¸ªç«¯åˆ°ç«¯çš„é—®é¢˜ï¼ˆæ¥æ”¶ç«¯æ§åˆ¶å‘é€ç«¯ï¼‰ã€‚æµé‡æ§åˆ¶æ‰€è¦åšçš„å°±æ˜¯æŠ‘åˆ¶å‘é€ç«¯å‘é€æ•°æ®çš„é€Ÿç‡ï¼Œä»¥ä¾¿ä½¿æ¥æ”¶ç«¯æ¥å¾—åŠæ¥æ”¶ã€‚\n ä»€ä¹ˆæ˜¯ç½‘ç»œæ‹¥å¡ï¼Ÿ\nåœ¨è®¡ç®—æœºç½‘ç»œä¸­çš„é“¾è·¯å®¹é‡ï¼ˆå³å¸¦å®½ï¼‰ã€äº¤æ¢ç»“ç‚¹ä¸­çš„ç¼“å­˜å’Œå¤„ç†æœºç­‰ï¼Œéƒ½æ˜¯ç½‘ç»œçš„èµ„æºã€‚åœ¨æŸæ®µæ—¶é—´ï¼Œè‹¥å¯¹ç½‘ç»œä¸­æŸä¸€èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†è¯¥èµ„æºæ‰€èƒ½æä¾›çš„å¯ç”¨éƒ¨åˆ†ï¼Œç½‘ç»œçš„æ€§èƒ½å°±è¦å˜åã€‚è¿™ç§æƒ…å†µå°±å«åšæ‹¥å¡(congestion)ã€‚\n æ‰€è°“æ‹¥å¡æ§åˆ¶å°±æ˜¯é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚\n æ‹¥å¡æ§åˆ¶æ‰€è¦åšçš„éƒ½æœ‰ä¸€ä¸ªå‰æï¼Œå°±æ˜¯ç½‘ç»œèƒ½å¤Ÿæ‰¿å—ç°æœ‰çš„ç½‘ç»œè´Ÿè·ã€‚æ‹¥å¡æ§åˆ¶æ˜¯ä¸€ä¸ªå…¨å±€æ€§çš„è¿‡ç¨‹ï¼Œæ¶‰åŠåˆ°æ‰€æœ‰çš„ä¸»æœºã€æ‰€æœ‰çš„è·¯ç”±å™¨ï¼Œä»¥åŠä¸é™ä½ç½‘ç»œä¼ è¾“æ€§èƒ½æœ‰å…³çš„æ‰€æœ‰å› ç´ ã€‚ä½†TCPè¿æ¥çš„ç«¯ç‚¹åªè¦è¿Ÿè¿Ÿä¸èƒ½æ”¶åˆ°å¯¹æ–¹çš„ç¡®è®¤ä¿¡æ¯ï¼Œå°±çŒœæƒ³åœ¨å½“å‰ç½‘ç»œä¸­çš„æŸå¤„å¾ˆå¯èƒ½å‘ç”Ÿäº†æ‹¥å¡ï¼Œä½†è¿™æ—¶å´æ— æ³•çŸ¥é“æ‹¥å¡åˆ°åº•å‘ç”Ÿåœ¨ç½‘ç»œçš„ä½•å¤„ï¼Œä¹Ÿæ— æ³•çŸ¥é“å‘ç”Ÿæ‹¥å¡çš„å…·ä½“åŸå› ï¼ˆæ˜¯è®¿é—®æŸä¸ªæœåŠ¡å™¨çš„é€šä¿¡é‡è¿‡å¤§ï¼Ÿè¿˜æ˜¯åœ¨æŸä¸ªåœ°åŒºå‡ºç°äº†è‡ªç„¶ç¾å®³ï¼‰ã€‚\næ‹¥å¡æ§åˆ¶æ‰€èµ·çš„ä½œç”¨å¦‚ä¸‹ï¼š\nå›¾ä¸­éšç€æä¾›çš„è´Ÿè½½çš„å¢å¤§ï¼Œç½‘ç»œååé‡çš„å¢é•¿é€Ÿç‡é€æ¸å‡å°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç½‘ç»œååé‡è¿˜æœªè¾¾åˆ°é¥±å’Œæ—¶ï¼Œå°±å·²ç»æœ‰ä¸€éƒ¨åˆ†çš„è¾“å…¥åˆ†ç»„è¢«ä¸¢å¼ƒäº†ã€‚å½“ç½‘ç»œçš„ååé‡æ˜æ˜¾åœ°å°äºç†æƒ³çš„ååé‡æ—¶ï¼Œç½‘ç»œå°±è¿›å…¥äº†è½»åº¦æ‹¥å¡çš„çŠ¶æ€ã€‚æ›´å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“æä¾›çš„è´Ÿè½½è¾¾åˆ°æŸä¸€æ•°å€¼æ—¶ï¼Œç½‘ç»œçš„ååé‡åè€Œéšæä¾›çš„è´Ÿè½½çš„å¢å¤§è€Œä¸‹é™ï¼Œè¿™æ—¶ç½‘ç»œå°±è¿›å…¥äº†æ‹¥å¡çŠ¶æ€ã€‚å½“æä¾›çš„è´Ÿè½½ç»§ç»­å¢å¤§åˆ°æŸä¸€æ•°å€¼æ—¶ï¼Œç½‘ç»œçš„ååé‡å°±ä¸‹é™åˆ°é›¶ï¼Œç½‘ç»œå·²æ— æ³•å·¥ä½œã€‚è¿™å°±æ˜¯æ‰€è°“çš„æ­»é”(deadlock)ã€‚\nç”±äºè®¡ç®—æœºç½‘ç»œæ˜¯ä¸€ä¸ªå¾ˆå¤æ‚çš„ç³»ç»Ÿï¼Œå› æ­¤å¯ä»¥ä»æ§åˆ¶ç†è®ºçš„è§’åº¦æ¥çœ‹æ‹¥å¡æ§åˆ¶è¿™ä¸ªé—®é¢˜ã€‚è¿™æ ·ï¼Œä»å¤§çš„æ–¹é¢çœ‹ï¼Œå¯ä»¥åˆ†ä¸ºå¼€ç¯æ§åˆ¶å’Œé—­ç¯æ§åˆ¶ä¸¤ç§æ–¹æ³•ã€‚å¼€ç¯æ§åˆ¶æ–¹æ³•å°±æ˜¯åœ¨è®¾è®¡ç½‘ç»œæ—¶äº‹å…ˆå°†æœ‰å…³å‘ç”Ÿæ‹¥å¡çš„å› ç´ è€ƒè™‘å‘¨åˆ°ï¼ŒåŠ›æ±‚ç½‘ç»œåœ¨å·¥ä½œæ—¶ä¸äº§ç”Ÿæ‹¥å¡ã€‚ä½†ä¸€æ—¦æ•´ä¸ªç³»ç»Ÿè¿è¡Œèµ·æ¥ï¼Œå°±ä¸å†ä¸­é€”è¿›è¡Œæ”¹æ­£äº†ã€‚\né—­ç¯æ§åˆ¶æ˜¯åŸºäºåé¦ˆç¯è·¯çš„æ¦‚å¿µã€‚å±äºé—­ç¯æ§åˆ¶çš„æœ‰ä»¥ä¸‹å‡ ç§æªæ–½ï¼š\n ç›‘æµ‹ç½‘ç»œç³»ç»Ÿä»¥ä¾¿æ£€æµ‹åˆ°æ‹¥å¡åœ¨ä½•æ—¶ã€ä½•å¤„å‘ç”Ÿã€‚ æŠŠæ‹¥å¡å‘ç”Ÿçš„ä¿¡æ¯ä¼ é€åˆ°å¯é‡‡å–è¡ŒåŠ¨çš„åœ°æ–¹ã€‚ è°ƒæ•´ç½‘ç»œç³»ç»Ÿçš„è¿è¡Œä»¥è§£å†³å‡ºç°çš„é—®é¢˜ã€‚  å‡ ç§æ–¹æ³•  1999å¹´å…¬å¸ƒçš„å› ç‰¹ç½‘å»ºè®®æ ‡å‡†RFC 2581å®šä¹‰äº†è¿›è¡Œæ‹¥å¡æ§åˆ¶çš„å››ç§ç®—æ³•ï¼Œå³æ…¢å¼€å§‹(slow-start)ã€æ‹¥å¡é¿å…(congestion avoidance)ã€å¿«é‡ä¼ (fast retransmit)å’Œå¿«æ¢å¤(fast recovery)ã€‚\n   æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…\nå‘é€æ–¹ç»´æŒä¸€ä¸ªå«åšæ‹¥å¡çª—å£ cwnd (congestion window)çš„çŠ¶æ€å˜é‡ã€‚æ‹¥å¡çª—å£çš„å¤§å°å–å†³äºç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œå¹¶ä¸”åŠ¨æ€åœ°åœ¨å˜åŒ–ã€‚å‘é€æ–¹è®©è‡ªå·±çš„å‘é€çª—å£ç­‰äºæ‹¥å¡çª—å£ã€‚\né€æ–¹æ§åˆ¶æ‹¥å¡çª—å£çš„åŸåˆ™æ˜¯ï¼šåªè¦ç½‘ç»œæ²¡æœ‰å‡ºç°æ‹¥å¡ï¼Œæ‹¥å¡çª—å£å°±å†å¢å¤§ä¸€äº›ï¼Œä»¥ä¾¿æŠŠæ›´å¤šçš„åˆ†ç»„å‘é€å‡ºå»ã€‚ä½†åªè¦ç½‘ç»œå‡ºç°æ‹¥å¡ï¼Œæ‹¥å¡çª—å£å°±å‡å°ä¸€äº›ï¼Œä»¥å‡å°‘æ³¨å…¥åˆ°ç½‘ç»œä¸­çš„åˆ†ç»„æ•°ã€‚\n å‘é€æ–¹åˆæ˜¯å¦‚ä½•çŸ¥é“ç½‘ç»œå‘ç”Ÿäº†æ‹¥å¡å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œå½“ç½‘ç»œå‘ç”Ÿæ‹¥å¡æ—¶ï¼Œè·¯ç”±å™¨å°±è¦ä¸¢å¼ƒåˆ†ç»„ã€‚å› æ­¤åªè¦å‘é€æ–¹æ²¡æœ‰æŒ‰æ—¶æ”¶åˆ°åº”å½“åˆ°è¾¾çš„ç¡®è®¤æŠ¥æ–‡ï¼Œå°±å¯ä»¥çŒœæƒ³ç½‘ç»œå¯èƒ½å‡ºç°äº†æ‹¥å¡ã€‚ç°åœ¨é€šä¿¡çº¿è·¯çš„ä¼ è¾“è´¨é‡ä¸€èˆ¬éƒ½å¾ˆå¥½ï¼Œå› ä¼ è¾“å‡ºå·®é”™è€Œä¸¢å¼ƒåˆ†ç»„çš„æ¦‚ç‡æ˜¯å¾ˆå°çš„ï¼ˆè¿œå°äº1 %ï¼‰ã€‚\n æ…¢å¼€å§‹ç®—æ³•çš„æ€è·¯æ˜¯è¿™æ ·çš„ã€‚å½“ä¸»æœºå¼€å§‹å‘é€æ•°æ®æ—¶ï¼Œå¦‚æœç«‹å³æŠŠå¤§é‡æ•°æ®å­—èŠ‚æ³¨å…¥åˆ°ç½‘ç»œï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œå› ä¸ºç°åœ¨å¹¶ä¸æ¸…æ¥šç½‘ç»œçš„è´Ÿè·æƒ…å†µã€‚\nç»éªŒè¯æ˜ï¼Œè¾ƒå¥½çš„æ–¹æ³•æ˜¯å…ˆæ¢æµ‹ä¸€ä¸‹ï¼Œå³ç”±å°åˆ°å¤§é€æ¸å¢å¤§å‘é€çª—å£ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”±å°åˆ°å¤§é€æ¸å¢å¤§æ‹¥å¡çª—å£æ•°å€¼ã€‚é€šå¸¸åœ¨åˆšåˆšå¼€å§‹å‘é€æŠ¥æ–‡æ®µæ—¶ï¼Œå…ˆæŠŠæ‹¥å¡çª—å£cwndè®¾ç½®ä¸ºä¸€ä¸ªæœ€å¤§æŠ¥æ–‡æ®µMSSçš„æ•°å€¼[æ’å›¾]ã€‚è€Œåœ¨æ¯æ”¶åˆ°ä¸€ä¸ªå¯¹æ–°çš„æŠ¥æ–‡æ®µçš„ç¡®è®¤åï¼ŒæŠŠæ‹¥å¡çª—å£å¢åŠ è‡³å¤šä¸€ä¸ªMSSçš„æ•°å€¼ã€‚ç”¨è¿™æ ·çš„æ–¹æ³•é€æ­¥å¢å¤§å‘é€æ–¹çš„æ‹¥å¡çª—å£cwndï¼Œå¯ä»¥ä½¿åˆ†ç»„æ³¨å…¥åˆ°ç½‘ç»œçš„é€Ÿç‡æ›´åŠ åˆç†ã€‚\næ…¢å¼€å§‹æ‹¥å¡çª—å£å˜åŒ–ï¼š\nå›¾è§£ï¼š\næ‹¥å¡é¿å…ç®—æ³•å°±æ˜¯æŒ‡æ‹¥å¡çª—å£æŒ‰çº¿æ€§è§„å¾‹å¢é•¿ã€‚\nåœ¨TCPæ‹¥å¡æ§åˆ¶çš„æ–‡çŒ®ä¸­ç»å¸¸å¯çœ‹è§â€œä¹˜æ³•å‡å°â€(Multiplicative Decrease)å’Œâ€œåŠ æ³•å¢å¤§â€(Additive Increase)è¿™æ ·çš„ææ³•ã€‚â€œä¹˜æ³•å‡å°â€æ˜¯æŒ‡ä¸è®ºåœ¨æ…¢å¼€å§‹é˜¶æ®µè¿˜æ˜¯æ‹¥å¡é¿å…é˜¶æ®µï¼Œåªè¦å‡ºç°è¶…æ—¶ï¼ˆå³å¾ˆå¯èƒ½å‡ºç°äº†ç½‘ç»œæ‹¥å¡ï¼‰ï¼Œå°±æŠŠæ…¢å¼€å§‹é—¨é™å€¼ssthreshå‡åŠï¼Œå³è®¾ç½®ä¸ºå½“å‰çš„æ‹¥å¡çª—å£çš„ä¸€åŠï¼ˆä¸æ­¤åŒæ—¶ï¼Œæ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼‰ã€‚å½“ç½‘ç»œé¢‘ç¹å‡ºç°æ‹¥å¡æ—¶ï¼Œssthreshå€¼å°±ä¸‹é™å¾—å¾ˆå¿«ï¼Œä»¥å¤§å¤§å‡å°‘æ³¨å…¥åˆ°ç½‘ç»œä¸­çš„åˆ†ç»„æ•°ã€‚è€Œâ€œåŠ æ³•å¢å¤§â€æ˜¯æŒ‡æ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•åï¼Œä½¿æ‹¥å¡çª—å£ç¼“æ…¢å¢å¤§ï¼Œä»¥é˜²æ­¢ç½‘ç»œè¿‡æ—©å‡ºç°æ‹¥å¡ã€‚ä¸Šé¢ä¸¤ç§ç®—æ³•åˆèµ·æ¥å¸¸ç§°ä¸ºAIMDç®—æ³•ï¼ˆåŠ æ³•å¢å¤§ä¹˜æ³•å‡å°ï¼‰ã€‚å¯¹è¿™ç§ç®—æ³•è¿›è¡Œé€‚å½“ä¿®æ”¹åï¼Œåˆå‡ºç°äº†å…¶ä»–ä¸€äº›æ”¹è¿›çš„ç®—æ³•ã€‚ä½†ä½¿ç”¨æœ€å¹¿æ³›çš„è¿˜æ˜¯AIMDç®—æ³•ã€‚\n  å¿«é‡ä¼ å’Œå¿«æ¢å¤\nå¿«é‡ä¼ ç®—æ³•è§„å®šï¼Œå‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µM3ï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…ä¸ºM3è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨åˆ°æœŸã€‚ç”±äºå‘é€æ–¹èƒ½å°½æ—©é‡ä¼ æœªè¢«ç¡®è®¤çš„æŠ¥æ–‡æ®µï¼Œå› æ­¤é‡‡ç”¨å¿«é‡ä¼ åå¯ä»¥ä½¿æ•´ä¸ªç½‘ç»œçš„ååé‡æé«˜çº¦20%ã€‚\nç¤ºæ„å›¾ï¼š\nå¿«é‡ä¼ é…åˆä½¿ç”¨çš„è¿˜æœ‰å¿«æ¢å¤ç®—æ³•ï¼Œå…¶è¿‡ç¨‹æœ‰ä»¥ä¸‹ä¸¤ä¸ªè¦ç‚¹ï¼š\n å½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œâ€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠæ…¢å¼€å§‹é—¨é™ssthreshå‡åŠã€‚è¿™æ˜¯ä¸ºäº†é¢„é˜²ç½‘ç»œå‘ç”Ÿæ‹¥å¡ã€‚è¯·æ³¨æ„ï¼Œæ¥ä¸‹å»ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚ ç”±äºå‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¾ˆå¯èƒ½æ²¡æœ‰å‘ç”Ÿæ‹¥å¡ï¼ˆå¦‚æœç½‘ç»œå‘ç”Ÿäº†ä¸¥é‡çš„æ‹¥å¡ï¼Œå°±ä¸ä¼šä¸€è¿æœ‰å¥½å‡ ä¸ªæŠ¥æ–‡æ®µè¿ç»­åˆ°è¾¾æ¥æ”¶æ–¹ï¼Œä¹Ÿå°±ä¸ä¼šå¯¼è‡´æ¥æ”¶æ–¹è¿ç»­å‘é€é‡å¤ç¡®è®¤ï¼‰ï¼Œå› æ­¤ä¸æ…¢å¼€å§‹ä¸åŒä¹‹å¤„æ˜¯ç°åœ¨ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼ˆå³æ‹¥å¡çª—å£cwndç°åœ¨ä¸è®¾ç½®ä¸º1ï¼‰ï¼Œè€Œæ˜¯æŠŠcwndå€¼è®¾ç½®ä¸ºæ…¢å¼€å§‹é—¨é™ssthreshå‡åŠåçš„æ•°å€¼ï¼Œç„¶åå¼€å§‹æ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ï¼ˆâ€œåŠ æ³•å¢å¤§â€ï¼‰ï¼Œä½¿æ‹¥å¡çª—å£ç¼“æ…¢åœ°çº¿æ€§å¢å¤§ã€‚  ç¤ºæ„å›¾ï¼š\n  å¦‚æœæŠŠæ‹¥å¡æ§åˆ¶å’Œæ¥æ”¶æ–¹å¯¹å‘é€æ–¹çš„æµé‡æ§åˆ¶ä¸€èµ·è€ƒè™‘ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œå‘é€æ–¹çš„çª—å£çš„ä¸Šé™å€¼åº”å½“å–ä¸ºæ¥æ”¶æ–¹çª—å£rwndå’Œæ‹¥å¡çª—å£cwndè¿™ä¸¤ä¸ªå˜é‡ä¸­è¾ƒå°çš„ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š\næµé‡æ§åˆ¶ æ»‘åŠ¨çª—å£\næ‹¥å¡æ§åˆ¶ å¿«é‡ä¼ ã€å¿«æ¢å¤ã€è¶…æ—¶é‡ä¼ ï¼Œæ‹¥å¡é¿å…\nUDPğŸ“¦ UDPä¸€æ¬¡äº¤ä»˜ä¸€ä¸ªå®Œæ•´çš„æŠ¥æ–‡ï¼Œä¸ä¼šå¯¹æŠ¥æ–‡è¿›è¡Œæ‹†åˆ†ã€‚å› æ­¤ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»é€‰æ‹©åˆé€‚å¤§å°çš„æŠ¥æ–‡ã€‚è‹¥æŠ¥æ–‡å¤ªé•¿ï¼ŒUDPæŠŠå®ƒäº¤ç»™IPå±‚åï¼ŒIPå±‚åœ¨ä¼ é€æ—¶å¯èƒ½è¦è¿›è¡Œåˆ†ç‰‡ï¼Œè¿™ä¼šé™ä½IPå±‚çš„æ•ˆç‡ã€‚åä¹‹ï¼Œè‹¥æŠ¥æ–‡å¤ªçŸ­ï¼ŒUDPæŠŠå®ƒäº¤ç»™IPå±‚åï¼Œä¼šä½¿IPæ•°æ®æŠ¥çš„é¦–éƒ¨çš„ç›¸å¯¹é•¿åº¦å¤ªå¤§ï¼Œè¿™ä¹Ÿé™ä½äº†IPå±‚çš„æ•ˆç‡ã€‚\nUDPæ•°æ®æŠ¥æ ¼å¼ï¼š(é¦–éƒ¨8å­—èŠ‚)\nä¼ªæŠ¥å¤´æ ¼å¼ï¼š\n **æ ¡éªŒå’Œè®¡ç®—ï¼š**ä¼ªæŠ¥å¤´+UDPæ•°æ®æŠ¥\n ä¼ªæŠ¥å¤´çš„ä½œç”¨æ˜¯éªŒè¯UDPæ•°æ®æŠ¥æ˜¯å¦æ­£ç¡®ä¼ é€åˆ°ç›®çš„è¿›ç¨‹ã€‚\nè®¡ç®—æ ¡éªŒå’Œï¼š\nåœ¨å‘é€æ–¹ï¼Œé¦–å…ˆæ˜¯å…ˆæŠŠå…¨é›¶æ”¾å…¥æ£€éªŒå’Œå­—æ®µã€‚å†æŠŠä¼ªé¦–éƒ¨ä»¥åŠUDPç”¨æˆ·æ•°æ®æŠ¥çœ‹æˆæ˜¯ç”±è®¸å¤š16ä½çš„å­—ä¸²æ¥èµ·æ¥ã€‚è‹¥UDPç”¨æˆ·æ•°æ®æŠ¥çš„æ•°æ®éƒ¨åˆ†ä¸æ˜¯å¶æ•°ä¸ªå­—èŠ‚ï¼Œåˆ™è¦å¡«å…¥ä¸€ä¸ªå…¨é›¶å­—èŠ‚ï¼ˆä½†æ­¤å­—èŠ‚ä¸å‘é€ï¼‰ã€‚ç„¶åæŒ‰äºŒè¿›åˆ¶åç è®¡ç®—å‡ºè¿™äº›16ä½å­—çš„å’Œã€‚å°†æ­¤å’Œçš„äºŒè¿›åˆ¶åç å†™å…¥æ£€éªŒå’Œå­—æ®µåï¼Œå°±å‘é€è¿™æ ·çš„UDPç”¨æˆ·æ•°æ®æŠ¥ã€‚åœ¨æ¥æ”¶æ–¹ï¼ŒæŠŠæ”¶åˆ°çš„UDPç”¨æˆ·æ•°æ®æŠ¥è¿åŒä¼ªé¦–éƒ¨ï¼ˆä»¥åŠå¯èƒ½çš„å¡«å……å…¨é›¶å­—èŠ‚ï¼‰ä¸€èµ·ï¼ŒæŒ‰äºŒè¿›åˆ¶åç æ±‚è¿™äº›16ä½å­—çš„å’Œã€‚å½“æ— å·®é”™æ—¶å…¶ç»“æœåº”ä¸ºå…¨1ã€‚\n äºŒè¿›åˆ¶åç æ±‚å’Œï¼š0å’Œ0ç›¸åŠ æ˜¯0ï¼Œä½†è¦äº§ç”Ÿä¸€ä¸ªè¿›ä½1ï¼Œ0å’Œ1ç›¸åŠ æ˜¯1ï¼Œ1å’Œ1ç›¸åŠ æ˜¯0ã€‚è‹¥æœ€é«˜ä½ç›¸åŠ åäº§ç”Ÿè¿›ä½ï¼Œåˆ™æœ€åå¾—åˆ°çš„ç»“æœè¦åŠ 1ã€‚\nï¼ˆ0ï¼‰å + ï¼ˆ0ï¼‰å = 1 + 1 = 10\nï¼ˆ1ï¼‰å +ï¼ˆ0ï¼‰å=0+ 1 =1\nï¼ˆ1ï¼‰å + ï¼ˆ1ï¼‰å = 0 + 0 = 0\n\u0026ldquo;äºŒè¿›åˆ¶åç æ±‚å’Œ\u0026rdquo; ç­‰ä»·äº \u0026ldquo;äºŒè¿›åˆ¶æ±‚å’Œå†å–å\u0026rdquo;\näºŒè¿›åˆ¶æ±‚å‡ºçš„å’Œå¦‚æœå¤§äº16ä½æ—¶æ‰€åšçš„æ“ä½œ,ç”¨å’Œå€¼ä¸­é«˜16ä½åŠ ä¸Šä½16ä½çš„å€¼ä½œä¸ºæœ€ç»ˆçš„å’Œå€¼,ç„¶åå†åšå–åè¿ç®—.\n ä¸‹é¢æ˜¯è®¡ç®—æ ¡éªŒå’Œçš„ä¸€ä¸ªä¾‹å­ï¼š\n è¿™æ ·çš„æ£€éªŒå’Œï¼Œæ—¢æ£€æŸ¥äº†UDPç”¨æˆ·æ•°æ®æŠ¥çš„æºç«¯å£å·å’Œç›®çš„ç«¯å£å·ä»¥åŠUDPç”¨æˆ·æ•°æ®æŠ¥çš„æ•°æ®éƒ¨åˆ†ï¼Œåˆæ£€æŸ¥äº†IPæ•°æ®æŠ¥çš„æºIPåœ°å€å’Œç›®çš„åœ°å€ã€‚\n  ç½‘å¡æ”¶åˆ°ä¸€æ¡æ•°æ®åˆ°è¿›ç¨‹å¤„ç†æ•°æ®,è¿™ä¹‹é—´ç»å†äº†ä»€ä¹ˆ(ä¸­æ–­çš„ä¸ŠåŠéƒ¨ä¸‹åŠéƒ¨,ç½‘ç»œå±‚åè®®æ‹†åŒ…)ï¼Ÿ\næ‹¥å¡æ§åˆ¶ç®—æ³• TCPæ‹¥å¡æ§åˆ¶ç®—æ³•çš„ç›®çš„å¯ä»¥ç®€å•æ¦‚æ‹¬ä¸ºï¼šå…¬å¹³ç«äº‰ã€å……åˆ†åˆ©ç”¨ç½‘ç»œå¸¦å®½ã€é™ä½ç½‘ç»œå»¶æ—¶ã€ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œç„¶è€Œå°±ç›®å‰è€Œè¨€è¦å®ç°è¿™äº›ç›®æ ‡å°±éš¾å…æœ‰æƒè¡¡å’Œå–èˆã€‚\nç®—æ³•åˆ†ç±» åŸºäºä¸¢åŒ…ç­–ç•¥çš„ä¼ ç»Ÿæ‹¥å¡æ§åˆ¶ç®—æ³•çš„å‡ ä¸ªè¿­ä»£ç‰ˆæœ¬ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\nä¸æ­¤åŒæ—¶è¿˜æœ‰ä¸€ç±»ç®—æ³•æ˜¯åŸºäºRTTå»¶æ—¶ç­–ç•¥æ¥è¿›è¡Œæ§åˆ¶çš„ï¼Œä½†æ˜¯è¿™ç±»ç®—æ³•åœ¨å‘åŒ…é€Ÿç‡ä¸Šå¯èƒ½ä¸å¤Ÿæ¿€è¿›ï¼Œç«äº‰æ€§èƒ½ä¸å¦‚å…¶ä»–ç®—æ³•ï¼Œå› æ­¤åœ¨å…±äº«ç½‘ç»œå¸¦å®½æ—¶æœ‰å¤±å…¬å¹³æ€§ï¼Œä½†æ˜¯ç®—æ³•é€Ÿç‡æ›²çº¿å´æ˜¯å¾ˆå¹³æ»‘\nå¦‚ä½•æ„ŸçŸ¥æ‹¥å¡ åœ¨TCPè¿æ¥çš„å‘é€æ–¹ä¸€èˆ¬æ˜¯åŸºäºä¸¢åŒ…æ¥åˆ¤æ–­å½“å‰ç½‘ç»œæ˜¯å¦å‘ç”Ÿæ‹¥å¡ï¼Œä¸¢åŒ…å¯ä»¥ç”±é‡ä¼ è¶…æ—¶RTOå’Œé‡å¤ç¡®è®¤æ¥åšåˆ¤æ–­ã€‚\næ‹¥å¡æ§åˆ¶åŸºæœ¬ç­–ç•¥ æ‹¥å¡æ§åˆ¶æ˜¯ä¸€ä¸ªåŠ¨æ€çš„è¿‡ç¨‹ï¼Œå®ƒæ—¢è¦æé«˜å¸¦å®½åˆ©ç”¨ç‡å‘é€å°½é‡å¤šçš„æ•°æ®åˆè¦é¿å…ç½‘ç»œæ‹¥å µä¸¢åŒ…RTTå¢å¤§ç­‰é—®é¢˜ï¼ŒåŸºäºè¿™ç§é«˜è¦æ±‚å¹¶ä¸æ˜¯å•ä¸€ç­–ç•¥å¯ä»¥æå®šçš„ï¼Œå› æ­¤TCPçš„ æ‹¥å¡æ§åˆ¶ç­–ç•¥å®é™…ä¸Šæ˜¯åˆ†é˜¶æ®µåˆ†ç­–ç•¥çš„ç»¼åˆè¿‡ç¨‹ï¼š\nTCP Tahoe å’ŒTCP Reno\nè¿™ä¸¤ä¸ªç®—æ³•ä»£å·å–è‡ªå¤ªæµ©æ¹–Lakeå’ŒTahoeé‡Œè¯ºå¸‚ï¼Œä¸¤è€…ç®—æ³•å¤§è‡´ä¸€è‡´ï¼Œå¯¹äºä¸¢åŒ…äº‹ä»¶åˆ¤æ–­éƒ½æ˜¯ä»¥é‡ä¼ è¶…æ—¶retransmission timeoutå’Œé‡å¤ç¡®è®¤ä¸ºæ¡ä»¶ï¼Œä½†æ˜¯å¯¹äºé‡å¤ç¡®è®¤çš„å¤„ç†ä¸¤è€…æœ‰æ‰€ä¸åŒï¼Œå¯¹äºè¶…æ—¶é‡ä¼ RTOæƒ…å†µä¸¤ä¸ªç®—æ³•éƒ½æ˜¯å°†æ‹¥å¡çª—å£é™ä¸º1ä¸ªMSSï¼Œç„¶åè¿›å…¥æ…¢å¯åŠ¨é˜¶æ®µã€‚\nTCP Tahoeç®—æ³•ï¼šå¦‚æœæ”¶åˆ°ä¸‰æ¬¡é‡å¤ç¡®è®¤å³ç¬¬å››æ¬¡æ”¶åˆ°ç›¸åŒç¡®è®¤å·çš„åˆ†æ®µç¡®è®¤ï¼Œå¹¶ä¸”åˆ†æ®µå¯¹åº”åŒ…æ— è´Ÿè½½åˆ†æ®µå’Œæ— æ”¹å˜æ¥æ”¶çª—å£çš„è¯ï¼ŒTahoeç®—æ³•åˆ™è¿›å…¥å¿«é€Ÿé‡ä¼ ï¼Œå°†æ…¢å¯åŠ¨é˜ˆå€¼æ”¹ä¸ºå½“å‰æ‹¥å¡çª—å£çš„ä¸€åŠï¼Œå°†æ‹¥å¡çª—å£é™ä¸º1ä¸ªMSSï¼Œå¹¶é‡æ–°è¿›å…¥æ…¢å¯åŠ¨é˜¶æ®µã€‚\nTCP Renoç®—æ³•ï¼šå¦‚æœæ”¶åˆ°ä¸‰æ¬¡é‡å¤ç¡®è®¤ï¼ŒRenoç®—æ³•åˆ™è¿›å…¥å¿«é€Ÿé‡ä¼ åªå°†æ‹¥å¡çª—å£å‡åŠæ¥è·³è¿‡æ…¢å¯åŠ¨é˜¶æ®µï¼Œå°†æ…¢å¯åŠ¨é˜ˆå€¼è®¾ä¸ºå½“å‰æ–°çš„æ‹¥å¡çª—å£å€¼ï¼Œè¿›å…¥ä¸€ä¸ªç§°ä¸ºå¿«é€Ÿæ¢å¤çš„æ–°è®¾è®¡é˜¶æ®µã€‚TCP New Reno\nTCP New Renoæ˜¯å¯¹TCP Renoä¸­å¿«é€Ÿæ¢å¤é˜¶æ®µçš„é‡ä¼ è¿›è¡Œæ”¹å–„çš„ä¸€ç§æ”¹è¿›ç®—æ³•ï¼ŒNew Renoåœ¨ä½é”™è¯¯ç‡æ—¶è¿è¡Œæ•ˆç‡å’Œé€‰æ‹©ç¡®è®¤SACKç›¸å½“ï¼Œåœ¨é«˜é”™è¯¯ç‡ä»ä¼˜äºRenoã€‚\nTCP BIC å’ŒTCP CUBIC\nTCP BICæ—¨åœ¨ä¼˜åŒ–é«˜é€Ÿé«˜å»¶è¿Ÿç½‘ç»œçš„æ‹¥å¡æ§åˆ¶ï¼Œå…¶æ‹¥å¡çª—å£ç®—æ³•ä½¿ç”¨äºŒåˆ†æœç´¢ç®—æ³•å°è¯•æ‰¾åˆ°èƒ½é•¿æ—¶é—´ä¿æŒæ‹¥å¡çª—å£æœ€å¤§å€¼ï¼ŒLinuxå†…æ ¸åœ¨2.6.8è‡³2.6.18ä½¿ç”¨è¯¥ç®—æ³•ä½œä¸ºé»˜è®¤TCPæ‹¥å¡ç®—æ³•ã€‚\nCUBICåˆ™æ˜¯æ¯”BICæ›´æ¸©å’Œå’Œç³»ç»ŸåŒ–çš„åˆ†æ”¯ç‰ˆæœ¬ï¼Œå…¶ä½¿ç”¨ä¸‰æ¬¡å‡½æ•°ä»£æ›¿äºŒåˆ†ç®—æ³•ä½œä¸ºå…¶æ‹¥å¡çª—å£ç®—æ³•ï¼Œå¹¶ä¸”ä½¿ç”¨å‡½æ•°æ‹ç‚¹ä½œä¸ºæ‹¥å¡çª—å£çš„è®¾ç½®å€¼ï¼ŒLinuxå†…æ ¸åœ¨2.6.19åä½¿ç”¨è¯¥ç®—æ³•ä½œä¸ºé»˜è®¤TCPæ‹¥å¡ç®—æ³•ã€‚\nTCP PRR\nTCP PRRæ˜¯æ—¨åœ¨æ¢å¤æœŸé—´æé«˜å‘é€æ•°æ®çš„å‡†ç¡®æ€§ï¼Œè¯¥ç®—æ³•ç¡®ä¿æ¢å¤åçš„æ‹¥å¡çª—å£å¤§å°å°½å¯èƒ½æ¥è¿‘æ…¢å¯åŠ¨é˜ˆå€¼ã€‚åœ¨Googleè¿›è¡Œçš„æµ‹è¯•ä¸­ï¼Œèƒ½å°†å¹³å‡å»¶è¿Ÿé™ä½3~10%æ¢å¤è¶…æ—¶å‡å°‘5%ï¼ŒPRRç®—æ³•åä½œä¸ºLinuxå†…æ ¸3.2ç‰ˆæœ¬é»˜è®¤æ‹¥å¡ç®—æ³•ã€‚\nTCP BBRæ˜¯ç”±Googleè®¾è®¡äº2016å¹´å‘å¸ƒçš„æ‹¥å¡ç®—æ³•ï¼Œè¯¥ç®—æ³•è®¤ä¸ºéšç€ç½‘ç»œæ¥å£æ§åˆ¶å™¨é€æ¸è¿›å…¥åƒå…†é€Ÿåº¦æ—¶ï¼Œåˆ†ç»„ä¸¢å¤±ä¸åº”è¯¥è¢«è®¤ä¸ºæ˜¯è¯†åˆ«æ‹¥å¡çš„ä¸»è¦å†³å®šå› ç´ ï¼Œæ‰€ä»¥åŸºäºæ¨¡å‹çš„æ‹¥å¡æ§åˆ¶ç®—æ³•èƒ½æœ‰æ›´é«˜çš„ååé‡å’Œæ›´ä½çš„å»¶è¿Ÿï¼Œå¯ä»¥ç”¨BBRæ¥æ›¿ä»£å…¶ä»–æµè¡Œçš„æ‹¥å¡ç®—æ³•ã€‚\nGoogleåœ¨YouTubeä¸Šåº”ç”¨è¯¥ç®—æ³•ï¼Œå°†å…¨çƒå¹³å‡çš„YouTubeç½‘ç»œååé‡æé«˜äº†4%ï¼ŒBBRä¹‹åç§»æ¤å…¥Linuxå†…æ ¸4.9ç‰ˆæœ¬ã€‚\nå…¶ä¸­æ¯”è¾ƒæœ‰åçš„Vegasç®—æ³•æ˜¯å¤§çº¦åœ¨1995å¹´ç”±äºšåˆ©æ¡‘é‚£å¤§å­¦çš„ç ”ç©¶äººå‘˜æ‹‰é‡ŒÂ·å½¼å¾—æ£®å’ŒåŠ³ä¼¦æ–¯Â·å¸ƒæ‹‰ç§‘å¤«æå‡ºï¼Œè¿™ä¸ªæ–°çš„TCPæ‹¥å¡ç®—æ³•ä»¥å†…åè¾¾å·æœ€å¤§çš„åŸå¸‚æ‹‰æ–¯ç»´åŠ æ–¯å‘½åï¼Œåæˆä¸ºTCP Vegasç®—æ³•ã€‚\nå…³äºåŸºäºRTTçš„TCP Vegasç®—æ³•çš„è¯¦ç»†ä»‹ç»å¯ä»¥æŸ¥é˜…æ–‡æ¡£ï¼š\n http://www.cs.cmu.edu/~srini/15-744/F02/readings/BP95.pdf\n æ–‡æ¡£å¯¹Vegasç®—æ³•å’ŒNew Renoåšäº†ä¸€äº›å¯¹æ¯”ï¼Œæˆ‘ä»¬ä»ç›´è§‚å›¾å½¢ä¸Šå¯ä»¥çœ‹åˆ°Vegasç®—æ³•æ›´åŠ å¹³æ»‘ï¼Œç›¸åNew Renoåˆ™è¡¨ç°é™¤äº†è¾ƒå¤§çš„æ³¢åŠ¨å‘ˆé”¯é½¿çŠ¶ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\nå®é™…ä¸Šè¿˜æœ‰æ›´ç»†ç²’åº¦çš„åˆ†ç±»ï¼Œç”±äºä¸æ˜¯ä»Šå¤©çš„é‡ç‚¹ï¼Œå°±ä¸å†æ·±å…¥å±•å¼€äº†ï¼Œå½“å‰ä½¿ç”¨çš„æ‹¥å¡æ§åˆ¶ç®—æ³•è¿˜æ˜¯åŸºäºä¸¢åŒ…Loss-Basedä½œä¸ºä¸»æµã€‚\nå‚è€ƒï¼š\n ä¸‡å­—é•¿æ–‡|å…¨ç½‘æœ€å¼º TCP/IP æ‹¥å¡æ§åˆ¶æ€»ç»“\u0026hellip; ä¸‡å­—è¯¦æ–‡ï¼šTCP æ‹¥å¡æ§åˆ¶è¯¦è§£  ä¸€æ³¡å°¿çš„æ—¶é—´ï¼Œå¿«é€Ÿè¯»æ‡‚QUICåè®® å¦‚ä½•è®©ç½‘ç»œæ•°æ®ä¼ è¾“åœ°æ›´å¿«ï¼Ÿ(åˆå¹¶ä¸€äº›å±‚)\nä¸ºä»€ä¹ˆéœ€è¦QUICï¼Ÿ   ä¸­é—´è®¾å¤‡çš„åƒµåŒ–\nå¯èƒ½æ˜¯ TCP åè®®ä½¿ç”¨å¾—å¤ªä¹…ï¼Œä¹Ÿéå¸¸å¯é ã€‚æ‰€ä»¥æˆ‘ä»¬å¾ˆå¤šä¸­é—´è®¾å¤‡ï¼ŒåŒ…æ‹¬é˜²ç«å¢™ã€NAT ç½‘å…³ï¼Œæ•´æµå™¨ç­‰å‡ºç°äº†ä¸€äº›çº¦å®šä¿—æˆçš„åŠ¨ä½œã€‚\n  ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„å®ç°å¯¼è‡´åè®®åƒµåŒ–\nTCP æ˜¯ç”±æ“ä½œç³»ç»Ÿåœ¨å†…æ ¸è¥¿æ–¹æ ˆå±‚é¢å®ç°çš„ï¼Œåº”ç”¨ç¨‹åºåªèƒ½ä½¿ç”¨ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ã€‚è™½ç„¶åº”ç”¨ç¨‹åºçš„æ›´æ–°è¿­ä»£éå¸¸å¿«é€Ÿå’Œç®€å•ã€‚ä½†æ˜¯ TCP çš„è¿­ä»£å´éå¸¸ç¼“æ…¢ï¼ŒåŸå› å°±æ˜¯æ“ä½œç³»ç»Ÿå‡çº§å¾ˆéº»çƒ¦ã€‚\n  å»ºç«‹è¿æ¥çš„æ¡æ‰‹å»¶è¿Ÿå¤§\nä¸ç®¡æ˜¯ HTTP1.0/1.1 è¿˜æ˜¯ HTTPSï¼ŒHTTP2ï¼Œéƒ½ä½¿ç”¨äº† TCP è¿›è¡Œä¼ è¾“ã€‚HTTPS å’Œ HTTP2 è¿˜éœ€è¦ä½¿ç”¨ TLS åè®®æ¥è¿›è¡Œå®‰å…¨ä¼ è¾“ã€‚è¿™å°±å‡ºç°äº†ä¸¤ä¸ªæ¡æ‰‹å»¶è¿Ÿï¼š\n  TCP ä¸‰æ¬¡æ¡æ‰‹å¯¼è‡´çš„ TCP è¿æ¥å»ºç«‹çš„å»¶è¿Ÿã€‚\n  TLS å®Œå…¨æ¡æ‰‹éœ€è¦è‡³å°‘ 2 ä¸ª RTT æ‰èƒ½å»ºç«‹ï¼Œç®€åŒ–æ¡æ‰‹éœ€è¦ 1 ä¸ª RTT çš„æ¡æ‰‹å»¶è¿Ÿã€‚\n  å¯¹äºå¾ˆå¤šçŸ­è¿æ¥åœºæ™¯ï¼Œè¿™æ ·çš„æ¡æ‰‹å»¶è¿Ÿå½±å“å¾ˆå¤§ï¼Œä¸”æ— æ³•æ¶ˆé™¤ã€‚\n  é˜Ÿå¤´é˜»å¡\né˜Ÿå¤´é˜»å¡ä¸»è¦æ˜¯ TCP åè®®çš„å¯é æ€§æœºåˆ¶å¼•å…¥çš„ã€‚TCP ä½¿ç”¨åºåˆ—å·æ¥æ ‡è¯†æ•°æ®çš„é¡ºåºï¼Œæ•°æ®å¿…é¡»æŒ‰ç…§é¡ºåºå¤„ç†ï¼Œå¦‚æœå‰é¢çš„æ•°æ®ä¸¢å¤±ï¼Œåé¢çš„æ•°æ®å°±ç®—åˆ°è¾¾äº†ä¹Ÿä¸ä¼šé€šçŸ¥åº”ç”¨å±‚æ¥å¤„ç†ã€‚\nå¦å¤– TLS åè®®å±‚é¢ä¹Ÿæœ‰ä¸€ä¸ªé˜Ÿå¤´é˜»å¡ï¼Œå› ä¸º TLS åè®®éƒ½æ˜¯æŒ‰ç…§ record æ¥å¤„ç†æ•°æ®çš„ï¼Œå¦‚æœä¸€ä¸ª record ä¸­ä¸¢å¤±äº†æ•°æ®ï¼Œä¹Ÿä¼šå¯¼è‡´æ•´ä¸ª record æ— æ³•æ­£ç¡®å¤„ç†ã€‚\n  QUIC åè®®é€‰æ‹©äº† UDPï¼Œå› ä¸º UDP æœ¬èº«æ²¡æœ‰è¿æ¥çš„æ¦‚å¿µï¼Œä¸éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¼˜åŒ–äº†è¿æ¥å»ºç«‹çš„æ¡æ‰‹å»¶è¿Ÿï¼ŒåŒæ—¶åœ¨åº”ç”¨ç¨‹åºå±‚é¢å®ç°äº† TCP çš„å¯é æ€§ï¼ŒTLS çš„å®‰å…¨æ€§å’Œ HTTP2 çš„å¹¶å‘æ€§ï¼Œåªéœ€è¦ç”¨æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„åº”ç”¨ç¨‹åºæ”¯æŒ QUIC åè®®ï¼Œå®Œå…¨é¿å¼€äº†æ“ä½œç³»ç»Ÿå’Œä¸­é—´è®¾å¤‡çš„é™åˆ¶ã€‚\nQUIC æ˜¯ Quick UDP Internet Connections çš„ç¼©å†™ï¼Œè°·æ­Œå‘æ˜çš„æ–°ä¼ è¾“åè®®ã€‚\n ä¸ TCP ç›¸æ¯”ï¼ŒQUIC å¯ä»¥å‡å°‘å»¶è¿Ÿã€‚\n QUIC åè®®å¯ä»¥åœ¨ 1 åˆ° 2 ä¸ªæ•°æ®åŒ…ï¼ˆå–å†³äºè¿æ¥çš„æœåŠ¡å™¨æ˜¯æ–°çš„è¿˜æ˜¯å·²çŸ¥çš„ï¼‰å†…ï¼Œå®Œæˆè¿æ¥çš„åˆ›å»ºï¼ˆåŒ…æ‹¬ TLSï¼‰ã€‚\nQUIC ä¸ç°æœ‰ TCP + TLS + HTTP/2 æ–¹æ¡ˆç›¸æ¯”ï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹ä¸»è¦ç‰¹å¾ï¼š\n åˆ©ç”¨ç¼“å­˜ï¼Œæ˜¾è‘—å‡å°‘è¿æ¥å»ºç«‹æ—¶é—´ï¼›(å‡å°‘äº† TCP ä¸‰æ¬¡æ¡æ‰‹åŠ TLS æ¡æ‰‹æ—¶é—´) æ”¹å–„æ‹¥å¡æ§åˆ¶ï¼Œæ‹¥å¡æ§åˆ¶ä»å†…æ ¸ç©ºé—´åˆ°ç”¨æˆ·ç©ºé—´ï¼› æ²¡æœ‰ head of line é˜»å¡çš„å¤šè·¯å¤ç”¨ï¼› å‰å‘çº é”™ï¼Œå‡å°‘é‡ä¼ ï¼› è¿æ¥å¹³æ»‘è¿ç§»ï¼Œç½‘ç»œçŠ¶æ€çš„å˜æ›´ä¸ä¼šå½±å“è¿æ¥æ–­çº¿ã€‚  æ‹¥å¡æ§åˆ¶ã€åŠ å¯†å’Œä¸€äº›HTTP/2çš„ç‰¹æ€§éƒ½ç§»åŠ¨åˆ°QUICå±‚å»äº†\nä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼ŒQUIC åº•å±‚é€šè¿‡ UDP åè®®æ›¿ä»£äº† TCPï¼Œä¸Šå±‚åªéœ€è¦ä¸€å±‚ç”¨äºå’Œè¿œç¨‹æœåŠ¡å™¨äº¤äº’çš„ HTTP/2 APIã€‚è¿™æ˜¯å› ä¸º QUIC åè®®å·²ç»åŒ…å«äº†å¤šè·¯å¤ç”¨å’Œè¿æ¥ç®¡ç†ï¼ŒHTTP API åªéœ€è¦å®Œæˆ HTTP åè®®çš„è§£æå³å¯ã€‚\nQUICä¹Ÿåˆå¹¶äº†TLSæ¡æ‰‹è¿‡ç¨‹åˆ°å®ƒçš„è¿æ¥è¿‡ç¨‹ä¹‹ä¸­\nç›®æ ‡ QUIC åè®®çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯ä¸ºäº†æ•´åˆ TCP åè®®çš„å¯é æ€§å’Œ UDP åè®®çš„é€Ÿåº¦å’Œæ•ˆç‡ã€‚\nQUICè¿æ¥è¿‡ç¨‹ Step1ï¼šé¦–æ¬¡è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å‘é€ Inchoate Client Hello ç»™æœåŠ¡ç«¯ï¼Œç”¨äºè¯·æ±‚è¿æ¥ï¼›\nStep2ï¼šæœåŠ¡ç«¯ç”Ÿæˆ gã€pã€aï¼Œæ ¹æ® gã€p å’Œ a ç®—å‡º Aï¼Œç„¶åå°† gã€pã€A æ”¾åˆ° Server Config ä¸­å†å‘é€ Rejection æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼›\nStep3ï¼šå®¢æˆ·ç«¯æ¥æ”¶åˆ° gã€pã€A åï¼Œè‡ªå·±å†ç”Ÿæˆ bï¼Œæ ¹æ® gã€pã€b ç®—å‡º Bï¼Œæ ¹æ® Aã€pã€b ç®—å‡ºåˆå§‹å¯†é’¥ Kã€‚B å’Œ K ç®—å¥½åï¼Œå®¢æˆ·ç«¯ä¼šç”¨ K åŠ å¯† HTTP æ•°æ®ï¼Œè¿åŒ B ä¸€èµ·å‘é€ç»™æœåŠ¡ç«¯ï¼›\nStep4ï¼šæœåŠ¡ç«¯æ¥æ”¶åˆ° B åï¼Œæ ¹æ® aã€pã€B ç”Ÿæˆä¸å®¢æˆ·ç«¯åŒæ ·çš„å¯†é’¥ï¼Œå†ç”¨è¿™å¯†é’¥è§£å¯†æ”¶åˆ°çš„ HTTP æ•°æ®ã€‚ä¸ºäº†è¿›ä¸€æ­¥çš„å®‰å…¨ï¼ˆå‰å‘å®‰å…¨æ€§ï¼‰ï¼ŒæœåŠ¡ç«¯ä¼šæ›´æ–°è‡ªå·±çš„éšæœºæ•° a å’Œå…¬é’¥ï¼Œå†ç”Ÿæˆæ–°çš„å¯†é’¥ Sï¼Œç„¶åæŠŠå…¬é’¥é€šè¿‡ Server Hello å‘é€ç»™å®¢æˆ·ç«¯ã€‚è¿åŒ Server Hello æ¶ˆæ¯ï¼Œè¿˜æœ‰ HTTP è¿”å›æ•°æ®ï¼›\nStep5ï¼šå®¢æˆ·ç«¯æ”¶åˆ° Server Hello åï¼Œç”Ÿæˆä¸æœåŠ¡ç«¯ä¸€è‡´çš„æ–°å¯†é’¥ Sï¼Œåé¢çš„ä¼ è¾“éƒ½ä½¿ç”¨ S åŠ å¯†ã€‚\nè¿™æ ·ï¼ŒQUIC ä»è¯·æ±‚è¿æ¥åˆ°æ­£å¼æ¥å‘ HTTP æ•°æ®ä¸€å…±èŠ±äº† 1 RTTï¼Œè¿™ 1 ä¸ª RTT ä¸»è¦æ˜¯ä¸ºäº†è·å– Server Configï¼Œåé¢çš„è¿æ¥å¦‚æœå®¢æˆ·ç«¯ç¼“å­˜äº† Server Configï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥å‘é€ HTTP æ•°æ®ï¼Œå®ç° 0 RTT å»ºç«‹è¿æ¥ã€‚\nè¿™é‡Œä½¿ç”¨çš„æ˜¯ DH å¯†é’¥äº¤æ¢ç®—æ³•ï¼ŒDH ç®—æ³•çš„æ ¸å¿ƒå°±æ˜¯æœåŠ¡ç«¯ç”Ÿæˆ aã€gã€p 3 ä¸ªéšæœºæ•°ï¼Œa è‡ªå·±æŒæœ‰ï¼Œg å’Œ p è¦ä¼ è¾“ç»™å®¢æˆ·ç«¯ï¼Œè€Œå®¢æˆ·ç«¯ä¼šç”Ÿæˆ b è¿™ 1 ä¸ªéšæœºæ•°ï¼Œé€šè¿‡ DH ç®—æ³•å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯ä»¥ç®—å‡ºåŒæ ·çš„å¯†é’¥ã€‚åœ¨è¿™è¿‡ç¨‹ä¸­ a å’Œ b å¹¶ä¸å‚ä¸ç½‘ç»œä¼ è¾“ï¼Œå®‰å…¨æ€§å¤§å¤§æé«˜ã€‚å› ä¸º p å’Œ g æ˜¯å¤§æ•°ï¼Œæ‰€ä»¥å³ä½¿åœ¨ç½‘ç»œä¸­ä¼ è¾“çš„ pã€gã€Aã€B éƒ½è¢«åŠ«æŒï¼Œé‚£ä¹ˆé ç°åœ¨çš„è®¡ç®—æœºç®—åŠ›ä¹Ÿæ²¡æ³•ç ´è§£å¯†é’¥ã€‚\nQUICè¿æ¥è¿ç§»  å½“æ‰‹æœºä»æ•°æ®ä¿¡å·åˆ‡æ¢åˆ°WIFIä¿¡å·æ—¶éœ€è¦å¯ä»¥çµæ´»çš„è¿›è¡Œè¿æ¥çš„åˆ‡æ¢ã€‚\n TCP è¿æ¥åŸºäºå››å…ƒç»„ï¼ˆæº IPã€æºç«¯å£ã€ç›®çš„ IPã€ç›®çš„ç«¯å£ï¼‰ï¼Œåˆ‡æ¢ç½‘ç»œæ—¶è‡³å°‘ä¼šæœ‰ä¸€ä¸ªå› ç´ å‘ç”Ÿå˜åŒ–ï¼Œå¯¼è‡´è¿æ¥å‘ç”Ÿå˜åŒ–ã€‚å½“è¿æ¥å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¦‚æœè¿˜ä½¿ç”¨åŸæ¥çš„ TCP è¿æ¥ï¼Œåˆ™ä¼šå¯¼è‡´è¿æ¥å¤±è´¥ï¼Œå°±å¾—ç­‰åŸæ¥çš„è¿æ¥è¶…æ—¶åé‡æ–°å»ºç«‹è¿æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰æ—¶å€™å‘ç°åˆ‡æ¢åˆ°ä¸€ä¸ªæ–°ç½‘ç»œæ—¶ï¼Œå³ä½¿æ–°ç½‘ç»œçŠ¶å†µè‰¯å¥½ï¼Œä½†å†…å®¹è¿˜æ˜¯éœ€è¦åŠ è½½å¾ˆä¹…ã€‚å¦‚æœå®ç°å¾—å¥½ï¼Œå½“æ£€æµ‹åˆ°ç½‘ç»œå˜åŒ–æ—¶ç«‹åˆ»å»ºç«‹æ–°çš„ TCP è¿æ¥ï¼Œå³ä½¿è¿™æ ·ï¼Œå»ºç«‹æ–°çš„è¿æ¥è¿˜æ˜¯éœ€è¦å‡ ç™¾æ¯«ç§’çš„æ—¶é—´ã€‚\nQUIC çš„è¿æ¥ä¸å—å››å…ƒç»„çš„å½±å“ï¼Œå½“è¿™å››ä¸ªå…ƒç´ å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒåŸè¿æ¥ä¾ç„¶ç»´æŒã€‚é‚£è¿™æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿé“ç†å¾ˆç®€å•ï¼ŒQUIC è¿æ¥ä¸ä»¥å››å…ƒç»„ä½œä¸ºæ ‡è¯†ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ª 64 ä½çš„éšæœºæ•°ï¼Œè¿™ä¸ªéšæœºæ•°è¢«ç§°ä¸º Connection IDï¼Œå³ä½¿ IP æˆ–è€…ç«¯å£å‘ç”Ÿå˜åŒ–ï¼Œåªè¦ Connection ID æ²¡æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆè¿æ¥ä¾ç„¶å¯ä»¥ç»´æŒã€‚\næ˜¯ä¸æ˜¯å¾ˆå¼º~\nQUICè§£å†³é˜Ÿå¤´é˜»å¡é—®é¢˜ HTTP ä¸€èˆ¬åˆå…è®¸æ¯ä¸ªä¸»æœºå»ºç«‹ 6 ä¸ª TCP è¿æ¥ï¼Œè¿™æ ·å¯ä»¥æ›´åŠ å……åˆ†åœ°åˆ©ç”¨å¸¦å®½èµ„æºï¼Œä½†æ¯ä¸ªè¿æ¥ä¸­é˜Ÿå¤´é˜»å¡çš„é—®é¢˜è¿˜æ˜¯å­˜åœ¨ã€‚\nHTTP/2 çš„å¤šè·¯å¤ç”¨è§£å†³äº†ä¸Šè¿°çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚ä¸åƒ HTTP/1.1 ä¸­åªæœ‰ä¸Šä¸€ä¸ªè¯·æ±‚çš„æ‰€æœ‰æ•°æ®åŒ…è¢«ä¼ è¾“å®Œæ¯•ä¸‹ä¸€ä¸ªè¯·æ±‚çš„æ•°æ®åŒ…æ‰å¯ä»¥è¢«ä¼ è¾“ï¼ŒHTTP/2 ä¸­æ¯ä¸ªè¯·æ±‚éƒ½è¢«æ‹†åˆ†æˆå¤šä¸ª Frame é€šè¿‡ä¸€æ¡ TCP è¿æ¥åŒæ—¶è¢«ä¼ è¾“ï¼Œè¿™æ ·å³ä½¿ä¸€ä¸ªè¯·æ±‚è¢«é˜»å¡ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–çš„è¯·æ±‚ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸åŒé¢œè‰²ä»£è¡¨ä¸åŒçš„è¯·æ±‚ï¼Œç›¸åŒé¢œè‰²çš„è‰²å—ä»£è¡¨è¯·æ±‚è¢«åˆ‡åˆ†çš„ Frameã€‚\näº‹æƒ…è¿˜æ²¡å®Œï¼ŒHTTP/2 è™½ç„¶å¯ä»¥è§£å†³â€œè¯·æ±‚â€è¿™ä¸ªç²’åº¦çš„é˜»å¡ï¼Œä½† HTTP/2 çš„åŸºç¡€ TCP åè®®æœ¬èº«å´ä¹Ÿå­˜åœ¨ç€é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ã€‚HTTP/2 çš„æ¯ä¸ªè¯·æ±‚éƒ½ä¼šè¢«æ‹†åˆ†æˆå¤šä¸ª Frameï¼Œä¸åŒè¯·æ±‚çš„ Frame ç»„åˆæˆ Streamï¼ŒStream æ˜¯ TCP ä¸Šçš„é€»è¾‘ä¼ è¾“å•å…ƒï¼Œè¿™æ · HTTP/2 å°±è¾¾åˆ°äº†ä¸€æ¡è¿æ¥åŒæ—¶å‘é€å¤šæ¡è¯·æ±‚çš„ç›®æ ‡ï¼Œè¿™å°±æ˜¯å¤šè·¯å¤ç”¨çš„åŸç†ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼Œåœ¨ä¸€æ¡ TCP è¿æ¥ä¸ŠåŒæ—¶å‘é€ 4 ä¸ª Streamï¼Œå…¶ä¸­ Stream1 å·²æ­£ç¡®é€è¾¾ï¼ŒStream2 ä¸­çš„ç¬¬ 3 ä¸ª Frame ä¸¢å¤±ï¼ŒTCP å¤„ç†æ•°æ®æ—¶æœ‰ä¸¥æ ¼çš„å‰åé¡ºåºï¼Œå…ˆå‘é€çš„ Frame è¦å…ˆè¢«å¤„ç†ï¼Œè¿™æ ·å°±ä¼šè¦æ±‚å‘é€æ–¹é‡æ–°å‘é€ç¬¬ 3 ä¸ª Frameï¼ŒStream3 å’Œ Stream4 è™½ç„¶å·²åˆ°è¾¾ä½†å´ä¸èƒ½è¢«å¤„ç†ï¼Œé‚£ä¹ˆè¿™æ—¶æ•´æ¡è¿æ¥éƒ½è¢«é˜»å¡ã€‚\nä¸ä»…å¦‚æ­¤ï¼Œç”±äº HTTP/2 å¿…é¡»ä½¿ç”¨ HTTPSï¼Œè€Œ HTTPS ä½¿ç”¨çš„ TLS åè®®ä¹Ÿå­˜åœ¨é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚TLS åŸºäº Record ç»„ç»‡æ•°æ®ï¼Œå°†ä¸€å †æ•°æ®æ”¾åœ¨ä¸€èµ·ï¼ˆå³ä¸€ä¸ª Recordï¼‰åŠ å¯†ï¼ŒåŠ å¯†å®Œååˆæ‹†åˆ†æˆå¤šä¸ª TCP åŒ…ä¼ è¾“ã€‚ä¸€èˆ¬æ¯ä¸ª Record 16Kï¼ŒåŒ…å« 12 ä¸ª TCP åŒ…ï¼Œè¿™æ ·å¦‚æœ 12 ä¸ª TCP åŒ…ä¸­æœ‰ä»»ä½•ä¸€ä¸ªåŒ…ä¸¢å¤±ï¼Œé‚£ä¹ˆæ•´ä¸ª Record éƒ½æ— æ³•è§£å¯†ã€‚\né‚£ QUIC æ˜¯å¦‚ä½•è§£å†³é˜Ÿå¤´é˜»å¡é—®é¢˜çš„å‘¢ï¼Ÿä¸»è¦æœ‰ä¸¤ç‚¹ã€‚\n QUIC çš„ä¼ è¾“å•å…ƒæ˜¯ Packetï¼ŒåŠ å¯†å•å…ƒä¹Ÿæ˜¯ Packetï¼Œæ•´ä¸ªåŠ å¯†ã€ä¼ è¾“ã€è§£å¯†éƒ½åŸºäº Packetï¼Œè¿™æ ·å°±èƒ½é¿å… TLS çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ï¼› QUIC åŸºäº UDPï¼ŒUDP çš„æ•°æ®åŒ…åœ¨æ¥æ”¶ç«¯æ²¡æœ‰å¤„ç†é¡ºåºï¼Œå³ä½¿ä¸­é—´ä¸¢å¤±ä¸€ä¸ªåŒ…ï¼Œä¹Ÿä¸ä¼šé˜»å¡æ•´æ¡è¿æ¥ï¼Œå…¶ä»–çš„èµ„æºä¼šè¢«æ­£å¸¸å¤„ç†ã€‚  QUICçš„æ‹¥å¡æ§åˆ¶ æ‹¥å¡æ§åˆ¶çš„ç›®çš„æ˜¯é¿å…è¿‡å¤šçš„æ•°æ®ä¸€ä¸‹å­æ¶Œå…¥ç½‘ç»œï¼Œå¯¼è‡´ç½‘ç»œè¶…å‡ºæœ€å¤§è´Ÿè·ã€‚QUIC çš„æ‹¥å¡æ§åˆ¶ä¸ TCP ç±»ä¼¼ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šåšäº†æ”¹è¿›ã€‚\nQUIC é‡æ–°å®ç°äº† TCP åè®®çš„ Cubic ç®—æ³•è¿›è¡Œæ‹¥å¡æ§åˆ¶ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šåšäº†ä¸å°‘æ”¹è¿›ã€‚\nçƒ­æ‹”æ’\nTCP ä¸­å¦‚æœè¦ä¿®æ”¹æ‹¥å¡æ§åˆ¶ç­–ç•¥ï¼Œéœ€è¦åœ¨ç³»ç»Ÿå±‚é¢è¿›è¡Œæ“ä½œã€‚QUIC ä¿®æ”¹æ‹¥å¡æ§åˆ¶ç­–ç•¥åªéœ€è¦åœ¨åº”ç”¨å±‚æ“ä½œï¼Œå¹¶ä¸” QUIC ä¼šæ ¹æ®ä¸åŒçš„ç½‘ç»œç¯å¢ƒã€ç”¨æˆ·æ¥åŠ¨æ€é€‰æ‹©æ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚\nQUICå‰å‘çº é”™FEC QUIC ä½¿ç”¨å‰å‘çº é”™(FECï¼ŒForward Error Correction)æŠ€æœ¯å¢åŠ åè®®çš„å®¹é”™æ€§ã€‚ä¸€æ®µæ•°æ®è¢«åˆ‡åˆ†ä¸º 10 ä¸ªåŒ…åï¼Œä¾æ¬¡å¯¹æ¯ä¸ªåŒ…è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œè¿ç®—ç»“æœä¼šä½œä¸º FEC åŒ…ä¸æ•°æ®åŒ…ä¸€èµ·è¢«ä¼ è¾“ï¼Œå¦‚æœä¸å¹¸åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªæ•°æ®åŒ…ä¸¢å¤±ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ ¹æ®å‰©ä½™ 9 ä¸ªåŒ…ä»¥åŠ FEC åŒ…æ¨ç®—å‡ºä¸¢å¤±çš„é‚£ä¸ªåŒ…çš„æ•°æ®ï¼Œè¿™æ ·å°±å¤§å¤§å¢åŠ äº†åè®®çš„å®¹é”™æ€§ã€‚\nè¿™æ˜¯ç¬¦åˆç°é˜¶æ®µç½‘ç»œæŠ€æœ¯çš„ä¸€ç§æ–¹æ¡ˆï¼Œç°é˜¶æ®µå¸¦å®½å·²ç»ä¸æ˜¯ç½‘ç»œä¼ è¾“çš„ç“¶é¢ˆï¼Œå¾€è¿”æ—¶é—´æ‰æ˜¯ï¼Œæ‰€ä»¥æ–°çš„ç½‘ç»œä¼ è¾“åè®®å¯ä»¥é€‚å½“å¢åŠ æ•°æ®å†—ä½™ï¼Œå‡å°‘é‡ä¼ æ“ä½œã€‚\nQUICé‡ä¼ åºåˆ—å·å•è°ƒé€’å¢ TCP ä¸ºäº†ä¿è¯å¯é æ€§ï¼Œä½¿ç”¨ Sequence Number å’Œ ACK æ¥ç¡®è®¤æ¶ˆæ¯æ˜¯å¦æœ‰åºåˆ°è¾¾ï¼Œä½†è¿™æ ·çš„è®¾è®¡å­˜åœ¨ç¼ºé™·ã€‚\nè¶…æ—¶å‘ç”Ÿåå®¢æˆ·ç«¯å‘èµ·é‡ä¼ ï¼Œåæ¥æ¥æ”¶åˆ°äº† ACK ç¡®è®¤æ¶ˆæ¯ï¼Œä½†å› ä¸ºåŸå§‹è¯·æ±‚å’Œé‡ä¼ è¯·æ±‚æ¥æ”¶åˆ°çš„ ACK æ¶ˆæ¯ä¸€æ ·ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯å°±éƒé—·äº†ï¼Œä¸çŸ¥é“è¿™ä¸ª ACK å¯¹åº”çš„æ˜¯åŸå§‹è¯·æ±‚è¿˜æ˜¯é‡ä¼ è¯·æ±‚ã€‚å¦‚æœå®¢æˆ·ç«¯è®¤ä¸ºæ˜¯åŸå§‹è¯·æ±‚çš„ ACKï¼Œä½†å®é™…ä¸Šæ˜¯å·¦å›¾çš„æƒ…å½¢ï¼Œåˆ™è®¡ç®—çš„é‡‡æ · RTT åå¤§ï¼›å¦‚æœå®¢æˆ·ç«¯è®¤ä¸ºæ˜¯é‡ä¼ è¯·æ±‚çš„ ACKï¼Œä½†å®é™…ä¸Šæ˜¯å³å›¾çš„æƒ…å½¢ï¼Œåˆä¼šå¯¼è‡´é‡‡æ · RTT åå°ã€‚å›¾ä¸­æœ‰å‡ ä¸ªæœ¯è¯­ï¼ŒRTO æ˜¯æŒ‡è¶…æ—¶é‡ä¼ æ—¶é—´ï¼ˆRetransmission TimeOutï¼‰ï¼Œè·Ÿæˆ‘ä»¬ç†Ÿæ‚‰çš„ RTTï¼ˆRound Trip Timeï¼Œå¾€è¿”æ—¶é—´ï¼‰å¾ˆé•¿å¾—å¾ˆåƒã€‚é‡‡æ · RTT ä¼šå½±å“ RTO è®¡ç®—ï¼Œè¶…æ—¶æ—¶é—´çš„å‡†ç¡®æŠŠæ¡å¾ˆé‡è¦ï¼Œé•¿äº†çŸ­äº†éƒ½ä¸åˆé€‚ã€‚\nQUIC è§£å†³äº†ä¸Šé¢çš„æ­§ä¹‰é—®é¢˜ã€‚ä¸ Sequence Number ä¸åŒçš„æ˜¯ï¼ŒPacket Number ä¸¥æ ¼å•è°ƒé€’å¢ï¼Œå¦‚æœ Packet N ä¸¢å¤±äº†ï¼Œé‚£ä¹ˆé‡ä¼ æ—¶ Packet çš„æ ‡è¯†ä¸ä¼šæ˜¯ Nï¼Œè€Œæ˜¯æ¯” N å¤§çš„æ•°å­—ï¼Œæ¯”å¦‚ N + Mï¼Œè¿™æ ·å‘é€æ–¹æ¥æ”¶åˆ°ç¡®è®¤æ¶ˆæ¯æ—¶å°±èƒ½æ–¹ä¾¿åœ°çŸ¥é“ ACK å¯¹åº”çš„æ˜¯åŸå§‹è¯·æ±‚è¿˜æ˜¯é‡ä¼ è¯·æ±‚ã€‚\nACK Delay TCP è®¡ç®— RTT æ—¶æ²¡æœ‰è€ƒè™‘æ¥æ”¶æ–¹æ¥æ”¶åˆ°æ•°æ®åˆ°å‘é€ç¡®è®¤æ¶ˆæ¯ä¹‹é—´çš„å»¶è¿Ÿï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™æ®µå»¶è¿Ÿå³ ACK Delayã€‚QUIC è€ƒè™‘äº†è¿™æ®µå»¶è¿Ÿï¼Œä½¿å¾— RTT çš„è®¡ç®—æ›´åŠ å‡†ç¡®ã€‚\næ›´å¤šçš„ ACK å— ä¸€èˆ¬æ¥è¯´ï¼Œæ¥æ”¶æ–¹æ”¶åˆ°å‘é€æ–¹çš„æ¶ˆæ¯åéƒ½åº”è¯¥å‘é€ä¸€ä¸ª ACK å›å¤ï¼Œè¡¨ç¤ºæ”¶åˆ°äº†æ•°æ®ã€‚ä½†æ¯æ”¶åˆ°ä¸€ä¸ªæ•°æ®å°±è¿”å›ä¸€ä¸ª ACK å›å¤å¤ªéº»çƒ¦ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šç«‹å³å›å¤ï¼Œè€Œæ˜¯æ¥æ”¶åˆ°å¤šä¸ªæ•°æ®åå†å›å¤ï¼ŒTCP SACK æœ€å¤šæä¾› 3 ä¸ª ACK blockã€‚ä½†æœ‰äº›åœºæ™¯ä¸‹ï¼Œæ¯”å¦‚ä¸‹è½½ï¼Œåªéœ€è¦æœåŠ¡å™¨è¿”å›æ•°æ®å°±å¥½ï¼Œä½†æŒ‰ç…§ TCP çš„è®¾è®¡ï¼Œæ¯æ”¶åˆ° 3 ä¸ªæ•°æ®åŒ…å°±è¦â€œç¤¼è²Œæ€§â€åœ°è¿”å›ä¸€ä¸ª ACKã€‚è€Œ QUIC æœ€å¤šå¯ä»¥æå¸¦ 256 ä¸ª ACK blockã€‚åœ¨ä¸¢åŒ…ç‡æ¯”è¾ƒä¸¥é‡çš„ç½‘ç»œä¸‹ï¼Œæ›´å¤šçš„ ACK block å¯ä»¥å‡å°‘é‡ä¼ é‡ï¼Œæå‡ç½‘ç»œæ•ˆç‡ã€‚\nQUICæµé‡æ§åˆ¶ ä¼¼ä¹ä¸€æ ·ã€‚\nå‚è€ƒï¼š\n The Road to QUIC ç§‘æ™®ï¼šQUICåè®®åŸç†åˆ†æ Quicåè®®ä»‹ç»å’Œæµ…æ  å‚è€ƒä¸æ›´å¤šâ•  è®¡ç®—æœºç½‘ç»œé¢è¯•æ€»ç»“      Interview OS é«˜é¢‘çŸ¥è¯†â€”â€”æ“ä½œç³»ç»Ÿé¢è¯•é—®é¢˜æ•´ç†\nå°ç™½å¦‚ä½•å­¦ä¹ æ“ä½œç³»ç»Ÿï¼Ÿ\nè¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹åŒºåˆ«ğŸ’  è¿›ç¨‹ä¸çº¿ç¨‹çš„æ¥ç”±â˜„ è¿›ç¨‹çš„ä½œç”¨ä¸å®šä¹‰ï¼šæ˜¯ä¸ºäº†æé«˜CPUçš„æ‰§è¡Œæ•ˆç‡ï¼Œä¸ºäº†é¿å…å› ç­‰å¾…è€Œé€ æˆCPUç©ºè½¬ä»¥åŠå…¶ä»–è®¡ç®—æœºç¡¬ä»¶èµ„æºçš„æµªè´¹è€Œæå‡ºæ¥çš„ã€‚\nçº¿ç¨‹çš„å¼•å…¥ï¼šä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ªWebæœåŠ¡å™¨è¦è¿›ç¨‹çš„æ–¹å¼å¹¶å‘åœ°å¤„ç†æ¥è‡ªä¸åŒç”¨æˆ·çš„ç½‘é¡µè®¿é—®è¯·æ±‚çš„è¯ï¼Œå¯ä»¥åˆ›å»ºçˆ¶è¿›ç¨‹å’Œå¤šä¸ªå­è¿›ç¨‹çš„æ–¹å¼æ¥è¿›è¡Œå¤„ç†ï¼Œä½†æ˜¯åˆ›å»ºä¸€ä¸ªè¿›ç¨‹è¦èŠ±è´¹è¾ƒå¤§çš„ç³»ç»Ÿå¼€é”€å’Œå ç”¨è¾ƒå¤šçš„èµ„æºã€‚é™¤å¤–ï¼Œè¿™äº›ä¸åŒçš„ç”¨æˆ·å­è¿›ç¨‹åœ¨æ‰§è¡Œçš„æ—¶å€™æ¶‰åŠåˆ°è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ã€‚æ‰€ä»¥ï¼Œä¸ºäº†å‡å°‘è¿›ç¨‹åˆ‡æ¢å’Œåˆ›å»ºçš„å¼€é”€ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡å’ŒèŠ‚çœèµ„æºï¼Œäººä»¬åœ¨æ“ä½œç³»ç»Ÿä¸­å¼•å…¥äº†\u0026quot;çº¿ç¨‹ï¼ˆthreadï¼‰\u0026ldquo;çš„æ¦‚å¿µã€‚\n(è¿›ç¨‹çš„æ¶ˆè€—å¤ªå¤§ï¼Œæ‰€ä»¥å¼•å…¥çº¿ç¨‹)\nè¿›ç¨‹ä¸çº¿ç¨‹çš„æ•°æ®ğŸ—¡ è¿›ç¨‹æ˜¯ç³»ç»Ÿèµ„æºåˆ†é…çš„æœ€å°å•ä½, ç³»ç»Ÿç”±ä¸€ä¸ªä¸ªè¿›ç¨‹(ç¨‹åº)ç»„æˆ ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒåŒ…æ‹¬æ–‡æœ¬åŒºåŸŸï¼ˆtext regionï¼‰ã€æ•°æ®åŒºåŸŸï¼ˆdata regionï¼‰å’Œå †æ ˆï¼ˆstack regionï¼‰ã€‚\n æ–‡æœ¬åŒºåŸŸå­˜å‚¨å¤„ç†å™¨æ‰§è¡Œçš„ä»£ç  æ•°æ®åŒºåŸŸå­˜å‚¨å˜é‡å’Œè¿›ç¨‹æ‰§è¡ŒæœŸé—´ä½¿ç”¨çš„åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼› å †æ ˆåŒºåŸŸå­˜å‚¨ç€æ´»åŠ¨è¿‡ç¨‹è°ƒç”¨çš„æŒ‡ä»¤å’Œæœ¬åœ°å˜é‡ã€‚   ä¸è¿›ç¨‹çš„æ§åˆ¶è¡¨PCBç›¸ä¼¼ï¼Œçº¿ç¨‹ä¹Ÿæœ‰è‡ªå·±çš„æ§åˆ¶è¡¨TCBï¼Œä½†æ˜¯TCBä¸­æ‰€ä¿å­˜çš„çº¿ç¨‹çŠ¶æ€æ¯”PCBè¡¨å°‘å¾—å¤šã€‚\n çº¿ç¨‹å±äºè¿›ç¨‹ï¼Œå¹¶ä¸”å…±äº«è¿›ç¨‹çš„å†…å­˜åœ°å€ç©ºé—´\nçº¿ç¨‹å‡ ä¹ä¸å æœ‰ç³»ç»Ÿèµ„æºé€šä¿¡é—®é¢˜: è¿›ç¨‹ç›¸å½“äºä¸€ä¸ªå®¹å™¨,è€Œçº¿ç¨‹è€Œæ˜¯è¿è¡Œåœ¨å®¹å™¨é‡Œé¢çš„,å› æ­¤å¯¹äºå®¹å™¨å†…çš„ä¸œè¥¿,çº¿ç¨‹æ˜¯å…±åŒäº«æœ‰çš„,å› æ­¤çº¿ç¨‹é—´çš„é€šä¿¡å¯ä»¥ç›´æ¥é€šè¿‡å…¨å±€å˜é‡è¿›è¡Œé€šä¿¡,ä½†æ˜¯ç”±æ­¤å¸¦æ¥çš„ä¾‹å¦‚å¤šä¸ªçº¿ç¨‹è¯»å†™åŒä¸€ä¸ªåœ°å€å˜é‡çš„æ—¶å€™åˆ™å°†å¸¦æ¥ä¸å¯é¢„æœŸçš„åæœ,å› æ­¤è¿™æ—¶å€™å¼•å…¥äº†å„ç§é”çš„ä½œç”¨,ä¾‹å¦‚äº’æ–¥é”ç­‰ã€‚\n åŒæ—¶å¤šçº¿ç¨‹æ˜¯ä¸å®‰å…¨çš„,å½“ä¸€ä¸ªçº¿ç¨‹å´©æºƒäº†,ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹ä¹Ÿå´©æºƒäº†,å³å…¶ä»–çº¿ç¨‹ä¹ŸæŒ‚äº†, ä½†å¤šè¿›ç¨‹è€Œä¸ä¼š,ä¸€ä¸ªè¿›ç¨‹æŒ‚äº†,å¦ä¸€ä¸ªè¿›ç¨‹ä¾ç„¶ç…§æ ·è¿è¡Œã€‚\n ä¸Šä¸‹æ–‡åˆ‡æ¢ğŸ“Š è¿›ç¨‹åˆ‡æ¢åˆ†3æ­¥:\n åˆ‡æ¢é¡µç›®å½•ä»¥ä½¿ç”¨æ–°çš„åœ°å€ç©ºé—´ åˆ‡æ¢å†…æ ¸æ ˆ åˆ‡æ¢ç¡¬ä»¶ä¸Šä¸‹æ–‡  è€Œçº¿ç¨‹åˆ‡æ¢åªéœ€è¦ç¬¬2ã€3æ­¥,å› æ­¤è¿›ç¨‹çš„åˆ‡æ¢ä»£ä»·æ¯”è¾ƒå¤§\n**åç¨‹ï¼Œè‹±æ–‡Coroutinesï¼Œæ˜¯ä¸€ç§æ¯”çº¿ç¨‹æ›´åŠ è½»é‡çº§çš„å­˜åœ¨ã€‚**æ­£å¦‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹ä¸€æ ·ï¼Œä¸€ä¸ªçº¿ç¨‹ä¹Ÿå¯ä»¥æ‹¥æœ‰å¤šä¸ªåç¨‹ã€‚\nåç¨‹æ˜¯å±äºçº¿ç¨‹çš„ã€‚åç¨‹ç¨‹åºæ˜¯åœ¨çº¿ç¨‹é‡Œé¢è·‘çš„ï¼Œå› æ­¤åç¨‹åˆç§°å¾®çº¿ç¨‹å’Œçº¤ç¨‹ç­‰\nåæ²¡æœ‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ¶ˆè€—ã€‚åç¨‹çš„è°ƒåº¦åˆ‡æ¢æ˜¯ç”¨æˆ·(ç¨‹åºå‘˜)æ‰‹åŠ¨åˆ‡æ¢çš„,å› æ­¤æ›´åŠ çµæ´»,å› æ­¤åˆå«ç”¨æˆ·ç©ºé—´çº¿ç¨‹.\nåŸå­æ“ä½œæ€§ã€‚ç”±äºåç¨‹æ˜¯ç”¨æˆ·è°ƒåº¦çš„ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°æ‰§è¡Œä¸€åŠçš„ä»£ç ç‰‡æ®µè¢«å¼ºåˆ¶ä¸­æ–­äº†ï¼Œå› æ­¤æ— éœ€åŸå­æ“ä½œé”ã€‚\n åç¨‹ä¸æ˜¯è¢«æ“ä½œç³»ç»Ÿå†…æ ¸æ‰€ç®¡ç†ï¼Œè€Œå®Œå…¨æ˜¯ç”±ç¨‹åºæ‰€æ§åˆ¶ï¼ˆä¹Ÿå°±æ˜¯åœ¨ç”¨æˆ·æ€æ‰§è¡Œï¼‰ã€‚åç¨‹çš„æš‚åœå®Œå…¨ç”±ç¨‹åºæ§åˆ¶ï¼Œçº¿ç¨‹çš„é˜»å¡çŠ¶æ€æ˜¯ç”±æ“ä½œç³»ç»Ÿå†…æ ¸æ¥è¿›è¡Œåˆ‡æ¢ã€‚\nå¥½å¤„ï¼š\nâ€‹\tæ€§èƒ½å¾—åˆ°äº†å¾ˆå¤§çš„æå‡ï¼Œä¸ä¼šåƒçº¿ç¨‹åˆ‡æ¢é‚£æ ·æ¶ˆè€—èµ„æºã€‚\n å¦‚æœè¯´æ“ä½œç³»ç»Ÿå¼•å…¥è¿›ç¨‹çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜ç¨‹åºå¹¶å‘æ‰§è¡Œï¼Œä»¥æé«˜èµ„æºåˆ©ç”¨ç‡å’Œç³»ç»Ÿååé‡ã€‚é‚£ä¹ˆæ“ä½œç³»ç»Ÿä¸­å¼•å…¥çº¿ç¨‹çš„ç›®çš„ï¼Œåˆ™æ˜¯ä¸ºäº†å‡å°‘è¿›ç¨‹å¹¶å‘æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€ä»˜å‡ºçš„æ—¶ç©ºå¼€é”€ï¼Œä½¿æ“ä½œç³»ç»Ÿèƒ½å¾ˆå¥½çš„å¹¶å‘æ‰§è¡Œã€‚\nã€€è¿›ç¨‹processå®šä¹‰äº†ä¸€ä¸ªæ‰§è¡Œç¯å¢ƒï¼ŒåŒ…æ‹¬å®ƒè‡ªå·±ç§æœ‰çš„åœ°å€ç©ºé—´ã€ä¸€ä¸ªå¥æŸ„è¡¨ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨ç¯å¢ƒï¼›çº¿ç¨‹åˆ™æ˜¯ä¸€ä¸ªæ§åˆ¶æµï¼Œæœ‰ä»–è‡ªå·±çš„è°ƒç”¨æ ˆcall stackï¼Œè®°å½•äº†å®ƒçš„æ‰§è¡Œå†å²ã€‚\nã€€çº¿ç¨‹ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼š1ï¼‰çº¿ç¨‹çš„å†…æ ¸å¯¹è±¡ï¼Œæ“ä½œç³»ç»Ÿç”¨å®ƒæ¥å¯¹çº¿ç¨‹å®æ–½ç®¡ç†ã€‚å†…æ ¸å¯¹è±¡ä¹Ÿæ˜¯ç³»ç»Ÿç”¨æ¥å­˜æ”¾çº¿ç¨‹ç»Ÿè®¡ä¿¡æ¯çš„åœ°æ–¹ã€‚2ï¼‰çº¿ç¨‹å †æ ˆï¼Œå®ƒç”¨äºç»´æŠ¤çº¿ç¨‹åœ¨æ‰§è¡Œä»£ç æ—¶éœ€è¦çš„æ‰€æœ‰å‚æ•°å’Œå±€éƒ¨å˜é‡ã€‚å½“åˆ›å»ºçº¿ç¨‹æ—¶ï¼Œç³»ç»Ÿåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å†…æ ¸å¯¹è±¡ã€‚è¯¥çº¿ç¨‹å†…æ ¸å¯¹è±¡ä¸æ˜¯çº¿ç¨‹æœ¬èº«ï¼Œè€Œæ˜¯æ“ä½œç³»ç»Ÿç”¨æ¥ç®¡ç†çº¿ç¨‹çš„è¾ƒå°çš„æ•°æ®ç»“æ„ã€‚å¯ä»¥å°†çº¿ç¨‹å†…æ ¸å¯¹è±¡è§†ä¸ºç”±å…³äºçº¿ç¨‹çš„ç»Ÿè®¡ä¿¡æ¯ç»„æˆçš„ä¸€ä¸ªå°å‹æ•°æ®ç»“æ„ã€‚\nå‚è€ƒé“¾æ¥ï¼š\n çº¿ç¨‹ï¼Œè¿›ç¨‹ï¼Œåç¨‹è¯¦ç»†è§£é‡Š è¿›ç¨‹ã€çº¿ç¨‹å’Œåç¨‹çš„æ¦‚å¿µ  è¿›ç¨‹çš„å‡ ç§çŠ¶æ€   å°±ç»ª(Ready)çŠ¶æ€\nå½“è¿›ç¨‹å·²åˆ†é…åˆ°é™¤CPUä»¥å¤–çš„æ‰€æœ‰å¿…è¦èµ„æºåï¼Œåªè¦å†è·å¾—CPUï¼Œä¾¿å¯ç«‹å³æ‰§è¡Œï¼Œè¿›ç¨‹è¿™æ—¶çš„çŠ¶æ€ç§°ä¸ºå°±ç»ªçŠ¶æ€ã€‚åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­å¤„äºå°±ç»ªçŠ¶æ€çš„è¿›ç¨‹å¯èƒ½æœ‰å¤šä¸ªï¼Œé€šå¸¸å°†å®ƒä»¬æ’æˆä¸€ä¸ªé˜Ÿåˆ—ï¼Œç§°ä¸ºå°±ç»ªé˜Ÿåˆ—ã€‚\n  æ‰§è¡ŒçŠ¶æ€\nè¿›ç¨‹å·²è·å¾—CPUï¼Œå…¶ç¨‹åºæ­£åœ¨æ‰§è¡Œã€‚åœ¨å•å¤„ç†æœºç³»ç»Ÿä¸­ï¼Œåªæœ‰ä¸€ä¸ªè¿›ç¨‹å¤„äºæ‰§è¡ŒçŠ¶æ€ï¼› åœ¨å¤šå¤„ç†æœºç³»ç»Ÿä¸­ï¼Œåˆ™æœ‰å¤šä¸ªè¿›ç¨‹å¤„äºæ‰§è¡ŒçŠ¶æ€ã€‚\n  é˜»å¡çŠ¶æ€\næ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ç”±äºå‘ç”ŸæŸäº‹ä»¶è€Œæš‚æ—¶æ— æ³•ç»§ç»­æ‰§è¡Œæ—¶ï¼Œä¾¿æ”¾å¼ƒå¤„ç†æœºè€Œå¤„äºæš‚åœçŠ¶æ€ï¼Œäº¦å³è¿›ç¨‹çš„æ‰§è¡Œå—åˆ°é˜»å¡ï¼ŒæŠŠè¿™ç§æš‚åœçŠ¶æ€ç§°ä¸ºé˜»å¡çŠ¶æ€ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºç­‰å¾…çŠ¶æ€æˆ–å°é”çŠ¶æ€ã€‚è‡´ä½¿è¿›ç¨‹é˜»å¡çš„å…¸å‹äº‹ä»¶æœ‰ï¼šè¯·æ±‚I/Oï¼Œç”³è¯·ç¼“å†²ç©ºé—´ç­‰ã€‚é€šå¸¸å°†è¿™ç§å¤„äºé˜»å¡çŠ¶æ€çš„è¿›ç¨‹ä¹Ÿæ’æˆä¸€ä¸ªé˜Ÿåˆ—ã€‚æœ‰çš„ç³»ç»Ÿåˆ™æ ¹æ®é˜»å¡åŸå› çš„ä¸åŒè€ŒæŠŠå¤„äºé˜»å¡çŠ¶æ€çš„è¿›ç¨‹æ’æˆå¤šä¸ªé˜Ÿåˆ—ã€‚\n  æ­»é”ï¼Œæ´»é”å’Œé¥¥é¥¿ğŸ” æ­»é”ğŸ”ï¼šæ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ã€‚æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”ï¼Œè¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰å¾…çš„è¿›ç¨‹ç§°ä¸ºæ­»é”è¿›ç¨‹ã€‚\næ­»é”çš„æ¡ä»¶:\n äº’æ–¥ è¯·æ±‚å’Œä¿æŒ ä¸å‰¥å¤ºåŸåˆ™ ç¯è·¯ç­‰å¾…  å¦‚ä½•é¿å…æ­»é”ï¼ŸğŸƒ\né¢„é˜²\n æ‰“ç ´äº’æ–¥æ¡ä»¶ï¼šæ”¹é€ ç‹¬å æ€§èµ„æºä¸ºè™šæ‹Ÿèµ„æºï¼Œå¤§éƒ¨åˆ†èµ„æºå·²æ— æ³•æ”¹é€ ã€‚ æ‰“ç ´ä¸å¯æŠ¢å æ¡ä»¶ï¼šå½“ä¸€è¿›ç¨‹å æœ‰ä¸€ç‹¬å æ€§èµ„æºååˆç”³è¯·ä¸€ç‹¬å æ€§èµ„æºè€Œæ— æ³•æ»¡è¶³ï¼Œåˆ™é€€å‡ºåŸå æœ‰çš„èµ„æºã€‚ æ‰“ç ´å æœ‰ä¸”ç”³è¯·æ¡ä»¶ï¼šé‡‡ç”¨èµ„æºé¢„å…ˆåˆ†é…ç­–ç•¥ï¼Œå³è¿›ç¨‹è¿è¡Œå‰ç”³è¯·å…¨éƒ¨èµ„æºï¼Œæ»¡è¶³åˆ™è¿è¡Œï¼Œä¸ç„¶å°±ç­‰å¾…ï¼Œè¿™æ ·å°±ä¸ä¼šå æœ‰ä¸”ç”³è¯·ã€‚ æ‰“ç ´å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå®ç°èµ„æºæœ‰åºåˆ†é…ç­–ç•¥ï¼Œå¯¹æ‰€æœ‰è®¾å¤‡å®ç°åˆ†ç±»ç¼–å·ï¼Œæ‰€æœ‰è¿›ç¨‹åªèƒ½é‡‡ç”¨æŒ‰åºå·é€’å¢çš„å½¢å¼ç”³è¯·èµ„æºã€‚ æœ‰åºèµ„æºåˆ†é…æ³• é“¶è¡Œå®¶ç®—æ³•  æ´»é”ğŸš›ï¼š**æ˜¯æŒ‡çº¿ç¨‹1å¯ä»¥ä½¿ç”¨èµ„æºï¼Œä½†å®ƒå¾ˆç¤¼è²Œï¼Œè®©å…¶ä»–çº¿ç¨‹å…ˆä½¿ç”¨èµ„æºï¼Œçº¿ç¨‹2ä¹Ÿå¯ä»¥ä½¿ç”¨èµ„æºï¼Œä½†å®ƒå¾ˆç»…å£«ï¼Œä¹Ÿè®©å…¶ä»–çº¿ç¨‹å…ˆä½¿ç”¨èµ„æºã€‚**è¿™æ ·ä½ è®©æˆ‘ï¼Œæˆ‘è®©ä½ ï¼Œæœ€åä¸¤ä¸ªçº¿ç¨‹éƒ½æ— æ³•ä½¿ç”¨èµ„æºã€‚\né¥¥é¥¿ğŸ‡­ğŸ‡º :æ˜¯æŒ‡å¦‚æœçº¿ç¨‹T1å ç”¨äº†èµ„æºRï¼Œçº¿ç¨‹T2åˆè¯·æ±‚å°é”Rï¼Œäºæ˜¯T2ç­‰å¾…ã€‚T3ä¹Ÿè¯·æ±‚èµ„æºRï¼Œå½“T1é‡Šæ”¾äº†Rä¸Šçš„å°é”åï¼Œç³»ç»Ÿé¦–å…ˆæ‰¹å‡†äº†T3çš„è¯·æ±‚ï¼ŒT2ä»ç„¶ç­‰å¾…ã€‚ç„¶åT4åˆè¯·æ±‚å°é”Rï¼Œå½“T3é‡Šæ”¾äº†Rä¸Šçš„å°é”ä¹‹åï¼Œç³»ç»Ÿåˆæ‰¹å‡†äº†T4çš„è¯·æ±‚\u0026hellip;\u0026hellip;ï¼ŒT2å¯èƒ½æ°¸è¿œç­‰å¾…ã€‚\nå¦‚ä½•æ£€æµ‹æ­»é” ä¸€èˆ¬æ¥è¯´ï¼Œç”±äºæ“ä½œç³»ç»Ÿæœ‰å¹¶å‘ï¼Œå…±äº«ä»¥åŠéšæœºæ€§ç­‰ç‰¹ç‚¹ï¼Œé€šè¿‡é¢„é˜²å’Œé¿å…çš„æ‰‹æ®µè¾¾åˆ°æ’é™¤æ­»é”çš„ç›®çš„æ˜¯å¾ˆå›°éš¾çš„ã€‚è¿™éœ€è¦è¾ƒå¤§çš„ç³»ç»Ÿå¼€é”€ï¼Œè€Œä¸”ä¸èƒ½å……åˆ†åˆ©ç”¨èµ„æºã€‚ä¸ºæ­¤ï¼Œä¸€ç§ç®€ä¾¿çš„æ–¹æ³•æ˜¯ç³»ç»Ÿä¸ºè¿›ç¨‹åˆ†é…èµ„æºæ—¶ï¼Œä¸é‡‡å–ä»»ä½•é™åˆ¶æ€§æªæ–½ï¼Œä½†æ˜¯æä¾›äº†æ£€æµ‹å’Œè§£è„±æ­»é”çš„æ‰‹æ®µï¼šèƒ½å‘ç°æ­»é”å¹¶ä»æ­»é”çŠ¶æ€ä¸­æ¢å¤å‡ºæ¥ã€‚å› æ­¤ï¼Œåœ¨å®é™…çš„æ“ä½œç³»ç»Ÿä¸­å¾€å¾€é‡‡ç”¨æ­»é”çš„æ£€æµ‹ä¸æ¢å¤æ–¹æ³•æ¥æ’é™¤æ­»é”ã€‚å¸¸åˆ©ç”¨èµ„æºåˆ†é…å›¾ã€è¿›ç¨‹ç­‰å¾…å›¾æ¥ååŠ©è¿™ç§æ£€æµ‹ã€‚\næ ¸å¿ƒæ˜¯ï¼šä¸è¯•å›¾é˜»æ­¢æ­»é”ï¼Œè€Œæ˜¯å½“æ£€æµ‹åˆ°æ­»é”å‘ç”Ÿæ—¶ï¼Œé‡‡å–æªæ–½è¿›è¡Œæ¢å¤ã€‚\nå¯ä»¥å¯¹è¿›ç¨‹ - èµ„æºåˆ†é…å›¾è¿›è¡Œæ£€æµ‹(æŒ‰å‘¨æœŸè¿›è¡Œæ£€æµ‹)ï¼š\n å¦‚æœè¿›ç¨‹ - èµ„æºåˆ†é…å›¾ä¸­æ— ç¯è·¯ï¼Œæ­¤æ—¶ç³»ç»Ÿæ²¡æœ‰å‘ç”Ÿæ­»é”ã€‚ å¦‚æœè¿›ç¨‹ - èµ„æºåˆ†é…å›¾ä¸­æœ‰ç¯è·¯ï¼Œåˆ™å¯åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š  æ¯ç§èµ„æºç±»ä¸­ä»…æœ‰ä¸€ä¸ªèµ„æºï¼Œåˆ™ç³»ç»Ÿå‘ç”Ÿäº†æ­»é”ã€‚æ­¤æ—¶ï¼Œç¯è·¯æ˜¯ç³»ç»Ÿå‘ç”Ÿæ­»é”çš„å……åˆ†å¿…è¦æ¡ä»¶ï¼Œç¯è·¯ä¸­çš„è¿›ç¨‹å°±æ˜¯æ­»é”è¿›ç¨‹ æ¯ç§èµ„æºç±»ä¸­æœ‰å¤šä¸ªèµ„æºï¼Œåˆ™ç¯è·¯çš„å­˜åœ¨åªæ˜¯äº§ç”Ÿæ­»é”çš„å¿…è¦ä¸å……åˆ†æ¡ä»¶ï¼Œç³»ç»Ÿæœªå¿…ä¼šå‘ç”Ÿæ­»é”ã€‚    æ­»é”æ¢å¤   èµ„æºå‰¥å¤ºæ³•\nå‰¥å¤ºé™·äºæ­»é”çš„è¿›ç¨‹æ‰€å ç”¨çš„èµ„æºï¼Œä½†å¹¶ä¸æ’¤é”€æ­¤è¿›ç¨‹ï¼Œç›´è‡³æ­»é”è§£é™¤ã€‚\n  è¿›ç¨‹å›é€€æ³•\næ ¹æ®ç³»ç»Ÿä¿å­˜çš„æ£€æŸ¥ç‚¹è®©æ‰€æœ‰çš„è¿›ç¨‹å›é€€ï¼Œç›´åˆ°è¶³ä»¥è§£é™¤æ­»é”ï¼Œè¿™ç§æªæ–½è¦æ±‚ç³»ç»Ÿå»ºç«‹ä¿å­˜æ£€æŸ¥ç‚¹ã€å›é€€åŠé‡å¯æœºåˆ¶ã€‚\n  è¿›ç¨‹æ’¤é”€æ³•\n   æ’¤é”€é™·å…¥æ­»é”çš„æ‰€æœ‰è¿›ç¨‹ï¼Œè§£é™¤æ­»é”ï¼Œç»§ç»­è¿è¡Œã€‚ é€ä¸ªæ’¤é”€é™·å…¥æ­»é”çš„è¿›ç¨‹ï¼Œå›æ”¶å…¶èµ„æºå¹¶é‡æ–°åˆ†é…ï¼Œç›´è‡³æ­»é”è§£é™¤ã€‚    å¯é€‰æ‹©ç¬¦åˆä¸‹é¢æ¡ä»¶ä¹‹ä¸€çš„å…ˆæ’¤é”€ï¼š 1.CPUæ¶ˆè€—æ—¶é—´æœ€å°‘è€… 2.äº§ç”Ÿçš„è¾“å‡ºé‡æœ€å°è€…\n3.é¢„è®¡å‰©ä½™æ‰§è¡Œæ—¶é—´æœ€é•¿è€… 4.åˆ†å¾—çš„èµ„æºæ•°é‡æœ€å°‘è€…åä¼˜å…ˆçº§æœ€ä½è€…\n ç³»ç»Ÿé‡å¯æ³•\nç»“æŸæ‰€æœ‰è¿›ç¨‹çš„æ‰§è¡Œå¹¶é‡æ–°å¯åŠ¨æ“ä½œç³»ç»Ÿã€‚è¿™ç§æ–¹æ³•å¾ˆç®€å•ï¼Œä½†å…ˆå‰çš„å·¥ä½œå…¨éƒ¨ä½œåºŸï¼ŒæŸå¤±å¾ˆå¤§ã€‚  å‚è€ƒï¼š\n æ“ä½œç³»ç»Ÿä¸­çš„æ­»é”æ£€æµ‹æ–¹æ³• æ­»é”çš„äº§ç”Ÿã€é˜²æ­¢ã€é¿å…ã€æ£€æµ‹å’Œè§£é™¤  ä»€ä¹ˆæ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼Ÿ å®ˆæŠ¤è¿›ç¨‹å°±æ˜¯åœ¨åå°è¿è¡Œ,ä¸ä¸ä»»ä½•ç»ˆç«¯å…³è”çš„è¿›ç¨‹,é€šå¸¸æƒ…å†µä¸‹å®ˆæŠ¤è¿›ç¨‹åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å°±åœ¨è¿è¡Œ,å®ƒä»¬ä»¥rootç”¨æˆ·æˆ–è€…å…¶ä»–ç‰¹æ®Šç”¨æˆ·(apacheå’Œpostfix)è¿è¡Œ,å¹¶èƒ½å¤„ç†ä¸€äº›ç³»ç»Ÿçº§çš„ä»»åŠ¡.ä¹ æƒ¯ä¸Šå®ˆæŠ¤è¿›ç¨‹çš„åå­—é€šå¸¸ä»¥dç»“å°¾(sshd),ä½†è¿™äº›ä¸æ˜¯å¿…é¡»çš„.\nå‚è€ƒï¼š\n ä»€ä¹ˆæ˜¯å®ˆæŠ¤è¿›ç¨‹  Linuxè¿è¡Œå†…å­˜åˆ†åŒºğŸš© è™šæ‹Ÿå†…å­˜æ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µ ï¼Œå®ƒä¸º æ¯ä¸ªè¿›ç¨‹æä¾›äº†ä¸€ä¸ªå‡è±¡ï¼Œ å³æ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç‹¬å åœ°ä½¿ç”¨ä¸»å­˜ ã€‚\nè™šæ‹Ÿåœ°å€ç©ºé—´(å’ŒCç¨‹åºç©ºé—´ä¸€è‡´)å¦‚ä¸‹ï¼š\nåœ¨ Linuxä¸­ ï¼Œåœ°å€ç©ºé—´æœ€ä¸Šé¢çš„åŒºåŸŸæ˜¯ä¿ç•™ç»™æ“ä½œç³»ç»Ÿä¸­çš„ä»£ç å’Œæ•°æ®çš„ ï¼Œè¿™å¯¹æ‰€æœ‰è¿›ç¨‹æ¥è¯´éƒ½æ˜¯ä¸€æ · ã€‚åœ°å€ç©ºé—´çš„åº•éƒ¨åŒºåŸŸå­˜æ”¾ç”¨æˆ·è¿›ç¨‹å®šä¹‰çš„ä»£ç å’Œæ•°æ® ã€‚\nè¿›ç¨‹é—´é€šä¿¡ğŸ¦…   ç®¡é“(PIPE) / FIFO(æœ‰åç®¡é“)\nç®¡é“å¯ç”¨äºå…·æœ‰äº²ç¼˜å…³ç³»è¿›ç¨‹é—´çš„é€šä¿¡ï¼Œæœ‰åç®¡é“å…‹æœäº†ç®¡é“æ²¡æœ‰åå­—çš„é™åˆ¶ï¼Œå› æ­¤ï¼Œé™¤å…·æœ‰ç®¡é“æ‰€å…·æœ‰çš„åŠŸèƒ½å¤–ï¼Œå®ƒè¿˜å…è®¸æ— äº²ç¼˜å…³ç³»è¿›ç¨‹é—´çš„é€šä¿¡ï¼›æ— åç®¡é“ä½¿ç”¨forkå®ç°ã€‚\n  æ¶ˆæ¯é˜Ÿåˆ—\næ¶ˆæ¯é˜Ÿåˆ—æ˜¯æ¶ˆæ¯çš„é“¾æ¥è¡¨ï¼ŒåŒ…æ‹¬Posixæ¶ˆæ¯é˜Ÿåˆ—system Væ¶ˆæ¯é˜Ÿåˆ—ã€‚æœ‰è¶³å¤Ÿæƒé™çš„è¿›ç¨‹å¯ä»¥å‘é˜Ÿåˆ—ä¸­æ·»åŠ æ¶ˆæ¯ï¼Œè¢«èµ‹äºˆè¯»æƒé™çš„è¿›ç¨‹åˆ™å¯ä»¥è¯»èµ°é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ã€‚æ¶ˆæ¯é˜Ÿåˆ—å…‹æœäº†ä¿¡å·æ‰¿è½½ä¿¡æ¯é‡å°‘ï¼Œç®¡é“åªèƒ½æ‰¿è½½æ— æ ¼å¼å­—èŠ‚æµä»¥åŠç¼“å†²åŒºå¤§å°å—é™ç­‰ç¼ºç‚¹ã€‚\n  ä¿¡å·é‡\nè¦ä½œä¸ºè¿›ç¨‹é—´ä»¥åŠåŒä¸€è¿›ç¨‹ä¸åŒçº¿ç¨‹ä¹‹é—´çš„åŒæ­¥æ‰‹æ®µã€‚\n  å…±äº«å†…å­˜\nä½¿å¾—å¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œæ˜¯æœ€å¿«çš„å¯ç”¨IPCå½¢å¼ã€‚æ˜¯é’ˆå¯¹å…¶ä»–é€šä¿¡æœºåˆ¶è¿è¡Œæ•ˆç‡è¾ƒä½è€Œè®¾è®¡çš„ã€‚å¾€å¾€ä¸å…¶å®ƒé€šä¿¡æœºåˆ¶ï¼Œå¦‚ä¿¡å·é‡ç»“åˆä½¿ç”¨ï¼Œæ¥è¾¾åˆ°è¿›ç¨‹é—´çš„åŒæ­¥åŠäº’æ–¥ã€‚\n ä¼˜ç‚¹ï¼šæ— é¡»å¤åˆ¶ï¼Œå¿«æ·ï¼Œä¿¡æ¯é‡å¤§ ç¼ºç‚¹ï¼š  é€šä¿¡æ˜¯é€šè¿‡å°†å…±äº«ç©ºé—´ç¼“å†²åŒºç›´æ¥é™„åŠ åˆ°è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­æ¥å®ç°çš„ï¼Œå› æ­¤è¿›ç¨‹é—´çš„è¯»å†™æ“ä½œçš„åŒæ­¥é—®é¢˜ åˆ©ç”¨å†…å­˜ç¼“å†²åŒºç›´æ¥äº¤æ¢ä¿¡æ¯ï¼Œå†…å­˜çš„å®ä½“å­˜åœ¨äºè®¡ç®—æœºä¸­ï¼Œåªèƒ½åŒä¸€ä¸ªè®¡ç®—æœºç³»ç»Ÿä¸­çš„è¯¸å¤šè¿›ç¨‹å…±äº«ï¼Œä¸æ–¹ä¾¿ç½‘ç»œé€šä¿¡      åŸŸå¥—æ¥å­—(Domain Socket)\næ›´ä¸ºä¸€èˆ¬çš„è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼Œå¯ç”¨äºä¸åŒæœºå™¨ä¹‹é—´çš„è¿›ç¨‹é—´é€šä¿¡ã€‚èµ·åˆæ˜¯ç”±Unixç³»ç»Ÿçš„BSDåˆ†æ”¯å¼€å‘å‡ºæ¥çš„ï¼Œä½†ç°åœ¨ä¸€èˆ¬å¯ä»¥ç§»æ¤åˆ°å…¶å®ƒç±»Unixç³»ç»Ÿä¸Šï¼šLinuxå’ŒSystem Vçš„å˜ç§éƒ½æ”¯æŒå¥—æ¥å­—ã€‚\n  ä¿¡å·(Signal)\nä¿¡å·æ˜¯æ¯”è¾ƒå¤æ‚çš„é€šä¿¡æ–¹å¼ï¼Œç”¨äºé€šçŸ¥æ¥å—è¿›ç¨‹æœ‰æŸç§äº‹ä»¶å‘ç”Ÿï¼Œé™¤äº†ç”¨äºè¿›ç¨‹é—´é€šä¿¡å¤–ï¼Œè¿›ç¨‹è¿˜å¯ä»¥å‘é€ä¿¡å·ç»™è¿›ç¨‹æœ¬èº«ï¼›Linuxé™¤äº†æ”¯æŒUnixæ—©æœŸä¿¡å·è¯­ä¹‰å‡½æ•°sigalå¤–ï¼Œè¿˜æ”¯æŒè¯­ä¹‰ç¬¦åˆPosix.1æ ‡å‡†çš„ä¿¡å·å‡½æ•°sigactionï¼ˆå®é™…ä¸Šï¼Œè¯¥å‡½æ•°æ˜¯åŸºäºBSDçš„ï¼ŒBSDä¸ºäº†å®ç°å¯é ä¿¡å·æœºåˆ¶ï¼Œåˆèƒ½å¤Ÿç»Ÿä¸€å¯¹å¤–æ¥å£ï¼Œç”¨sigactionå‡½æ•°é‡æ–°å®ç°äº†signalå‡½æ•°ï¼‰ï¼›\n ä¸€èˆ¬æ¥è¯´ï¼Œsignalæ˜¯å¯¹â€œä¸­æ–­\u0026quot;è¿™ç§æ¦‚å¿µåœ¨è½¯ä»¶å±‚é¢ä¸Šçš„æ¨¡æ‹Ÿï¼Œä¹Ÿç§°â€è½¯ä¸­æ–­â€œï¼Œå…¶ä¸­ä¿¡å·çš„å‘é€è€…ç›¸å½“äºä¸­æ–­æºï¼Œè€Œæ¥æ”¶è€…ç›¸å½“äºå¤„ç†å™¨ï¼Œæ‰€ä»¥å¿…é¡»æ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚\n   å¦‚æœè¯´â€œå‘½åç®¡é“â€æŠŠâ€œç®¡é“â€è¿™ç§åŸæ¥åªé€‚ç”¨è¿‘äº²çš„æ‰‹æ®µæ¨å¹¿åˆ°äº†åŒä¸€å°è®¡ç®—æœºä¸­çš„ä»»æ„è¿›ç¨‹ä¹‹é—´ï¼Œåˆ™Socketåˆè¿›ä¸€æ­¥å°†å…¶æ¨å¹¿è‡³è®¡ç®—æœºç½‘ç»œä¸­çš„ä»»æ„è¿›ç¨‹ä¹‹é—´ã€‚ä»è¿™ä¸ªæ„ä¹‰ä¸Šè®²ï¼ŒSocketæˆäº†æœ€ä¸€èˆ¬ã€æœ€æ™®éé€‚ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ‰‹æ®µå’Œæœºåˆ¶ã€‚äº‹å®ä¸Šï¼Œç°åœ¨æœ‰äº›Unixç³»ç»Ÿä¸­çš„ç®¡é“æœºåˆ¶ä¹Ÿåè¿‡æ¥æ”¹æˆé€šè¿‡Socketæ¥å®ç°ã€‚\nä¸ºä»€ä¹ˆå…±äº«å†…å­˜æ›´å¿«ï¼Ÿ æ‹·è´4æ¬¡(ä¸€èˆ¬è¿›ç¨‹é€šä¿¡æ–¹å¼)\n1ï¼Œç”±ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºä¸­å°†æ•°æ®æ‹·è´åˆ°å†…æ ¸ç©ºé—´ç¼“å†²åŒºä¸­\n2ï¼Œå†…æ ¸ç©ºé—´ç¼“å†²åŒºå°†æ•°æ®æ‹·è´åˆ°å†…å­˜ä¸­\n3ï¼Œå†…å­˜å°†æ•°æ®æ‹·è´åˆ°åˆ°å†…æ ¸ç¼“å†²åŒº\n4ï¼Œå†…æ ¸ç©ºé—´ç¼“å†²åŒºåˆ°ç”¨æˆ·ç©ºé—´ç¼“å†²åŒº.\næ‹·è´2æ¬¡(å…±äº«å†…å­˜é€šä¿¡)\n1ï¼Œç”¨æˆ·ç©ºé—´åˆ°å†…å­˜ã€‚\n2ï¼Œå†…å­˜åˆ°ç”¨æˆ·ç©ºé—´ã€‚\nçº¿ç¨‹é—´é€šä¿¡ğŸ‘‚  é”æœºåˆ¶ï¼šåŒ…æ‹¬äº’æ–¥é”/é‡ï¼ˆmutexï¼‰ã€è¯»å†™é”ï¼ˆreader-writer lockï¼‰ã€è‡ªæ—‹é”ï¼ˆspin lockï¼‰ã€æ¡ä»¶å˜é‡ï¼ˆconditionï¼‰  äº’æ–¥é”/é‡ï¼ˆmutexï¼‰ï¼šæä¾›äº†ä»¥æ’ä»–æ–¹å¼é˜²æ­¢æ•°æ®ç»“æ„è¢«å¹¶å‘ä¿®æ”¹çš„æ–¹æ³•ã€‚ è¯»å†™é”ï¼ˆreader-writer lockï¼‰ï¼šå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å…±äº«æ•°æ®ï¼Œè€Œå¯¹å†™æ“ä½œæ˜¯äº’æ–¥çš„ã€‚ è‡ªæ—‹é”ï¼ˆspin lockï¼‰ä¸äº’æ–¥é”ç±»ä¼¼ï¼Œéƒ½æ˜¯ä¸ºäº†ä¿æŠ¤å…±äº«èµ„æºã€‚äº’æ–¥é”æ˜¯å½“èµ„æºè¢«å ç”¨ï¼Œç”³è¯·è€…è¿›å…¥ç¡çœ çŠ¶æ€ï¼›è€Œè‡ªæ—‹é”åˆ™å¾ªç¯æ£€æµ‹ä¿æŒè€…æ˜¯å¦å·²ç»é‡Šæ”¾é”ã€‚ æ¡ä»¶å˜é‡ï¼ˆconditionï¼‰ï¼šå¯ä»¥ä»¥åŸå­çš„æ–¹å¼é˜»å¡è¿›ç¨‹ï¼Œç›´åˆ°æŸä¸ªç‰¹å®šæ¡ä»¶ä¸ºçœŸä¸ºæ­¢ã€‚å¯¹æ¡ä»¶çš„æµ‹è¯•æ˜¯åœ¨äº’æ–¥é”çš„ä¿æŠ¤ä¸‹è¿›è¡Œçš„ã€‚æ¡ä»¶å˜é‡å§‹ç»ˆä¸äº’æ–¥é”ä¸€èµ·ä½¿ç”¨ã€‚   ä¿¡å·é‡æœºåˆ¶(Semaphore)  æ— åçº¿ç¨‹ä¿¡å·é‡ å‘½åçº¿ç¨‹ä¿¡å·é‡   ä¿¡å·æœºåˆ¶(Signal)ï¼šç±»ä¼¼è¿›ç¨‹é—´çš„ä¿¡å·å¤„ç† å±éšœï¼ˆbarrierï¼‰ï¼šå±éšœå…è®¸æ¯ä¸ªçº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°æ‰€æœ‰çš„åˆä½œçº¿ç¨‹éƒ½è¾¾åˆ°æŸä¸€ç‚¹ï¼Œç„¶åä»è¯¥ç‚¹ç»§ç»­æ‰§è¡Œã€‚  çº¿ç¨‹é—´çš„é€šä¿¡ç›®çš„ä¸»è¦æ˜¯ç”¨äºçº¿ç¨‹åŒæ­¥ï¼Œæ‰€ä»¥çº¿ç¨‹æ²¡æœ‰åƒè¿›ç¨‹é€šä¿¡ä¸­çš„ç”¨äºæ•°æ®äº¤æ¢çš„é€šä¿¡æœºåˆ¶\nä»€ä¹ˆæ˜¯å­¤å„¿è¿›ç¨‹ã€åƒµå°¸è¿›ç¨‹ï¼Ÿ åœ¨unix/linuxä¸­ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œå­è¿›ç¨‹æ˜¯é€šè¿‡çˆ¶è¿›ç¨‹åˆ›å»ºçš„ï¼Œå­è¿›ç¨‹åœ¨åˆ›å»ºæ–°çš„è¿›ç¨‹ã€‚å­è¿›ç¨‹çš„ç»“æŸå’Œçˆ¶è¿›ç¨‹çš„è¿è¡Œæ˜¯ä¸€ä¸ªå¼‚æ­¥è¿‡ç¨‹,å³çˆ¶è¿›ç¨‹æ°¸è¿œæ— æ³•é¢„æµ‹å­è¿›ç¨‹ åˆ°åº•ä»€ä¹ˆæ—¶å€™ç»“æŸã€‚ å½“ä¸€ä¸ª è¿›ç¨‹å®Œæˆå®ƒçš„å·¥ä½œç»ˆæ­¢ä¹‹åï¼Œå®ƒçš„çˆ¶è¿›ç¨‹éœ€è¦è°ƒç”¨wait()æˆ–è€…waitpid()ç³»ç»Ÿè°ƒç”¨å–å¾—å­è¿›ç¨‹çš„ç»ˆæ­¢çŠ¶æ€ã€‚\nå­¤å„¿è¿›ç¨‹:\nä¸€ä¸ªçˆ¶è¿›ç¨‹é€€å‡ºï¼Œè€Œå®ƒçš„ä¸€ä¸ªæˆ–å¤šä¸ªå­è¿›ç¨‹è¿˜åœ¨è¿è¡Œï¼Œé‚£ä¹ˆé‚£äº›å­è¿›ç¨‹å°†æˆä¸ºå­¤å„¿è¿›ç¨‹ã€‚å­¤å„¿è¿›ç¨‹å°†è¢«initè¿›ç¨‹(è¿›ç¨‹å·ä¸º1)æ‰€æ”¶å…»ï¼Œå¹¶ç”±initè¿›ç¨‹å¯¹å®ƒä»¬å®ŒæˆçŠ¶æ€æ”¶é›†å·¥ä½œã€‚\nåƒµå°¸è¿›ç¨‹ï¼š\nä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨forkåˆ›å»ºå­è¿›ç¨‹ï¼Œå¦‚æœå­è¿›ç¨‹é€€å‡ºï¼Œè€Œçˆ¶è¿›ç¨‹å¹¶æ²¡æœ‰è°ƒç”¨waitæˆ–waitpidè·å–å­è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ï¼Œé‚£ä¹ˆå­è¿›ç¨‹çš„è¿›ç¨‹æè¿°ç¬¦ä»ç„¶ä¿å­˜åœ¨ç³»ç»Ÿä¸­ã€‚è¿™ç§è¿›ç¨‹ç§°ä¹‹ä¸ºåƒµæ­»è¿›ç¨‹ã€‚\nå¤„ç†åƒµå°¸è¿›ç¨‹ï¼š\n  å¹²æ‰çˆ¶è¿›ç¨‹ï»¿\nå¹²æ‰çˆ¶è¿›ç¨‹åï¼Œè®©å‰©ä¸‹çš„å­è¿›ç¨‹æˆä¸ºå­¤å„¿è¿›ç¨‹ï¼Œæˆä¸ºå­¤å„¿è¿›ç¨‹åå°±å’Œæˆ‘ä»¬ä¸Šé¢è¯´çš„ä¸€æ ·äº†ï¼Œç”±initè¿›ç¨‹æ¥é¢†å…»è¿™äº›è¿›ç¨‹ï¼Œå¹¶ä¸”æ¥å¤„ç†è¿™äº›è¿›ç¨‹çš„èµ„æºé‡Šæ”¾ç­‰å·¥ä½œã€‚\n  çˆ¶è¿›ç¨‹è°ƒç”¨waitæˆ–waitpid\nç­‰å‡½æ•°ç­‰å¾…å­è¿›ç¨‹ç»“æŸï¼Œè¿™ä¼šå¯¼è‡´çˆ¶è¿›ç¨‹æŒ‚èµ·ã€‚\næ‰§è¡Œwaitï¼ˆï¼‰æˆ– waitpidï¼ˆï¼‰ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ™å­è¿›ç¨‹åœ¨ç»ˆæ­¢åä¼šç«‹å³æŠŠå®ƒåœ¨è¿›ç¨‹è¡¨ä¸­çš„æ•°æ®è¿”å›ç»™çˆ¶è¿›ç¨‹ï¼Œæ­¤æ—¶ç³»ç»Ÿä¼šç«‹å³åˆ é™¤è¯¥è¿›å…¥ç‚¹ã€‚åœ¨è¿™ç§æƒ…å½¢ä¸‹å°±ä¸ä¼šäº§ç”Ÿdefunctè¿›ç¨‹ã€‚\n  forkä¸¤æ¬¡\nç¬¬ä¸€æ¬¡ fork : çˆ¶è¿›ç¨‹forkä¸€ä¸ªå­è¿›ç¨‹\nç¬¬äºŒæ¬¡ fork : å­è¿›ç¨‹forkä¸€ä¸ªå­™è¿›ç¨‹åé€€å‡º\né‚£ä¹ˆå­™è¿›ç¨‹è¢«initæ¥ç®¡ï¼Œå½“å­™è¿›ç¨‹ç»“æŸåï¼Œinitä¼šå›æ”¶ã€‚\nä½†å­è¿›ç¨‹çš„å›æ”¶è¿˜è¦è‡ªå·±åšã€‚\n  signalå‡½æ•°\nçˆ¶è¿›ç¨‹æ¥å¤„ç†ï¼šç”¨signalå‡½æ•°ä¸ºSIGCHLDå®‰è£…handlerï¼Œåœ¨å­è¿›ç¨‹ç»“æŸåï¼Œçˆ¶è¿›ç¨‹ä¼šæ”¶åˆ°è¯¥ä¿¡å·ï¼Œå¯ä»¥åœ¨handlerä¸­è°ƒç”¨waitå›æ”¶ã€‚\nå†…æ ¸æ¥å¤„ç†:\nå¦‚æœçˆ¶è¿›ç¨‹ä¸å…³å¿ƒå­è¿›ç¨‹ä»€ä¹ˆæ—¶å€™ç»“æŸï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°é€šçŸ¥å†…æ ¸è‡ªå·±ä¸æ„Ÿå…´è¶£å­è¿›ç¨‹çš„ç»“æŸï¼Œæ­¤æ—¶ï¼Œå­è¿›ç¨‹ç»“æŸåï¼Œå†…æ ¸ä¼šå›æ”¶å¹¶ä¸å†ç»™ä½ çˆ¶è¿›ç¨‹å‘ä¿¡å·ã€‚\n signalï¼ˆSIGCLD, SIG_IGNï¼‰ signalï¼ˆSIGCHLD, SIG_IGNï¼‰    ï»¿\nå‚è€ƒï¼šå­¤å„¿è¿›ç¨‹ä¸åƒµå°¸è¿›ç¨‹æ€»ç»“\nå†…æ ¸æ€å’Œç”¨æˆ·æ€ğŸ’ ä¸ºäº†å®‰å…¨ï¼Œç”¨æˆ·è¿›ç¨‹æ˜¯å—é™çš„ï¼Œå®ƒä¸èƒ½éšæ„è®¿é—®èµ„æºã€è·å–èµ„æºã€‚æ‰€ä»¥ï¼Œç”±å†…æ ¸è¿›ç¨‹è´Ÿè´£ç®¡ç†å’Œåˆ†é…èµ„æºï¼Œå®ƒå…·æœ‰æœ€é«˜æƒé™ï¼Œè€Œç”¨æˆ·è¿›ç¨‹ä½¿ç”¨è¢«åˆ†é…çš„èµ„æºã€‚ç”¨æˆ·æ€çš„ç¨‹åºä¸èƒ½ éšæ„æ“ä½œå†…æ ¸åœ°å€ç©ºé—´ï¼Œå…·æœ‰ä¸€å®šçš„å®‰å…¨ä¿æŠ¤ä½œç”¨ã€‚\nè€Œä¸”ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»èƒ½å¤Ÿåœ¨æœ‰éœ€è¦çš„æ—¶å€™èƒ½ç«‹å³åˆ‡æ¢å›å†…æ ¸è¿›ç¨‹(é€šè¿‡ä¸­æ–­)ï¼Œåªæœ‰è¿™æ ·ï¼Œæ“ä½œç³»ç»Ÿæ‰èƒ½æœ‰å®‰å…¨æ„Ÿã€‚\nç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€çš„3ç§æ–¹å¼   ç³»ç»Ÿè°ƒç”¨\nè¿™æ˜¯ç”¨æˆ·æ€è¿›ç¨‹ä¸»åŠ¨è¦æ±‚åˆ‡æ¢åˆ°å†…æ ¸æ€çš„ä¸€ç§æ–¹å¼ï¼Œç”¨æˆ·æ€è¿›ç¨‹é€šè¿‡ç³»ç»Ÿè°ƒç”¨ç”³è¯·ä½¿ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„æœåŠ¡ç¨‹åºå®Œæˆå·¥ä½œï¼Œæ¯”å¦‚fork()å®é™…ä¸Šå°±æ˜¯æ‰§è¡Œäº†ä¸€ä¸ªåˆ›å»ºæ–°è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ã€‚è€Œç³»ç»Ÿè°ƒç”¨çš„æœºåˆ¶å…¶æ ¸å¿ƒè¿˜æ˜¯ä½¿ç”¨äº†æ“ä½œç³»ç»Ÿä¸ºç”¨æˆ·ç‰¹åˆ«å¼€æ”¾çš„ä¸€ä¸ªä¸­æ–­æ¥å®ç°ï¼Œä¾‹å¦‚Linuxçš„int 80hä¸­æ–­ã€‚\n  ä¸­æ–­\nå½“å¤–å›´è®¾å¤‡å®Œæˆç”¨æˆ·è¯·æ±‚çš„æ“ä½œåï¼Œä¼šå‘CPUå‘å‡ºç›¸åº”çš„ä¸­æ–­ä¿¡å·ï¼Œè¿™æ—¶CPUä¼šæš‚åœæ‰§è¡Œä¸‹ä¸€æ¡å³å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤è½¬è€Œå»æ‰§è¡Œä¸ä¸­æ–­ä¿¡å·å¯¹åº”çš„å¤„ç†ç¨‹åºï¼Œå¦‚æœå…ˆå‰æ‰§è¡Œçš„æŒ‡ä»¤æ˜¯ç”¨æˆ·æ€ä¸‹çš„ç¨‹åºï¼Œé‚£ä¹ˆè¿™ä¸ªè½¬æ¢çš„è¿‡ç¨‹è‡ªç„¶ä¹Ÿå°±å‘ç”Ÿäº†ç”±ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢ã€‚æ¯”å¦‚ç¡¬ç›˜è¯»å†™æ“ä½œå®Œæˆï¼Œç³»ç»Ÿä¼šåˆ‡æ¢åˆ°ç¡¬ç›˜è¯»å†™çš„ä¸­æ–­å¤„ç†ç¨‹åºä¸­æ‰§è¡Œåç»­æ“ä½œç­‰ã€‚\n  å¼‚å¸¸\nå½“CPUåœ¨æ‰§è¡Œè¿è¡Œåœ¨ç”¨æˆ·æ€ä¸‹çš„ç¨‹åºæ—¶ï¼Œå‘ç”Ÿäº†æŸäº›äº‹å…ˆä¸å¯çŸ¥çš„å¼‚å¸¸ï¼Œè¿™æ—¶ä¼šè§¦å‘ç”±å½“å‰è¿è¡Œè¿›ç¨‹åˆ‡æ¢åˆ°å¤„ç†æ­¤å¼‚å¸¸çš„å†…æ ¸ç›¸å…³ç¨‹åºä¸­ï¼Œä¹Ÿå°±è½¬åˆ°äº†å†…æ ¸æ€ï¼Œæ¯”å¦‚ç¼ºé¡µå¼‚å¸¸ã€‚\n  free()å‡½æ•°å¦‚ä½•çŸ¥é“è¦é‡Šæ”¾çš„ç©ºé—´å¤§å°â“ mallocæœ‰å¤šç§å®ç°ï¼Œæœ‰ä½¿ç”¨é“¾è¡¨çš„ï¼Œä¹Ÿæœ‰æ˜¯ç”±åœ¨ç”³è¯·å†…å­˜å¤´éƒ¨è®°å½•ä¿¡æ¯çš„ï¼Œè¿˜æœ‰ä½¿ç”¨ä¼™ä¼´çš„ç®—æ³•ã€‚æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„mallocç®—æ³•ã€‚\nå‚è€ƒï¼šhttps://www.zhihu.com/question/302440083\nä¸­æ–­å’Œè½®è¯¢çš„ç‰¹ç‚¹ğŸ¥š å¯¹I/Oè®¾å¤‡çš„ç¨‹åºè½®è¯¢çš„æ–¹å¼ï¼Œæ˜¯æ—©æœŸçš„è®¡ç®—æœºç³»ç»Ÿå¯¹I/Oè®¾å¤‡çš„ä¸€ç§ç®¡ç†æ–¹å¼ã€‚å®ƒå®šæ—¶å¯¹å„ç§è®¾å¤‡è½®æµè¯¢é—®ä¸€éæœ‰æ— å¤„ç†è¦æ±‚ã€‚è½®æµè¯¢é—®ä¹‹åï¼Œæœ‰è¦æ±‚çš„ï¼Œåˆ™åŠ ä»¥å¤„ç†ã€‚åœ¨å¤„ç†I/Oè®¾å¤‡çš„è¦æ±‚ä¹‹åï¼Œå¤„ç†æœºè¿”å›ç»§ç»­å·¥ä½œã€‚å°½ç®¡è½®è¯¢éœ€è¦æ—¶é—´ï¼Œä½†è½®è¯¢è¦æ¯”I/Oè®¾å¤‡çš„é€Ÿåº¦è¦å¿«å¾—å¤šï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šå‘ç”Ÿä¸èƒ½åŠæ—¶å¤„ç†çš„é—®é¢˜ã€‚å½“ç„¶ï¼Œå†å¿«çš„å¤„ç†æœºï¼Œèƒ½å¤„ç†çš„è¾“å…¥è¾“å‡ºè®¾å¤‡çš„æ•°é‡ä¹Ÿæ˜¯æœ‰ä¸€å®šé™åº¦çš„ã€‚è€Œä¸”ï¼Œç¨‹åºè½®è¯¢æ¯•ç«Ÿå æ®äº†CPUç›¸å½“ä¸€éƒ¨åˆ†å¤„ç†æ—¶é—´ï¼Œå› æ­¤ï¼Œç¨‹åºè½®è¯¢æ˜¯ä¸€ç§æ•ˆç‡è¾ƒä½çš„æ–¹å¼ï¼Œåœ¨ç°ä»£è®¡ç®—æœºç³»ç»Ÿä¸­å·²å¾ˆå°‘åº”ç”¨ã€‚\nã€€ç¨‹åºä¸­æ–­é€šå¸¸ç®€ç§°ä¸­æ–­ï¼Œæ˜¯æŒ‡CPUåœ¨æ­£å¸¸è¿è¡Œç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œç”±äºé¢„å…ˆå®‰æ’æˆ–å‘ç”Ÿäº†å„ç§éšæœºçš„å†…éƒ¨æˆ–å¤–éƒ¨äº‹ä»¶ï¼Œä½¿CPUä¸­æ–­æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œè€Œè½¬åˆ°ä¸ºå“åº”çš„æœåŠ¡ç¨‹åºå»å¤„ç†ã€‚\nã€€è½®è¯¢â€”â€”æ•ˆç‡ä½ï¼Œç­‰å¾…æ—¶é—´å¾ˆé•¿ï¼ŒCPUåˆ©ç”¨ç‡ä¸é«˜ã€‚\nã€€ä¸­æ–­â€”â€”å®¹æ˜“é—æ¼ä¸€äº›é—®é¢˜ï¼ŒCPUåˆ©ç”¨ç‡é«˜ã€‚\n ä¸­æ–­æ˜¯æŒ‡åœ¨è®¡ç®—æœºæ‰§è¡ŒæœŸé—´ï¼Œç³»ç»Ÿå†…å‘ç”Ÿä»»ä½•éå¯»å¸¸çš„æˆ–éé¢„æœŸçš„æ€¥éœ€å¤„ç†äº‹ä»¶ï¼Œä½¿å¾—CPUæš‚æ—¶ä¸­æ–­å½“å‰æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºè€Œè½¬å»æ‰§è¡Œç›¸åº”çš„äº‹ä»¶å¤„ç†ç¨‹åºã€‚å¾…å¤„ç†å®Œæ¯•ååˆè¿”å›åŸæ¥è¢«ä¸­æ–­å¤„ç»§ç»­æ‰§è¡Œæˆ–è°ƒåº¦æ–°çš„è¿›ç¨‹æ‰§è¡Œçš„è¿‡ç¨‹ã€‚\n ä¸­æ–­å‘é‡è¡¨\nå¤–éƒ¨è®¾å¤‡çš„ä¸­æ–­å¸¸å¸¸å¯¹åº”å‘é‡è¡¨ä¸­çš„æŸä¸€é¡¹ï¼Œè¿™æ˜¯é€šç”¨æ¡†æ¶çš„å¤–éƒ¨ä¸­æ–­å¤„ç†å‡½æ•°å…¥å£ï¼Œå› æ­¤åœ¨è¿›å…¥é€šç”¨çš„ä¸­æ–­å¤„ç†å‡½æ•°ä¹‹åï¼Œç³»ç»Ÿå¿…é¡»çŸ¥é“æ­£åœ¨å¤„ç†çš„ä¸­æ–­æ˜¯å“ªä¸€ä¸ªè®¾å¤‡äº§ç”Ÿçš„ï¼Œè€Œè¿™æ­£æ˜¯ç”±è½¯ä»¶ä¸­æ–­å·irqå®šçš„å†³ã€‚ä¸­æ–­å‘é‡è¡¨çš„å†…å®¹æ˜¯ç”±æ“ä½œç³»ç»Ÿåœ¨åˆå§‹åŒ–é˜¶æ®µæ¥å¡«å†™ï¼Œå¯¹äºå¤–éƒ¨ä¸­æ–­ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£å®ç°ä¸€ä¸ªé€šç”¨çš„å¤–éƒ¨ä¸­æ–­å¤„ç†å‡½æ•°ï¼Œç„¶åæŠŠè¿™ä¸ªå‡½æ•°çš„å…¥å£åœ°å€æ”¾åˆ°ä¸­æ–­å‘é‡è¡¨ä¸­çš„å¯¹åº”ä½ç½®ã€‚ç”¨æˆ·æ³¨å†Œè®¾å¤‡é©±åŠ¨ISRï¼Œå®é™…ä¸Šå°±æ˜¯æŒ‚æ¥åˆ°ä¸­æ–­å‘é‡è¡¨ä¸­ï¼Œè¦†ç›–æŸä¸€é¡¹çš„é»˜è®¤å¤„ç†å®ç°ç‰¹åŒ–ã€‚\nåˆ†æ®µä¸åˆ†é¡µğŸ‘“ æ®µå¼å­˜å‚¨ç®¡ç†æ˜¯ä¸€ç§ç¬¦åˆç”¨æˆ·è§†è§’çš„å†…å­˜åˆ†é…ç®¡ç†æ–¹æ¡ˆã€‚åœ¨æ®µå¼å­˜å‚¨ç®¡ç†ä¸­ï¼Œå°†ç¨‹åºçš„åœ°å€ç©ºé—´åˆ’åˆ†ä¸ºè‹¥å¹²æ®µï¼ˆsegmentï¼‰ï¼Œå¦‚ä»£ç æ®µï¼Œæ•°æ®æ®µï¼Œå †æ ˆæ®µï¼›è¿™æ ·æ¯ä¸ªè¿›ç¨‹æœ‰ä¸€ä¸ªäºŒç»´åœ°å€ç©ºé—´ï¼Œç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ã€‚æ®µå¼ç®¡ç†çš„ä¼˜ç‚¹æ˜¯ï¼šæ²¡æœ‰å†…ç¢ç‰‡ï¼ˆå› ä¸ºæ®µå¤§å°å¯å˜ï¼Œæ”¹å˜æ®µå¤§å°æ¥æ¶ˆé™¤å†…ç¢ç‰‡ï¼‰ã€‚ä½†æ®µæ¢å…¥æ¢å‡ºæ—¶ï¼Œä¼šäº§ç”Ÿå¤–ç¢ç‰‡ï¼ˆæ¯”å¦‚4kçš„æ®µæ¢5kçš„æ®µï¼Œä¼šäº§ç”Ÿ1kçš„å¤–ç¢ç‰‡ï¼‰\né¡µå¼å­˜å‚¨ç®¡ç†æ–¹æ¡ˆæ˜¯ä¸€ç§ç”¨æˆ·è§†è§’å†…å­˜ä¸ç‰©ç†å†…å­˜ç›¸åˆ†ç¦»çš„å†…å­˜åˆ†é…ç®¡ç†æ–¹æ¡ˆã€‚åœ¨é¡µå¼å­˜å‚¨ç®¡ç†ä¸­ï¼Œå°†ç¨‹åºçš„é€»è¾‘åœ°å€åˆ’åˆ†ä¸ºå›ºå®šå¤§å°çš„é¡µï¼ˆpageï¼‰ï¼Œè€Œç‰©ç†å†…å­˜åˆ’åˆ†ä¸ºåŒæ ·å¤§å°çš„å¸§ï¼Œç¨‹åºåŠ è½½æ—¶ï¼Œå¯ä»¥å°†ä»»æ„ä¸€é¡µæ”¾å…¥å†…å­˜ä¸­ä»»æ„ä¸€ä¸ªå¸§ï¼Œè¿™äº›å¸§ä¸å¿…è¿ç»­ï¼Œä»è€Œå®ç°äº†ç¦»æ•£åˆ†ç¦»ã€‚é¡µå¼å­˜å‚¨ç®¡ç†çš„ä¼˜ç‚¹æ˜¯ï¼šæ²¡æœ‰å¤–ç¢ç‰‡ï¼ˆå› ä¸ºé¡µçš„å¤§å°å›ºå®šï¼‰ï¼Œä½†ä¼šäº§ç”Ÿå†…ç¢ç‰‡ï¼ˆä¸€ä¸ªé¡µå¯èƒ½å¡«å……ä¸æ»¡ï¼‰ã€‚\nä¸¤è€…çš„ä¸åŒç‚¹ï¼š\nç›®çš„ä¸åŒï¼šåˆ†é¡µæ˜¯ç”±äºç³»ç»Ÿç®¡ç†çš„éœ€è¦è€Œä¸æ˜¯ç”¨æˆ·çš„éœ€è¦ï¼Œå®ƒæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ï¼›åˆ†æ®µçš„ç›®çš„æ˜¯ä¸ºäº†èƒ½æ›´å¥½åœ°æ»¡è¶³ç”¨æˆ·çš„éœ€è¦ï¼Œå®ƒæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œå®ƒå«æœ‰ä¸€ç»„å…¶æ„ä¹‰ç›¸å¯¹å®Œæ•´çš„ä¿¡æ¯ï¼›\nå¤§å°ä¸åŒï¼šé¡µçš„å¤§å°å›ºå®šä¸”ç”±ç³»ç»Ÿå†³å®šï¼Œè€Œæ®µçš„é•¿åº¦å´ä¸å›ºå®šï¼Œç”±å…¶æ‰€å®Œæˆçš„åŠŸèƒ½å†³å®šï¼›\nåœ°å€ç©ºé—´ä¸åŒï¼š æ®µå‘ç”¨æˆ·æä¾›äºŒç»´åœ°å€ç©ºé—´ï¼›é¡µå‘ç”¨æˆ·æä¾›çš„æ˜¯ä¸€ç»´åœ°å€ç©ºé—´ï¼›\nä¿¡æ¯å…±äº«ï¼šæ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œä¾¿äºå­˜å‚¨ä¿æŠ¤å’Œä¿¡æ¯çš„å…±äº«ï¼Œé¡µçš„ä¿æŠ¤å’Œå…±äº«å—åˆ°é™åˆ¶ï¼›\nå†…å­˜ç¢ç‰‡ï¼šé¡µå¼å­˜å‚¨ç®¡ç†çš„ä¼˜ç‚¹æ˜¯æ²¡æœ‰å¤–ç¢ç‰‡ï¼ˆå› ä¸ºé¡µçš„å¤§å°å›ºå®šï¼‰ï¼Œä½†ä¼šäº§ç”Ÿå†…ç¢ç‰‡ï¼ˆä¸€ä¸ªé¡µå¯èƒ½å¡«å……ä¸æ»¡ï¼‰ï¼›è€Œæ®µå¼ç®¡ç†çš„ä¼˜ç‚¹æ˜¯æ²¡æœ‰å†…ç¢ç‰‡ï¼ˆå› ä¸ºæ®µå¤§å°å¯å˜ï¼Œæ”¹å˜æ®µå¤§å°æ¥æ¶ˆé™¤å†…ç¢ç‰‡ï¼‰ã€‚ä½†æ®µæ¢å…¥æ¢å‡ºæ—¶ï¼Œä¼šäº§ç”Ÿå¤–ç¢ç‰‡ï¼ˆæ¯”å¦‚4kçš„æ®µæ¢5kçš„æ®µï¼Œä¼šäº§ç”Ÿ1kçš„å¤–ç¢ç‰‡ï¼‰ã€‚\n æ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œå®ƒæ˜¯æ ¹æ®ç”¨æˆ·çš„éœ€è¦åˆ’åˆ†çš„ï¼Œå› æ­¤æ®µå¯¹ç”¨æˆ·æ˜¯å¯è§çš„ ï¼›é¡µæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ï¼Œæ˜¯ä¸ºäº†ç®¡ç†ä¸»å­˜çš„æ–¹ä¾¿è€Œåˆ’åˆ†çš„ï¼Œå¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ã€‚ æ®µçš„å¤§å°ä¸å›ºå®šï¼Œæœ‰å®ƒæ‰€å®Œæˆçš„åŠŸèƒ½å†³å®šï¼›é¡µå¤§å¤§å°å›ºå®šï¼Œç”±ç³»ç»Ÿå†³å®š æ®µå‘ç”¨æˆ·æä¾›äºŒç»´åœ°å€ç©ºé—´ï¼›é¡µå‘ç”¨æˆ·æä¾›çš„æ˜¯ä¸€ç»´åœ°å€ç©ºé—´ æ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œä¾¿äºå­˜å‚¨ä¿æŠ¤å’Œä¿¡æ¯çš„å…±äº«ï¼Œé¡µçš„ä¿æŠ¤å’Œå…±äº«å—åˆ°é™åˆ¶ã€‚  é¡µæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ï¼Œåˆ†é¡µæ˜¯ä¸ºå®ç°ç¦»æ•£åˆ†é…æ–¹å¼ï¼Œä»¥æ¶ˆå‡å†…å­˜çš„å¤–é›¶å¤´ï¼Œæé«˜å†…å­˜çš„åˆ©ç”¨ç‡ï¼›æˆ–è€…è¯´ï¼Œåˆ†é¡µä»…ä»…æ˜¯ç”±äºç³»ç»Ÿç®¡ç†çš„éœ€è¦ï¼Œè€Œä¸æ˜¯ç”¨æˆ·çš„éœ€è¦ã€‚\næ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œå®ƒå«æœ‰ä¸€ç»„å…¶æ„ä¹‰ç›¸å¯¹å®Œæ•´çš„ä¿¡æ¯ã€‚åˆ†æ®µçš„ç›®çš„æ˜¯ä¸ºäº†èƒ½æ›´å¥½çš„æ»¡è¶³ç”¨æˆ·çš„éœ€è¦ã€‚\né¡µçš„å¤§å°å›ºå®šä¸”ç”±ç³»ç»Ÿç¡®å®šï¼ŒæŠŠé€»è¾‘åœ°å€åˆ’åˆ†ä¸ºé¡µå·å’Œé¡µå†…åœ°å€ä¸¤éƒ¨åˆ†ï¼Œæ˜¯ç”±æœºå™¨ç¡¬ä»¶å®ç°çš„ï¼Œå› è€Œä¸€ä¸ªç³»ç»Ÿåªèƒ½æœ‰ä¸€ç§å¤§å°çš„é¡µé¢ã€‚æ®µçš„é•¿åº¦å´ä¸å›ºå®šï¼Œå†³å®šäºç”¨æˆ·æ‰€ç¼–å†™çš„ç¨‹åºï¼Œé€šå¸¸ç”±ç¼–è¾‘ç¨‹åºåœ¨å¯¹æºç¨‹åºè¿›è¡Œç¼–è¾‘æ—¶ï¼Œæ ¹æ®ä¿¡æ¯çš„æ€§è´¨æ¥åˆ’åˆ†ã€‚\nåˆ†é¡µçš„ä½œä¸šåœ°å€ç©ºé—´æ˜¯ä¸€ç»´çš„ï¼Œå³å•ä¸€çš„çº¿æ€§ç©ºé—´ï¼Œç¨‹åºå‘˜åªé¡»åˆ©ç”¨ä¸€ä¸ªè®°å¿†ç¬¦ï¼Œå³å¯è¡¨ç¤ºä¸€åœ°å€ã€‚åˆ†æ®µçš„ä½œä¸šåœ°å€ç©ºé—´æ˜¯äºŒç»´çš„ï¼Œç¨‹åºå‘˜åœ¨æ ‡è¯†ä¸€ä¸ªåœ°å€æ—¶ï¼Œæ—¢éœ€ç»™å‡ºæ®µåï¼Œåˆéœ€ç»™å‡ºæ®µå†…åœ°å€ã€‚\nå†…å­˜åˆ†æ®µ ç¨‹åºæ˜¯ç”±è‹¥å¹²ä¸ªé€»è¾‘åˆ†æ®µç»„æˆçš„ï¼Œå¦‚å¯ç”±ä»£ç åˆ†æ®µã€æ•°æ®åˆ†æ®µã€æ ˆæ®µã€å †æ®µç»„æˆã€‚ä¸åŒçš„æ®µæ˜¯æœ‰ä¸åŒçš„å±æ€§çš„ï¼Œæ‰€ä»¥å°±ç”¨åˆ†æ®µï¼ˆSegmentationï¼‰çš„å½¢å¼æŠŠè¿™äº›æ®µåˆ†ç¦»å‡ºæ¥ã€‚\n åˆ†æ®µæœºåˆ¶ä¸‹ï¼Œè™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€æ˜¯å¦‚ä½•æ˜ å°„çš„ï¼Ÿ\n åˆ†æ®µæœºåˆ¶ä¸‹çš„è™šæ‹Ÿåœ°å€ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œæ®µé€‰æ‹©å­å’Œæ®µå†…åç§»é‡ã€‚\n æ®µé€‰æ‹©å­å°±ä¿å­˜åœ¨æ®µå¯„å­˜å™¨é‡Œé¢ã€‚æ®µé€‰æ‹©å­é‡Œé¢æœ€é‡è¦çš„æ˜¯æ®µå·ï¼Œç”¨ä½œæ®µè¡¨çš„ç´¢å¼•ã€‚æ®µè¡¨é‡Œé¢ä¿å­˜çš„æ˜¯è¿™ä¸ªæ®µçš„åŸºåœ°å€ã€æ®µçš„ç•Œé™å’Œç‰¹æƒç­‰çº§ç­‰ã€‚ è™šæ‹Ÿåœ°å€ä¸­çš„æ®µå†…åç§»é‡åº”è¯¥ä½äº 0 å’Œæ®µç•Œé™ä¹‹é—´ï¼Œå¦‚æœæ®µå†…åç§»é‡æ˜¯åˆæ³•çš„ï¼Œå°±å°†æ®µåŸºåœ°å€åŠ ä¸Šæ®µå†…åç§»é‡å¾—åˆ°ç‰©ç†å†…å­˜åœ°å€ã€‚  ç”±ä¸Šé¢å¯ä»¥çŸ¥é“è™šæ‹Ÿåœ°å€æ˜¯é€šè¿‡æ®µè¡¨ä¸ç‰©ç†åœ°å€è¿›è¡Œæ˜ å°„çš„ï¼Œåˆ†æ®µæœºåˆ¶ä¼šæŠŠç¨‹åºçš„è™šæ‹Ÿåœ°å€åˆ†æˆ 4 ä¸ªæ®µï¼Œæ¯ä¸ªæ®µåœ¨æ®µè¡¨ä¸­æœ‰ä¸€ä¸ªé¡¹ï¼Œåœ¨è¿™ä¸€é¡¹æ‰¾åˆ°æ®µçš„åŸºåœ°å€ï¼Œå†åŠ ä¸Šåç§»é‡ï¼Œäºæ˜¯å°±èƒ½æ‰¾åˆ°ç‰©ç†å†…å­˜ä¸­çš„åœ°å€ï¼Œå¦‚ä¸‹å›¾ï¼š\nåˆ†æ®µçš„åŠæ³•å¾ˆå¥½ï¼Œè§£å†³äº†ç¨‹åºæœ¬èº«ä¸éœ€è¦å…³å¿ƒå…·ä½“çš„ç‰©ç†å†…å­˜åœ°å€çš„é—®é¢˜ï¼Œä½†å®ƒä¹Ÿæœ‰ä¸€äº›ä¸è¶³ä¹‹å¤„ï¼š\n ç¬¬ä¸€ä¸ªå°±æ˜¯å†…å­˜ç¢ç‰‡çš„é—®é¢˜ã€‚ ç¬¬äºŒä¸ªå°±æ˜¯å†…å­˜äº¤æ¢çš„æ•ˆç‡ä½çš„é—®é¢˜ã€‚  ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Ÿ\nå‡è®¾æˆ‘ä»¬æ‰§è¡Œäº†ä¸‹é¢å‡ ä¸ªç¨‹åºï¼š\n æ¸¸æˆå ç”¨äº† 512MB å†…å­˜ æµè§ˆå™¨å ç”¨äº† 128MB å†…å­˜ éŸ³ä¹å ç”¨äº† 256 MB å†…å­˜ã€‚  å‡è®¾æœ‰ 1G çš„ç‰©ç†å†…å­˜ï¼Œåˆ™ç©ºé—²å†…å­˜è¿˜æœ‰ 1024 - 512 - 256 = 256MBã€‚å¦‚æœè¿™ä¸ª 256MB ä¸æ˜¯è¿ç»­çš„ï¼Œè¢«åˆ†æˆäº†ä¸¤æ®µ 128 MB å†…å­˜ï¼Œè¿™å°±ä¼šå¯¼è‡´æ²¡æœ‰ç©ºé—´å†æ‰“å¼€ä¸€ä¸ª 200MB çš„ç¨‹åºã€‚\nè¿™é‡Œçš„å†…å­˜ç¢ç‰‡çš„é—®é¢˜å…±æœ‰ä¸¤å¤„åœ°æ–¹ï¼š\n å¤–éƒ¨å†…å­˜ç¢ç‰‡ï¼Œä¹Ÿå°±æ˜¯äº§ç”Ÿäº†å¤šä¸ªä¸è¿ç»­çš„å°ç‰©ç†å†…å­˜ï¼Œå¯¼è‡´æ–°çš„ç¨‹åºæ— æ³•è¢«è£…è½½ï¼› å†…éƒ¨å†…å­˜ç¢ç‰‡ï¼Œç¨‹åºæ‰€æœ‰çš„å†…å­˜éƒ½è¢«è£…è½½åˆ°äº†ç‰©ç†å†…å­˜ï¼Œä½†æ˜¯è¿™ä¸ªç¨‹åºæœ‰éƒ¨åˆ†çš„å†…å­˜å¯èƒ½å¹¶ä¸æ˜¯å¾ˆå¸¸ä½¿ç”¨ï¼Œè¿™ä¹Ÿä¼šå¯¼è‡´å†…å­˜çš„æµªè´¹ï¼›  è§£å†³å¤–éƒ¨å†…å­˜ç¢ç‰‡çš„é—®é¢˜å°±æ˜¯å†…å­˜äº¤æ¢ã€‚\nå¯ä»¥æŠŠéŸ³ä¹ç¨‹åºå ç”¨çš„é‚£ 256MB å†…å­˜å†™åˆ°ç¡¬ç›˜ä¸Šï¼Œç„¶åå†ä»ç¡¬ç›˜ä¸Šè¯»å›æ¥åˆ°å†…å­˜é‡Œã€‚ä¸è¿‡å†è¯»å›çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸èƒ½è£…è½½å›åŸæ¥çš„ä½ç½®ï¼Œè€Œæ˜¯ç´§ç´§è·Ÿç€é‚£å·²ç»è¢«å ç”¨äº†çš„ 512MB å†…å­˜åé¢ã€‚è¿™æ ·å°±èƒ½ç©ºç¼ºå‡ºè¿ç»­çš„ 256MB ç©ºé—´ï¼Œäºæ˜¯æ–°çš„ 200MB ç¨‹åºå°±å¯ä»¥è£…è½½è¿›æ¥ã€‚\nè¿™ä¸ªå†…å­˜äº¤æ¢ç©ºé—´ï¼Œåœ¨ Linux ç³»ç»Ÿé‡Œï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸çœ‹åˆ°çš„ Swap ç©ºé—´ï¼Œè¿™å—ç©ºé—´æ˜¯ä»ç¡¬ç›˜åˆ’åˆ†å‡ºæ¥çš„ï¼Œç”¨äºå†…å­˜ä¸ç¡¬ç›˜çš„ç©ºé—´äº¤æ¢ã€‚\nåˆ†æ®µä¸ºä»€ä¹ˆå¯¼è‡´æ•ˆç‡ä½ï¼Ÿ\nå¯¹äºå¤šè¿›ç¨‹çš„ç³»ç»Ÿæ¥è¯´ï¼Œç”¨åˆ†æ®µçš„æ–¹å¼ï¼Œå†…å­˜ç¢ç‰‡æ˜¯å¾ˆå®¹æ˜“äº§ç”Ÿçš„ï¼Œäº§ç”Ÿäº†å†…å­˜ç¢ç‰‡ï¼Œé‚£ä¸å¾—ä¸é‡æ–° Swap å†…å­˜åŒºåŸŸï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šäº§ç”Ÿæ€§èƒ½ç“¶é¢ˆã€‚\nå› ä¸ºç¡¬ç›˜çš„è®¿é—®é€Ÿåº¦è¦æ¯”å†…å­˜æ…¢å¤ªå¤šäº†ï¼Œæ¯ä¸€æ¬¡å†…å­˜äº¤æ¢ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æŠŠä¸€å¤§æ®µè¿ç»­çš„å†…å­˜æ•°æ®å†™åˆ°ç¡¬ç›˜ä¸Šã€‚\næ‰€ä»¥ï¼Œå¦‚æœå†…å­˜äº¤æ¢çš„æ—¶å€™ï¼Œäº¤æ¢çš„æ˜¯ä¸€ä¸ªå å†…å­˜ç©ºé—´å¾ˆå¤§çš„ç¨‹åºï¼Œè¿™æ ·æ•´ä¸ªæœºå™¨éƒ½ä¼šæ˜¾å¾—å¡é¡¿ã€‚\nå†…å­˜åˆ†é¡µ å†…å­˜åˆ†é¡µå°±æ˜¯ä¸ºäº†è§£å†³åˆ†æ®µçš„å†…å­˜ç¢ç‰‡ä»¥åŠæ•ˆç‡ä½è€Œæå‡ºæ¥çš„ã€‚\nåˆ†é¡µæ˜¯æŠŠæ•´ä¸ªè™šæ‹Ÿå’Œç‰©ç†å†…å­˜ç©ºé—´åˆ‡æˆä¸€æ®µæ®µå›ºå®šå°ºå¯¸çš„å¤§å°ã€‚è¿™æ ·ä¸€ä¸ªè¿ç»­å¹¶ä¸”å°ºå¯¸å›ºå®šçš„å†…å­˜ç©ºé—´ï¼Œæˆ‘ä»¬å«é¡µï¼ˆPageï¼‰ã€‚åœ¨ Linux ä¸‹ï¼Œæ¯ä¸€é¡µçš„å¤§å°ä¸º 4KBã€‚\nè™šæ‹Ÿåœ°å€ä¸ç‰©ç†åœ°å€ä¹‹é—´é€šè¿‡é¡µè¡¨æ¥æ˜ å°„ï¼š\nç”±äºå†…å­˜ç©ºé—´éƒ½æ˜¯é¢„å…ˆåˆ’åˆ†å¥½çš„ï¼Œä¹Ÿå°±ä¸ä¼šåƒåˆ†æ®µä¼šäº§ç”Ÿé—´éš™éå¸¸å°çš„å†…å­˜ï¼Œè¿™æ­£æ˜¯åˆ†æ®µä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡çš„åŸå› ã€‚è€Œé‡‡ç”¨äº†åˆ†é¡µï¼Œé‚£ä¹ˆé‡Šæ”¾çš„å†…å­˜éƒ½æ˜¯ä»¥é¡µä¸ºå•ä½é‡Šæ”¾çš„ï¼Œä¹Ÿå°±ä¸ä¼šäº§ç”Ÿæ— æ³•ç»™è¿›ç¨‹ä½¿ç”¨çš„å°å†…å­˜ã€‚\nå¦‚æœå†…å­˜ç©ºé—´ä¸å¤Ÿï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠå…¶ä»–æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ä¸­çš„ã€Œæœ€è¿‘æ²¡è¢«ä½¿ç”¨ã€çš„å†…å­˜é¡µé¢ç»™é‡Šæ”¾æ‰ï¼Œä¹Ÿå°±æ˜¯æš‚æ—¶å†™åœ¨ç¡¬ç›˜ä¸Šï¼Œç§°ä¸ºæ¢å‡ºï¼ˆSwap Outï¼‰ã€‚ä¸€æ—¦éœ€è¦çš„æ—¶å€™ï¼Œå†åŠ è½½è¿›æ¥ï¼Œç§°ä¸ºæ¢å…¥ï¼ˆSwap Inï¼‰ã€‚æ‰€ä»¥ï¼Œä¸€æ¬¡æ€§å†™å…¥ç£ç›˜çš„ä¹Ÿåªæœ‰å°‘æ•°çš„ä¸€ä¸ªé¡µæˆ–è€…å‡ ä¸ªé¡µï¼Œä¸ä¼šèŠ±å¤ªå¤šæ—¶é—´ï¼Œå†…å­˜äº¤æ¢çš„æ•ˆç‡å°±ç›¸å¯¹æ¯”è¾ƒé«˜ã€‚\nåœ¨åˆ†é¡µæœºåˆ¶ä¸‹ï¼Œè™šæ‹Ÿåœ°å€åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œé¡µå·å’Œé¡µå†…åç§»ã€‚é¡µå·ä½œä¸ºé¡µè¡¨çš„ç´¢å¼•ï¼Œé¡µè¡¨åŒ…å«ç‰©ç†é¡µæ¯é¡µæ‰€åœ¨ç‰©ç†å†…å­˜çš„åŸºåœ°å€ï¼Œè¿™ä¸ªåŸºåœ°å€ä¸é¡µå†…åç§»çš„ç»„åˆå°±å½¢æˆäº†ç‰©ç†å†…å­˜åœ°å€ï¼Œè§ä¸‹å›¾ã€‚\næ®µé¡µå¼ç®¡ç† å†…å­˜åˆ†æ®µå’Œå†…å­˜åˆ†é¡µå¹¶ä¸æ˜¯å¯¹ç«‹çš„ï¼Œå®ƒä»¬æ˜¯å¯ä»¥ç»„åˆèµ·æ¥åœ¨åŒä¸€ä¸ªç³»ç»Ÿä¸­ä½¿ç”¨çš„ï¼Œé‚£ä¹ˆç»„åˆèµ·æ¥åï¼Œé€šå¸¸ç§°ä¸ºæ®µé¡µå¼å†…å­˜ç®¡ç†ã€‚\næ®µé¡µå¼å†…å­˜ç®¡ç†å®ç°çš„æ–¹å¼ï¼š\n å…ˆå°†ç¨‹åºåˆ’åˆ†ä¸ºå¤šä¸ªæœ‰é€»è¾‘æ„ä¹‰çš„æ®µï¼Œä¹Ÿå°±æ˜¯å‰é¢æåˆ°çš„åˆ†æ®µæœºåˆ¶ï¼› æ¥ç€å†æŠŠæ¯ä¸ªæ®µåˆ’åˆ†ä¸ºå¤šä¸ªé¡µï¼Œä¹Ÿå°±æ˜¯å¯¹åˆ†æ®µåˆ’åˆ†å‡ºæ¥çš„è¿ç»­ç©ºé—´ï¼Œå†åˆ’åˆ†å›ºå®šå¤§å°çš„é¡µï¼›  è¿™æ ·ï¼Œåœ°å€ç»“æ„å°±ç”±æ®µå·ã€æ®µå†…é¡µå·å’Œé¡µå†…ä½ç§»ä¸‰éƒ¨åˆ†ç»„æˆã€‚\nç”¨äºæ®µé¡µå¼åœ°å€å˜æ¢çš„æ•°æ®ç»“æ„æ˜¯æ¯ä¸€ä¸ªç¨‹åºä¸€å¼ æ®µè¡¨ï¼Œæ¯ä¸ªæ®µåˆå»ºç«‹ä¸€å¼ é¡µè¡¨ï¼Œæ®µè¡¨ä¸­çš„åœ°å€æ˜¯é¡µè¡¨çš„èµ·å§‹åœ°å€ï¼Œè€Œé¡µè¡¨ä¸­çš„åœ°å€åˆ™ä¸ºæŸé¡µçš„ç‰©ç†é¡µå·ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\næ®µé¡µå¼åœ°å€å˜æ¢ä¸­è¦å¾—åˆ°ç‰©ç†åœ°å€é¡»ç»è¿‡ä¸‰æ¬¡å†…å­˜è®¿é—®ï¼š\n ç¬¬ä¸€æ¬¡è®¿é—®æ®µè¡¨ï¼Œå¾—åˆ°é¡µè¡¨èµ·å§‹åœ°å€ï¼› ç¬¬äºŒæ¬¡è®¿é—®é¡µè¡¨ï¼Œå¾—åˆ°ç‰©ç†é¡µå·ï¼› ç¬¬ä¸‰æ¬¡å°†ç‰©ç†é¡µå·ä¸é¡µå†…ä½ç§»ç»„åˆï¼Œå¾—åˆ°ç‰©ç†åœ°å€ã€‚  å¯ç”¨è½¯ã€ç¡¬ä»¶ç›¸ç»“åˆçš„æ–¹æ³•å®ç°æ®µé¡µå¼åœ°å€å˜æ¢ï¼Œè¿™æ ·è™½ç„¶å¢åŠ äº†ç¡¬ä»¶æˆæœ¬å’Œç³»ç»Ÿå¼€é”€ï¼Œä½†æé«˜äº†å†…å­˜çš„åˆ©ç”¨ç‡ã€‚\nå‚è€ƒï¼š\n 20 å¼ å›¾æ­å¼€ã€Œå†…å­˜ç®¡ç†ã€çš„è¿·é›¾  è¿›ç¨‹è°ƒåº¦ç®—æ³•ğŸ”Œ FCFS(å…ˆæ¥å…ˆæœåŠ¡)ï¼Œä¼˜å…ˆçº§ï¼Œæ—¶é—´ç‰‡è½®è½¬ï¼Œå¤šçº§åé¦ˆ\n  FCFS(å…ˆæ¥å…ˆæœåŠ¡ï¼Œé˜Ÿåˆ—å®ç°ï¼ŒéæŠ¢å çš„)\nå…ˆè¯·æ±‚CPUçš„è¿›ç¨‹å…ˆåˆ†é…åˆ°CPU\n  SJF(æœ€çŸ­ä½œä¸šä¼˜å…ˆè°ƒåº¦ç®—æ³•)\nå¹³å‡ç­‰å¾…æ—¶é—´æœ€çŸ­ï¼Œä½†éš¾ä»¥çŸ¥é“ä¸‹ä¸€ä¸ªCPUåŒºé—´é•¿åº¦\n  **ä¼˜å…ˆçº§è°ƒåº¦ç®—æ³•(**å¯ä»¥æ˜¯æŠ¢å çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯éæŠ¢å çš„)ï¼š\nä¼˜å…ˆçº§è¶Šé«˜è¶Šå…ˆåˆ†é…åˆ°CPUï¼Œç›¸åŒä¼˜å…ˆçº§å…ˆåˆ°å…ˆæœåŠ¡ï¼Œå­˜åœ¨çš„ä¸»è¦é—®é¢˜æ˜¯ï¼šä½ä¼˜å…ˆçº§è¿›ç¨‹æ— ç©·ç­‰å¾…CPUï¼Œä¼šå¯¼è‡´æ— ç©·é˜»å¡æˆ–é¥¥é¥¿ï¼›è§£å†³æ–¹æ¡ˆï¼šè€åŒ–\n  é«˜å“åº”æ¯”ä¼˜å…ˆè°ƒåº¦ç®—æ³•\næ ¹æ®â€œå“åº”æ¯”=ï¼ˆè¿›ç¨‹æ‰§è¡Œæ—¶é—´+è¿›ç¨‹ç­‰å¾…æ—¶é—´ï¼‰/ è¿›ç¨‹æ‰§è¡Œæ—¶é—´â€è¿™ä¸ªå…¬å¼å¾—åˆ°çš„å“åº”æ¯”æ¥è¿›è¡Œè°ƒåº¦ã€‚é«˜å“åº”æ¯”ä¼˜å…ˆç®—æ³•åœ¨ç­‰å¾…æ—¶é—´ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œä½œä¸šæ‰§è¡Œçš„æ—¶é—´è¶ŠçŸ­ï¼Œå“åº”æ¯”è¶Šé«˜ï¼Œæ»¡è¶³æ®µä»»åŠ¡ä¼˜å…ˆï¼ŒåŒæ—¶å“åº”æ¯”ä¼šéšç€ç­‰å¾…æ—¶é—´å¢åŠ è€Œå˜å¤§ï¼Œä¼˜å…ˆçº§ä¼šæé«˜ï¼Œèƒ½å¤Ÿé¿å…é¥¥é¥¿ç°è±¡ã€‚ä¼˜ç‚¹æ˜¯å…¼é¡¾é•¿çŸ­ä½œä¸šï¼Œç¼ºç‚¹æ˜¯è®¡ç®—å“åº”æ¯”å¼€é”€å¤§ï¼Œé€‚ç”¨äºæ‰¹å¤„ç†ç³»ç»Ÿã€‚\n  æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•(å¯æŠ¢å çš„)\né˜Ÿåˆ—ä¸­**æ²¡æœ‰è¿›ç¨‹è¢«åˆ†é…è¶…è¿‡ä¸€ä¸ªæ—¶é—´ç‰‡çš„CPUæ—¶é—´ï¼Œé™¤éå®ƒæ˜¯å”¯ä¸€å¯è¿è¡Œçš„è¿›ç¨‹ã€‚**å¦‚æœè¿›ç¨‹çš„CPUåŒºé—´è¶…è¿‡äº†ä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œé‚£ä¹ˆè¯¥è¿›ç¨‹å°±è¢«æŠ¢å å¹¶æ”¾å›å°±ç»ªé˜Ÿåˆ—ã€‚\n  å¤šçº§é˜Ÿåˆ—è°ƒåº¦ç®—æ³•\nå°†å°±ç»ªé˜Ÿåˆ—åˆ†æˆå¤šä¸ªç‹¬ç«‹çš„é˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½æœ‰è‡ªå·±çš„è°ƒåº¦ç®—æ³•ï¼Œé˜Ÿåˆ—ä¹‹é—´é‡‡ç”¨å›ºå®šä¼˜å…ˆçº§æŠ¢å è°ƒåº¦ã€‚å…¶ä¸­ï¼Œä¸€ä¸ªè¿›ç¨‹æ ¹æ®è‡ªèº«å±æ€§è¢«æ°¸ä¹…åœ°åˆ†é…åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ã€‚\n  å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•\nä¸å¤šçº§é˜Ÿåˆ—è°ƒåº¦ç®—æ³•ç›¸æ¯”ï¼Œå…¶å…è®¸è¿›ç¨‹åœ¨é˜Ÿåˆ—ä¹‹é—´ç§»åŠ¨ï¼šè‹¥è¿›ç¨‹ä½¿ç”¨è¿‡å¤šCPUæ—¶é—´ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«è½¬ç§»åˆ°æ›´ä½çš„ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼›åœ¨è¾ƒä½ä¼˜å…ˆçº§é˜Ÿåˆ—ç­‰å¾…æ—¶é—´è¿‡é•¿çš„è¿›ç¨‹ä¼šè¢«è½¬ç§»åˆ°æ›´é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œä»¥é˜²æ­¢é¥¥é¥¿å‘ç”Ÿã€‚\n  å‚è€ƒï¼š\n äº”ç§è¿›ç¨‹è°ƒåº¦ç®—æ³•çš„æ€»ç»“ å¤§å‚é¢è¯•çˆ±é—®çš„ã€Œè°ƒåº¦ç®—æ³•ã€ï¼Œ20 å¼ å›¾ä¸€ä¸¾æ‹¿ä¸‹  é¡µé¢ç½®æ¢ç®—æ³•ğŸ’± ä»€ä¹ˆæ˜¯é¡µé¢ç½®æ¢ç®—æ³•ï¼Ÿ è¿›ç¨‹è¿è¡Œæ—¶ï¼Œè‹¥å…¶è®¿é—®çš„é¡µé¢ä¸åœ¨å†…å­˜è€Œéœ€å°†å…¶è°ƒå…¥ï¼Œä½†å†…å­˜å·²æ— ç©ºé—²ç©ºé—´æ—¶ï¼Œå°±éœ€è¦ä»å†…å­˜ä¸­è°ƒå‡ºä¸€é¡µç¨‹åºæˆ–æ•°æ®ï¼Œé€å…¥ç£ç›˜çš„å¯¹æ¢åŒºï¼Œå…¶ä¸­é€‰æ‹©è°ƒå‡ºé¡µé¢çš„ç®—æ³•å°±ç§°ä¸ºé¡µé¢ç½®æ¢ç®—æ³•ã€‚\nå¸¸è§çš„é¡µé¢ç½®æ¢ç®—æ³•   FIFOå…ˆè¿›å…ˆå‡ºç®—æ³•\nï¼ˆä¼˜å…ˆæ·˜æ±°æœ€æ—©è¿›å…¥å†…å­˜çš„é¡µé¢ï¼‰\nåœ¨æ“ä½œç³»ç»Ÿä¸­ç»å¸¸è¢«ç”¨åˆ°ï¼Œæ¯”å¦‚ä½œä¸šè°ƒåº¦ï¼ˆä¸»è¦å®ç°ç®€å•ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ï¼‰ï¼›\n  OPTï¼ˆOptimal replacementï¼‰æœ€ä¼˜ç½®æ¢ç®—æ³•\nï¼ˆæ·˜æ±°ä»¥åä¸ä¼šä½¿ç”¨çš„é¡µé¢ï¼‰\nç†è®ºçš„æœ€ä¼˜ï¼Œç†è®ºï¼›å°±æ˜¯è¦ä¿è¯ç½®æ¢å‡ºå»çš„æ˜¯ä¸å†è¢«ä½¿ç”¨çš„é¡µï¼Œæˆ–è€…æ˜¯åœ¨å®é™…å†…å­˜ä¸­æœ€æ™šä½¿ç”¨çš„ç®—æ³•ã€‚\n FIFO å’Œ OPT ç®—æ³•çš„åŒºåˆ«åœ¨äºï¼šé™¤äº†åœ¨æ—¶é—´ä¸Šå‘åæˆ–å‘å‰çœ‹ä¹‹å¤–ï¼ŒFIFO ç®—æ³•ä½¿ç”¨çš„æ˜¯é¡µé¢è°ƒå…¥å†…å­˜çš„æ—¶é—´ï¼ŒOPT ç®—æ³•ä½¿ç”¨çš„æ˜¯é¡µé¢å°†æ¥ä½¿ç”¨çš„æ—¶é—´\n   LRUï¼ˆLeast recently useï¼‰æœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•\nï¼ˆæ·˜æ±°æœ€è¿‘æ²¡æœ‰ä½¿ç”¨çš„é¡µé¢ï¼‰\né€‰æ‹©æœ€è¿‘æœ€é•¿æ—¶é—´æœªè®¿é—®è¿‡çš„é¡µé¢äºˆä»¥æ·˜æ±°ï¼Œå®ƒè®¤ä¸ºè¿‡å»ä¸€æ®µæ—¶é—´å†…æœªè®¿é—®è¿‡çš„é¡µé¢ï¼Œåœ¨æœ€è¿‘çš„å°†æ¥å¯èƒ½ä¹Ÿä¸ä¼šè¢«è®¿é—®ã€‚è¯¥ç®—æ³•ä¸ºæ¯ä¸ªé¡µé¢è®¾ç½®ä¸€ä¸ªè®¿é—®å­—æ®µï¼Œæ¥è®°å½•é¡µé¢è‡ªä¸Šæ¬¡è¢«è®¿é—®ä»¥æ¥æ‰€ç»å†çš„æ—¶é—´ï¼Œæ·˜æ±°é¡µé¢æ—¶é€‰æ‹©ç°æœ‰é¡µé¢ä¸­å€¼æœ€å¤§çš„äºˆä»¥æ·˜æ±°ã€‚\n OPT å’Œ LRU ç®—æ³•çš„åŒºåˆ«åœ¨äºï¼šLRU ç®—æ³•æ ¹æ®å„é¡µä»¥å‰çš„æƒ…å†µï¼Œæ˜¯â€œå‘å‰çœ‹â€çš„ï¼Œè€Œæœ€ä½³ç½®æ¢ç®—æ³•åˆ™æ ¹æ®å„é¡µä»¥åçš„ä½¿ç”¨æƒ…å†µï¼Œæ˜¯â€œå‘åçœ‹â€çš„\nLRU æ€§èƒ½è¾ƒå¥½ï¼Œä½†éœ€è¦å¯„å­˜å™¨å’Œæ ˆçš„ç¡¬ä»¶æ”¯æŒ\n LRU æ˜¯å †æ ˆç±»çš„ç®—æ³•ï¼Œç†è®ºä¸Šå¯ä»¥è¯æ˜ï¼Œå †æ ˆç±»ç®—æ³•ä¸å¯èƒ½å‡ºç° Belady å¼‚å¸¸\n  LFUï¼ˆLeast frequently use**ï¼‰æœ€å°‘ä½¿ç”¨æ¬¡æ•°ç®—æ³•**\nï¼ˆæ ¹æ®ä½¿ç”¨æ¬¡æ•°æ¥åˆ¤æ–­ï¼‰\næœ€ä¸ç»å¸¸ä½¿ç”¨ï¼ˆLFUï¼‰é¡µé¢ç½®æ¢ç®—æ³•è¦æ±‚ç½®æ¢å…·æœ‰æœ€å°è®¡æ•°çš„é¡µé¢ã€‚\nè¿™ç§é€‰æ‹©çš„åŸå› æ˜¯ï¼Œç§¯æä½¿ç”¨çš„é¡µé¢åº”å½“å…·æœ‰å¤§çš„å¼•ç”¨è®¡æ•°ã€‚ç„¶è€Œï¼Œå½“ä¸€ä¸ªé¡µé¢åœ¨è¿›ç¨‹çš„åˆå§‹é˜¶æ®µå¤§é‡ä½¿ç”¨ä½†æ˜¯éšåä¸å†ä½¿ç”¨æ—¶ï¼Œä¼šå‡ºç°é—®é¢˜ã€‚ç”±äºè¢«å¤§é‡ä½¿ç”¨ï¼Œå®ƒæœ‰ä¸€ä¸ªå¤§çš„è®¡æ•°ï¼Œå³ä½¿ä¸å†éœ€è¦å´ä»ä¿ç•™åœ¨å†…å­˜ä¸­ã€‚ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå®šæœŸåœ°å°†è®¡æ•°å³ç§» 1 ä½ï¼Œä»¥å½¢æˆæŒ‡æ•°è¡°å‡çš„å¹³å‡ä½¿ç”¨è®¡æ•°ã€‚\n  Clockï¼ˆæ—¶é’Ÿç½®æ¢ç®—æ³•ï¼‰\nç®€å•çš„ CLOCK ç®—æ³•æ˜¯ç»™æ¯ä¸€å¸§å…³è”ä¸€ä¸ªé™„åŠ ä½ï¼Œç§°ä¸ºä½¿ç”¨ä½ã€‚\nå½“æŸä¸€é¡µé¦–æ¬¡è£…å…¥ä¸»å­˜æ—¶ï¼Œè¯¥å¸§çš„ä½¿ç”¨ä½è®¾ç½®ä¸º1;\nå½“è¯¥é¡µéšåå†è¢«è®¿é—®åˆ°æ—¶ï¼Œå®ƒçš„ä½¿ç”¨ä½ä¹Ÿè¢«ç½®ä¸º1ã€‚\nå¯¹äºé¡µæ›¿æ¢ç®—æ³•ï¼Œç”¨äºæ›¿æ¢çš„å€™é€‰å¸§é›†åˆçœ‹åšä¸€ä¸ªå¾ªç¯ç¼“å†²åŒºï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªæŒ‡é’ˆä¸ä¹‹ç›¸å…³è”ã€‚\nå½“æŸä¸€é¡µè¢«æ›¿æ¢æ—¶ï¼Œè¯¥æŒ‡é’ˆè¢«è®¾ç½®æˆæŒ‡å‘ç¼“å†²åŒºä¸­çš„ä¸‹ä¸€å¸§ã€‚\nå½“éœ€è¦æ›¿æ¢ä¸€é¡µæ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰«æç¼“å†²åŒºï¼Œä»¥æŸ¥æ‰¾ä½¿ç”¨ä½è¢«ç½®ä¸º0çš„ä¸€å¸§ã€‚\næ¯å½“é‡åˆ°ä¸€ä¸ªä½¿ç”¨ä½ä¸º1çš„å¸§æ—¶ï¼Œæ“ä½œç³»ç»Ÿå°±å°†è¯¥ä½é‡æ–°ç½®ä¸º0ï¼›\nå¦‚æœåœ¨è¿™ä¸ªè¿‡ç¨‹å¼€å§‹æ—¶ï¼Œç¼“å†²åŒºä¸­æ‰€æœ‰å¸§çš„ä½¿ç”¨ä½å‡ä¸º0ï¼Œåˆ™é€‰æ‹©é‡åˆ°çš„ç¬¬ä¸€ä¸ªå¸§æ›¿æ¢ï¼›\nå¦‚æœæ‰€æœ‰å¸§çš„ä½¿ç”¨ä½å‡ä¸º1,åˆ™æŒ‡é’ˆåœ¨ç¼“å†²åŒºä¸­å®Œæ•´åœ°å¾ªç¯ä¸€å‘¨ï¼ŒæŠŠæ‰€æœ‰ä½¿ç”¨ä½éƒ½ç½®ä¸º0ï¼Œå¹¶ä¸”åœç•™åœ¨æœ€åˆçš„ä½ç½®ä¸Šï¼Œæ›¿æ¢è¯¥å¸§ä¸­çš„é¡µã€‚\nç”±äºè¯¥ç®—æ³•å¾ªç¯åœ°æ£€æŸ¥å„é¡µé¢çš„æƒ…å†µï¼Œæ•…ç§°ä¸º CLOCK ç®—æ³•ï¼Œåˆç§°ä¸ºæœ€è¿‘æœªç”¨( Not Recently Used, NRU )ç®—æ³•ã€‚\n  å‚è€ƒï¼š\n é¡µé¢ç½®æ¢ç®—æ³•è¯¦è§£ å¤§å‚é¢è¯•çˆ±é—®çš„ã€Œè°ƒåº¦ç®—æ³•ã€ï¼Œ20 å¼ å›¾ä¸€ä¸¾æ‹¿ä¸‹  ç£ç›˜è°ƒåº¦ç®—æ³•ğŸ’¾ ç£ç›˜çš„ç»“æ„ï¼š\nç£ç›˜è°ƒåº¦ç®—æ³•çš„ç›®çš„å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸ºäº†æé«˜ç£ç›˜çš„è®¿é—®æ€§èƒ½ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ä¼˜åŒ–ç£ç›˜çš„è®¿é—®è¯·æ±‚é¡ºåºæ¥åšåˆ°çš„ã€‚\nå¯»é“çš„æ—¶é—´æ˜¯ç£ç›˜è®¿é—®æœ€è€—æ—¶çš„éƒ¨åˆ†ï¼Œå¦‚æœè¯·æ±‚é¡ºåºä¼˜åŒ–çš„å¾—å½“ï¼Œå¿…ç„¶å¯ä»¥èŠ‚çœä¸€äº›ä¸å¿…è¦çš„å¯»é“æ—¶é—´ï¼Œä»è€Œæé«˜ç£ç›˜çš„è®¿é—®æ€§èƒ½ã€‚\nå¸¸è§çš„ç£ç›˜è°ƒåº¦ç®—æ³•ï¼š\n  å…ˆæ¥å…ˆæœåŠ¡ç®—æ³•\n  æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆç®—æ³•\n  æ‰«æç®—æ³•ç®—æ³•\n  å¾ªç¯æ‰«æç®—æ³•\nåªæœ‰ç£å¤´æœæŸä¸ªç‰¹å®šæ–¹å‘ç§»åŠ¨æ—¶ï¼Œæ‰å¤„ç†ç£é“è®¿é—®è¯·æ±‚ï¼Œè€Œè¿”å›æ—¶ç›´æ¥å¿«é€Ÿç§»åŠ¨è‡³æœ€é è¾¹ç¼˜çš„ç£é“ï¼Œä¹Ÿå°±æ˜¯å¤ä½ç£å¤´ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¾ˆå¿«çš„ï¼Œå¹¶ä¸”è¿”å›ä¸­é€”ä¸å¤„ç†ä»»ä½•è¯·æ±‚ï¼Œè¯¥ç®—æ³•çš„ç‰¹ç‚¹ï¼Œå°±æ˜¯ç£é“åªå“åº”ä¸€ä¸ªæ–¹å‘ä¸Šçš„è¯·æ±‚ã€‚\n  LOOK ä¸ C-LOOK ç®—æ³•\næˆ‘ä»¬å‰é¢è¯´åˆ°çš„æ‰«æç®—æ³•å’Œå¾ªç¯æ‰«æç®—æ³•ï¼Œéƒ½æ˜¯ç£å¤´ç§»åŠ¨åˆ°ç£ç›˜ã€Œæœ€å§‹ç«¯æˆ–æœ€æœ«ç«¯ã€æ‰å¼€å§‹è°ƒæ¢æ–¹å‘ã€‚\né‚£è¿™å…¶å®æ˜¯å¯ä»¥ä¼˜åŒ–çš„ï¼Œä¼˜åŒ–çš„æ€è·¯å°±æ˜¯ç£å¤´åœ¨ç§»åŠ¨åˆ°ã€Œæœ€è¿œçš„è¯·æ±‚ã€ä½ç½®ï¼Œç„¶åç«‹å³åå‘ç§»åŠ¨ã€‚\né‚£é’ˆå¯¹ SCAN ç®—æ³•çš„ä¼˜åŒ–åˆ™å« LOOK ç®—æ³•ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼ï¼Œç£å¤´åœ¨æ¯ä¸ªæ–¹å‘ä¸Šä»…ä»…ç§»åŠ¨åˆ°æœ€è¿œçš„è¯·æ±‚ä½ç½®ï¼Œç„¶åç«‹å³åå‘ç§»åŠ¨ï¼Œè€Œä¸éœ€è¦ç§»åŠ¨åˆ°ç£ç›˜çš„æœ€å§‹ç«¯æˆ–æœ€æœ«ç«¯ï¼Œåå‘ç§»åŠ¨çš„é€”ä¸­ä¼šå“åº”è¯·æ±‚\nè€Œé’ˆ C-SCAN ç®—æ³•çš„ä¼˜åŒ–åˆ™å« C-LOOKï¼Œå®ƒçš„å·¥ä½œæ–¹å¼ï¼Œç£å¤´åœ¨æ¯ä¸ªæ–¹å‘ä¸Šä»…ä»…ç§»åŠ¨åˆ°æœ€è¿œçš„è¯·æ±‚ä½ç½®ï¼Œç„¶åç«‹å³åå‘ç§»åŠ¨ï¼Œè€Œä¸éœ€è¦ç§»åŠ¨åˆ°ç£ç›˜çš„æœ€å§‹ç«¯æˆ–æœ€æœ«ç«¯ï¼Œåå‘ç§»åŠ¨çš„é€”ä¸­ä¸ä¼šå“åº”è¯·æ±‚ã€‚\n  å‚è€ƒï¼š\n å¤§å‚é¢è¯•çˆ±é—®çš„ã€Œè°ƒåº¦ç®—æ³•ã€ï¼Œ20 å¼ å›¾ä¸€ä¸¾æ‹¿ä¸‹  å†…å­˜åˆ†é…ç®—æ³• é¦–æ¬¡é€‚åº”ç®—æ³•ï¼ˆFirst Fitï¼‰ ä»ç©ºé—²åˆ†åŒºè¡¨çš„ç¬¬ä¸€ä¸ªè¡¨ç›®èµ·æŸ¥æ‰¾è¯¥è¡¨ï¼ŒæŠŠæœ€å…ˆèƒ½å¤Ÿæ»¡è¶³è¦æ±‚çš„ç©ºé—²åŒºåˆ†é…ç»™ä½œä¸šï¼Œè¿™ç§æ–¹æ³•çš„ç›®çš„åœ¨äºå‡å°‘æŸ¥æ‰¾æ—¶é—´ã€‚ä¸ºé€‚åº”è¿™ç§ç®—æ³•ï¼Œç©ºé—²åˆ†åŒºè¡¨ï¼ˆç©ºé—²åŒºé“¾ï¼‰ä¸­çš„ç©ºé—²åˆ†åŒºè¦æŒ‰åœ°å€ç”±ä½åˆ°é«˜è¿›è¡Œæ’åºã€‚è¯¥ç®—æ³•ä¼˜å…ˆä½¿ç”¨ä½å€éƒ¨åˆ†ç©ºé—²åŒºï¼Œåœ¨ä½å€ç©ºé—´é€ æˆè®¸å¤šå°çš„ç©ºé—²åŒºï¼Œåœ¨é«˜åœ°å€ç©ºé—´ä¿ç•™å¤§çš„ç©ºé—²åŒºã€‚\næœ€ä½³é€‚åº”ç®—æ³•ï¼ˆBest Fit) ä»å…¨éƒ¨ç©ºé—²åŒºä¸­æ‰¾å‡ºèƒ½æ»¡è¶³ä½œä¸šè¦æ±‚çš„ã€ä¸”å¤§å°æœ€å°çš„ç©ºé—²åˆ†åŒºï¼Œè¿™ç§æ–¹æ³•èƒ½ä½¿ç¢ç‰‡å°½é‡å°ã€‚ä¸ºé€‚åº”æ­¤ç®—æ³•ï¼Œç©ºé—²åˆ†åŒºè¡¨ï¼ˆç©ºé—²åŒºé“¾ï¼‰ä¸­çš„ç©ºé—²åˆ†åŒºè¦æŒ‰ä»å°åˆ°å¤§è¿›è¡Œæ’åºï¼Œè‡ªè¡¨å¤´å¼€å§‹æŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„è‡ªç”±åˆ†åŒºåˆ†é…ã€‚è¯¥ç®—æ³•ä¿ç•™å¤§çš„ç©ºé—²åŒºï¼Œä½†é€ æˆè®¸å¤šå°çš„ç©ºé—²åŒºã€‚\næœ€å·®é€‚åº”ç®—æ³•ï¼ˆWorst Fit) ä»å…¨éƒ¨ç©ºé—²åŒºä¸­æ‰¾å‡ºèƒ½æ»¡è¶³ä½œä¸šè¦æ±‚çš„ã€ä¸”å¤§å°æœ€å¤§çš„ç©ºé—²åˆ†åŒºï¼Œä»è€Œä½¿é“¾è¡¨ä¸­çš„ç»“ç‚¹å¤§å°è¶‹äºå‡åŒ€ï¼Œé€‚ç”¨äºè¯·æ±‚åˆ†é…çš„å†…å­˜å¤§å°èŒƒå›´è¾ƒçª„çš„ç³»ç»Ÿã€‚ä¸ºé€‚åº”æ­¤ç®—æ³•ï¼Œç©ºé—²åˆ†åŒºè¡¨ï¼ˆç©ºé—²åŒºé“¾ï¼‰ä¸­çš„ç©ºé—²åˆ†åŒºæŒ‰å¤§å°ä»å¤§åˆ°å°è¿›è¡Œæ’åºï¼Œè‡ªè¡¨å¤´å¼€å§‹æŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„è‡ªç”±åˆ†åŒºåˆ†é…ã€‚è¯¥ç®—æ³•ä¿ç•™å°çš„ç©ºé—²åŒºï¼Œå°½é‡å‡å°‘å°çš„ç¢ç‰‡äº§ç”Ÿã€‚\nä¼™ä¼´ç®—æ³•ï¼ˆbuddyï¼‰ ä½¿ç”¨äºŒè¿›åˆ¶ä¼˜åŒ–çš„æ€æƒ³ï¼Œå°†å†…å­˜ä»¥2çš„å¹‚ä¸ºå•ä½è¿›è¡Œåˆ†é…ï¼Œåˆå¹¶æ—¶åªèƒ½åˆå¹¶æ˜¯ä¼™ä¼´çš„å†…å­˜å—ï¼Œä¸¤ä¸ªå†…å­˜å—æ˜¯ä¼™ä¼´çš„ä¸‰ä¸ªæ¡ä»¶æ˜¯ï¼š\n1.å¤§å°ç›¸ç­‰ï¼ˆå¾ˆå¥½åˆ¤æ–­ï¼‰\n2.åœ°å€è¿ç»­ï¼ˆä¹Ÿå¾ˆå¥½åˆ¤æ–­ï¼‰\n3.ä¸¤ä¸ªå†…å­˜å—åˆ†è£‚è‡ªåŒä¸€ä¸ªçˆ¶å—ï¼ˆå…¶å®åªè¦åˆ¤æ–­ä½åœ°å€çš„å†…å­˜å—é¦–åœ°å€æ˜¯å¦æ˜¯ä¸çˆ¶å—åœ°å€å¯¹é½ï¼Œå³åˆå¹¶åçš„é¦–åœ°å€ä¸ºçˆ¶å—å¤§å°çš„æ•´æ•°å€ï¼‰ä½¿ç”¨lowbitç­‰ä½è¿ç®—å¯ä»¥o(1)åˆ¤æ–­ã€‚\nä¼™ä¼´ç®—æ³•åœ¨å®ç°çš„æ—¶å€™å¯ä»¥ä½¿ç”¨æ•°ç»„+é“¾è¡¨çš„å½¢å¼ï¼ˆæœ‰ç‚¹åƒé‚»æ¥è¡¨é‚£ç§ï¼‰ï¼Œå› ä¸ºå†…å­˜ä¸Šé™æ˜¯å›ºå®šçš„ï¼Œæ¯”è¾ƒå®¹æ˜“ç¡®å®šã€‚ä¸‹åˆ—ä»£ç ä½¿ç”¨çš„æ˜¯äºŒç»´é“¾è¡¨ï¼ˆå†™èµ·æ¥å°±æ²¡æœ‰æ•°ç»„åŠ é“¾è¡¨ç®€æ´ï¼‰ã€‚åœ¨åˆ†é…è°ƒæ•´å†…å­˜å—æ—¶ä½¿ç”¨äº†é€’å½’ï¼Œå¦‚æœéœ€è¦æé«˜æ•ˆç‡å¯ä»¥æ”¹ä¸ºå¾ªç¯ï¼ˆé€’å½’æ›´èƒ½ä½“ç°å‡ºæ€æƒ³ä¸”ä»£ç ç®€å•ï¼Œå¾ªç¯æ•ˆç‡æ›´é«˜ä½†æ˜¯å¤æ‚ä¸€ä¸¢ä¸¢ï¼Œè‡ªè¡Œé€‰å–ï¼‰ã€‚\nSlabåˆ†é…ç®—æ³• CMAç®—æ³• åº”ç”¨ç¨‹åºä¸­ç”³è¯·ä¸€å—å†…å­˜ï¼Œåœ¨åº”ç”¨ç¨‹åºçœ‹æ¥æ˜¯è¿ç»­çš„ï¼Œå› ä¸ºè™šæ‹Ÿåœ°å€æœ¬èº«æ˜¯è¿ç»­çš„ï¼Œä½†å®é™…çš„å†…å­˜ç©ºé—´ä¸­ï¼Œæ‰€ç”³è¯·çš„è¿™ç‰‡å†…å­˜æœªå¿…æ˜¯è¿ç»­çš„ï¼Œä¸è¿‡è¿™å¯¹åº”ç”¨ç¨‹åºæ¥è¯´æ˜¯æ²¡å…³ç³»çš„ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºä¸éœ€è¦å…³å¿ƒå®é™…çš„å†…å­˜æƒ…å†µï¼Œåªè¦MMUæŠŠç‰©ç†åœ°å€æ˜ å°„æˆè™šæ‹Ÿåœ°å€å°±å¥½äº†ã€‚ä½†æ˜¯å¦‚æœæ²¡æœ‰MMUçš„æƒ…å†µå‘¢ï¼Œæˆ‘ä»¬åˆéœ€è¦ä¸€ç‰‡è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œæ¯”å¦‚è®¾å¤‡é€šè¿‡DMAç›´æ¥è®¿é—®å†…å­˜ï¼Œè¿™ç§æƒ…å†µä¸‹åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\nCMAæœºåˆ¶å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šé¢æåˆ°çš„é—®é¢˜è€Œäº§ç”Ÿçš„ã€‚DMA zoneå¹¶ä¸æ˜¯DMAä¸“å±ï¼Œå…¶å®ƒçš„ç¨‹åºä¹Ÿå¯ä»¥ç”³è¯·è¯¥zoneçš„å†…å­˜ï¼Œå¦‚æœå½“è®¾å¤‡è¦ç”³è¯·DMA zoneç©ºé—´çš„ä¸€å¤§ç‰‡è¿ç»­çš„å†…å­˜æ—¶å€™ï¼Œå·²ç»æ²¡æœ‰è¿ç»­çš„å¤§ç‰‡å†…å­˜äº†ï¼Œåªæœ‰1é¡µï¼Œ2é¡µï¼Œ4é¡µçš„è¿™ç§è¿ç»­çš„å°å†…å­˜ã€‚è§£å†³åŠæ³•å°±æ˜¯æˆ‘ä»¬æ ‡è®°æŸä¸€ç‰‡è¿ç»­åŒºåŸŸä¸ºCMAåŒºåŸŸï¼Œè¿™éƒ¨åˆ†åŒºåŸŸåœ¨æ²¡æœ‰å¤§ç‰‡è¿ç»­å†…å­˜ç”³è¯·çš„æ—¶å€™åªç»™moveableçš„ç¨‹åºä½¿ç”¨ï¼Œå½“å¤§ç‰‡è¿ç»­å†…å­˜è¯·æ±‚æ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬å»è¿™ç‰‡åŒºåŸŸï¼ŒæŠŠæ‰€æœ‰moveableçš„å°ç‰‡å†…å­˜ç§»åŠ¨åˆ°å…¶å®ƒçš„éCMAåŒºåŸŸï¼Œæ›´æ”¹å¯¹åº”çš„ç¨‹åºçš„é¡µè¡¨ï¼Œç„¶åå†æŠŠç©ºå‡ºæ¥çš„CMAåŒºåŸŸç»™è®¾å¤‡ï¼Œä»è€Œå®ç°äº†DMAå¤§ç‰‡è¿ç»­å†…å­˜çš„åˆ†é…ã€‚\nCMAæœºåˆ¶å¹¶ä¸æ˜¯å•ç‹¬å­˜åœ¨çš„ï¼Œå®ƒé€šå¸¸æœåŠ¡äºDMAè®¾å¤‡ï¼Œåœ¨è®¾å¤‡è°ƒç”¨dma_alloc_coherentå‡½æ•°ç”³è¯·ä¸€å—å†…å­˜åï¼Œä¸ºäº†å¾—åˆ°ä¸€ç‰‡è¿ç»­çš„å†…å­˜ï¼ŒCMAæœºåˆ¶è¢«è°ƒç”¨ï¼Œå®ƒä¿è¯äº†ç”³è¯·çš„å†…å­˜çš„è¿ç»­æ€§ã€‚\nå¦å¤–CMAåŒºåŸŸé€šå¸¸è¢«åˆ†é…åœ¨é«˜ç«¯å†…å­˜ã€‚\nå‚è€ƒï¼š\n å†…å­˜åˆ†é…ç®—æ³•â€”â€”FFã€BFã€WFã€buddyï¼ˆä¼™ä¼´ç®—æ³•ï¼‰ Linuxå­¦ä¹ -å†…å­˜ç®¡ç†ç¯‡ï¼ˆå››ï¼‰-å†…å­˜åˆ†é…ç®—æ³•  ä¼™ä¼´ç®—æ³•å’Œslabç®—æ³• ä¼™ä¼´ç®—æ³•(Buddyåˆ†é…ç®—æ³•) ä½œç”¨\nå®ƒè¦è§£å†³çš„é—®é¢˜æ˜¯é¢‘ç¹åœ°è¯·æ±‚å’Œé‡Šæ”¾ä¸åŒå¤§å°çš„ä¸€ç»„è¿ç»­é¡µæ¡†ï¼Œå¿…ç„¶å¯¼è‡´åœ¨å·²åˆ†é…é¡µæ¡†çš„å—å†…åˆ†æ•£äº†è®¸å¤šå°å—çš„ç©ºé—²é¡µé¢ï¼Œç”±æ­¤å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œå³ä½¿æœ‰è¶³å¤Ÿçš„ç©ºé—²é¡µæ¡†å¯ä»¥æ»¡è¶³è¯·æ±‚ï¼Œä½†è¦åˆ†é…ä¸€ä¸ªå¤§å—çš„è¿ç»­é¡µæ¡†å¯èƒ½æ— æ³•æ»¡è¶³è¯·æ±‚ã€‚(è§£å†³ç¢ç‰‡é—®é¢˜)\næµç¨‹\nä¼™ä¼´ç®—æ³•ï¼ˆBuddy systemï¼‰æŠŠæ‰€æœ‰çš„ç©ºé—²é¡µæ¡†åˆ†ä¸º11ä¸ªå—é“¾è¡¨ï¼Œæ¯å—é“¾è¡¨ä¸­åˆ†å¸ƒåŒ…å«ç‰¹å®šçš„è¿ç»­é¡µæ¡†åœ°å€ç©ºé—´ï¼Œæ¯”å¦‚ç¬¬0ä¸ªå—é“¾è¡¨åŒ…å«å¤§å°ä¸º2^0ä¸ªè¿ç»­çš„é¡µæ¡†ï¼Œç¬¬1ä¸ªå—é“¾è¡¨ä¸­ï¼Œæ¯ä¸ªé“¾è¡¨å…ƒç´ åŒ…å«2ä¸ªé¡µæ¡†å¤§å°çš„è¿ç»­åœ°å€ç©ºé—´ï¼Œâ€¦.ï¼Œç¬¬10ä¸ªå—é“¾è¡¨ä¸­ï¼Œæ¯ä¸ªé“¾è¡¨å…ƒç´ ä»£è¡¨4Mçš„è¿ç»­åœ°å€ç©ºé—´ã€‚æ¯ä¸ªé“¾è¡¨ä¸­å…ƒç´ çš„ä¸ªæ•°åœ¨ç³»ç»Ÿåˆå§‹åŒ–æ—¶å†³å®šï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒåŠ¨æ€å˜åŒ–ã€‚\nä¼™ä¼´ç®—æ³•æ¯æ¬¡åªèƒ½åˆ†é…2çš„å¹‚æ¬¡é¡µçš„ç©ºé—´ï¼Œæ¯”å¦‚ä¸€æ¬¡åˆ†é…1é¡µï¼Œ2é¡µï¼Œ4é¡µï¼Œ8é¡µï¼Œâ€¦ï¼Œ1024é¡µ(2^10)ç­‰ç­‰ï¼Œæ¯é¡µå¤§å°ä¸€èˆ¬ä¸º4Kï¼Œå› æ­¤ï¼Œä¼™ä¼´ç®—æ³•æœ€å¤šä¸€æ¬¡èƒ½å¤Ÿåˆ†é…4Mçš„å†…å­˜ç©ºé—´ã€‚\nç”³è¯·å’Œå›æ”¶è¿‡ç¨‹\næ¯”å¦‚ï¼Œæˆ‘è¦åˆ†é…4(2^2)é¡µï¼ˆ16kï¼‰çš„å†…å­˜ç©ºé—´ï¼Œç®—æ³•ä¼šå…ˆä»free_area[2]ä¸­æŸ¥çœ‹nr_freeæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœæœ‰ç©ºé—²å—ï¼Œåˆ™ä»ä¸­åˆ†é…ï¼Œå¦‚æœæ²¡æœ‰ç©ºé—²å—ï¼Œå°±ä»å®ƒçš„ä¸Šä¸€çº§free_area[3]ï¼ˆæ¯å—32Kï¼‰ä¸­åˆ†é…å‡º16Kï¼Œå¹¶å°†å¤šä½™çš„å†…å­˜ï¼ˆ16Kï¼‰åŠ å…¥åˆ°free_area[2]ä¸­å»ã€‚å¦‚æœfree_area[3]ä¹Ÿæ²¡æœ‰ç©ºé—²ï¼Œåˆ™ä»æ›´ä¸Šä¸€çº§ç”³è¯·ç©ºé—´ï¼Œä¾æ¬¡é€’æ¨ï¼Œç›´åˆ°free_area[max_order]ï¼Œå¦‚æœé¡¶çº§éƒ½æ²¡æœ‰ç©ºé—´ï¼Œé‚£ä¹ˆå°±æŠ¥å‘Šåˆ†é…å¤±è´¥ã€‚\né‡Šæ”¾æ˜¯ç”³è¯·çš„é€†è¿‡ç¨‹ï¼Œå½“é‡Šæ”¾ä¸€ä¸ªå†…å­˜å—æ—¶ï¼Œå…ˆåœ¨å…¶å¯¹äºçš„free_areaé“¾è¡¨ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰ä¼™ä¼´å­˜åœ¨ï¼Œå¦‚æœæ²¡æœ‰ä¼™ä¼´å—ï¼Œç›´æ¥å°†é‡Šæ”¾çš„å—æ’å…¥é“¾è¡¨å¤´ã€‚å¦‚æœæœ‰æˆ–æ¿å—çš„å­˜åœ¨ï¼Œåˆ™å°†å…¶ä»é“¾è¡¨æ‘˜ä¸‹ï¼Œåˆå¹¶æˆä¸€ä¸ªå¤§å—ï¼Œç„¶åç»§ç»­æŸ¥æ‰¾åˆå¹¶åçš„å—åœ¨æ›´å¤§ä¸€çº§é“¾è¡¨ä¸­æ˜¯å¦æœ‰ä¼™ä¼´çš„å­˜åœ¨ï¼Œç›´è‡³ä¸èƒ½åˆå¹¶æˆ–è€…å·²ç»åˆå¹¶è‡³æœ€å¤§å—2^10ä¸ºæ­¢ã€‚\nå†…æ ¸è¯•å›¾å°†å¤§å°ä¸ºbçš„ä¸€å¯¹ç©ºé—²å—ï¼ˆä¸€ä¸ªæ˜¯ç°æœ‰ç©ºé—²é“¾è¡¨ä¸Šçš„ï¼Œä¸€ä¸ªæ˜¯å¾…å›æ”¶çš„ï¼‰ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªå¤§å°ä¸º2Bçš„å•ç‹¬å—ï¼Œå¦‚æœå®ƒæˆåŠŸåˆå¹¶æ‰€é‡Šæ”¾çš„å—ï¼Œå®ƒä¼šè¯•å›¾åˆå¹¶2bå¤§å°çš„å—ï¼Œ\nä¼™ä¼´ç®—æ³•çš„ä¼˜ç¼ºç‚¹\nä¼˜ç‚¹ï¼š\n è¾ƒå¥½çš„è§£å†³å¤–éƒ¨ç¢ç‰‡é—®é¢˜ å½“éœ€è¦åˆ†é…è‹¥å¹²ä¸ªå†…å­˜é¡µé¢æ—¶ï¼Œç”¨äºDMAçš„å†…å­˜é¡µé¢å¿…é¡»è¿ç»­ï¼Œä¼™ä¼´ç®—æ³•å¾ˆå¥½çš„æ»¡è¶³äº†è¿™ä¸ªè¦æ±‚ åªè¦è¯·æ±‚çš„å—ä¸è¶…è¿‡512ä¸ªé¡µé¢(2K)ï¼Œå†…æ ¸å°±å°½é‡åˆ†é…è¿ç»­çš„é¡µé¢ã€‚ é’ˆå¯¹å¤§å†…å­˜åˆ†é…è®¾è®¡ã€‚  ç¼ºç‚¹ï¼š\n åˆå¹¶çš„è¦æ±‚å¤ªè¿‡ä¸¥æ ¼ï¼Œåªèƒ½æ˜¯æ»¡è¶³ä¼™ä¼´å…³ç³»çš„å—æ‰èƒ½åˆå¹¶ï¼Œæ¯”å¦‚ç¬¬1å—å’Œç¬¬2å—å°±ä¸èƒ½åˆå¹¶ã€‚ ç¢ç‰‡é—®é¢˜ï¼šä¸€ä¸ªè¿ç»­çš„å†…å­˜ä¸­ä»…ä»…ä¸€ä¸ªé¡µé¢è¢«å ç”¨ï¼Œå¯¼è‡´æ•´å—å†…å­˜åŒºéƒ½ä¸å…·å¤‡åˆå¹¶çš„æ¡ä»¶(å†…éƒ¨ç¢ç‰‡é—®é¢˜) æµªè´¹é—®é¢˜ï¼šä¼™ä¼´ç®—æ³•åªèƒ½åˆ†é…2çš„å¹‚æ¬¡æ–¹å†…å­˜åŒºï¼Œå½“éœ€è¦8Kï¼ˆ2é¡µï¼‰æ—¶ï¼Œå¥½è¯´ï¼Œå½“éœ€è¦9Kæ—¶ï¼Œé‚£å°±éœ€è¦åˆ†é…16Kï¼ˆ4é¡µï¼‰çš„å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯å®é™…åªç”¨åˆ°9Kç©ºé—´ï¼Œå¤šä½™çš„7Kç©ºé—´å°±è¢«æµªè´¹æ‰ã€‚ ç®—æ³•çš„æ•ˆç‡é—®é¢˜ï¼š ä¼™ä¼´ç®—æ³•æ¶‰åŠäº†æ¯”è¾ƒå¤šçš„è®¡ç®—è¿˜æœ‰é“¾è¡¨å’Œä½å›¾çš„æ“ä½œï¼Œå¼€é”€è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œå¦‚æœæ¯æ¬¡2^nå¤§å°çš„ä¼™ä¼´å—å°±ä¼šåˆå¹¶åˆ°2^(n+1)çš„é“¾è¡¨é˜Ÿåˆ—ä¸­ï¼Œé‚£ä¹ˆ2^nå¤§å°é“¾è¡¨ä¸­çš„å—å°±ä¼šå› ä¸ºåˆå¹¶æ“ä½œè€Œå‡å°‘ï¼Œä½†ç³»ç»Ÿéšåç«‹å³æœ‰å¯èƒ½åˆæœ‰å¯¹è¯¥å¤§å°å—çš„éœ€æ±‚ï¼Œä¸ºæ­¤å¿…é¡»å†ä»2^(n+1)å¤§å°çš„é“¾è¡¨ä¸­æ‹†åˆ†ï¼Œè¿™æ ·çš„åˆå¹¶åˆç«‹å³æ‹†åˆ†çš„è¿‡ç¨‹æ˜¯æ— æ•ˆç‡çš„ã€‚  Linuxé’ˆå¯¹å¤§å†…å­˜çš„ç‰©ç†åœ°å€åˆ†é…ï¼Œé‡‡ç”¨ä¼™ä¼´ç®—æ³•ï¼Œå¦‚æœæ˜¯é’ˆå¯¹å°äºä¸€ä¸ªpageçš„å†…å­˜ï¼Œé¢‘ç¹çš„åˆ†é…å’Œé‡Šæ”¾ï¼Œæœ‰æ›´åŠ é€‚å®œçš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚slabå’Œkmem_cacheç­‰ã€‚\nSlabåˆ†é…ç®—æ³• åœ¨Linuxä¸­ï¼Œä¼™ä¼´ç³»ç»Ÿï¼ˆbuddy systemï¼‰æ˜¯ä»¥é¡µä¸ºå•ä½ç®¡ç†å’Œåˆ†é…å†…å­˜ã€‚ä½†æ˜¯ç°å®çš„éœ€æ±‚å´ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œå‡å¦‚æˆ‘ä»¬éœ€è¦ç”³è¯·20Bytesï¼Œæ€»ä¸èƒ½åˆ†é…ä¸€é¡µå§ï¼é‚£å²‚ä¸æ˜¯ä¸¥é‡æµªè´¹å†…å­˜ã€‚é‚£ä¹ˆè¯¥å¦‚ä½•åˆ†é…å‘¢ï¼Ÿslabåˆ†é…å™¨å°±åº”è¿è€Œç”Ÿäº†ï¼Œä¸“ä¸ºå°å†…å­˜åˆ†é…è€Œç”Ÿã€‚slabåˆ†é…å™¨åˆ†é…å†…å­˜ä»¥Byteä¸ºå•ä½ã€‚ä½†æ˜¯slabåˆ†é…å™¨å¹¶æ²¡æœ‰è„±ç¦»ä¼™ä¼´ç³»ç»Ÿï¼Œè€Œæ˜¯åŸºäºä¼™ä¼´ç³»ç»Ÿåˆ†é…çš„å¤§å†…å­˜è¿›ä¸€æ­¥ç»†åˆ†æˆå°å†…å­˜åˆ†é…ã€‚\nlinux æ‰€ä½¿ç”¨çš„ slab åˆ†é…å™¨çš„åŸºç¡€æ˜¯ Jeff Bonwick ä¸ºSunOS æ“ä½œç³»ç»Ÿé¦–æ¬¡å¼•å…¥çš„ä¸€ç§ç®—æ³•ã€‚Jeffçš„åˆ†é…å™¨æ˜¯å›´ç»•å¯¹è±¡ç¼“å­˜è¿›è¡Œçš„ã€‚åœ¨å†…æ ¸ä¸­ï¼Œä¼šä¸ºæœ‰é™çš„å¯¹è±¡é›†ï¼ˆä¾‹å¦‚æ–‡ä»¶æè¿°ç¬¦å’Œå…¶ä»–å¸¸è§ç»“æ„ï¼‰åˆ†é…å¤§é‡å†…å­˜ã€‚Jeffå‘ç°å¯¹å†…æ ¸ä¸­**æ™®é€šå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–æ‰€éœ€çš„æ—¶é—´è¶…è¿‡äº†å¯¹å…¶è¿›è¡Œåˆ†é…å’Œé‡Šæ”¾æ‰€éœ€çš„æ—¶é—´ã€‚å› æ­¤ä»–çš„ç»“è®ºæ˜¯ä¸åº”è¯¥å°†å†…å­˜é‡Šæ”¾å›ä¸€ä¸ªå…¨å±€çš„å†…å­˜æ± ï¼Œè€Œæ˜¯å°†å†…å­˜ä¿æŒä¸ºé’ˆå¯¹ç‰¹å®šç›®è€Œåˆå§‹åŒ–çš„çŠ¶æ€ã€‚**ä¾‹å¦‚ï¼Œå¦‚æœå†…å­˜è¢«åˆ†é…ç»™äº†ä¸€ä¸ªäº’æ–¥é”ï¼Œé‚£ä¹ˆåªéœ€åœ¨ä¸ºäº’æ–¥é”é¦–æ¬¡åˆ†é…å†…å­˜æ—¶æ‰§è¡Œä¸€æ¬¡äº’æ–¥é”åˆå§‹åŒ–å‡½æ•°ï¼ˆmutex_initï¼‰å³å¯ã€‚åç»­çš„å†…å­˜åˆ†é…ä¸éœ€è¦æ‰§è¡Œè¿™ä¸ªåˆå§‹åŒ–å‡½æ•°ï¼Œå› ä¸ºä»ä¸Šæ¬¡é‡Šæ”¾å’Œè°ƒç”¨ææ„ä¹‹åï¼Œå®ƒå·²ç»å¤„äºæ‰€éœ€çš„çŠ¶æ€ä¸­äº†ã€‚\nslabå±‚ä¸»è¦èµ·åˆ°äº†ä¸¤ä¸ªæ–¹é¢çš„ä½œç”¨ï¼š\n  slabå¯ä»¥å¯¹å°å¯¹è±¡è¿›è¡Œåˆ†é…ï¼Œè¿™æ ·å°±ä¸ç”¨ä¸ºæ¯ä¸ªå°å¯¹è±¡åˆ†é…ä¸€ä¸ªé¡µæ¡†ï¼ŒèŠ‚çœäº†ç©ºé—´ã€‚\n  å†…æ ¸ä¸­çš„ä¸€äº›å°å¯¹è±¡åˆ›å»ºææ„å¾ˆé¢‘ç¹ï¼Œslabå¯¹è¿™äº›å°å¯¹è±¡åšäº†ç¼“å­˜ï¼Œå¯ä»¥é‡å¤åˆ©ç”¨ä¸€äº›ç›¸åŒçš„å¯¹è±¡ï¼Œå‡å°‘å†…å­˜åˆ†é…æ¬¡æ•°ã€‚\n  å›¾ä¸­ç»™å‡ºäº† slabç»“æ„çš„é«˜å±‚ç»„ç»‡ç»“æ„ã€‚åœ¨æœ€é«˜å±‚æ˜¯ cache_chainï¼Œè¿™æ˜¯ä¸€ä¸ª slab ç¼“å­˜çš„é“¾æ¥åˆ—è¡¨ã€‚cache_chain çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ª kmem_cache ç»“æ„çš„å¼•ç”¨ï¼ˆç§°ä¸ºä¸€ä¸ª cacheï¼‰ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªè¦ç®¡ç†çš„ç»™å®šå¤§å°çš„å¯¹è±¡æ± ã€‚\næ¯ä¸ªç¼“å­˜éƒ½åŒ…å«äº†ä¸€ä¸ª slabs åˆ—è¡¨ï¼Œè¿™æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜å—ï¼ˆé€šå¸¸éƒ½æ˜¯é¡µé¢ï¼‰ã€‚å­˜åœ¨3 ç§ slabï¼š\nslabs_full:å®Œå…¨åˆ†é…çš„slab\nslabs_partial:éƒ¨åˆ†åˆ†é…çš„slab\nslabs_empty:ç©ºslabï¼Œæˆ–è€…æ²¡æœ‰å¯¹è±¡è¢«åˆ†é…\nslab åˆ—è¡¨ä¸­çš„æ¯ä¸ª slabéƒ½æ˜¯ä¸€ä¸ªè¿ç»­çš„å†…å­˜å—ï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªè¿ç»­é¡µï¼‰ï¼Œå®ƒä»¬è¢«åˆ’åˆ†æˆä¸€ä¸ªä¸ªå¯¹è±¡ã€‚è¿™äº›å¯¹è±¡æ˜¯ä»ç‰¹å®šç¼“å­˜ä¸­è¿›è¡Œåˆ†é…å’Œé‡Šæ”¾çš„åŸºæœ¬å…ƒç´ ã€‚æ³¨æ„ slab æ˜¯ slabåˆ†é…å™¨è¿›è¡Œæ“ä½œçš„æœ€å°åˆ†é…å•ä½ï¼Œå› æ­¤å¦‚æœéœ€è¦å¯¹ slab è¿›è¡Œæ‰©å±•ï¼Œè¿™ä¹Ÿå°±æ˜¯æ‰€æ‰©å±•çš„æœ€å°å€¼ã€‚é€šå¸¸æ¥è¯´ï¼Œæ¯ä¸ª slab è¢«åˆ†é…ä¸ºå¤šä¸ªå¯¹è±¡ã€‚\nç”±äºå¯¹è±¡æ˜¯ä» slab ä¸­è¿›è¡Œåˆ†é…å’Œé‡Šæ”¾çš„ï¼Œå› æ­¤å•ä¸ª slab å¯ä»¥åœ¨ slabåˆ—è¡¨ä¹‹é—´è¿›è¡Œç§»åŠ¨ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ª slabä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½è¢«ä½¿ç”¨å®Œæ—¶ï¼Œå°±ä»slabs_partial åˆ—è¡¨ä¸­ç§»åŠ¨åˆ° slabs_full åˆ—è¡¨ä¸­ã€‚å½“ä¸€ä¸ª slabå®Œå…¨è¢«åˆ†é…å¹¶ä¸”æœ‰å¯¹è±¡è¢«é‡Šæ”¾åï¼Œå°±ä» slabs_full åˆ—è¡¨ä¸­ç§»åŠ¨åˆ°slabs_partial åˆ—è¡¨ä¸­ã€‚å½“æ‰€æœ‰å¯¹è±¡éƒ½è¢«é‡Šæ”¾ä¹‹åï¼Œå°±ä» slabs_partial åˆ—è¡¨ç§»åŠ¨åˆ° slabs_empty åˆ—è¡¨ä¸­ã€‚\nslabèƒŒåçš„åŠ¨æœº\nâ€‹\tä¸ä¼ ç»Ÿçš„å†…å­˜ç®¡ç†æ¨¡å¼ç›¸æ¯”ï¼Œ slabç¼“å­˜åˆ†é…å™¨æä¾›äº†å¾ˆå¤šä¼˜ç‚¹ã€‚é¦–å…ˆï¼Œå†…æ ¸é€šå¸¸ä¾èµ–äºå¯¹å°å¯¹è±¡çš„åˆ†é…ï¼Œå®ƒä»¬ä¼šåœ¨ç³»ç»Ÿç”Ÿå‘½å‘¨æœŸå†…è¿›è¡Œæ— æ•°æ¬¡åˆ†é…ã€‚slabç¼“å­˜åˆ†é…å™¨é€šè¿‡å¯¹ç±»ä¼¼å¤§å°çš„å¯¹è±¡è¿›è¡Œç¼“å­˜è€Œæä¾›è¿™ç§åŠŸèƒ½ï¼Œä»è€Œé¿å…äº†å¸¸è§çš„ç¢ç‰‡é—®é¢˜ã€‚slabåˆ†é…å™¨è¿˜æ”¯æŒé€šç”¨å¯¹è±¡çš„åˆå§‹åŒ–ï¼Œä»è€Œé¿å…äº†ä¸ºåŒä¸€ç›®è€Œå¯¹ä¸€ä¸ªå¯¹è±¡é‡å¤è¿›è¡Œåˆå§‹åŒ–ã€‚\nslabæè¿°ç¬¦\næ—¢ç„¶æ˜¯å¯¹å¯¹è±¡è¿›è¡Œç®¡ç†ï¼Œé‚£ä¹ˆå°±æœ‰ä¸€ä¸ªå†…å­˜çš„æŒ‡é’ˆæŒ‡å‘å®ƒæ‰€ç®¡ç†çš„å¯¹è±¡ï¼švoid* s_memã€‚å¹¶ä¸”å®ƒè¿˜éœ€è¦è®°å½•å“ªäº›å¯¹è±¡è¢«ä½¿ç”¨äº†ï¼Œå“ªäº›æ˜¯ç©ºé—²çš„ã€‚è¿™æ—¶å°±éœ€è¦æœ‰ä¸€ä¸ªæ•°ç»„è®°å½•è¿™ä¸ªä¸œè¥¿ï¼Œè¿™å°±æ˜¯freeå˜é‡ã€‚ä½ å¯èƒ½ä¼šå¥‡æ€ªå®ƒçš„ç±»å‹æ˜¯ä¸€ä¸ªunsigned intï¼š\nå®ƒæ˜¯å¦‚ä½•è®°å½•è¿™ä¸ªæ•°ç»„çš„å‘¢ï¼Ÿäº‹å®ä¸Šæ˜¯è®°å½•åœ¨slabæè¿°ç¬¦åé¢çš„æ•°ç»„ä¸­ï¼Œè¿™ä¸ªæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è®°å½•ç€ä¸‹ä¸€ä¸ªç©ºé—²çš„å†…å­˜å¯¹è±¡çš„ä½ç½®ã€‚è€Œfreeè®°å½•çš„å°±æ˜¯ç¬¬ä¸€ä¸ªç©ºé—²çš„å¯¹è±¡ã€‚è¿™æ ·å°±å¯ä»¥ä»freeå¼€å§‹éå†æ‰€æœ‰ç©ºé—²çš„å¯¹è±¡ã€‚\nä¸‹å›¾æ˜¾ç¤ºäº†slabå¯¹è±¡çš„å†…å­˜åˆ†å¸ƒï¼Œè¿™é‡Œéœ€è¦è§£é‡Šä¸€ä¸‹çš„æ˜¯slab descriptorä¼šæ ¹æ®æƒ…å†µè¢«å­˜æ”¾åœ¨å½“å‰slabçš„å†…å­˜ä¸­æˆ–è€…å­˜æ”¾åœ¨é€šç”¨çš„é«˜é€Ÿç¼“å­˜ä¸­ã€‚\nSlabä¸Buddyçš„å…³ç³»  slabä¸Buddyéƒ½æ˜¯å†…å­˜åˆ†é…å™¨ã€‚ slabçš„å†…å­˜æ¥è‡ªBuddy slabä¸Buddyåœ¨ç®—æ³•ä¸Šçº§åˆ«å¯¹ç­‰ã€‚BuddyæŠŠå†…å­˜æ¡å½“ä½œä¸€ä¸ªæ± å­æ¥ç®¡ç†ï¼Œslabæ˜¯æŠŠä»Buddyæ‹¿ åˆ°çš„å†…å­˜å½“ä½œä¸€ä¸ªæ± å­æ¥ç®¡ç†çš„  å‚è€ƒé“¾æ¥ï¼š\n Linux ä¼™ä¼´ç®—æ³•ç®€ä»‹ ä¼™ä¼´ç®—æ³•ä¸slabç®—æ³•  mmapå’Œbrkçš„åŒºåˆ« ä»æ“ä½œç³»ç»Ÿè§’åº¦æ¥çœ‹ï¼Œè¿›ç¨‹åˆ†é…å†…å­˜æœ‰ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«ç”±ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨å®Œæˆï¼šbrkå’Œmmapï¼ˆä¸è€ƒè™‘å…±äº«å†…å­˜ï¼‰ã€‚\n brkæ˜¯å°†æ•°æ®æ®µ(.data)çš„æœ€é«˜åœ°å€æŒ‡é’ˆ_edataå¾€é«˜åœ°å€æ¨ï¼›\nè¿™æ˜¯ brk çš„å†…å­˜åˆ†é…æ–¹å¼ï¼Œå¯ä»¥çœ‹åˆ°Aã€Bæ–°ç”³è¯·çš„å†…å­˜éƒ½ä»å †çš„åº•éƒ¨ï¼ˆå †çš„åœ°å€ç”Ÿé•¿æ˜¯ä»ä½åˆ°é«˜çš„ï¼‰å¼€å§‹å‘ä¸Šç”Ÿé•¿ã€‚\nå¦‚æœæ­¤æ—¶ free(A)ï¼ŒAçš„å†…å­˜å¹¶ä¸ä¼šè¢«é‡Šæ”¾ï¼Œè€Œæ˜¯ä¼šè¢«å›æ”¶ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡çš„åˆ©ç”¨ï¼Œæˆ–è€…è¯´æ˜¯ç­‰å¾…Bçš„å›æ”¶ã€‚\n mmapæ˜¯åœ¨è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ï¼ˆå †å’Œæ ˆä¸­é—´ï¼Œç§°ä¸ºæ–‡ä»¶æ˜ å°„åŒºåŸŸçš„åœ°æ–¹ï¼‰æ‰¾ä¸€å—ç©ºé—²çš„è™šæ‹Ÿå†…å­˜ã€‚\nmmapç›´æ¥ä»å †å’Œæ ˆä¹‹é—´çš„åŒºåŸŸå–å‡ºäº†ä¸€å—åŒºåŸŸï¼Œå½“å›æ”¶è¿™å—å†…å­˜æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¹Ÿä¼šç›´æ¥å°†è¿™å—å†…å­˜é‡Šæ”¾ã€‚\nä½†æ˜¯ç³»ç»Ÿè°ƒç”¨å’Œç¼ºé¡µä¸­æ–­æ¯”è¾ƒæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œä¸ºäº†CPUçš„æ‰§è¡Œæ•ˆç‡ï¼Œmallocåªåœ¨ç”³è¯·çš„å†…å­˜å¤§äº128Kæ—¶æ‰ä¼šè°ƒç”¨mmapè¿›è¡Œåˆ†é…å†…å­˜ã€‚\n  å¦‚æœå°† brk æ¯”å–»ä¸ºæ‰¹å‘çš„è¯ï¼Œé‚£ä¹ˆ mmap å°±æ˜¯é›¶å”®ã€‚\nè¿™ä¸¤ç§æ–¹å¼åˆ†é…çš„éƒ½æ˜¯è™šæ‹Ÿå†…å­˜ï¼Œæ²¡æœ‰åˆ†é…ç‰©ç†å†…å­˜ã€‚åœ¨ç¬¬ä¸€æ¬¡è®¿é—®å·²åˆ†é…çš„è™šæ‹Ÿåœ°å€ç©ºé—´çš„æ—¶å€™ï¼Œå‘ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£åˆ†é…ç‰©ç†å†…å­˜ï¼Œç„¶åå»ºç«‹è™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚\nå‚è€ƒï¼š\n æ“ä½œç³»ç»Ÿä¸­ brk å’Œ mmap çš„åŒºåˆ« linuxä¸‹brkã€mmapã€mallocå’Œnewçš„åŒºåˆ« è¿›ç¨‹åˆ†é…å†…å­˜çš„ä¸¤ç§æ–¹å¼\u0026ndash;brk() å’Œmmap()ï¼ˆä¸è®¾è®¡å…±äº«å†…å­˜ï¼‰  å¦‚ä½•æŸ¥çœ‹ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼Ÿ   ä½¿ç”¨netstat:\n1  netstat anp | grep 80     ä½¿ç”¨lsof:\n1  lsof -i:80     Linuxçš„forkå®ç° forkçš„ç®€å•ä¾‹å­å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  #include \u0026lt;unistd.h\u0026gt;#include \u0026lt;stdio.h\u0026gt; int main() { int pid = fork(); if (pid == -1) return -1; if (pid) { printf(\u0026#34;I am father, my pid is %d\\n\u0026#34;, getpid()); return 0; } else { printf(\u0026#34;I am child, my pid is %d\\n\u0026#34;, getpid()); return 0; } }   I am father, my pid is 466 I am child, my pid is 469 çœ‹åˆ°è¿™ä¸ªç»“æœæ˜¯ä¸æ˜¯å¾ˆå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆifçš„åˆ†æ”¯æ‰§è¡Œåˆ°äº†ï¼Œelseçš„åˆ†æ”¯ä¹Ÿæ‰§è¡Œåˆ°äº†â“\nå¯¹äºå‡½æ•°åŸå‹pid_t fork();ï¼Œå®ƒæœ‰ä¸‰ä¸ªè¿”å›å€¼\n è¯¥è¿›ç¨‹ä¸ºçˆ¶è¿›ç¨‹æ—¶ï¼Œè¿”å›å­è¿›ç¨‹çš„pid è¯¥è¿›ç¨‹ä¸ºå­è¿›ç¨‹æ—¶ï¼Œè¿”å› forkæ‰§è¡Œå¤±è´¥ï¼Œè¿”å›-1  forkå®ƒæ˜¯å¦‚ä½•çŸ¥é“ä¸€ä¸ªè¿›ç¨‹æ˜¯çˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹çš„â“\nforkæœ¬èº«çš„åŠŸèƒ½æ˜¯å…‹éš†è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯å°†åŸå…ˆçš„ä¸€ä¸ªè¿›ç¨‹å†å…‹éš†å‡ºä¸€ä¸ªæ¥ï¼Œå…‹éš†å‡ºçš„è¿™ä¸ªè¿›ç¨‹å°±æ˜¯åŸè¿›ç¨‹çš„å­è¿›ç¨‹ï¼Œè¿™ä¸ªå­è¿›ç¨‹å’Œå…¶ä»–çš„è¿›ç¨‹æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŒåŒæ ·æ‹¥æœ‰è‡ªå·±çš„ç‹¬ç«‹çš„åœ°å€ç©ºé—´ã€‚ä¸åŒçš„æ˜¯å­è¿›ç¨‹æ˜¯åœ¨forkè¿”å›ä¹‹åæ‰å¼€å§‹æ‰§è¡Œçš„ï¼Œå°±åƒä¸€æŠŠå‰å­ä¸€æ ·ï¼Œæ‰§è¡Œforkä¹‹åï¼Œçˆ¶å­è¿›ç¨‹å°±åˆ†é“æ‰¬é•³äº†ï¼Œæ‰€ä»¥forkè¿™ä¸ªåå­—å°±å¾ˆå½¢è±¡\nforkæœ¬è´¨(ä¸¤ä¸ªè¿›ç¨‹+æ—¶é—´ç‰‡è½®è½¬)\nforkåœ¨æ‰§è¡Œä¹‹åï¼Œä¼šåˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œè¿™ä¸ªæ–°çš„è¿›ç¨‹å†…éƒ¨çš„æ•°æ®æ˜¯åŸè¿›ç¨‹æ‰€æœ‰æ•°æ®çš„ä¸€ä»½æ‹·è´ã€‚å› æ­¤forkå°±ç›¸å½“äºæŠŠæŸä¸ªè¿›ç¨‹çš„å…¨éƒ¨èµ„æºå¤åˆ¶äº†ä¸€éï¼Œç„¶åè®©csï¼šeipæŒ‡å‘æ–°è¿›ç¨‹çš„æŒ‡ä»¤éƒ¨åˆ†ã€‚\nforkç»™çˆ¶è¿›ç¨‹è¿”å›å­è¿›ç¨‹pidï¼Œç»™å…¶æ‹·è´å‡ºæ¥çš„å­è¿›ç¨‹è¿”å›0ï¼Œè¿™ä¹Ÿæ˜¯ä»–çš„ç‰¹ç‚¹ä¹‹ä¸€ï¼Œä¸€æ¬¡è°ƒç”¨ï¼Œä¸¤æ¬¡è¿”å›ã€‚ä¸¤æ¬¡è¿”å›çœ‹ä¸Šå»æœ‰ç‚¹ç¥ç§˜ï¼Œå®è´¨æ˜¯åœ¨å­è¿›ç¨‹çš„æ ˆä¸­æ„é€ å¥½æ•°æ®åï¼Œå­è¿›ç¨‹ä»æ ˆä¸­è·å–åˆ°çš„è¿”å›å€¼ã€‚\nforkçš„å®ç°åˆ†ä¸ºä»¥ä¸‹ä¸¤æ­¥\n å¤åˆ¶è¿›ç¨‹èµ„æº æ‰§è¡Œè¯¥è¿›ç¨‹  å¤åˆ¶è¿›ç¨‹çš„èµ„æºåŒ…æ‹¬ä»¥ä¸‹å‡ æ­¥\n è¿›ç¨‹pcb ç¨‹åºä½“ï¼Œå³ä»£ç æ®µæ•°æ®æ®µç­‰ ç”¨æˆ·æ ˆ å†…æ ¸æ ˆ è™šæ‹Ÿå†…å­˜æ±  é¡µè¡¨  è¿›è¡Œè¿›ç¨‹çš„è¯å°±æ¯”è¾ƒç®€å•äº†ï¼Œåªéœ€è¦å°†å…¶åŠ å…¥åˆ°å°±ç»ªé˜Ÿåˆ—å³å¯ï¼Œæ¥ä¸‹æ¥å°±ç­‰å¾…cpuçš„è°ƒåº¦äº†ã€‚\n1  pid=fork();   æ“ä½œç³»ç»Ÿåˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹(å­è¿›ç¨‹)ï¼Œå¹¶ä¸”åœ¨è¿›ç¨‹è¡¨ä¸­ç›¸åº”ä¸ºå®ƒå»ºç«‹ä¸€ä¸ªæ–°çš„è¡¨é¡¹ã€‚æ–°è¿›ç¨‹å’ŒåŸæœ‰è¿›ç¨‹çš„å¯æ‰§è¡Œç¨‹åºæ˜¯åŒä¸€ä¸ªç¨‹åºï¼›ä¸Šä¸‹æ–‡å’Œæ•°æ®ï¼Œç»å¤§éƒ¨åˆ†å°±æ˜¯åŸè¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹ï¼‰çš„æ‹·è´ï¼Œä½†å®ƒä»¬æ˜¯ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„è¿›ç¨‹!æ­¤æ—¶ç¨‹åºå¯„å­˜å™¨pcï¼Œåœ¨çˆ¶ã€å­è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­éƒ½å£°ç§°ï¼Œè¿™ä¸ªè¿›ç¨‹ç›®å‰æ‰§è¡Œåˆ°forkè°ƒç”¨å³å°†è¿”å›(æ­¤æ—¶å­è¿›ç¨‹ä¸å æœ‰CPUï¼Œå­è¿›ç¨‹çš„pcä¸æ˜¯çœŸæ­£ä¿å­˜åœ¨å¯„å­˜å™¨ä¸­ï¼Œè€Œæ˜¯ä½œä¸ºè¿›ç¨‹ä¸Šä¸‹æ–‡ä¿å­˜åœ¨è¿›ç¨‹è¡¨ä¸­çš„å¯¹åº”è¡¨é¡¹å†…)ã€‚é—®é¢˜æ˜¯æ€ä¹ˆè¿”å›ï¼Œåœ¨çˆ¶å­è¿›ç¨‹ä¸­å°±åˆ†é“æ‰¬é•³ã€‚\nçˆ¶è¿›ç¨‹ç»§ç»­æ‰§è¡Œï¼Œæ“ä½œç³»ç»Ÿå¯¹forkçš„å®ç°ï¼Œä½¿è¿™ä¸ªè°ƒç”¨åœ¨çˆ¶è¿›ç¨‹ä¸­è¿”å›åˆšåˆšåˆ›å»ºçš„å­è¿›ç¨‹çš„pid(ä¸€ä¸ªæ­£æ•´æ•°)ï¼Œæ‰€ä»¥ä¸‹é¢çš„ifè¯­å¥ä¸­pid\u0026lt;0, pid==0çš„ä¸¤ä¸ªåˆ†æ”¯éƒ½ä¸ä¼šæ‰§è¡Œã€‚\nå­è¿›ç¨‹åœ¨ä¹‹åçš„æŸä¸ªæ—¶å€™å¾—åˆ°è°ƒåº¦ï¼Œå®ƒçš„ä¸Šä¸‹æ–‡è¢«æ¢å…¥ï¼Œå æ® CPUï¼Œæ“ä½œç³»ç»Ÿå¯¹forkçš„å®ç°ï¼Œä½¿å¾—å­è¿›ç¨‹ä¸­forkè°ƒç”¨è¿”å›0ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªè¿›ç¨‹ï¼ˆæ³¨æ„è¿™ä¸æ˜¯çˆ¶è¿›ç¨‹äº†ï¼Œè™½ç„¶æ˜¯åŒä¸€ä¸ªç¨‹åºï¼Œä½†æ˜¯è¿™æ˜¯åŒä¸€ä¸ªç¨‹åºçš„å¦å¤–ä¸€æ¬¡æ‰§è¡Œï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­è¿™æ¬¡æ‰§è¡Œæ˜¯ç”±å¦å¤–ä¸€ä¸ªè¿›ç¨‹è¡¨ç¤ºçš„ï¼Œä»æ‰§è¡Œçš„è§’åº¦è¯´å’Œçˆ¶è¿›ç¨‹ç›¸äº’ç‹¬ç«‹ï¼‰ä¸­pid=0ã€‚è¿™ä¸ªè¿›ç¨‹ç»§ç»­æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œifè¯­å¥ä¸­ pid\u0026lt;0ä¸æ»¡è¶³ï¼Œä½†æ˜¯pid==0æ˜¯trueã€‚\nç›¸å…³ä»£ç \nå°†çˆ¶è¿›ç¨‹çš„pcbã€è™šæ‹Ÿåœ°å€ä½å›¾æ‹·è´ç»™å­è¿›ç¨‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  static int32_t copy_pcb_vaddrbitmap_stack0(task_struct *child_thread, task_struct *parent_thread) { /* a å¤åˆ¶pcbæ‰€åœ¨çš„æ•´ä¸ªé¡µ,é‡Œé¢åŒ…å«è¿›ç¨‹pcbä¿¡æ¯åŠç‰¹çº§0æçš„æ ˆ,é‡Œé¢åŒ…å«äº†è¿”å›åœ°å€, ç„¶åå†å•ç‹¬ä¿®æ”¹ä¸ªåˆ«éƒ¨åˆ† */ memcpy(child_thread, parent_thread, PG_SIZE); child_thread-\u0026gt;pid = fork_pid(); child_thread-\u0026gt;elapsed_ticks = 0; child_thread-\u0026gt;status = TASK_READY; child_thread-\u0026gt;ticks = child_thread-\u0026gt;priority; // ä¸ºæ–°è¿›ç¨‹æŠŠæ—¶é—´ç‰‡å……æ»¡  child_thread-\u0026gt;parent_pid = parent_thread-\u0026gt;pid; child_thread-\u0026gt;general_tag.prev = child_thread-\u0026gt;general_tag.next = NULL; child_thread-\u0026gt;all_list_tag.prev = child_thread-\u0026gt;all_list_tag.next = NULL; block_desc_init(child_thread-\u0026gt;u_block_desc); /* b å¤åˆ¶çˆ¶è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€æ± çš„ä½å›¾ */ uint32_t bitmap_pg_cnt = DIV_ROUND_UP((0xc0000000 - USER_VADDR_START) / PG_SIZE / 8, PG_SIZE); void *vaddr_btmp = get_kernel_pages(bitmap_pg_cnt); if (vaddr_btmp == NULL) return -1; /* æ­¤æ—¶child_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.bitsè¿˜æ˜¯æŒ‡å‘çˆ¶è¿›ç¨‹è™šæ‹Ÿåœ°å€çš„ä½å›¾åœ°å€ * ä¸‹é¢å°†child_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.bitsæŒ‡å‘è‡ªå·±çš„ä½å›¾vaddr_btmp */ memcpy(vaddr_btmp, child_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.bits, bitmap_pg_cnt * PG_SIZE); child_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.bits = vaddr_btmp; ASSERT(strlen(child_thread-\u0026gt;name) \u0026lt; 11); // pcb.nameçš„é•¿åº¦æ˜¯16,ä¸ºé¿å…ä¸‹é¢strcatè¶Šç•Œ  strcat(child_thread-\u0026gt;name, \u0026#34;_fork\u0026#34;); return 0; }   å¤åˆ¶å­è¿›ç¨‹çš„è¿›ç¨‹ä½“(ä»£ç å’Œæ•°æ®)åŠç”¨æˆ·æ ˆ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  static void copy_body_stack3(task_struct *child_thread, task_struct *parent_thread, void *buf_page) { uint8_t *vaddr_btmp = parent_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.bits; uint32_t btmp_bytes_len = parent_thread-\u0026gt;userprog_vaddr.vaddr_bitmap.btmp_bytes_len; uint32_t vaddr_start = parent_thread-\u0026gt;userprog_vaddr.vaddr_start; uint32_t idx_byte = 0; uint32_t idx_bit = 0; uint32_t prog_vaddr = 0; /* åœ¨çˆ¶è¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´ä¸­æŸ¥æ‰¾å·²æœ‰æ•°æ®çš„é¡µ */ while (idx_byte \u0026lt; btmp_bytes_len) { if (vaddr_btmp[idx_byte]) { idx_bit = 0; while (idx_bit \u0026lt; 8) { if ((BITMAP_MASK \u0026lt;\u0026lt; idx_bit) \u0026amp; vaddr_btmp[idx_byte]) { prog_vaddr = (idx_byte * 8 + idx_bit) * PG_SIZE + vaddr_start; /* ä¸‹é¢çš„æ“ä½œæ˜¯å°†çˆ¶è¿›ç¨‹ç”¨æˆ·ç©ºé—´ä¸­çš„æ•°æ®é€šè¿‡å†…æ ¸ç©ºé—´åšä¸­è½¬,æœ€ç»ˆå¤åˆ¶åˆ°å­è¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´ */ /* a å°†çˆ¶è¿›ç¨‹åœ¨ç”¨æˆ·ç©ºé—´ä¸­çš„æ•°æ®å¤åˆ¶åˆ°å†…æ ¸ç¼“å†²åŒºbuf_page, ç›®çš„æ˜¯ä¸‹é¢åˆ‡æ¢åˆ°å­è¿›ç¨‹çš„é¡µè¡¨å,è¿˜èƒ½è®¿é—®åˆ°çˆ¶è¿›ç¨‹çš„æ•°æ®*/ memcpy(buf_page, (void *)prog_vaddr, PG_SIZE); /* b å°†é¡µè¡¨åˆ‡æ¢åˆ°å­è¿›ç¨‹,ç›®çš„æ˜¯é¿å…ä¸‹é¢ç”³è¯·å†…å­˜çš„å‡½æ•°å°†pteåŠpdeå®‰è£…åœ¨çˆ¶è¿›ç¨‹çš„é¡µè¡¨ä¸­ */ page_dir_activate(child_thread); /* c ç”³è¯·è™šæ‹Ÿåœ°å€prog_vaddr */ get_a_page_without_opvaddrbitmap(PF_USER, prog_vaddr); /* d ä»å†…æ ¸ç¼“å†²åŒºä¸­å°†çˆ¶è¿›ç¨‹æ•°æ®å¤åˆ¶åˆ°å­è¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´ */ memcpy((void *)prog_vaddr, buf_page, PG_SIZE); /* e æ¢å¤çˆ¶è¿›ç¨‹é¡µè¡¨ */ page_dir_activate(parent_thread); } idx_bit++; } } idx_byte++; } }   ä¸ºå­è¿›ç¨‹æ„å»ºthread_stackå’Œä¿®æ”¹è¿”å›å€¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  static int32_t build_child_stack(task_struct *child_thread) { /* a ä½¿å­è¿›ç¨‹pidè¿”å›å€¼ä¸º0 */ /* è·å–å­è¿›ç¨‹0çº§æ ˆæ ˆé¡¶ */ intr_stack *intr_0_stack = (intr_stack *)((uint32_t)child_thread + PG_SIZE - sizeof(intr_stack)); /* ä¿®æ”¹å­è¿›ç¨‹çš„è¿”å›å€¼ä¸º0 */ intr_0_stack-\u0026gt;eax = 0; /* b ä¸ºswitch_to æ„å»º struct thread_stack,å°†å…¶æ„å»ºåœ¨ç´§ä¸´intr_stackä¹‹ä¸‹çš„ç©ºé—´*/ uint32_t *ret_addr_in_thread_stack = (uint32_t *)intr_0_stack - 1; /* ebpåœ¨thread_stackä¸­çš„åœ°å€ä¾¿æ˜¯å½“æ—¶çš„esp(0çº§æ ˆçš„æ ˆé¡¶), å³espä¸º\u0026#34;(uint32_t*)intr_0_stack - 5\u0026#34; */ uint32_t *ebp_ptr_in_thread_stack = (uint32_t *)intr_0_stack - 5; /* switch_toçš„è¿”å›åœ°å€æ›´æ–°ä¸ºintr_exit,ç›´æ¥ä»ä¸­æ–­è¿”å› */ *ret_addr_in_thread_stack = (uint32_t)intr_exit; /* æŠŠæ„å»ºçš„thread_stackçš„æ ˆé¡¶åšä¸ºswitch_toæ¢å¤æ•°æ®æ—¶çš„æ ˆé¡¶ */ child_thread-\u0026gt;self_kstack = ebp_ptr_in_thread_stack; return 0; }   æ‹·è´çˆ¶è¿›ç¨‹æœ¬èº«æ‰€å èµ„æºç»™å­è¿›ç¨‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  static int32_t copy_process(task_struct *child_thread, task_struct *parent_thread) { /* å†…æ ¸ç¼“å†²åŒº,ä½œä¸ºçˆ¶è¿›ç¨‹ç”¨æˆ·ç©ºé—´çš„æ•°æ®å¤åˆ¶åˆ°å­è¿›ç¨‹ç”¨æˆ·ç©ºé—´çš„ä¸­è½¬ */ void *buf_page = get_kernel_pages(1); if (buf_page == NULL) { return -1; } /* a å¤åˆ¶çˆ¶è¿›ç¨‹çš„pcbã€è™šæ‹Ÿåœ°å€ä½å›¾ã€å†…æ ¸æ ˆåˆ°å­è¿›ç¨‹ */ if (copy_pcb_vaddrbitmap_stack0(child_thread, parent_thread) == -1) { return -1; } /* b ä¸ºå­è¿›ç¨‹åˆ›å»ºé¡µè¡¨,æ­¤é¡µè¡¨ä»…åŒ…æ‹¬å†…æ ¸ç©ºé—´ */ child_thread-\u0026gt;pgdir = create_page_dir(); if (child_thread-\u0026gt;pgdir == NULL) { return -1; } /* c å¤åˆ¶çˆ¶è¿›ç¨‹è¿›ç¨‹ä½“åŠç”¨æˆ·æ ˆç»™å­è¿›ç¨‹ */ copy_body_stack3(child_thread, parent_thread, buf_page); /* d æ„å»ºå­è¿›ç¨‹thread_stackå’Œä¿®æ”¹è¿”å›å€¼pid */ build_child_stack(child_thread); /* e æ›´æ–°æ–‡ä»¶inodeçš„æ‰“å¼€æ•° */ update_inode_open_cnts(child_thread); mfree_page(PF_KERNEL, buf_page, 1); return 0; }   ä¸»ç³»ç»ŸAPIè°ƒç”¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  /* forkå­è¿›ç¨‹,å†…æ ¸çº¿ç¨‹ä¸å¯ç›´æ¥è°ƒç”¨ */ pid_t sys_fork(void) { task_struct *parent_thread = running_thread(); task_struct *child_thread = get_kernel_pages(1); // ä¸ºå­è¿›ç¨‹åˆ›å»ºpcb(task_structç»“æ„)  if (child_thread == NULL) { return -1; } ASSERT(INTR_OFF == intr_get_status() \u0026amp;\u0026amp; parent_thread-\u0026gt;pgdir != NULL); if (copy_process(child_thread, parent_thread) == -1) { return -1; } /* æ·»åŠ åˆ°å°±ç»ªçº¿ç¨‹é˜Ÿåˆ—å’Œæ‰€æœ‰çº¿ç¨‹é˜Ÿåˆ—,å­è¿›ç¨‹ç”±è°ƒè¯•å™¨å®‰æ’è¿è¡Œ */ ASSERT(!elem_find(\u0026amp;thread_ready_list, \u0026amp;child_thread-\u0026gt;general_tag)); list_append(\u0026amp;thread_ready_list, \u0026amp;child_thread-\u0026gt;general_tag); ASSERT(!elem_find(\u0026amp;thread_all_list, \u0026amp;child_thread-\u0026gt;all_list_tag)); list_append(\u0026amp;thread_all_list, \u0026amp;child_thread-\u0026gt;all_list_tag); return child_thread-\u0026gt;pid; // çˆ¶è¿›ç¨‹è¿”å›å­è¿›ç¨‹çš„pid }   å‚è€ƒï¼š\n åä¹. forkçš„åŸç†åŠå®ç° forkè¿›ç¨‹çš„è¿‡ç¨‹  MallocåŸç†ğŸš´  å†…å­˜ç®¡ç†æ¨¡å—ä¸­æ˜¯é€šè¿‡bitmapå¯¹å†…å­˜è¿›è¡Œç®¡ç†çš„ï¼Œbitmapä¸­çš„æ¯ä¸€ä¸ªbitä½å°±ä»£è¡¨ä¸€é¡µå¤§å°çš„å†…å­˜ï¼Œè¯¥ä½ä¸º1æ—¶è¡¨ç¤ºè¿™é¡µå·²ç»åˆ†é…å‡ºå»äº†ã€‚é‚£ä¹ˆå¯¹å°å—å†…å­˜è¿›è¡Œåˆ†é…çš„æ—¶å€™ï¼ŒåŒæ ·éœ€è¦ä¸€ä¸ªç»“æ„æ¥è®°å½•è¿™å—å†…å­˜çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦é€šè¿‡ä¸€ç§ç»“æ„æ¥å¯¹å†…å­˜çš„åˆ†é…ä¸é‡Šæ”¾è¿›è¡Œç®¡ç†ã€‚\n ä»»ä½•å®é™…çš„åˆ†é…å™¨éƒ½éœ€è¦ä¸€äº›æ•°æ®ç»“æ„ï¼Œå…è®¸å®ƒæ¥åŒºåˆ«å—è¾¹ç•Œï¼Œä»¥åŠåŒºåˆ«å·²åˆ†é…å—å’Œç©ºé—²å— ã€‚å¤§å¤šæ•°åˆ†é…å™¨å°†è¿™äº›ä¿¡æ¯åµŒäººå—æœ¬èº«ã€‚ä¸€ä¸ªç®€å•çš„ç»“æ„å¦‚ä¸‹ï¼š\nLinuxè¿›ç¨‹å †ç®¡ç† Linuxç»´æŠ¤ä¸€ä¸ªbreakæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å †ç©ºé—´çš„æŸä¸ªåœ°å€ã€‚ä»å †èµ·å§‹åœ°å€åˆ°breakä¹‹é—´çš„åœ°å€ç©ºé—´ä¸ºæ˜ å°„å¥½çš„ï¼Œå¯ä»¥ä¾›è¿›ç¨‹è®¿é—®ï¼›è€Œä»breakå¾€ä¸Šï¼Œæ˜¯æœªæ˜ å°„çš„åœ°å€ç©ºé—´ï¼Œå¦‚æœè®¿é—®è¿™æ®µç©ºé—´åˆ™ç¨‹åºä¼šæŠ¥é”™ã€‚\nbrkä¸sbrk è¦å¢åŠ ä¸€ä¸ªè¿›ç¨‹å®é™…çš„å¯ç”¨å †å¤§å°ï¼Œå°±éœ€è¦å°†breakæŒ‡é’ˆå‘é«˜åœ°å€ç§»åŠ¨ã€‚Linuxé€šè¿‡brkå’Œsbrkç³»ç»Ÿè°ƒç”¨æ“ä½œbreakæŒ‡é’ˆã€‚ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨çš„åŸå‹å¦‚ä¸‹ï¼š\n1 2  int brk(void *addr); void *sbrk(intptr_t increment);   brkå°†breakæŒ‡é’ˆç›´æ¥è®¾ç½®ä¸ºæŸä¸ªåœ°å€ï¼Œè€Œsbrkå°†breakä»å½“å‰ä½ç½®ç§»åŠ¨incrementæ‰€æŒ‡å®šçš„å¢é‡ã€‚brkåœ¨æ‰§è¡ŒæˆåŠŸæ—¶è¿”å›0ï¼Œå¦åˆ™è¿”å›-1å¹¶è®¾ç½®errnoä¸ºENOMEMï¼›sbrkæˆåŠŸæ—¶è¿”å›breakç§»åŠ¨ä¹‹å‰æ‰€æŒ‡å‘çš„åœ°å€ï¼Œå¦åˆ™è¿”å›(void *)-1ã€‚\nä¸€ä¸ªå°æŠ€å·§æ˜¯ï¼Œå¦‚æœå°†incrementè®¾ç½®ä¸º0ï¼Œåˆ™å¯ä»¥è·å¾—å½“å‰breakçš„åœ°å€ã€‚\nç®€å•å®ç°malloc 1 2 3 4 5 6 7 8 9 10 11  /* ä¸€ä¸ªç©å…·malloc */ #include \u0026lt;sys/types.h\u0026gt;#include \u0026lt;unistd.h\u0026gt;void *malloc(size_t size) { void *p; p = sbrk(0); if (sbrk(size) == (void *)-1) return NULL; return p; }   è¿™ä¸ªmallocæ¯æ¬¡éƒ½åœ¨å½“å‰breakçš„åŸºç¡€ä¸Šå¢åŠ sizeæ‰€æŒ‡å®šçš„å­—èŠ‚æ•°ï¼Œå¹¶å°†ä¹‹å‰breakçš„åœ°å€è¿”å›ã€‚è¿™ä¸ªmallocç”±äºå¯¹æ‰€åˆ†é…çš„å†…å­˜ç¼ºä¹è®°å½•ï¼Œä¸ä¾¿äºå†…å­˜é‡Šæ”¾ï¼Œæ‰€ä»¥æ— æ³•ç”¨äºçœŸå®åœºæ™¯ã€‚\næ­£å¼å®ç°malloc æ•°æ®ç»“æ„\nä¸€ä¸ªç®€å•å¯è¡Œæ–¹æ¡ˆæ˜¯å°†å †å†…å­˜ç©ºé—´ä»¥å—ï¼ˆBlockï¼‰çš„å½¢å¼ç»„ç»‡èµ·æ¥ï¼Œæ¯ä¸ªå—ç”±metaåŒºå’Œæ•°æ®åŒºç»„æˆï¼ŒmetaåŒºè®°å½•æ•°æ®å—çš„å…ƒä¿¡æ¯ï¼ˆæ•°æ®åŒºå¤§å°ã€ç©ºé—²æ ‡å¿—ä½ã€æŒ‡é’ˆç­‰ç­‰ï¼‰ï¼Œæ•°æ®åŒºæ˜¯çœŸå®åˆ†é…çš„å†…å­˜åŒºåŸŸï¼Œå¹¶ä¸”æ•°æ®åŒºçš„ç¬¬ä¸€ä¸ªå­—èŠ‚åœ°å€å³ä¸ºmallocè¿”å›çš„åœ°å€ã€‚\n1 2 3 4 5 6 7 8 9  typedef struct s_block *t_block; struct s_block { size_t size; /* æ•°æ®åŒºå¤§å° 8å­—èŠ‚*/ t_block next; /* æŒ‡å‘ä¸‹ä¸ªå—çš„æŒ‡é’ˆ 8å­—èŠ‚*/ int free; /* æ˜¯å¦æ˜¯ç©ºé—²å— 4å­—èŠ‚*/ int padding; /* å¡«å……4å­—èŠ‚ï¼Œä¿è¯metaå—é•¿åº¦ä¸º8çš„å€æ•° 4å­—èŠ‚*/ char data[1] /* è¿™æ˜¯ä¸€ä¸ªè™šæ‹Ÿå­—æ®µï¼Œè¡¨ç¤ºæ•°æ®å—çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œé•¿åº¦ä¸åº”è®¡å…¥meta */ }; // æ€»å…±32å­—èŠ‚   ç”±äºæˆ‘ä»¬åªè€ƒè™‘64ä½æœºå™¨ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬åœ¨ç»“æ„ä½“æœ€åå¡«å……ä¸€ä¸ªintï¼Œä½¿å¾—ç»“æ„ä½“æœ¬èº«çš„é•¿åº¦ä¸º8çš„å€æ•°ï¼Œä»¥ä¾¿å†…å­˜å¯¹é½ã€‚ç¤ºæ„å›¾å¦‚ä¸‹ï¼š\nå¯»æ‰¾åˆé€‚çš„block\nã€€ç°åœ¨è€ƒè™‘å¦‚ä½•åœ¨blocké“¾ä¸­æŸ¥æ‰¾åˆé€‚çš„blockã€‚ä¸€èˆ¬æ¥è¯´æœ‰ä¸¤ç§æŸ¥æ‰¾ç®—æ³•ï¼š\n First fitï¼šä»å¤´å¼€å§‹ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªæ•°æ®åŒºå¤§å°å¤§äºè¦æ±‚sizeçš„å—æ‰€è°“æ­¤æ¬¡åˆ†é…çš„å— Best fitï¼šä»å¤´å¼€å§‹ï¼Œéå†æ‰€æœ‰å—ï¼Œä½¿ç”¨æ•°æ®åŒºå¤§å°å¤§äºsizeä¸”å·®å€¼æœ€å°çš„å—ä½œä¸ºæ­¤æ¬¡åˆ†é…çš„å—  ã€€ä¸¤ç§æ–¹æ³•å„æœ‰åƒç§‹ï¼Œbest fitå…·æœ‰è¾ƒé«˜çš„å†…å­˜ä½¿ç”¨ç‡ï¼ˆpayloadè¾ƒé«˜ï¼‰ï¼Œè€Œfirst fitå…·æœ‰æ›´å¥½çš„è¿è¡Œæ•ˆç‡ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨first fitç®—æ³•ã€‚\n1 2 3 4 5 6 7 8 9  /* First fit */ t_block find_block(t_block *last, size_t size) { t_block b = first_block; while(b \u0026amp;\u0026amp; !(b-\u0026gt;free \u0026amp;\u0026amp; b-\u0026gt;size \u0026gt;= size)) { *last = b; b = b-\u0026gt;next; } return b; }   find_blockä»frist_blockå¼€å§‹ï¼ŒæŸ¥æ‰¾ç¬¬ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„blockå¹¶è¿”å›blockèµ·å§‹åœ°å€ï¼Œå¦‚æœæ‰¾ä¸åˆ°è¿™è¿”å›NULLã€‚è¿™é‡Œåœ¨éå†æ—¶ä¼šæ›´æ–°ä¸€ä¸ªå«lastçš„æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆå§‹ç»ˆæŒ‡å‘å½“å‰éå†çš„blockã€‚è¿™æ˜¯ä¸ºäº†å¦‚æœæ‰¾ä¸åˆ°åˆé€‚çš„blockè€Œå¼€è¾Ÿæ–°blockä½¿ç”¨çš„ã€‚\nå¼€è¾Ÿæ–°çš„block\nå¦‚æœç°æœ‰blockéƒ½ä¸èƒ½æ»¡è¶³sizeçš„è¦æ±‚ï¼Œåˆ™éœ€è¦åœ¨é“¾è¡¨æœ€åå¼€è¾Ÿä¸€ä¸ªæ–°çš„blockã€‚è¿™é‡Œå…³é”®æ˜¯å¦‚ä½•åªä½¿ç”¨sbrkåˆ›å»ºä¸€ä¸ªstructï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  #define BLOCK_SIZE 24 /* ç”±äºå­˜åœ¨è™šæ‹Ÿçš„dataå­—æ®µï¼Œsizeofä¸èƒ½æ­£ç¡®è®¡ç®—metaé•¿åº¦ï¼Œè¿™é‡Œæ‰‹å·¥è®¾ç½® */ t_block extend_heap(t_block last, size_t s) { t_block b; b = sbrk(0); if(sbrk(BLOCK_SIZE + s) == (void *)-1) return NULL; b-\u0026gt;size = s; b-\u0026gt;next = NULL; if(last) last-\u0026gt;next = b; b-\u0026gt;free = 0; return b; }   åˆ†è£‚block\nFirst fitæœ‰ä¸€ä¸ªæ¯”è¾ƒè‡´å‘½çš„ç¼ºç‚¹ï¼Œå°±æ˜¯å¯èƒ½ä¼šè®©å¾ˆå°çš„sizeå æ®å¾ˆå¤§çš„ä¸€å—blockï¼Œæ­¤æ—¶ï¼Œä¸ºäº†æé«˜payloadï¼Œåº”è¯¥åœ¨å‰©ä½™æ•°æ®åŒºè¶³å¤Ÿå¤§çš„æƒ…å†µä¸‹ï¼Œå°†å…¶åˆ†è£‚ä¸ºä¸€ä¸ªæ–°çš„blockï¼Œç¤ºæ„å¦‚ä¸‹ï¼š\nå®ç°ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9  void split_block(t_block b, size_t s) { t_block new; new = b-\u0026gt;data + s; new-\u0026gt;size = b-\u0026gt;size - s - BLOCK_SIZE ; new-\u0026gt;next = b-\u0026gt;next; new-\u0026gt;free = 1; b-\u0026gt;size = s; b-\u0026gt;next = new; }   mallocå®ç°\næ³¨æ„é¦–å…ˆæˆ‘ä»¬è¦å®šä¹‰ä¸ªblocké“¾è¡¨çš„å¤´first_blockï¼Œåˆå§‹åŒ–ä¸ºNULLï¼›å¦å¤–ï¼Œæˆ‘ä»¬éœ€è¦å‰©ä½™ç©ºé—´è‡³å°‘æœ‰BLOCK_SIZE + 8æ‰æ‰§è¡Œåˆ†è£‚æ“ä½œã€‚\nç”±äºæˆ‘ä»¬å¸Œæœ›mallocåˆ†é…çš„æ•°æ®åŒºæ˜¯æŒ‰8å­—èŠ‚å¯¹é½ï¼Œæ‰€ä»¥åœ¨sizeä¸ä¸º8çš„å€æ•°æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†sizeè°ƒæ•´ä¸ºå¤§äºsizeçš„æœ€å°çš„8çš„å€æ•°ï¼š\n1 2 3 4 5  size_t align8(size_t s) { if(s \u0026amp; 0x7 == 0) return s; return ((s \u0026gt;\u0026gt; 3) + 1) \u0026lt;\u0026lt; 3; }   mallocä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  #define BLOCK_SIZE 24void *first_block=NULL; /* other functions... */ void *malloc(size_t size) { t_block b, last; size_t s; /* å¯¹é½åœ°å€ */ s = align8(size); if(first_block) { /* æŸ¥æ‰¾åˆé€‚çš„block */ last = first_block; b = find_block(\u0026amp;last, s); if(b) { /* å¦‚æœå¯ä»¥ï¼Œåˆ™åˆ†è£‚ */ if ((b-\u0026gt;size - s) \u0026gt;= ( BLOCK_SIZE + 8)) split_block(b, s); b-\u0026gt;free = 0; } else { /* æ²¡æœ‰åˆé€‚çš„blockï¼Œå¼€è¾Ÿä¸€ä¸ªæ–°çš„ */ b = extend_heap(last, s); if(!b) return NULL; } } else { b = extend_heap(NULL, s); if(!b) return NULL; first_block = b; } return b-\u0026gt;data; }   callocçš„å®ç° æœ‰äº†mallocï¼Œå®ç°callocåªè¦ä¸¤æ­¥ï¼š\n mallocä¸€æ®µå†…å­˜ å°†æ•°æ®åŒºå†…å®¹ç½®ä¸º0  ç”±äºæˆ‘ä»¬çš„æ•°æ®åŒºæ˜¯æŒ‰8å­—èŠ‚å¯¹é½çš„ï¼Œæ‰€ä»¥ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæˆ‘ä»¬å¯ä»¥æ¯8å­—èŠ‚ä¸€ç»„ç½®0ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚è®¾ç½®ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–°å»ºä¸€ä¸ªsize_tæŒ‡é’ˆï¼Œå°†å†…å­˜åŒºåŸŸå¼ºåˆ¶çœ‹åšsize_tç±»å‹æ¥å®ç°ã€‚\n1 2 3 4 5 6 7 8 9 10 11  void *calloc(size_t number, size_t size) { size_t *new; size_t s8, i; new = malloc(number * size); if(new) { s8 = align8(number * size) \u0026gt;\u0026gt; 3; for(i = 0; i \u0026lt; s8; i++) new[i] = 0; } return new; }   freeçš„å®ç° freeçš„å®ç°å¹¶ä¸åƒçœ‹ä¸Šå»é‚£ä¹ˆç®€å•ï¼Œè¿™é‡Œæˆ‘ä»¬è¦è§£å†³ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼š\n å¦‚ä½•éªŒè¯æ‰€ä¼ å…¥çš„åœ°å€æ˜¯æœ‰æ•ˆåœ°å€ï¼Œå³ç¡®å®æ˜¯é€šè¿‡mallocæ–¹å¼åˆ†é…çš„æ•°æ®åŒºé¦–åœ°å€ å¦‚ä½•è§£å†³ç¢ç‰‡é—®é¢˜  é¦–å…ˆæˆ‘ä»¬è¦ä¿è¯ä¼ å…¥freeçš„åœ°å€æ˜¯æœ‰æ•ˆçš„ï¼Œè¿™ä¸ªæœ‰æ•ˆåŒ…æ‹¬ä¸¤æ–¹é¢ï¼š\n åœ°å€åº”è¯¥åœ¨ä¹‹å‰mallocæ‰€åˆ†é…çš„åŒºåŸŸå†…ï¼Œå³åœ¨first_blockå’Œå½“å‰breakæŒ‡é’ˆèŒƒå›´å†… è¿™ä¸ªåœ°å€ç¡®å®æ˜¯ä¹‹å‰é€šè¿‡æˆ‘ä»¬è‡ªå·±çš„mallocåˆ†é…çš„  ç¬¬ä¸€ä¸ªé—®é¢˜æ¯”è¾ƒå¥½è§£å†³ï¼Œåªè¦è¿›è¡Œåœ°å€æ¯”è¾ƒå°±å¯ä»¥äº†ï¼Œå…³é”®æ˜¯ç¬¬äºŒä¸ªé—®é¢˜ã€‚è¿™é‡Œæœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼šä¸€æ˜¯åœ¨ç»“æ„ä½“å†…åŸ‹ä¸€ä¸ªmagic numberå­—æ®µï¼Œfreeä¹‹å‰é€šè¿‡ç›¸å¯¹åç§»æ£€æŸ¥ç‰¹å®šä½ç½®çš„å€¼æ˜¯å¦ä¸ºæˆ‘ä»¬è®¾ç½®çš„magic numberï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨ç»“æ„ä½“å†…å¢åŠ ä¸€ä¸ªmagic pointerï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘æ•°æ®åŒºçš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆä¹Ÿå°±æ˜¯åœ¨åˆæ³•æ—¶freeæ—¶ä¼ å…¥çš„åœ°å€ï¼‰ï¼Œæˆ‘ä»¬åœ¨freeå‰æ£€æŸ¥magic pointeræ˜¯å¦æŒ‡å‘å‚æ•°æ‰€æŒ‡åœ°å€ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç¬¬äºŒç§æ–¹æ¡ˆï¼š\né¦–å…ˆæˆ‘ä»¬åœ¨ç»“æ„ä½“ä¸­å¢åŠ magic pointerï¼ˆåŒæ—¶è¦ä¿®æ”¹BLOCK_SIZEï¼‰ï¼š\n1 2 3 4 5 6 7 8 9  typedef struct s_block *t_block; struct s_block { size_t size; /* æ•°æ®åŒºå¤§å° */ t_block next; /* æŒ‡å‘ä¸‹ä¸ªå—çš„æŒ‡é’ˆ */ int free; /* æ˜¯å¦æ˜¯ç©ºé—²å— */ int padding; /* å¡«å……4å­—èŠ‚ï¼Œä¿è¯metaå—é•¿åº¦ä¸º8çš„å€æ•° */ void *ptr; /* Magic pointerï¼ŒæŒ‡å‘data */ char data[1] /* è¿™æ˜¯ä¸€ä¸ªè™šæ‹Ÿå­—æ®µï¼Œè¡¨ç¤ºæ•°æ®å—çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œé•¿åº¦ä¸åº”è®¡å…¥meta */ };   ç„¶åæˆ‘ä»¬å®šä¹‰æ£€æŸ¥åœ°å€åˆæ³•æ€§çš„å‡½æ•°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  t_block get_block(void *p) { char *tmp; tmp = p; return (p = tmp -= BLOCK_SIZE); } int valid_addr(void *p) { if(first_block) { if(p \u0026gt; first_block \u0026amp;\u0026amp; p \u0026lt; sbrk(0)) { return p == (get_block(p))-\u0026gt;ptr; } } return 0; }   å½“å¤šæ¬¡mallocå’Œfreeåï¼Œæ•´ä¸ªå†…å­˜æ± å¯èƒ½ä¼šäº§ç”Ÿå¾ˆå¤šç¢ç‰‡blockï¼Œè¿™äº›blockå¾ˆå°ï¼Œç»å¸¸æ— æ³•ä½¿ç”¨ï¼Œç”šè‡³å‡ºç°è®¸å¤šç¢ç‰‡è¿åœ¨ä¸€èµ·ï¼Œè™½ç„¶æ€»ä½“èƒ½æ»¡è¶³æŸæ­¤mallocè¦æ±‚ï¼Œä½†æ˜¯ç”±äºåˆ†å‰²æˆäº†å¤šä¸ªå°blockè€Œæ— æ³•fitï¼Œè¿™å°±æ˜¯ç¢ç‰‡é—®é¢˜ã€‚\nä¸€ä¸ªç®€å•çš„è§£å†³æ–¹å¼æ—¶å½“freeæŸä¸ªblockæ—¶ï¼Œå¦‚æœå‘ç°å®ƒç›¸é‚»çš„blockä¹Ÿæ˜¯freeçš„ï¼Œåˆ™å°†blockå’Œç›¸é‚»blockåˆå¹¶ã€‚ä¸ºäº†æ»¡è¶³è¿™ä¸ªå®ç°ï¼Œéœ€è¦å°†s_blockæ”¹ä¸ºåŒå‘é“¾è¡¨ã€‚ä¿®æ”¹åçš„blockç»“æ„å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10  typedef struct s_block *t_block; struct s_block { size_t size; /* æ•°æ®åŒºå¤§å° */ t_block prev; /* æŒ‡å‘ä¸Šä¸ªå—çš„æŒ‡é’ˆ */ t_block next; /* æŒ‡å‘ä¸‹ä¸ªå—çš„æŒ‡é’ˆ */ int free; /* æ˜¯å¦æ˜¯ç©ºé—²å— */ int padding; /* å¡«å……4å­—èŠ‚ï¼Œä¿è¯metaå—é•¿åº¦ä¸º8çš„å€æ•° */ void *ptr; /* Magic pointerï¼ŒæŒ‡å‘data */ char data[1] /* è¿™æ˜¯ä¸€ä¸ªè™šæ‹Ÿå­—æ®µï¼Œè¡¨ç¤ºæ•°æ®å—çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œé•¿åº¦ä¸åº”è®¡å…¥meta */ };   åˆå¹¶æ–¹æ³•å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9  t_block fusion(t_block b) { if (b-\u0026gt;next \u0026amp;\u0026amp; b-\u0026gt;next-\u0026gt;free) { b-\u0026gt;size += BLOCK_SIZE + b-\u0026gt;next-\u0026gt;size; b-\u0026gt;next = b-\u0026gt;next-\u0026gt;next; if(b-\u0026gt;next) b-\u0026gt;next-\u0026gt;prev = b; } return b; }   æœ‰äº†ä¸Šè¿°æ–¹æ³•ï¼Œfreeçš„å®ç°æ€è·¯å°±æ¯”è¾ƒæ¸…æ™°äº†ï¼šé¦–å…ˆæ£€æŸ¥å‚æ•°åœ°å€çš„åˆæ³•æ€§ï¼Œå¦‚æœä¸åˆæ³•åˆ™ä¸åšä»»ä½•äº‹ï¼›å¦åˆ™ï¼Œå°†æ­¤blockçš„freeæ ‡ä¸º1ï¼Œå¹¶ä¸”åœ¨å¯ä»¥çš„æƒ…å†µä¸‹ä¸åé¢çš„blockè¿›è¡Œåˆå¹¶ã€‚å¦‚æœå½“å‰æ˜¯æœ€åä¸€ä¸ªblockï¼Œåˆ™å›é€€breakæŒ‡é’ˆé‡Šæ”¾è¿›ç¨‹å†…å­˜ï¼Œå¦‚æœå½“å‰blockæ˜¯æœ€åä¸€ä¸ªblockï¼Œåˆ™å›é€€breakæŒ‡é’ˆå¹¶è®¾ç½®first_blockä¸ºNULLã€‚å®ç°å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  void free(void *p) { t_block b; if(valid_addr(p)) { b = get_block(p); b-\u0026gt;free = 1; if(b-\u0026gt;prev \u0026amp;\u0026amp; b-\u0026gt;prev-\u0026gt;free) b = fusion(b-\u0026gt;prev); if(b-\u0026gt;next) fusion(b); else { if(b-\u0026gt;prev) b-\u0026gt;prev-\u0026gt;prev = NULL; else first_block = NULL; brk(b); } } }   reallocçš„å®ç° ä¸ºäº†å®ç°reallocï¼Œæˆ‘ä»¬é¦–å…ˆè¦å®ç°ä¸€ä¸ªå†…å­˜å¤åˆ¶æ–¹æ³•ã€‚å¦‚åŒcallocä¸€æ ·ï¼Œä¸ºäº†æ•ˆç‡ï¼Œæˆ‘ä»¬ä»¥8å­—èŠ‚ä¸ºå•ä½è¿›è¡Œå¤åˆ¶ï¼š\n1 2 3 4 5 6 7 8  void copy_block(t_block src, t_block dst) { size_t *sdata, *ddata; size_t i; sdata = src-\u0026gt;ptr; ddata = dst-\u0026gt;ptr; for(i = 0; (i * 8) \u0026lt; src-\u0026gt;size \u0026amp;\u0026amp; (i * 8) \u0026lt; dst-\u0026gt;size; i++) ddata[i] = sdata[i]; }   ç„¶åæˆ‘ä»¬å¼€å§‹å®ç°reallocã€‚ä¸€ä¸ªç®€å•ï¼ˆä½†æ˜¯ä½æ•ˆï¼‰çš„æ–¹æ³•æ˜¯mallocä¸€æ®µå†…å­˜ï¼Œç„¶åå°†æ•°æ®å¤åˆ¶è¿‡å»ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åšçš„æ›´é«˜æ•ˆï¼Œå…·ä½“å¯ä»¥è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š\n å¦‚æœå½“å‰blockçš„æ•°æ®åŒºå¤§äºç­‰äºreallocæ‰€è¦æ±‚çš„sizeï¼Œåˆ™ä¸åšä»»ä½•æ“ä½œ å¦‚æœæ–°çš„sizeå˜å°äº†ï¼Œè€ƒè™‘split å¦‚æœå½“å‰blockçš„æ•°æ®åŒºä¸èƒ½æ»¡è¶³sizeï¼Œä½†æ˜¯å…¶åç»§blockæ˜¯freeçš„ï¼Œå¹¶ä¸”åˆå¹¶åå¯ä»¥æ»¡è¶³ï¼Œåˆ™è€ƒè™‘åšåˆå¹¶  ä¸‹é¢æ˜¯reallocçš„å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  void *realloc(void *p, size_t size) { size_t s; t_block b, new; void *newp; if (!p) /* æ ¹æ®æ ‡å‡†åº“æ–‡æ¡£ï¼Œå½“pä¼ å…¥NULLæ—¶ï¼Œç›¸å½“äºè°ƒç”¨malloc */ return malloc(size); if(valid_addr(p)) { s = align8(size); b = get_block(p); if(b-\u0026gt;size \u0026gt;= s) { if(b-\u0026gt;size - s \u0026gt;= (BLOCK_SIZE + 8)) split_block(b,s); } else { /* çœ‹æ˜¯å¦å¯è¿›è¡Œåˆå¹¶ */ if(b-\u0026gt;next \u0026amp;\u0026amp; b-\u0026gt;next-\u0026gt;free \u0026amp;\u0026amp; (b-\u0026gt;size + BLOCK_SIZE + b-\u0026gt;next-\u0026gt;size) \u0026gt;= s) { fusion(b); if(b-\u0026gt;size - s \u0026gt;= (BLOCK_SIZE + 8)) split_block(b, s); } else { /* æ–°malloc */ newp = malloc (s); if (!newp) return NULL; new = get_block(newp); copy_block(b, new); free(p); return(newp); } } return (p); } return NULL; }   é—ç•™é—®é¢˜å’Œä¼˜åŒ– ä»¥ä¸Šæ˜¯ä¸€ä¸ªè¾ƒä¸ºç®€é™‹ï¼Œä½†æ˜¯åˆæ­¥å¯ç”¨çš„mallocå®ç°ã€‚è¿˜æœ‰å¾ˆå¤šé—ç•™çš„å¯èƒ½ä¼˜åŒ–ç‚¹ï¼Œä¾‹å¦‚ï¼š\n åŒæ—¶å…¼å®¹32ä½å’Œ64ä½ç³»ç»Ÿ åœ¨åˆ†é…è¾ƒå¤§å¿«å†…å­˜æ—¶ï¼Œè€ƒè™‘ä½¿ç”¨mmapè€Œésbrkï¼Œè¿™é€šå¸¸æ›´é«˜æ•ˆ å¯ä»¥è€ƒè™‘ç»´æŠ¤å¤šä¸ªé“¾è¡¨è€Œéå•ä¸ªï¼Œæ¯ä¸ªé“¾è¡¨ä¸­çš„blockå¤§å°å‡ä¸ºä¸€ä¸ªèŒƒå›´å†…ï¼Œä¾‹å¦‚8å­—èŠ‚é“¾è¡¨ã€16å­—èŠ‚é“¾è¡¨ã€24-32å­—èŠ‚é“¾è¡¨ç­‰ç­‰ã€‚æ­¤æ—¶å¯ä»¥æ ¹æ®sizeåˆ°å¯¹åº”é“¾è¡¨ä¸­åšåˆ†é…ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘ç¢ç‰‡ï¼Œå¹¶æé«˜æŸ¥è¯¢blockçš„é€Ÿåº¦ å¯ä»¥è€ƒè™‘é“¾è¡¨ä¸­åªå­˜æ”¾freeçš„blockï¼Œè€Œä¸å­˜æ”¾å·²åˆ†é…çš„blockï¼Œå¯ä»¥å‡å°‘æŸ¥æ‰¾blockçš„æ¬¡æ•°ï¼Œæé«˜æ•ˆç‡  å‚è€ƒï¼š\n åå››. malloc\u0026amp;freeçš„å®ç° å¦‚ä½•å®ç°ä¸€ä¸ªmalloc brk(ï¼‰å’Œsbrk()å‡½æ•°çš„ä½¿ç”¨  mmap() åˆ›å»ºè¿›ç¨‹æ—¶ï¼Œå»ºç«‹è™šå­˜ç©ºé—´å’Œå…·ä½“æ–‡ä»¶ä¹‹é—´çš„æ˜ å°„ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯å»ºç«‹æ˜ å°„çš„è¿‡ç¨‹ä¸­å®Œæˆå¾ˆå¤šå¤æ‚çš„éœ€æ±‚ï¼Œæ¯”å¦‚ç”¨å‡½æ•°æŒ‡é’ˆæ¥ç»‘å®šä¸€äº›å¯¹é¡µé¢çš„æ“ä½œã€‚è¿™ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨çš„å®ç°è¿‡ç¨‹å…¶å®å¹¶ä¸ç®€å•ï¼Œéå¸¸å€¼å¾—ç ”ç©¶ï¼Œå…·ä½“è¿˜æ˜¯å‚çœ‹ä¹¦ç±ã€‚\nç»“è®º\n1ï¼‰å½“å¼€è¾Ÿçš„ç©ºé—´å°äº 128K æ—¶ï¼Œè°ƒç”¨ brkï¼ˆï¼‰å‡½æ•°ï¼Œmalloc çš„åº•å±‚å®ç°æ˜¯ç³»ç»Ÿè°ƒç”¨å‡½æ•° brkï¼ˆï¼‰ï¼Œå…¶ä¸»è¦ç§»åŠ¨æŒ‡é’ˆ _enddata(æ­¤æ—¶çš„ _enddata æŒ‡çš„æ˜¯ Linux åœ°å€ç©ºé—´ä¸­å †æ®µçš„æœ«å°¾åœ°å€ï¼Œä¸æ˜¯æ•°æ®æ®µçš„æœ«å°¾åœ°å€)\n2ï¼‰å½“å¼€è¾Ÿçš„ç©ºé—´å¤§äº 128K æ—¶ï¼Œmmapï¼ˆï¼‰ç³»ç»Ÿè°ƒç”¨å‡½æ•°æ¥åœ¨è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ï¼ˆå †å’Œæ ˆä¸­é—´ï¼Œç§°ä¸ºâ€œæ–‡ä»¶æ˜ å°„åŒºåŸŸâ€çš„åœ°æ–¹ï¼‰æ‰¾ä¸€å—ç©ºé—´æ¥å¼€è¾Ÿã€‚\nå‚è€ƒï¼šmalloc åº•å±‚å®ç°åŠåŸç†\nå†…å­˜ç®¡ç†çš„æœ¬è´¨ å¯¹äºç¤¾ä¼šæ¥è®²ï¼Œâ€œç®¡ç†â€æ˜¯äººç±»å‘å±•åˆ°ä¸€å®šé˜¶æ®µæ‰äº§ç”Ÿçš„ã€‚æ‹¿æ—¶ä¸‹æœ€ç–¯ç‹‚çš„ä¸€ä»¶äº‹â€œä¹°æˆ¿â€æ¥ä¸¾ä¾‹ï¼Œå½“æˆ‘æŠµä¸Šæœªæ¥20å¹´çš„é’æ˜¥ä¹°åˆ°ä¸€å¥—æˆ¿å­åï¼Œå¹¶ä¸æ˜¯å°†æˆ¿å­ä»åœ°ä¸ŠæŒ–èµ·æ¥é€åˆ°æˆ‘é¢å‰ï¼Œè€Œåªæ˜¯åœ¨åˆæ³•éƒ¨é—¨å°†æˆ¿å­çš„æ‰€å±æƒè·Ÿæˆ‘çš„**å·å…³è”èµ·æ¥ï¼Œæˆ‘å°±æœ‰æƒä½è¿›è¿™ä¸ªæˆ¿å­äº†ã€‚è…¿é•¿åœ¨æˆ‘è‡ªå·±èº«ä¸Šï¼ŒæŒ‰é“ç†æˆ‘æƒ³è¿›è°çš„æˆ¿å­å°±è¿›è°çš„æˆ¿å­å‘€ï¼Œä½†é™¤éæ˜¯åœ¨åŸå§‹ç¤¾ä¼šï¼Œåœ¨æœ‰äº†â€œç®¡ç†â€çš„å½“ä»Šç¤¾ä¼šï¼Œä¹±è·‘å°±ä¼šè¢«æŠ“èµ·æ¥ï¼åŸå§‹ç¤¾ä¼šåªç”Ÿæ´»ç€ä¸€ä¸ªæˆ–å°‘é‡çŒ¿çŒ´ï¼ˆéœ€\u0026laquo;æ±‚ï¼‰ï¼Œéšä¾¿æ‰¾ä¸ªæ´ç©´å°±æ˜¯æˆ¿å­ï¼Œä¸€æ–‡ä¸å€¼ï¼ŒçŒ¿çŒ´ä¸ä¼šå› ä¸ºæˆ¿å­è€Œå‘ç”Ÿå†²çªï¼Œæ‰€ä»¥æ‰ä¸éœ€è¦ç®¡ç†ã€‚\nå¯¹è®¡ç®—æœºæ¥è®²ï¼Œä»åŠ ç”µåˆ°å¯åŠ¨å®Œæˆï¼Œä¹Ÿç»å†äº†â€œåŸå§‹ç¤¾ä¼šâ€åˆ°â€œå½“ä»Šç¤¾ä¼šâ€çš„è¿‡ç¨‹ï¼Œå³â€œå®æ¨¡å¼â†’ä¿æŠ¤æ¨¡å¼â€ï¼Œå®æ¨¡å¼æ—¶åªæœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªå·´æŒæ‹ä¸å“ï¼Œæ‰€ä»¥ä¸æ‹…å¿ƒå¹²æ‰°ï¼Œåªç®¡ä¸ºè¿›å…¥ä¿æŠ¤æ¨¡å¼ä½œå¥½å‡†å¤‡ï¼Œå¹¶åˆ‡æ¢åˆ°ä¿æŠ¤æ¨¡å¼ã€‚ä¸€æ—¦è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼Œå®é™…ä¸Šå°±æ˜¯å¯åŠ¨ä¸€äº›é˜²æ­¢ç›¸äº’å¹²æ‰°çš„â€œç®¡ç†â€ï¼Œå…¶ä¸­å†…å­˜ç®¡ç†å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œä»è€Œå¤šä¸ªè¿›ç¨‹æ‰èƒ½å’Œè°å…±å¤„ã€‚\nå†…æ ¸è¦ä¿è¯å„ä¸ªè¿›ç¨‹å¯¹ç‰©ç†å†…å­˜ï¼ˆç³»ç»ŸèŒƒå›´å”¯ä¸€ï¼‰çš„ä½¿ç”¨ä¸å‘ç”Ÿå¹²æ‰°ï¼Œä¹Ÿè¦ä¿è¯æ¯ä¸ªè¿›ç¨‹ä¸­ä¸åŒçš„ç¨‹åºç‰‡æ®µå¯¹è™šæ‹Ÿå†…å­˜ï¼ˆè¿›ç¨‹èŒƒå›´å”¯ä¸€ï¼‰çš„ä½¿ç”¨ä¸å‘ç”Ÿå¹²æ‰°ï¼š\nâ‘  æ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„æ˜ å°„å…³ç³»è¡¨ï¼Œå†…æ ¸çš„è§†é‡èƒ½çœ‹è§ç³»ç»Ÿæ‰€æœ‰è¿›ç¨‹ï¼Œè‡ªç„¶ä¹Ÿèƒ½ä¿è¯å„ä¸ªè¿›ç¨‹å¯¹ç‰©ç†é¡µé¢çš„ä½¿ç”¨ä¸å†²çªã€‚\nâ‘¡ ç¨‹åºä¸­çš„å…¨å±€å˜é‡ã€staticå˜é‡ã€å‡½æ•°åç­‰ï¼Œç”±ç¼–è¯‘å™¨å®‰æ’ä¸å†²çªçš„è™šæ‹Ÿåœ°å€ï¼ŒåŠ¨æ€åˆ†é…/é‡Šæ”¾æ—¶ï¼Œå¯¹è™šæ‹Ÿé¡µé¢çš„ä½¿ç”¨éƒ½å»ºç«‹è®°å½•ä¿¡æ¯ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šå‘ç”Ÿå†²çªã€‚\næ‰€ä»¥å†…å­˜ç®¡ç†çš„æœ¬è´¨å°±æ˜¯ä¸ºé˜²æ­¢å¹²æ‰°ã€æ•ˆç‡ã€æ¢å…¥æ¢å‡ºç­‰å»ºç«‹è®°å½•ä¿¡æ¯ï¼Œå¹¶åˆ©ç”¨è¿™äº›ä¿¡æ¯è¾¾åˆ°ç›¸åº”çš„ç›®çš„ã€‚\nä»¥ä¸‹å°±æ˜¯åˆ†é…å†…å­˜æ—¶ï¼Œå»ºç«‹ç®¡ç†ä¿¡æ¯çš„å¤§è‡´ç¤ºæ„å›¾ï¼š\n  brk()\nä»ä¸Šå›¾ä¹Ÿå¯ä»¥çœ‹å‡ºLinuxå¯¹è™šæ‹Ÿç©ºé—´çš„ä½¿ç”¨å®‰æ’ï¼Œbrk()å°±æ˜¯æ“ä½œåŠ¨æ€åˆ†é…åŒºé—´çš„è™šæ‹Ÿåœ°å€ï¼ˆåˆ†é…/é‡Šæ”¾ï¼‰ã€‚glibcåº“ä¸­çš„malloc()å‡½æ•°ï¼Œå°±æ˜¯ç”¨brk()ç³»ç»Ÿè°ƒç”¨åˆ†é…/é‡Šæ”¾è™šæ‹Ÿé¡µé¢ã€‚\næ³¨æ„ï¼š\nchar *p = malloc(); // ä¸èƒ½free(p+1)\nbrk()å¾—åˆ°çš„ä¸€ä¸ªè™šæ‹Ÿåœ°å€åŒºé—´ï¼ˆå›¾ä¸­ç°è‰²åŒºåŸŸï¼Œç”¨vm_area_structç»“æ„è¡¨ç¤ºï¼‰ï¼Œå¯ä»¥é‡Šæ”¾å½“ä¸­ä¸€éƒ¨åˆ†ï¼Œè€Œè£‚ä¸ºä¸¤ä¸ªåŒºåŸŸ\n  Linuxç¼“å†²åŒºğŸƒ linuxä¸­æœ‰ä¸¤ä¸ªçº§åˆ«çš„ç¼“å†²ï¼šIOç¼“å†²ä¸å†…æ ¸ç¼“å†²\nï¼ˆ1ï¼‰IOç¼“å†²:å¯¹äºæ ‡å‡†IOæ“ä½œï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªç¼“å†²åŒºï¼Œå½“ç”¨æˆ·æƒ³è¦å†™æ•°æ®æ—¶ï¼Œé¦–å…ˆå°†æ•°æ®å†™å…¥ç¼“å†²åŒºï¼Œå¾…ç¼“å†²åŒºæ»¡ä¹‹åæ‰èƒ½è°ƒç”¨ç³»ç»Ÿå‡½æ•°å†™å…¥å†…æ ¸ç¼“å†²åŒºã€‚å½“ç”¨æˆ·æƒ³è¯»å–æ•°æ®æ—¶ï¼Œé¦–å…ˆå‘å†…æ ¸è¯»å–ä¸€å®šçš„æ•°æ®æ”¾å…¥IOç¼“å†²åŒºï¼Œè¯»æ“ä½œä»ç¼“å†²åŒºä¸­è¯»æ•°æ®ï¼Œå½“è¯»å®ŒIOç¼“å†²åŒºçš„æ•°æ®æ—¶ï¼Œæ‰èƒ½å†è¯»å–æ•°æ®åˆ°IOç¼“å†²åŒºã€‚\nç›®çš„ï¼šå‡å°‘å¯¹ç£ç›˜çš„è¯»å†™æ¬¡æ•°ï¼Œæé«˜å·¥ä½œæ•ˆç‡ã€‚\nï¼ˆ2ï¼‰å†…æ ¸ç¼“å†²åŒº:æ“ä½œç³»ç»Ÿå†…æ ¸éƒ¨åˆ†ä¹Ÿæœ‰ç¼“å†²ï¼Œå…¶ä¸IOç¼“å†²åŒºæ˜¯ä¸åŒçš„ï¼Œå…¶ä¸»è¦åŒºåˆ«ç”¨ä¸€å¼ å›¾è¡¨ç¤ºï¼š\n æ“ä½œç³»ç»Ÿï¼ˆå†…æ ¸ï¼‰å…ˆä»ç£ç›˜è¯»å–æ•°æ®åˆ°å†…æ ¸ç©ºé—´çš„å†…å­˜ï¼ˆreadâ‘ ï¼‰ï¼Œå†æŠŠæ•°æ®ä»å†…æ ¸ç©ºé—´å†…å­˜æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´å†…å­˜ï¼ˆreadâ‘¡ï¼‰ã€‚æ­¤åï¼Œç”¨æˆ·åº”ç”¨ç¨‹åºæ‰å¯ä»¥æ“ä½œæ­¤æ•°æ®ã€‚  é‚£ä¹ˆå†…æ ¸ç¼“å†²åšäº†ä»€ä¹ˆäº‹æƒ…å‘¢ï¼Ÿ\n è¯»ï¼šæ•°æ®é¢„è¯» å†™ï¼šå»¶æ—¶å›å†™  å‚è€ƒé“¾æ¥ï¼š\n https://github.com/raxxarr/note/issues/2  ä»€ä¹ˆæ˜¯RPC RPCæ˜¯æŒ‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤å°æœåŠ¡å™¨Aï¼ŒBï¼Œä¸€ä¸ªåº”ç”¨éƒ¨ç½²åœ¨AæœåŠ¡å™¨ä¸Šï¼Œæƒ³è¦è°ƒç”¨BæœåŠ¡å™¨ä¸Šåº”ç”¨æä¾›çš„å‡½æ•°/æ–¹æ³•ï¼Œç”±äºä¸åœ¨ä¸€ä¸ªå†…å­˜ç©ºé—´ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œæ¥è¡¨è¾¾è°ƒç”¨çš„è¯­ä¹‰å’Œä¼ è¾¾è°ƒç”¨çš„æ•°æ®ã€‚\nå‚è€ƒï¼š\n ä»€ä¹ˆæ˜¯RPC? ä¸ºä»€ä¹ˆè¦ç”¨RPCï¼Ÿ ä»€ä¹ˆæ˜¯RPCï¼Ÿ  çº¿ç¨‹åŒæ­¥çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ  äº’æ–¥é‡ï¼šé‡‡ç”¨äº’æ–¥å¯¹è±¡æœºåˆ¶ï¼Œåªæœ‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹æ‰æœ‰è®¿é—®å…¬å…±èµ„æºçš„æƒé™ã€‚å› ä¸ºäº’æ–¥å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯å…¬å…±èµ„æºä¸ä¼šè¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ã€‚ ä¿¡å·é‡ï¼šå®ƒå…è®¸åŒä¸€æ—¶åˆ»å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€èµ„æºï¼Œä½†æ˜¯éœ€è¦æ§åˆ¶åŒä¸€æ—¶åˆ»è®¿é—®æ­¤èµ„æºçš„æœ€å¤§çº¿ç¨‹æ•°é‡ã€‚ äº‹ä»¶ï¼ˆä¿¡å·ï¼‰ï¼šé€šè¿‡é€šçŸ¥æ“ä½œçš„æ–¹å¼æ¥ä¿æŒå¤šçº¿ç¨‹åŒæ­¥ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿çš„å®ç°å¤šçº¿ç¨‹ä¼˜å…ˆçº§çš„æ¯”è¾ƒæ“ä½œã€‚  ä¸­æ–­å’Œè½®è¯¢çš„ç‰¹ç‚¹? å¯¹I/Oè®¾å¤‡çš„ç¨‹åºè½®è¯¢çš„æ–¹å¼ï¼Œæ˜¯æ—©æœŸçš„è®¡ç®—æœºç³»ç»Ÿå¯¹I/Oè®¾å¤‡çš„ä¸€ç§ç®¡ç†æ–¹å¼ã€‚å®ƒå®šæ—¶å¯¹å„ç§è®¾å¤‡è½®æµè¯¢é—®ä¸€éæœ‰æ— å¤„ç†è¦æ±‚ã€‚è½®æµè¯¢é—®ä¹‹åï¼Œæœ‰è¦æ±‚çš„ï¼Œåˆ™åŠ ä»¥å¤„ç†ã€‚åœ¨å¤„ç†I/Oè®¾å¤‡çš„è¦æ±‚ä¹‹åï¼Œå¤„ç†æœºè¿”å›ç»§ç»­å·¥ä½œã€‚å°½ç®¡è½®è¯¢éœ€è¦æ—¶é—´ï¼Œä½†è½®è¯¢è¦æ¯”I/Oè®¾å¤‡çš„é€Ÿåº¦è¦å¿«å¾—å¤šï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šå‘ç”Ÿä¸èƒ½åŠæ—¶å¤„ç†çš„é—®é¢˜ã€‚å½“ç„¶ï¼Œå†å¿«çš„å¤„ç†æœºï¼Œèƒ½å¤„ç†çš„è¾“å…¥è¾“å‡ºè®¾å¤‡çš„æ•°é‡ä¹Ÿæ˜¯æœ‰ä¸€å®šé™åº¦çš„ã€‚è€Œä¸”ï¼Œç¨‹åºè½®è¯¢æ¯•ç«Ÿå æ®äº†CPUç›¸å½“ä¸€éƒ¨åˆ†å¤„ç†æ—¶é—´ï¼Œå› æ­¤ï¼Œç¨‹åºè½®è¯¢æ˜¯ä¸€ç§æ•ˆç‡è¾ƒä½çš„æ–¹å¼ï¼Œåœ¨ç°ä»£è®¡ç®—æœºç³»ç»Ÿä¸­å·²å¾ˆå°‘åº”ç”¨ã€‚\nã€€ç¨‹åºä¸­æ–­é€šå¸¸ç®€ç§°ä¸­æ–­ï¼Œæ˜¯æŒ‡CPUåœ¨æ­£å¸¸è¿è¡Œç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œç”±äºé¢„å…ˆå®‰æ’æˆ–å‘ç”Ÿäº†å„ç§éšæœºçš„å†…éƒ¨æˆ–å¤–éƒ¨äº‹ä»¶ï¼Œä½¿CPUä¸­æ–­æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œè€Œè½¬åˆ°ä¸ºå“åº”çš„æœåŠ¡ç¨‹åºå»å¤„ç†ã€‚\nã€€è½®è¯¢â€”â€”æ•ˆç‡ä½ï¼Œç­‰å¾…æ—¶é—´å¾ˆé•¿ï¼ŒCPUåˆ©ç”¨ç‡ä¸é«˜ã€‚\nã€€ä¸­æ–­â€”â€”å®¹æ˜“é—æ¼ä¸€äº›é—®é¢˜ï¼ŒCPUåˆ©ç”¨ç‡é«˜\nè¾“å…¥ä¸è¾“å‡º è®¾å¤‡\n  å—è®¾å¤‡\nå—è®¾å¤‡å­˜å‚¨åœ¨å›ºå®šå¤§å°çš„å—ä¸­ï¼Œæ¯ä¸ªå—æœ‰è‡ªå·±çš„åœ°å€ã€‚å—è®¾å¤‡çš„åŸºæœ¬ç‰¹å¾æ˜¯æ¯ä¸ªå—éƒ½èƒ½ç‹¬ç«‹äºå…¶ä»–å—è€Œè¯»å†™ã€‚ç¡¬ç›˜ã€CD-ROM å’Œ USB ç›˜æ˜¯æœ€å¸¸è§çš„å—è®¾å¤‡ã€‚\n  å­—ç¬¦è®¾å¤‡\nå­—ç¬¦è®¾å¤‡ä»¥å­—ç¬¦ä¸ºå•ä½å‘é€æˆ–æ¥æ”¶ä¸€ä¸ªå­—ç¬¦æµï¼Œè€Œä¸è€ƒè™‘ä»»ä½•å—ç»“æ„ã€‚å­—ç¬¦è®¾å¤‡æ˜¯ä¸å¯å¯»å€çš„ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•å¯»é“æ“ä½œã€‚æ‰“å°æœºã€ç½‘ç»œæ¥å£ã€é¼ æ ‡ï¼Œä»¥åŠå¤§å¤šæ•°ä¸ç£ç›˜ä¸åŒçš„è®¾å¤‡éƒ½å¯çœ‹ä½œæ˜¯å­—ç¬¦è®¾å¤‡ã€‚\n  IOæ§åˆ¶æ–¹å¼\n  ç¨‹åºç›´æ¥æ§åˆ¶æ–¹å¼ã€‚è®¡ç®—æœºä»å¤–éƒ¨è®¾å¤‡è¯»å–æ•°æ®åˆ°å­˜å‚¨å™¨ï¼Œæ¯æ¬¡è¯»ä¸€ä¸ªå­—çš„æ•°æ®ã€‚å¯¹è¯»å…¥çš„æ¯ä¸ªå­—ï¼ŒCPU éœ€è¦å¯¹å¤–è®¾çŠ¶æ€è¿›è¡Œå¾ªç¯æ£€æŸ¥çŸ¥é“ç¡®å®šè¯¥å­—å·²ç»åœ¨ I/O æ§åˆ¶å™¨çš„æ•°æ®å¯„å­˜å™¨ä¸­ã€‚\n  ä¸­æ–­é©±åŠ¨æ–¹å¼ã€‚å…è®¸ I/O è®¾å¤‡ä¸»åŠ¨æ‰“æ–­ CPU çš„è¿è¡Œå¹¶è¯·æ±‚æœåŠ¡ï¼Œä»è€Œâ€œè§£æ”¾â€ CPUï¼Œä½¿å¾—å…¶å‘ I/O æ§åˆ¶å™¨å‘é€è¯»å‘½ä»¤åå¯ä»¥ç»§ç»­åšå…¶ä»–æœ‰ç”¨çš„å·¥ä½œã€‚\n  DMA æ–¹å¼ã€‚DMA(ç›´æ¥å­˜å‚¨å™¨)æ–¹å¼çš„åŸºæœ¬æ€æƒ³æ˜¯åœ¨ I/O è®¾å¤‡å’Œå†…å­˜ä¹‹é—´å¼€è¾Ÿç›´æ¥çš„æ•°æ®äº¤æ¢é€šè·¯ï¼Œå½»åº•â€œè§£æ”¾â€ CPUã€‚DMAç‰¹ç‚¹å¦‚ä¸‹ï¼šï¼ˆ1ï¼‰åŸºæœ¬å•ä½æ˜¯æ•°æ®å— ï¼ˆ2ï¼‰æ‰€ä¼ é€çš„æ•°æ®ï¼Œæ˜¯ä»è®¾å¤‡ç›´æ¥é€å…¥å†…å­˜çš„ï¼Œæˆ–è€…ç›¸å ï¼ˆ3ï¼‰ä»…åœ¨ä¼ é€ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®å—çš„å¼€å§‹å’Œç»“æŸæ—¶ï¼Œæ‰éœ€ CPU å¹²é¢„ï¼Œæ•´å—æ•°æ®çš„ä¼ é€æ˜¯åœ¨ DMA æ§åˆ¶å™¨çš„æ§åˆ¶ä¸‹å®Œæˆçš„ã€‚\nä¸ºäº†åœ¨ä¸»æœºä¸æ§åˆ¶å™¨ä¹‹é—´å®ç°æˆå—æ•°æ®çš„ç›´æ¥äº¤æ¢ï¼Œå¿…é¡»åœ¨ DMA æ§åˆ¶å™¨ä¸­è®¾ç½®å¦‚ä¸‹4ç±»å¯„å­˜å™¨ï¼š\n å‘½ä»¤/çŠ¶æ€å¯„å­˜å™¨ï¼ˆCRï¼‰ã€‚ç”¨äºæ¥æ”¶ä» CPU å‘æ¥çš„ I/O å‘½ä»¤æˆ–æœ‰å…³æ§åˆ¶ä¿¡æ¯ï¼Œæˆ–è®¾å¤‡çš„çŠ¶æ€ã€‚ å†…å­˜åœ°å€å¯„å­˜å™¨ï¼ˆMARï¼‰ã€‚åœ¨è¾“å…¥æ—¶ï¼Œå®ƒå­˜æ”¾æŠŠæ•°æ®ä»è®¾å¤‡ä¼ é€åˆ°å†…å­˜çš„èµ·å§‹ç›®æ ‡åœ°å€ï¼›åœ¨è¾“å‡ºæ—¶ï¼Œå®ƒå­˜æ”¾ç”±å†…å­˜åˆ°è®¾å¤‡çš„å†…å­˜æºåœ°å€ã€‚ æ•°æ®å¯„å­˜å™¨ï¼ˆDRï¼‰ã€‚ç”¨äºæš‚å­˜ä»è®¾å¤‡åˆ°å†…å­˜æˆ–ä»å†…å­˜åˆ°è®¾å¤‡çš„æ•°æ®ã€‚ æ•°æ®è®¡æ•°å™¨ï¼ˆDCï¼‰ã€‚å­˜æ”¾æœ¬æ¬¡è¦ä¼ é€çš„å­—ï¼ˆèŠ‚ï¼‰æ•°ã€‚    é€šé“æ§åˆ¶æ–¹å¼ã€‚I/O é€šé“æ˜¯æŒ‡ä¸“é—¨è´Ÿè´£è¾“å…¥/è¾“å‡ºçš„å¤„ç†æœºã€‚I/O é€šé“æ˜¯ DMA æ–¹å¼çš„å‘å±•,å®ƒå¯ä»¥è¿›ä¸€æ­¥å‡å°‘ CPU çš„å¹²é¢„ï¼Œå³æŠŠå¯¹ä¸€ä¸ªæ•°æ®å—çš„è¯»ï¼ˆæˆ–å†™ï¼‰ä¸ºå•ä½çš„å¹²é¢„ï¼Œå‡å°‘ä¸ºå¯¹ä¸€ç»„æ•°æ®å—çš„è¯»ï¼ˆæˆ–å†™ï¼‰åŠæœ‰å…³æ§åˆ¶å’Œç®¡ç†ä¸ºå•ä½çš„å¹²é¢„ã€‚I/O é€šé“ä¸ä¸€èˆ¬å¤„ç†æœºçš„åŒºåˆ«æ˜¯ï¼šé€šé“æŒ‡ä»¤çš„ç±»å‹å•ä¸€æ²¡æœ‰è‡ªå·±çš„å†…å­˜ï¼Œé€šé“æ‰€æ‰§è¡Œçš„é€šé“ç¨‹åºæ˜¯æ”¾åœ¨ä¸»æœºå†…å­˜ä¸­çš„ï¼Œä¹Ÿå°±æ˜¯è¯´é€šé“ä¸ CPU å…±äº«å†…å­˜ã€‚I/O é€šé“ä¸ DMA æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼šDMA æ–¹å¼éœ€è¦ CPU æ¥æ§åˆ¶ä¼ è¾“çš„æ•°æ®å—å¤§å°ã€ä¼ è¾“çš„å†…å­˜ä½ç½®ï¼Œè€Œé€šé“æ–¹å¼ä¸­è¿™äº›ä¿¡æ¯æ˜¯ç”±é€šé“æ§åˆ¶çš„ã€‚å¦å¤–ï¼Œæ¯ä¸ª DMA æ§åˆ¶å™¨å¯¹åº”ä¸€å°è®¾å¤‡ä¸å†…å­˜ä¼ é€’æ•°æ®ï¼Œè€Œä¸€ä¸ªé€šé“å¯ä»¥æ§åˆ¶å¤šå°è®¾å¤‡ä¸å†…å­˜çš„æ•°æ®äº¤æ¢ã€‚\n  IOç³»ç»Ÿå±‚æ¬¡ç»“æ„\nå„å±‚æ¬¡åŠå…¶åŠŸèƒ½å¦‚ä¸‹ï¼š\n ç”¨æˆ·å±‚ I/O è½¯ä»¶ã€‚å®ç°ä¸ç”¨æˆ·äº¤äº’çš„æ¥å£ï¼Œç”¨æˆ·å¯ç›´æ¥è°ƒç”¨åœ¨ç”¨æˆ·å±‚æä¾›çš„ã€ä¸ I/O æ“ä½œæœ‰å…³çš„åº“å‡½æ•°ï¼Œå¯¹è®¾å¤‡è¿›è¡Œæ“ä½œã€‚ è®¾å¤‡ç‹¬ç«‹æ€§è½¯ä»¶ã€‚ç”¨äºå®ç°ç”¨æˆ·ç¨‹åºä¸è®¾å¤‡é©±åŠ¨å™¨çš„ç»Ÿä¸€æ¥å£ã€è®¾å¤‡å‘½ä»¤ã€è®¾å¤‡ä¿æŠ¤åŠè®¾å¤‡åˆ†é…ä¸é‡Šæ”¾ç­‰ï¼ŒåŒæ—¶ä¸ºè®¾å¤‡ç®¡ç†å’Œæ•°æ®ä¼ é€æä¾›å¿…è¦çš„å­˜å‚¨ç©ºé—´ã€‚ è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚ä¸ç¡¬ä»¶ç›´æ¥ç›¸å…³ï¼Œè´Ÿè´£å…·ä½“å®ç°ç³»ç»Ÿå¯¹è®¾å¤‡å‘å‡ºçš„æ“ä½œæŒ‡ä»¤ï¼Œé©±åŠ¨ I/O è®¾å¤‡å·¥ä½œçš„é©±åŠ¨ç¨‹åºã€‚ ä¸­æ–­å¤„ç†ç¨‹åºã€‚ç”¨äºä¿æŠ¤è¢«ä¸­æ–­è¿›ç¨‹çš„ CPU ç¯å¢ƒï¼Œè½¬å…¥ç›¸åº”çš„ä¸­æ–­å¤„ç†ç¨‹åºè¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œå¹¶æ¢å¤è¢«ä¸­æ–­è¿›ç¨‹çš„ç°åœºåï¼Œè¿”å›åˆ°è¢«ä¸­æ–­ç¨‹åºã€‚ ç¡¬ä»¶è®¾å¤‡ã€‚I/O è®¾å¤‡é€šå¸¸åŒ…æ‹¬ä¸€ä¸ªæœºæ¢°éƒ¨ä»¶å’Œä¸€ä¸ªç”µå­éƒ¨ä»¶ã€‚ä¸ºäº†è¾¾åˆ°è®¾è®¡çš„æ¨¡å—æ€§å’Œé€šç”¨æ€§ï¼Œä¸€èˆ¬å°†å…¶åˆ†å¼€ï¼šç”µå­éƒ¨ä»¶ç§°ä¸ºè®¾å¤‡æ§åˆ¶å™¨ï¼ˆæˆ–é€‚é…å™¨ï¼‰ï¼Œåœ¨ä¸ªäººè®¡ç®—æœºä¸­ï¼Œé€šå¸¸æ˜¯ä¸€å—æ’å…¥ä¸»æ¿æ‰©å……æ§½çš„å°åˆ¶ç”µè·¯æ¿ï¼›æœºæ¢°éƒ¨ä»¶åˆ™æ˜¯è®¾å¤‡æœ¬èº«ã€‚  å‚è€ƒ:\n https://github.com/jx453331958/blog/issues/17 ã€æ“ä½œç³»ç»Ÿã€‘ è¾“å…¥/è¾“å‡ºï¼ˆI/Oï¼‰ç®¡ç†  ","description":"","id":17,"section":"talks","tags":[""],"title":"interview","uri":"https://hugo.jiahongw.com/zh/talks/interview/"},{"content":"æ ‘æ˜¯ä¸€ç§éå¸¸å®ç”¨çš„ç»“æ„ï¼ğŸŒ´\nä»¥ä¸‹çš„äºŒå‰æ ‘é‡‡ç”¨çš„ç»“æ„éƒ½ä¸ºé“¾å¼ç»“æ„\n1 2 3 4 5  typedef struct BiTNode /* ç»“ç‚¹ç»“æ„ */ { int data; /* ç»“ç‚¹æ•°æ® */ struct BiTNode *lchild, *rchild; /* å·¦å³å­©å­æŒ‡é’ˆ */ } BiTNode, *BiTree;   1. äºŒå‰æ’åºæ ‘  äºŒå‰æ’åºæ ‘åˆç§°â€œäºŒå‰æŸ¥æ‰¾æ ‘â€ã€â€œäºŒå‰æœç´¢æ ‘â€ã€‚\n å®šä¹‰ æˆ–è€…æ˜¯ä¸€æ£µç©ºæ ‘ï¼Œæˆ–è€…æ˜¯å…·æœ‰ä¸‹åˆ—æ€§è´¨çš„äºŒå‰æ ‘ï¼š\n  è‹¥å®ƒçš„å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼›\n  è‹¥å®ƒçš„å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼›\n  å®ƒçš„å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æ’åºæ ‘ã€‚\n   ä¸­åºéå†äºŒå‰æ’åºæ ‘å¯å¾—åˆ°ä¸€ä¸ªä¾æ®å…³é”®å­—çš„æœ‰åºåºåˆ—ï¼Œä¸€ä¸ªæ— åºåºåˆ—å¯ä»¥é€šè¿‡æ„é€ ä¸€æ£µäºŒå‰æ’åºæ ‘å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ï¼Œæ„é€ æ ‘çš„è¿‡ç¨‹å³æ˜¯å¯¹æ— åºåºåˆ—è¿›è¡Œæ’åºçš„è¿‡ç¨‹ã€‚æ¯æ¬¡æ’å…¥çš„æ–°çš„ç»“ç‚¹éƒ½æ˜¯äºŒå‰æ’åºæ ‘ä¸Šæ–°çš„å¶å­ç»“ç‚¹ï¼Œåœ¨è¿›è¡Œæ’å…¥æ“ä½œæ—¶ï¼Œä¸å¿…ç§»åŠ¨å…¶å®ƒç»“ç‚¹ï¼Œåªéœ€æ”¹åŠ¨æŸä¸ªç»“ç‚¹çš„æŒ‡é’ˆï¼Œç”±ç©ºå˜ä¸ºéç©ºå³å¯ã€‚æœç´¢ã€æ’å…¥ã€åˆ é™¤çš„æ—¶é—´å¤æ‚åº¦ç­‰äºæ ‘é«˜ï¼ŒæœŸæœ›O(logn)ï¼Œæœ€åO(n)ï¼ˆæ•°åˆ—æœ‰åºï¼Œæ ‘é€€åŒ–æˆçº¿æ€§è¡¨ï¼Œå¦‚å³æ–œæ ‘ï¼‰ã€‚\n æŸ¥æ‰¾ç®—æ³• æŸ¥æ‰¾è¿‡ç¨‹ï¼š\n1.è‹¥bæ˜¯ç©ºæ ‘ï¼Œåˆ™æœç´¢å¤±è´¥ï¼Œå¦åˆ™ï¼š\n2.è‹¥xç­‰äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™æŸ¥æ‰¾æˆåŠŸï¼›å¦åˆ™ï¼š\n3.è‹¥xå°äºbçš„æ ¹èŠ‚ç‚¹çš„æ•°æ®åŸŸä¹‹å€¼ï¼Œåˆ™æœç´¢å·¦å­æ ‘ï¼›å¦åˆ™ï¼š\n4.æŸ¥æ‰¾å³å­æ ‘ã€‚\n5.è‹¥æŸ¥æ‰¾ä¸æˆåŠŸï¼Œ åˆ™æŒ‡é’ˆ p æŒ‡å‘æŸ¥æ‰¾è·¯å¾„ä¸Šè®¿é—®çš„æœ€åä¸€ä¸ªç»“ç‚¹å¹¶è¿”å›FALSE\næ’å…¥ç®—æ³• æ’å…¥è¿‡ç¨‹ï¼š\n  å…ˆè°ƒç”¨æŸ¥æ‰¾æ“ä½œå°†è¦æ’å…¥çš„å…³é”®å­—è¿›è¡Œæ¯”è¾ƒ\n  å¦‚æœåœ¨åŸæœ‰çš„äºŒå‰æ’åºæ ‘ä¸­æ²¡æœ‰è¦æ’å…¥çš„å…³é”®å­—ï¼Œåˆ™å°†å…³é”®å­—ä¸æŸ¥æ‰¾çš„ç»“ç‚¹pï¼ˆåœ¨æŸ¥æ‰¾æ“ä½œä¸­è¿”å›çš„ç»“ç‚¹ï¼‰çš„å€¼è¿›è¡Œæ¯”è¾ƒ\n  è‹¥pä¸ºç©ºï¼Œåˆ™æ’å…¥å…³é”®å­—èµ‹å€¼ç»™è¯¥èŠ‚ç‚¹ï¼›\n  è‹¥å°äºç»“ç‚¹pçš„å€¼ï¼Œåˆ™æ’å…¥å…³é”®å­—ä½œä¸ºç»“ç‚¹pçš„å·¦å­æ ‘ï¼›\n  è‹¥å¤§äºç»“ç‚¹pçš„å€¼ï¼Œåˆ™æ’å…¥å…³é”®å­—ä½œä¸ºç»“ç‚¹pçš„å³å­æ ‘ï¼›\n   æ¯æ¬¡éœ€è¦æ’å…¥çš„èŠ‚ç‚¹éƒ½ä¸ºå¶å­èŠ‚ç‚¹ã€‚\n åˆ é™¤ç®—æ³• åˆ å»ä¸€ä¸ªç»“ç‚¹ï¼Œåˆ†ä¸‰ç§æƒ…å†µè®¨è®ºï¼š\n  è‹¥*pç»“ç‚¹ä¸ºå¶å­ç»“ç‚¹ï¼Œå³PL(å·¦å­æ ‘)å’ŒPR(å³å­æ ‘)å‡ä¸ºç©ºæ ‘ã€‚ç”±äºåˆ å»å¶å­ç»“ç‚¹ä¸ç ´åæ•´æ£µæ ‘çš„ç»“æ„ï¼Œåˆ™åªéœ€ä¿®æ”¹å…¶åŒäº²ç»“ç‚¹çš„æŒ‡é’ˆå³å¯ã€‚\n  è‹¥pç»“ç‚¹åªæœ‰å·¦å­æ ‘PLæˆ–å³å­æ ‘PRï¼Œæ­¤æ—¶åªè¦ä»¤PLæˆ–PRç›´æ¥æˆä¸ºå…¶åŒäº²ç»“ç‚¹fçš„å·¦å­æ ‘ï¼ˆå½“pæ˜¯å·¦å­æ ‘ï¼‰æˆ–å³å­æ ‘ï¼ˆå½“pæ˜¯å³å­æ ‘ï¼‰å³å¯ï¼Œä½œæ­¤ä¿®æ”¹ä¹Ÿä¸ç ´åäºŒå‰æ’åºæ ‘çš„ç‰¹æ€§ã€‚\n  è‹¥pç»“ç‚¹çš„å·¦å­æ ‘å’Œå³ å­æ ‘å‡ä¸ç©ºã€‚åœ¨åˆ å»pä¹‹åï¼Œä¸ºä¿æŒå…¶å®ƒå…ƒç´ ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œå¯æŒ‰ä¸­åºéå†ä¿æŒæœ‰åºè¿›è¡Œè°ƒæ•´ã€‚æ¯”è¾ƒå¥½çš„åšæ³•æ˜¯ï¼Œæ‰¾åˆ°*pçš„**ç›´æ¥å‰é©±ï¼ˆæˆ–ç›´æ¥åç»§ï¼‰sï¼Œç”¨sæ¥æ›¿æ¢ç»“ç‚¹pï¼Œç„¶åå†åˆ é™¤ç»“ç‚¹sã€‚(ä¾é ä¸­åºéå†åœ¨pèŠ‚ç‚¹ä¸‹è¿›è¡Œéå†å¾—åˆ°çš„æœ€åä¸€ä¸ªæ•°å³ä¸ºæ›¿æ¢çš„èŠ‚ç‚¹)\n  æ€§èƒ½åˆ†æ  æœ€å¥½çš„æƒ…å†µæ˜¯äºŒå‰æ’åºæ ‘çš„å½¢æ€å’ŒæŠ˜åŠæŸ¥æ‰¾çš„åˆ¤å®šæ ‘ç›¸åŒï¼Œå…¶å¹³å‡æŸ¥æ‰¾é•¿åº¦å’Œlognæˆæ­£æ¯”ï¼ˆO(log2(n))ï¼‰ã€‚ æœ€åæƒ…å†µä¸‹ï¼Œå½“å…ˆåæ’å…¥çš„å…³é”®å­—æœ‰åºæ—¶ï¼Œæ„æˆçš„äºŒå‰æ’åºæ ‘ä¸ºä¸€æ£µæ–œæ ‘ï¼Œæ ‘çš„æ·±åº¦ä¸ºnï¼Œå…¶å¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º(n + 1) / 2ã€‚ä¹Ÿå°±æ˜¯æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œç­‰åŒäºé¡ºåºæŸ¥æ‰¾ã€‚   è™½ç„¶äºŒå‰æ’åºæ ‘çš„æœ€åæ•ˆç‡æ˜¯O(n)ï¼Œä½†å®ƒæ”¯æŒåŠ¨æ€æŸ¥æ‰¾ã€‚æœ€å¥½æ˜¯æŠŠå®ƒæ„å»ºæˆä¸€æ£µå¹³è¡¡çš„äºŒå‰æ’åºæ ‘ï¼ˆå¹³è¡¡äºŒå‰æ ‘ï¼‰ï¼Œè¿™äº›å¹³è¡¡äºŒå‰æ ‘å¯ä»¥ä½¿æ ‘é«˜ä¸ºO(logn)ï¼Œå¦‚AVLã€çº¢é»‘æ ‘ç­‰ã€‚\n 2. å¹³è¡¡äºŒå‰æ ‘ï¼ˆAVLï¼‰ å®šä¹‰ å®ƒæˆ–è€…æ˜¯ä¸€é¢—ç©ºæ ‘ï¼Œæˆ–è€…å…·æœ‰ä»¥ä¸‹æ€§è´¨çš„äºŒå‰æ ‘ï¼šå®ƒçš„å·¦å­æ ‘å’Œå³å­æ ‘çš„æ·±åº¦ä¹‹å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1ï¼Œä¸”å®ƒçš„å·¦å­æ ‘å’Œå³å­æ ‘éƒ½æ˜¯ä¸€é¢—å¹³è¡¡äºŒå‰æ ‘ã€‚\nå¹³è¡¡å› å­(bf)ï¼šç»“ç‚¹çš„å·¦å­æ ‘çš„æ·±åº¦å‡å»å³å­æ ‘çš„æ·±åº¦ï¼Œé‚£ä¹ˆæ˜¾ç„¶-1\u0026lt;=bf\u0026lt;=1;\n åœ¨AVLæ ‘ä¸­ï¼Œä»»ä¸€èŠ‚ç‚¹å¯¹åº”çš„ä¸¤æ£µå­æ ‘çš„æœ€å¤§é«˜åº¦å·®ä¸º1ï¼Œå› æ­¤å®ƒä¹Ÿè¢«ç§°ä¸ºé«˜åº¦å¹³è¡¡æ ‘ã€‚\n æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤åœ¨å¹³å‡å’Œæœ€åæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯$O(log(n))$ã€‚å¢åŠ å’Œåˆ é™¤å…ƒç´ çš„æ“ä½œåˆ™å¯èƒ½éœ€è¦å€Ÿç”±ä¸€æ¬¡æˆ–å¤šæ¬¡æ ‘æ—‹è½¬ï¼Œä»¥å®ç°æ ‘çš„é‡æ–°å¹³è¡¡ã€‚\næŸ¥æ‰¾æ“ä½œ å¹³è¡¡äºŒå‰æ ‘çš„æŸ¥æ‰¾åŸºæœ¬ä¸äºŒå‰æŸ¥æ‰¾æ ‘ç›¸åŒã€‚\næ’å…¥æ“ä½œ åœ¨å¹³è¡¡äºŒå‰æ ‘ä¸­æ’å…¥ç»“ç‚¹ä¸äºŒå‰æŸ¥æ‰¾æ ‘æœ€å¤§çš„ä¸åŒåœ¨äºè¦éšæ—¶ä¿è¯æ’å…¥åæ•´æ£µäºŒå‰æ ‘æ˜¯å¹³è¡¡çš„ã€‚é‚£ä¹ˆè°ƒæ•´ä¸å¹³è¡¡æ ‘çš„åŸºæœ¬æ–¹æ³•å°±æ˜¯ï¼š æ—‹è½¬ ã€‚\né¦–å…ˆï¼Œè¿˜éœ€è¦æ˜ç™½çš„ä¸€ä¸ªæ¦‚å¿µå°±æ˜¯ï¼š\næœ€å°ä¸å¹³è¡¡å­æ ‘çš„æ ¹ç»“ç‚¹ï¼šä¹Ÿå°±æ˜¯å½“ä½ è¿›è¡Œæ’å…¥æ“ä½œæ—¶ï¼Œæ‰¾åˆ°è¯¥éœ€è¦æ’å…¥ç»“ç‚¹çš„ä½ç½®å¹¶æ’å…¥åï¼Œä»è¯¥ç»“ç‚¹èµ·å‘ä¸Šå¯»æ‰¾ï¼ˆå›æº¯ï¼‰ï¼Œç¬¬ä¸€ä¸ªä¸å¹³è¡¡çš„ç»“ç‚¹å³å¹³è¡¡å› å­bfå˜ä¸º-2æˆ–2çš„èŠ‚ç‚¹ã€‚\n é‚£ç©¶ç«Ÿæ˜¯å¦‚ä½•â€œè½¬â€çš„å‘¢ï¼Ÿ\nå…¶å®ï¼Œå¯ä»¥æ¢ä¸€ç§æ€è·¯æ€è€ƒï¼Œä¸è®©å®ƒå«â€œæ—‹è½¬â€ï¼è€Œå«â€”â€”\u0026gt;â€œä¸¤ä¸ªç»“ç‚¹çš„å˜æ¢â€\n ä¸‹é¢åˆ†æƒ…å†µåˆ†æå››ç§æ—‹è½¬æ–¹å¼\nå·¦å·¦ å³åœ¨xçš„å·¦å­©å­açš„å·¦å­©å­cä¸Šæ’å…¥ä¸€ä¸ªç»“ç‚¹yï¼ˆè¯¥ç»“ç‚¹ä¹Ÿå¯ä»¥æ˜¯c,å¦‚å›¾â‘ ï¼‰ï¼Œå³yå¯ä»¥æ˜¯cï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å·¦å­©å­ï¼ˆå¦‚å›¾â‘¡ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å³å­©å­ï¼ˆä¸åœ¨ç”»å‡ºï¼‰\n è¿™ç§å·¦å·¦æ’å…¥æ–¹å¼æœ‰ä¸€ä¸ªè§„å¾‹ï¼šä¸å¹³è¡¡å­æ ‘çš„å·¦å­æ ‘æ·±åº¦æ¯”å³å­æ ‘æ·±åº¦å¤§2.\n å›¾â‘ â‘¡æ’å…¥çš„èŠ‚ç‚¹éƒ½ä¸ºyï¼Œæ­¤æ—¶å‘ä¸Šå›æº¯ç¬¬ä¸€ä¸ªä¸å¹³è¡¡çš„å­æ ‘æ ¹èŠ‚ç‚¹ä¸ºxï¼Œé‚£ä¹ˆå°†xèŠ‚ç‚¹åŠå…¶å³å­æ ‘(å›¾â‘ ä¸ºNULLï¼Œå›¾â‘¡ä¸ºb)ä¸€èµ·ç»•ç€xçš„å·¦å­æ ‘æ ¹èŠ‚ç‚¹(å³a)å³æ—‹(å³é¡ºæ—¶é’ˆæ—‹è½¬),ç„¶åå°†açš„å³å­æ ‘ä½œä¸ºxçš„å·¦å­æ ‘ï¼Œå‡å¦‚açš„å³å­æ ‘ä¸ºç©ºåˆ™ä¸å¿…æ’å…¥ã€‚é‚£ä¹ˆè¿™æ ·æ—‹è½¬æœ€åå°†ä¸å¹³è¡¡å­æ ‘å˜ä¸ºå¹³è¡¡ã€‚\nå³å³ å³åœ¨xçš„å³å­©å­açš„å³å­©å­cä¸Šæ’å…¥ä¸€ä¸ªç»“ç‚¹yï¼ˆè¯¥ç»“ç‚¹ä¹Ÿå¯ä»¥æ˜¯c,å¦‚å›¾â‘ ï¼‰ï¼Œå³yå¯ä»¥æ˜¯cï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å³å­©å­ï¼ˆå¦‚å›¾â‘¡ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å·¦å­©å­ï¼ˆä¸åœ¨ç”»å‡ºï¼‰\n è¿™ç§å³å³æ’å…¥æ–¹å¼æœ‰ä¸€ä¸ªè§„å¾‹ï¼šä¸å¹³è¡¡å­æ ‘çš„å·¦å­æ ‘æ·±åº¦æ¯”å³å­æ ‘æ·±åº¦å°2.\n å›¾â‘ â‘¡æ’å…¥çš„èŠ‚ç‚¹éƒ½ä¸ºyï¼Œæ­¤æ—¶å‘ä¸Šå›æº¯æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸å¹³è¡¡å­æ ‘çš„èŠ‚ç‚¹ä¸ºxï¼Œéœ€è¦å°†èŠ‚ç‚¹xåŠå…¶å·¦å­æ ‘(å›¾â‘ ä¸ºNULLï¼Œå›¾äºŒä¸ºb)ç»•ç€xå³å­æ ‘(ä¸¤å›¾éƒ½ä¸ºaä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘)è¿›è¡Œå·¦æ—‹(é€†æ—¶é’ˆæ—‹è½¬),ç„¶åå°†å…¶å³å­æ ‘(a)çš„å·¦èŠ‚ç‚¹ä½œä¸ºxçš„å³èŠ‚ç‚¹ï¼Œè¿™æ ·ä½¿å¾—ä¸å¹³è¡¡å­æ ‘åˆå†åº¦å¹³è¡¡ã€‚\nå·¦å³ å³åœ¨xçš„å·¦å­©å­açš„å³å­©å­cä¸Šæ’å…¥ä¸€ä¸ªç»“ç‚¹yï¼ˆè¯¥ç»“ç‚¹ä¹Ÿå¯ä»¥æ˜¯c,å¦‚å›¾â‘ ï¼‰ï¼Œå³yå¯ä»¥æ˜¯cï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å³å­©å­ï¼ˆå¦‚å›¾â‘¡ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å·¦å­©å­ï¼ˆä¸åœ¨ç”»å‡ºï¼‰\n è¿™ç§å·¦å³æ’å…¥çš„è§„å¾‹å°±æ˜¯ï¼šä¸å¹³è¡¡å­æ ‘çš„å·¦å­æ ‘é«˜åº¦æ¯”å³å­æ ‘å¤§2ä¸”å·¦å­æ ‘çš„å³å­æ ‘æ¯”å·¦å­æ ‘çš„å·¦å­æ ‘æ·±åº¦æ·±ã€‚\n å‘ä¸Šå›æº¯çš„ç¬¬ä¸€ä¸ªä¸å¹³è¡¡å­æ ‘ä¸ºxï¼Œå…ˆå¯¹xçš„å·¦å­æ ‘å·¦æ—‹(æ—‹è½¬ä¸­å¿ƒä¸ºc)ï¼Œå†å¯¹xçš„å·¦å­æ ‘è¿›è¡Œå³æ—‹(æ—‹è½¬ä¸­å¿ƒä¸ºc)ã€‚(æ—‹è½¬ä¸­å¿ƒä¸ºå·¦å­æ ‘çš„å³èŠ‚ç‚¹)\n å¦‚æœæ˜¯å›¾â‘ ï¼Œæ—‹è½¬ä¸­å¿ƒä¸ºy\n å³å·¦ å³åœ¨xçš„å³å­©å­açš„å·¦å­©å­cä¸Šæ’å…¥ä¸€ä¸ªç»“ç‚¹yï¼ˆè¯¥ç»“ç‚¹ä¹Ÿå¯ä»¥æ˜¯c,å¦‚å›¾â‘ ï¼‰ï¼Œå³yå¯ä»¥æ˜¯cï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å³å­©å­ï¼ˆå¦‚å›¾â‘¡ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯cçš„å·¦å­©å­ï¼ˆä¸åœ¨ç”»å‡ºï¼‰\n è¿™ç§å³å·¦æ’å…¥çš„è§„å¾‹å°±æ˜¯ï¼šä¸å¹³è¡¡å­æ ‘çš„å³å­æ ‘é«˜åº¦æ¯”å·¦å­æ ‘å¤§2ä¸”å³å­æ ‘çš„å·¦å­æ ‘æ¯”å³å­æ ‘çš„å³å­æ ‘æ·±åº¦æ·±ã€‚\n å‘ä¸Šå›æº¯çš„ç¬¬ä¸€ä¸ªä¸å¹³è¡¡å­æ ‘ä¸ºxï¼Œå…ˆå¯¹xçš„å³å­æ ‘å³æ—‹(æ—‹è½¬ä¸­å¿ƒä¸ºc)ï¼Œå†å¯¹xçš„å³å­æ ‘è¿›è¡Œå·¦æ—‹(æ—‹è½¬ä¸­å¿ƒä¸ºc)ã€‚(æ—‹è½¬ä¸­å¿ƒä¸ºå·¦å­æ ‘çš„å³èŠ‚ç‚¹)\n å¦‚æœæ˜¯å›¾â‘ ï¼Œæ—‹è½¬ä¸­å¿ƒä¸ºy\n AVLæ ‘çš„æ“ä½œæ±‡æ€»ï¼š\nåˆ é™¤æ“ä½œ åˆ é™¤ç±»ä¼¼æ’å…¥çš„æ“ä½œã€‚åˆ é™¤æ—¶å°‘ä¸€ä¸ªç»“ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯¥ç»“ç‚¹æ‰€åœ¨çš„å­æ ‘æ·±åº¦å¯èƒ½ä¼šå‡å°ï¼Œè€Œæ’å…¥æ—¶å¤šä¸€ä¸ªç»“ç‚¹ï¼Œè¯¥ç»“ç‚¹æ‰€åœ¨çš„å­æ ‘æ·±åº¦å¯èƒ½ä¼šå¢åŠ ï¼Œæ‰€ä»¥é€’å½’åˆ é™¤ä¸€ä¸ªç»“ç‚¹æ—¶ï¼Œå›æº¯æ—¶æ‰¾åˆ°æœ€å°ä¸å¹³è¡¡å­æ ‘çš„æ ¹ç»“ç‚¹æ—¶ï¼Œè¦å‘ç›¸åçš„æ–¹å‘å»æ‰¾å±äºå“ªç§æƒ…å†µï¼›\nå¦‚å›¾yä¸ºè¦åˆ é™¤çš„èŠ‚ç‚¹\nå›¾â‘ ï¼šyç»“ç‚¹åˆ é™¤åï¼Œå›æº¯åˆ°xç»“ç‚¹ä»bf=-1å˜ä¸ºbf=-2ï¼›åˆ™éœ€ä»ç›¸åæ–¹å‘å³ä»xçš„å³å­©å­çš„æ–¹å‘å‘ä¸‹æ£€æŸ¥å±äºå“ªç§æƒ…å†µï¼Œæ˜¾ç„¶ç¬¬ä¸€ä¸ªæ–¹å‘ä¸º1ï¼šå³ï¼›ç¬¬äºŒä¸ªæ–¹å‘çœ‹açš„bfçš„å€¼â€”â€”è‹¥ä¸º1æ—¶ï¼Œé‚£å°±ç›¸å½“äºæ’å…¥æ—¶â€˜å³å·¦â€™çš„æƒ…å†µï¼›è‹¥ä¸º-1æ—¶ï¼Œé‚£å°±ç›¸å½“äºæ’å…¥æ—¶â€˜å³å³â€™çš„æƒ…å†µï¼›å¯ç°åœ¨açš„bfæ—¢ä¸æ˜¯1ä¹Ÿä¸æ˜¯-1è€Œæ˜¯0ï¼Œè¿™å°±æ˜¯åˆ é™¤çš„ç‰¹æ®Šæƒ…å†µäº†ï¼æˆ‘ä»¬ä¸å¦¨è¯•è¯•å¯¹ä»–è¿›è¡Œç±»ä¼¼äºæ’å…¥æ—¶çš„â€˜å³å³â€™æ“ä½œï¼Œçœ‹æ€ä¹ˆæ ·~ å¦‚ä¸Šå›¾ï¼Œç»è¿‡å˜æ¢åè¯¥å­æ ‘å¹³è¡¡äº†ï¼ä½†æ˜¯å› å­çš„ä¿®æ”¹å°±è·Ÿæ’å…¥æ—¶çš„â€˜å³å³â€™ä¸ä¸€æ ·äº†ï¼æ­¤æ—¶å˜ä¸ºï¼šxçš„bf=-1,açš„bf=1ï¼›æ‰€ä»¥æˆ‘ä»¬ä¸å¦¨å°±æŠŠaçš„bf=0ä¹Ÿå½’çº³ä¸ºåˆ é™¤çš„â€˜å³å³â€™æˆ–â€˜å·¦å·¦â€™ï¼ˆå¦‚å›¾â‘¡ï¼Œä¸å†æ•–è¿°ï¼‰æ“ä½œï¼›\né‚£ä¹ˆåˆ é™¤æ—¶å› å­çš„æ”¹å˜éœ€åœ¨æ’å…¥æ—¶å› å­çš„æ”¹å˜ä¸­æ·»åŠ ä¸Šï¼š\nå·¦å·¦ï¼šå‰a:bf=0 åx:bf=1,a:bf=-1ï¼› å³å³ï¼šå‰a:bf=0 åx:bf=-1,a:bf=1ï¼›å…¶ä»–ä¸å˜ï¼\n å¯ä»¥æƒ³è±¡ï¼Œå…¶å®æ˜¯å¾ˆç®€å•çš„é“ç†ï¼šé™¤äº†ç‰¹æ®Šæƒ…å†µå…¶ä»–éƒ½ä¸æ’å…¥çš„æƒ…å†µä¸€æ¨¡ä¸€æ ·ï¼Œè¯´ç™½äº†å°±æ˜¯æŠŠæ·±åº¦å¤§çš„å­æ ‘ï¼ˆæ ¹ç»“ç‚¹çš„å…¶ä¸­ä¸€ä¸ªï¼‰å‘æ·±åº¦å°å­æ ‘è´¡çŒ®ä¸€ä¸ªæ·±åº¦ï¼Œé‚£ä¹ˆè¿™æ ·ä¸€æ¥ï¼Œè¯¥å­æ ‘ï¼ˆå¯¹äºæ ¹ç»“ç‚¹æ‰€é¢†å¯¼çš„æ ‘ï¼‰çš„æ·±åº¦æ˜¯ä¸æ˜¯æ¯”åŸæ¥çš„å°1äº†ï¼Ÿï¼æ‰€ä»¥è¦ç»§ç»­å‘ä¸Šä¸€ä¸ªä¸€ä¸ªè¿›è¡Œæ£€ç´¢ï¼Œç›´åˆ°æ ¹ç»“ç‚¹ä¸ºæ­¢ï¼\n ä»£ç å®ç° https://blog.csdn.net/nightwizard2030/article/details/72874715\næ€§èƒ½åˆ†æ ä¼˜åŠ¿ å¹³è¡¡äºŒå‰æ ‘çš„ä¼˜åŠ¿åœ¨äºä¸ä¼šå‡ºç°æ™®é€šäºŒå‰æŸ¥æ‰¾æ ‘çš„æœ€å·®æƒ…å†µã€‚å…¶æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(logN)$ã€‚\nç¼ºé™·  ä¸ºäº†ä¿è¯é«˜åº¦å¹³è¡¡ï¼ŒåŠ¨æ€æ’å…¥å’Œåˆ é™¤çš„ä»£ä»·ä¹Ÿéšä¹‹å¢åŠ . æ‰€æœ‰äºŒå‰æŸ¥æ‰¾æ ‘ç»“æ„çš„æŸ¥æ‰¾ä»£ä»·éƒ½ä¸æ ‘é«˜æ˜¯ç´§å¯†ç›¸å…³çš„ï¼Œèƒ½å¦é€šè¿‡å‡å°‘æ ‘é«˜æ¥è¿›ä¸€æ­¥é™ä½æŸ¥æ‰¾ä»£ä»·å‘¢ã€‚  åº”ç”¨åœºæ™¯ åº”ç”¨ï¼šwindowså¯¹è¿›ç¨‹åœ°å€ç©ºé—´çš„ç®¡ç†ç”¨åˆ°äº†AVLæ ‘ã€‚\n3. çº¢é»‘æ ‘ ä¹Ÿè¢«ç§°ä¸º\u0026rdquo;å¯¹ç§°äºŒå‰Bæ ‘\u0026quot;ã€‚\nå®šä¹‰ çº¢é»‘æ ‘(red-black tree) æ˜¯ä¸€æ£µæ»¡è¶³ä¸‹è¿°æ€§è´¨çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼š\n  æ¯ä¸€ä¸ªç»“ç‚¹è¦ä¹ˆæ˜¯çº¢è‰²ï¼Œè¦ä¹ˆæ˜¯é»‘è‰²ã€‚\n  æ ¹ç»“ç‚¹æ˜¯é»‘è‰²çš„ã€‚\n  æ‰€æœ‰å¶å­ç»“ç‚¹éƒ½æ˜¯é»‘è‰²çš„ï¼ˆå®é™…ä¸Šéƒ½æ˜¯NullæŒ‡é’ˆï¼Œä¸‹å›¾ç”¨NILè¡¨ç¤ºï¼‰ã€‚å¶å­ç»“ç‚¹ä¸åŒ…å«ä»»ä½•å…³é”®å­—ä¿¡æ¯ï¼Œæ‰€æœ‰æŸ¥è¯¢å…³é”®å­—éƒ½åœ¨éç»ˆç»“ç‚¹ä¸Šã€‚\n  æ¯ä¸ªçº¢è‰²ç»“ç‚¹çš„ä¸¤ä¸ªå­èŠ‚ç‚¹å¿…é¡»æ˜¯é»‘è‰²çš„ã€‚æ¢å¥è¯è¯´ï¼šä»æ¯ä¸ªå¶å­åˆ°æ ¹çš„æ‰€æœ‰è·¯å¾„ä¸Šä¸èƒ½æœ‰ä¸¤ä¸ªè¿ç»­çš„çº¢è‰²ç»“ç‚¹\n  ä»ä»»ä¸€ç»“ç‚¹åˆ°å…¶æ¯ä¸ªå¶å­çš„æ‰€æœ‰è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²ç»“ç‚¹\n  å‡ ä¸ªæ¦‚å¿µï¼š\né»‘æ·±åº¦ â€”â€”ä»æŸä¸ªç»“ç‚¹xå‡ºå‘(ä¸åŒ…æ‹¬ç»“ç‚¹xæœ¬èº«)åˆ°å¶ç»“ç‚¹(åŒ…æ‹¬å¶å­ç»“ç‚¹)çš„è·¯å¾„ä¸Šçš„é»‘ç»“ç‚¹ä¸ªæ•°,ç§°ä¸ºè¯¥ç»“ç‚¹xçš„é»‘æ·±åº¦,è®°ä¸º$bd(x)$,æ ¹ç»“ç‚¹çš„é»‘æ·±åº¦å°±æ˜¯è¯¥çº¢é»‘æ ‘çš„é»‘æ·±åº¦ã€‚å¶å­ç»“ç‚¹çš„é»‘æ·±åº¦ä¸º0ã€‚æ¯”å¦‚ï¼šä¸Šå›¾$bd(13)=2ï¼Œ bd(8)=2ï¼Œ bd(1)=1$\nå†…éƒ¨ç»“ç‚¹ â€”â€” çº¢é»‘æ ‘çš„éç»ˆç»“ç‚¹\nå¤–éƒ¨èŠ‚ç‚¹ â€”â€” çº¢é»‘æ ‘çš„å¶å­ç»“ç‚¹\nç›¸å…³åŸç†  ä»æ ¹åˆ°å¶å­çš„æœ€é•¿çš„å¯èƒ½è·¯å¾„ä¸å¤šäºæœ€çŸ­çš„å¯èƒ½è·¯å¾„çš„ä¸¤å€é•¿ã€‚ çº¢é»‘æ ‘çš„æ ‘é«˜$(h)$ä¸å¤§äºä¸¤å€çš„çº¢é»‘æ ‘çš„é»‘æ·±åº¦$(bd)$ï¼Œå³$h\u0026lt;=2bd$ ä¸€æ£µæ‹¥æœ‰nä¸ªå†…éƒ¨ç»“ç‚¹(ä¸åŒ…æ‹¬å¶å­ç»“ç‚¹)çš„çº¢é»‘æ ‘çš„æ ‘é«˜$h\u0026lt;=2log(n+1)$  æŸ¥æ‰¾æ“ä½œ å› ä¸ºæ¯ä¸€ä¸ªçº¢é»‘æ ‘ä¹Ÿæ˜¯ä¸€ä¸ªç‰¹åŒ–çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œå› æ­¤çº¢é»‘æ ‘ä¸Šçš„æŸ¥æ‰¾æ“ä½œä¸æ™®é€šäºŒå‰æŸ¥æ‰¾æ ‘ä¸Šçš„æŸ¥æ‰¾æ“ä½œç›¸åŒ.\næ’å…¥æ“ä½œ æˆ‘ä»¬é¦–å…ˆä»¥äºŒå‰æŸ¥æ‰¾æ ‘çš„æ–¹æ³•å¢åŠ èŠ‚ç‚¹å¹¶æ ‡è®°å®ƒä¸ºçº¢è‰²ã€‚ä¸‹é¢è¦è¿›è¡Œä»€ä¹ˆæ“ä½œå–å†³äºå…¶ä»–ä¸´è¿‘èŠ‚ç‚¹çš„é¢œè‰²ã€‚åŒäººç±»çš„å®¶æ—æ ‘ä¸­ä¸€æ ·ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœ¯è¯­å”çˆ¶èŠ‚ç‚¹æ¥æŒ‡ä¸€ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹ã€‚\nå‡è®¾æ–°åŠ å…¥çš„ç»“ç‚¹ä¸ºNï¼Œçˆ¶äº²ç»“ç‚¹ä¸ºPï¼Œå”çˆ¶ç»“ç‚¹ä¸ºUi(å”çˆ¶ç»“ç‚¹å°±æ˜¯ä¸€äº›åˆ—Pçš„å…„å¼Ÿç»“ç‚¹)ï¼Œç¥–çˆ¶ç»“ç‚¹G(çˆ¶äº²ç»“ç‚¹Pçš„çˆ¶äº²)ã€‚\næƒ…å†µ1. å½“å‰çº¢é»‘æ ‘ä¸ºç©ºï¼Œæ–°ç»“ç‚¹Nä½äºæ ‘çš„æ ¹ä¸Šï¼Œæ²¡æœ‰çˆ¶ç»“ç‚¹ã€‚\næ­¤æ—¶å¾ˆç®€å•ï¼Œæˆ‘ä»¬å°†ç›´æ¥æ’å…¥ä¸€ä¸ªé»‘ç»“ç‚¹Nï¼ˆæ»¡è¶³æ€§è´¨2ï¼‰ï¼Œå› ä¸ºæ˜¯ç‰¹æ®Šå¤§çš„æƒ…å†µï¼Œä¸æ’å…¥çº¢è‰²è€Œæ’å…¥é»‘è‰²èŠ‚ç‚¹ã€‚\næƒ…å†µ2. æ–°ç»“ç‚¹Nçš„çˆ¶ç»“ç‚¹Pæ˜¯é»‘è‰²ã€‚\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ’å…¥ä¸€ä¸ªçº¢è‰²ç»“ç‚¹N(æ»¡è¶³æ€§è´¨5)\n æ³¨æ„ï¼šåœ¨æƒ…å†µ3ï¼Œ4ï¼Œ5ä¸‹ï¼Œæˆ‘ä»¬å‡å®šæ–°èŠ‚ç‚¹æœ‰ç¥–çˆ¶èŠ‚ç‚¹ï¼Œå› ä¸ºçˆ¶èŠ‚ç‚¹æ˜¯çº¢è‰²ï¼›å¹¶ä¸”å¦‚æœå®ƒæ˜¯æ ¹ï¼Œå®ƒå°±åº”å½“æ˜¯é»‘è‰²ã€‚æ‰€ä»¥æ–°èŠ‚ç‚¹æ€»æœ‰ä¸€ä¸ªå”çˆ¶èŠ‚ç‚¹ï¼Œå°½ç®¡åœ¨æƒ…å½¢4å’Œ5ä¸‹å®ƒå¯èƒ½æ˜¯å¶å­ã€‚\n æƒ…å†µ3.å¦‚æœçˆ¶èŠ‚ç‚¹På’Œå”çˆ¶èŠ‚ç‚¹UäºŒè€…éƒ½æ˜¯çº¢è‰²ã€‚\nå¦‚ä¸‹å›¾ï¼Œå› ä¸ºæ–°åŠ å…¥çš„Nç»“ç‚¹å¿…é¡»ä¸ºçº¢è‰²ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†çˆ¶ç»“ç‚¹P(ä¿è¯æ€§è´¨4)ï¼Œä»¥åŠNçš„å”çˆ¶ç»“ç‚¹U(ä¿è¯æ€§è´¨5)é‡æ–°ç»˜åˆ¶æˆé»‘è‰²ã€‚å¦‚æœæ­¤æ—¶ç¥–çˆ¶ç»“ç‚¹Gæ˜¯æ ¹ï¼Œåˆ™ç»“æŸå˜åŒ–ã€‚å¦‚æœä¸æ˜¯æ ¹ï¼Œåˆ™ç¥–çˆ¶ç»“ç‚¹é‡ç»˜ä¸ºçº¢è‰²(ä¿è¯æ€§è´¨5)ã€‚ä½†æ˜¯ï¼ŒGçš„çˆ¶äº²ä¹Ÿå¯èƒ½æ˜¯çº¢è‰²çš„ï¼Œä¸ºäº†ä¿è¯æ€§è´¨4ã€‚æˆ‘ä»¬æŠŠGé€’å½’å½“åšæ–°åŠ å…¥çš„ç»“ç‚¹Nåœ¨è¿›è¡Œå„ç§æƒ…å†µçš„é‡æ–°æ£€æŸ¥ã€‚\n æ³¨æ„ï¼šåœ¨æƒ…å½¢4å’Œ5ä¸‹ï¼Œæˆ‘ä»¬å‡å®šçˆ¶èŠ‚ç‚¹P æ˜¯ç¥–çˆ¶ç»“ç‚¹G çš„å·¦å­èŠ‚ç‚¹ã€‚å¦‚æœå®ƒæ˜¯å³å­èŠ‚ç‚¹ï¼Œæƒ…å½¢4å’Œæƒ…å½¢5ä¸­çš„å·¦å’Œå³åº”å½“å¯¹è°ƒã€‚\n æƒ…å†µ4. çˆ¶èŠ‚ç‚¹Pæ˜¯çº¢è‰²è€Œå”çˆ¶èŠ‚ç‚¹Uæ˜¯é»‘è‰²æˆ–ç¼ºå°‘; å¦å¤–ï¼Œæ–°èŠ‚ç‚¹Næ˜¯å…¶çˆ¶èŠ‚ç‚¹Pçš„å³å­èŠ‚ç‚¹ï¼Œè€Œçˆ¶èŠ‚ç‚¹Påˆæ˜¯ç¥–çˆ¶ç»“ç‚¹Gçš„å·¦å­èŠ‚ç‚¹ã€‚\nå¦‚ä¸‹å›¾, åœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼Œæˆ‘ä»¬è¿›è¡Œä¸€æ¬¡å·¦æ—‹è½¬è°ƒæ¢æ–°èŠ‚ç‚¹å’Œå…¶çˆ¶èŠ‚ç‚¹çš„è§’è‰²ï¼ˆä¸AVLæ ‘çš„å·¦æ—‹è½¬ç›¸åŒï¼‰; è¿™å¯¼è‡´æŸäº›è·¯å¾„é€šè¿‡å®ƒä»¬ä»¥å‰ä¸é€šè¿‡çš„æ–°èŠ‚ç‚¹Næˆ–çˆ¶èŠ‚ç‚¹Pä¸­çš„ä¸€ä¸ªï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªèŠ‚ç‚¹éƒ½æ˜¯çº¢è‰²çš„ï¼Œæ‰€ä»¥æ€§è´¨5æ²¡æœ‰å¤±æ•ˆã€‚ä½†ç›®å‰æƒ…å†µå°†è¿åæ€§è´¨4ï¼Œæ‰€ä»¥æ¥ç€ï¼Œæˆ‘ä»¬æŒ‰ä¸‹é¢çš„æƒ…å†µ5ç»§ç»­å¤„ç†ä»¥å‰çš„çˆ¶èŠ‚ç‚¹Pã€‚\næƒ…å†µ5. çˆ¶èŠ‚ç‚¹Pæ˜¯çº¢è‰²è€Œå”çˆ¶èŠ‚ç‚¹U æ˜¯é»‘è‰²æˆ–ç¼ºå°‘ï¼Œæ–°èŠ‚ç‚¹N æ˜¯å…¶çˆ¶èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ï¼Œè€Œçˆ¶èŠ‚ç‚¹Påˆæ˜¯ç¥–çˆ¶ç»“ç‚¹çš„Gçš„å·¦å­èŠ‚ç‚¹ã€‚\nå¦‚ä¸‹å›¾ï¼š åœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼Œæˆ‘ä»¬è¿›è¡Œé’ˆå¯¹ç¥–çˆ¶èŠ‚ç‚¹P çš„ä¸€æ¬¡å³æ—‹è½¬; åœ¨æ—‹è½¬äº§ç”Ÿçš„æ ‘ä¸­ï¼Œä»¥å‰çš„çˆ¶èŠ‚ç‚¹Pç°åœ¨æ˜¯æ–°èŠ‚ç‚¹Nå’Œä»¥å‰çš„ç¥–çˆ¶èŠ‚ç‚¹G çš„çˆ¶èŠ‚ç‚¹ã€‚æˆ‘ä»¬çŸ¥é“ä»¥å‰çš„ç¥–çˆ¶èŠ‚ç‚¹Gæ˜¯é»‘è‰²ï¼Œå¦åˆ™çˆ¶èŠ‚ç‚¹På°±ä¸å¯èƒ½æ˜¯çº¢è‰²ã€‚æˆ‘ä»¬åˆ‡æ¢ä»¥å‰çš„çˆ¶èŠ‚ç‚¹På’Œç¥–çˆ¶èŠ‚ç‚¹Gçš„é¢œè‰²ï¼Œç»“æœçš„æ ‘æ»¡è¶³æ€§è´¨4[3]ã€‚æ€§è´¨ 5[4]ä¹Ÿä»ç„¶ä¿æŒæ»¡è¶³ï¼Œå› ä¸ºé€šè¿‡è¿™ä¸‰ä¸ªèŠ‚ç‚¹ä¸­ä»»ä½•ä¸€ä¸ªçš„æ‰€æœ‰è·¯å¾„ä»¥å‰éƒ½é€šè¿‡ç¥–çˆ¶èŠ‚ç‚¹G ï¼Œç°åœ¨å®ƒä»¬éƒ½é€šè¿‡ä»¥å‰çš„çˆ¶èŠ‚ç‚¹Pã€‚åœ¨å„è‡ªçš„æƒ…å½¢ä¸‹ï¼Œè¿™éƒ½æ˜¯ä¸‰ä¸ªèŠ‚ç‚¹ä¸­å”¯ä¸€çš„é»‘è‰²èŠ‚ç‚¹ã€‚\nåˆ é™¤æ“ä½œ ç›¸è¾ƒäºæ’å…¥æ“ä½œï¼Œçº¢é»‘æ ‘çš„åˆ é™¤æ“ä½œåˆ™è¦æ›´ä¸ºå¤æ‚ä¸€äº›ã€‚åˆ é™¤æ“ä½œé¦–å…ˆè¦ç¡®å®šå¾…åˆ é™¤èŠ‚ç‚¹æœ‰å‡ ä¸ªå­©å­ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªå­©å­ï¼Œä¸èƒ½ç›´æ¥åˆ é™¤è¯¥èŠ‚ç‚¹ã€‚è€Œæ˜¯è¦å…ˆæ‰¾åˆ°è¯¥èŠ‚ç‚¹çš„å‰é©±ï¼ˆè¯¥èŠ‚ç‚¹å·¦å­æ ‘ä¸­æœ€å¤§çš„èŠ‚ç‚¹ï¼‰æˆ–è€…åç»§ï¼ˆè¯¥èŠ‚ç‚¹å³å­æ ‘ä¸­æœ€å°çš„èŠ‚ç‚¹ï¼‰ï¼Œç„¶åå°†å‰é©±æˆ–è€…åç»§çš„å€¼å¤åˆ¶åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹ä¸­ï¼Œæœ€åå†å°†å‰é©±æˆ–åç»§åˆ é™¤ã€‚ç”±äºå‰é©±å’Œåç»§è‡³å¤šåªæœ‰ä¸€ä¸ªå­©å­èŠ‚ç‚¹ï¼Œè¿™æ ·æˆ‘ä»¬å°±æŠŠåŸæ¥è¦åˆ é™¤çš„èŠ‚ç‚¹æœ‰ä¸¤ä¸ªå­©å­çš„é—®é¢˜è½¬åŒ–ä¸ºåªæœ‰ä¸€ä¸ªå­©å­èŠ‚ç‚¹çš„é—®é¢˜ï¼Œé—®é¢˜è¢«ç®€åŒ–äº†ä¸€äº›ã€‚æˆ‘ä»¬å¹¶ä¸å…³å¿ƒæœ€ç»ˆè¢«åˆ é™¤çš„èŠ‚ç‚¹æ˜¯å¦æ˜¯æˆ‘ä»¬å¼€å§‹æƒ³è¦åˆ é™¤çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œåªè¦èŠ‚ç‚¹é‡Œçš„å€¼æœ€ç»ˆè¢«åˆ é™¤å°±è¡Œäº†ï¼Œè‡³äºæ ‘ç»“æ„å¦‚ä½•å˜åŒ–ï¼Œè¿™ä¸ªå¹¶ä¸é‡è¦ã€‚\nåº”ç”¨åœºæ™¯ å·¥ä¸šç•Œæœ€ä¸»è¦ä½¿ç”¨çš„äºŒå‰æœç´¢å¹³è¡¡æ ‘ï¼Œå¹¿æ³›ç”¨åœ¨C++çš„STLä¸­ã€‚å¦‚mapå’Œsetéƒ½æ˜¯ç”¨çº¢é»‘æ ‘å®ç°çš„ã€‚Javaç”¨å®ƒæ¥å®ç°TreeMapã€‚è‘—åçš„linuxè¿›ç¨‹è°ƒåº¦Completely Fair Scheduler,ç”¨çº¢é»‘æ ‘ç®¡ç†è¿›ç¨‹æ§åˆ¶å—ã€‚\n epollåœ¨å†…æ ¸ä¸­çš„å®ç°ï¼Œç”¨çº¢é»‘æ ‘ç®¡ç†äº‹ä»¶å— nginxä¸­ï¼Œç”¨çº¢é»‘æ ‘ç®¡ç†timerç­‰  Code å®ç°ï¼šhttps://www.cnblogs.com/skywang12345/p/3624291.html\nçº¢é»‘æ ‘èŠ‚ç‚¹å®šä¹‰ 1 2 3 4 5 6 7 8 9 10 11 12  template \u0026lt;class T\u0026gt; class RBTNode { public: RBTColor color; // é¢œè‰²  T key; // å…³é”®å­—(é”®å€¼)  RBTNode *left; // å·¦å­©å­  RBTNode *right; // å³å­©å­  RBTNode *parent; // çˆ¶ç»“ç‚¹  RBTNode(T value, RBTColor c, RBTNode *p, RBTNode *l, RBTNode *r) : key(value), color(c), parent(), left(l), right(r) {} };   é¢œè‰²å®šä¹‰ 1 2 3 4 5  enum RBTColor { RED, BLACK };   4.Bæ ‘ èƒŒæ™¯\nä¸€ä¸ªæ¯”è¾ƒå®é™…çš„é—®é¢˜ï¼šå°±æ˜¯å¤§é‡æ•°æ®å­˜å‚¨ä¸­ï¼Œå®ç°æŸ¥è¯¢è¿™æ ·ä¸€ä¸ªå®é™…èƒŒæ™¯ä¸‹ï¼Œå¹³è¡¡äºŒå‰æ ‘ç”±äºæ ‘æ·±åº¦è¿‡å¤§è€Œé€ æˆç£ç›˜IOè¯»å†™è¿‡äºé¢‘ç¹ï¼Œè¿›è€Œå¯¼è‡´æ•ˆç‡ä½ä¸‹ã€‚é‚£ä¹ˆå¦‚ä½•å‡å°‘æ ‘çš„æ·±åº¦ï¼ˆå½“ç„¶ä¸èƒ½å‡å°‘æŸ¥è¯¢æ•°æ®é‡ï¼‰ï¼Œä¸€ä¸ªåŸºæœ¬çš„æƒ³æ³•å°±æ˜¯ï¼š\n  æ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨å¤šä¸ªå…ƒç´  ï¼ˆä½†å…ƒç´ æ•°é‡ä¸èƒ½æ— é™å¤šï¼Œå¦åˆ™æŸ¥æ‰¾å°±é€€åŒ–æˆäº†èŠ‚ç‚¹å†…éƒ¨çš„çº¿æ€§æŸ¥æ‰¾äº†ï¼‰ã€‚\n  æ‘’å¼ƒäºŒå‰æ ‘ç»“æ„ï¼Œé‡‡ç”¨å¤šå‰æ ‘ ï¼ˆç”±äºèŠ‚ç‚¹å†…å…ƒç´ æ•°é‡ä¸èƒ½æ— é™å¤šï¼Œè‡ªç„¶å­æ ‘çš„æ•°é‡ä¹Ÿå°±ä¸ä¼šæ— é™å¤šäº†ï¼‰ã€‚\n  è¿™æ ·æˆ‘ä»¬å°±æå‡ºæ¥äº†ä¸€ä¸ªæ–°çš„æŸ¥æ‰¾æ ‘ç»“æ„ â€”â€”å¤šè·¯æŸ¥æ‰¾æ ‘ã€‚ æ ¹æ®AVLç»™æˆ‘ä»¬çš„å¯å‘ï¼Œä¸€é¢—å¹³è¡¡å¤šè·¯æŸ¥æ‰¾æ ‘(B~æ ‘) è‡ªç„¶å¯ä»¥ä½¿å¾—æ•°æ®çš„æŸ¥æ‰¾æ•ˆç‡ä¿è¯åœ¨O(logN)è¿™æ ·çš„å¯¹æ•°çº§åˆ«ä¸Šã€‚\n ç›®å‰å¤§éƒ¨åˆ†æ•°æ®åº“ç³»ç»ŸåŠæ–‡ä»¶ç³»ç»Ÿéƒ½é‡‡ç”¨B-Treeæˆ–å…¶å˜ç§B+Treeä½œä¸ºç´¢å¼•ç»“æ„\n B-æ ‘ B-æ ‘æ˜¯ä¸€ç§å¤šè·¯æœç´¢æ ‘ã€‚\nB-Tree æ˜¯æ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„æ•°æ®ç»“æ„ï¼š\n d ä¸ºå¤§äº 1 çš„ä¸€ä¸ªæ­£æ•´æ•°ï¼Œç§°ä¸º B-Tree çš„åº¦ã€‚ h ä¸ºä¸€ä¸ªæ­£æ•´æ•°ï¼Œç§°ä¸º B-Tree çš„é«˜åº¦ã€‚ æ¯ä¸ªéå¶å­èŠ‚ç‚¹ç”± n-1 ä¸ª key å’Œ n ä¸ªæŒ‡é’ˆç»„æˆï¼Œå…¶ä¸­ d\u0026lt;=n\u0026lt;=2dã€‚ æ¯ä¸ªå¶å­èŠ‚ç‚¹æœ€å°‘åŒ…å«ä¸€ä¸ª key å’Œä¸¤ä¸ªæŒ‡é’ˆï¼Œæœ€å¤šåŒ…å« 2d-1 ä¸ª key å’Œ 2d ä¸ªæŒ‡é’ˆï¼Œå¶èŠ‚ç‚¹çš„æŒ‡é’ˆå‡ä¸º null ã€‚ æ‰€æœ‰å¶èŠ‚ç‚¹å…·æœ‰ç›¸åŒçš„æ·±åº¦ï¼Œç­‰äºæ ‘é«˜ hã€‚ key å’ŒæŒ‡é’ˆäº’ç›¸é—´éš”ï¼ŒèŠ‚ç‚¹ä¸¤ç«¯æ˜¯æŒ‡é’ˆã€‚ ä¸€ä¸ªèŠ‚ç‚¹ä¸­çš„ key ä»å·¦åˆ°å³éé€’å‡æ’åˆ—ã€‚ æ‰€æœ‰èŠ‚ç‚¹ç»„æˆæ ‘ç»“æ„ã€‚ æ¯ä¸ªæŒ‡é’ˆè¦ä¹ˆä¸º nullï¼Œè¦ä¹ˆæŒ‡å‘å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹ã€‚ å¦‚æœæŸä¸ªæŒ‡é’ˆåœ¨èŠ‚ç‚¹ node æœ€å·¦è¾¹ä¸”ä¸ä¸º nullï¼Œåˆ™å…¶æŒ‡å‘èŠ‚ç‚¹çš„æ‰€æœ‰ key å°äº v(key1)ï¼Œå…¶ä¸­ v(key1) ä¸º node çš„ç¬¬ä¸€ä¸ª key çš„å€¼ã€‚ å¦‚æœæŸä¸ªæŒ‡é’ˆåœ¨èŠ‚ç‚¹ node æœ€å³è¾¹ä¸”ä¸ä¸º nullï¼Œåˆ™å…¶æŒ‡å‘èŠ‚ç‚¹çš„æ‰€æœ‰ key å¤§äº v(keym)ï¼Œå…¶ä¸­ v(keym) ä¸º node çš„æœ€åä¸€ä¸ª key çš„å€¼ã€‚ å¦‚æœæŸä¸ªæŒ‡é’ˆåœ¨èŠ‚ç‚¹ node çš„å·¦å³ç›¸é‚» key åˆ†åˆ«æ˜¯ keyi å’Œ keyi+1 ä¸”ä¸ä¸º nullï¼Œåˆ™å…¶æŒ‡å‘èŠ‚ç‚¹çš„æ‰€æœ‰ key å°äº v(keyi+1) ä¸”å¤§äº v(keyi)ã€‚  æ€§è´¨ï¼š\n  æ ¹ç»“ç‚¹è‡³å°‘æœ‰ä¸¤ä¸ªå­å¥³ï¼›\n  æ¯ä¸ªéæ ¹èŠ‚ç‚¹æ‰€åŒ…å«çš„å…³é”®å­—ä¸ªæ•° j æ»¡è¶³ï¼šâ”Œm/2â” - 1 \u0026lt;= j \u0026lt;= m - 1ï¼›\n  é™¤æ ¹ç»“ç‚¹ä»¥å¤–çš„æ‰€æœ‰ç»“ç‚¹ï¼ˆä¸åŒ…æ‹¬å¶å­ç»“ç‚¹ï¼‰çš„åº¦æ•°æ­£å¥½æ˜¯å…³é”®å­—æ€»æ•°åŠ 1ï¼Œæ•…å†…éƒ¨å­æ ‘ä¸ªæ•° k æ»¡è¶³ï¼šâ”Œm/2â” \u0026lt;= k \u0026lt;= m ï¼›\n  æ‰€æœ‰çš„å¶å­ç»“ç‚¹éƒ½ä½äºåŒä¸€å±‚ã€‚\n   ç”¨åœ¨ç£ç›˜æ–‡ä»¶ç»„ç»‡ æ•°æ®ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ã€‚\n B-Tree ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹æ ¹æ®å®é™…æƒ…å†µå¯ä»¥åŒ…å«å¤§é‡çš„å…³é”®å­—ä¿¡æ¯å’Œåˆ†æ”¯ï¼Œä¾‹ï¼š\næ¯ä¸ªèŠ‚ç‚¹å ç”¨ä¸€ä¸ªç›˜å—çš„ç£ç›˜ç©ºé—´ï¼Œä¸€ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ä¸¤ä¸ªå‡åºæ’åºçš„å…³é”®å­—å’Œä¸‰ä¸ªæŒ‡å‘å­æ ‘æ ¹èŠ‚ç‚¹çš„æŒ‡é’ˆï¼ŒæŒ‡é’ˆå­˜å‚¨çš„æ˜¯å­èŠ‚ç‚¹æ‰€åœ¨ç£ç›˜å—çš„åœ°å€ã€‚\nä¸¤ä¸ªå…³é”®è¯åˆ’åˆ†æˆçš„ä¸‰ä¸ªèŒƒå›´åŸŸå¯¹åº”ä¸‰ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®çš„èŒƒå›´åŸŸã€‚\nä»¥æ ¹èŠ‚ç‚¹ä¸ºä¾‹ï¼Œå…³é”®å­—ä¸º 17 å’Œ 35ï¼ŒP1 æŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®èŒƒå›´ä¸ºå°äº 17ï¼ŒP2 æŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®èŒƒå›´ä¸º 17~35ï¼ŒP3 æŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®èŒƒå›´ä¸ºå¤§äº 35ã€‚\næ¨¡æ‹ŸæŸ¥æ‰¾å…³é”®å­— 29 çš„è¿‡ç¨‹ï¼š\n æ ¹æ®æ ¹èŠ‚ç‚¹æ‰¾åˆ°ç£ç›˜å— 1ï¼Œè¯»å…¥å†…å­˜ã€‚ã€ç£ç›˜ I/O æ“ä½œç¬¬ 1 æ¬¡ã€‘ æ¯”è¾ƒå…³é”®å­— 29 åœ¨åŒºé—´ï¼ˆ17,35ï¼‰ï¼Œæ‰¾åˆ°ç£ç›˜å— 1 çš„æŒ‡é’ˆ P2ã€‚ æ ¹æ® P2 æŒ‡é’ˆæ‰¾åˆ°ç£ç›˜å— 3ï¼Œè¯»å…¥å†…å­˜ã€‚ã€ç£ç›˜ I/O æ“ä½œç¬¬ 2 æ¬¡ã€‘ æ¯”è¾ƒå…³é”®å­— 29 åœ¨åŒºé—´ï¼ˆ26,30ï¼‰ï¼Œæ‰¾åˆ°ç£ç›˜å— 3 çš„æŒ‡é’ˆ P2ã€‚ æ ¹æ® P2 æŒ‡é’ˆæ‰¾åˆ°ç£ç›˜å— 8ï¼Œè¯»å…¥å†…å­˜ã€‚ã€ç£ç›˜ I/O æ“ä½œç¬¬ 3 æ¬¡ã€‘ åœ¨ç£ç›˜å— 8 ä¸­çš„å…³é”®å­—åˆ—è¡¨ä¸­æ‰¾åˆ°å…³é”®å­— 29ã€‚   B-Tree ç›¸å¯¹äº AVLTree ç¼©å‡äº†èŠ‚ç‚¹ä¸ªæ•°ï¼Œä½¿æ¯æ¬¡ç£ç›˜ I/O å–åˆ°å†…å­˜çš„æ•°æ®éƒ½å‘æŒ¥äº†ä½œç”¨ï¼Œä»è€Œæé«˜äº†æŸ¥è¯¢æ•ˆç‡ã€‚\n B+æ ‘ B+æ ‘æ˜¯B-æ ‘çš„å˜ä½“ï¼Œä¹Ÿæ˜¯ä¸€ç§å¤šè·¯æœç´¢æ ‘ï¼š\n1.å…¶å®šä¹‰åŸºæœ¬ä¸B-æ ‘åŒï¼Œé™¤äº†ï¼š\n2.éå¶å­ç»“ç‚¹çš„å­æ ‘æŒ‡é’ˆä¸å…³é”®å­—ä¸ªæ•°ç›¸åŒï¼›\n3.éå¶å­ç»“ç‚¹çš„å­æ ‘æŒ‡é’ˆP[i]ï¼ŒæŒ‡å‘å…³é”®å­—å€¼å±äº[K[i], K[i+1])çš„å­æ ‘\nï¼ˆB-æ ‘æ˜¯å¼€åŒºé—´ï¼‰ï¼›\n5.ä¸ºæ‰€æœ‰å¶å­ç»“ç‚¹å¢åŠ ä¸€ä¸ªé“¾æŒ‡é’ˆï¼›\n6.æ‰€æœ‰å…³é”®å­—éƒ½åœ¨å¶å­ç»“ç‚¹å‡ºç°ï¼›\n ç”¨åœ¨ç£ç›˜æ–‡ä»¶ç»„ç»‡ æ•°æ®ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ã€‚MySQLå¸¸ç”¨çš„å¼•æ“InnoDB å’Œ Myisam éƒ½æ˜¯ç”¨ B+Tree æ¥å­˜å‚¨æ•°æ®çš„ã€‚\nBå’ŒB+ä¸»è¦ç”¨åœ¨æ–‡ä»¶ç³»ç»Ÿä»¥åŠæ•°æ®åº“ä¸­åšç´¢å¼•ç­‰ï¼Œæ¯”å¦‚Mysqlï¼šB-Tree Index in MySql\n  åœ¨ B-Tree ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸­æœ‰ keyï¼Œä¹Ÿæœ‰ dataï¼Œè€Œæ¯ä¸€ä¸ªé¡µçš„å­˜å‚¨ç©ºé—´æ˜¯æœ‰é™çš„ï¼Œå¦‚æœ data æ•°æ®è¾ƒå¤§æ—¶å°†ä¼šå¯¼è‡´æ¯ä¸ªèŠ‚ç‚¹ï¼ˆå³ä¸€ä¸ªé¡µï¼‰èƒ½å­˜å‚¨çš„ key çš„æ•°é‡å¾ˆå°ã€‚å½“å­˜å‚¨çš„æ•°æ®é‡å¾ˆå¤§æ—¶åŒæ ·ä¼šå¯¼è‡´ B-Tree çš„æ·±åº¦è¾ƒå¤§ï¼Œå¢å¤§æŸ¥è¯¢æ—¶çš„ç£ç›˜ I/O æ¬¡æ•°ï¼Œè¿›è€Œå½±å“æŸ¥è¯¢æ•ˆç‡ã€‚\n B+Tree æ˜¯åœ¨ B-Tree åŸºç¡€ä¸Šçš„ä¸€ç§ä¼˜åŒ–ï¼Œä½¿å…¶æ›´é€‚åˆå®ç°å¤–å­˜å‚¨ç´¢å¼•ç»“æ„ï¼ŒInnoDB å­˜å‚¨å¼•æ“å°±æ˜¯ç”¨ B+Tree å®ç°å…¶ç´¢å¼•ç»“æ„ã€‚\nB+Tree åœ¨ B-Tree çš„åŸºç¡€ä¸Šæœ‰ä¸¤ç‚¹å˜åŒ–ï¼š\n æ•°æ®æ˜¯å­˜åœ¨å¶å­èŠ‚ç‚¹ä¸­çš„ï¼› æ•°æ®èŠ‚ç‚¹ä¹‹é—´æ˜¯æœ‰æŒ‡é’ˆæŒ‡å‘çš„ã€‚  ç”±äº B+Tree çš„éå¶å­èŠ‚ç‚¹åªå­˜å‚¨é”®å€¼ä¿¡æ¯ï¼Œå‡è®¾æ¯ä¸ªç£ç›˜å—èƒ½å­˜å‚¨ 4 ä¸ªé”®å€¼åŠæŒ‡é’ˆä¿¡æ¯ï¼Œåˆ™å˜æˆ B+Tree åå…¶ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nMySQLåº”ç”¨ æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„åœ¨æŸä¸ªå­—æ®µä¸Šå»ºç´¢å¼•ï¼Œæ„æ€å°±æ˜¯è®© MySQL å¯¹è¯¥å­—æ®µä»¥ç´¢å¼•è¿™ç§æ•°æ®ç»“æ„æ¥å­˜å‚¨ï¼Œç„¶åæŸ¥æ‰¾çš„æ—¶å€™å°±æœ‰å¯¹åº”çš„æŸ¥æ‰¾ç®—æ³•ã€‚\nå»ºç´¢å¼•çš„æ ¹æœ¬ç›®çš„æ˜¯ä¸ºäº†æŸ¥æ‰¾çš„ä¼˜åŒ–ï¼Œç‰¹åˆ«æ˜¯å½“æ•°æ®å¾ˆåºå¤§çš„æ—¶å€™ï¼Œä¸€èˆ¬çš„æŸ¥æ‰¾ç®—æ³•æœ‰é¡ºåºæŸ¥æ‰¾ã€æŠ˜åŠæŸ¥æ‰¾ã€å¿«é€ŸæŸ¥æ‰¾ç­‰ã€‚\n InnoDB\nInnoDB çš„å­˜å‚¨æ–‡ä»¶æœ‰ä¸¤ä¸ªï¼Œåç¼€ååˆ†åˆ«æ˜¯ .frm å’Œ .idbï¼Œå…¶ä¸­ .frm æ˜¯è¡¨çš„å®šä¹‰æ–‡ä»¶ï¼Œè€Œ idb æ˜¯æ•°æ®æ–‡ä»¶ã€‚  InnoDB ä¸­å­˜åœ¨è¡¨é”å’Œè¡Œé”ï¼Œä¸è¿‡è¡Œé”æ˜¯åœ¨å‘½ä¸­ç´¢å¼•çš„æƒ…å†µä¸‹æ‰ä¼šèµ·ä½œç”¨ã€‚\nInnoDB æ”¯æŒäº‹åŠ¡ï¼Œä¸”æ”¯æŒå››ç§éš”ç¦»çº§åˆ«ï¼ˆè¯»æœªæäº¤ã€è¯»å·²æäº¤ã€å¯é‡å¤è¯»ã€ä¸²è¡ŒåŒ–ï¼‰ï¼Œé»˜è®¤çš„ä¸ºå¯é‡å¤è¯»ï¼›è€Œåœ¨ Oracle æ•°æ®åº“ä¸­ï¼Œåªæ”¯æŒä¸²è¡ŒåŒ–çº§åˆ«å’Œè¯»å·²æäº¤è¿™ä¸¤ç§çº§åˆ«ï¼Œå…¶ä¸­é»˜è®¤çš„ä¸ºè¯»å·²æäº¤çº§åˆ«ã€‚\nInnoDB é€šè¿‡ B+Tree ç»“æ„å¯¹ ID å»ºç´¢å¼•ï¼Œç„¶ååœ¨å¶å­èŠ‚ç‚¹ä¸­å­˜å‚¨è®°å½•ã€‚\nMyisam\nMyisam çš„å­˜å‚¨æ–‡ä»¶æœ‰ä¸‰ä¸ªï¼Œåç¼€ååˆ†åˆ«æ˜¯ .frmã€.MYDã€MYIï¼Œå…¶ä¸­ .frm æ˜¯è¡¨çš„å®šä¹‰æ–‡ä»¶ï¼Œ.MYD æ˜¯æ•°æ®æ–‡ä»¶ï¼Œ.MYI æ˜¯ç´¢å¼•æ–‡ä»¶ã€‚  Myisam åªæ”¯æŒè¡¨é”ï¼Œä¸”ä¸æ”¯æŒäº‹åŠ¡ã€‚Myisam ç”±äºæœ‰å•ç‹¬çš„ç´¢å¼•æ–‡ä»¶ï¼Œåœ¨è¯»å–æ•°æ®æ–¹é¢çš„æ€§èƒ½å¾ˆé«˜ ã€‚\nç”±äº Myisam ä¸­çš„ç´¢å¼•å’Œæ•°æ®åˆ†åˆ«å­˜æ”¾åœ¨ä¸åŒçš„æ–‡ä»¶ï¼Œæ‰€ä»¥åœ¨ç´¢å¼•æ ‘ä¸­çš„å¶å­èŠ‚ç‚¹ä¸­å­˜çš„æ•°æ®æ˜¯è¯¥ç´¢å¼•å¯¹åº”çš„æ•°æ®è®°å½•çš„åœ°å€ï¼Œç”±äºæ•°æ®ä¸ç´¢å¼•ä¸åœ¨ä¸€èµ·ï¼Œæ‰€ä»¥ Myisam æ˜¯éèšç°‡ç´¢å¼•ã€‚\nçº¢é»‘æ ‘å’Œå¤šè·¯æŸ¥æ‰¾æ ‘éƒ½æ˜¯å±äºæ·±åº¦æœ‰ç•ŒæŸ¥æ‰¾æ ‘ï¼ˆdepth-bounded tree â€”DBTï¼‰\n2-3-4æ ‘ 2-3-4 æ ‘åœ¨è®¡ç®—æœºç§‘å­¦ä¸­æ˜¯é˜¶ä¸º 4 çš„Bæ ‘ã€‚\n2-3-4 æ ‘æŠŠæ•°æ®å­˜å‚¨åœ¨å«åšå…ƒç´ çš„å•ç‹¬å•å…ƒä¸­ã€‚å®ƒä»¬ç»„åˆæˆèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸‹åˆ—ä¹‹ä¸€\n 2-èŠ‚ç‚¹ï¼Œå°±æ˜¯è¯´ï¼Œå®ƒåŒ…å« 1 ä¸ªå…ƒç´ å’Œ 2 ä¸ªå„¿å­ï¼Œ 3-èŠ‚ç‚¹ï¼Œå°±æ˜¯è¯´ï¼Œå®ƒåŒ…å« 2 ä¸ªå…ƒç´ å’Œ 3 ä¸ªå„¿å­ï¼Œ 4-èŠ‚ç‚¹ï¼Œå°±æ˜¯è¯´ï¼Œå®ƒåŒ…å« 3 ä¸ªå…ƒç´ å’Œ 4 ä¸ªå„¿å­ ã€‚  æ¯ä¸ªå„¿å­éƒ½æ˜¯ï¼ˆå¯èƒ½ä¸ºç©ºï¼‰ä¸€ä¸ªå­ 2-3-4 æ ‘ã€‚æ ¹èŠ‚ç‚¹æ˜¯å…¶ä¸­æ²¡æœ‰çˆ¶äº²çš„é‚£ä¸ªèŠ‚ç‚¹ï¼›å®ƒåœ¨éå†æ ‘çš„æ—¶å€™å……å½“èµ·ç‚¹ï¼Œå› ä¸ºä»å®ƒå¯ä»¥åˆ°è¾¾æ‰€æœ‰çš„å…¶ä»–èŠ‚ç‚¹ã€‚å¶å­èŠ‚ç‚¹æ˜¯æœ‰è‡³å°‘ä¸€ä¸ªç©ºå„¿å­çš„èŠ‚ç‚¹ã€‚\nåŒBæ ‘ä¸€æ ·ï¼Œ2-3-4 æ ‘æ˜¯æœ‰åºçš„ï¼šæ¯ä¸ªå…ƒç´ å¿…é¡»å¤§äºæˆ–ç­‰äºå®ƒå·¦è¾¹çš„å’Œå®ƒçš„å·¦å­æ ‘ä¸­çš„ä»»ä½•å…¶ä»–å…ƒç´ ã€‚æ¯ä¸ªå„¿å­å› æ­¤æˆä¸ºäº†ç”±å®ƒçš„å·¦å’Œå³å…ƒç´ ç•Œå®šçš„ä¸€ä¸ªåŒºé—´ã€‚\n2-3-4 æ ‘æ˜¯çº¢é»‘æ ‘çš„ä¸€ç§ç­‰åŒï¼Œè¿™æ„å‘³ç€å®ƒä»¬æ˜¯ç­‰ä»·çš„æ•°æ®ç»“æ„ã€‚æ¢å¥è¯è¯´ï¼Œå¯¹äºæ¯ä¸ª 2-3-4 æ ‘ï¼Œéƒ½å­˜åœ¨ç€è‡³å°‘ä¸€ä¸ªæ•°æ®å…ƒç´ æ˜¯ç›¸åŒæ¬¡åºçš„çº¢é»‘æ ‘ã€‚åœ¨ 2-3-4 æ ‘ä¸Šçš„æ’å…¥å’Œåˆ é™¤æ“ä½œä¹Ÿç­‰ä»·äºåœ¨çº¢é»‘æ ‘ä¸­çš„é¢œè‰²ç¿»è½¬å’Œæ—‹è½¬ã€‚è¿™ä½¿å¾—å®ƒæˆä¸ºç†è§£çº¢é»‘æ ‘èƒŒåçš„é€»è¾‘çš„é‡è¦å·¥å…·ã€‚\nå­—å…¸æ ‘ (åˆç§°trie æ ‘ï¼Œå•è¯æŸ¥æ‰¾æ ‘)\n1.åˆç§°å•è¯æŸ¥æ‰¾æ ‘ï¼ŒTrieæ ‘ï¼Œæ˜¯ä¸€ç§æ ‘å½¢ç»“æ„ï¼Œæ˜¯ä¸€ç§å“ˆå¸Œæ ‘çš„å˜ç§ã€‚\nå…¸å‹åº”ç”¨æ˜¯ç”¨äºç»Ÿè®¡ï¼Œæ’åºå’Œä¿å­˜å¤§é‡çš„å­—ç¬¦ä¸²ï¼ˆä½†ä¸ä»…é™äºå­—ç¬¦ä¸²ï¼‰ï¼Œæ‰€ä»¥ç»å¸¸è¢«æœç´¢å¼•æ“ç³»ç»Ÿç”¨äºæ–‡æœ¬è¯é¢‘ç»Ÿè®¡ã€‚\n2.å®ƒçš„ä¼˜ç‚¹æ˜¯ï¼šåˆ©ç”¨å­—ç¬¦ä¸²çš„å…¬å…±å‰ç¼€æ¥èŠ‚çº¦å­˜å‚¨ç©ºé—´ï¼Œæœ€å¤§é™åº¦åœ°å‡å°‘æ— è°“çš„å­—ç¬¦ä¸²æ¯”è¾ƒï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”å“ˆå¸Œè¡¨é«˜ã€‚\n3.å­—å…¸æ ‘ä¸å­—å…¸å¾ˆç›¸ä¼¼,å½“ä½ è¦æŸ¥ä¸€ä¸ªå•è¯æ˜¯ä¸æ˜¯åœ¨å­—å…¸æ ‘ä¸­,é¦–å…ˆçœ‹å•è¯çš„ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯ä¸æ˜¯åœ¨å­—å…¸çš„ç¬¬ä¸€å±‚,å¦‚æœä¸åœ¨,è¯´æ˜å­—å…¸æ ‘é‡Œæ²¡æœ‰è¯¥å•è¯,å¦‚æœåœ¨å°±åœ¨è¯¥å­—æ¯çš„å­©å­èŠ‚ç‚¹é‡Œæ‰¾æ˜¯ä¸æ˜¯æœ‰å•è¯çš„ç¬¬äºŒä¸ªå­—æ¯,æ²¡æœ‰è¯´æ˜æ²¡æœ‰è¯¥å•è¯,æœ‰çš„è¯ç”¨åŒæ ·çš„æ–¹æ³•ç»§ç»­æŸ¥æ‰¾.å­—å…¸æ ‘ä¸ä»…å¯ä»¥ç”¨æ¥å‚¨å­˜å­—æ¯,ä¹Ÿå¯ä»¥å‚¨å­˜æ•°å­—ç­‰å…¶å®ƒæ•°æ®ã€‚\n ç”¨åœ¨ç»Ÿè®¡å’Œæ’åºå¤§é‡å­—ç¬¦ä¸²ï¼Œå¦‚è‡ªåŠ¨æœºã€‚\ntrie æ ‘çš„ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯å‰ç¼€åŒ¹é…ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªå¾ˆå¸¸è§çš„åœºæ™¯ï¼Œåœ¨æˆ‘ä»¬è¾“å…¥æ—¶ï¼Œæœç´¢å¼•æ“ä¼šç»™äºˆæç¤º\nè¿˜æœ‰æ¯”å¦‚IPé€‰è·¯ï¼Œä¹Ÿæ˜¯å‰ç¼€åŒ¹é…ï¼Œä¸€å®šç¨‹åº¦ä¼šç”¨åˆ°trie\n  åç¼€æ ‘\n  å¹¿ä¹‰åç¼€æ ‘\n  å‚è€ƒï¼š\n https://www.cnblogs.com/zhuyf87/archive/2012/11/09/2763113.html äºŒå‰æ’åºæ ‘ https://www.cnblogs.com/fornever/archive/2011/11/15/2249492.html å¹³è¡¡äºŒå‰æ ‘ï¼ˆè§£æƒ‘ï¼‰ https://www.iteye.com/blog/hxraid-609949 å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ https://www.iteye.com/blog/hxraid-611816 çº¢é»‘æ ‘(RBT) https://www.zhihu.com/question/30527705 æ ‘çš„åº”ç”¨åœºæ™¯ è¯´ä¸€ä¸‹èšç°‡ç´¢å¼• \u0026amp; éèšç°‡ç´¢å¼• MySQLç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„åŠç®—æ³•åŸç† ","description":"","id":18,"section":"posts","tags":["äºŒå‰æ ‘"],"title":"é«˜çº§çš„äºŒå‰æ ‘","uri":"https://hugo.jiahongw.com/zh/posts/algorithmstructure/bst/"},{"content":"åœ°å€ï¼šhttp://markdown.xiaoshujiang.com/\nThis is a Test!\n","description":"","id":19,"section":"posts","tags":["å°ä¹¦åŒ "],"title":"ä½¿ç”¨å°ä¹¦åŒ åœ¨çº¿ç¼–å†™åšæ–‡","uri":"https://hugo.jiahongw.com/zh/posts/hugo/xiaoshujiang/"},{"content":"åœ¨UE4ä¸­è·å–æ·±åº¦ç¼“å­˜ï¼Œè°ƒç”¨æ¸²æŸ“å‘½ä»¤è¯»å–ã€‚\nè·å–æ·±åº¦ç¼“å­˜ æ·±åº¦åƒç´ æ ¼å¼ é”®å…¥å‘½ä»¤vis scenedepthz uv0ä»¥æŸ¥çœ‹å®é™…ä½¿ç”¨çš„æ·±åº¦ç¼“å†²åŒºã€‚UE4å¯¹åœºæ™¯ä½¿ç”¨â€œåå‘â€æ·±åº¦ç¼“å†²åŒºã€‚\nWay1ï¼šç›´æ¥ä½¿ç”¨ENQUEUE_RENDER_COMMANDå‘½ä»¤è·å–(æ•ˆç‡è¾ƒä½) åœ¨ä»»æ„tickå‡½æ•°æˆ–è€…å…¶ä»–å‡½æ•°æ·»åŠ ä»¥ä¸‹çš„å‘½ä»¤ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  struct DepthPixel\t//å®šä¹‰æ·±åº¦åƒç´ ç»“æ„ä½“ \t{ float depth; char stencil; char unused1; char unused2; char unused3; }; float* cpuDataPtr;\t// Textureæ·±åº¦å€¼æ•°ç»„é¦–åœ°å€ \tTArray\u0026lt;DepthPixel\u0026gt; mydata;\t//æœ€ç»ˆè·å–è‰²æ·±åº¦å€¼æ•°æ® \tFIntPoint buffsize;\t//æ·±åº¦é•¿å®½å¤§å°Xå’ŒY  ENQUEUE_RENDER_COMMAND(ReadSurfaceFloatCommand)(\t// å°†è¯»å–æ·±åº¦æ•°æ®çš„å‘½ä»¤æ¨ç»™æ¸²æŸ“çº¿ç¨‹è¿›è¡Œæ‰§è¡Œ \t[\u0026amp;cpuDataPtr, \u0026amp;mydata, \u0026amp;buffsize](FRHICommandListImmediate\u0026amp; RHICmdList) //\u0026amp;cpuDataPtr, \u0026amp;mydata, \u0026amp;buffsizeä¸ºä¼ å…¥çš„å¤–éƒ¨å‚æ•° \t{ FSceneRenderTargets::Get(RHICmdList).AdjustGBufferRefCount(RHICmdList, 1); FTexture2DRHIRef uTex2DRes = FSceneRenderTargets::Get(RHICmdList).GetSceneDepthSurface();\tbuffsize = uTex2DRes-\u0026gt;GetSizeXY(); uint32 sx = buffsize.X; uint32 sy = buffsize.Y; mydata.AddUninitialized(sx * sy); uint32 Lolstrid = 0; cpuDataPtr = (float*)RHILockTexture2D(uTex2DRes,0,RLM_ReadOnly,Lolstrid,true);\t// åŠ é” è·å–å¯è¯»depth Textureæ·±åº¦å€¼æ•°ç»„é¦–åœ°å€ \tmemcpy(mydata.GetData(), cpuDataPtr, sx * sy * sizeof(DepthPixel));\t//å¤åˆ¶æ·±åº¦æ•°æ® \tRHIUnlockTexture2D(uTex2DRes, 0, true);\t//è§£é” \tFSceneRenderTargets::Get(RHICmdList).AdjustGBufferRefCount(RHICmdList, -1);\t}); FlushRenderingCommands();\t//ç­‰å¾…æ¸²æŸ“çº¿ç¨‹æ‰§è¡Œ  mydata; //æœ€ç»ˆè·å–æ·±åº¦æ•°æ®   æœ€ç»ˆè¿”å›çš„mydataæ•°æ®å°±æ˜¯æœ€ç»ˆçš„æ·±åº¦å€¼æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸ªæ·±åº¦å€¼çš„ç»“æ„æ˜¯DepthPixelï¼Œå…¶ä¸­ä¸€ä¸ªæˆå‘˜ä¸ºdepthï¼Œå¦å¤–å››ä¸ªä¸ä¸ä½¿ç”¨ã€‚å…¶ä¸­ä½¿ç”¨ä¸Šé¢çš„å‡ ä¸ªå‘½ä»¤éœ€è¦æ·»åŠ \u0026quot;RHI.h\u0026quot;å¤´æ–‡ä»¶\nWay2ï¼šå†™ä¸ªè¯·æ±‚ç±»è¯»å– UMLå›¾ï¼š\næµç¨‹å›¾ï¼š\n1. é¦–å…ˆåœ¨é¡¹ç›®çš„build.csæ–‡ä»¶æ·»åŠ ï¼š æ·»åŠ å¼•æ“æºç åœ°å€\n1 2 3 4 5 6 7 8 9 10  // æ·»åŠ å¼•æ“æºç åœ°å€  string EnginePath = \u0026#34;C:/Program Files (x86)/UE4+VS2017/UnrealEngine/\u0026#34;; PrivateIncludePaths.AddRange( new string[] { EnginePath + \u0026#34;Source/Runtime/Renderer/Private\u0026#34;, EnginePath + \u0026#34;Source/Runtime/Renderer/Private/CompositionLighting\u0026#34;, EnginePath + \u0026#34;Source/Runtime/Renderer/Private/PostProcess\u0026#34; } );   æ·»åŠ å¼•ä¾èµ–é¡¹\n2. ç±»å®ç° å°†ä¸‹é¢ç±»ä»£ç å¤åˆ¶åˆ°PostProcessing.hæ–‡ä»¶ä»»æ„ä½ç½®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83  /*****************************************Get Depth Class*******************************************************/ /*\tå­˜å‚¨ä¸€ä¸ªåƒç´ çš„ç¼“å­˜ depth æ·±åº¦ç¼“å­˜ stencil ï¼ˆæŠ å›¾ç¼“å­˜ï¼‰*/ struct DepthPixel { float depth; char stencil; char unused1; char unused2; char unused3; }; /*\tå­˜å‚¨æ•´ä¸ªè§†çª—çš„ç¼“å­˜ data\tåƒç´ ç¼“å­˜æ•°ç»„ bufferSizeX\tç¼“å­˜å¤§å°X bufferSizeY\tç¼“å­˜å¤§å°Y pixelSizeBytes\tåƒç´ ç¼“å­˜å­—èŠ‚æ•°*/ struct DepthResult { TArray\u0026lt;DepthPixel\u0026gt; data; int bufferSizeX; int bufferSizeY; int pixelSizeBytes; }; /*\tè·å–æ·±åº¦ç¼“å­˜çš„ç±»\t*/ class RENDERER_API DepthCapture { public: /*\té™æ€æˆå‘˜ï¼Œå½“ç”¨æˆ·å‘å‡ºä¸€ä¸ªè·å–æ·±åº¦ç¼“å­˜çš„è¯·æ±‚åï¼ŒwaitForCaptureé•¿åº¦åŠ 1ï¼Œæ–°å¢DepthResultå†…å®¹ä¸ºç©º å½“ç³»ç»Ÿå®Œæˆä¸€ä¸ªæ·±åº¦ç¼“å­˜çš„è¯·æ±‚åï¼ŒwaitForCaptureé•¿åº¦å‡ä¸€ */ static TQueue\u0026lt;DepthResult *, EQueueMode::Mpsc\u0026gt; waitForCapture; /*\té™æ€æˆå‘˜ï¼Œå½“ç³»ç»Ÿå®Œæˆä¸€ä¸ªæ·±åº¦ç¼“å­˜çš„è¯·æ±‚åï¼ŒfinishedCaptureé•¿åº¦åŠ 1ï¼Œ æ–°å¢DepthResultå«æœ‰æ·±åº¦ç¼“å­˜ä¿¡æ¯\t*/ static TQueue\u0026lt;DepthResult *, EQueueMode::Mpsc\u0026gt; finishedCapture; public: /*ç”¨æˆ·å‘å‡ºä¸€ä¸ªè·å–æ·±åº¦ç¼“å­˜çš„è¯·æ±‚æ—¶è°ƒç”¨*/ static void AddCapture() { waitForCapture.Enqueue(new DepthResult()); } /*ç³»ç»Ÿå®Œæˆä¸€ä¸ªæ·±åº¦ç¼“å­˜è¯·æ±‚åè°ƒç”¨*/ static void FinishedCapture(DepthResult *result) { finishedCapture.Enqueue(result); } /*è¿”å›æ˜¯å¦å­˜åœ¨å·²ç»å®Œæˆçš„è¯·æ±‚*/ static bool HasFinishedCapture() { return !finishedCapture.IsEmpty(); } /*å¦‚æœå­˜åœ¨å·²å®Œæˆçš„è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ªæ·±åº¦ç»“æœ*/ static DepthResult* GetIfExistFinished() { DepthResult* result = NULL; if (!finishedCapture.IsEmpty()) { finishedCapture.Dequeue(result); } return result; } /*è¿”å›æ˜¯å¦å­˜åœ¨ç­‰å¾…ç³»ç»Ÿæ‰§è¡Œçš„è¯·æ±‚*/ static bool HasCaptureRequest() { return !waitForCapture.IsEmpty(); } /*å¦‚æœå­˜åœ¨å¾…å®Œæˆçš„è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ªæ·±åº¦ç»“æœï¼ˆä¸ºç©ºï¼‰*/ static DepthResult* GetIfExistRequest() { DepthResult* result = NULL; if (!waitForCapture.IsEmpty()) { waitForCapture.Dequeue(result); } return result; } //friend void AddPostProcessingPasses(FRDGBuilder\u0026amp; GraphBuilder, const FViewInfo\u0026amp; View, const FPostProcessingInputs\u0026amp; Inputs); }; /*****************************************end******************************************************/   å°†ä¸‹é¢ç±»ä¸­é™æ€æˆå‘˜åˆå§‹åŒ–å’Œæ·»åŠ æ‰§è¡Œè·å–ä»£ç ä»£ç å¤åˆ¶åˆ°PostProcessing.cppæ–‡ä»¶ä»»æ„ä½ç½®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37  /*ç±»é™æ€æˆå‘˜çš„å®šä¹‰*/ TQueue\u0026lt;DepthResult *, EQueueMode::Mpsc\u0026gt; DepthCapture::waitForCapture; TQueue\u0026lt; DepthResult *, EQueueMode::Mpsc\u0026gt; DepthCapture::finishedCapture; /*è·å–æ·±åº¦ç¼“å­˜*/ void AddDepthInspectorPass(FRDGBuilder\u0026amp; GraphBuilder, const FViewInfo\u0026amp; View, DepthResult* result) { RDG_EVENT_SCOPE(GraphBuilder, \u0026#34;DepthInspector\u0026#34;); { // è·å–æ¸²æŸ“å¯¹è±¡ \tFSceneRenderTargets\u0026amp; renderTargets = FSceneRenderTargets::Get(GRHICommandList.GetImmediateCommandList()); // å®šä¹‰æ‹·è´å‚æ•° \tuint32 striped = 0; FIntPoint size = renderTargets.GetBufferSizeXY(); result-\u0026gt;bufferSizeX = size.X; result-\u0026gt;bufferSizeY = size.Y; result-\u0026gt;data.AddUninitialized(size.X * size.Y); // è·å–è§†çª—æŸä¸€å¸§çš„æ·±åº¦ç¼“å­˜å¯¹è±¡ \tFRHITexture2D* depthTexture = (FRHITexture2D *)renderTargets.SceneDepthZ-\u0026gt;GetRenderTargetItem().TargetableTexture.GetReference(); // æ‰§è¡Œæ‹·è´æ·±åº¦ç¼“å­˜æ“ä½œï¼Œå°†GPUæ˜¾å­˜ä¸­çš„ç¼“å­˜ä¿¡æ¯æ‹·è´åˆ°CPUå†…å­˜ä¸­ï¼Œè¿”å›æŒ‡å‘è¿™å—CPUå†…å­˜çš„é¦–åœ°å€ \tvoid* buffer = RHILockTexture2D(depthTexture, 0, EResourceLockMode::RLM_ReadOnly, striped, true); // å°†ç¼“å­˜ç»“æœæ‹·è´åˆ°resultï¼Œç”¨äºè¾“å‡º \tmemcpy(result-\u0026gt;data.GetData(), buffer, size.X * size.Y * 8); // å¿…é¡»æ‰§è¡Œè§£é”è¯­å¥ï¼Œå¦åˆ™è¢«é”ä½çš„GPUç¼“å­˜ä¿¡æ¯å°†ä¸èƒ½é‡Šæ”¾ \tRHIUnlockTexture2D(depthTexture, 0, true); // æ‹·è´ç»“æœå…¥é˜Ÿ \tDepthCapture::FinishedCapture(result); } } ////////////////////////////////////////   PostProcessing.cppä¸­è¯¥ä½ç½®æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š\nä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10  // Capture depth bufferï¼Œotherwise the buffer will be changed \tif (DepthCapture::HasCaptureRequest()) { DepthResult *reuslt; reuslt = DepthCapture::GetIfExistRequest(); if (reuslt) { AddDepthInspectorPass(GraphBuilder, View, reuslt); } }   3. è°ƒç”¨ ä½¿ç”¨ä»¥ä¸‹çš„ä»£ç å¯ä»¥è·å–æ·±åº¦å€¼ï¼Œè·å–çš„ç»“æœä¸ºresultï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  int tickcount = 0; // Called every frame void ATestPawn::Tick(float DeltaTime) { tickcount++; if (tickcount % 2 == 0)\t// è®¾è®¡å‡ å¸§è°ƒç”¨  DepthCapture::AddCapture(); // å®šæ—¶å‘å‡ºè·å–æ·±åº¦ç¼“å­˜çš„è¯·æ±‚  // å¦‚æœå­˜åœ¨å·²å®Œæˆçš„æ·±åº¦ç¼“å­˜è¯·æ±‚  if (DepthCapture::HasFinishedCapture()) { DepthResult *result; // è·å–å·²å®Œæˆçš„æ·±åº¦ç¼“å­˜ç»“æœ  result = DepthCapture::GetIfExistFinished(); if (result) { int n = result-\u0026gt;data.Num(); //this is test  GEngine-\u0026gt;AddOnScreenDebugMessage(-1, -1, FColor::Blue, FString::Printf(TEXT(\u0026#34;Get Depth Size: %d \u0026#34;), n)); } } }   ","description":"","id":20,"section":"posts","tags":["C++","UE4","Game"],"title":"UE4è·å–æ·±åº¦å€¼","uri":"https://hugo.jiahongw.com/zh/posts/ue/ue-depth/"},{"content":"æ¢ç´¢UE4æ¸¸æˆçº¿ç¨‹çš„è¿›å…¥\næ¸¸æˆçº¿ç¨‹ \u0026amp; æ¸²æŸ“çº¿ç¨‹ UE4æ¸¸æˆçº¿ç¨‹å¯åŠ¨ æ¸¸æˆçº¿ç¨‹æ¯ä¸€å¸§æ›´æ–°æ‰€æœ‰å†…å®¹ã€‚\nè¿™ä¸ªtickæ˜¯å“ªé‡Œæ‰“å¼€çš„ï¼Ÿ\nå¤´æ–‡ä»¶ï¼šEngine\\Source\\Runtime\\Launch\\Private\\Launch.cpp\nLauch.cppå®šä¹‰äº†ä¸€ä¸ªå…¨å±€çš„å˜é‡FEngineLoop GEngineLoop;\nè¯¥ç±»è·¯å¾„ï¼šEngine\\Source\\Runtime\\Launch\\Public\\LaunchEngineLoop.hï¼Œç»§æ‰¿ä¸€ä¸ªæ¥å£ç±»IEngineLoopï¼Œå®šä¹‰å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145  /** * Implements the main engine loop.\t*/ class FEngineLoop #if WITH_ENGINE\t: public IEngineLoop #endif{ public: /** Default constructor. */ FEngineLoop(); virtual ~FEngineLoop() { } public: /** * Pre-Initialize the main loop, and generates the commandline from standard ArgC/ArgV from main(). * * @param ArgC The number of strings in ArgV. * @param ArgV The command line parameters (ArgV[0] is expected to be the executable name). * @param AdditionalCommandLine Optional string to append to the command line (after ArgV is put together). * @return Returns the error level, 0 if successful and \u0026gt; 0 if there were errors. */ int32 PreInit(int32 ArgC, TCHAR* ArgV[], const TCHAR* AdditionalCommandline = nullptr); /** * Pre-Initialize the main loop - parse command line, sets up GIsEditor, etc. * * @param CmdLine The command line. * @return The error level; 0 if successful, \u0026gt; 0 if there were errors. */ int32 PreInit(const TCHAR* CmdLine); /** First part of PreInit. */ int32 PreInitPreStartupScreen(const TCHAR* CmdLine); /** Second part of PreInit. */ int32 PreInitPostStartupScreen(const TCHAR* CmdLine); /** Load all modules needed before Init. */ void LoadPreInitModules(); /** Load core modules. */ bool LoadCoreModules(); /** Clean up PreInit context. */ void CleanupPreInitContext(); #if WITH_ENGINE\t/** Load all core modules needed at startup time. */ bool LoadStartupCoreModules(); /** Load all modules needed at startup time. */ bool LoadStartupModules(); /** * Initialize the main loop (the rest of the initialization). * * @return The error level; 0 if successful, \u0026gt; 0 if there were errors. */ virtual int32 Init() override; /** Initialize the timing options from the command line. */ void InitTime(); /** Performs shut down. */ void Exit(); /** Whether the engine should operate in an idle mode that uses no CPU or GPU time. */ bool ShouldUseIdleMode() const; // Advances the main loop.æ¨è¿›ä¸»å¾ªç¯ \tvirtual void Tick() override; /** Removes references to any objects pending cleanup by deleting them. */ virtual void ClearPendingCleanupObjects() override; #endif // WITH_ENGINE  /** RHI post-init initialization */ static void PostInitRHI(); /** Pre-init HMD device (if necessary). */ static void PreInitHMDDevice(); public: /** Initializes the application. */ static bool AppInit(); /** * Prepares the application for shutdown. * * This function is called from within guarded exit code, only during non-error exits. */ static void AppPreExit(); /** * Shuts down the application. * * This function called outside guarded exit code, during all exits (including error exits). */ static void AppExit(); private: /** Utility function that processes Slate operations. */ void ProcessLocalPlayerSlateOperations() const; protected: /** Holds a dynamically expanding array of frame times in milliseconds (if FApp::IsBenchmarking() is set). */ TArray\u0026lt;float\u0026gt; FrameTimes; /** Holds the total time spent ticking engine. */ double TotalTickTime; /** Holds the maximum number of seconds engine should be ticked. */ double MaxTickTime; /** Holds the maximum number of frames to render in benchmarking mode. */ uint64 MaxFrameCounter; /** Holds the number of cycles in the last frame. */ uint32 LastFrameCycles; #if WITH_ENGINE /** Holds the objects which need to be cleaned up when the rendering thread finishes the previous frame. */ FPendingCleanupObjects* PendingCleanupObjects; #endif //WITH_ENGINE  private: #if WITH_ENGINE /** Holds the engine service. */ FEngineService* EngineService; /** Holds the application session service. */ TSharedPtr\u0026lt;ISessionService\u0026gt; SessionService; #endif // WITH_ENGINE \tFPreInitContext PreInitContext; };    è¯¥æ–‡ä»¶åªéœ€#include \u0026quot;CoreMinimal.h\u0026quot;ï¼Œæœ€å¤šåŠ ä¸Š#include \u0026quot;UnrealEngine.h\u0026quot;\n æ¥å£ç±»ï¼Œä½äºè·¯å¾„Engine\\Source\\Runtime\\Engine\\Public\\UnrealEngine.hï¼š\n1 2 3 4 5 6 7 8 9  /** Public interface to FEngineLoop so we can call it from editor or editor code */ class IEngineLoop { public: virtual int32 Init() = 0; virtual void Tick() = 0; /** Removes references to any objects pending cleanup by deleting them. */ virtual void ClearPendingCleanupObjects() = 0; };   å¼€å¯Tickå‡½æ•°ä¹‹å‰éœ€è¦åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–å‡½æ•°åœ¨Launch.cppè¿™ä¸ªæ–‡ä»¶ä¸­ï¼š\n1 2 3 4 5 6  /* Inits the engine loop */ int32 EngineInit() { int32 ErrorLevel = GEngineLoop.Init(); return( ErrorLevel ); }   GEngineLoop.Init()å‡½æ•°ï¼š\nå…¶ä¸­ä¼šåˆ¤æ–­æ˜¯è¿›å…¥é‚£ç§å¼•æ“æ¨¡å¼ï¼Œåˆ†ä¸ºGameæ¨¡å¼ä¸Editoræ¨¡å¼ã€‚\nç»“æŸå¼•æ“çš„å‡½æ•°ä¸ºï¼š\n1 2 3 4 5 6 7 8 9 10  /** * Shuts down the engine */ void EngineExit( void ) { // Make sure this is set \tRequestEngineExit(TEXT(\u0026#34;EngineExit() was called\u0026#34;)); GEngineLoop.Exit(); }   ä¹Ÿåœ¨Launch.cpp\nLaunch.cppä¸­çš„å‡½æ•°å¤šæ¬¡ä½¿ç”¨GEngineè¿™ä¸ªå¤–éƒ¨å˜é‡ï¼Œè¿™ä¸ªå˜é‡åœ¨ä¸Šé¢çš„åˆå§‹åŒ–å‡½æ•°ä¼šè‡ªå®šè®¾ç½®ä¸ºç›¸åº”çš„å¼•æ“ï¼Œå³Gameå¼•æ“æˆ–è€…Editorå¼•æ“ï¼š\n æ‰€åœ¨æ–‡ä»¶Engine.h\n åœ¨FEngineLoop::Tick()å‡½æ•°ä¼šè°ƒç”¨GEngineçš„Tickå‡½æ•°ï¼š\nä¹Ÿå°±æ˜¯æœ¬æ–‡å¼€å§‹çš„é‚£ä¸ªTickå‡½æ•°ã€‚\n","description":"","id":21,"section":"posts","tags":["C++","UE4","Game"],"title":"UEæ¸¸æˆã€æ¸²æŸ“çº¿ç¨‹","uri":"https://hugo.jiahongw.com/zh/posts/ue/ue-game-render/"},{"content":"==é€šå¸¸çš„æ¸¸æˆå¼•æ“ä¸­æ¸¸æˆçº¿ç¨‹å’Œæ¸²æŸ“çº¿ç¨‹éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç›¸äº’ä¹‹é—´ä¼šå­˜åœ¨ä¸€ä¸ªåŒæ­¥çš„æœºåˆ¶==\nKeyWord: UMG è™šå¹»ç¤ºæ„å›¾å½¢ç•Œé¢è®¾è®¡å™¨ï¼ˆUnreal Motion Graphics UI Designerï¼‰(UMG) æ˜¯ä¸€ä¸ªå¯è§†åŒ–çš„UIåˆ›ä½œå·¥å…·ï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºUIå…ƒç´ ï¼Œå¦‚æ¸¸æˆä¸­çš„HUDã€èœå•æˆ–æ‚¨å¸Œæœ›å‘ˆç°ç»™ç”¨æˆ·çš„å…¶ä»–ç•Œé¢ç›¸å…³å›¾å½¢ã€‚UMGçš„æ ¸å¿ƒæ˜¯æ§ä»¶ï¼Œè¿™äº›æ§ä»¶æ˜¯ä¸€ç³»åˆ—é¢„å…ˆåˆ¶ä½œçš„å‡½æ•°ï¼Œå¯ç”¨äºæ„å»ºç•Œé¢ï¼ˆå¦‚æŒ‰é’®ã€å¤é€‰æ¡†ã€æ»‘å—ã€è¿›åº¦æ¡ç­‰ï¼‰ã€‚è¿™äº›æ§ä»¶åœ¨ä¸“é—¨çš„æ§ä»¶è“å›¾ä¸­ç¼–è¾‘ï¼Œè¯¥è“å›¾ä½¿ç”¨ä¸¤ä¸ªé€‰é¡¹å¡è¿›è¡Œæ„é€ ï¼šè®¾è®¡å™¨ï¼ˆDesignerï¼‰é€‰é¡¹å¡å…è®¸ç•Œé¢å’ŒåŸºæœ¬å‡½æ•°çš„å¯è§†åŒ–å¸ƒå±€ï¼Œè€Œå›¾è¡¨ï¼ˆGraphï¼‰é€‰é¡¹å¡æä¾›æ‰€ä½¿ç”¨æ§ä»¶èƒŒåçš„åŠŸèƒ½ã€‚\nSlate Slate æ˜¯å®Œå…¨è‡ªå®šä¹‰ã€ä¸å¹³å°æ— å…³çš„ç”¨æˆ·ç•Œé¢æ¡†æ¶ï¼Œæ—¨åœ¨è®©å·¥å…·å’Œåº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚è™šå¹»ç¼–è¾‘å™¨ï¼‰çš„ç”¨æˆ·ç•Œé¢æˆ–æ¸¸æˆä¸­ç”¨æˆ·ç•Œé¢çš„æ„å»ºè¿‡ç¨‹å˜å¾—æœ‰è¶£ã€é«˜æ•ˆã€‚å®ƒå°†å£°æ˜æ€§è¯­æ³•ä¸è½»æ¾è®¾è®¡ã€å¸ƒå±€å’Œé£æ ¼ç»„ä»¶çš„åŠŸèƒ½ç›¸ç»“åˆï¼Œå…è®¸åœ¨UIä¸Šè½»æ¾å®ç°åˆ›å»ºå’Œè¿­ä»£ã€‚\nSlate UIè§£å†³æ–¹æ¡ˆä½¿å¾—ä¸ºå·¥å…·å’Œåº”ç”¨ç¨‹åºç»„åˆå›¾å½¢ç”¨æˆ·ç•Œé¢å’Œå¿«é€Ÿè¿­ä»£è¿™äº›ç•Œé¢å˜å¾—æå…¶ç®€å•ã€‚\nRHICmdList è¿™æ˜¯ä¸€ç»„ç‹¬ç‰¹çš„å®ï¼Œç”¨äºå°†æ“ä½œå‘é€åˆ°æ¸²æŸ“çº¿ç¨‹è¿›è¡Œæ“ä½œã€‚\nä¸»è¦æ˜¯å¯¹Textureä¹‹ç±»çš„æ•°æ®åœ¨GPUä»¥åŠGPUç›¸å…³çš„æŒ‡ä»¤è¿›è¡Œæ‰§è¡Œã€‚\næ¸²æŸ“çº¿ç¨‹çš„é€šä¿¡ å‚è€ƒé“¾æ¥ï¼š\n ã€ŠExploring in UE4ã€‹å¤šçº¿ç¨‹æœºåˆ¶è¯¦è§£[åŸç†åˆ†æ] çº¹ç†å’Œé‡‡æ ·å™¨ è™šå¹»4 Task Graph System ä»‹ç»  é¢„è§ˆ UE4å¼•æ“è¿è¡Œæ—¶çš„éƒ¨åˆ†çº¿ç¨‹ï¼Œåœ¨UEä¸­ï¼Œè®¸å¤šæ¨¡å—éƒ½ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œå¦‚æ¸²æŸ“æ¨¡å—ã€ç‰©ç†æ¨¡å—ã€ç½‘ç»œé€šä¿¡ã€éŸ³é¢‘ç³»ç»Ÿã€IOï¼š\nè™½ç„¶UE4éµå¾ªC++11çš„æ ‡å‡†ï¼Œä½†æ˜¯ä»–å¹¶æ²¡æœ‰ä½¿ç”¨std::threadï¼Œè€Œæ˜¯è‡ªå·±å®ç°äº†ä¸€å¥—å¤šçº¿ç¨‹æœºåˆ¶ï¼ˆåº”è¯¥æ˜¯ä»UE3æ—¶ä»£å°±æœ‰äº†ï¼Œæœªè€ƒè¯ï¼‰ï¼Œç”¨æ³•ä¸Šå¾ˆåƒJavaã€‚\nä½¿ç”¨çº¿ç¨‹ åœ¨UE4é‡Œé¢ï¼Œä½¿ç”¨çº¿ç¨‹æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼š\n æˆ‘ä»¬å¯ä»¥è‡ªå·±ç»§æ‰¿FRunnableæ¥å£åˆ›å»ºå•ä¸ªçº¿ç¨‹ ç›´æ¥åˆ›å»ºAsyncTaskæ¥è°ƒç”¨çº¿ç¨‹æ± é‡Œé¢ç©ºé—²çš„çº¿ç¨‹ é€šè¿‡TaskGraphç³»ç»Ÿæ¥å¼‚æ­¥å®Œæˆä¸€äº›è‡ªå®šä¹‰ä»»åŠ¡ã€‚  FRunnable çº¿ç´¢ï¼š\n   æ¨¡å— Core     .h /Engine/Source/Runtime/Core/Public/HAL/Runnable.h   include #include \u0026ldquo;HAL/Runnable.h\u0026rdquo;     UE4ä¸­æœ€åŸºç¡€çš„æ¨¡å‹å°±æ˜¯FRunnableå’ŒFRunnableThreadï¼ŒFRunnableæŠ½è±¡å‡ºä¸€ä¸ªå¯ä»¥æ‰§è¡Œåœ¨çº¿ç¨‹ä¸Šçš„å¯¹è±¡ï¼Œè€ŒFRunnableThreadæ˜¯å¹³å°æ— å…³çš„çº¿ç¨‹å¯¹è±¡çš„æŠ½è±¡ã€‚åé¢çš„ç¯‡å¹…ä¼šè¯¦ç»†è®¨è®ºè¿™äº›åŸºç¡€è®¾æ–½ã€‚\n åˆ›å»ºä¸€ä¸ªç»§æ‰¿äºFRunnableçš„ç±»ï¼ŒFRunnableå£°æ˜å¦‚ä¸‹ï¼š\n FRunnableå°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç±»ï¼Œé‡Œé¢åªæœ‰5ï¼Œ6ä¸ªå‡½æ•°æ¥å£ï¼Œä¸ºäº†ä¸çœŸæ­£çš„çº¿ç¨‹åŒºåˆ†ï¼Œæˆ‘è¿™é‡Œç§°FRunnableä¸ºâ€œçº¿ç¨‹æ‰§è¡Œä½“â€ï¼›æ‰€è°“çœŸæ­£çš„çº¿ç¨‹å…¶å®å°±æ˜¯FRunnableThreadï¼Œä¸åŒå¹³å°çš„çº¿ç¨‹éƒ½ç»§æ‰¿è‡ªä»–ï¼Œå¦‚FRunnableThreadWinï¼Œé‡Œé¢ä¼šè°ƒç”¨Windowså¹³å°çš„åˆ›å»ºçº¿ç¨‹çš„APIæ¥å£ã€‚\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59  class CORE_API FRunnable { public: /** * Initializes the runnable object. * * This method is called in the context of the thread object that aggregates this, not the * thread that passes this runnable to a new thread. * * @return True if initialization was successful, false otherwise * @see Run, Stop, Exit */ virtual bool Init() { return true; } /** * Runs the runnable object. * * This is where all per object thread work is done. This is only called if the initialization was successful. * * @return The exit code of the runnable object * @see Init, Stop, Exit */ virtual uint32 Run() = 0; /** * Stops the runnable object. * * This is called if a thread is requested to terminate early. * @see Init, Run, Exit */ virtual void Stop() { } /** * Exits the runnable object. * * Called in the context of the aggregating thread to perform any cleanup. * @see Init, Run, Stop */ virtual void Exit() { } /** * Gets single thread interface pointer used for ticking this runnable when multi-threading is disabled. * If the interface is not implemented, this runnable will not be ticked when FPlatformProcess::SupportsMultithreading() is false. * * @return Pointer to the single thread interface or nullptr if not implemented. */ virtual class FSingleThreadRunnable* GetSingleThreadInterface( ) { return nullptr; } /** Virtual destructor */ virtual ~FRunnable() { } };   FRunnableä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»ç±»å›¾ï¼š\nUE4ä¸­çš„å¤šçº¿ç¨‹æ¨¡å‹ç”¨ä¸€å¥è¯æ¦‚æ‹¬ä¸º: A FRunnable runs on a FRunnableThread.\n FQueuedThreadPoolçº¿ç¨‹æ±     æ¨¡å— Core      /Engine/Source/Runtime/Core/Public/Misc/QueuedThreadPool.h    #include \u0026ldquo;Misc/QueuedThreadPool.h\u0026rdquo;    FQueuedThreadPoolã€‚å’Œä¸€èˆ¬çš„çº¿ç¨‹æ± å®ç°ç±»ä¼¼ï¼Œçº¿ç¨‹æ± é‡Œé¢ç»´æŠ¤äº†å¤šä¸ªçº¿ç¨‹FQueuedThreadä¸å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—IQueuedWorkï¼Œçº¿ç¨‹æ˜¯æŒ‰ç…§é˜Ÿåˆ—çš„æ–¹å¼æ¥æ’åˆ—çš„ã€‚\nåœ¨çº¿ç¨‹æ± é‡Œé¢æ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯FQueuedThreadç±»å‹ï¼Œä¸è¿‡æ›´ç¡®åˆ‡çš„è¯´FQueuedThreadæ˜¯ç»§æ‰¿è‡ªFRunnableçš„çº¿ç¨‹æ‰§è¡Œä½“ï¼Œæ¯ä¸ªFQueuedThreadé‡Œé¢åŒ…å«ä¸€ä¸ªFRunnableThreadä½œä¸ºå†…éƒ¨æˆå‘˜ã€‚\nç›¸æ¯”ä¸€èˆ¬çš„çº¿ç¨‹ï¼ŒFQueuedThreadé‡Œé¢å¤šäº†ä¸€ä¸ªæˆå‘˜FEvent* DoWorkEventï¼Œä¹Ÿå°±æ˜¯è¯´FQueuedThreadé‡Œé¢æ˜¯æœ‰ä¸€ä¸ªäº‹ä»¶è§¦å‘æœºåˆ¶çš„ã€‚é‚£ä¹ˆè¿™ä¸ªäº‹ä»¶æœºåˆ¶çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿä¸€èˆ¬æƒ…å†µä¸‹æ¥è¯´ï¼Œå°±æ˜¯åœ¨æ²¡æœ‰ä»»åŠ¡çš„æ—¶å€™æŒ‚èµ·è¿™ä¸ªçº¿ç¨‹ï¼Œåœ¨æ·»åŠ å¹¶åˆ†é…ç»™è¯¥çº¿ç¨‹ä»»åŠ¡çš„æ—¶å€™æ¿€æ´»ä»–ï¼Œä¸è¿‡ä½ å¯ä»¥çµæ´»è¿ç”¨å®ƒï¼Œåœ¨ä½ éœ€è¦çš„æ—¶å€™å»åŠ¨æ€æ§åˆ¶çº¿ç¨‹ä»»åŠ¡çš„æ‰§è¡Œä¸æš‚åœã€‚\n AsyncTaskç³»ç»Ÿ AsyncTaskç³»ç»Ÿæ˜¯ä¸€å¥—åŸºäºçº¿ç¨‹æ± çš„å¼‚æ­¥ä»»åŠ¡å¤„ç†ç³»ç»Ÿã€‚\nFAsyncTaskæœ‰å‡ ä¸ªç‰¹ç‚¹ï¼š\n FAsyncTaskæ˜¯ä¸€ä¸ªæ¨¡æ¿ç±»ï¼ŒçœŸæ­£çš„AsyncTaskéœ€è¦ä½ è‡ªå·±å†™ã€‚é€šè¿‡DoWorkæä¾›ä½ è¦æ‰§è¡Œçš„å…·ä½“ä»»åŠ¡ï¼Œç„¶åæŠŠä½ çš„ç±»ä½œä¸ºæ¨¡æ¿å‚æ•°ä¼ è¿‡å» ä½¿ç”¨FAsyncTaskå°±é»˜è®¤ä½ è¦ä½¿ç”¨UEæä¾›çš„çº¿ç¨‹æ± FQueuedThreadPoolï¼Œå‰é¢ä»£ç é‡Œè¯´æ˜äº†åœ¨å¼•æ“PreInitçš„æ—¶å€™ä¼šåˆå§‹åŒ–çº¿ç¨‹æ± å¹¶è¿”å›ä¸€ä¸ªæŒ‡é’ˆGThreadPoolã€‚åœ¨æ‰§è¡ŒFAsyncTaskä»»åŠ¡æ—¶ï¼Œå¦‚æœä½ åœ¨æ‰§è¡ŒStartBackgroundTaskçš„æ—¶å€™ä¼šé»˜è®¤ä½¿ç”¨GThreadPoolçº¿ç¨‹æ± ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨å‚æ•°é‡Œé¢æŒ‡å®šè‡ªå·±åˆ›å»ºçš„çº¿ç¨‹æ±  åˆ›å»ºFAsyncTaskå¹¶ä¸ä¸€å®šè¦ä½¿ç”¨æ–°çš„çº¿ç¨‹ï¼Œä½ å¯ä»¥è°ƒç”¨å‡½æ•°StartSynchronousTaskç›´æ¥åœ¨å½“å‰çº¿ç¨‹ä¸Šæ‰§è¡Œä»»åŠ¡ FAsyncTaskæœ¬èº«åŒ…å«ä¸€ä¸ªDoneEventï¼Œä»»åŠ¡æ‰§è¡Œå®Œæˆçš„æ—¶å€™ä¼šæ¿€æ´»è¯¥äº‹ä»¶ã€‚å½“ä½ æƒ³ç­‰å¾…ä¸€ä¸ªä»»åŠ¡å®Œæˆæ—¶å†åšå…¶ä»–æ“ä½œï¼Œå°±å¯ä»¥è°ƒç”¨EnsureCompletionå‡½æ•°ï¼Œä»–å¯ä»¥ä»é˜Ÿåˆ—é‡Œé¢å–å‡ºæ¥è¿˜æ²¡è¢«æ‰§è¡Œçš„ä»»åŠ¡æ”¾åˆ°å½“å‰çº¿ç¨‹æ¥åšï¼Œä¹Ÿå¯ä»¥æŒ‚èµ·å½“å‰çº¿ç¨‹ç­‰å¾…DoneEventæ¿€æ´»åå†å¾€ä¸‹æ‰§è¡Œ  Task Graph ç³»ç»Ÿ Task Graph ç³»ç»Ÿæ˜¯UE4ä¸€å¥—æŠ½è±¡çš„å¼‚æ­¥ä»»åŠ¡å¤„ç†ç³»ç»Ÿï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªå¤šçº¿ç¨‹ä»»åŠ¡ï¼ŒæŒ‡å®šå„ä¸ªä»»åŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ŒæŒ‰ç…§è¯¥å…³ç³»æ¥ä¾æ¬¡å¤„ç†ä»»åŠ¡ã€‚\nTickå‡½æ•°\nå¹³æ—¶è°ƒè¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬éšä¾¿æ‰¾ä¸ªTickæ–­ç‚¹ä¸€ä¸‹éƒ½èƒ½çœ‹åˆ°ç±»ä¼¼ä¸‹å›¾è¿™æ ·çš„å‡½æ•°å †æ ˆã€‚å¦‚æœä½ å‰é¢çš„ç« èŠ‚éƒ½çœ‹æ‡‚çš„è¯ï¼Œè¿™ä¸ªå †æ ˆä¹Ÿèƒ½å¤§æ¦‚ç†è§£ã€‚Worldåœ¨æ‰§è¡ŒTickçš„æ—¶å€™ï¼Œè§¦å‘äº†FNamedTaskThreadçº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼ˆFTickFunctionTaskï¼‰ï¼Œä»»åŠ¡FTickFunctionTaskå…·ä½“çš„å·¥ä½œå†…å®¹å°±æ˜¯æ‰§è¡ŒACtorComponentçš„Tickå‡½æ•°ã€‚å…¶å®ï¼Œè¿™ä¸ªå †æ ˆä¹Ÿè¯´æ˜äº†æ‰€æœ‰Actorä¸Componentçš„Tickéƒ½æ˜¯é€šè¿‡TaskGraphç³»ç»Ÿæ¥æ‰§è¡Œçš„ï¼ˆåœ¨TG_PrePhysicsé˜¶æ®µï¼‰ã€‚\nCconclusion ==å¯¹äºæ¶ˆè€—å¤§çš„ï¼Œå¤æ‚çš„ä»»åŠ¡ä¸å»ºè®®ä½¿ç”¨TaskGraphï¼Œä¸€æ˜¯å› ä¸ºTaskGraphå¦‚æœè¢«åˆ†é…åˆ°æ¸¸æˆçº¿ç¨‹ï¼Œå°±ä¼šé˜»å¡æ•´ä¸ªæ¸¸æˆçº¿ç¨‹çš„æ‰§è¡Œï¼ŒäºŒæ˜¯å³ä½¿ä½ ä¸åœ¨é‚£å‡ ä¸ªæœ‰åå­—çš„çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œä¹Ÿå¯èƒ½ä¼šå½±å“åˆ°æ¸¸æˆçš„å…¶ä»–é€»è¾‘ã€‚==\nå…¨å®¶ç¦ï¼š\nçº¿ç¨‹åŒæ­¥ UE4å¯¹æ“ä½œç³»ç»Ÿæä¾›çš„çº¿ç¨‹åŒæ­¥ç›¸å…³æ¥å£è¿›è¡Œäº†ä¸€å®šçš„å°è£…ã€‚\nAtomics \u0026hellip;\u0026hellip;\n","description":"","id":22,"section":"posts","tags":["UE","C++"],"title":"UE4å¤šçº¿ç¨‹","uri":"https://hugo.jiahongw.com/zh/posts/ue/ue-thread-commuicate/"},{"content":"UE4é—®é¢˜æ±‡æ€»   UE4å…‰ç…§æ„å»ºå¤±è´¥âš \nhttps://blog.csdn.net/earlyAutumnOfRain/article/details/80863561\n  UE4å¯¼å…¥ç°åº¦å›¾\nhttps://www.cnblogs.com/gucheng/p/10116857.html\n  è¯¦è§£UE4é™æ€åº“ä¸åŠ¨æ€åº“çš„å¯¼å…¥ä¸ä½¿ç”¨\nhttps://gameinstitute.qq.com/community/detail/121551\n  Ue4_åºåˆ—åŒ–æµ…æ_\nhttps://blog.csdn.net/mohuak/article/details/83027211\n  UEå¿«æ·é”®\nhttps://www.unrealengine.com/zh-CN/tech-blog/designer-s-guide-to-unreal-engine-keyboard-shortcuts\n  UE4èµ„æºåŠ è½½ï¼ˆä¸€ï¼‰ä»StaticLoadObjectå¼€å§‹\nhttp://suo.im/6v7hUc\n  Unreal Cookbookï¼šåˆ›å»ºå¯¹è±¡çš„çš„å‡ ç§å§¿åŠ¿ï¼ˆC++ï¼‰\nhttps://blog.csdn.net/Neil3D/article/details/51488401\n  Aeryçš„UE4 C++æ¸¸æˆå¼€å‘ä¹‹æ—…ï¼ˆ1ï¼‰åŸºç¡€å¯¹è±¡æ¨¡å‹\nhttps://www.cnblogs.com/KillerAery/p/11986316.html\n  ç›®å½•ç»“æ„\nhttps://docs.unrealengine.com/zh-CN/Engine/Basics/DirectoryStructure/index.html\n  å¼•æ“ä¸–ç•Œ\nhttps://www.engineworld.cn/\n  ã€ŠInsideUE4ã€‹GamePlayæ¶æ„ï¼ˆä¸€ï¼‰Actorå’ŒComponent\nhttps://zhuanlan.zhihu.com/p/22833151\n  å®æ—¶æ¸²æŸ“ä¸­çš„åæ ‡ç³»å˜æ¢ï¼ˆ5ï¼‰ï¼šæŠ•å½±å˜æ¢-3\nhttps://zhuanlan.zhihu.com/p/115395322\n  UE4 å±å¹•åæ ‡è½¬æ¢åˆ°ä¸–ç•Œåæ ‡\nhttps://blog.csdn.net/weixin_36412907/article/details/77306212\n  UE4å¿…è¯»æ–‡ç« åˆ—è¡¨_ä¸ªäººæ•´ç†\nhttps://zhuanlan.zhihu.com/p/126611976\n  OpenGL å­¦ä¹ ç³»åˆ—\u0026mdash;æŠ•å½±çŸ©é˜µ\nhttps://juejin.im/post/5b0ec5fef265da092a2b79b1\n  Alpha Test\nhttp://geekfaner.com/shineengine/blog13_OpenGLESv2_12.html\n  Rendocä½¿ç”¨\nhttps://www.cnblogs.com/kekec/p/11760288.html\n  [å¤šè§†å›¾å‡ ä½•] - é€†é€è§†å˜æ¢\nhttps://blog.csdn.net/chishuideyu/article/details/79136903\n  UE4å¿…è¯»æ–‡ç« åˆ—è¡¨_ä¸ªäººæ•´ç†\nhttps://zhuanlan.zhihu.com/p/126611976\n  UE4ä¸­çš„Tone Mapping\nhttps://www.dingshukai.com/blog/ue4-tone-mapping.html\n  UE4 æ¸²æŸ“æµç¨‹\nhttps://blog.csdn.net/or_7r_ccl/article/details/81102771\n  [UE4]å°è¯•ä½¿ç”¨è‡ªå®šä¹‰æ·±åº¦ fq\nhttp://monsho.blog63.fc2.com/blog-entry-138.html#comment469\n  [UE4]æ‰©å±•GBuffer\nhttp://monsho.blog63.fc2.com/blog-entry-191.html\n  https://ue4study-osaka.connpass.com/event/120568/\n  UE4æ–‡ä»¶ç³»ç»Ÿ  æ¨¡å—æ˜¯UE4çš„æ„å»ºå—ã€‚å¼•æ“æ˜¯ä»¥å¤§é‡æ¨¡å—çš„é›†åˆå½¢å¼å®ç°çš„ï¼Œæ¸¸æˆæä¾›è‡ªå·±çš„æ¨¡å—æ¥æ‰©å……è‡ªå·±ã€‚æ¯ä¸ªæ¨¡å—éƒ½å°è£…äº†ä¸€ç»„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥æä¾›å…¬å…±æ¥å£å’Œç¼–è¯‘ç¯å¢ƒï¼ˆåŒ…æ‹¬å®ã€è·¯å¾„ç­‰ï¼‰ä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨ã€‚\n .build.csæ–‡ä»¶çš„å…¸å‹ç»“æ„å¦‚ä¸‹ã€‚\n1 2 3 4 5 6 7 8 9  using UnrealBuildTool; using System.Collections.Generic; public class MyModule : ModuleRules { public MyModule(ReadOnlyTargetRules Target) : base(Target) { // Settings go here  } }     \\Engine\\Source\\ThirdPartyç›®å½•\nå­˜æ”¾ç¬¬ä¸‰æ–¹çš„åº“\n  F:\\UnrealEngine4.14\\Engine\\Pluginsç›®å½•(æˆ–è€…F:\\UE4Project\\é¡¹ç›®åç§°\\Pluginsç›®å½•)\nä¿å­˜æ’ä»¶çš„ç›®å½•\n  UEåˆ›ä¸–ï¼Œä¸‡ç‰©çš†UObjectï¼Œæ¥ç€æœ‰Actorã€‚\nComponentå’ŒActor  UE4è®©Actorä»¬è½»è£…ä¸Šé˜µï¼Œåªæä¾›ä¸€äº›é€šç”¨çš„åŸºæœ¬ç”Ÿå­˜èƒ½åŠ›ï¼Œè€ŒæŠŠä¼—å¤šçš„â€œæŠ€èƒ½â€æŠ½è±¡æˆäº†ä¸€ä¸ªä¸ªâ€œComponentâ€å¹¶æä¾›ç»„è£…çš„æ¥å£ï¼Œè®©Actoréšç”¨éšç»„è£…ï¼ŒæŠŠè‡ªå·±æ­¦è£…æˆä¸€ä¸ªä¸ªä¸“ä¸šèƒ½æ‰‹ã€‚\n ç›¸å…³ç»„ä»¶ RootComponent å®šä¹‰è¿™ä¸ªæ¼”å‘˜åœ¨ä¸–ç•Œä¸Šçš„å˜æ¢(ä½ç½®ã€æ—‹è½¬ã€ç¼©æ”¾)çš„ç»„ä»¶ï¼Œæ‰€æœ‰å…¶ä»–ç»„ä»¶å¿…é¡»ä»¥æŸç§æ–¹å¼é™„åŠ åˆ°è¿™ä¸ªç»„ä»¶\nå¼¹ç°§è‡‚ç»„ä»¶ å¼¹ç°§è‡‚ç»„ä»¶ç”¨äºè‡ªåŠ¨æ§åˆ¶æ‘„åƒæœºå—é˜»æ—¶çš„åº”å¯¹æ–¹å¼ã€‚\nUEæ–‡ä»¶å­˜å‚¨çš„æ–¹å¼ UE ä¸­ä½¿ç”¨ç»Ÿä¸€çš„æ ¼å¼å­˜å‚¨èµ„æº (uassetï¼Œ umap)ï¼Œæ¯ä¸ª uasset å¯¹åº”ä¸€ä¸ªåŒ… (package)ï¼Œå­˜å‚¨ä¸€ä¸ª UPackage å¯¹è±¡æ—¶ï¼Œä¼šå°†è¯¥åŒ…ä¸‹çš„æ‰€æœ‰å¯¹è±¡éƒ½å­˜åˆ° uasset ä¸­ã€‚\n ä¸€ä¸ªèµ„æºåœ¨æ–‡ä»¶ä¸­å¯¹åº”uassetï¼Œåœ¨å†…å­˜ä¸­å¯¹åº”ä¸ºUPackageã€‚\n uassetæ–‡ä»¶æ ¼å¼  File Summary æ–‡ä»¶å¤´ä¿¡æ¯ Name Table åŒ…ä¸­å¯¹è±¡çš„åå­—è¡¨ Import Table å­˜æ”¾è¢«è¯¥åŒ…ä¸­å¯¹è±¡å¼•ç”¨çš„å…¶å®ƒåŒ…ä¸­çš„å¯¹è±¡ä¿¡æ¯(è·¯å¾„åå’Œç±»å‹) Export Table è¯¥åŒ…ä¸­çš„å¯¹è±¡ä¿¡æ¯(è·¯å¾„åå’Œç±»å‹) Export Objects æ‰€æœ‰Export Tableä¸­å¯¹è±¡çš„å®é™…æ•°æ®ã€‚  FlinkerLoad FLinkerLoadæ˜¯ä½œä¸ºuassetå’Œå†…å­˜UPackageçš„ä¸­é—´æ¡¥æ¢ã€‚åœ¨åŠ è½½å†…å®¹ç”ŸæˆUPackageçš„æ—¶å€™ï¼ŒUPackageä¼šæ ¹æ®åå­—æ‰¾åˆ°uassetæ–‡ä»¶ï¼Œç”±FLinkerLoadæ¥è´Ÿè´£åŠ è½½ã€‚\nFLinkerLoadä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š\n FArchive* Loader;\t//Loaderè´Ÿè´£è¯»å–å…·ä½“æ–‡ä»¶ TArray ImportMap; //å°†uassetçš„ImportTableåŠ è½½åˆ°ImportMapä¸­ï¼ŒFObjectImportæ˜¯éœ€è¦ä¾èµ–ï¼ˆå¯¼å…¥ï¼‰çš„UObject TArray ExportMap; //FObjectExportæ˜¯è¿™ä¸ªUPackageæ‰€æ‹¥æœ‰çš„UObjectï¼ˆè¿™äº›UObjectéƒ½èƒ½æä¾›ç»™å…¶ä»–UPackageä½œä¸ºImportï¼‰  StaticLoadObjectåŠ è½½ æ­¥éª¤ï¼š\n æ ¹æ®æ–‡ä»¶åå­—åˆ›å»ºä¸€ä¸ªç©ºçš„åŒ…ï¼ˆæ²¡æœ‰ä»»ä½•æ–‡ä»¶ç›¸å…³çš„æ•°æ®ï¼‰ å»ºç«‹ä¸€ä¸ªLinkerLoadå»åŠ è½½å¯¹åº”çš„uassetæ–‡ä»¶ åºåˆ—åŒ–ã€‚ ä¼˜å…ˆåŠ è½½ImportMap åŠ è½½ExportMapï¼ˆæœ¬èº«çš„æ•°æ®ï¼‰  1ã€å»ºç«‹ä¸€ä¸ªUPackage\n2ã€åºåˆ—åŒ–uasset\n3ã€åŠ è½½ImportMap\nPawné»˜è®¤ç»„ä»¶ UEç›¸æœº http://www.geodesic.games/2019/03/27/projection-matrices-in-unreal-engine/\n Firstly, Unreal inverses the perspective divide, applying 1 instead of -1 for the â€œWâ€ value.ï¼ˆè™šå¹»å¤„ç†æŠ•å½±ä¸ Unity ä¸­ä½¿ç”¨çš„æ ‡å‡† OpenGL é€è§†çŸ©é˜µä¸åŒã€‚ï¼‰ Secondly, Unreal applies a matrix transposition to all their perspective matrices.ï¼ˆå…¶æ¬¡ï¼ŒUnreal å¯¹æ‰€æœ‰çš„é€è§†çŸ©é˜µè¿›è¡Œäº†çŸ©é˜µç§»ä½ã€‚  ç¼ºçœæƒ…å†µä¸‹ï¼ŒUnreal æä¾›äº†å„ç§æ–¹ä¾¿çš„é€è§†çŸ©é˜µæ„é€ å‡½æ•°ã€‚ æœ‰ä¸¤ç§å˜ä½“ï¼Œä¸€ç§æ˜¯æ™®é€šé€è§†çŸ©é˜µï¼Œå¦ä¸€ç§æ˜¯é€†å‘é€è§†çŸ©é˜µã€‚  å³æ‰‹åæ ‡ç³»ï¼š https://zhuanlan.zhihu.com/p/114729671\né€è§†æŠ•å½±ï¼š\nå½’ä¸€åŒ–é½æ¬¡åæ ‡ä»¥åçš„ç»“æœæ˜¯ï¼š\n camera space 3Dç©ºé—´ä¸­ï¼Œç›¸åŒçš„xï¼Œzè¶Šå¤§ï¼ŒæŠ•å½±å˜æ¢ä»¥åçš„xåˆ†é‡è¶Šé è¿‘0ã€‚\u0026ldquo;è¿‘å¤§è¿œå°\u0026quot;çš„é€è§†æ•ˆæœï¼Œå°±æ˜¯è¿™ä¹ˆç®—å‡ºæ¥çš„ã€‚\n  Unityçš„æŠ•å½±çŸ©é˜µï¼Œæ˜¯æŠŠè§†é”¥å†…çš„æ‰€æœ‰3Dåæ ‡ï¼Œè½¬æ¢åˆ° [-1,1] èŒƒå›´ä¹‹å†…ã€‚æœ€åè½¬åŒ–ä¸ºScreen Spaceï¼ŒèŒƒå›´ä¸º[0,1]\n æ·±åº¦å€¼æ˜¯åˆ°è¿‘å¹³é¢çš„è·ç¦»ï¼š\næ­£äº¤æŠ•å½±ï¼š\n é€è§†æŠ•å½±å˜æ¢ï¼Œæœ‰\u0026quot;è¿‘å¤§è¿œå°\u0026quot;çš„é€è§†æ•ˆæœã€‚3Dç©ºé—´ä¸­çš„ä¸¤æ¡å¹³è¡Œçº¿ï¼Œåœ¨æŠ•å½±å˜æ¢ä»¥åä¼šç›¸äº¤äºæŸä¸ª\u0026quot;ç­ç‚¹\u0026rdquo;ã€‚\næ­£äº¤æŠ•å½±å˜æ¢ï¼Œæ²¡æœ‰\u0026quot;è¿‘å¤§è¿œå°\u0026quot;çš„é€è§†æ•ˆæœã€‚3Dç©ºé—´ä¸­çš„ä¸¤æ¡å¹³è¡Œçº¿ï¼Œåœ¨æŠ•å½±å˜æ¢ä»¥åï¼Œä»æ—§æ˜¯å¹³è¡Œçš„ã€‚\n Unreal æ­£äº¤çŸ©é˜µï¼š\n UE4é‡Œçš„é€è§†æŠ•å½±çŸ©é˜µçš„è®¡ç®—æ–¹å¼ï¼Œå‚è§å¼•æ“æºä»£ç çš„OrthoMatrix.hæ–‡ä»¶ã€‚\n ä»£ç 1ï¼š\n1  UGameplayStatics::DeprojectScreenToWorld(UGameplayStatics::GetPlayerController(GetWorld(), 0), forwardCursorPos, forwardWorldPos, forwardMoveDirection);   ä»£ç 2ï¼š\n1 2 3  FVector forwardMoveDirection; GetWorld()-\u0026gt;GetFirstPlayerController()-\u0026gt;GetMousePosition(forwardCursorPos.X, forwardCursorPos.Y); UGameplayStatics::DeprojectScreenToWorld(UGameplayStatics::GetPlayerController(GetWorld(), 0), forwardCursorPos, forwardWorldPos, forwardMoveDirection);    APlayerController ç©å®¶æ§åˆ¶å™¨è¢«äººç±»ç©å®¶ç”¨æ¥æ§åˆ¶æ£‹å­ã€‚åœ°å€ ULocalPlayer å½“å‰å®¢æˆ·ç«¯ä¸Šçš„æ¯ä¸ªç©å®¶éƒ½æœ‰ä¸€ä¸ªLocalPlayerã€‚åœ°å€ FViewportClient è§†çª—å®¢æˆ·ç«¯çš„æŠ½è±¡æ¥å£ã€‚åœ°å€ ViewportClient åœ¨ç©å®¶ä¸­åŒ…å«æ­¤ç©å®¶è§†å›¾çš„ä¸»è§†çª—.ã€‚ åœ°å€ ULocalPlayer::GetProjectionData ç”¨äºå¯¼å‡ºæŠ•å½±æ‰€éœ€çš„å„ç§æ•°æ®ä½çš„è¾…åŠ©å‡½æ•°ã€‚ åœ°å€  bianxngjing:\nhttps://v.qq.com/x/page/t0770a2b6f6.html\nAPI UGameplayStatics::DeprojectScreenToWorld  Unity ä¸ NGUI åæ ‡è½¬æ¢åŸç†   å°†ç»™å®šçš„2Då±å¹•ç©ºé—´åæ ‡è½¬æ¢ä¸º3Dä¸–ç•Œç©ºé—´ç‚¹å’Œæ–¹å‘ã€‚\nAPIåœ°å€ï¼š https://docs.unrealengine.com/en-US/API/Runtime/Engine/Kismet/UGameplayStatics/DeprojectScreenToWorld/index.html\nè¯­æ³•ï¼š\n1 2 3 4 5 6 7  static bool DeprojectScreenToWorld ( APlayerController const * Player,\t// ç©å®¶è§†è§’  const FVector2D \u0026amp; ScreenPosition,\t// 2Dç‚¹  FVector \u0026amp; WorldPosition,\t// ä¸–ç•Œç©ºé—´ä¸‰ç»´åæ ‡ è¾“å‡º  FVector \u0026amp; WorldDirection\t// åœ¨ç»™å®šçš„2dç‚¹ä¸Šè¿œç¦»ç›¸æœºçš„ä¸–ç•Œç©ºé—´æ–¹å‘çŸ¢é‡ã€‚\tè¾“å‡º )   æºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  bool UGameplayStatics::DeprojectScreenToWorld(APlayerController const* Player, const FVector2D\u0026amp; ScreenPosition, FVector\u0026amp; WorldPosition, FVector\u0026amp; WorldDirection) { // è·å–LocalPlayer \tULocalPlayer* const LP = Player ? Player-\u0026gt;GetLocalPlayer() : nullptr; if (LP \u0026amp;\u0026amp; LP-\u0026gt;ViewportClient) {//ViewpoetClient åŒ…å«æ­¤ç©å®¶è§†å›¾çš„ä¸»è§†çª—ã€‚ \t// get the projection data \tFSceneViewProjectionData ProjectionData; //ç«‹ä½“æ¸²æŸ“é€šè¿‡ã€‚FULLè¡¨ç¤ºæ­¤è¿‡ç¨‹ä¸­æœªå¯ç”¨ç«‹ä½“æ¸²æŸ“ï¼ŒeSSP_FULL \tif (LP-\u0026gt;GetProjectionData(LP-\u0026gt;ViewportClient-\u0026gt;Viewport, eSSP_FULL, /*out*/ ProjectionData)) {// è·å–æŠ•å½±æ•°æ® \tFMatrix const InvViewProjMatrix = ProjectionData.ComputeViewProjectionMatrix().InverseFast(); FSceneView::DeprojectScreenToWorld(ScreenPosition, ProjectionData.GetConstrainedViewRect(), InvViewProjMatrix, /*out*/ WorldPosition, /*out*/ WorldDirection); return true; } } // something went wrong, zero things and return falseï¼Œé”™è¯¯ä¸ç®¡ \tWorldPosition = FVector::ZeroVector; WorldDirection = FVector::ZeroVector; return false; }   é€†é€è§†å˜æ¢ æŠ•å½±çŸ©é˜µï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  // Projection data for a FSceneView struct FSceneViewProjectionData { FVector ViewOrigin;\t//æºè§†å›¾å‘é‡ \t/** Rotation matrix transforming from world space to view space. */ FMatrix ViewRotationMatrix;\t// ä»ä¸–ç•Œç©ºé—´åˆ°è§†å›¾ç©ºé—´çš„æ—‹è½¬çŸ©é˜µè½¬æ¢ã€‚ \t/** UE4 projection matrix projects such that clip space Z=1 is the near plane, and Z=0 is the infinite far plane. */ FMatrix ProjectionMatrix;\t// UE4æŠ•å½±çŸ©é˜µæŠ•å½±ä½¿å¾—å‰ªè¾‘ç©ºé—´Z=1æ˜¯è¿‘å¹³é¢ï¼ŒZ=0æ˜¯æ— é™è¿œå¹³é¢ã€‚ protected: //The unconstrained (no aspect ratio bars applied) view rectangle (also unscaled) \tFIntRect ViewRect;\t// æ— çº¦æŸ(æœªåº”ç”¨å®½é«˜æ¯”æ¡)è§†å›¾çŸ©å½¢(ä¹Ÿæœªç¼©æ”¾) \t// The constrained view rectangle (identical to UnconstrainedUnscaledViewRect if aspect ratio is not constrained) \tFIntRect ConstrainedViewRect;\t// å—çº¦æŸçš„è§†å›¾çŸ©å½¢(å¦‚æœé•¿å®½æ¯”ä¸å—çº¦æŸï¼Œåˆ™ä¸UnconstrainedUnscaledViewRectç›¸åŒ) public: void SetViewRectangle(const FIntRect\u0026amp; InViewRect) { ViewRect = InViewRect; ConstrainedViewRect = InViewRect; } void SetConstrainedViewRectangle(const FIntRect\u0026amp; InViewRect) { ConstrainedViewRect = InViewRect; } // ä¸Šé¢ä¸¤ä¸ªå‡½æ•°è®¾ç½®Rectçª—å£  bool IsValidViewRectangle() const {//åˆ¤æ–­çª—å£æ˜¯å¦æœ‰æ•ˆ \treturn (ConstrainedViewRect.Min.X \u0026gt;= 0) \u0026amp;\u0026amp; (ConstrainedViewRect.Min.Y \u0026gt;= 0) \u0026amp;\u0026amp; (ConstrainedViewRect.Width() \u0026gt; 0) \u0026amp;\u0026amp; (ConstrainedViewRect.Height() \u0026gt; 0); } bool IsPerspectiveProjection() const {// åˆ¤æ–­æ˜¯ä¸æ˜¯é€è§†æŠ•å½±çŸ©é˜µ \treturn ProjectionMatrix.M[3][3] \u0026lt; 1.0f; } const FIntRect\u0026amp; GetViewRect() const { return ViewRect; } const FIntRect\u0026amp; GetConstrainedViewRect() const { return ConstrainedViewRect; } FMatrix ComputeViewProjectionMatrix() const {// è®¡ç®—è§†å›¾æŠ•å½±çŸ©é˜µ \treturn FTranslationMatrix(-ViewOrigin) * ViewRotationMatrix * ProjectionMatrix; } };   ä¸Šé¢å¹³ç§»çŸ©é˜µï¼š\n1 2 3 4 5 6 7 8  FORCEINLINE FTranslationMatrix::FTranslationMatrix(const FVector\u0026amp; Delta)\t//åŸºäºç»™å®šå‘é‡çš„æ„é€ å‡½æ•°è½¬æ¢çŸ©é˜µï¼Œ//è½¬ç½®çŸ©é˜µ \t: FMatrix( FPlane(1.0f,\t0.0f,\t0.0f,\t0.0f), FPlane(0.0f,\t1.0f,\t0.0f,\t0.0f), FPlane(0.0f,\t0.0f,\t1.0f,\t0.0f), FPlane(Delta.X,\tDelta.Y,Delta.Z,1.0f) ) { }   éš¾ç‚¹ä¸€ï¼šGetProjectionDataå‡½æ•°\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141  bool ULocalPlayer::GetProjectionData(FViewport* Viewport, EStereoscopicPass StereoPass, FSceneViewProjectionData\u0026amp; ProjectionData) const { // If the actor  //Sizeä¸ºåˆ†é…ç»™æ­¤ç©å®¶çš„ä¸»è§†å£å­åŒºåŸŸçš„å¤§å°ã€‚0-1  // Viewport-\u0026gt;GetSizeXY()è·å–è§†ç«¯çš„Xä¸Y \tif ((Viewport == NULL) || (PlayerController == NULL) || (Viewport-\u0026gt;GetSizeXY().X == 0) || (Viewport-\u0026gt;GetSizeXY().Y == 0) || (Size.X == 0) || (Size.Y == 0)) { return false; } // å°†æµ®ç‚¹æ•°è½¬æ¢ä¸ºæˆªæ–­å€¼æ¥è¿‘é›¶çš„æ•´æ•°ã€‚å³å‘ä¸‹å–æ•´  // Originä¸ºåˆ†é…ç»™è¯¥ç©å®¶çš„ä¸»è§†å£å­åŒºåŸŸå·¦ä¸Šè§’çš„åæ ‡ã€‚0-1 \tint32 X = FMath::TruncToInt(Origin.X * Viewport-\u0026gt;GetSizeXY().X); int32 Y = FMath::TruncToInt(Origin.Y * Viewport-\u0026gt;GetSizeXY().Y); // åŠ ä¸Šè§†ç«¯åˆå§‹çš„åæ ‡å€¼ \tX += Viewport-\u0026gt;GetInitialPositionXY().X; Y += Viewport-\u0026gt;GetInitialPositionXY().Y; //æ–°çš„çª—å£å¤§å° \tuint32 SizeX = FMath::TruncToInt(Size.X * Viewport-\u0026gt;GetSizeXY().X); uint32 SizeY = FMath::TruncToInt(Size.Y * Viewport-\u0026gt;GetSizeXY().Y); //X=0,Y = 0 #if !(UE_BUILD_SHIPPING || UE_BUILD_TEST) // We expect some size to avoid problems with the view rect manipulation \t// æˆ‘ä»¬å¸Œæœ›æœ‰ä¸€å®šçš„å¤§å°æ¥é¿å…view rectæ“ä½œçš„é—®é¢˜ \tif(SizeX \u0026gt; 50 \u0026amp;\u0026amp; SizeY \u0026gt; 50) { int32 Value = CVarViewportTest.GetValueOnGameThread();\t//æ ¹æ®valueçš„å€¼åˆ†ç±»å„ç§è§†ç«¯  if(Value) { int InsetX = SizeX / 4; int InsetY = SizeY / 4; // this allows to test various typical view port situations (todo: split screen)  // è¿™å…è®¸æµ‹è¯•å„ç§å…¸å‹çš„è§†å›¾ç«¯å£æƒ…å†µ(todo:åˆ†å‰²å±å¹•) \tswitch(Value) { case 1: X += InsetX; Y += InsetY; SizeX -= InsetX * 2; SizeY -= InsetY * 2;break; case 2: Y += InsetY; SizeY -= InsetY * 2; break; case 3: X += InsetX; SizeX -= InsetX * 2; break; case 4: SizeX /= 2; SizeY /= 2; break; case 5: SizeX /= 2; SizeY /= 2; X += SizeX;\tbreak; case 6: SizeX /= 2; SizeY /= 2; Y += SizeY; break; case 7: SizeX /= 2; SizeY /= 2; X += SizeX; Y += SizeY; break; } } } #endif\t// FIntRectä¸ºäºŒç»´ç©ºé—´ä¸­æ•´æ•°çŸ©å½¢çš„ç»“æ„ã€‚æ–°çš„è§†ç«¯çŸ©é˜µ \tFIntRect UnconstrainedRectangle = FIntRect(X, Y, X+SizeX, Y+SizeY);//InMin(X,Y),InMax(X+SizeX,Y+SizeY) \t// è®¾ç½®æŠ•å½±æ•°æ®çš„çª—å£ \tProjectionData.SetViewRectangle(UnconstrainedRectangle); // Get the viewpoint.  // è·å¾—è§†ç‚¹ \tFMinimalViewInfo ViewInfo; //ç»“æ„  /** enum EStereoscopicPass { eSSP_FULL, eSSP_LEFT_EYE, eSSP_RIGHT_EYE, eSSP_LEFT_EYE_SIDE, eSSP_RIGHT_EYE_SIDE, } **/ GetViewPoint(/*out*/ ViewInfo, StereoPass);\t//æ£€ç´¢è¯¥ç©å®¶çš„è§†ç‚¹ã€‚  // If stereo rendering is enabled, update the size and offset appropriately for this pass  // å¦‚æœå¯ç”¨äº†ç«‹ä½“æ¸²æŸ“ï¼Œè¯·ä¸ºæ­¤è¿‡ç¨‹é€‚å½“æ›´æ–°å¤§å°å’Œåç§» \tconst bool bNeedStereo = IStereoRendering::IsStereoEyePass(StereoPass) \u0026amp;\u0026amp; GEngine-\u0026gt;IsStereoscopic3D(); const bool bIsHeadTrackingAllowed = GEngine-\u0026gt;XRSystem.IsValid() \u0026amp;\u0026amp; GEngine-\u0026gt;XRSystem-\u0026gt;IsHeadTrackingAllowed(); if (bNeedStereo) { GEngine-\u0026gt;StereoRenderingDevice-\u0026gt;AdjustViewRect(StereoPass, X, Y, SizeX, SizeY); } // scale distances for cull distance purposes by the ratio of our current FOV to the default FOV  // æ ¹æ®æˆ‘ä»¬å½“å‰çš„FOVä¸é»˜è®¤FOVçš„æ¯”ç‡ï¼Œä¸ºé€‰æ‹©è·ç¦»çš„ç›®çš„ç¼©æ”¾è·ç¦» \tPlayerController-\u0026gt;LocalPlayerCachedLODDistanceFactor = ViewInfo.FOV / FMath::Max\u0026lt;float\u0026gt;(0.01f, (PlayerController-\u0026gt;PlayerCameraManager != NULL) ? PlayerController-\u0026gt;PlayerCameraManager-\u0026gt;DefaultFOV : 90.f); FVector StereoViewLocation = ViewInfo.Location; // åŠ å…¥ç«‹ä½“æ¸²æŸ“æˆ–è€…  if (bNeedStereo || bIsHeadTrackingAllowed) {// å‡å¦‚å¯ç”¨äº†ç«‹ä½“æ¸²æŸ“å’Œå¤´éƒ¨è¿½è¸ª \tauto XRCamera = GEngine-\u0026gt;XRSystem.IsValid() ? GEngine-\u0026gt;XRSystem-\u0026gt;GetXRCamera() : nullptr;\t//è™šæ‹Ÿç°å®ç›¸æœº \tif (XRCamera.IsValid()) { AActor* ViewTarget = PlayerController-\u0026gt;GetViewTarget(); const bool bHasActiveCamera = ViewTarget \u0026amp;\u0026amp; ViewTarget-\u0026gt;HasActiveCameraComponent(); XRCamera-\u0026gt;UseImplicitHMDPosition(bHasActiveCamera); } if (GEngine-\u0026gt;StereoRenderingDevice.IsValid()) { GEngine-\u0026gt;StereoRenderingDevice-\u0026gt;CalculateStereoViewOffset(StereoPass, ViewInfo.Rotation, GetWorld()-\u0026gt;GetWorldSettings()-\u0026gt;WorldToMeters, StereoViewLocation); } } // Create the view matrix  // åˆ›å»ºè§†å›¾çŸ©é˜µ  // FPlane ä¸‰ç»´å¹³é¢çš„ç»“æ„ã€‚(X,Y,Z,W)  // FMatrix æµ®ç‚¹å€¼çš„4x4çŸ©é˜µã€‚ \tProjectionData.ViewOrigin = StereoViewLocation; ProjectionData.ViewRotationMatrix = FInverseRotationMatrix(ViewInfo.Rotation) * FMatrix( FPlane(0,\t0,\t1,\t0), FPlane(1,\t0,\t0,\t0), FPlane(0,\t1,\t0,\t0), FPlane(0,\t0,\t0,\t1)); // @todo viewext this use case needs to be revisited  // é‡æ–°è€ƒè™‘viewext \tif (!bNeedStereo)\t//å‡å¦‚æ²¡æœ‰ç«‹ä½“æ¸²æŸ“ \t{ // Create the projection matrix (and possibly constrain the view rectangle)  // åˆ›å»ºæŠ•å½±çŸ©é˜µ(å¹¶å¯èƒ½çº¦æŸè§†å›¾çŸ©å½¢)  // ViewInfoè§†ç‚¹ \tFMinimalViewInfo::CalculateProjectionMatrixGivenView(ViewInfo, AspectRatioAxisConstraint, Viewport, /*inout*/ ProjectionData);//è®¡ç®—ç»™å®šè§†å›¾æŠ•å½±çŸ©é˜µ \t// è§†å›¾æ‰©å±•å¯¹è±¡å¯ä»¥åœ¨æ²¡æœ‰è¿åŠ¨æ§åˆ¶å™¨ç»„ä»¶çš„æƒ…å†µä¸‹ä¿ç•™åœ¨æ¸²æŸ“çº¿ç¨‹ä¸Šï¼Œå¤§æ¦‚æ˜¯è®¾ç½®ç›¸å…³è¯•å›¾æ‹“å±•çš„æŠ•å½±çŸ©é˜µ \tfor (auto\u0026amp; ViewExt : GEngine-\u0026gt;ViewExtensions-\u0026gt;GatherActiveExtensions()) { ViewExt-\u0026gt;SetupViewProjectionMatrix(ProjectionData); }; } else {\t// æœ‰ä¸‰ç»´æ¸²æŸ“ \t// Let the stereoscopic rendering device handle creating its own projection matrix, as needed  // è®©ç«‹ä½“æ¸²æŸ“è®¾å¤‡æ ¹æ®éœ€è¦å¤„ç†åˆ›å»ºè‡ªå·±çš„æŠ•å½±çŸ©é˜µï¼Œè°ƒç”¨ä¸€ç³»åˆ—å‡½æ•°GetProjectMatrix \tProjectionData.ProjectionMatrix = GEngine-\u0026gt;StereoRenderingDevice-\u0026gt;GetStereoProjectionMatrix(StereoPass); // calculate the out rect \tProjectionData.SetViewRectangle(FIntRect(X, Y, X + SizeX, Y + SizeY)); } return true; }   éš¾ç‚¹ï¼šè®¡ç®—ç»™å®šè§†å›¾æŠ•å½±çŸ©é˜µ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78  void FMinimalViewInfo::CalculateProjectionMatrixGivenView(const FMinimalViewInfo\u0026amp; ViewInfo, TEnumAsByte\u0026lt;enum EAspectRatioAxisConstraint\u0026gt; AspectRatioAxisConstraint, FViewport* Viewport, FSceneViewProjectionData\u0026amp; InOutProjectionData) { // Create the projection matrix (and possibly constrain the view rectangle)  // åˆ›å»ºæŠ•å½±çŸ©é˜µ(å¹¶å¯èƒ½çº¦æŸè§†å›¾çŸ©å½¢) \tif (ViewInfo.bConstrainAspectRatio) { // Enforce a particular aspect ratio for the render of the scene. \t// Results in black bars at top/bottom etc. \tInOutProjectionData.SetConstrainedViewRectangle(Viewport-\u0026gt;CalculateViewExtents(ViewInfo.AspectRatio, InOutProjectionData.GetViewRect())); InOutProjectionData.ProjectionMatrix = ViewInfo.CalculateProjectionMatrix(); } else { // Avoid divide by zero in the projection matrix calculation by clamping FOV \tfloat MatrixFOV = FMath::Max(0.001f, ViewInfo.FOV) * (float)PI / 360.0f; float XAxisMultiplier; float YAxisMultiplier; const FIntRect\u0026amp; ViewRect = InOutProjectionData.GetViewRect(); const int32 SizeX = ViewRect.Width(); const int32 SizeY = ViewRect.Height(); // if x is bigger, and we\u0026#39;re respecting x or major axis, AND mobile isn\u0026#39;t forcing us to be Y axis aligned \tif (((SizeX \u0026gt; SizeY) \u0026amp;\u0026amp; (AspectRatioAxisConstraint == AspectRatio_MajorAxisFOV)) || (AspectRatioAxisConstraint == AspectRatio_MaintainXFOV) || (ViewInfo.ProjectionMode == ECameraProjectionMode::Orthographic)) { //if the viewport is wider than it is tall \tXAxisMultiplier = 1.0f; YAxisMultiplier = SizeX / (float)SizeY; } else { //if the viewport is taller than it is wide \tXAxisMultiplier = SizeY / (float)SizeX; YAxisMultiplier = 1.0f; } if (ViewInfo.ProjectionMode == ECameraProjectionMode::Orthographic) {\t//åˆ¤æ–­æŠ•å½±æ¨¡å¼ \tconst float OrthoWidth = ViewInfo.OrthoWidth / 2.0f * XAxisMultiplier; const float OrthoHeight = (ViewInfo.OrthoWidth / 2.0f) / YAxisMultiplier; const float NearPlane = ViewInfo.OrthoNearClipPlane; const float FarPlane = ViewInfo.OrthoFarClipPlane; const float ZScale = 1.0f / (FarPlane - NearPlane); const float ZOffset = -NearPlane; InOutProjectionData.ProjectionMatrix = FReversedZOrthoMatrix( // è®¡ç®—åå‘Zæ­£äº¤çŸ©é˜µ \tOrthoWidth, OrthoHeight, ZScale, ZOffset );\t} else { InOutProjectionData.ProjectionMatrix = FReversedZPerspectiveMatrix(\t// åè½¬Zé€è§†çŸ©é˜µ \tMatrixFOV, MatrixFOV, XAxisMultiplier, YAxisMultiplier, GNearClippingPlane, GNearClippingPlane ); } } if (!ViewInfo.OffCenterProjectionOffset.IsZero()) { const float Left = -1.0f + ViewInfo.OffCenterProjectionOffset.X; const float Right = Left + 2.0f; const float Bottom = -1.0f + ViewInfo.OffCenterProjectionOffset.Y; const float Top = Bottom + 2.0f; InOutProjectionData.ProjectionMatrix.M[2][0] = (Left + Right) / (Left - Right); InOutProjectionData.ProjectionMatrix.M[2][1] = (Bottom + Top) / (Bottom - Top); } }   åå‘Zæ­£äº¤ï¼š\n1 2 3 4 5 6 7 8  FORCEINLINE FReversedZOrthoMatrix::FReversedZOrthoMatrix(float Width,float Height,float ZScale,float ZOffset) : FMatrix( FPlane((Width != 0.0f) ? (1.0f / Width) : 1.0f, 0.0f, 0.0f, 0.0f), FPlane(0.0f, (Height != 0.0f) ? (1.0f / Height) : 1.f, 0.0f, 0.0f), FPlane(0.0f, 0.0f, -ZScale, 0.0f), FPlane(0.0f, 0.0f, 1.0f - ZOffset * ZScale, 1.0f) ) { }   éš¾ç‚¹2ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53  void FSceneView::DeprojectScreenToWorld(const FVector2D\u0026amp; ScreenPos, const FIntRect\u0026amp; ViewRect, const FMatrix\u0026amp; InvViewProjMatrix, FVector\u0026amp; out_WorldOrigin, FVector\u0026amp; out_WorldDirection) { float PixelX = FMath::TruncToFloat(ScreenPos.X); float PixelY = FMath::TruncToFloat(ScreenPos.Y); // Get the eye position and direction of the mouse cursor in two stages (inverse transform projection, then inverse transform view).  // //åˆ†ä¸¤ä¸ªé˜¶æ®µè·å–é¼ æ ‡å…‰æ ‡çš„çœ¼ç›ä½ç½®å’Œæ–¹å‘(é€†å˜æ¢æŠ•å½±ï¼Œç„¶åé€†å˜æ¢è§†å›¾)ã€‚  // This avoids the numerical instability that occurs when a view matrix with large translation is composed with a projection matrix \t// //è¿™é¿å…äº†å½“å…·æœ‰å¤§å¹³ç§»çš„è§†å›¾çŸ©é˜µç”±æŠ•å½±çŸ©é˜µç»„æˆæ—¶å‡ºç°çš„æ•°å€¼ä¸ç¨³å®šæ€§  // Get the pixel coordinates into 0..1 normalized coordinates within the constrained view rectangle  // å°†åƒç´ åæ ‡è½¬æ¢ä¸º0..1çº¦æŸè§†å›¾çŸ©å½¢å†…çš„æ ‡å‡†åŒ–åæ ‡ \tconst float NormalizedX = (PixelX - ViewRect.Min.X) / ((float)ViewRect.Width()); const float NormalizedY = (PixelY - ViewRect.Min.Y) / ((float)ViewRect.Height()); // Get the pixel coordinates into -1..1 projection space  // å°†åƒç´ åæ ‡è½¬æ¢ä¸º-1..1æŠ•å½±ç©ºé—´ \tconst float ScreenSpaceX = (NormalizedX - 0.5f) * 2.0f; const float ScreenSpaceY = ((1.0f - NormalizedY) - 0.5f) * 2.0f; // The start of the ray trace is defined to be at mousex,mousey,1 in projection space (z=1 is near, z=0 is far - this gives us better precision)  // //å…‰çº¿è·Ÿè¸ªçš„å¼€å§‹è¢«å®šä¹‰ä¸ºåœ¨æŠ•å½±ç©ºé—´ä¸­mousexï¼Œmouseyï¼Œ1å¤„(z = 1æ˜¯è¿‘çš„ï¼Œz=0æ˜¯è¿œçš„-è¿™ç»™äº†æˆ‘ä»¬æ›´å¥½çš„ç²¾åº¦) \t// To get the direction of the ray trace we need to use any z between the near and the far plane, so let\u0026#39;s use (mousex, mousey, 0.5)  // //ä¸ºäº†å¾—åˆ°å…‰çº¿è½¨è¿¹çš„æ–¹å‘ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨è¿‘å¹³é¢å’Œè¿œå¹³é¢ä¹‹é—´çš„ä»»ä½•zï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä½¿ç”¨(mousexï¼Œmouseyï¼Œ0.5) \tconst FVector4 RayStartProjectionSpace = FVector4(ScreenSpaceX, ScreenSpaceY, 1.0f, 1.0f); const FVector4 RayEndProjectionSpace = FVector4(ScreenSpaceX, ScreenSpaceY, 0.5f, 1.0f); // Projection (changing the W coordinate) is not handled by the FMatrix transforms that work with vectors, so multiplications  // //æŠ•å½±(æ”¹å˜wåæ ‡)ä¸æ˜¯ç”±å¤„ç†å‘é‡çš„çŸ©é˜µå˜æ¢æ¥å¤„ç†çš„ï¼Œæ‰€ä»¥ä¹˜æ³•  // by the projection matrix should use homogeneous coordinates (i.e. FPlane).  // ç”±æŠ•å½±çŸ©é˜µåº”ä½¿ç”¨é½æ¬¡åæ ‡(å³å¹³é¢)ã€‚ \tconst FVector4 HGRayStartWorldSpace = InvViewProjMatrix.TransformFVector4(RayStartProjectionSpace); const FVector4 HGRayEndWorldSpace = InvViewProjMatrix.TransformFVector4(RayEndProjectionSpace); FVector RayStartWorldSpace(HGRayStartWorldSpace.X, HGRayStartWorldSpace.Y, HGRayStartWorldSpace.Z); FVector RayEndWorldSpace(HGRayEndWorldSpace.X, HGRayEndWorldSpace.Y, HGRayEndWorldSpace.Z); // divide vectors by W to undo any projection and get the 3-space coordinate  // //å°†å‘é‡é™¤ä»¥wä»¥æ’¤é”€ä»»ä½•æŠ•å½±å¹¶è·å¾—3-ç©ºé—´åæ ‡ \tif (HGRayStartWorldSpace.W != 0.0f) { RayStartWorldSpace /= HGRayStartWorldSpace.W; } if (HGRayEndWorldSpace.W != 0.0f) { RayEndWorldSpace /= HGRayEndWorldSpace.W; } const FVector RayDirWorldSpace = (RayEndWorldSpace - RayStartWorldSpace).GetSafeNormal(); // Finally, store the results in the outputs \tout_WorldOrigin = RayStartWorldSpace; out_WorldDirection = RayDirWorldSpace; }   FPlane:\nFMatrix:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  FORCEINLINE FMatrix::FMatrix(const FPlane\u0026amp; InX,const FPlane\u0026amp; InY,const FPlane\u0026amp; InZ,const FPlane\u0026amp; InW) { M[0][0] = InX.X; M[0][1] = InX.Y; M[0][2] = InX.Z; M[0][3] = InX.W; M[1][0] = InY.X; M[1][1] = InY.Y; M[1][2] = InY.Z; M[1][3] = InY.W; M[2][0] = InZ.X; M[2][1] = InZ.Y; M[2][2] = InZ.Z; M[2][3] = InZ.W; M[3][0] = InW.X; M[3][1] = InW.Y; M[3][2] = InW.Z; M[3][3] = InW.W; } FORCEINLINE FMatrix::FMatrix(const FVector\u0026amp; InX,const FVector\u0026amp; InY,const FVector\u0026amp; InZ,const FVector\u0026amp; InW) { M[0][0] = InX.X; M[0][1] = InX.Y; M[0][2] = InX.Z; M[0][3] = 0.0f; M[1][0] = InY.X; M[1][1] = InY.Y; M[1][2] = InY.Z; M[1][3] = 0.0f; M[2][0] = InZ.X; M[2][1] = InZ.Y; M[2][2] = InZ.Z; M[2][3] = 0.0f; M[3][0] = InW.X; M[3][1] = InW.Y; M[3][2] = InW.Z; M[3][3] = 1.0f; }   step1:\nAPI UGameplayStatics::ProjectWorldToScreen å°†ç»™å®šçš„3Dä¸–ç•Œç©ºé—´ç‚¹è½¬æ¢ä¸ºå…¶2Då±å¹•ç©ºé—´åæ ‡ã€‚\nAPIåœ°å€ï¼š https://docs.unrealengine.com/en-US/API/Runtime/Engine/Kismet/UGameplayStatics/ProjectWorldToScreen/index.html\nè¯­æ³•ï¼š\n1 2 3 4 5 6 7  static bool ProjectWorldToScreen ( APlayerController const * Player, const FVector \u0026amp; WorldPosition, FVector2D \u0026amp; ScreenPosition, bool bPlayerViewportRelative\t//è¿™æ˜¯å¦åº”è¯¥ä¸ç©å®¶è§†çª—å­åŒºåŸŸç›¸å…³(åœ¨åˆ†å‰²å±å¹•ä¸­ä½¿ç”¨ç©å®¶é™„åŠ çš„å°éƒ¨ä»¶æ—¶å¾ˆæœ‰ç”¨) )   Z-Buffer ç”¨Renderdocå¯¹UE4(PCï¼ŒDX11ï¼‰æˆªå¸§ï¼ŒUE4çš„ç‰ˆæœ¬ä¸º4.18. å¯ä»¥çœ‹åˆ°UE4ä¸€å¸§ç”»é¢çš„æ¸²æŸ“è¿‡ç¨‹å¦‚ä¸‹\nè·å–GBufferçš„ä¸€ç§æ–¹å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  ENQUEUE_UNIQUE_RENDER_COMMAND_ONEPARAMETER( DZRenderSutioBP_InterceptSceneBaseColor, UTexture2D*, vTextureAsset, TextureAsset, { /*if (!IsInRenderingThread()) return;*/ FRHICommandListImmediate\u0026amp; RHICmdList = GRHICommandList.GetImmediateCommandList(); //è®¡æ•°åŠ ä¸€é¿å…Renderå®Œæˆåç›´æ¥æ¸…ç©ºäº†GBuffer,ä½†ä¼šæ…¢ä¸€å¸§ï¼Œä½ çŒœ FSceneRenderTargets::Get(RHICmdList).AdjustGBufferRefCount(RHICmdList, 1); static const FString ScrollingMessage(TEXT(\u0026#34;Hello World: \u0026#34;)); GEngine-\u0026gt;AddOnScreenDebugMessage(-1, 0.2f, FColor::Red, ScrollingMessage); FSceneRenderTargets\u0026amp; SceneContext = FSceneRenderTargets::Get(RHICmdList); if (SceneContext.GBufferA) { FTexture2DRHIRef vTextTarget = SceneContext.GetGBufferATexture(); FString vSiceStr = FString::Printf(TEXT(\u0026#34;FSceneRenderTargets GBufferA Size = %d*%d\u0026#34;), vTextTarget-\u0026gt;GetSizeX(), vTextTarget-\u0026gt;GetSizeY()); GEngine-\u0026gt;AddOnScreenDebugMessage(-1, 0.2f, FColor::Red, vSiceStr); } //ç§»é™¤ FSceneRenderTargets::Get(RHICmdList).AdjustGBufferRefCount(RHICmdList, -1); } );   How to export FTexture2DRHIRef to png?\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  classÂ SceneDepthCapture { public: TArray\u0026lt;FLinearColor\u0026gt;Â sceneDepthData; FIntPointÂ bufferSize; voidÂ SceneDepthCaptureSync() { ENQUEUE_RENDER_COMMAND(ReadSurfaceFloatCommand)( [this](FRHICommandListImmediate\u0026amp;Â RHICmdList) { FSceneRenderTargets\u0026amp;Â contextÂ =Â FSceneRenderTargets::Get(RHICmdList); bufferSizeÂ =Â context.GetBufferSizeXY(); FIntRectÂ Rect(0,Â 0,Â bufferSize.X,Â bufferSize.Y); RHICmdList.ReadSurfaceData( context.GetSceneDepthTexture(), Rect, sceneDepthData, FReadSurfaceDataFlags()); }); FlushRenderingCommands(); } };   ä½¿ç”¨æ¨¡å—çš„æ–¹å¼ ä½¿ç”¨æ¨¡å—\næ·»åŠ è‡ªå®šä¹‰Passçš„æ–¹æ³•  æ·»åŠ Shader  äº†è§£äº†ä¸€ä¸ªPassè¦å®Œæˆçš„å·¥ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥åŠ¨æ‰‹å®ç°ä¸€ä¸ªè‡ªå·±çš„ Pass äº†ã€‚é¦–å…ˆè¦ç¡®å®šçš„é—®é¢˜æ˜¯ Shaderã€‚æ—¢ç„¶è¦æŠŠåŒä¸€ä¸ªæ¨¡å‹ç”»ä¸¤æ¬¡ï¼Œé‚£å¿…ç„¶è¦ç”¨åˆ°ä¸åŒçš„Shaderã€‚å…³äºå¦‚ä½•åœ¨UE4ä¸­æ·»åŠ  Shaderï¼Œå¯ä»¥å‚è€ƒ DepthPass çš„ VS/PS(åœ¨DepthRendering.hä¸­) å’Œ UE4 çš„å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.unrealengine.com/en-US/Programming/Rendering/ShaderDevelopment/index.htmlã€‚MobileBasePassçš„Shaderå› ä¸ºæ¶‰åŠç¯å¢ƒå…‰ï¼Œç‚¹å…‰æºæ•°ç­‰å¯å¼€å…³çš„Definationï¼Œæ‰€ä»¥å¯¹åº”çš„ C++ ç±»æ˜¯ä»¥ template çš„å½¢å¼å®ç°çš„ã€‚ä¸€èˆ¬æ¥è¯´è‡ªå®šä¹‰ Pass çš„ Shader ä¼šç»§æ‰¿ FMaterialShader å¹¶ç”¨ IMPLEMENT_MATERIAL_SHADER_TYPE å®æ¥ç»‘å®šå¯¹åº”çš„ usf æ–‡ä»¶ã€‚ å¯ä»¥å®Œå…¨è‡ªå·±å†™æ–°çš„ usf æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åœ¨ FMaterialShader::ModifyCompilationEnvironment() ä¸­åº”ç”¨ä¸åŒçš„ SetDefine() æ¥å®ç°ä¸åŒçš„ Shaderã€‚éœ€è¦æ³¨æ„çš„æ˜¯ UE4 çš„ Shader ç¼–è¯‘æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ¼«é•¿çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥æœ€å¥½åœ¨ FMaterialShader::ShouldCompilePremutation() ä¸­å¯¹æè´¨è¿›è¡Œç­›é€‰ï¼Œåªç¼–è¯‘å¿…è¦çš„Shaderã€‚å¦åˆ™æ‰€æœ‰çš„ Material éƒ½ä¼šç¼–è¯‘å¯¹åº”çš„ Shaderï¼Œæ•ˆç‡å¾ˆä½ã€‚è¿˜æœ‰æ³¨æ„ Shader è¦åœ¨æ„é€ å‡½æ•°ä¸­ç»‘å®šéœ€è¦çš„ Uniform Bufferï¼Œåœ¨ GetShaderBinding ä¸­ç»‘å®šå¯¹åº”çš„UniformBufferï¼Œå¦åˆ™ä¼šå‡ºç° ResourceMissã€‚\n2. æ·»åŠ  MeshProcessor\næ ¹æ®å¯¹UE4çš„æ¸²æŸ“æµç¨‹åˆ†ææˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒPass ç”Ÿæˆ DrawCall çš„ä¸»è¦é€»è¾‘æ˜¯åœ¨ MeshProcessor ä¸­å®Œæˆçš„ã€‚MeshProcessor æ˜¯ 4.22 ä¸­æ–°åŠ å…¥çš„ç±»åï¼Œä¹‹å‰å¯¹åº”çš„æ˜¯ DrawingPolicyã€‚æ·»åŠ  MeshProcessor å¾ˆç®€å•ï¼Œåªéœ€è¦ç»§æ‰¿ FMeshPassProcessor å¹¶å¤å†™å…¶ AddMeshBatch() æ–¹æ³•å³å¯ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¼šåœ¨ AddMeshBatch æ–¹æ³•ä¸­è·å– Material Resource çš„ä¿¡æ¯å¹¶å¯¹ MeshBatch åšè¿›ä¸€æ­¥ç­›é€‰ï¼Œæœ€åè°ƒç”¨ Process æ–¹æ³•ç»‘å®š Shaderï¼ŒMesh å’Œ Materialï¼Œè®¡ç®— Mesh çš„ CullModeï¼ŒZTestï¼ŒZwriteï¼ŒBlendOP å’Œ SortKeyç­‰ç­‰å¹¶ç”¨ BuildMeshCommands ç”Ÿæˆ DrawCallã€‚\n3. æ·»åŠ  Pass\næ‰€æœ‰çš„ Pass éƒ½å¯ä»¥åœ¨ Enum EMeshPassä¸­æ‰¾åˆ°ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥å°±æ˜¯åœ¨ MeshProcessor.h çš„ EMeshPass ä¸­æ·»åŠ å¯¹åº”çš„ Enumã€‚ç„¶åæˆ‘ä»¬è¦ä¸º Pass åˆ›å»ºå¯¹åº”çš„ MeshProcessorï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯¹åº” .cpp æ–‡ä»¶ä¸­å®ç°å¯¹åº” MeshProcessor çš„ Creator æ–¹æ³•ï¼Œå¹¶å®šä¹‰å¯¹åº”çš„ FRegisterPassProcessorCreatFunction åœ¨å…¶æ„é€ å‡½æ•°ä¸­ä¼ å…¥å¯¹åº”çš„ Creator æ–¹æ³•æŒ‡é’ˆå’Œ Pass Enumã€‚è¿™ä¸€éƒ¨åˆ†å¯ä»¥å‚è€ƒ MobileBasePass.cpp æœ€åçš„ CreateMobileBasePassProcessor å’Œ RegisterMobileBasePass éƒ¨åˆ†ã€‚ä¹‹åæˆ‘ä»¬å°±è¦åœ¨ MobileSceneRenderer çš„ Render æ–¹æ³•ä¸­æ’å…¥è‡ªå®šä¹‰ Pass çš„æ¸²æŸ“æµç¨‹ï¼Œè¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯ä¸€äº› Profile æ ‡ç­¾å’Œ RHICmdList çš„Setup å’Œ Flushï¼Œè¿˜æœ‰ç”Ÿæˆ Pass çš„å¤šçº¿ç¨‹ DrawTaskã€‚è¿™ä¸€éƒ¨åˆ†é€»è¾‘å¯ä»¥å‚è€ƒ MobileBasePassRendering.cpp ä¸­çš„ RenderMobileBasePass æ–¹æ³•ã€‚\n","description":"è™šå¹»å¼•æ“ç›¸å…³é—®é¢˜","id":23,"section":"talks","tags":[""],"title":"UE4 Problems","uri":"https://hugo.jiahongw.com/zh/talks/ue4-talks/"},{"content":"å¤§æ¦‚ä»‹ç»ä»¥ä¸‹UE4çš„ä¸»è¦æ¸²æŸ“è¿‡ç¨‹ã€‚\nUE4æ¸²æŸ“è¿‡ç¨‹ å»¶è¿Ÿæ¸²æŸ“ æ‰€è°“å»¶è¿Ÿæ¸²æŸ“ï¼Œæ˜¯æŒ‡å°†ä¸€ä¸ªåœºæ™¯çš„å‡ ä½•ä½“ï¼ˆ3Dæ¨¡å‹ã€å¤šè¾¹å½¢ï¼‰çš„å…‰ç…§ã€é˜´å½±ã€è´¨æ„Ÿæç½®åˆ°ä¸€æ—ï¼Œå…ˆç€æ‰‹äºç»˜ç”»ï¼Œç„¶ååœ¨ååŠæ®µå†å¯¹å…‰ç…§ã€é˜´å½±ã€è´¨æ„Ÿè¿›è¡Œå¤„ç†çš„å¤„ç†æ–¹å¼ã€‚å³ç»™äººä¸€ç§æŠŠåŸæœ¬çš„å¤šè¾¹å½¢å…ˆç»˜åˆ¶å‡ºæ¥çš„å°è±¡ï¼Œå®é™…ä¸Šä¸ä»…è¦ç»˜åˆ¶å¤šè¾¹å½¢ï¼Œå‰è€…çš„å‚æ•°è¿˜éœ€è¦é…åˆåé¢å…‰ç…§å’Œé˜´å½±çš„å¤„ç†ã€‚å…¶è¾“å‡ºç›®æ ‡ï¼Œåœ¨æˆä¸ºå¤æ•°ç¼“å†²æ—¶å…·æœ‰æ™®éæ€§ï¼Œä½†æ˜¯è¿™é‡Œçš„ç¼“å†²æˆ‘ä»¬ç§°ä¹‹ä¸º\u0026quot;ç‰©ç†ç¼“å†²\u0026rdquo;ã€‚ç‰©ä½“ç¼“å†²æ˜¯æŒ‡ä½¿ç”¨åç…§æ˜å’Œåå¤„ç†ç‰¹æ•ˆçš„ä¸­é—´è¿‡æ¸¡ç¯èŠ‚\nç›¸å…³æœ¯è¯­ RHI\næ¸²æŸ“ç¡¬ä»¶æ¥å£ï¼Œæ˜¯ä¸ºä¸åŒå¹³å°æŠ½è±¡å‡ºä¸åŒå›¾å½¢APIçš„ä¸€å±‚ã€‚æ‰€æœ‰æ¸²æŸ“å‘½ä»¤å‡é€šè¿‡RHIå±‚ä¼ é€’ï¼Œä»¥è½¬æ¢ä¸ºé€‚ç”¨çš„æ¸²æŸ“å™¨ã€‚\nå»¶è¿Ÿæ¸²æŸ“\nè™šå¹»å¼•æ“4ä¸­çš„é»˜è®¤æ¸²æŸ“å™¨ã€‚å®ƒå› å°†ç…§æ˜/é˜´å½±è®¡ç®—æ¨è¿Ÿåˆ°å…¨å±è¿‡ç¨‹è€Œä¸æ˜¯ç»˜åˆ¶æ¯ä¸ªç½‘æ ¼æ—¶è€Œå¾—åã€‚\né¡¶ç‚¹å·¥å‚\né¡¶ç‚¹å·¥å‚æ˜¯å°è£…é¡¶ç‚¹æ•°æ®æºå¹¶é“¾æ¥åˆ°é¡¶ç‚¹ç€è‰²å™¨ä¸Šçš„è¾“å…¥çš„ç±»ã€‚é™æ€ç½‘æ ¼ç‰©ä½“ï¼Œéª¨æ¶ç½‘æ ¼ç‰©ä½“å’Œè¿‡ç¨‹ç½‘æ ¼ç»„ä»¶å‡ä½¿ç”¨ä¸åŒçš„é¡¶ç‚¹å·¥å‚ã€‚\nç€è‰²å™¨\nåœ¨è™šå¹»å¼•æ“ä¸­ï¼Œç€è‰²å™¨æ˜¯HLSLä»£ç ï¼ˆä»¥.ush / .usfæ–‡ä»¶çš„å½¢å¼ï¼‰å’Œæè´¨å›¾çš„å†…å®¹çš„ç»„åˆã€‚åœ¨Unrealä¸­åˆ›å»ºæè´¨æ—¶ï¼Œå®ƒä¼šæ ¹æ®è®¾ç½®ï¼ˆå¦‚ç€è‰²æ¨¡å¼ï¼‰å’Œç”¨æ³•æ¥ç¼–è¯‘å¤šä¸ªç€è‰²å™¨æ’åˆ—ã€‚\næ¸²æŸ“æ•°æ® ç›¸å…³çš„æ¸²æŸ“çš„æ•°æ®åŒ…æ‹¬æ·±åº¦å€¼åŠä¸€äº›Gbufferï¼Œå¦‚ä¸‹å›¾ï¼š\nå‡ ä¸ªPass Z Pre Pass UE4çš„æ¸²æŸ“ç®¡é“ï¼Œæ˜¯åœ¨Bass Passçš„ç‰©ä½“ç¼“å†²å†™å‡ºæ¥ä¹‹å‰ï¼Œåœ¨ä»…é¢„å¤„ç†æ·±åº¦å€¼ï¼ˆZå€¼ï¼‰ä¹‹åï¼Œè¿è¡ŒZé¢„é˜¶æ®µã€‚\näº‹å…ˆé¢„å¤„ç†æ·±åº¦å€¼çš„ç›®çš„ï¼Œæ˜¯å°†æœ€ç»ˆå½±åƒå’ŒåŒä¸€æ·±åº¦ç¼“å†²çš„å†…å®¹ç»“æœï¼Œåœ¨é€è§†å‰è·å¾—ã€‚Zé¢„é˜¶æ®µä¹‹åçš„Base Passåˆ™æ˜¯ï¼Œå‚è€ƒé¢„å…ˆå¾—å‡ºçš„æ·±åº¦å€¼ç¼“å†²è¿›è¡ŒZé¢„æµ‹è¯•ï¼Œå› æ­¤é€šè¿‡åœ¨æœ€ç»ˆçš„ç”»é¢é‡Œä¸ç•™ä¸‹åƒç´ ç—•è¿¹ï¼ˆå³ç¼–å†™ååˆè¢«æ¶ˆå»çš„åƒç´ ï¼‰ï¼Œä»¥å›é¿åƒç´ ç€è‰²å™¨çš„è¿è¡Œã€‚\nBase Pass\nä½¿ç”¨Base Passè¾“å‡ºç‰©ä½“ç¼“å†²éœ€è¦æ³¨æ„çš„ä¸¤ç‚¹ï¼š\n  ä¸ç»˜åˆ¶æ²¡è¿›å…¥è§†çº¿çš„å¯¹è±¡\nè¿™ç§\u0026quot;æŠ•å½±å‰”é™¤\u0026rdquo;ï¼ˆFrustum Cullingï¼‰ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡CPUç«¯æ¥å¤„ç†ï¼›ä¸ºäº†æ•´ä½“è¦†ç›–è¢«ç§°ä¸º\u0026quot;åŒ…å›´çƒ\u0026rdquo;ï¼ˆBounding sphereï¼‰çš„å„ä¸ª3Då¯¹è±¡ï¼Œå¯¹è±¡æ˜¯å¦åœ¨è§†é‡å†…çš„åˆ¤å®šæ ‡å‡†ï¼Œæ˜¯é€šè¿‡é¢„å…ˆè®¾å®šçš„åŒ…å›´çƒæ¥å®è¡Œçš„ã€‚\n ä»€ä¹ˆç¨‹åº¦çš„å‰”é™¤ä¼šæˆåŠŸï¼Œå¯ä»¥é€šè¿‡Statåˆå§‹è§†å›¾ï¼ˆStat InitViewsï¼‰æŒ‡ä»¤çš„\u0026quot;è§†é”¥ä½“è£å‰ªåŸºå…ƒï¼ˆFrustum Culled Primitivesï¼‰\u0026ldquo;è¿›è¡Œç¡®è®¤ã€‚\n   ä¸è®¡ç®—å¤šä½™çš„åƒç´ \nåœ¨å›¾åƒå¤„ç†çš„æµç¨‹ä¸­ï¼Œä½¿ç”¨åƒç´ ç€è‰²å™¨å®é™…å¤„ç†å‰ï¼Œä¼šæœ‰è¿è¡Œæ·±åº¦æµ‹è¯•ï¼ˆZ æµ‹è¯•ï¼‰çš„\u0026quot;Pre Z æµ‹è¯•\u0026quot;è¿™ä¸€æ­¥éª¤ã€‚ä»è¿™é‡Œç€æ‰‹å¤„ç†çš„åƒç´ ï¼Œä¼šå› ä¸ºè¢«æŸä¸ªä¸œè¥¿æ‰€é®æŒ¡è€Œæ— æ³•ç»˜åˆ¶å‡ºæ¥ï¼Œè¿™æ—¶å¯ä»¥è¿›è¡Œæ’¤é”€å¤„ç†ã€‚\n ä½†æ˜¯ï¼ŒåƒåŠé€æ˜å¯¹è±¡è¿™ç§ä¼šä¼´éšÎ±æµ‹è¯•çš„ç»˜åˆ¶ã€è§†å·®é®è”½æ˜ å°„è¿™ç§åƒç´ ç€è‰²å™¨å¤„ç†åä¼šé‡æ–°ç¼–å†™æ·±åº¦å€¼çš„æƒ…å†µï¼Œå°±ä¸è¿›è¡ŒPre Zæµ‹è¯•ï¼Œè€Œé€šè¿‡å¤„ç†å®è¡Œåˆ†è·¯è¿‚å›ã€‚\n    UE4 ç»˜åˆ¶ç­–ç•¥DrawingPolicy\nç»˜åˆ¶ç­–ç•¥åœ¨UE4æ¸²æŸ“ä¸­ä½¿ç”¨å¾ˆå¤šï¼Œ ä¸­æ–‡ä¹Ÿä¸å¥½ç¿»è¯‘ã€‚ å…¶å®å°±æ˜¯æ ¹æ®ç­–ç•¥ ä½¿ç”¨äº†å“ªäº› ç€è‰²å™¨ ã€‚\n \u0026hellip;\u0026hellip;\u0026hellip;.\nUE4æ¸²æŸ“ä¸€å¸§ æ¸²æŸ“ç®¡é“ é¦–å…ˆï¼Œè™šå¹»çš„æ¸²æŸ“ç”±ä¸‰ä¸ªçº¿ç¨‹å…±åŒå®Œæˆã€‚åˆ†åˆ«æ˜¯CPUçº¿ç¨‹ï¼ŒDRAWçº¿ç¨‹ï¼Œå’ŒGPUçº¿ç¨‹ã€‚\nçŸ¥ä¹ï¼šhttps://zhuanlan.zhihu.com/p/57158725\nRenderæ¨¡å— è°ƒç”¨Render()å‡½æ•°åœ¨Renderæ¨¡å—RendererModule.hä¸­ï¼Œä»¥ä¸‹å‡½æ•°ï¼š\n1 2 3 4 5  class FRendererModule : public IRendererModule { // å¼€å§‹æ¸²æŸ“è§†å›¾æ—  virtual void BeginRenderingViewFamily(FCanvas* Canvas,FSceneViewFamily* ViewFamily) override; }   ==è°æœ€ç»ˆè°ƒç”¨äº†Renderï¼Ÿ==\nå®æ—¶æ¸²æŸ“æµç¨‹å›¾ï¼š part1:https://i.loli.net/2020/05/30/qU8vN2WZVbt9hkF.jpg\npart2:https://i.loli.net/2020/05/30/3trKVpOMU5sTQfB.jpg\næ¸²æŸ“å‡½æ•°Render è·¯å¾„ï¼šEngine \\ Source \\ Runtime \\ Renderer \\ Private \\ DeferredShadingRenderer.cppï¼ˆ660ï¼‰\nå‡½æ•°ï¼šFDeferredShadingSceneRenderer :: Renderï¼ˆï¼‰æ¸²æŸ“è·¯å¾„\n   å…¨å±€ç³»ç»Ÿçº¹ç†åˆå§‹åŒ– DeferredShadingRenderer.cppï¼ˆ677ï¼‰ GSystemTextures.InitializeTexturesï¼ˆï¼‰     ä¿æŠ¤ å¿…è¦çš„æ¸²æŸ“ç›®æ ‡æ‚¨æ˜¯å¦å·²ç¡®ä¿å¯ä»¥ä¿æŠ¤çš„æœ€å¤§ç›®æ ‡æ•°ç›®ï¼Ÿ DeferredShadingRenderer.cppï¼ˆ680ï¼‰ GSceneRenderTargets.Allocateï¼ˆï¼‰   åˆå§‹åŒ–æ¯ä¸ªè§†å£ è®¾ç½®è§†å£æ˜¾ç¤ºçš„å¯¹è±¡ï¼Œé€‰æ‹©ä½¿ç”¨åŠ¨æ€é˜´å½±æ—¶æ˜¾ç¤ºçš„å¯¹è±¡ï¼Œå¯¹åŠé€æ˜å¯¹è±¡è¿›è¡Œæ’åº DeferredShadingRenderer.cppï¼ˆ683ï¼‰ InitViews()ï¼ˆï¼‰   FXSystemé¢„å¤„ç† GPUç²’å­æ­£åœ¨è¢«ä»¿çœŸ DeferredShadingRenderer.cppï¼ˆ758ï¼‰ FXSystem-\u0026gt; PreRenderï¼ˆï¼‰   å¯ç”¨Z Pre-Passæ—¶æ‰§è¡Œçš„æ—©æœŸZç»˜åˆ¶ ä¸ç»˜åˆ¶Tileæ¸²æŸ“çš„ç¡¬ä»¶ï¼ˆç§»åŠ¨è®¾å¤‡ï¼ŒAndroidæˆ–iOSï¼‰å¯¹äº PCæˆ–PS4ï¼Œå°†ç”Ÿæˆæ·±åº¦ç¼“å†²åŒºå’ŒHiZï¼Œå› æ­¤åç»­ç»˜åˆ¶é€Ÿåº¦å¾ˆå¿«æˆä¸ºï¼Ÿ DeferredShadingRenderer.cppï¼ˆ768ï¼‰ RenderPrePassï¼ˆï¼‰   å®‰å…¨GBuffer DeferredShadingRenderer.cppï¼ˆ774ï¼‰ GSceneRenderTargets.AllocGBufferTargetsï¼ˆï¼‰   é€æ˜å…‰ä¼ æ’­é‡ DeferredShadingRenderer.cppï¼ˆ779ï¼‰ ClearLPVsï¼ˆï¼‰   ä½¿ç”¨DBufferæ—¶ç»˜åˆ¶å»¶æœŸè´´å›¾å•å‡»æ­¤å¤„è·å– DBufferå’Œå»¶æœŸè´´å›¾ DeferredShadingRenderer.cppï¼ˆ796ï¼‰ GCompositionLighting.ProcessBeforeBasePassï¼ˆï¼‰   å¦‚æœ‰å¿…è¦ï¼Œè¯· åœ¨ç»˜åˆ¶çº¿æ¡†å›¾æ—¶æ¸…é™¤GBufferé€æ˜é¢œè‰²ç¼“å†²åŒºï¼Œ æœ‰äº›æ¸¸æˆåœ¨å‘è¡Œæ¸¸æˆæ—¶æ— æ³•æ¸…é™¤GBufferæˆ–å±å¹•ã€‚ DeferredShadingRenderer.cppï¼ˆ805ï¼‰ SetAndClearViewGBufferï¼ˆï¼‰ DeferredShadingRenderer.cppï¼ˆ816ï¼‰ RHICmdList.Clearï¼ˆï¼‰   æ¸²æŸ“ä¸é€æ˜çš„å¯¹è±¡æ¸²æŸ“ é¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®æ ¹æ®å®ƒä»¬æ˜¯Maskedè¿˜æ˜¯Defaultï¼Œæ˜¯å¦æœ‰LightMapç­‰æŒ‰æ¯ç§æ’åºé¡ºåºè¿›è¡Œäº†ç²¾ç»†åˆ†ç±» DeferredShadingRenderer.cppï¼ˆ828ï¼‰ RenderBasePassï¼ˆï¼‰   æ¸…é™¤ GBuffer çš„æœªç»˜åˆ¶éƒ¨åˆ†å¦‚æœäº‹å…ˆæ¸…é™¤GBufferï¼Œåˆ™ä¸å¿…è¦ã€‚ DeferredShadingRenderer.cppï¼ˆ851ï¼‰ ClearGBufferAtMaxZï¼ˆï¼‰   ç»˜åˆ¶ è‡ªå®šä¹‰æ·±åº¦è¯·å‚è§æ­¤å¤„ä»¥è·å–è‡ªå®šä¹‰æ·±åº¦ DeferredShadingRenderer.cppï¼ˆ860ï¼‰ RenderCustomDepthPassï¼ˆï¼‰   åœ¨è¿™é‡Œå†æ¬¡æ¨¡æ‹ŸGPUç²’å­é™¤äº†åœ¨è¿™é‡Œ å¤„ç†ä½¿ç”¨æ·±åº¦ç¼“å†²åŒºæ‰§è¡Œç¢°æ’æ£€æµ‹çš„ ç²’å­å¤–ï¼Œè¿˜å¯¹GPUç²’å­è¿›è¡Œæ’åº DeferredShadingRenderer.cppï¼ˆ865ï¼‰ åœºæ™¯-\u0026gt; FXSystem-\u0026gt; PostRenderOpaqueï¼ˆï¼‰   ä¸ºSceneDepthTextureåˆ›å»ºä¸€ä¸ªåŠåˆ†è¾¨ç‡ï¼ˆæ¯ä¸ªæ–¹é¢ä¸º1/4åˆ†è¾¨ç‡ï¼‰çš„ç¼“å†²åŒº DeferredShadingRenderer.cppï¼ˆ875ï¼‰ UpdateDownsampledDepthSurfaceï¼ˆï¼‰   æ‰§è¡Œé˜»å¡æµ‹è¯• HZBçš„æ„å»ºï¼Œæ‰§è¡Œæäº¤ çš„HZB Attotempkinderçš„è¿™ç¯‡æ–‡ç« æŒ‡ DeferredShadingRenderer.cppï¼ˆ881ï¼‰ BeginOcclusionTestsï¼ˆï¼‰   å¼€å§‹å†™ å› ä¸ºæœ‰ç‚¹å¤æ‚ï¼Œæ‰€ä»¥è¦å†™ä¸€äº›ç»†èŠ‚ DeferredShadingRenderer.cppï¼ˆ890ï¼‰   ä¸ä½¿ç”¨DBufferç»˜åˆ¶å»¶è¿Ÿçš„è´´å›¾ CompositionLighting.cppï¼ˆ293ï¼‰ AddDeferredDecalsBeforeLightingï¼ˆï¼‰   åœ¨å±å¹•ç©ºé—´ä¸­ç»˜åˆ¶ç¯å¢ƒå…‰é®æŒ¡ CompositionLighting.cppï¼ˆ300ï¼‰ AddPostProcessingAmbientOcclusionï¼ˆï¼‰   åæœŸå¤„ç†ç¯å¢ƒç«‹æ–¹ä½“è´´å›¾ CompositionLighting.cppï¼ˆ305ï¼‰ AddPostProcessingAmbientCubemapï¼ˆï¼‰   åˆ°è¿™é‡Œä¸ºæ­¢çš„ä¸€ç³»åˆ—å¤„ç† DeferredShadingRenderer.cppï¼ˆ904ï¼‰ GCompositionLighting.ProcessAfterBasePassï¼ˆï¼‰   é€æ˜çš„ä½“ç§¯å…‰ç¼“å†²æ¶²å¯æé«˜é€æ˜åº¦ DeferredShadingRenderer.cppï¼ˆ908ï¼‰ ClearTranslucentVolumeLightingï¼ˆï¼‰   ä»æ­¤å¤„å¼€å§‹çš„ä¸»è¦ç…§æ˜è®¾å¤‡ æ”¶é›†è¦ç»˜åˆ¶çš„ç¯å…‰å¹¶å°†å…¶æ’åº ä¸è¦æŠ•å½±ï¼Œä¸ä½¿ç”¨ç¯å…‰åŠŸèƒ½çš„ç¯å…‰å°†ä½¿ç”¨â€œ åŸºäºå›¾å—â€ ç»˜åˆ¶ï¼ˆå¦‚æœå¯èƒ½ï¼‰å¦‚æœä¸èƒ½ä½¿ç”¨â€œ åŸºäºå›¾å—â€å…³äºå»¶è¿Ÿæ¸²æŸ“ï¼Œè¿™æ˜¯å‘³oï¼Œä½†è¯·å‚è§æ­¤å¤„ LightRendering.cppï¼ˆ312-348ï¼‰ LightRendering.cppï¼ˆ423ï¼‰ RenderTiledDeferredLightingï¼ˆï¼‰ LightRendering.cppï¼ˆ429ï¼‰ RenderSimpleLightsStandardDeferredï¼ˆï¼‰   å®ƒä¸ä¼šé˜´å½±ï¼Œä¹Ÿä¸ä¼šä½¿ç”¨ç¯å…‰åŠŸèƒ½ï¼Œä½†æ˜¯ä¼¼ä¹æ— æ³•ä½¿ç”¨TBDRç»˜åˆ¶çš„ç¯å…‰ è¢«ç§°ä¸ºæ ‡å‡†å»¶è¿Ÿç¯å…‰ã€‚ LightRendering.cppï¼ˆ445ï¼‰ RenderLightï¼ˆï¼‰   å¦‚æœç”¨äºåŠé€æ˜çš„ä½“ç§¯å…‰æ˜¯æœ‰æ•ˆçš„ï¼Œåˆ™å°†æ¯ä¸ªå…‰æ³¨å…¥åˆ°ä½“ç§¯å…‰ä¸­ ï¼Œä»è€Œåœ¨3Dçº¹ç†ä¸Šç»˜åˆ¶å…‰æ•ˆæœã€‚ LightRendering.cppï¼ˆ455ï¼‰ InjectTranslucentVolumeLightingArrayï¼ˆï¼‰ LightRendering.cppï¼ˆ461ï¼‰ InjectSimpleTranslucentVolumeLightingArrayï¼ˆï¼‰   ä½¿ç”¨ç¯å…‰åŠŸèƒ½æŠ•å°„é˜´å½±çš„ç¯å…‰å°†å•ç‹¬å¤„ç† LightRendering.cppï¼ˆ468-552ï¼‰   é¦–å…ˆï¼Œæˆ‘åœ¨æŠ•å°„é˜´å½±æ—¶ ç»˜åˆ¶äº†ä¸€ä¸ªé˜´å½±è´´å›¾ï¼›åœ¨è¿™é‡Œæˆ‘è¿˜ç»˜åˆ¶äº†ä¸€ä¸ª åŠé€æ˜çš„é˜´å½±è´´å›¾ï¼›æˆ‘è®°å¾—åŠé€æ˜çš„å½“ç„¶æ˜¯å‚…ç«‹å¶ä¸é€æ˜åº¦è´´å›¾ã€‚ LightRendering.cppï¼ˆ495ï¼‰ RenderTranslucentProjectedShadowsï¼ˆï¼‰ LightRendering.cppï¼ˆ497ï¼‰ RenderProjectedShadowsï¼ˆï¼‰   ä½¿ç”¨LPVæ—¶ç»˜åˆ¶åå°„é˜´å½±è´´å›¾ LightRendering.cppï¼ˆ508ï¼‰ RenderReflectiveShadowMapsï¼ˆï¼‰   ç¯å…‰åŠŸèƒ½å›¾ é˜´å½±æŒ‡ç¤ºå™¨å›¾ LightRendering.cppï¼ˆ515ï¼‰ RenderLightFunctionï¼ˆï¼‰ LightRendering.cppï¼ˆ522ï¼‰ RenderPreviewShadowsIndicatorï¼ˆï¼‰   è¡°å‡ç¼“å†²å™¨ä¸­çš„åˆ†è¾¨ å…‰çš„è¡°å‡ä¿¡æ¯æ˜¯å¦æ›¾ç»è¢«å¸å…¥å¦ä¸€ä¸ªç¼“å†²å™¨ä¸­ï¼Ÿ LightRendering.cppï¼ˆ534ï¼‰ GSceneRenderTargets.FinishRenderingLightAttenuationï¼ˆï¼‰   æ³¨å…¥ä½“ç§¯å…‰ä»¥è·å¾—åŠé€æ˜ LightRendering.cppï¼ˆ541ï¼‰ InjectTranslucentVolumeLightingï¼ˆï¼‰   è¿™ æ˜¯ä½¿ç”¨å…‰åŠŸèƒ½æŠ•å°„é˜´å½±çš„å…‰å¤„ç†çš„ç»“æŸã€‚ LightRendering.cppï¼ˆ550ï¼‰ RenderLightï¼ˆï¼‰   è¿™ æ˜¯æ¯ä¸ªå…‰çš„LPV çš„ä¸»è¦æ³¨å…¥ç…§æ˜è¿‡ç¨‹çš„ç»“å°¾ LightRendering.cppï¼ˆ561-593ï¼‰ Lpv-\u0026gt; InjectLightDirectï¼ˆï¼‰   æ³¨å…¥ä½“ç§¯å…‰ä»¥å®ç°ç¯å¢ƒç«‹æ–¹ä½“è´´å›¾çš„åŠé€æ˜ DeferredShadingRenderer.cppï¼ˆ916ï¼‰ InjectAmbientCubemapTranslucentVolumeLightingï¼ˆï¼‰   è¿‡æ»¤ä½“ç§¯å…‰ä»¥è·å¾—åŠé€æ˜ DeferredShadingRenderer.cppï¼ˆ919ï¼‰ FilterTranslucentVolumeLightingï¼ˆï¼‰   LPVä¼ è¾“è¿‡ç¨‹ æ­¤å¤–ï¼Œç¬¬921è¡Œçš„æ³¨é‡Šä¸Šå†™æœ‰â€œ copypimisâ€ï¼Œä¾‹å¦‚â€œ Clear LPV bufferâ€ã€‚ DeferredShadingRenderer.cppï¼ˆ924ï¼‰ PropagateLPVsï¼ˆï¼‰   åŠ¨æ€å¤©å…‰ç»˜å›¾ DeferredShadingRenderer.cppï¼ˆ928ï¼‰ RenderDynamicSkyLightingï¼ˆï¼‰   å»¶è¿Ÿçš„åå°„å›¾å½¢ æ•è·çš„åå°„å›¾å½¢è€Œä¸æ˜¯å±å¹•ç©ºé—´ DeferredShadingRenderer.cppï¼ˆ931ï¼‰ RenderDeferredReflectionsï¼ˆï¼‰   LPVçš„GIç»˜å›¾ CompositionLighting.cppï¼ˆ344ï¼‰ AddPostProcessingLpvIndirectï¼ˆï¼‰   å±å¹•ç©ºé—´æ¬¡è¡¨é¢æ•£å°„ï¼ˆSSSSSï¼‰çš„åå¤„ç† CompositionLighting.cppï¼ˆ347-376ï¼‰   å¦‚æœå¯ç”¨äº†â€œå…‰è½´â€ï¼Œåˆ™ç»˜åˆ¶â€œå…‰è½´é®æŒ¡â€ DeferredShadingRenderer.cppï¼ˆ953ï¼‰ RenderLightShaftOcclusionï¼ˆï¼‰   å¤§æ°”é›¾å›¾ DeferredShadingRenderer.cppï¼ˆ977ï¼‰ RenderAtmosphereï¼ˆï¼‰   ç»˜å›¾é›¾ è¿™æ˜¯é«˜åº¦é›¾å—ï¼Ÿ DeferredShadingRenderer.cppï¼ˆ986ï¼‰ RenderFogï¼ˆï¼‰   ç”»ä¸€ä¸ªåŠé€æ˜çš„ç‰©ä½“ åœ¨è¿™é‡Œä¹Ÿç”»ä¸€ä¸ªå•ç‹¬çš„åŠé€æ˜çš„ä¸œè¥¿ DeferredShadingRenderer.cppï¼ˆ1000ï¼‰ RenderTranslucencyï¼ˆï¼‰   æŠ˜å°„å˜å½¢å¤„ç† DeferredShadingRenderer.cppï¼ˆ1008ï¼‰ RenderDistortionï¼ˆï¼‰   å…‰è½´çš„èµ·éœœå¤„ç† DeferredShadingRenderer.cppï¼ˆ1013ï¼‰ RenderLightShaftBloomï¼ˆï¼‰   è·ç¦»åœºAOå¤„ç†ä¸èƒ½åœ¨ å½“å‰ä¸æ”¯æŒå¤šä¸ªè§†å£ çš„åˆ†å±æ¸¸æˆä¸­ä½¿ç”¨å—ï¼Ÿ DeferredShadingRenderer.cppï¼ˆ1019ï¼‰ RenderDistanceFieldAOSurfaceCacheï¼ˆï¼‰   å®ƒåªæ˜¯åœ¨æŸ¥çœ‹ç½‘æ ¼çš„â€œè·ç¦»åœºâ€çš„å¯è§†åŒ–å¤„ç†ç»“æœå—ï¼Ÿ DeferredShadingRenderer.cppï¼ˆ1024ï¼‰ RenderMeshDistanceFieldVisualizationï¼ˆï¼‰   ç”±äºé€Ÿåº¦æ¨¡ç³Šè€Œç»˜åˆ¶è¿åŠ¨å¯¹è±¡çš„é€Ÿåº¦ DeferredShadingRenderer.cppï¼ˆ1034ï¼‰ RenderVelocitiesï¼ˆï¼‰   ä»è¿™é‡Œåˆ°æœ€åçš„å‘å¸ƒè¿‡ç¨‹ï¼Œ è¿™ä¹Ÿå¾ˆå¤æ‚è€Œä¸”å¾ˆé•¿ DeferredShadingRenderer.cppï¼ˆ1047ï¼‰ GPostProcessing.Processï¼ˆï¼‰   ä½¿ç”¨BeforeTranslucencyè®¾ç½®ç»˜åˆ¶åå¤„ç†ææ–™ PostProcessing.cppï¼ˆ878ï¼‰ AddPostProcessMaterialï¼ˆï¼‰   æ™¯æ·±å¤„ç† é€šè¿‡é«˜æ–¯æ¨¡ç³Šè¿›è¡ŒDOF å¤„ç†ä¹‹åï¼Œæ­£åœ¨æ‰§è¡Œæ•£ç„¦å¤„ç†ï¼ˆä½¿ç”¨æŒ‡å®šçš„å…‰åœˆå½¢çŠ¶çš„çº¹ç†è¿›è¡Œç»˜åˆ¶ï¼‰ï¼Œ åœ¨æ­¤é˜¶æ®µä¼¼ä¹åˆå¹¶äº†å•ç‹¬çš„åŠé€æ˜ç¼“å†²åŒº PostProcessing.cppï¼ˆ888ï¼‰ AddPostProcessDepthOfFieldGaussianï¼ˆï¼‰ PostProcessing.cppï¼ˆ898ï¼‰ AddPostProcessDepthOfFieldBokehï¼ˆï¼‰ PostProcessing.cppï¼ˆ905ï¼‰ FRCPassPostProcessBokehDOFRecombine ï¼ˆå¦‚æœæœªå¯ç”¨æ¨¡ç³Šï¼‰   ä½¿ç”¨BeforeTonemappingè®¾ç½®ç»˜åˆ¶åå¤„ç†ææ–™ PostProcessing.cppï¼ˆ913ï¼‰ AddPostProcessMaterialï¼ˆï¼‰   å¦‚æœè¦ä½¿ç”¨TemporalAA ï¼Œè¯·åœ¨æ­¤å¤„ç»˜åˆ¶ï¼Œå¦‚æœä½¿ç”¨FXAAï¼Œè¯·ç¨åå†ç»˜åˆ¶ PostProcessing.cppï¼ˆ921ï¼‰ AddTemporalAAï¼ˆï¼‰ PostProcessing.cppï¼ˆ928ï¼‰ AddTemporalAAï¼ˆï¼‰ ï¼ˆå¦‚æœä¸ä½¿ç”¨é€Ÿåº¦ç¼“å†²åŒºï¼Œè¯·å•å‡»æ­¤å¤„ï¼‰   è¿åŠ¨æ¨¡ç³Šå¤„ç† è®¾ç½®ï¼Œåˆ†è¾¨ç‡ä¸‹é‡‡æ ·ï¼Œé«˜æ–¯æ¨¡ç³Šï¼Œè¿åŠ¨æ¨¡ç³Šç»˜åˆ¶ï¼Œç»„åˆå¤„ç† PostProcessing.cppï¼ˆ932-994ï¼‰ FRCPassPostProcessMotionBlurSetup FRCPassPostProcessDownsample RenderGaussianBlurï¼ˆï¼‰ FRCPassPostProcessMotionBlur FRCPassPostProcessMotionBlurRecombine   SceneColorä¸‹é‡‡æ · PostProcessing.cppï¼ˆ1000ï¼‰ FRCPassPostProcessDownsample   ç›´æ–¹å›¾ PostProcessing.cppï¼ˆ1006-1040ï¼‰ FRCPassPostProcessHistogram FRCPassPostProcessHistogramReduce   æ­¤å¤„éœ€è¦çœ¼ç›é€‚åº”å›¾ç›´æ–¹å›¾ PostProcessing.cppï¼ˆ1046ï¼‰ AddPostProcessEyeAdaptationï¼ˆï¼‰   å¸ƒå¢å§†ç»˜å›¾ PostProcessing.cppï¼ˆ1057ï¼‰ AddBloomï¼ˆï¼‰ PostProcessing.cppï¼ˆ1060-1148ï¼‰ ï¼ˆå¯¹äºç§»åŠ¨è®¾å¤‡ï¼Œè¯·å•å‡»æ­¤å¤„ï¼‰   è‰²è°ƒæ˜ å°„ ä»…æ›¿æ¢ReplacecingTonemapperè®¾ç½®å·¥ç¨‹å›¾çš„ä¸€ç§åå¤„ç†ææ–™ï¼Œä½†æ˜¯ å¦‚æœå­˜åœ¨è¯¥ææ–™ï¼Œåˆ™æ‰§è¡Œé»˜è®¤è‰²è°ƒæ˜ å°„ PostProcessing.cppï¼ˆ1155ï¼‰ AddSinglePostProcessMaterialï¼ˆï¼‰ PostProcessing.cppï¼ˆ1171ï¼‰ AddTonemapperï¼ˆï¼‰ ï¼ˆé»˜è®¤è‰²è°ƒæ˜ å°„ï¼‰   å¦‚æœå¯ç”¨äº†FXAAï¼Œè¯·åœ¨æ­¤å¤„å¤„ç† PostProcessing.cppï¼ˆ1177ï¼‰ AddPostProcessAAï¼ˆï¼‰   ç»˜åˆ¶ä¸€äº›ç¼–è¾‘å™¨ï¼ˆå¦‚é€‰å®šçš„è½®å»“ï¼‰ï¼Œ ç„¶åä½¿ç”¨AfterTonemappingè®¾ç½®ç»˜åˆ¶åæœŸå¤„ç†ææ–™ PostProcessing.cppï¼ˆ1244ï¼‰ AddPostProcessMaterialï¼ˆï¼‰   ç”¨äºåœ°ä¸‹å’ŒGBufferçš„å¯è§†åŒ– è°ƒè¯• PostProcessing.cppï¼ˆ1246-1254ï¼‰   ç”¨äºHMDçš„åå¤„ç† Oculusæˆ–Morpheus PostProcessing.cppï¼ˆ1256-1277ï¼‰ FRCPassPostProcessHMD FRCPassPostProcessMorpheus   ä¹‹åï¼Œè°ƒè¯•å’Œé«˜åˆ†è¾¨ç‡å±å¹•æˆªå›¾åŠŸèƒ½ç­‰ã€‚ ä¹‹åï¼Œè¿›è¡Œåå¤„ç†å¹¶ç»“æŸï¼ è°¢è°¢ï¼ PostProcessing.cppï¼ˆ1279-ï¼‰    å“¦ï¼Œå¾ˆé•¿ã€‚\nå‚è€ƒé“¾æ¥ï¼š\n  å¦‚ä½•åœ¨C ++ä¸­ä»UTexture2Dè¯»å–æ•°æ®\n  https://forums.unrealengine.com/development-discussion/c-gameplay-programming/1422920-casting-converting-frhitexture-to-utexture\n  Unrealæ¸²æŸ“ç›¸å…³çš„ç¼“å†²åŒº\n  https://qiita.com/mechamogera/items/a0c369a3b853a3042cae\n  https://answers.unrealengine.com/questions/17862/access-color-and-depth-buffer-of-each-frame.html\n  https://segmentfault.com/a/1190000012737548\n  Gbuffæ•°æ®\n  æ¸²æŸ“ç³»ç»Ÿæ¦‚è¿° å›¾ç‰‡\n  ","description":"","id":24,"section":"posts","tags":["C++","UE4","Game"],"title":"UE4æ¸²æŸ“è¿‡ç¨‹","uri":"https://hugo.jiahongw.com/zh/posts/ue/ue4-render/"},{"content":"RSAç®—æ³• RSAåŠ å¯†ç®—æ³•æ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œåœ¨å…¬å¼€å¯†é’¥åŠ å¯†å’Œç”µå­å•†ä¸šä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚\n å¯¹æå¤§æ•´æ•°åšå› æ•°åˆ†è§£çš„éš¾åº¦å†³å®šäº† RSA ç®—æ³•çš„å¯é æ€§ã€‚æ¢è¨€ä¹‹ï¼Œå¯¹ä¸€æå¤§æ•´æ•°åšå› æ•°åˆ†è§£æ„ˆå›°éš¾ï¼ŒRSA ç®—æ³•æ„ˆå¯é ã€‚å‡å¦‚æœ‰äººæ‰¾åˆ°ä¸€ç§å¿«é€Ÿå› æ•°åˆ†è§£çš„ç®—æ³•çš„è¯ï¼Œé‚£ä¹ˆç”¨ RSA åŠ å¯†çš„ä¿¡æ¯çš„å¯é æ€§å°±ä¼šæåº¦ä¸‹é™ã€‚ä½†æ‰¾åˆ°è¿™æ ·çš„ç®—æ³•çš„å¯èƒ½æ€§æ˜¯éå¸¸å°çš„ã€‚ä»Šå¤©åªæœ‰çŸ­çš„ RSA é’¥åŒ™æ‰å¯èƒ½è¢«å¼ºåŠ›æ–¹å¼ç ´è§£ã€‚åˆ°å½“å‰ä¸ºæ­¢ï¼Œä¸–ç•Œä¸Šè¿˜æ²¡æœ‰ä»»ä½•å¯é çš„æ”»å‡»RSAç®—æ³•çš„æ–¹å¼ã€‚åªè¦å…¶é’¥åŒ™çš„é•¿åº¦è¶³å¤Ÿé•¿ï¼Œç”¨RSAåŠ å¯†çš„ä¿¡æ¯å®é™…ä¸Šæ˜¯ä¸èƒ½è¢«ç ´è§£çš„ã€‚\n å…¬é’¥/åŒå¯†é’¥/éå¯¹ç§° åŠ å¯† æ¶‰åŠåˆ°ä¸¤ä¸ªå¯†é’¥çš„ä½¿ç”¨:\n ä¸€ä¸ªå…¬é’¥, å¯ä»¥è¢«ä»»ä½•äººçŸ¥é“ï¼Œç”¨äºåŠ å¯†æ¶ˆæ¯å’ŒéªŒè¯ç­¾å ä¸€ä¸ªç§é’¥, åªæœ‰æ¥æ”¶æ–¹æ‰çŸ¥é“ï¼Œç”¨äºè§£å¯†æ¶ˆæ¯å’Œåˆ›é€ ç­¾å  RSAå®ç°è¿‡ç¨‹ 1. å…¬é’¥ä¸ç§é’¥çš„äº§ç”Ÿ ç”Ÿæˆå…¬é’¥eå’Œç§é’¥dçš„æ­¥éª¤å¦‚ä¸‹ï¼š\n éšæ„é€‰æ‹©ä¸¤ä¸ªå¤§çš„è´¨æ•°$p$å’Œ$q$ï¼Œ$p$ä¸ç­‰äº$q$ï¼Œè®¡ç®—$n=pq$ã€‚ æ ¹æ®æ¬§æ‹‰å‡½æ•°ï¼Œæ±‚$r = \\varphi (N) = \\varphi (p)\\varphi (q) = (p - 1)(q - 1)$ é€‰æ‹©ä¸€ä¸ªå°äº$r$çš„æ•´æ•°$e$ï¼Œä½¿$e$ä¸$r$äº’è´¨ã€‚å¹¶æ±‚å¾—$e$å…³äº$r$çš„æ¨¡åå…ƒç´ ï¼Œå‘½åä¸º$d$(æ±‚$d$ä»¤$ed \\equiv 1(\\bmod ;r)$)ã€‚(æ¨¡åå…ƒç´ å­˜åœ¨ï¼Œå½“ä¸”ä»…å½“$e$ä¸$r$äº’è´¨) å°†$p$å’Œ$q$çš„è®°å½•é”€æ¯  ç»è¿‡ä¸Šé¢å››ä¸ªæ­¥éª¤æœ€ç»ˆå¯ä»¥å¾—åˆ°å…¬é’¥$(n,e)$å’Œç§é’¥$(n,d)$ã€‚\næ¥æ”¶æ¶ˆæ¯çš„äººå°†è‡ªå·±çš„å…¬é’¥$(n,e)$å‘é€ç»™å‘é€æ¶ˆæ¯çš„äºº,å‘é€çš„äººä½¿ç”¨è¿™ä¸ªå…¬é’¥åŠ å¯†ä¿¡æ¯å‘é€ç»™æ¥æ”¶æ–¹ï¼Œè€Œæ¥æ”¶æ–¹å°†ç§é’¥$(n,d)$ä¿å­˜èµ·æ¥ç”¨äºè§£å¯†ã€‚\nä¸‹é¢å®ç°RSAç±»\n å‚è€ƒèµ„æ–™ï¼š\n ç±³å‹’-æ‹‰å®¾ç´ æ€§æ£€éªŒ RSAåŠ å¯†ç®—æ³• C++å®ç°   å®éªŒæ­¥éª¤ä¸ç»“æœ 1.å®ç°å¤§æ•´æ•°ç±» å› ä¸ºè¯¥åŠ å¯†ç®—æ³•æ¶‰åŠçš„æ•°å¯èƒ½å¾ˆå¤§ï¼Œè€ŒC++ä¸­å¹¶æ²¡æœ‰åƒJavaä¸€æ ·ï¼Œå†…ç½®å¤§æ•´æ•°ç±»BigIntegerï¼Œæ•…éœ€è‡ªå·±å®ç°ï¼Œè¿™é‡Œæˆ‘å‚è€ƒäº†ç½‘ä¸Šçš„ä¸€äº›èµ„æ–™è®¾è®¡äº†BigIntegerç±»ï¼Œå®ç°äº†åŠ å‡ä¹˜é™¤ä»¥åŠæ¨¡å¹‚ç­‰è¿ç®—ï¼Œä¹Ÿå®ç°äº†è¿ç®—ç¬¦é‡è½½ï¼Œå…·ä½“å‚è€ƒå®ç°çš„æ–¹æ³•å¦‚ä¸‹ï¼š\n2. è®¾è®¡RSAç±» ç¼–å†™rsa.hå¤´æ–‡ä»¶ï¼Œå®šä¹‰RSAç±»ï¼Œå…¶ä¸­åŒ…å«çš„æˆå‘˜ä»¥åŠæˆå‘˜å‡½æ•°å¦‚ä¸‹ï¼š\nä¸‹é¢åˆ†åˆ«å®ç°ä¸Šè¿°çš„å„ä¸ªæ–¹æ³•\né¦–å…ˆè¦ç”Ÿæˆå¯†é’¥å¯¹ï¼Œå³ç”Ÿæˆå…¬é’¥å’Œç§é’¥ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•°på’Œq,æ˜¾ç„¶ï¼Œç´ æ•°æ˜¯ä¸å¯èƒ½æ˜¯å¶æ•°çš„ï¼Œæ•…å®šä¹‰ä¸€ä¸ªç”Ÿæˆéšæœºå¥‡æ•°çš„å‡½æ•°BigInteger createOddNum(unsigned len)å‚æ•°ä¸ºå¥‡æ•°çš„é•¿åº¦ã€‚\nä½¿ç”¨16è¿›åˆ¶çš„éšæœºå­—æ¯ï¼Œç„¶åéšæœºé€‰å–å…¶ä¸­çš„len/4ä¸ªå¾—åˆ°ä¸€ä¸ªéšæœºçš„å¤§å¥‡æ•°ï¼Œåªéœ€è¦æœ«å°¾é‚£ä¸ªæ•°ä¸ºå¥‡æ•°å³å¯ï¼Œæœ€åè¿”å›BigIntegerç±»å‹çš„å¥‡æ•°å¤§æ•´æ•°ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š\nç„¶åå®šä¹‰ä¸€ä¸ªç”Ÿæˆç´ æ•°çš„å‡½æ•°ï¼Œå…¶ä¸­ç”¨åˆ°ç±³å‹’-æ‹‰å®¾ç´ æ€§æ£€éªŒç®—æ³•åˆ¤æ–­ç”Ÿæˆçš„ç´ æ•°æ˜¯å¦ä¸ºç´ æ•°ç´ æ•°ï¼š\nç±³å‹’-æ‹‰å®¾ç´ æ€§æ£€æµ‹ç®—æ³• åŸºäºä»¥ä¸‹å®šç†ï¼š\n è´¹é©¬å°å®šç†  è¦æµ‹è¯•$N$æ˜¯å¦ä¸ºç´ æ•°ï¼Œé¦–å…ˆå°†$Nâˆ’1$åˆ†è§£ä¸º$2^{s}d$ã€‚åœ¨æ¯æ¬¡æµ‹è¯•å¼€å§‹æ—¶ï¼Œå…ˆéšæœºé€‰ä¸€ä¸ªä»‹äº$[1,Nâˆ’1]$çš„æ•´æ•°$a$ï¼Œä¹‹åå¦‚æœå¯¹æ‰€æœ‰çš„$râˆˆ[0,sâˆ’1]$ï¼Œè‹¥${a^d}\\bmod N \\ne 1$ä¸”${a^{{2^r}d}}\\bmod N \\ne - 1$ï¼Œåˆ™$N$æ˜¯åˆæ•°ã€‚å¦åˆ™ï¼Œ$N$æœ‰$3/4$çš„æ¦‚ç‡ä¸ºç´ æ•°ã€‚\nå…³é”®ä»£ç å¦‚ä¸‹ï¼š\nç”Ÿæˆç´ æ•°çš„é€»è¾‘å°±æ˜¯é¦–å…ˆä½¿ç”¨å‡½æ•°createOddNumç”Ÿæˆä¸€ä¸ªå¤§å¥‡æ•°ï¼Œç„¶åè°ƒç”¨isPrimeåˆ¤æ–­æ˜¯å¦ä¸ºä¸€ä¸ªç´ æ•°ï¼Œæ˜¯çš„è¯å°±å¯ä»¥returnï¼Œä¸ç„¶ç»§ç»­å¯»æ‰¾ï¼ŒçŸ¥é“ç”Ÿæˆä¸€ä¸ªç´ æ•°ã€‚\næ¥ä¸‹æ¥è®¡ç®—nå€¼ï¼Œnå€¼çš„è®¡ç®—å¾ˆç®€å•ï¼Œç›´æ¥ä½¿ç”¨$n = p * q$ è¿™ä¸ªå¼å­å°±èƒ½å¤Ÿè®¡ç®—å‡ºæ¥ï¼›è®¡ç®—æ¬§æ‹‰å€¼ä¹Ÿä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨$\\varphi(n) = (p-1) * (q-1)$å¾—å‡ºã€‚å…¶ä¸­æ¯”è¾ƒéš¾çš„æ˜¯ç”Ÿæˆçš„ç§é’¥dã€‚\nä¸‹é¢å®šä¹‰ä¸€ä¸ªRSAç±»çš„åˆå§‹åŒ–å‡½æ•°init()â€‹ï¼Œç”Ÿæˆpã€qä»¥åŠå¯†é’¥å¯¹ï¼Œå¦‚ä¸‹ï¼š\nåœ¨åˆ›å»ºå…¬é’¥eå’Œç§é’¥dçš„å‡½æ•°createExponent(eul)ä¸­ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªæ¯”æ¬§æ‹‰å€¼å°çš„å…¬é’¥eï¼Œå…¶ä¸­eä¸ºä¸€ä¸ªç´ æ•°ï¼Œç›´æ¥è°ƒç”¨å‡½æ•°createPrime()ç”Ÿæˆï¼Œç„¶åä½¿ç”¨å¤§æ•´æ•°ç±»ä¸­çš„æ±‚æ¨¡é€†å…ƒï¼Œå³æ±‚å‡ºç§é’¥dã€‚\næ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•  é€†å…ƒ\né€†å…ƒæ˜¯æ¨¡è¿ç®—ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬é€šå¸¸è¯´ A æ˜¯ B æ¨¡ C çš„é€†å…ƒï¼Œå®é™…ä¸Šæ˜¯æŒ‡ A * B = 1 mod Cï¼Œä¹Ÿå°±æ˜¯è¯´ A ä¸ B çš„ä¹˜ç§¯æ¨¡ C çš„ä½™æ•°ä¸º 1ã€‚å¯è¡¨ç¤ºä¸º A = B^(-1) mod Cã€‚\næ‰“ä¸ªæ¯”æ–¹ï¼Œ7 æ¨¡ 11 çš„é€†å…ƒï¼Œå³ï¼š7^(-1) mod 11 = 8ï¼Œè¿™æ˜¯å› ä¸º 7 Ã— 8 = 5 Ã— 11 + 1ï¼Œæ‰€ä»¥è¯´ 7 æ¨¡ 11 çš„é€†å…ƒæ˜¯ 8ã€‚\n æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ˜¯æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆåˆå«è¾—è½¬ç›¸é™¤æ³•ï¼‰çš„æ‰©å±•ã€‚å·²çŸ¥æ•´æ•°aã€bï¼Œæ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥åœ¨æ±‚å¾—aã€bçš„æœ€å¤§å…¬çº¦æ•°çš„åŒæ—¶ï¼Œèƒ½æ‰¾åˆ°æ•´æ•°xã€yï¼ˆå…¶ä¸­ä¸€ä¸ªå¾ˆå¯èƒ½æ˜¯è´Ÿæ•°ï¼‰ï¼Œä½¿å®ƒä»¬æ»¡è¶³è´ç¥–ç­‰å¼\n$$\nax{\\rm{ }} + {\\rm{ }}by{\\rm{ }} = {\\rm{ }}gcd\\left( {a,b} \\right).\n$$\nåœ¨RSAç®—æ³•ä¸­æ±‚ç§é’¥ä¸­çš„æ•´æ•°dæ—¶ï¼Œéœ€è¦ä½¿å¾— (e * d ) % n = 1ï¼Œè¯¥æ–¹ç¨‹ç­‰ä»·äº e * d = 1 + y * n ï¼ˆyä¸ºæ•´æ•°ï¼‰ï¼Œä¹Ÿç­‰ä»·äº e * d - y * n = 1ã€‚\nå› æ­¤æ±‚è§£dçš„è¿‡ç¨‹å°±æ˜¯æ±‚è§£è¯¥äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„ï¼ˆeå’Œnå·²çŸ¥ï¼Œæ±‚è§£dï¼‰ï¼Œå³æ±‚eæ¨¡nçš„é€†å…ƒã€‚\nå…³é”®ä»£ç å¦‚ä¸‹ï¼š\næˆ‘ä»¬çŸ¥é“ï¼ŒRSAçš„åŠ å¯†ä¸è§£å¯†å…¶å®å°±æ˜¯ä¸€ä¸ªæ¨¡å¹‚çš„è¿ç®—ï¼Œè€Œè¿™ä¸ªæ¨¡å¹‚çš„è¿ç®—å·²ç»åœ¨å¤§æ•´æ•°ç±»ä¸­å®ç°äº†ï¼Œå¦‚ä¸‹ï¼š\nä½¿ç”¨RSAç±»è¿›è¡ŒåŠ å¯†è§£å¯†çš„å‡½æ•°åªéœ€è¦è°ƒç”¨è¿™ä¸ªæ¨¡å¹‚è¿ç®—å³å¯ï¼Œä¾‹å¦‚ç§é’¥åŠ å¯†å¯ä»¥è¿™æ ·è°ƒç”¨ï¼š\nä»¥ä¸Šå°±è®¾è®¡å®Œäº†RSAç±»çš„ç›¸å…³æ“ä½œï¼Œä¸»è¦æ˜¯åŒ…æ‹¬å¯†é’¥çš„ç”Ÿæˆã€‚ä¸‹é¢å°†RSAåŠ å¯†è§£å¯†çš„æ“ä½œå°è£…åœ¨ä¸€ä¸ªç±»ä¸­ã€‚\n3. è®¾è®¡åŠ å¯†è§£å¯†ç±»EncryptDecrypt ä¸»è¦çš„æ–¹æ³•åŠæˆå‘˜å¦‚ä¸‹ï¼š\nå®ç°RSAåŠ å¯†è§£å¯†å­—ç¬¦ä¸² åŠ å¯†å­—ç¬¦ä¸²çš„é€»è¾‘æ˜¯ï¼Œå…ˆå°†å­—ç¬¦ä¸²ä»¥æ¯ä¸¤ä¸ªå­—ç¬¦ ä¸€ç»„ï¼Œè½¬åŒ–ä¸ºä¸€ä¸ª16è¿›åˆ¶æ•°æ®åºåˆ—ï¼Œä½¿ç”¨vectorå®¹å™¨ä¿å­˜ï¼Œä¹‹åè°ƒç”¨rsaçš„å…¬é’¥åŠ å¯†å‡½æ•°è¿›è¡ŒåŠ å¯†ï¼Œå¦‚ä¸‹æ˜¯å…³é”®ä»£ç ï¼š\nè§£å¯†å‡½æ•°å…¶å®æ˜¯æ¥å—ä¸€ä¸ªåŠ å¯†åçš„16è¿›åˆ¶åºåˆ—ï¼Œç„¶åå¯¹è¿™ä¸ªåºåˆ—è°ƒç”¨RSAçš„ç§é’¥è§£å¯†å‡½æ•°è¿›è¡Œè§£å¯†ï¼Œç„¶åå¾—åˆ°è§£å¯†åçš„16è¿›åˆ¶æ•°æ®åºåˆ—ï¼Œæœ€åè¿˜æœ‰ä¸€æ­¥å°±æ˜¯éœ€è¦å°†è¿™ä¸ª16è¿›åˆ¶åºåˆ—æœ€ç»ˆè½¬åŒ–ä¸ºåŸæ¥çš„å­—ç¬¦ä¸²ï¼Œåªéœ€è¦æ ¹æ®asciiç çš„æ•°å€¼å³å¯å¾—åˆ°ï¼Œè¿™é‡Œç¼–å†™äº†ä¸€ä¸ªhex2stringå‡½æ•°ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š\nå®ç°æ•ˆæœ\né¦–å…ˆæ˜¾ç¤ºå¯†é’¥ï¼š\nåŠ å¯†å­—ç¬¦ä¸²\nè§£å¯†å­—ç¬¦ä¸²\nå®ç°RSAåŠ å¯†è§£å¯†æ–‡ä»¶ å®ç°RSAåŠ å¯†è§£å¯†æ–‡ä»¶æ—¶åŸºäºRSAåŠ å¯†è§£å¯†å­—ç¬¦ä¸²å®ç°çš„ï¼Œå…¶ä¸­ä¸»è¦çš„åŠ å¯†é€»è¾‘å°±æ˜¯å°†ä¸€ä¸ªæ–‡ä»¶çœ‹ä½œæ˜¯ä¸€è¡Œä¸€è¡Œçš„å­—ç¬¦ä¸²æ–‡æœ¬ï¼Œæ²¡æ¯è¯»å–ä¸€è¡Œï¼Œå°±è°ƒç”¨åŠ å¯†å­—ç¬¦ä¸²çš„å‡½æ•°è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå°†åŠ å¯†å¾—åˆ°çš„16è¿›åˆ¶åºåˆ—å†™å…¥åˆ°å¦å¤–ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶ä¹Ÿå°±æ˜¯åŠ å¯†åçš„æ–‡ä»¶ï¼Œä¸»è¦å…³é”®ä»£ç å¦‚ä¸‹ï¼š\nè§£å¯†æ–‡ä»¶çš„å‡½æ•°ç¨å¾®æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œæ˜¯ä»æ‰“å¼€çš„å¾…è§£å¯†æ–‡ä»¶ä¸­å¾ªç¯è¯»å–æ¯ä¸€ä¸ª16è¿›åˆ¶æ•°æ®ï¼Œç„¶åå¯¹æ¯ä¸€ä¸ª16è¿›åˆ¶æ•°æ®è°ƒç”¨è§£å¯†å‡½æ•°å¾—åˆ°è§£å¯†åçš„16è¿›åˆ¶æ•°æ®ï¼Œå°†16è¿›åˆ¶æ•°æ®è½¬ä¸ºå­—ç¬¦ä¸²åå†ç›¸ç»§çš„å†™åˆ°å¦å¤–ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå³è§£å¯†åçš„æ–‡ä»¶ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š\nå®ç°æ•ˆæœ\nåŠ å¯†æ–‡ä»¶\nè§£å¯†æ–‡ä»¶\nåŠ å¯†æ–‡ä»¶è§£å¯†æ–‡ä»¶å¯¹æ¯”\nå®ç°RSAæ•°å­—ç­¾ååŠéªŒè¯ å®ç°æ•°å­—ç­¾åæ–¹æ¡ˆï¼ŒæŒ‰ç…§ä»¥ä¸‹çš„æµç¨‹å›¾è¿›è¡Œæ“ä½œã€‚\né¦–å…ˆéœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œä¿¡æ¯çš„æ‘˜è¦ï¼Œå¾—åˆ°Hashå€¼ï¼Œè¿™é‡Œé€‰æ‹©çš„Hashç®—æ³•æ˜¯SHA512ç®—æ³•ï¼Œå¯ä»¥ç›´æ¥å¯¹æ–‡ä»¶è¿›è¡Œä¿¡æ¯æ‘˜è¦ã€‚\nå¯ä»¥ç›´æ¥include C++ å®ç°çš„\u0026quot;sha512.h\u0026quot;æ–‡ä»¶å¤´ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹çš„è¯­å¥å°±èƒ½å¤Ÿç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º512çš„Hashå€¼ï¼Œå¦‚ä¸‹ï¼š\nå¯ä»¥åœ¨å‘½ä»¤è¡Œè¾“å‡ºæ–‡ä»¶çš„Hashæ‘˜è¦å€¼å¦‚ä¸‹:\næ•°å­—ç­¾åçš„å®ç°ç±»ä¼¼å­—ç¬¦ä¸²åŠ å¯†ï¼Œå¯¹æ–‡ä»¶çš„hashå€¼è¿›è¡ŒåŠ å¯†å¾—åˆ°åé¢çš„16è¿›åˆ¶åºåˆ—ï¼Œç„¶åå°†16è¿›åˆ¶åºåˆ—ä¼´éšæ–‡ä»¶å‘é€å‡ºå»ï¼Œç­¾åçš„å…³é”®ä»£ç å°±æ˜¯å¯¹hashå€¼è¿›è¡ŒåŠ å¯†ï¼Œå¦‚ä¸‹ï¼š\néªŒè¯å‡½æ•°ç›´æ¥å°†16è¿›åˆ¶åºåˆ—è¿›è¡Œè§£å¯†ï¼Œç„¶åè¿˜åŸæˆå­—ç¬¦ä¸²å†ä¸æ”¶åˆ°çš„æ–‡ä»¶çš„hashå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰ï¼Œé‚£ä¹ˆéªŒè¯æˆåŠŸï¼›å¦åˆ™éªŒè¯å¤±è´¥ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š\nå®ç°æ•ˆæœ\næ•°å­—ç­¾å\néªŒè¯æ•°å­—ç­¾å\n","description":"","id":25,"section":"posts","tags":["rsa"],"title":"RSAåŠ å¯†ç®—æ³•","uri":"https://hugo.jiahongw.com/zh/posts/mima/rsa/"},{"content":"è´¹é©¬å¤§å®šç†åœ¨æ•°å­¦é‡Œæœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç°è±¡ï¼Œå³åœ¨äºå®ƒæ˜¯é”™è¯¯è¯æ˜æ•°é‡æœ€å¤šçš„æ•°å­¦é¢˜ã€‚\nè´¹é©¬å°å®šç† è´¹é©¬å°å®šç†æ˜¯æ•°è®ºä¸­çš„ä¸€ä¸ªå®šç†ï¼šå‡å¦‚$a$æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ$p$æ˜¯ä¸€ä¸ªè´¨æ•°ï¼Œé‚£ä¹ˆ$a^{p}-a$æ˜¯$p$çš„å€æ•°ï¼Œå¯ä»¥è¡¨ç¤ºä¸º\n$$\na^{p} \\equiv a \\pmod p\n$$\nå½“aä¸æ˜¯pçš„å€æ•°æ—¶ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸º\n$$\na^{p-1} \\equiv 1 \\pmod p\n$$\n åŒä½™ç¬¦å·\nä¸¤ä¸ªæ•´æ•°aï¼Œbï¼Œè‹¥å®ƒä»¬é™¤ä»¥æ­£æ•´æ•°mæ‰€å¾—çš„ä½™æ•°ç›¸ç­‰ï¼Œåˆ™ç§°aï¼Œbå¯¹äºæ¨¡måŒä½™\nè®°ä½œ$a \\equiv b\\pmod {m}$\nè¯»ä½œaåŒä½™äºbæ¨¡mï¼Œæˆ–è¯»ä½œaä¸bå…³äºæ¨¡måŒä½™ã€‚\næ¯”å¦‚$26 \\equiv 14 \\pmod{12}$\n ä¸€ç§è¯æ˜ï¼š\nè€ƒè™‘ä¸€æ ¹æœ‰ [å…¬å¼] é¢—ç å­çš„é¡¹é“¾ï¼Œå…¶æ¯é¢—ç å­æœ‰ [å…¬å¼] ç§æŸ“è‰²é€‰æ‹©ï¼Œç„¶åç”±ä¸‹å›¾è•´å«çš„ç²¾ç¥å¯å¾—åŸå‘½é¢˜æˆç«‹ã€‚\nè´¹é©¬å¤§å®šç† å½“æ•´æ•°$n\u0026gt;2$æ—¶ï¼Œå…³äº$x, y, z$çš„ä¸å®šæ–¹ç¨‹\n$$\nx^{n} + y^{n} = z^{n}\n$$\næ²¡æœ‰æ•´æ•°è§£\n","description":"è´¹é©¬å¤§å®šç†ã€è´¹é©¬å°å®šç†","id":26,"section":"posts","tags":["è´¹é©¬"],"title":"è´¹é©¬ğŸ¦“å®šç†","uri":"https://hugo.jiahongw.com/zh/posts/math/feima/"},{"content":"è´¹é©¬å¤§å®šç†åœ¨æ•°å­¦é‡Œæœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç°è±¡ï¼Œå³åœ¨äºå®ƒæ˜¯é”™è¯¯è¯æ˜æ•°é‡æœ€å¤šçš„æ•°å­¦é¢˜ã€‚\nè´¹é©¬å°å®šç† è´¹é©¬å°å®šç†æ˜¯æ•°è®ºä¸­çš„ä¸€ä¸ªå®šç†ï¼šå‡å¦‚$a$æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ$p$æ˜¯ä¸€ä¸ªè´¨æ•°ï¼Œé‚£ä¹ˆ$a^{p}-a$æ˜¯$p$çš„å€æ•°ï¼Œå¯ä»¥è¡¨ç¤ºä¸º\n$$\na^{p} \\equiv a \\pmod p\n$$\nå½“aä¸æ˜¯pçš„å€æ•°æ—¶ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸º\n$$\na^{p-1} \\equiv 1 \\pmod p\n$$\n åŒä½™ç¬¦å·\nä¸¤ä¸ªæ•´æ•°aï¼Œbï¼Œè‹¥å®ƒä»¬é™¤ä»¥æ­£æ•´æ•°mæ‰€å¾—çš„ä½™æ•°ç›¸ç­‰ï¼Œåˆ™ç§°aï¼Œbå¯¹äºæ¨¡måŒä½™\nè®°ä½œ$a \\equiv b\\pmod {m}$\nè¯»ä½œaåŒä½™äºbæ¨¡mï¼Œæˆ–è¯»ä½œaä¸bå…³äºæ¨¡måŒä½™ã€‚\næ¯”å¦‚$26 \\equiv 14 \\pmod{12}$\n ä¸€ç§è¯æ˜ï¼š\nè€ƒè™‘ä¸€æ ¹æœ‰ [å…¬å¼] é¢—ç å­çš„é¡¹é“¾ï¼Œå…¶æ¯é¢—ç å­æœ‰ [å…¬å¼] ç§æŸ“è‰²é€‰æ‹©ï¼Œç„¶åç”±ä¸‹å›¾è•´å«çš„ç²¾ç¥å¯å¾—åŸå‘½é¢˜æˆç«‹ã€‚\nè´¹é©¬å¤§å®šç† å½“æ•´æ•°$n\u0026gt;2$æ—¶ï¼Œå…³äº$x, y, z$çš„ä¸å®šæ–¹ç¨‹\n$$\nx^{n} + y^{n} = z^{n}\n$$\næ²¡æœ‰æ•´æ•°è§£\n","description":"è´¹é©¬å¤§å®šç†ã€è´¹é©¬å°å®šç†","id":27,"section":"posts","tags":["è´¹é©¬"],"title":"è´¹é©¬ğŸ¦“å®šç†","uri":"https://hugo.jiahongw.com/zh/posts/network/feima/"},{"content":"æ“ä½œæµç¨‹ ç”¨åˆ°çš„äº‘äº§å“åŠæœåŠ¡            åºå· äº‘äº§å“ åŠŸèƒ½åŠç”¨é€” å¤‡æ³¨   1 å®¹å™¨é•œåƒä»“åº“ ç”¨äºå­˜æ”¾ç¤ºä¾‹demoé•œåƒ    2 äº‘ç¼–è¯‘ ç¼–è¯‘å’Œæ‰“åŒ…å®ä¾‹demoä»£ç ï¼ŒåŒæ—¶å°†é•œåƒæ¨é€è‡³å®¹å™¨é•œåƒä»“åº“    3 ç§æœ‰ç½‘ç»œ åˆ›å»ºç”¨äºKubernetesé›†ç¾¤ï¼Œå·¥ä½œèŠ‚ç‚¹æ‰€éœ€çš„VPC    4 Access Key æˆæƒK8Sé›†ç¾¤è®¿é—®äº¬ä¸œæ™ºè”äº‘å„ä¸ªæœåŠ¡APIçš„æˆæƒå‡­è¯ã€‚ ä¾‹å¦‚ï¼šé›†ç¾¤å‘äº¬ä¸œæ™ºè”äº‘ç›‘æ§ä¸­å¿ƒï¼Œæ¨é€ä¸šåŠ¡ç›‘æ§æ•°æ®å°±éœ€è¦ç”¨åˆ°AK/SKã€‚   5 Kubernetesé›†ç¾¤ åˆ›å»ºK8Sé›†ç¾¤ï¼Œéƒ¨ç½²åº”ç”¨æœåŠ¡ è§„æ ¼ï¼šé€šç”¨å‹1æ ¸4GBï¼Œå…¬ç½‘IP 5Mpbs   6 äº‘ç›‘æ§ æŸ¥è¯¢ä¸šåŠ¡ç›‘æ§æ•°æ®ï¼Œé…ç½®å‘Šè­¦æœåŠ¡ã€‚     å®æ“ ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡Dockeré•œåƒ åˆ›å»ºå®¹å™¨é•œåƒä»“åº“ æ–°å»ºæ³¨å†Œè¡¨\n  ç™»å½•äº¬ä¸œæ™ºè”äº‘æ§åˆ¶å°ï¼Œé€‰æ‹©äº‘æœåŠ¡-\u0026gt;å¼¹æ€§è®¡ç®—-\u0026gt;å®¹å™¨é•œåƒä»“åº“ã€‚\n  è¿›å…¥æ³¨å†Œè¡¨é¡µé¢ï¼Œé€‰æ‹©â€œååŒ—-åŒ—äº¬â€åœ°åŸŸï¼Œç‚¹å‡»â€œæ–°å»ºâ€æŒ‰é’®ï¼Œè¿›å…¥æ–°å»ºæ³¨å†Œè¡¨é¡µé¢ã€‚\n  åœ¨æ–°å»ºæ³¨å†Œè¡¨é¡µé¢ï¼Œè®¾ç½®åç§°ï¼Œå‹¾é€‰åŒæ„æœåŠ¡æ¡æ¬¾ã€‚ç‚¹å‡»â€œä¿å­˜â€æŒ‰é’®å³å¯ã€‚\n  æ–°å»ºé•œåƒä»“åº“\n  åˆ‡æ¢è‡³â€œé•œåƒä»“åº“â€åˆ—è¡¨é¡µé¢ï¼Œé€‰æ‹©åœ°åŸŸâ€œååŒ—-åŒ—äº¬â€ï¼Œç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ã€‚\n  åœ¨æ–°å»ºé•œåƒä»“åº“é¡µé¢ï¼Œ é€‰æ‹©åˆšæ–°å»ºçš„æ³¨å†Œè¡¨ï¼Œé…ç½®æ³¨å†Œè¡¨åç§°ä¿¡æ¯\n  åˆ›å»ºæˆåŠŸåï¼Œåœ¨é•œåƒä»“åº“é‡Œåˆ—è¡¨å¯ä»¥çœ‹åˆ°åˆ°ä»“åº“åç§°ã€‚ä»¥åŠé•œåƒä»“åº“çš„URI\n  ç¼–è¯‘æ„å»ºDockeré•œåƒ æ–°å»ºç¼–è¯‘ä»»åŠ¡\n  é€‰æ‹©äº‘æœåŠ¡-\u0026gt;å¼€å‘è€…å·¥å…·-\u0026gt;äº‘ç¼–è¯‘ï¼Œè¿›å…¥äº‘ç¼–è¯‘æœåŠ¡é¡µé¢ã€‚\n  åœ¨ä»»åŠ¡åˆ—è¡¨é¡µé¢ï¼Œé€‰æ‹©ååŒ—-åŒ—äº¬åœ°åŸŸï¼Œ ç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ï¼Œé€‰æ‹©ä¸­â€œåˆ›å»ºä»»åŠ¡â€\n  åœ¨åˆ›å»ºä»»åŠ¡é¡µé¢åšå¦‚ä¸‹é…ç½®ï¼š\nä»»åŠ¡é…ç½®ä¸æºç é…ç½®å¦‚ä¸‹ï¼Œå…¶ä¸­ä»£ç åº“åœ°å€ä¸º:https://code.jdcloud.com/jdcloud-monitor/prometheus-demo.git\næ„å»ºå­˜æ”¾çš„é…ç½®å¦‚ä¸‹ï¼š\nå…¶ä»–é€‰é¡¹ä¿æŒé»˜è®¤é…ç½®\n  ç‚¹å‡»â€œä¿å­˜â€æŒ‰é’®ï¼Œå®Œæˆä»»åŠ¡çš„åˆ›å»ºã€‚\n  æ„å»ºä»»åŠ¡\n  é€‰ä¸­åˆšåˆ›å»ºçš„ä»»åŠ¡ï¼Œç‚¹å‡»æ“ä½œäº†ä¸‹çš„æ‰§è¡Œæ„å»ºæŒ‰é’®ã€‚\n  åœ¨å¼¹å‡ºçš„æ„å»ºé¡µé¢ï¼Œé…ç½®å¦‚ä¸‹ä¿¡æ¯,å…¶ä¸­CommitIDä¸ºece523fc68cce1cd3d48b38fc07252f81ba2c44c\n  ç‚¹å‡»â€œç¡®å®šâ€æŒ‰é’®ï¼Œæ‰§è¡Œç¼–è¯‘æ„å»ºæ“ä½œã€‚å½“äº§ç‰©å½’æ¡£çŠ¶æ€å˜ä¸ºå®ŒæˆçŠ¶æ€æ—¶ï¼Œå®Œæˆæ„å»ºã€‚\n  ç¬¬äºŒæ­¥ï¼šç”¨K8Séƒ¨ç½²åº”ç”¨æœåŠ¡ å‰æå‡†å¤‡ åˆ›å»ºkubernetesè¿›ç¾¤æ—¶ï¼Œéœ€è¦ç”¨åˆ°VPC å’Œ å¯†é’¥ä¿¡æ¯ï¼Œ åªéœ€åˆ›å»ºVPCå³å¯ï¼Œæ— éœ€åˆ›å»ºå­ç½‘ï¼Œå·¥ä½œèŠ‚ç‚¹ç»„ç”¨åˆ°çš„å­ç½‘ä¼šè‡ªå·±åˆ›å»ºã€‚\nåˆ›å»ºVPC\n  é€‰æ‹©äº‘æœåŠ¡-\u0026gt;ç½‘ç»œ-\u0026gt;ç§æœ‰ç½‘ç»œï¼Œè¿›å…¥ç§æœ‰ç½‘ç»œVPCåˆ—è¡¨é¡µé¢ã€‚\n  åœ¨ç§æœ‰ç½‘ç»œé¡µé¢ï¼Œé€‰ä¸­ååŒ—-åŒ—äº¬åœ°åŸŸï¼Œç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ã€‚\n  é…ç½®ç½‘ç»œåç§°ï¼ŒIPv4CIRDé€‰æ‹© 192.168.0.0/16ã€‚\n  åˆ›å»ºAK/SKå¯†é’¥\n  ç‚¹å‡»é¡¶éƒ¨å¯¼èˆªçš„è´¦æˆ·åç§°ï¼Œåœ¨å¼¹å‡ºçš„ä¸‹æ‹‰æ¡†ä¸­ç‚¹å‡»â€œAccess Keyç®¡ç†â€\n  åœ¨è¿›å…¥çš„Access Keyç®¡ç†é¡µé¢ä¸­ï¼Œç‚¹å‡»â€œåˆ›å»ºAccess Keyâ€ï¼Œä¼šæç¤ºè¾“å…¥çŸ­ä¿¡éªŒè¯ç ï¼Œè¾“å…¥å®Œå°±å¯ä»¥åˆ›å»ºäº†\n  åˆ›å»ºKubernetesé›†ç¾¤   é€‰æ‹©äº‘æœåŠ¡-\u0026gt;å¼¹æ€§è®¡ç®—-\u0026gt; Kubernetesé›†ç¾¤ï¼Œè¿›å…¥é›†ç¾¤åˆ—è¡¨é¡µé¢ã€‚\n  é€‰æ‹©â€œååŒ—-åŒ—äº¬â€åœ°åŸŸï¼Œç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ï¼Œåœ¨æ–°å»ºKubernetesé›†ç¾¤ï¼Œè¿›è¡Œå¦‚ä¸‹é…ç½®\né›†ç¾¤ä¿¡æ¯é…ç½®\nç½‘ç»œä¸å·¥ä½œèŠ‚ç‚¹é…ç½®\nå¯†ç é…ç½®\n  éƒ¨ç½²æœåŠ¡ æ³¨å†Œé•œåƒä»“åº“\n æœ¬æ“ä½œæ˜¯å°†å®¹å™¨é•œåƒä»“åº“çš„æ³¨å†Œè¡¨åœ¨K8SæœåŠ¡ä¸­è¿›è¡Œæ³¨å†Œï¼Œä¾¿äºåç»­podä¸Šéƒ¨ç½²åº”ç”¨æœåŠ¡ã€‚\n   é€‰æ‹©äº‘æœåŠ¡-\u0026gt;å¼¹æ€§è®¡ç®—-\u0026gt; äº‘ä¸»æœºï¼Œè¿›å…¥äº‘ä¸»æœºåˆ—è¡¨é¡µé¢ã€‚åœ¨äº‘ä¸»æœºåˆ—è¡¨å¯ä»¥çœ‹åˆ°æ–°åˆ›å»ºäº†2å°äº‘ä¸»æœºå®ä¾‹ã€‚\n  æ‰¾åˆ°k8s-***-nat-vm-***å‘½åçš„äº‘ä¸»æœºï¼Œå…¶ä¸ºK8Sé›†ç¾¤çš„ç®¡ç†èŠ‚ç‚¹äº‘ä¸»æœºï¼Œ å¯ä»¥å…¬ç½‘SSHè¿œç¨‹ç™»å½•è¿›å»ã€‚\n  è·å–é›†ç¾¤å‡­æ®ï¼Œ é€‰æ‹©äº‘æœåŠ¡-\u0026gt;å¼¹æ€§è®¡ç®—-\u0026gt; Kubernetesé›†ç¾¤, è¿›å…¥é›†ç¾¤åˆ—è¡¨é¡µé¢ã€‚é€‰ä¸­åˆšåˆ›å»ºçš„é›†ç¾¤ä¿¡æ¯ï¼Œç‚¹å‡»åç§°ï¼Œè¿›å…¥è¯¦æƒ…é¡µé¢ã€‚åˆ‡æ¢è‡³kubectlå®¢æˆ·ç«¯é…ç½®é¡µã€‚\n  ç®¡ç†èŠ‚ç‚¹ç™»å½•æˆåŠŸåï¼Œssh ç™»å½•è‡³ k8s-node-*** èŠ‚ç‚¹çš„äº‘ä¸»æœºï¼ˆ**å‘½ä»¤ï¼š ssh root@your_node_ip, éœ€è¦å°† your_node_ip æ›¿æ¢ä¸ºä½ çš„nodeäº‘ä¸»æœºçš„å†…ç½‘ipã€‚ç‚¹å‡»å›è½¦åè¾“å…¥å¯†ç å³å¯** ï¼‰ã€‚\n  é…ç½®kubectlå®¢æˆ·ç«¯\næ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤\n1 2 3 4 5  mkdir -p $HOME/.kube cd $HOME/.kube vi config   å°†kubectlå®¢æˆ·ç«¯é…ç½®çš„å‡­æ®ï¼Œæ‹·è´è‡³configä¸­ï¼Œä¿å­˜åé€€å‡ºã€‚æ‰§è¡Œ sudo chown $(id -u):$(id -g) $HOME/.kube/config å‘½ä»¤ã€‚\n  æ‰§è¡Œä»¥ä¸‹æ“ä½œå‘½åï¼Œæ³¨å†Œé•œåƒä»“åº“ã€‚\nkubectl create secret -n default docker-registry my-secret --docker-server=k8s-monitor-demo01-cn-north-1.jcr.service.jdcloud.com --docker-username=jdcloud --docker-password=Eoj3Ja4mSeXasAbX --docker-email=1427298682@qq.com è¾“å…¥æŒ‡ä»¤å¦‚ä¸‹ï¼š\n  åˆ›å»ºPod\n  åœ¨kubernetesé›†ç¾¤é¡µé¢ï¼Œèœå•åˆ‡æ¢è‡³Workloads-\u0026gt;Podï¼Œè¿›å…¥Podåˆ—è¡¨é¡µé¢ã€‚ç‚¹å‡»åˆ›å»ºpod\n  é…ç½®å¦‚ä¸‹ä¿¡æ¯\na. é›†ç¾¤ï¼šè¯·ç¡®è®¤åˆšåˆ›å»ºçš„é›†ç¾¤ï¼Œä¾‹å¦‚ï¼šmonitor-demo\nb. Yaml æ–‡ä»¶ï¼šå°†å¦‚ä¸‹å†…å®¹æ‹·è´è‡³é»‘è‰²è¾“å…¥æ¡†ï¼Œæ³¨æ„é»„è‰²æ ‡æ³¨å†…å®¹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  apiVersion:v1kind:Podmetadata:name:prometheus-demolabels:app:prometheus-demospec:imagePullSecrets:- name:my-secretcontainers:- name:flaskapp-demoimage:k8s-monitor-demo01-cn-north-1.jcr.service.jdcloud.com/k8s-monitor-demo-repo:job-ANbzZdjyyYKEBRX-1587872493ports:- containerPort:5000- containerPort:7777   æ³¨æ„ï¼š\n  nameï¼šä¸ºæ‚¨æ³¨å†Œé•œåƒä»“åº“åˆ›å»ºçš„secretåç§°ï¼Œç¤ºä¾‹ç”¨çš„my-secretã€‚\n  image æ ‡æ³¨ä¸ºé»„è‰²çš„å†…å®¹åŒ…å«2ä¸ªéƒ¨åˆ†ï¼ŒURI:é•œåƒç‰ˆæœ¬ï¼Œè¯·ä¸€å®šè¦æ›¿æ¢ä¸ºè‡ªå·±é•œåƒä»“åº“çš„å†…å®¹ã€‚å¯é€šè¿‡å¦‚ä¸‹æˆªå›¾ä½ç½®è·å–ã€‚\n     åˆ›å»ºPod  å¯ä»¥çœ‹åˆ°åˆ›å»ºçš„podï¼Œè¿›å…¥podè¯¦æƒ…ï¼Œåˆ‡æ¢è‡³Containerå¯ä»¥æŸ¥çœ‹å…¶è¿è¡ŒçŠ¶æ€ï¼Œç­‰å¾…3åˆ†é’Ÿå·¦å³ï¼Œå…¶çŠ¶æ€å˜ä¸ºè¿è¡Œï¼ŒæœåŠ¡éƒ¨ç½²æˆåŠŸã€‚\n  é…ç½®è®¿é—®ç­–ç•¥ åˆ›å»ºService\n æ³¨ï¼šåŸºäºK8Séƒ¨ç½²çš„åº”ç”¨æœåŠ¡ï¼Œè‹¥éœ€è¦å¤–ç½‘è®¿é—®ï¼Œåˆ™éœ€è¦åˆ›å»ºä¸€ä¸ªè´Ÿè½½å‡è¡¡ï¼ŒåŒæ—¶ç»‘å®šå…¬ç½‘IPï¼Œä»¥ä¸‹æ­¥éª¤å°±æ˜¯é€šè¿‡åˆ›å»ºServiceä¸ºæœåŠ¡é…ç½®ä¸€ä¸ªè´Ÿè½½å‡è¡¡ã€‚\n   åˆ‡æ¢è‡³serviceåˆ—è¡¨é¡µé¢ï¼Œé€‰æ‹©â€œååŒ—-åŒ—äº¬â€ï¼Œç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ã€‚\n  è¿›å…¥åˆ›å»ºServiceé¡µé¢\né…ç½®å¦‚ä¸‹ä¿¡æ¯\na. é›†ç¾¤ï¼šç¡®è®¤é€‰ä¸­çš„é›†ç¾¤ã€‚\nb. Yamlï¼šå°†å¦‚ä¸‹ä¿¡æ¯æ‹·è´è‡³è¾“å…¥æ¡†ä¸­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  kind:ServiceapiVersion:v1metadata:name:prometheus-demoannotations:prometheus.io/path:/metricsprometheus.io/port:\u0026#39;7777\u0026#39;prometheus.io/scrape:\u0026#39;true\u0026#39;spec:ports:- protocol:TCPport:5000targetPort:5000selector:app:prometheus-demotype:LoadBalancer    ç‚¹å‡»â€œç¡®å®šâ€æŒ‰é’®ï¼Œå®Œæˆserviceåˆ›å»ºã€‚ç‚¹å‡»åç§°ï¼Œè¿›å…¥è¯¦æƒ…é¡µé¢ï¼Œå¯æŸ¥çœ‹åˆ°podçŠ¶æ€ä¸ºrunningã€‚\n  ç‚¹å‡»é¡¶éƒ¨å¯¼èˆªäº‘æœåŠ¡-\u0026gt;ç½‘ç»œ-\u0026gt;è´Ÿè½½å‡è¡¡ï¼Œè¿›å…¥åº”ç”¨è´Ÿè½½å‡è¡¡é¡µé¢ã€‚å¯ä»¥çœ‹åˆ°åˆšæ–°å»ºçš„çš„LoadBalancerã€‚\n  è®¿é—®æœåŠ¡\n  åœ¨æ–°å»ºçš„è´Ÿè½½å‡è¡¡æœåŠ¡é¡µé¢ï¼Œè·å–åˆ°å…¬ç½‘IPï¼Œ åœ¨æµè§ˆå™¨ç«¯è¾“å…¥http://å…¬ç½‘IP:5000ï¼Œå¯çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ã€‚\n  ç¬¬ä¸‰æ­¥ï¼šä¸šåŠ¡ç›‘æ§å‘Šè­¦ æŸ¥çœ‹ç›‘æ§å›¾   é€‰æ‹©äº‘æœåŠ¡-\u0026gt;ç›‘æ§ä¸è¿ç»´-\u0026gt; äº‘ç›‘æ§ï¼Œè¿›å…¥äº‘ç›‘æ§æ§åˆ¶å°ã€‚\n  åœ¨å·¦ä¾§èœå•é€‰ä¸­â€œè‡ªå®šä¹‰ç›‘æ§â€ï¼Œè¿›å…¥è‡ªå®šä¹‰ç›‘æ§é¡µé¢ã€‚\n   è¾“å…¥ä»¥ä¸‹æŸ¥è¯¢æ¡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°Demoç¤ºä¾‹å†…ç½®é‡‡é›†çš„ä¸€äº›ä¸šåŠ¡æ•°æ®ã€‚æŸ¥è¯¢æ¡ä»¶å¦‚ä¸‹ï¼š\n  é…ç½®å‘Šè­¦   åœ¨ä¸Šè¿°æŸ¥çœ‹çš„çš„ç›‘æ§å›¾ä¸­ï¼Œç‚¹å‡»â€œé…ç½®æŠ¥è­¦â€æŒ‰é’®ï¼Œè¿›å…¥è®¾ç½®å‘Šè­¦é¡µé¢ï¼Œè¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š\nåŸºæœ¬ä¿¡æ¯é…ç½®\nè§¦å‘æ¡ä»¶é…ç½®\né€šçŸ¥ç­–ç•¥é…ç½®\n  ä¸Šé¢é…ç½®å®Œä¹‹åå½“è®¿é—®é¡µé¢æ¬¡æ•°è¶…è¿‡10æ­¤çš„æ—¶å€™å°±ä¼šæœ‰é‚®ä»¶å’ŒçŸ­ä¿¡çš„é€šçŸ¥\né‚®ä»¶\nçŸ­ä¿¡\n","description":"","id":28,"section":"posts","tags":["äº‘è®¡ç®—","äº¬ä¸œäº‘"],"title":"ä½¿ç”¨äº‘ç›‘æ§ç®¡ç†k8s-äº¬ä¸œäº‘å®è·µ","uri":"https://hugo.jiahongw.com/zh/posts/cloud/cloud-kubernetes/"},{"content":"[toc]\n1. é²²é¹äº‘æœåŠ¡ é²²é¹å¤„ç†å™¨ä¸æœåŠ¡å™¨ é²²é¹å¤„ç†å™¨ åä¸ºé²²é¹å¤„ç†å™¨æ˜¯åä¸ºè‡ªä¸»ç ”å‘çš„åŸºäºARMæ¶æ„çš„ä¼ä¸šçº§ç³»åˆ—å¤„ç†å™¨äº§å“ï¼ŒåŒ…å«â€œç®—ã€å­˜ã€ä¼ ã€ç®¡ã€æ™ºâ€äº”ä¸ªäº§å“ç³»ç»Ÿä½“ç³»ã€‚\næ¶æ„ä»‹ç»ï¼š åä¸ºé²²é¹å¤„ç†å™¨åŸºäºARMæ¶æ„ã€‚ARMæ˜¯ä¸€ç§CPUæ¶æ„ï¼Œæœ‰åˆ«äºIntelã€AMD CPUé‡‡ç”¨çš„CISCå¤æ‚æŒ‡ä»¤é›†ï¼ŒARM CPUé‡‡ç”¨RISCç²¾ç®€æŒ‡ä»¤é›†ï¼ˆreduced instruction set computerï¼Œç²¾ç®€æŒ‡ä»¤é›†è®¡ç®—æœºï¼‰ã€‚\nå¤„ç†å™¨å¯¹æ¯”ï¼š\nä¼˜ç‚¹ï¼š  é‡‡ç”¨ARMæ¶æ„ï¼ŒåŒæ ·åŠŸèƒ½æ€§èƒ½å ç”¨çš„èŠ¯ç‰‡é¢ç§¯å°ã€åŠŸè€—ä½ã€é›†æˆåº¦æ›´é«˜ï¼Œæ›´å¤šçš„ç¡¬ä»¶CPUæ ¸å…·å¤‡æ›´å¥½çš„å¹¶å‘æ€§èƒ½ã€‚ æ”¯æŒ16ä½ã€32ä½ã€64ä½å¤šç§æŒ‡ä»¤é›†ï¼Œèƒ½å¾ˆå¥½çš„å…¼å®¹ä»IOTã€ç»ˆç«¯åˆ°äº‘ç«¯çš„å„ç±»åº”ç”¨åœºæ™¯ã€‚ å¤§é‡ä½¿ç”¨å¯„å­˜å™¨ï¼Œå¤§å¤šæ•°æ•°æ®æ“ä½œéƒ½åœ¨å¯„å­˜å™¨ä¸­å®Œæˆï¼ŒæŒ‡ä»¤æ‰§è¡Œé€Ÿåº¦æ›´å¿«ã€‚ é‡‡ç”¨RISCæŒ‡ä»¤é›†ï¼ŒæŒ‡ä»¤é•¿åº¦å›ºå®šï¼Œå¯»å€æ–¹å¼çµæ´»ç®€å•ï¼Œæ‰§è¡Œæ•ˆç‡é«˜ã€‚  è§„æ ¼å‘å±• åä¸ºé²²é¹920å¤„ç†å™¨è§„æ ¼ æŠ€æœ¯åˆ›æ–° å†…ç½®å¤šç§åŠ é€Ÿå¼•æ“ TaishanæœåŠ¡å™¨ ç³»åˆ— TaiShan 200æœºæ¶æœåŠ¡å™¨å…¨æ™¯å›¾ TaiShan 200é«˜å¯†æœåŠ¡å™¨ äº‘æœåŠ¡ äº‘è®¡ç®— ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ï¼ˆNISTï¼‰å®šä¹‰ï¼š\näº‘è®¡ç®—æ˜¯ä¸€ç§æ¨¡å‹ï¼Œå®ƒå¯ä»¥å®ç°éšæ—¶éšåœ°ï¼Œä¾¿æ·åœ°ï¼Œéšéœ€åº”å˜åœ°ä»å¯é…ç½®è®¡ç®—èµ„æºå…±äº«æ± ä¸­è·å–æ‰€éœ€çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç½‘ç»œã€æœåŠ¡å™¨ã€å­˜å‚¨ã€åº”ç”¨ã€åŠæœåŠ¡ï¼‰ï¼Œèµ„æºèƒ½å¤Ÿå¿«é€Ÿä¾›åº”å¹¶é‡Šæ”¾ï¼Œä½¿ç®¡ç†èµ„æºçš„å·¥ä½œé‡å’Œä¸æœåŠ¡æä¾›å•†çš„äº¤äº’å‡å°åˆ°æœ€ä½é™åº¦ã€‚\näº‘è®¡ç®—çš„ç‰¹ç‚¹:\n å¿«æ·çš„ç½‘ç»œè®¿é—® è‡ªæœåŠ¡å’Œéšéœ€åˆ†é… èµ„æºæ±  çµæ´»æœ‰å¼¹æ€§ æœåŠ¡å¯åº¦é‡  äº‘è®¡ç®—çš„æœ¬è´¨å°±æ˜¯è‡ªåŠ¨åŒ–å’Œè§„æ¨¡åŒ–åœ¨ITè¡Œä¸šçš„æœåŠ¡åŒ–ä½“ç°ï¼  äº‘æœåŠ¡å®ä¾‹ è€Œäº‘æœåŠ¡æ­£æ˜¯ç”±äºäº‘è®¡ç®—çš„å‘å±•è€Œå­•è‚²è€Œç”Ÿ,ä¸»è¦ä¾é äº‘è®¡ç®—çš„è™šæ‹ŸåŒ–æŠ€æœ¯.å°†æ‰€æœ‰çš„ç¡¬ä»¶èµ„æºè¿›è¡Œè®¡ç®—è™šæ‹ŸåŒ–å’Œå­˜å‚¨è™šæ‹ŸåŒ–,æœ€åå¾—åˆ°æˆ‘ä»¬çš„äº‘æœåŠ¡.\nä¸€ä¸ªç®€å•çš„ç½‘ç«™ä¾‹å­å¯ä»¥æ˜¯ä¸‹é¢è¿™å¼ å›¾:\nè®¡ç®—ç±»äº‘æœåŠ¡ è®¡ç®—ç±»äº‘æœåŠ¡æœ‰å¦‚ä¸‹è¿™ä¹ˆå¤šç§:\nECS-(å¼¹æ€§äº‘ä¸»æœº) å¼¹æ€§äº‘æœåŠ¡å™¨ï¼ˆ Elastic Cloud Server ï¼‰æ˜¯ä¸€ç§å¯éšæ—¶è‡ªåŠ©è·å–ã€å¯å¼¹æ€§ä¼¸ç¼©çš„äº‘æœåŠ¡å™¨ï¼Œå¸®åŠ©ç”¨æˆ·æ‰“é€ å¯é ã€å®‰å…¨ã€çµæ´»ã€é«˜æ•ˆçš„åº”ç”¨ç¯å¢ƒï¼Œç¡®ä¿æœåŠ¡æŒä¹…ç¨³å®šè¿è¡Œï¼Œæå‡è¿è¥æ•ˆç‡ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯,ECSä¸€èˆ¬è¦é…åˆç¡¬ç›˜ç³»ç»Ÿç›˜ã€æ•°æ®ç›˜ä»¥åŠVPCç­‰ç»„ä»¶è¿›è¡Œä½¿ç”¨.  å¦‚ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å¤šæ€ECSæœåŠ¡å™¨çš„æ‹“æ‰‘å›¾:\nBMSè£¸é‡‘å±æœåŠ¡å™¨ å¼¹æ€§è£¸é‡‘å±æœåŠ¡å™¨(Bare Metal Server)æœåŠ¡, ä¸ºç”¨æˆ·æä¾›ä¸“å±çš„ç‰©ç†æœåŠ¡å™¨ï¼Œæä¾›å“è¶Šçš„è®¡ç®—æ€§èƒ½ï¼Œæ»¡è¶³æ ¸å¿ƒåº”ç”¨åœºæ™¯å¯¹é«˜æ€§èƒ½åŠç¨³å®šæ€§çš„éœ€æ±‚ï¼Œç»“åˆäº†ä¼ ç»Ÿæ‰˜ç®¡æœåŠ¡å™¨å¸¦æ¥çš„ç¨³å®šæ€§èƒ½ä¸äº‘ä¸­èµ„æºé«˜åº¦å¼¹æ€§çš„ä¼˜åŠ¿ã€‚\nè¿™ä¸ªäº‘æœåŠ¡çš„åº”ç”¨åœºæ™¯ä¸»è¦é’ˆå¯¹éƒ¨ç½²åœ¨ç‰©ç†æœºä¸Šçš„åœºæ™¯.\nè§„æ ¼å’Œåœºæ™¯ï¼š\n è‡ªå¸¦SDIå¡ï¼Œå®ç°æ— ç³»ç»Ÿç›˜æŒ‚è½½çš„æŠ€æœ¯ã€‚\n IMSé•œåƒæœåŠ¡ é•œåƒæ˜¯ç”±åŸºç¡€æ“ä½œç³»ç»Ÿã€é¢„è£…çš„å…¬å…±åº”ç”¨ä»¥åŠç”¨æˆ·ç§æœ‰åº”ç”¨ç»„æˆçš„æ¨¡æ¿ï¼Œä¾¿äºç”¨æˆ·æ‰¹é‡å‘æ”¾å¼¹æ€§äº‘ä¸»æœºæˆ–è£¸é‡‘å±æœåŠ¡å™¨ã€‚\næœ‰äº†é•œåƒä¹‹å,å°±ç›¸å½“äºæœ‰äº†ä¸€ä¸ªå½“å‰ç³»ç»Ÿçš„å¤‡ä»½,å¯ä»¥å¤åˆ¶åˆ°å…¶ä»–äº‘æœåŠ¡å™¨ä¸Š,å‡å°‘é…ç½®çš„æ—¶è€—.  é•œåƒæœåŠ¡æä¾›é•œåƒç”Ÿå‘½å‘¨æœŸç®¡ç†èƒ½åŠ›ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æœåŠ¡å™¨æˆ–å¤–éƒ¨æ–‡ä»¶åˆ›å»ºç³»ç»Ÿç›˜é•œåƒæˆ–æ•°æ®ç›˜é•œåƒï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¼¹æ€§äº‘æœåŠ¡å™¨æˆ–äº‘æœåŠ¡å™¨å¤‡ä»½åˆ›å»ºå¸¦æ•°æ®ç›˜çš„æ•´æœºé•œåƒã€‚å¹¶å¯¹é•œåƒè¿›è¡Œä¿®æ”¹ï¼Œå…±äº«ï¼ŒåŠ å¯†ï¼Œå¤åˆ¶ï¼Œå¯¼å‡ºï¼Œæ ‡ç­¾ç®¡ç†ï¼Œä¼ä¸šå¤šé¡¹ç›®ç®¡ç†ï¼Œå‘å¸ƒå¸‚åœºé•œåƒç­‰æ“ä½œã€‚\nASå¼¹æ€§ä¼¸ç¼©æœåŠ¡ å¼¹æ€§ä¼¸ç¼©ï¼ˆAuto Scalingï¼‰å¯æ ¹æ®ç”¨æˆ·çš„ä¸šåŠ¡éœ€æ±‚å’Œé¢„è®¾ç­–ç•¥ï¼Œè‡ªåŠ¨è°ƒæ•´è®¡ç®—èµ„æºæˆ–å¼¹æ€§IPèµ„æºï¼Œä½¿äº‘æœåŠ¡å™¨æ•°é‡æˆ–å¼¹æ€§IPå¸¦å®½è‡ªåŠ¨éšä¸šåŠ¡è´Ÿè½½å¢é•¿è€Œå¢åŠ ï¼Œéšä¸šåŠ¡è´Ÿè½½é™ä½è€Œå‡å°‘ï¼ŒèŠ‚çœäº‘ä¸Šä¸šåŠ¡èµ„è´¹ï¼Œä¿è¯ä¸šåŠ¡å¹³ç¨³å¥åº·è¿è¡Œ.\nåº”ç”¨åœºæ™¯ä¸»è¦æœ‰:\n ä¼ä¸šç½‘ç«™ã€ç”µå•†ã€ç§»åŠ¨åº”ç”¨ç­‰ï¼Œä¸šåŠ¡ç‰¹ç‚¹ï¼šä¸šåŠ¡è¯·æ±‚æœ‰çªå‘å¼æš´å¢æˆ–è€…è®¿é—®é‡èµ·ä¼ä¸å®š è§†é¢‘ç½‘ç«™ã€åª’ä½“ç¼–è§£ç åº”ç”¨ã€åª’ä½“å†…å®¹å›ä¼ åº”ç”¨ã€é«˜æµé‡å†…å®¹ç®¡ç†ç³»ç»Ÿã€åˆ†å¸ƒå¼é«˜é€Ÿç¼“å­˜ç³»ç»Ÿ,ä¸šåŠ¡ç‰¹ç‚¹:éœ€è¦æ ¹æ®è®¡ç®—é‡åŠ¨æ€è°ƒæ•´è®¡ç®—ã€ç½‘ç»œç­‰èµ„æº  ASæœåŠ¡ä¸€èˆ¬é…åˆè´Ÿè½½å‡è¡¡(ELB)ä¸€èµ·ä½¿ç”¨,ä¾‹å¦‚:\n ASç³»ç»Ÿæ¶æ„å¦‚ä¸‹:\näº‘å®¹å™¨æœåŠ¡ CCE(äº‘å®¹å™¨å¼•æ“)\näº‘å®¹å™¨å¼•æ“ï¼ˆCloud Container Engineï¼Œç®€ç§°CCEï¼‰æä¾›é«˜åº¦å¯æ‰©å±•çš„ã€é«˜æ€§èƒ½çš„ä¼ä¸šçº§Kubernetesé›†ç¾¤ï¼Œæ”¯æŒè¿è¡ŒDockerå®¹å™¨ã€‚å€ŸåŠ©äº‘å®¹å™¨å¼•æ“ï¼Œæ‚¨å¯ä»¥åœ¨äº‘ä¸Šè½»æ¾éƒ¨ç½²ã€ç®¡ç†å’Œæ‰©å±•å®¹å™¨åŒ–åº”ç”¨ç¨‹åºã€‚\nå®ç”¨å®ä¾‹ï¼š\nä¼˜ç‚¹ï¼š\n å¤šå¹³å°æ··åˆéƒ¨ç½² è·¨äº‘ç®¡ç† ä¸€é”®å¼äº¤ä»˜ é«˜æ€§èƒ½  CCI(äº‘å®¹å™¨å®ä¾‹)\näº‘å®¹å™¨å®ä¾‹ï¼ˆCloud Container Instanceï¼Œ CCIï¼‰æœåŠ¡æä¾› Serverless Containerï¼ˆæ— æœåŠ¡å™¨å®¹å™¨ï¼‰å¼•æ“ï¼Œè®©æ‚¨æ— éœ€åˆ›å»ºå’Œç®¡ç†æœåŠ¡å™¨é›†ç¾¤å³å¯ç›´æ¥è¿è¡Œå®¹å™¨ã€‚\nä½¿ç”¨äº‘å®¹å™¨å®ä¾‹\nä¼˜ç‚¹\n å…è¿ç»´ é«˜å®‰å…¨ æè‡´æ€§èƒ½ ç§’çº§ä»˜è´¹ å¼€æ”¾ç”Ÿæ€ æé€Ÿå¼¹æ€§  äº‘å®¹å™¨ç‰¹æ€§\næœåŠ¡æ€»è§ˆ\nå­˜å‚¨ç±»äº‘æœåŠ¡ å­˜å‚¨ç±»äº‘æœåŠ¡ä¸»è¦åˆ†ä¸ºå¦‚ä¸‹ä¸‰ç§:\näº‘ç¡¬ç›˜EVS äº‘ç¡¬ç›˜ï¼ˆElastic Volume Serviceï¼‰æ˜¯ä¸€ç§ä¸ºECSã€BMSç­‰è®¡ç®—æœåŠ¡æä¾›æŒä¹…æ€§å—å­˜å‚¨çš„æœåŠ¡ï¼Œé€šè¿‡æ•°æ®å†—ä½™å’Œç¼“å­˜åŠ é€Ÿç­‰å¤šé¡¹æŠ€æœ¯ï¼Œæä¾›é«˜å¯ç”¨æ€§å’ŒæŒä¹…æ€§ï¼Œä»¥åŠç¨³å®šçš„ä½æ—¶å»¶æ€§èƒ½ã€‚æ‚¨å¯ä»¥å¯¹äº‘ç¡¬ç›˜åšæ ¼å¼åŒ–ã€åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿç­‰æ“ä½œï¼Œå¹¶å¯¹æ•°æ®åšæŒä¹…åŒ–å­˜å‚¨ã€‚äº‘ç¡¬ç›˜æä¾›å¤šç§æ€§èƒ½è§„æ ¼ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®ä¸åŒä¸šåŠ¡åœºæ™¯æŒ‰éœ€ã€çµæ´»é…ç½®ã€‚\nä½¿ç”¨å›¾è§£:\nç›¸å½“äºåœ¨äº‘ä¸Šçš„ç¡¬ç›˜.\nå¯¹è±¡å­˜å‚¨æœåŠ¡OBS å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆOBSï¼‰æ˜¯ä¸€ä¸ªåŸºäºå¯¹è±¡çš„æµ·é‡å­˜å‚¨æœåŠ¡ï¼Œä¸ºæ‚¨æä¾›æµ·é‡ã€ä½æˆæœ¬ã€é«˜å¯é ã€å®‰å…¨çš„æ•°æ®å­˜å‚¨èƒ½åŠ›ã€‚\nå›¾è§£å¦‚ä¸‹:\nå¼¹æ€§æ–‡ä»¶æœåŠ¡SFSå’ŒSFS å¼¹æ€§æ–‡ä»¶æœåŠ¡ï¼ˆScalable File Serviceï¼‰ä¸ºç”¨æˆ·çš„å¼¹æ€§äº‘æœåŠ¡å™¨ï¼ˆECSï¼‰æä¾›ä¸€ä¸ªå®Œå…¨æ‰˜ç®¡çš„å…±äº«æ–‡ä»¶å­˜å‚¨ï¼Œç¬¦åˆæ ‡å‡†æ–‡ä»¶åè®®ï¼ˆNFSï¼‰ï¼Œèƒ½å¤Ÿå¼¹æ€§ä¼¸ç¼©è‡³PBè§„æ¨¡ï¼ˆSFS Turboæœ€å¤§320TBï¼‰ï¼Œå…·å¤‡å¯æ‰©å±•çš„æ€§èƒ½ï¼Œä¸ºæµ·é‡æ•°æ®ã€é«˜å¸¦å®½å‹åº”ç”¨æä¾›æœ‰åŠ›æ”¯æŒã€‚\näº‘å¤‡ä»½æœåŠ¡ æœ€ç®€å•çš„å¤‡ä»½æœåŠ¡ï¼Œå¯å°†äº‘æœåŠ¡å™¨æ•°æ®æ¢å¤åˆ°ä»»æ„å¤‡ä»½ç‚¹,ä¾‹å¦‚:\nSDRS å­˜å‚¨å®¹ç¾æœåŠ¡ å­˜å‚¨å®¹ç¾æœåŠ¡ï¼ˆStorage Disaster Recovery Serviceï¼Œç®€ç§°SDRSï¼‰æ˜¯ä¸€ç§æœåŠ¡åŒ–å®¹ç¾æ–¹æ¡ˆï¼Œå¯å¤§å¹…é™ä½ä¼ä¸šå®¹ç¾TCOã€‚é€šè¿‡ç®€å•ä¸‰æ­¥æ“ä½œï¼ˆåˆ›å»ºä¿æŠ¤ç»„ã€åˆ›å»ºä¿æŠ¤å®ä¾‹ã€å¼€å¯ä¿æŠ¤ï¼‰å³å¯ä¸ºäº‘ä¸Šè™šæ‹Ÿæœºæä¾›è·¨å¯ç”¨åŒºçº§åˆ«çš„å®¹ç¾ä¿æŠ¤ï¼Œç¡®ä¿æ•°æ®é›¶ä¸¢å¤±ï¼ˆRPO=0ï¼‰ï¼Œå¹¶å¯åœ¨ç¾éš¾å‘ç”Ÿæ—¶è¿…é€Ÿæ¢å¤ä¸šåŠ¡ï¼Œå‡å°‘æŸå¤±ã€‚\nç®€å•ä¾‹å­:\nç½‘ç»œç±»äº‘æœåŠ¡ ä¸»è¦æœ‰å¦‚ä¸‹å‡ ç§:\nVPCè™šæ‹Ÿç§æœ‰äº‘æœåŠ¡ è™šæ‹Ÿç§æœ‰äº‘ï¼ˆVirtual Private Cloud): ç”¨æˆ·åœ¨åä¸ºäº‘ä¸Šç”³è¯·çš„éš”ç¦»çš„ã€ç§å¯†çš„è™šæ‹Ÿç½‘ç»œç¯å¢ƒã€‚ç”¨æˆ·å¯ä»¥è‡ªç”±é…ç½®VPCå†…çš„IPåœ°å€æ®µã€å­ç½‘ã€å®‰å…¨ç»„ç­‰å­æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ç”³è¯·å¼¹æ€§å…¬ç½‘IPå’Œå¸¦å®½æ­å»ºé¢å‘Internetçš„ä¸šåŠ¡ç³»ç»Ÿã€‚\nä¸»è¦åŒ…æ‹¬å¦‚ä¸‹å››ä¸ªæ–¹å‘å†…å®¹:\nå¼¹æ€§å…¬ç½‘IP å¼¹æ€§å…¬ç½‘IPï¼ˆElastic IPï¼‰æä¾›ç‹¬ç«‹çš„å…¬ç½‘IPèµ„æºï¼ŒåŒ…æ‹¬å…¬ç½‘IPåœ°å€ä¸å…¬ç½‘å‡ºå£å¸¦å®½æœåŠ¡ã€‚å¯ä»¥ä¸å¼¹æ€§äº‘æœåŠ¡å™¨ã€è£¸é‡‘å±æœåŠ¡å™¨ã€è™šæ‹ŸIPã€å¼¹æ€§è´Ÿè½½å‡è¡¡ã€NATç½‘å…³ç­‰èµ„æºçµæ´»åœ°ç»‘å®šåŠè§£ç»‘ã€‚\n ç®€å•æ¥è¯´,å°±æ˜¯å¤–ç•Œå¯ä»¥è®¿é—®çš„ipåœ°å€.å¹¶ä¸”æ˜¯å…¶ä»–åŠŸèƒ½çš„ä¾èµ–.\n ä½¿ç”¨æ¨¡å‹ï¼š\nNATç½‘å…³æœåŠ¡ NATç½‘å…³ï¼ˆNAT Gatewayï¼‰èƒ½å¤Ÿä¸ºVPCå†…çš„å¼¹æ€§äº‘æœåŠ¡å™¨æä¾›SNATå’ŒDNATåŠŸèƒ½ï¼Œé€šè¿‡çµæ´»ç®€æ˜“çš„é…ç½®ï¼Œå³å¯è½»æ¾æ„å»ºVPCçš„å…¬ç½‘å‡ºå…¥å£\n SNATå’ŒDNATåˆ†åˆ«ä¸ºæºåœ°å€è½¬æ¢å’Œç›®çš„åœ°å€è½¬æ¢ã€‚\nSNATæ¶æ„ï¼š\nDNATæ¶æ„ï¼š\n ä½¿ç”¨NATè¿™ä¸ªåŠŸèƒ½ä¸»è¦æ˜¯ä¸ºäº†èŠ‚çœå¼¹æ€§å…¬ç½‘IPèµ„æºå¹¶ä¸”é¿å…äº‘ä¸»æœºIPç›´æ¥æš´éœ²åœ¨å…¬ç½‘ä¸Šã€‚\nè™šæ‹Ÿä¸“ç”¨ç½‘ç»œ VPN è™šæ‹Ÿä¸“ç”¨ç½‘ç»œï¼ˆVirtual Private Networkï¼‰ç”¨äºæ­å»ºç”¨æˆ·æœ¬åœ°æ•°æ®ä¸­å¿ƒä¸åä¸ºäº‘VPCä¹‹é—´ä¾¿æ·ã€çµæ´»ï¼Œå³å¼€å³ç”¨çš„IPsecåŠ å¯†è¿æ¥é€šé“ï¼Œå®ç°çµæ´»ä¸€ä½“ï¼Œå¯ä¼¸ç¼©çš„æ··åˆäº‘è®¡ç®—ç¯å¢ƒ\n ä¸»è¦é¢å‘çš„æ˜¯ä¼ä¸šç”¨æˆ·ã€‚\n æ»¡è¶³éœ€æ±‚ï¼š\n æ··åˆäº‘éƒ¨ç½² è·¨åœ°åŸŸVPC äº’è”  äº‘ä¸“çº¿ DC äº‘ä¸“çº¿ï¼ˆDirect Connectï¼‰ç”¨äºæ­å»ºç”¨æˆ·æœ¬åœ°æ•°æ®ä¸­å¿ƒä¸åä¸ºäº‘VPCä¹‹é—´é«˜é€Ÿã€ä½æ—¶å»¶ã€ç¨³å®šå®‰å…¨çš„ä¸“å±è¿æ¥é€šé“ï¼Œå……åˆ†åˆ©ç”¨åä¸ºäº‘æœåŠ¡ä¼˜åŠ¿çš„åŒæ—¶ï¼Œç»§ç»­ä½¿ç”¨ç°æœ‰çš„ITè®¾æ–½ï¼Œå®ç°çµæ´»ä¸€ä½“ï¼Œå¯ä¼¸ç¼©çš„æ··åˆäº‘è®¡ç®—ç¯å¢ƒ\nåº”ç”¨åœºæ™¯ï¼š\n æ··åˆäº‘éƒ¨ç½² å¼‚åœ°å®¹ç¾  å¼¹æ€§è´Ÿè½½å‡è¡¡æœåŠ¡ELB å¼¹æ€§è´Ÿè½½å‡è¡¡ï¼ˆElastic Load Balanceï¼Œç®€ç§°ELBï¼‰æ˜¯å°†è®¿é—®æµé‡æ ¹æ®è½¬å‘ç­–ç•¥åˆ†å‘åˆ°åç«¯å¤šå°å¼¹æ€§äº‘æœåŠ¡å™¨çš„æµé‡åˆ†å‘æ§åˆ¶æœåŠ¡ã€‚å¼¹æ€§è´Ÿè½½å‡è¡¡å¯ä»¥é€šè¿‡æµé‡åˆ†å‘æ‰©å±•åº”ç”¨ç³»ç»Ÿå¯¹å¤–çš„æœåŠ¡èƒ½åŠ›ï¼Œæé«˜åº”ç”¨ç¨‹åºçš„å®¹é”™èƒ½åŠ›ã€‚\nç®€å•æ¥è¯´ï¼ŒELBå°±æ˜¯ç”¨æ¥å¤„ç†å¤šç”¨æˆ·è¿æ¥æ—¶å€™çš„èµ„æºç¼ºä¹çš„ï¼Œä¸´æ—¶åˆ¶é€ å¤šä¸ªå‰¯æœ¬æ¥ç¼“è§£å‹åŠ›ã€‚åº”ç”¨åœºæ™¯æœ‰ï¼šå¤§å‹é—¨æˆ·ç½‘ç«™ã€è·¨å¯ç”¨åŒºåŒåŸå®¹ç¾ã€ç”µå•†æŠ¢è´­ã€‚\nPPT  2. é²²é¹åº”ç”¨ç§»æ¤ ä¸¤ç§è¯­è¨€ 1. ç¼–è¯‘å‹è¯­è¨€ 2. è§£é‡Šå‹è¯­è¨€ ç­–ç•¥ è¿ç§»è¿‡ç¨‹ è¿ç§»å·¥å…· åä¸ºé²²é¹ä»£ç è¿ç§»å·¥å…·ä¸»è¦é¢å‘é²²é¹å¹³å°çš„å¼€å‘è€…ã€ç”¨æˆ·å’Œç¬¬ä¸‰æ–¹å¾…ç§»æ¤è½¯ä»¶æä¾›æ–¹å¼€å‘å·¥ç¨‹å¸ˆï¼Œç”¨æ¥åˆ†æå¾…ç§»æ¤è½¯ä»¶æºç æ–‡ä»¶ï¼Œå¹¶ç»™å‡ºä»£ç ç§»æ¤æŒ‡å¯¼æŠ¥å‘Šï¼ŒåŒæ—¶èƒ½å¤Ÿè‡ªåŠ¨åˆ†æå‡ºéœ€ä¿®æ”¹çš„ä»£ç å†…å®¹ï¼Œå¹¶æŒ‡å¯¼å¦‚ä½•ä¿®æ”¹ï¼Œå¸®åŠ©ç”¨æˆ·é¡ºåˆ©å®Œæˆåº”ç”¨ä»x86å¹³å°å‘é²²é¹å¹³å°çš„ç§»æ¤ã€‚\né€»è¾‘æ¶æ„ å®¹å™¨è¿ç§» å®¹å™¨æ˜¯ä¸€ç§è½»é‡çº§ã€å¯ç§»æ¤ã€è‡ªåŒ…å«çš„è½¯ä»¶æ‰“åŒ…æŠ€æœ¯ï¼Œä½¿åº”ç”¨ç¨‹åºå¯ä»¥åœ¨å‡ ä¹ä»»ä½•åœ°æ–¹ä»¥ç›¸åŒçš„æ–¹å¼è¿è¡Œã€‚å¼€å‘äººå‘˜åœ¨è‡ªå·±ç¬”è®°æœ¬ä¸Šåˆ›å»ºå¹¶æµ‹è¯•å¥½çš„å®¹å™¨ï¼Œæ— éœ€ä»»ä½•ä¿®æ”¹å°±èƒ½å¤Ÿåœ¨ç”Ÿäº§ç³»ç»Ÿçš„è™šæ‹Ÿæœºã€ç‰©ç†æœåŠ¡å™¨æˆ–å…¬æœ‰äº‘ä¸»æœºä¸Šè¿è¡Œã€‚\nå®¹å™¨ä¸è™šæ‹Ÿæœºçš„ä¸åŒ å‰æ è·¨å¹³å°çš„å®¹å™¨æ— æ³•è¿è¡Œï¼Œä¼šå‡ºç°æ ¼å¼é”™è¯¯\n x86å¹³å°è·å–çš„é•œåƒæ˜¯é€‚ç”¨äºx86å¹³å°ï¼Œå½“è¿ç§»åˆ°é²²é¹å¹³å°ï¼Œå®¹å™¨æ— æ³•æ‰§è¡Œã€‚ åœ¨åŸºäºARMçš„å¹³å°ä¸­ï¼Œdocker pullæ–¹å¼æˆ–è€…Dockerfileæ–¹å¼è·å–æˆ–è€…æ„å»ºçš„é•œåƒå‡ä¸ºåŸºäºARMå¹³å°çš„ï¼ŒåŒæ ·ä¹Ÿæ— æ³•åœ¨x86ä¸Šè¿è¡Œã€‚  å®¹å™¨è¿ç§»çš„åŸç† è¿ç§»å®¹å™¨åŒæ—¶æ¶‰åŠåˆ°ä¸¤ä¸ªæ“ä½œï¼Œå¤‡ä»½å’Œæ¢å¤ã€‚æˆ‘ä»¬å¯ä»¥å°†ä»»ä½•ä¸€ä¸ªDockerå®¹å™¨ä»ä¸€å°æœºå™¨è¿ç§»åˆ°å¦ä¸€å°æœºå™¨ã€‚åœ¨è¿ç§»è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆæˆ‘ä»¬å°†æŠŠå®¹å™¨å¤‡ä»½ä¸ºDockeré•œåƒå¿«ç…§ã€‚ç„¶åï¼Œè¯¥Dockeré•œåƒæˆ–è€…æ˜¯è¢«æ¨é€åˆ°äº†Dockeræ³¨å†Œä¸­å¿ƒï¼Œæˆ–è€…è¢«ä½œä¸ºtaråŒ…æ–‡ä»¶ä¿å­˜åˆ°äº†æœ¬åœ°ã€‚å¦‚æœæˆ‘ä»¬å°†é•œåƒæ¨é€åˆ°äº†Dockeræ³¨å†Œä¸­å¿ƒï¼Œæˆ‘ä»¬ç®€å•åœ°ä»ä»»ä½•æˆ‘ä»¬æƒ³è¦çš„æœºå™¨ä¸Šä½¿ç”¨ docker run å‘½ä»¤æ¥æ¢å¤å¹¶è¿è¡Œè¯¥å®¹å™¨ï¼Œæˆ–è€…é€šè¿‡docker pullå‘½ä»¤æ‹‰å–æˆ‘ä»¬æƒ³è¦çš„é•œåƒã€‚\nè¿ç§»ç­–ç•¥ Dockerå®¹å™¨è¿ç§»æœ‰ä¸¤ç§ç­–ç•¥ï¼šä½¿ç”¨Docker pullè·å–é•œåƒæˆ–ä½¿ç”¨Dockerfileæ„å»ºé•œåƒã€‚\nä¸»è¦æµç¨‹  Dockerå®‰è£… Dockeræ„å»ºåŸºç¡€é•œåƒ Dockerfileåˆ›å»ºåº”ç”¨é•œåƒ éªŒè¯åº”ç”¨é•œåƒ  æ€§èƒ½è°ƒä¼˜ æ€§èƒ½è°ƒä¼˜å°±æ˜¯å¯¹è®¡ç®—æœºç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºæœ‰ç›¸å½“æ·±å…¥çš„äº†è§£ï¼Œè°ƒèŠ‚ä¸‰è€…ä¹‹é—´çš„å…³ç³»ï¼Œå®ç°æ•´ä¸ªç³»ç»Ÿï¼ˆåŒ…æ‹¬ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿã€åº”ç”¨ç¨‹åºï¼‰çš„æ€§èƒ½æœ€å¤§åŒ–ï¼Œå¹¶èƒ½ä¸æ–­åœ°æ»¡è¶³ç°æœ‰çš„ä¸šåŠ¡éœ€æ±‚ã€‚\nåä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…· ä¸ºè§£å†³å®¢æˆ·è½¯ä»¶è¿è¡Œé‡åˆ°æ€§èƒ½é—®é¢˜æ—¶å‡­äººå·¥ç»éªŒå®šä½å›°éš¾ã€è°ƒä¼˜èƒ½åŠ›å¼±çš„ç—›ç‚¹ï¼Œåä¸ºæ¨å‡ºäº†Kunpeng Tuning Kité²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·ã€‚\nåä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·ä¸»è¦é¢å‘åä¸ºFAEã€å¼€æ”¾å®éªŒå®¤èƒ½åŠ›å»ºè®¾å·¥ç¨‹å¸ˆæˆ–å®¢æˆ·å·¥ç¨‹å¸ˆï¼Œé’ˆå¯¹åº”ç”¨ç¨‹åºéƒ¨ç½²åœ¨TaiShanæœåŠ¡å™¨çš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡æ”¶é›†æœåŠ¡å™¨çš„å¤„ç†å™¨ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿã€è¿›ç¨‹/çº¿ç¨‹ã€å‡½æ•°ç­‰å„å±‚æ¬¡çš„æ€§èƒ½æ•°æ®ï¼Œåˆ†æå‡ºç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡ï¼Œå®šä½åˆ°ç“¶é¢ˆç‚¹åŠçƒ­ç‚¹å‡½æ•°ã€‚\nåä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·åŠŸèƒ½ç‰¹æ€§  æ”¯æŒé‡‡é›†æ•´ä¸ªç³»ç»Ÿæˆ–æŒ‡å®šè¿›ç¨‹çš„CPU Cyclesæ€§èƒ½äº‹ä»¶ï¼Œèƒ½å¤Ÿå¿«é€Ÿå®šä½çƒ­ç‚¹å‡½æ•°ã€‚ æ”¯æŒçƒ­ç‚¹å‡½æ•°æŒ‰ç…§CPUæ ¸/çº¿ç¨‹/æ¨¡å—è¿›è¡Œåˆ†ç»„ï¼Œæ”¯æŒæŸ¥çœ‹çƒ­ç‚¹å‡½æ•°è°ƒç”¨æ ˆã€‚ æ”¯æŒé€šè¿‡ç«ç„°å›¾æŸ¥çœ‹çƒ­ç‚¹å‡½æ•°åŠå…¶è°ƒç”¨æ ˆã€‚ æ”¯æŒä»£ç æ˜ å°„åŠŸèƒ½ï¼Œå³æŸ¥çœ‹å‡½æ•°å†…çš„çƒ­ç‚¹æŒ‡ä»¤åŠè¯¥æŒ‡ä»¤å¯¹åº”çš„é«˜çº§è¯­è¨€æ–‡ä»¶åŠè¡Œå·ã€‚ æ”¯æŒæ˜¾ç¤ºæ±‡ç¼–ä»£ç çš„æ§åˆ¶æµå›¾ã€‚ æ”¯æŒåˆ†æJavaä»£ç çš„çƒ­ç‚¹å‡½æ•°åŠçƒ­ç‚¹æŒ‡ä»¤ã€‚  åä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·é€»è¾‘æ¶æ„ ä¸»è¦åˆ†ä¸ºAnalysiså’ŒAgentä¸¤ä¸ªæ¨¡å—ã€‚\nå­æ¨¡å— Analysiså­æ¨¡å—\nAgentå­æ¨¡å—\néƒ¨ç½²æ–¹å¼ å½“å‰ç‰ˆæœ¬åªæ”¯æŒå•æœºéƒ¨ç½²ï¼Œå³å°†åä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·æ‰€æœ‰ç»„ä»¶éƒ¨ç½²åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå®Œæˆå¯¹è¯¥å°æœåŠ¡å™¨è½¯ä»¶çš„æ€§èƒ½æ•°æ®é‡‡é›†å’Œåˆ†æã€‚\nå¦‚ä»¥ä¸‹ç¤ºä¾‹å›¾ï¼š\n éƒ¨ç½²ç¯å¢ƒè¦æ±‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š\n éƒ¨ç½²åè®¿é—®æ–¹å¼  åä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·éƒ¨ç½²åœ¨TaiShanæœåŠ¡å™¨ä¸Šï¼Œè¯¥æœåŠ¡å™¨ä¸ŠåŒæ—¶è¿è¡Œå®¢æˆ·çš„åº”ç”¨è½¯ä»¶ã€‚ åä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·æä¾›Webç•Œé¢è®¿é—®æ–¹å¼ï¼Œç”¨æˆ·åªéœ€è¦åœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥ï¼šhttps:// éƒ¨ç½²æœåŠ¡å™¨çš„IP:ç«¯å£å· å³å¯ã€‚  è®¿é—®Webç•Œé¢æ—¶ï¼Œå¯¹æœ¬åœ°æµè§ˆå™¨çš„è¦æ±‚å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚\nä¼˜åŒ–å·¥å…·ä¸šåŠ¡æµç¨‹ C/C++ç¨‹åºæ€§èƒ½åˆ†æå’Œä¼˜åŒ– Java Mixed-Modeç¨‹åºæ€§èƒ½åˆ†æå’Œä¼˜åŒ– 3. å®¹ç¾å¤‡ä»½å®‰å…¨ äº‘æ¶æ„ åŸºç¡€æ¶æ„ï¼š\nå®‰å…¨æ¶æ„ï¼š\nä¼ä¸šä¸»æœºå®‰å…¨ï¼ˆHSSï¼‰ ä¼ä¸šä¸»æœºå®‰å…¨ï¼ˆHost Security Serviceï¼‰æ˜¯æå‡ä¸»æœºæ•´ä½“å®‰å…¨æ€§çš„æœåŠ¡ï¼ŒåŒ…æ‹¬è´¦æˆ·ç ´è§£é˜²æŠ¤ã€å¼±å£ä»¤æ£€æµ‹ã€æ¶æ„ç¨‹åºæ£€æµ‹ã€åŒå› å­è®¤è¯ã€æ¼æ´ç®¡ç†ï¼Œç½‘é¡µé˜²ç¯¡æ”¹ç­‰åŠŸèƒ½ï¼Œå¸®åŠ©ä¼ä¸šæ„å»ºæœåŠ¡å™¨å®‰å…¨é˜²æŠ¤ä½“ç³»ï¼Œé™ä½å½“å‰æœåŠ¡å™¨é¢ä¸´çš„ä¸»è¦å®‰å…¨é£é™©\nWAFï¼šæœ€å¸¸ç”¨æœ€æœ‰æ•ˆçš„é˜²æŠ¤æ–¹æ¡ˆ Webåº”ç”¨é˜²ç«å¢™ï¼ˆWeb Application Firewallï¼‰å¯¹ç½‘ç«™ä¸šåŠ¡æµé‡è¿›è¡Œå¤šç»´åº¦æ£€æµ‹å’Œé˜²æŠ¤ï¼Œç»“åˆæ·±åº¦æœºå™¨å­¦ä¹ æ™ºèƒ½è¯†åˆ«æ¶æ„è¯·æ±‚ç‰¹å¾å’Œé˜²å¾¡æœªçŸ¥å¨èƒï¼Œé˜»æŒ¡è¯¸å¦‚SQLæ³¨å…¥æˆ–è·¨ç«™è„šæœ¬ç­‰å¸¸è§æ”»å‡»ï¼Œé¿å…è¿™äº›æ”»å‡»å½±å“Webåº”ç”¨ç¨‹åºçš„å¯ç”¨æ€§ã€å®‰å…¨æ€§æˆ–è¿‡åº¦æ¶ˆè€—èµ„æºï¼Œé™ä½æ•°æ®è¢«ç¯¡æ”¹ã€å¤±çªƒçš„é£é™©\nDBSS-æ•°æ®åº“å®‰å…¨æœåŠ¡ æ•°æ®åº“å®‰å…¨æœåŠ¡ï¼ˆDatabase Security Serviceï¼‰æ˜¯ä¸€ä¸ªæ™ºèƒ½çš„æ•°æ®åº“å®‰å…¨é˜²æŠ¤æœåŠ¡ï¼ŒåŸºäºåå‘ä»£ç†åŠæœºå™¨å­¦ä¹ æœºåˆ¶ï¼Œæä¾›æ•æ„Ÿæ•°æ®å‘ç°ã€æ•°æ®è„±æ•ã€æ•°æ®åº“å®¡è®¡å’Œé˜²æ³¨å…¥æ”»å‡»ç­‰åŠŸèƒ½ï¼Œä¿éšœäº‘ä¸Šæ•°æ®åº“çš„å®‰å…¨\nCBH-äº‘å ¡å’æœºï¼šäº‘è¿ç»´å®¡è®¡çš„ç‘å£«å†›åˆ€ äº‘å ¡å’æœºï¼ˆCloud Bastion Hostï¼‰å¼€ç®±å³ç”¨ï¼ŒåŒ…å«ä¸»æœºç®¡ç†ã€æƒé™æ§åˆ¶ã€è¿ç»´å®¡è®¡ã€å®‰å…¨åˆè§„ç­‰åŠŸèƒ½ï¼Œæ”¯æŒChromeç­‰ä¸»æµæµè§ˆå™¨éšæ—¶éšåœ°è¿œç¨‹è¿ç»´ï¼Œå¼€å¯é«˜æ•ˆè¿ç»´æ–°æ—¶ä»£ã€‚\næ¡ˆä¾‹ å®¹ç¾å¤‡ä»½ ç³»ç»Ÿå¯é æ€§è®¾è®¡ä¹‹é«˜å¯ç”¨ã€åŒæ´»ã€å®¹ç¾ã€å¤‡ä»½ å®¹ç¾æŒ‡æ ‡ RTOï¼š RTO (Recovery Time Objectives)ï¼Œå…³é”®ä¸šåŠ¡åŠŸèƒ½ï¼ˆCBFï¼‰ä»ä¸­æ–­ç‚¹æ¢å¤åˆ°å…¶æœ€ä½ä¸šåŠ¡è¿ç»­ç›®æ ‡ï¼ˆMBCOï¼‰æ‰€èƒ½æ‰¿å—çš„æœ€å¤§æ—¶é—´ï¼Œä»è€Œä½¿ä¸­æ–­å¯¹ä¸šåŠ¡æ‰€å¸¦é¢†çš„å†²å‡»æœ€å°åŒ–ã€‚\nRPOï¼š RPO (Recovery Point Objectives)ï¼Œç¾éš¾æ¢å¤ä¸­çš„æ¢å¤æ—¶é—´ç‚¹ç›®æ ‡ï¼ŒæŒ‡ä¸šåŠ¡å¯æ¥å—çš„ã€ç¾éš¾å‘ç”Ÿåï¼Œç³»ç»Ÿå’Œæ•°æ®ä»ç¾éš¾å‘ç”Ÿæ—¶é—´ç‚¹åˆ°å¯æ¢å¤è‡³ç¾éš¾å‰çš„æ—¶é—´ç‚¹çš„ç›®æ ‡ã€‚\nMBCO MBCOï¼ˆMinimum Business Continuity Objectivesï¼‰ï¼Œåœ¨çªå‘äº‹ä»¶ã€ç´§æ€¥çŠ¶æ€ã€æˆ–ç¾éš¾å‘ç”ŸæœŸé—´ï¼Œä¼ä¸šä¸ºå®Œæˆå…¶ä¸šåŠ¡ç›®æ ‡æ‰€èƒ½æ¥å—çš„æœ€ä½æœåŠ¡åŠç”Ÿäº§æ°´å¹³ã€‚\n  æ ‡å‡† å®¹ç¾æ–¹æ¡ˆ æ··åˆäº‘å®¹ç¾æ•´ä½“æ–¹æ¡ˆ 4. GaussDB 5. å¤§æ•°æ® ç®—å­˜åˆ†ç¦» è§£å†³æ–¹æ¡ˆ 6. è§£å†³æ–¹æ¡ˆ å…¨è§ˆ\nåä¸ºé²²é¹é€šç”¨è§£å†³æ–¹æ¡ˆ åä¸ºé²²é¹è¡Œä¸šè§£å†³æ–¹æ¡ˆ æ€§èƒ½è°ƒä¼˜åˆ†æå·¥å…· Kunpeng Tuning Kité²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·\nåä¸ºé²²é¹æ€§èƒ½ä¼˜åŒ–å·¥å…·ä¸»è¦é¢å‘åä¸ºFAEã€å¼€æ”¾å®éªŒå®¤èƒ½åŠ›å»ºè®¾å·¥ç¨‹å¸ˆæˆ–å®¢æˆ·å·¥ç¨‹å¸ˆï¼Œé’ˆå¯¹åº”ç”¨ç¨‹åºéƒ¨ç½²åœ¨TaiShanæœåŠ¡å™¨çš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡æ”¶é›†æœåŠ¡å™¨çš„å¤„ç†å™¨ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿã€è¿›ç¨‹/çº¿ç¨‹ã€å‡½æ•°ç­‰å„å±‚æ¬¡çš„æ€§èƒ½æ•°æ®ï¼Œåˆ†æå‡ºç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡ï¼Œå®šä½åˆ°ç“¶é¢ˆç‚¹åŠçƒ­ç‚¹å‡½æ•°ã€‚\né«˜æ€§èƒ½è®¡ç®— é¡¹ç›®:ä¸ªäººåŒæ­¥ç½‘ç›˜\n","description":"","id":29,"section":"talks","tags":["äº‘è®¡ç®—"],"title":"é²²é¹LearningğŸ¸","uri":"https://hugo.jiahongw.com/zh/talks/kubpeng_exercise/"},{"content":"C++å­¦ä¹ è·¯çº¿ğŸŒ± hode on!ğŸ’ \n","description":"","id":30,"section":"talks","tags":["C++"],"title":"C++å­¦ä¹ è·¯çº¿","uri":"https://hugo.jiahongw.com/zh/talks/cpp_router/"},{"content":"| ç®¡é“ç¬¦ï¼Œâ€œ|â€ï¼Œè¡¨ç¤ºå°†å‰ä¸€ä¸ªå‘½ä»¤çš„å¤„ç†ç»“æœè¾“å‡ºä¼ é€’ç»™åé¢çš„å‘½ä»¤å¤„ç†ã€‚\ngrep Linuxç³»ç»Ÿä¸­grepå‘½ä»¤æ˜¯ä¸€ç§å¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·ï¼Œå®ƒèƒ½ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢æ–‡æœ¬ï¼Œå¹¶æŠŠåŒ¹ é…çš„è¡Œæ‰“å°å‡ºæ¥ã€‚grepå…¨ç§°æ˜¯Global Regular Expression Printï¼Œè¡¨ç¤ºå…¨å±€æ­£åˆ™è¡¨è¾¾å¼ç‰ˆæœ¬ï¼Œå®ƒçš„ä½¿ç”¨æƒé™æ˜¯æ‰€æœ‰ç”¨æˆ·ã€‚\nè¯­æ³• grep [é€‰é¡¹] æŸ¥æ‰¾å†…å®¹ æºæ–‡ä»¶ é€‰é¡¹å‚æ•°   -a --text #ä¸è¦å¿½ç•¥äºŒè¿›åˆ¶çš„æ•°æ®ã€‚\n  -A\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; --after-context=\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; #é™¤äº†æ˜¾ç¤ºç¬¦åˆèŒƒæœ¬æ ·å¼çš„é‚£ä¸€åˆ—ä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹åçš„å†…å®¹ã€‚\n  -b  --byte-offset  #åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œæ ‡ç¤ºå‡ºè¯¥è¡Œç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç¼–å·ã€‚â­\n  -B\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; --before-context=\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; #é™¤äº†æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹å‰çš„å†…å®¹ã€‚\n  -c --count #è®¡ç®—ç¬¦åˆæ ·å¼çš„åˆ—æ•°ã€‚â­\n  -C\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; --context=\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt;æˆ–-\u0026lt;æ˜¾ç¤ºè¡Œæ•°\u0026gt; #é™¤äº†æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å¤–ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œä¹‹å‰åçš„å†…å®¹ã€‚\n  -d \u0026lt;åŠ¨ä½œ\u0026gt; --directories=\u0026lt;åŠ¨ä½œ\u0026gt; #å½“æŒ‡å®šè¦æŸ¥æ‰¾çš„æ˜¯ç›®å½•è€Œéæ–‡ä»¶æ—¶ï¼Œå¿…é¡»ä½¿ç”¨è¿™é¡¹å‚æ•°ï¼Œå¦åˆ™grepæŒ‡ä»¤å°†å›æŠ¥ä¿¡æ¯å¹¶åœæ­¢åŠ¨ä½œã€‚â­\n  -e\u0026lt;èŒƒæœ¬æ ·å¼\u0026gt; --regexp=\u0026lt;èŒƒæœ¬æ ·å¼\u0026gt; #æŒ‡å®šå­—ç¬¦ä¸²åšä¸ºæŸ¥æ‰¾æ–‡ä»¶å†…å®¹çš„æ ·å¼ã€‚\n  -E --extended-regexp #å°†æ ·å¼ä¸ºå»¶ä¼¸çš„æ™®é€šè¡¨ç¤ºæ³•æ¥ä½¿ç”¨ã€‚\n  -f\u0026lt;è§„åˆ™æ–‡ä»¶\u0026gt; --file=\u0026lt;è§„åˆ™æ–‡ä»¶\u0026gt; #æŒ‡å®šè§„åˆ™æ–‡ä»¶ï¼Œå…¶å†…å®¹å«æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè§„åˆ™æ ·å¼ï¼Œè®©grepæŸ¥æ‰¾ç¬¦åˆè§„åˆ™æ¡ä»¶çš„æ–‡ä»¶å†…å®¹ï¼Œæ ¼å¼ä¸ºæ¯è¡Œä¸€ä¸ªè§„åˆ™æ ·å¼ã€‚\n  -F --fixed-regexp #å°†æ ·å¼è§†ä¸ºå›ºå®šå­—ç¬¦ä¸²çš„åˆ—è¡¨ã€‚\n  -G --basic-regexp #å°†æ ·å¼è§†ä¸ºæ™®é€šçš„è¡¨ç¤ºæ³•æ¥ä½¿ç”¨ã€‚\n  -h --no-filename #åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œä¸æ ‡ç¤ºè¯¥è¡Œæ‰€å±çš„æ–‡ä»¶åç§°ã€‚\n  -H --with-filename  #åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œè¡¨ç¤ºè¯¥è¡Œæ‰€å±çš„æ–‡ä»¶åç§°ã€‚\n  -i --ignore-case  #å¿½ç•¥å­—ç¬¦å¤§å°å†™çš„å·®åˆ«ã€‚â­\n  -l --file-with-matches #åˆ—å‡ºæ–‡ä»¶å†…å®¹ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§°ã€‚\n  -L --files-without-match #åˆ—å‡ºæ–‡ä»¶å†…å®¹ä¸ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§°ã€‚\n  -n --line-number #åœ¨æ˜¾ç¤ºç¬¦åˆæ ·å¼çš„é‚£ä¸€è¡Œä¹‹å‰ï¼Œæ ‡ç¤ºå‡ºè¯¥è¡Œçš„åˆ—æ•°ç¼–å·ã€‚\n  -q --quietæˆ–--silent #ä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ã€‚\n  -r --recursive #æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®šâ€œ-d recurseâ€å‚æ•°ç›¸åŒã€‚\n  -s --no-messages #ä¸æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚\n  -v --revert-match #æ˜¾ç¤ºä¸åŒ…å«åŒ¹é…æ–‡æœ¬çš„æ‰€æœ‰è¡Œã€‚\n  -V --version #æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚\n  -w --word-regexp #åªæ˜¾ç¤ºå…¨å­—ç¬¦åˆçš„åˆ—ã€‚\n  -x --line-regexp #åªæ˜¾ç¤ºå…¨åˆ—ç¬¦åˆçš„åˆ—ã€‚\n  -y #æ­¤å‚æ•°çš„æ•ˆæœå’ŒæŒ‡å®šâ€œ-iâ€å‚æ•°ç›¸åŒã€‚\n   å…¶ä¸­æ ‡â­å·çš„ä¸ºæ¯”è¾ƒå¸¸å®ç”¨çš„\n æŸ¥æ‰¾å†…å®¹è§„åˆ™ æŸ¥æ‰¾å†…å®¹çš„è§„åˆ™ä¸æ­£åˆ™è¡¨è¾¾å¼å¤§åŒå°å¼‚ã€‚\n  ^ #é”šå®šè¡Œçš„å¼€å§‹ å¦‚ï¼š\u0026lsquo;^grep'åŒ¹é…æ‰€æœ‰ä»¥grepå¼€å¤´çš„è¡Œã€‚\n  $ #é”šå®šè¡Œçš„ç»“æŸ å¦‚ï¼š\u0026lsquo;grep$'åŒ¹é…æ‰€æœ‰ä»¥grepç»“å°¾çš„è¡Œã€‚\n  . #åŒ¹é…ä¸€ä¸ªéæ¢è¡Œç¬¦çš„å­—ç¬¦ å¦‚ï¼š\u0026lsquo;gr.p'åŒ¹é…gråæ¥ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚\n  *#åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå…ˆå‰å­—ç¬¦ å¦‚ï¼š'*grep'åŒ¹é…æ‰€æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åç´§è·Ÿgrepçš„è¡Œã€‚\n  .* #ä¸€èµ·ç”¨ä»£è¡¨ä»»æ„å­—ç¬¦ã€‚\n  [] #åŒ¹é…ä¸€ä¸ªæŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚\u0026rsquo;[Gg]rep'åŒ¹é…Grepå’Œgrepã€‚\n  [^]  #åŒ¹é…ä¸€ä¸ªä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚ï¼š'[^A-FH-Z]rep'åŒ¹é…ä¸åŒ…å«A-Rå’ŒT-Zçš„ä¸€ä¸ªå­—æ¯å¼€å¤´ï¼Œç´§è·Ÿrepçš„è¡Œã€‚\n  \\(..\\) #æ ‡è®°åŒ¹é…å­—ç¬¦ï¼Œå¦‚\u0026rsquo;(love)'ï¼Œloveè¢«æ ‡è®°ä¸º1ã€‚\n  \\\u0026lt; #é”šå®šå•è¯çš„å¼€å§‹ï¼Œå¦‚:'\u0026lt;grep'åŒ¹é…åŒ…å«ä»¥grepå¼€å¤´çš„å•è¯çš„è¡Œã€‚\n  \\\u0026gt; #é”šå®šå•è¯çš„ç»“æŸï¼Œå¦‚\u0026rsquo;grep\u0026gt;'åŒ¹é…åŒ…å«ä»¥grepç»“å°¾çš„å•è¯çš„è¡Œã€‚\n  x\\{m\\} #é‡å¤å­—ç¬¦xï¼Œmæ¬¡ï¼Œå¦‚ï¼š\u0026lsquo;0{5}\u0026lsquo;åŒ¹é…åŒ…å«5ä¸ªoçš„è¡Œã€‚\n  x\\{m,\\}  #é‡å¤å­—ç¬¦x,è‡³å°‘mæ¬¡ï¼Œå¦‚ï¼š\u0026lsquo;o{5,}\u0026lsquo;åŒ¹é…è‡³å°‘æœ‰5ä¸ªoçš„è¡Œã€‚\n  x\\{m,n\\} #é‡å¤å­—ç¬¦xï¼Œè‡³å°‘mæ¬¡ï¼Œä¸å¤šäºnæ¬¡ï¼Œå¦‚ï¼š\u0026lsquo;o{5,10}\u0026lsquo;åŒ¹é…5\u0026ndash;10ä¸ªoçš„è¡Œã€‚\n  \\w  #åŒ¹é…æ–‡å­—å’Œæ•°å­—å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯[A-Za-z0-9]ï¼Œå¦‚ï¼š\u0026lsquo;G\\w*p'åŒ¹é…ä»¥Gåè·Ÿé›¶ä¸ªæˆ–å¤šä¸ªæ–‡å­—æˆ–æ•°å­—å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚\n  \\W  #\\wçš„åç½®å½¢å¼ï¼ŒåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéå•è¯å­—ç¬¦ï¼Œå¦‚ç‚¹å·å¥å·ç­‰ã€‚\n  \\b  #å•è¯é”å®šç¬¦ï¼Œå¦‚: \u0026lsquo;\\bgrep\\b'åªåŒ¹é…grepã€‚\n  åœ¨/etc/profileæ–‡ä»¶ä¸­æŸ¥æ‰¾å…³é”®å­—CLASS_PATHæ‰€åœ¨ä½ç½®\næŸ¥è¯¢sshç›¸å…³è¿›ç¨‹\nå‹ç¼©è§£å‹ç±»å‘½ä»¤ gzip/gunzip gzipç”¨äºå‹ç¼©æ–‡ä»¶ï¼Œgunzipç”¨äºè§£å‹\nè¯­æ³•ï¼š\ngzipæ–‡ä»¶åï¼ˆåŠŸèƒ½æè¿°ï¼šå‹ç¼©æ–‡ä»¶ï¼Œåªèƒ½å°†æ–‡ä»¶å‹ç¼©ä¸º*.gzæ–‡ä»¶ï¼‰\ngunzip æ–‡ä»¶å(.gzç»“å°¾)ï¼š(åŠŸèƒ½æè¿°ï¼šè§£å‹ç¼©æ–‡ä»¶å‘½ä»¤ï¼‰\nå‹ç¼©b.txtæ–‡ä»¶\nè§£å‹b.txt.gzå‹ç¼©æ–‡ä»¶\nzip/unzip zipç”¨äºå‹ç¼©æ–‡ä»¶ï¼Œunzipç”¨äºè§£å‹çš„ï¼Œè¿™ä¸ªåœ¨é¡¹ç›®æ‰“åŒ…å‘å¸ƒä¸­å¾ˆæœ‰ç”¨çš„.\nè¯­æ³•ï¼š\nzip [é€‰é¡¹] XXX.zip å°†è¦å‹ç¼©çš„å†…å®¹ï¼ˆåŠŸèƒ½æè¿°ï¼šå‹ç¼©æ–‡ä»¶å’Œç›®å½•çš„å‘½ä»¤ï¼‰\nunzip [é€‰é¡¹] XXX.zip (åŠŸèƒ½æè¿°ï¼šè§£å‹ç¼©æ–‡ä»¶ï¼‰\nåŠ å¯†a.txtæ–‡ä»¶\nè§£å¯†a.zipæ–‡ä»¶\ntar taræŒ‡ä»¤æ˜¯æ‰“åŒ…æŒ‡ä»¤ï¼Œæœ€åæ‰“åŒ…åçš„æ–‡ä»¶å¯ä»¥æ˜¯.tar.gzçš„æ–‡ä»¶ã€‚\nè¯­æ³•ï¼š\ntar [é€‰é¡¹] XXX.tar.gz æ‰“åŒ…çš„å†…å®¹ï¼ˆåŠŸèƒ½æè¿°ï¼šæ‰“åŒ…ç›®å½•ï¼Œå‹ç¼©åçš„æ–‡ä»¶æ ¼å¼tar.gz)\né€‰é¡¹å‚æ•°ï¼š\n  -A æ–°å¢å‹ç¼©æ–‡ä»¶åˆ°å·²å­˜åœ¨çš„å‹ç¼©\n  -B è®¾ç½®åŒºå—å¤§å°\n  -c å»ºç«‹æ–°çš„å‹ç¼©æ–‡ä»¶\n  -d è®°å½•æ–‡ä»¶çš„å·®åˆ«\n  -r æ·»åŠ æ–‡ä»¶åˆ°å·²ç»å‹ç¼©çš„æ–‡ä»¶\n  -u æ·»åŠ æ”¹å˜äº†å’Œç°æœ‰çš„æ–‡ä»¶åˆ°å·²ç»å­˜åœ¨çš„å‹ç¼©æ–‡ä»¶\n  -x ä»å‹ç¼©çš„æ–‡ä»¶ä¸­æå–æ–‡ä»¶\n  -t æ˜¾ç¤ºå‹ç¼©æ–‡ä»¶çš„å†…å®¹\n  -z æ”¯æŒgzipè§£å‹æ–‡ä»¶\n  -j æ”¯æŒbzip2è§£å‹æ–‡ä»¶\n  -Z æ”¯æŒcompressè§£å‹æ–‡ä»¶\n  -v æ˜¾ç¤ºæ“ä½œè¿‡ç¨‹\n  -l æ–‡ä»¶ç³»ç»Ÿè¾¹ç•Œè®¾ç½®\n  -k ä¿ç•™åŸæœ‰æ–‡ä»¶ä¸è¦†ç›–\n  -m ä¿ç•™æ–‡ä»¶ä¸è¢«è¦†ç›–\n  -W ç¡®è®¤å‹ç¼©æ–‡ä»¶çš„æ­£ç¡®æ€§\n  å¯é€‰å‚æ•°å¦‚ä¸‹ï¼š\n  -b è®¾ç½®åŒºå—æ•°ç›®\n  -C åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•\n  -f æŒ‡å®šå‹ç¼©æ–‡ä»¶\n  --help æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯\n  --version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯\n  å®ä¾‹ï¼š\næ‰“åŒ…/victoræ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰å†…å®¹ï¼Œæ‰“åŒ…åçš„æ–‡ä»¶åä¸ºvictor.tar\nè§£å‹victor.taræ–‡ä»¶\næ‰“åŒ…æ–‡ä»¶å¤¹/victorå¹¶ä¸”å‹ç¼©æˆdata.tar.gz\nå°†å¤šä¸ªæ–‡ä»¶å‹ç¼©æˆa.tar.gz\nå°†a.tar.gzè§£å‹åˆ°å½“å‰ç›®å½•\nè§£å‹åˆ°æ–‡ä»¶å¤¹/a(æ–‡ä»¶å¤¹å¿…é¡»å­˜åœ¨ï¼Œä¸ç„¶æŠ¥é”™)\n![](https://i.loli.net/2020/04/16/xALa9JldzXuBjRi.png\n https://www.cnblogs.com/peida/archive/2012/12/17/2821195.html https://www.cnblogs.com/peida/archive/2012/12/19/2824418.html https://www.cnblogs.com/peida/archive/2012/12/06/2804323.html ","description":"","id":31,"section":"posts","tags":["Linux","grep","tar","gzip"],"title":"Linuxå®ç”¨æŒ‡ä»¤","uri":"https://hugo.jiahongw.com/zh/posts/linux-grep/"},{"content":"æ¯ä¸€ä¸ªç”¨æˆ·éƒ½æ˜¯ä¸€ä¸ªä¸ªä½“ï¼Œæ¯ä¸€ä¸ªä¸ªä½“éƒ½å±äºä¸€ä¸ªç¾¤ç»„ï¼Œè€Œæ¯ä¸€ä¸ªç¾¤ç»„åˆæœ‰åŒºåˆ«!\nâ€”â€”Users\n Linuxç³»ç»Ÿæ˜¯ä¸€ä¸ªå¤šç”¨æˆ·å¤šä»»åŠ¡çš„æ“ä½œç³»ç»Ÿï¼Œä»»ä½•ä¸€ä¸ªè¦ä½¿ç”¨ç³»ç»Ÿèµ„æºçš„ç”¨æˆ·ï¼Œéƒ½å¿…é¡»é¦–å…ˆå‘ç³»ç»Ÿç®¡ç†å‘˜ç”³è¯·ä¸€ä¸ªè´¦å·ï¼Œç„¶åä»¥è¿™ä¸ªè´¦å·çš„èº«ä»½è¿›å…¥ç³»ç»Ÿã€‚\n æ·»åŠ ç”¨æˆ· åŸºæœ¬è¯­æ³• useradd [é€‰é¡¹] ç”¨æˆ·å å®æ“ è¾“å…¥ä»¥ä¸‹å‘½ä»¤ä¹‹ååˆ›å»ºä¸€ä¸ªç”¨æˆ·victor\nè¿™é‡Œæˆ‘ä»¬é€‰é¡¹å‚æ•°ä»€ä¹ˆä¹Ÿæ²¡æœ‰å†™ï¼Œæ­¤æ—¶ä¼šé»˜è®¤åœ¨/homeç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª/victorçš„æ–‡ä»¶å¤¹ç”¨äºä¿å­˜ç”¨æˆ·victorç”¨æˆ·çš„æ•°æ®ä¿¡æ¯ã€‚\nå½“ç„¶æˆ‘ä»¬å¯ä»¥æŒ‡å®šå‚æ•°ï¼š\nç”¨å‚æ•° -d ç›®å½•æŒ‡å®šç”¨æˆ·ä¿¡æ¯å­˜å‚¨çš„ç›®å½•ï¼Œä½¿ç”¨å‘½ä»¤useradd -d /home/test tomåˆ›å»ºç”¨æˆ·tomã€‚\nä½¿ç”¨-g ç”¨æˆ·ç»„æŒ‡å®šå°†å½“å‰åˆ›å»ºçš„ç”¨æˆ·æ·»åŠ åˆ°æŒ‡å®šçš„ç”¨æˆ·ç»„ï¼Œä½¿ç”¨å‘½ä»¤useradd -g root wjhå°†æ–°å»ºç”¨æˆ·wjhæ·»åŠ åˆ°rootç”¨æˆ·ç»„ã€‚\nç»™ç”¨æˆ·è®¾ç½®å¯†ç  åŸºæœ¬è¯­æ³• passwd ç”¨æˆ·å å®æ“ ç»™ç”¨æˆ·victorè®¾ç½®å¯†ç (é»˜è®¤å¯†ç æ˜¯ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥çš„)\nä¸‹é¢å¯ä»¥ä½¿ç”¨victorè¿™ä¸ªç”¨æˆ·ç™»é™†\né»˜è®¤æ˜¯ä¸èƒ½è®¿é—®rootç”¨æˆ·çš„æ–‡ä»¶çš„ï¼Œå› ä¸ºä¸åœ¨åŒä¸€ä¸ªç»„\nåˆ‡æ¢ç”¨æˆ· åŸºæœ¬è¯­æ³• su - åˆ‡æ¢ç”¨æˆ·å å®æ“ åˆ‡æ¢åˆ°rootã€‚å…¶ä¸­ä½æƒé™ç”¨æˆ·åˆ‡æ¢åˆ°é«˜æƒé™ç”¨æˆ·éœ€è¦è¾“å…¥å¯†ç ã€‚\né€€å‡ºåˆ‡æ¢ä½¿ç”¨exitåˆ é™¤ç”¨æˆ· åŸºæœ¬è¯­æ³• userdel [é€‰é¡¹] ç”¨æˆ·å å…¶ä¸­é€‰é¡¹å‚æ•°å¯ä»¥æ·»åŠ -rï¼Œè¡¨ç¤ºåˆ é™¤ç”¨æˆ·æ—¶åŒæ—¶åˆ é™¤ä¿å­˜ç”¨æˆ·çš„æ–‡ä»¶å¤¹ã€‚\nå®æ“ åˆ é™¤ç”¨æˆ·tom\nå¯ä»¥çœ‹åˆ°ä¹‹å‰tomè‡´ç”µç»™åˆ›å»ºçš„æ–‡ä»¶å¤¹testå¹¶æ²¡æœ‰åˆ é™¤ã€‚\n æ³¨æ„ï¼Œåˆ é™¤ç”¨æˆ·å¿…é¡»è¦rootæƒé™ï¼Œä¸ç„¶åˆ é™¤ä¸äº†ã€‚\n åˆ é™¤ç”¨æˆ·victorï¼ŒåŒæ—¶åˆ é™¤å…¶æ–‡ä»¶å¤¹ï¼Œvictoræ–‡ä»¶å¤¹æ¶ˆå¤±äº†\nå…¶ä»–æ“ä½œ æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ è¯­æ³•\nid ç”¨æˆ·å å¦‚ä¸‹æŸ¥è¯¢ç”¨æˆ·rootçš„ä¿¡æ¯\nrootç”¨æˆ·çš„ç”¨æˆ·idä¸º0ï¼Œç»„idä¸º0ï¼Œç»„ä¸º0\næŸ¥è¯¢å½“å‰ç”¨æˆ· è¯­æ³•\nwhoami ç”¨æˆ·ç»„  ç±»ä¼¼äºè§’è‰²ï¼Œç³»ç»Ÿå¯ä»¥å¯¹æœ‰å…±æ€§çš„å¤šä¸ªç”¨æˆ·è¿›è¡Œç»Ÿä¸€çš„ç®¡ç†ã€‚\n ç”¨æˆ·ç»„å…³ç³»å›¾ï¼š\nå¢åŠ ç»„ è¯­æ³•\ngroupadd ç»„å å¢åŠ ç”¨æˆ·ç»„test\nåˆ é™¤ç»„ è¯­æ³•\ngroupdel ç»„å åˆ é™¤ç”¨æˆ·ç»„test\nä¿®æ”¹ç”¨æˆ·çš„ç»„ è¯­æ³•\nusermod -g ç”¨æˆ·ç»„ ç”¨æˆ·å ç›¸å…³é…ç½®æ–‡ä»¶  ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶ï¼š/etc/passwd å¯†ç æ–‡ä»¶ï¼š /etc/shadow ç”¨æˆ·ç»„æ–‡ä»¶ï¼š/etc/group ç”¨æˆ·ç»„å¯†ç æ–‡ä»¶ï¼š /etc/gshadow ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼š\n/etc/login.defs\n/etc/default/useradd æ–°ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶ï¼š/etc/skel ç™»å½•ä¿¡æ¯ï¼š/etc/motd  /etc/passwd æ¯ä¸€è¡Œå†…å®¹å­˜æ”¾ä¸€ä¸ªç”¨æˆ·çš„ä¿¡æ¯ï¼Œæ¯ä¸ªç”¨æˆ·ä¿¡æ¯æœ‰7éƒ¨åˆ†ç»„æˆ\nrootâ€‹ï¼šx:0:0:root:/root:/bin/bash\nroot ç”¨æˆ·å ç”¨æˆ·ç™»å½•ç³»ç»Ÿæ—¶ä½¿ç”¨çš„ç”¨æˆ·å\nx å¯†ç  å¯†ç ä½\n2 UID ç”¨æˆ·æ ‡è¯†å·\n2 GID ç¼ºçœç»„æ ‡è¯†\nroot æ³¨é‡Šæ€§æè¿° ä¾‹å¦‚å­˜æ”¾ç”¨æˆ·å…¨åç­‰ä¿¡æ¯\n/root å®¿ä¸»ç›®å½• ç”¨æˆ·ç™»å½•ç³»ç»Ÿåçš„ç¼ºçœç›®å½•\n/bin/bash å‘½ä»¤è§£é‡Šå™¨ ç”¨æˆ·ä½¿ç”¨çš„Shell ,é»˜è®¤ä¸ºbash\n UIDåˆ†ç±»\nè¶…çº§ç”¨æˆ·ï¼šï¼ˆroot UID=0ï¼‰\næ™®é€šç”¨æˆ·ï¼š ï¼ˆUID 500~60000ï¼‰\nä¼ªç”¨æˆ·ï¼š ï¼ˆUID 1~499ï¼‰\nä»€ä¹ˆæ˜¯ä¼ªç”¨æˆ·?\n ä¼ªç”¨æˆ·ä¸ç³»ç»Ÿå’Œç¨‹åºæœåŠ¡ç›¸å…³  binã€daemonã€shutdownã€haltç­‰ï¼Œä»»ä½•Linuxç³»ç»Ÿé»˜è®¤éƒ½æœ‰è¿™äº›ä¼ªç”¨æˆ·ã€‚\nmailã€newsã€gamesã€apacheã€ftpã€mysqlåŠsshdç­‰ï¼Œä¸linuxç³»ç»Ÿçš„è¿›ç¨‹ç›¸å…³ã€‚\n ä¼ªç”¨æˆ·é€šå¸¸ä¸éœ€è¦æˆ–æ— æ³•ç™»å½•ç³»ç»Ÿ\n  å¯ä»¥æ²¡æœ‰å®¿ä¸»ç›®å½•\n   /etc/shadow æ¯è¡Œçš„å«ä¹‰ï¼š ç™»å½•å: åŠ å¯†å£ä»¤: æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´: æœ€å°æ—¶é—´é—´éš”: æœ€å¤§æ—¶é—´é—´éš”:è­¦å‘Šæ—¶é—´: ä¸æ´»åŠ¨æ—¶é—´: å¤±æ•ˆæ—¶é—´:æ ‡å¿—\n/etc/group æ¯è¡Œå«ä¹‰ï¼š ç»„å: å£ä»¤: ç»„æ ‡è¯†å·: ç»„å†…ç”¨æˆ·åˆ—è¡¨\n https://www.cnblogs.com/qmfsun/p/3674024.html linuxç”¨æˆ·ç®¡ç†å‘½ä»¤ ","description":"","id":32,"section":"posts","tags":["Linux","ç”¨æˆ·ç®¡ç†"],"title":"Linuxç”¨æˆ·ç®¡ç†","uri":"https://hugo.jiahongw.com/zh/posts/linux-users/"},{"content":"åœ¨å¤§å­¦æ—¶ä»£ï¼ŒVim çš„å¤§åå°±å·²å¦‚é›·è´¯è€³ï¼Œä½†ç”±äºå®ƒé™¡å³­çš„å­¦ä¹ æ›²çº¿ï¼Œä¸€ç›´æœ›è€Œå´æ­¥ã€‚ç­‰çœŸæ­£å¼€å§‹å­¦ä¹ ä¹‹åï¼Œå‘ç°å¹¶æ²¡æœ‰æƒ³è±¡ä¸­çš„å¤æ‚ï¼Œä¹Ÿæ²¡æœ‰æ‰€è°“çš„ç“¶é¢ˆï¼Œåªè¦åœ¨å®é™…å†™ä»£ç ä¸­å¼ºè¿«è‡ªå·±ä½¿ç”¨å°±å¯ä»¥äº†ï¼Œæ— å½¢ä¸­å°±ä¼šå½¢æˆä¹ æƒ¯ã€‚\nâ€‹\tâ€”â€”GeekPlux\nä¸‰ç§æ¨¡å¼ æ­£å¸¸æ¨¡å¼ ä»¥ vim æ‰“å¼€ä¸€ä¸ªæ¡£æ¡ˆå°±ç›´æ¥è¿›å…¥ä¸€èˆ¬æ¨¡å¼äº†(è¿™æ˜¯é»˜è®¤çš„æ¨¡å¼)ã€‚æ­£å¸¸æ¨¡å¼å¯ä»¥ä½¿ç”¨å¿«æ·é”®ã€‚\nç¼–è¾‘æ¨¡å¼ æŒ‰ä¸‹i, I, o, O, a, A, r, Rç­‰ä»»ä½•ä¸€ä¸ªå­—æ¯ä¹‹åæ‰ä¼šè¿›å…¥ç¼–è¾‘æ¨¡å¼, ä¸€èˆ¬æ¥è¯´æŒ‰iå³å¯.\nå‘½ä»¤è¡Œæ¨¡å¼ åœ¨è¿™ä¸ªæ¨¡å¼å½“ä¸­ï¼Œ å¯ä»¥æä¾›ä½ ç›¸å…³æŒ‡ä»¤ï¼Œå®Œæˆè¯»å–ã€å­˜ç›˜ã€æ›¿æ¢ã€ç¦»å¼€ vim ã€æ˜¾ç¤ºè¡Œå·ç­‰çš„åŠ¨ä½œåˆ™æ˜¯åœ¨æ­¤æ¨¡å¼ä¸­è¾¾æˆçš„ã€‚\n vi å’Œvimæ¨¡å¼çš„ç›¸äº’åˆ‡æ¢\n å¸¸ç”¨å¿«æ·é”®  ä½¿ç”¨å¿«æ·é”®åœ¨æ­£å¸¸æ¨¡å¼ä¸‹è¾“å…¥ï¼\n å¤åˆ¶ç²˜è´´ æ‹·è´å½“å‰è¡Œè¾“å…¥yyï¼Œç„¶åå†æŒ‰ä¸‹pé”®çš„æ—¶å€™å°±å¯ä»¥ç²˜è´´äº†ã€‚\nå¤åˆ¶å¤šè¡Œå¯ä»¥è¾“å…¥nyyï¼Œå…¶ä¸­nä¸ºä¸€ä¸ªæ•°å­—ï¼Œä¾‹å¦‚5yyï¼Œå³å¤åˆ¶å½“å‰è¡Œå‘ä¸‹çš„5è¡Œï¼ŒåŒæ ·ç²˜è´´ä¹Ÿæ˜¯æŒ‰pé”®ã€‚\nåˆ é™¤ åˆ é™¤å½“å‰è¡Œè¾“å…¥dd\nåˆ é™¤å¤šè¡Œè¾“å…¥nddï¼Œè¡¨ç¤ºåˆ é™¤å½“å‰è¡Œå‘ä¸‹çš„nè¡Œã€‚\næŸ¥æ‰¾å•è¯ å†æ­£å¸¸æ¨¡å¼ä¸‹è¾“å…¥/å…³é”®å­—å³å¯æŸ¥æ‰¾å…³é”®å­—æ‰€åœ¨çš„ä½ç½®ï¼Œä¾‹å¦‚/helloä¸ºæŸ¥æ‰¾helloè¿™ä¸ªå•è¯æ‰€æœ‰çš„æ‰€åœ¨ä½ç½®ï¼Œè¾“å…¥ n å°±æ˜¯æŸ¥æ‰¾ä¸‹ä¸€ä¸ªã€‚\nè®¾ç½®æ–‡ä»¶è¡Œå· æœ‰æ—¶å€™ä¸ºäº†çœ‹æ–‡æ¡£æ›´æ¸…æ¥šï¼Œæƒ³è¦çŸ¥é“æ¯ä¸€è¡Œçš„è¡Œæ•°ï¼Œå¯ä»¥å…ˆè¿›å…¥å‘½ä»¤æ¨¡å¼ï¼Œåœ¨è¾“å…¥set nuï¼Œå³å†æ­£å¸¸æ¨¡å¼ä¸‹è¾“å…¥:set nu,ç„¶åå›è½¦ã€‚\nå–æ¶ˆè¡Œå·å¯ä»¥è¾“å…¥:set nonu\nç§»åŠ¨åˆ°åº•éƒ¨åˆ°é¦–éƒ¨ æœ‰æ—¶å€™éœ€è¦ç›´æ¥çœ‹æ–‡æ¡£çš„æœ«å°¾ï¼Œå¯ä»¥è¾“å…¥Gç§»åŠ¨åˆ°æ–‡ä»¶æœ«è¡Œã€‚\nè€Œç§»åŠ¨åˆ°é¦–è¡Œåˆ™æ˜¯è¾“å…¥ggï¼Œç„¶åå›è½¦å³å¯ã€‚\næ’¤é”€ å–æ¶ˆä¸Šä¸€æ¬¡åšçš„æ“ä½œï¼Œè¾“å…¥uã€‚è¡¨ç¤ºundoã€‚\nç§»åŠ¨åˆ°æŸè¡Œ å‡å¦‚æˆ‘ä»¬è¦ç§»åŠ¨åˆ°ç¬¬20è¡Œï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è¾“å…¥ï¼š20 + shift + g\næ›´å¤šå¿«æ·é”®å¯ä»¥å‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/77283813\nVimé”®ç›˜å›¾\næ€ç»´å¯¼å›¾ï¼š\n","description":"","id":33,"section":"posts","tags":["Linux","Vim"],"title":"Linuxç¼–è¾‘åˆ©å™¨-Vim","uri":"https://hugo.jiahongw.com/zh/posts/linux/vim-use/"},{"content":"é—®é¢˜æè¿° ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œæ‰¾åˆ° s ä¸­æœ€é•¿çš„å›æ–‡å­ä¸²ã€‚ä½ å¯ä»¥å‡è®¾ s çš„æœ€å¤§é•¿åº¦ä¸º 1000ã€‚\nç¤ºä¾‹ 1ï¼š\nè¾“å…¥: \u0026quot;babad\u0026quot; è¾“å‡º: \u0026quot;bab\u0026quot; æ³¨æ„: \u0026quot;aba\u0026quot; ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰æ•ˆç­”æ¡ˆã€‚ ç¤ºä¾‹ 2ï¼š\nè¾“å…¥: \u0026quot;cbbd\u0026quot; è¾“å‡º: \u0026quot;bb\u0026quot; è§£ç­” ä½¿ç”¨åŠ¨æ€è§„åˆ’ï¼ŒæŠŠåŸæ¥çš„å­—ç¬¦ä¸²å€’ç½®ï¼Œç„¶åæ‰¾æœ€é•¿çš„å…¬å…±å­ä¸²å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚ S = \u0026ldquo;caba\u0026rdquo; ï¼ŒS = \u0026ldquo;abac\u0026rdquo;ï¼Œæœ€é•¿å…¬å…±å­ä¸²æ˜¯ \u0026ldquo;aba\u0026rdquo;ï¼Œæ‰€ä»¥åŸå­—ç¬¦ä¸²çš„æœ€é•¿å›æ–‡ä¸²å°±æ˜¯ \u0026ldquo;aba\u0026rdquo;ã€‚å…¶ä¸­æ±‚æœ€å¤§å…¬å…±å­ä¸²å°±æ˜¯ä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹æ³•ã€‚\nç¤ºæ„å›¾ï¼š\n å½“S[i]==S[j]æ—¶ï¼ŒçŸ©é˜µarr[i][j]=arr[i-1][j-1]+1ï¼›ç‰¹æ®Šæƒ…å†µiã€jä¸º0æ—¶arr[i][j]=1 å…¶ä»–æƒ…å†µè·³è¿‡ã€‚   å¦å¤–ï¼Œè¿˜éœ€è¦è€ƒè™‘æœ€é•¿å…¬å…±å­ä¸²ä¸æ˜¯å›æ–‡çš„æƒ…å†µï¼Œåªéœ€è¦åˆ¤æ–­ç¿»è½¬å‰åçš„æœ«å°¾å­—ç¬¦ä¸‹æ ‡æ˜¯å¦ä¸€æ ·å³å¯ï¼Œæ¯”å¦‚ S=\u0026quot;caba\u0026rdquo;ï¼ŒS'=\u0026quot;abac\u0026rdquo; ï¼ŒSâ€™ ä¸­ aba çš„ä¸‹æ ‡æ˜¯ 0 1 2 ï¼Œå€’ç½®å‰æ˜¯ 3 2 1ï¼Œå’Œ S ä¸­ aba çš„ä¸‹æ ‡ç¬¦åˆï¼Œæ‰€ä»¥ aba å°±æ˜¯æˆ‘ä»¬éœ€è¦æ‰¾çš„ã€‚å½“ç„¶æˆ‘ä»¬ä¸éœ€è¦æ¯ä¸ªå­—ç¬¦éƒ½åˆ¤æ–­ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ¤æ–­æœ«å°¾å­—ç¬¦å°±å¯ä»¥ã€‚\n ä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46  #include \u0026lt;iostream\u0026gt;#include \u0026lt;algorithm\u0026gt;class Solution { public: string longestPalindrome(string s) { //æš´åŠ›æ³•  int len = s.length(); if (len \u0026lt;= 1) return s; std::string r; std::string real = s; reverse(s.begin(), s.end()); std::string reverse = s; int arr[len][len]; for (int i = 0; i \u0026lt; len; ++i) for (int j = 0; j \u0026lt; len; ++j) arr[i][j] = 0; int maxLen(0), maxEnd(0); for (int i = 0; i \u0026lt; len; ++i) { for (int j = 0; j \u0026lt; len; ++j) { if (real[i] == reverse[j]) { if (i == 0 || j == 0) arr[i][j] = 1; else { arr[i][j] = arr[i - 1][j - 1] + 1; } } if (arr[i][j] \u0026gt; maxLen) { int beforeindex = len - 1 - j; if ((beforeindex + arr[i][j] - 1) == i) { maxLen = arr[i][j]; maxEnd = i; } } } } return real.substr(maxEnd - maxLen + 1, maxLen); } };   ç»“æœï¼š ","description":"","id":34,"section":"posts","tags":["C++","leetcode"],"title":"Leetcode-æœ€é•¿å›æ–‡å­ä¸²","uri":"https://hugo.jiahongw.com/zh/posts/leetcode-0/"},{"content":"LinuxåŸºæœ¬æ“ä½œã€‚ğŸ¤ \nLinux ç›®å½•ç»“æ„åŠè§£é‡Š æŸ¥çœ‹å‘½ä»¤è¡Œæ‰§è¡Œå®Œä½ç½®ï¼š\n1  echo $BASH   å‘½ä»¤è®°å½• mkdir mkdirå‘½ä»¤ ç”¨æ¥åˆ›å»ºç›®å½•ã€‚\nè¯­æ³•ï¼šmkdir (é€‰é¡¹)(å‚æ•°)\n ä¸»è¦é€‰é¡¹ï¼š\n-m\u0026lt;ç›®æ ‡å±æ€§\u0026gt;æˆ–\u0026ndash;mode\u0026lt;ç›®æ ‡å±æ€§\u0026gt;å»ºç«‹ç›®å½•çš„åŒæ—¶è®¾ç½®ç›®å½•çš„æƒé™ï¼›\n-pæˆ–\u0026ndash;parents è‹¥æ‰€è¦å»ºç«‹ç›®å½•çš„ä¸Šå±‚ç›®å½•ç›®å‰å°šæœªå»ºç«‹ï¼Œåˆ™ä¼šä¸€å¹¶å»ºç«‹ä¸Šå±‚ç›®å½•ï¼›\nå‚æ•°ï¼š\næŒ‡å®šè¦åˆ›å»ºçš„ç›®å½•åˆ—è¡¨ï¼Œå¤šä¸ªç›®å½•ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€ã€‚\n åˆ›å»ºå¤šå±‚ç›®å½•ï¼š\n1  mkdir a/b/c/d   chmod chmodå‘½ä»¤ç”¨æ¥å˜æ›´æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚\nè¯­æ³•ï¼šchmod(é€‰é¡¹)(å‚æ•°)\næƒé™èŒƒå›´çš„è¡¨ç¤ºæ³•å¦‚ä¸‹ï¼š\nu Userï¼Œå³æ–‡ä»¶æˆ–ç›®å½•çš„æ‹¥æœ‰è€…ï¼›\ng Groupï¼Œå³æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±ç¾¤ç»„ï¼›\no Otherï¼Œé™¤äº†æ–‡ä»¶æˆ–ç›®å½•æ‹¥æœ‰è€…æˆ–æ‰€å±ç¾¤ç»„ä¹‹å¤–ï¼Œå…¶ä»–ç”¨æˆ·çš†å±äºè¿™ä¸ªèŒƒå›´ï¼›\na Allï¼Œå³å…¨éƒ¨çš„ç”¨æˆ·ï¼ŒåŒ…å«æ‹¥æœ‰è€…ï¼Œæ‰€å±ç¾¤ç»„ä»¥åŠå…¶ä»–ç”¨æˆ·ï¼›\nr è¯»å–æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ4â€;\nw å†™å…¥æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ2â€ï¼›\nx æ‰§è¡Œæˆ–åˆ‡æ¢æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ1â€ï¼›\n- ä¸å…·ä»»ä½•æƒé™ï¼Œæ•°å­—ä»£å·ä¸ºâ€œ0â€ï¼›\ns ç‰¹æ®ŠåŠŸèƒ½è¯´æ˜ï¼šå˜æ›´æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚\nä¾‹å­ï¼š\n1 2 3 4  chmod u+x,g+w f01ã€€//ä¸ºæ–‡ä»¶f01è®¾ç½®è‡ªå·±å¯ä»¥æ‰§è¡Œï¼Œç»„å‘˜å¯ä»¥å†™å…¥çš„æƒé™ chmod u=rwx,g=rw,o=r f01 chmod 764 f01 chmod a+x f01ã€€//å¯¹æ–‡ä»¶f01çš„u,g,oéƒ½è®¾ç½®å¯æ‰§è¡Œå±æ€§   å¯ä»¥è¾“å…¥å‘½ä»¤ll -d æ–‡ä»¶åæŸ¥çœ‹æ–‡ä»¶çš„æƒé™ï¼š\nlinuxæ–‡ä»¶çš„ç”¨æˆ·æƒé™çš„åˆ†æå›¾\nä¾‹ï¼šrwxã€€rw-ã€€r\u0026ndash;\nr=è¯»å–å±æ€§ã€€//å€¼ï¼4\nw=å†™å…¥å±æ€§ã€€//å€¼ï¼2\nx=æ‰§è¡Œå±æ€§ã€€//å€¼ï¼1\nå¯¹demo.shæ‰§è¡Œchmod a+x demo.shä¹‹åï¼ŒæŸ¥çœ‹å…¶æƒé™ï¼Œä¸‰ä¸ªç»„éƒ½å«xï¼Œè¡¨ç¤ºæ‰€æœ‰ç”¨æˆ·éƒ½èƒ½æ‰§è¡Œï¼š\nShellè„šæœ¬ shellè„šæœ¬ä¸€èˆ¬ä»¥.shç»“å°¾ã€‚å¦‚demo.shï¼š\n1 2 3  #!/bin/bash #This is my First shell echo \u0026#34;Hello World!\u0026#34;    ç¬¬ä¸€è¡Œè¡¨ç¤ºè„šæœ¬çš„ä½ç½®\nç¬¬äºŒè¡Œä¸ºæ³¨é‡Š\nç¬¬ä¸‰è¡Œä¸ºè„šæœ¬çš„å‘½ä»¤\n å¦‚ä½•æ‰§è¡Œï¼Ÿåœ¨Linuxä¸‹éœ€è¦å…ˆèµ‹äºˆæƒé™\n1  chmod o+x demo.sh   æ‰§è¡Œ\n1  ./demo.sh   å¸¸è§çš„å˜é‡\n$0å½“å‰ç¨‹åºçš„åç§°\n$nå½“å‰ç¨‹åºçš„ç¬¬ n ä¸ªå‚æ•°,n=1,2,â€¦9\n$* å½“å‰ç¨‹åºçš„æ‰€æœ‰å‚æ•°(ä¸åŒ…æ‹¬ç¨‹åºæœ¬èº«)\n$# å½“å‰ç¨‹åºçš„å‚æ•°ä¸ªæ•°(ä¸åŒ…æ‹¬ç¨‹åºæœ¬èº«)\n$? å‘½ä»¤æˆ–ç¨‹åºæ‰§è¡Œå®Œåçš„çŠ¶æ€ï¼Œä¸€èˆ¬è¿”å› 0 è¡¨ç¤ºæ‰§è¡ŒæˆåŠŸã€‚\n$UID å½“å‰ç”¨æˆ·çš„ ID\n$PWD å½“å‰æ‰€åœ¨çš„ç›®å½•\nIf æ¡ä»¶åˆ¤æ–­è¯­å¥ æ ¼å¼ï¼š\n1 2 3 4 5  if (è¡¨è¾¾å¼) #if ( Variable in Array ) è¯­å¥ 1 else è¯­å¥ 2 fi   ä¾‹ï¼š\n1 2 3 4 5  #!/bin/sh NUM=100 if (( $NUM \u0026gt; 4 )) ;then echo â€œthis num is $NUM greater 4 !â€ fi   å‚è€ƒï¼š\n https://wangchujiang.com/linux-command/ ","description":"","id":35,"section":"posts","tags":["Linux","Shell","bash"],"title":"Linuxå‘½ä»¤ä¸Shell","uri":"https://hugo.jiahongw.com/zh/posts/linux/linux-shell/"},{"content":"Dockeræ˜¯åŸºäºå†…æ ¸çš„å®¹å™¨,å¯ä»¥è¿è¡Œåœ¨å®¿ä¸»æœºä¸Š,çœ‹ä½œæ˜¯ä¸€ä¸ªå®¹å™¨.\nDockerğŸ‹ å®‰è£…é…ç½® ç•¥,å¯ä»¥ç™¾åº¦æœç´¢.å¦‚ä¸‹:\nhttps://juejin.im/post/5dc241ce6fb9a04aa333c1bd\nåŸºæœ¬ä½¿ç”¨ å®‰è£…å®Œæˆä¹‹å,å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ç‰ˆæœ¬\n1  docker version   æ‹‰å–å¹¶ä¸”è¿è¡Œhello-worldé•œåƒè¿›è¡Œæµ‹è¯•\ndocker run hello-world æŸ¥çœ‹æœ¬åœ°é•œåƒ:\ndocker image ls æœ¬åœ°æœ‰ä¸€ä¸ªhello-worldé•œåƒ\nImageçš„è·å– 1. ä»Dockerfileåˆ¶ä½œ 2. ä»Registeræ‹‰å–(Pull from Register) ä¾‹å¦‚:\n1  docker pull ubuntu:14.04   å¯ä»¥åœ¨DockerHubé‡Œé¢æœç´¢ç›¸å…³çš„é•œåƒ\næ·»åŠ Dockerç”¨æˆ·æƒé™ï¼Œåˆ›å»ºdockerç»„\n1  sudo groupadd docker   1  sudo gpasswd -a vagrant docker   1  sudo service docker restart   æœ€åé‡æ–°ç™»é™†æœåŠ¡å™¨å³å¯\nè‡ªå®šä¹‰image æ„å»ºä¸€ä¸ªè¾“å‡ºä¿¡æ¯çš„Cè¯­è¨€ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶é•œåƒ\né¦–å…ˆç¼–å†™Cæ–‡ä»¶,å¦‚ä¸‹:\n1 2 3 4 5 6  #include \u0026lt;stdio.h\u0026gt;int main(){ printf(\u0026#34;Hello,Docker!\\n\u0026#34;); return 0; }   å®‰è£…gccåŠç›¸å…³åº“:\n1 2  sudo yum install gcc sudo yum install glibc-static   ç¼–è¯‘:\n1  gcc -static hello.c -o hello   åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºDockerfile\n1  vim Dockerfile   ç¼–å†™ä¸‹é¢çš„å†…å®¹\n1 2 3  FROM scratch ADD hello / CMD [\u0026#34;/hello\u0026#34;]   ä½¿ç”¨dockeræ„å»º:\n1  docker build -t victorhong/hello .   å…¶ä¸­victorhongæ˜¯ç”¨æˆ·å,helloæ˜¯é•œåƒå,.è¡¨ç¤ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹\næ„å»ºå®Œå¯ä»¥æŸ¥çœ‹åˆ°é•œåƒ:\næŸ¥çœ‹æ„å»ºçš„å†å²\nè¿è¡Œå®¹å™¨\ndocker run victorhong/hello Container ä»€ä¹ˆæ˜¯container?\næŸ¥çœ‹container\n1  docker container ls   æŸ¥çœ‹æ‰€æœ‰cpntainer,åŒ…æ‹¬ç»“æŸçš„\n1  docker container ls -a   è¿è¡Œubuntu:16.04æ˜¯é©¬ä¸Šå°±ä¼šç»“æŸçš„,è¦æƒ³äº¤äº’å¼çš„æ‰§è¡Œå®¹å™¨,ä½¿ç”¨ä»¥ä¸‹çš„mingl\n1  docker run -it ubuntu:16.04   å¦å¤–å¼€ä¸€ä¸ªçª—å£,æŸ¥çœ‹container\n1  docker container ls   å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªubuntuå®¹å™¨æ­£åœ¨è¿è¡Œ\næ„å»ºè‡ªå·±çš„Dockeré•œåƒ   docker container commit\n1  docker commit clever_franklin victorhong/centos-vim   åœ¨å¯¹å®¹å™¨è¿›è¡Œä¿®æ”¹äº†ä¹‹å,clever_franklinä¸ºå®¹å™¨å,victorhong/centos-vimä¸ºæäº¤çš„é•œåƒå\n  Dockerfile build\n1 2  FROMcentosRUN yum install -y vim  ç„¶åæ‰§è¡Œ\n1  docker build -t victorhong/centos-vim-new .     Dockerfileè¯­æ³• FROM å®šä¹‰base image\nLabel å®šä¹‰æ•°æ®ä¿¡æ¯,ç±»ä¼¼æ³¨é‡Š\n Metadataä¸å¯å°‘\n RUN æ¯æ‰§è¡Œä¸€æ¬¡run,éƒ½ä¼šæ–°å»ºä¸€å±‚,å°½é‡å°‘ç”¨å¤šæ¬¡run\nWORKDIR è®¾å®šå½“å‰å·¥ä½œç›®å½•,ç±»ä¼¼cd\n æ³¨æ„:\n ADD and COPY ADDè¿˜æœ‰è§£å‹åŠŸèƒ½\nENV è®¾ç½®ç¯å¢ƒå˜é‡æˆ–è€…å¸¸é‡å˜é‡\nå°½é‡ä½¿ç”¨ENVå¢åŠ å¯ç»´æŠ¤æ€§\nVOLUME ADN EXPOSE VOLUMEç”¨äºæŒ‚è½½æ•°æ®å·ï¼ŒEXPOSEç”¨äºæš´éœ²ç«¯å£\nCMD and ENTRYPOINT åŒºåˆ«:\næ‰§è¡Œå‘½ä»¤æ ¼å¼:\nGitHubä¸Šçš„å®˜æ–¹Dockerfile\né•œåƒçš„å‘å¸ƒ ä½¿ç”¨DockerHubå»push\nç™»é™†docker\n1  docker login   push\n1  docker push victorhongdream/hello:latest   æŸ¥çœ‹DockerHub\n","description":"","id":36,"section":"posts","tags":["docker"],"title":"å…¥é—¨Docker","uri":"https://hugo.jiahongw.com/zh/posts/docker-begin/"},{"content":"C++ç‰¹æ€§ä¹‹å¤šæ€ğŸ„\né™æ€ç±»å‹ æ˜¯æŒ‡ä¸éœ€è¦è€ƒè™‘è¡¨è¾¾å¼çš„æ‰§è¡ŒæœŸè¯­ä¹‰ï¼Œä»…åˆ†æç¨‹åºæ–‡æœ¬è€Œå†³å®šçš„è¡¨è¾¾å¼ç±»å‹ã€‚\nåŠ¨æ€ç±»å‹ æ˜¯æŒ‡ç”±ä¸€ä¸ªå·¦å€¼è¡¨è¾¾å¼è¡¨ç¤ºçš„å·¦å€¼æ‰€å¼•ç”¨çš„æœ€ç»ˆæ´¾ç”Ÿå¯¹è±¡çš„ç±»å‹ã€‚\nåŠ¨æ€ç»‘å®šä¸é™æ€ç»‘å®š **é™æ€ç»‘å®šï¼š**ç¼–è¯‘æ—¶ç»‘å®šï¼Œé€šè¿‡å¯¹è±¡è°ƒç”¨\n**åŠ¨æ€ç»‘å®šï¼š**è¿è¡Œæ—¶ç»‘å®šï¼Œé€šè¿‡åœ°å€å®ç°\nä½•æ—¶ä½¿ç”¨åŠ¨æ€ç»‘å®š?\n åªæœ‰é‡‡ç”¨â€œæŒ‡é’ˆ-\u0026gt;å‡½æ•°()â€æˆ–â€œå¼•ç”¨å˜é‡.å‡½æ•°()â€çš„æ–¹å¼è°ƒç”¨C++ç±»ä¸­çš„è™šå‡½æ•°æ‰ä¼šæ‰§è¡ŒåŠ¨æ€ç»‘å®šã€‚ å¯¹äºC++ä¸­çš„éè™šå‡½æ•°ï¼Œå› ä¸ºå…¶ä¸å…·å¤‡åŠ¨æ€ç»‘å®šçš„ç‰¹å¾ï¼Œæ‰€ä»¥ä¸ç®¡é‡‡ç”¨ä»€ä¹ˆæ ·çš„æ–¹å¼è°ƒç”¨ï¼Œéƒ½ä¸ä¼šæ‰§è¡ŒåŠ¨æ€ç»‘å®šã€‚   æ€»çš„æ¥æ‰€,åŠ¨æ€ç»‘å®šæ‰§è¡Œçš„å‡½æ•°åªé’ˆå¯¹è™šå‡½æ•°,æ‰§è¡Œè™šå‡½æ•°ä¼šåŠ¨æ€æ‰§è¡Œ,è€Œéè™šå‡½æ•°å°±ç›´æ¥æ‰§è¡ŒåŸºç±»ç±»å‹çš„å‡½æ•°,ä¹Ÿå°±æ˜¯è¯´æŒ‡é’ˆç±»å‹æ˜¯ä»€ä¹ˆï¼Œå°±ä¼šè°ƒç”¨è¯¥ç±»å‹ç›¸åº”çš„å‡½æ•°ã€‚\n ä¾‹å¦‚ä¸‹é¢çš„ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  #include \u0026lt;iostream\u0026gt;using namespace std; class Base { public: void func() { cout \u0026lt;\u0026lt; \u0026#34;func() in Base.\u0026#34; \u0026lt;\u0026lt; endl; } virtual void test() { cout \u0026lt;\u0026lt; \u0026#34;test() in Base.\u0026#34; \u0026lt;\u0026lt; endl; } }; class Derived : public Base { void func() { cout \u0026lt;\u0026lt; \u0026#34;func() in Derived.\u0026#34; \u0026lt;\u0026lt; endl; } virtual void test() { cout \u0026lt;\u0026lt; \u0026#34;test() in Derived.\u0026#34; \u0026lt;\u0026lt; endl; } }; int main() { Base *b; b = new Derived(); b-\u0026gt;func(); b-\u0026gt;test(); }   è¾“å‡ºä¸º:\nfunc() in Base. test() in Derived. å†ä¾‹å¦‚ä¸‹é¢çš„ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  class A { public: virtual void func(int val = 1) { std::cout\u0026lt;\u0026lt;\u0026#34;A-\u0026gt;\u0026#34;\u0026lt;\u0026lt;val \u0026lt;\u0026lt;std::endl;} virtual void test() { func();} }; class B : public A { public: void func(int val=0) {std::cout\u0026lt;\u0026lt;\u0026#34;B-\u0026gt;\u0026#34;\u0026lt;\u0026lt;val \u0026lt;\u0026lt;std::endl;} }; int main(int argc ,char* argv[]) { B*p = new B; p-\u0026gt;test(); return 0; }   è¾“å‡ºä¸º: B-\u0026gt;1\n test()æ˜¯è™šå‡½æ•°,p-\u0026gt;test()ä¼šåŠ¨æ€è°ƒç”¨Bç±»ä¸­çš„test()å‡½æ•°,å¹¶ä¸”,è¿˜éœ€è¦è®°ä½ä¸€ä¸ªç»“è®º:virtual å‡½æ•°æ˜¯åŠ¨æ€ç»‘å®šï¼Œè€Œç¼ºçœå‚æ•°å€¼å´æ˜¯é™æ€ç»‘å®š,ç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„ç¼ºçœå‚æ•°å€¼ï¼\n è™šå‡½æ•°ã€åŠ¨æ€ç»‘å®šã€è¿è¡Œæ—¶å¤šæ€ä¹‹é—´çš„å…³ç³» è¦è§¦å‘åŠ¨æ€ç»‘å®šï¼Œéœ€æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š\n  åªæœ‰è™šå‡½æ•°æ‰èƒ½è¿›è¡ŒåŠ¨æ€ç»‘å®šï¼Œéè™šå‡½æ•°ä¸è¿›è¡ŒåŠ¨æ€ç»‘å®šã€‚\n  å¿…é¡»é€šè¿‡åŸºç±»ç±»å‹çš„å¼•ç”¨æˆ–æŒ‡é’ˆè¿›è¡Œå‡½æ•°è°ƒç”¨ã€‚\n  ç®€å•åœ°è¯´ï¼Œè™šå‡½æ•°æ˜¯åŠ¨æ€ç»‘å®šçš„åŸºç¡€ï¼›åŠ¨æ€ç»‘å®šæ˜¯å®ç°è¿è¡Œæ—¶å¤šæ€çš„åŸºç¡€ã€‚\n https://blog.csdn.net/iicy266/article/details/11906509 C++ä¸­çš„åŠ¨æ€ç±»å‹ä¸åŠ¨æ€ç»‘å®šã€è™šå‡½æ•°ã€è¿è¡Œæ—¶å¤šæ€çš„å®ç° ","description":"","id":37,"section":"posts","tags":["C++","å¤šæ€"],"title":"C++åŠ¨æ€ä¸é™æ€","uri":"https://hugo.jiahongw.com/zh/posts/cpp-duotai/"},{"content":"cæ–‡ä»¶è¯»å†™ğŸ—ƒ\nFILEå¯¹è±¡ç»“æ„ä½“ 1 2 3 4 5 6 7 8  typedef struct { int _fd; // æ–‡ä»¶å·  int _cleft; // ç¼“å†²åŒºä¸­å‰©ä¸‹çš„å­—èŠ‚æ•°  int _mode; // æ–‡ä»¶æ“ä½œæ¨¡å¼  char * _nextc; // ä¸‹ä¸€ä¸ªå­—èŠ‚çš„ä½ç½®  char * _buff; // æ–‡ä»¶ç¼“å†²åŒºä½ç½® }FILE;   æ‰“å¼€æ–‡ä»¶ å¯ä»¥ä½¿ç”¨ fopen( ) å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶æˆ–è€…æ‰“å¼€ä¸€ä¸ªå·²æœ‰çš„æ–‡ä»¶ï¼Œè¿™ä¸ªè°ƒç”¨ä¼šåˆå§‹åŒ–ç±»å‹ FILE çš„ä¸€ä¸ªå¯¹è±¡ï¼Œç±»å‹ FILE åŒ…å«äº†æ‰€æœ‰ç”¨æ¥æ§åˆ¶æµçš„å¿…è¦çš„ä¿¡æ¯ã€‚ä¸‹é¢æ˜¯è¿™ä¸ªå‡½æ•°è°ƒç”¨çš„åŸå‹ï¼š\n1  FILE *fopen( const char * filename, const char * mode );   mode çš„å€¼å¯ä»¥æ˜¯r,w,a,,r+,w+,a+:\n   r æ‰“å¼€ä¸€ä¸ªå·²æœ‰çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå…è®¸è¯»å–æ–‡ä»¶ã€‚     w æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…è®¸å†™å…¥æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨çš„ç¨‹åºä¼šä»æ–‡ä»¶çš„å¼€å¤´å†™å…¥å†…å®¹ã€‚å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™è¯¥ä¼šè¢«æˆªæ–­ä¸ºé›¶é•¿åº¦ï¼Œé‡æ–°å†™å…¥ã€‚   a æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œä»¥è¿½åŠ æ¨¡å¼å†™å…¥æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨çš„ç¨‹åºä¼šåœ¨å·²æœ‰çš„æ–‡ä»¶å†…å®¹ä¸­è¿½åŠ å†…å®¹ã€‚   r+ æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…è®¸è¯»å†™æ–‡ä»¶ã€‚   w+ æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…è®¸è¯»å†™æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™æ–‡ä»¶ä¼šè¢«æˆªæ–­ä¸ºé›¶é•¿åº¦ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚   a+ æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…è®¸è¯»å†™æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚è¯»å–ä¼šä»æ–‡ä»¶çš„å¼€å¤´å¼€å§‹ï¼Œå†™å…¥åˆ™åªèƒ½æ˜¯è¿½åŠ æ¨¡å¼ã€‚    å¦‚æœå¤„ç†çš„æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåˆ™éœ€ä½¿ç”¨ä¸‹é¢çš„è®¿é—®æ¨¡å¼æ¥å–ä»£ä¸Šé¢çš„è®¿é—®æ¨¡å¼ï¼š\n1  \u0026#34;rb\u0026#34;, \u0026#34;wb\u0026#34;, \u0026#34;ab\u0026#34;, \u0026#34;rb+\u0026#34;, \u0026#34;r+b\u0026#34;, \u0026#34;wb+\u0026#34;, \u0026#34;w+b\u0026#34;, \u0026#34;ab+\u0026#34;, \u0026#34;a+b\u0026#34;     å…³é—­æ–‡ä»¶ å…³é—­æ–‡ä»¶éå¸¸ç®€å•,åªéœ€è¦è°ƒç”¨**fclose()**å‡½æ•°å³å¯,å…¶ä¸­å‚æ•°å°±æ˜¯æŒ‡å‘æ–‡ä»¶å¯¹è±¡çš„æŒ‡é’ˆ.\n1  int fclose( FILE *fp );   å¦‚æœæˆåŠŸå…³é—­æ–‡ä»¶ï¼Œfclose( ) å‡½æ•°è¿”å›é›¶ï¼Œå¦‚æœå…³é—­æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ï¼Œå‡½æ•°è¿”å› EOFã€‚è¿™ä¸ªå‡½æ•°å®é™…ä¸Šï¼Œä¼šæ¸…ç©ºç¼“å†²åŒºä¸­çš„æ•°æ®ï¼Œå…³é—­æ–‡ä»¶ï¼Œå¹¶é‡Šæ”¾ç”¨äºè¯¥æ–‡ä»¶çš„æ‰€æœ‰å†…å­˜ã€‚EOF æ˜¯ä¸€ä¸ªå®šä¹‰åœ¨å¤´æ–‡ä»¶ stdio.h ä¸­çš„å¸¸é‡ã€‚  demo 1 2 3 4 5 6 7 8 9 10 11 12 13  void open_close_file(){ char fname[10]; printf(\u0026#34;pease input file name: \u0026#34;); scanf(\u0026#34;%s\u0026#34;,fname); FILE *p = fopen(fname,\u0026#34;r+\u0026#34;); if(p == NULL) { printf(\u0026#34;file open fail!\\n\u0026#34;); return ; } printf(\u0026#34;file %s open sucessful!\\n\u0026#34;,fname); fclose(p); printf(\u0026#34;file %s had be closed!\\n\u0026#34;,fname); }   è¯»å–æ–‡ä»¶ è¯»å–å•ä¸ªå­—ç¬¦çš„æœ€ç®€å•çš„å‡½æ•°:\n1  int fgetc( FILE * fp );   è¯»å–å¤šä¸ªå­—ç¬¦çš„å‡½æ•°(ä¹Ÿå¯ä»¥è¯»å–å•ä¸ªå­—ç¬¦):\n1  char *fgets( char *buf, int n, FILE *fp );   fgetc() å‡½æ•°ä» fp æ‰€æŒ‡å‘çš„è¾“å…¥æ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ªå­—ç¬¦ã€‚è¿”å›å€¼æ˜¯è¯»å–çš„å­—ç¬¦ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯åˆ™è¿”å› EOFã€‚\nå‡½æ•° fgets() ä» fp æ‰€æŒ‡å‘çš„è¾“å…¥æµä¸­è¯»å– n - 1 ä¸ªå­—ç¬¦ã€‚å®ƒä¼šæŠŠè¯»å–çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ°ç¼“å†²åŒº bufï¼Œå¹¶åœ¨æœ€åè¿½åŠ ä¸€ä¸ª null å­—ç¬¦æ¥ç»ˆæ­¢å­—ç¬¦ä¸²ã€‚\n ä¾‹å­:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  void read_file_demo() { char fname[10] = \u0026#34;basic.sql\u0026#34;; FILE *fp = fopen(fname, \u0026#34;r+\u0026#34;); if (fp == NULL) { printf(\u0026#34;file open fail!\\n\u0026#34;); return; } printf(\u0026#34;file %s open sucessful!\\n\u0026#34;, fname); char ch; int n = 5; printf(\u0026#34;\\nusing fgetc()......\\n\u0026#34;); while (n--) { ch = fgetc(fp); if(ch != EOF) printf(\u0026#34;char = %c\\n\u0026#34;, ch); } char str[20]; printf(\u0026#34;\\nusing fgets()......\\n\u0026#34;); fgets(str,20,fp); printf(\u0026#34;str[20] = %s\\n\u0026#34;,str); fclose(fp); printf(\u0026#34;file %s had be closed!\\n\u0026#34;, fname); }   è¯»å–äºŒè¿›åˆ¶è¾“å…¥:\n1  size_t fread(void *buffer, size_t size, size_t count, FILE * stream);    bufferä¸ºæ¥æ”¶æ•°æ®çš„åœ°å€ï¼Œsizeä¸ºä¸€ä¸ªå•å…ƒçš„å¤§å°ï¼Œcountä¸ºå•å…ƒä¸ªæ•°ï¼Œstreamä¸ºæ–‡ä»¶æµã€‚\nè¿”å›å®é™…è¯»å–çš„å•å…ƒä¸ªæ•°ã€‚å¦‚æœå°äºcountï¼Œåˆ™å¯èƒ½æ–‡ä»¶ç»“æŸæˆ–è¯»å–å‡ºé”™ï¼›å¯ä»¥ç”¨ferror()æ£€æµ‹æ˜¯å¦è¯»å–å‡ºé”™ï¼Œç”¨feof()å‡½æ•°æ£€æµ‹æ˜¯å¦åˆ°è¾¾æ–‡ä»¶ç»“å°¾ã€‚å¦‚æœsizeæˆ–countä¸º0ï¼Œåˆ™è¿”å›0ã€‚\n å†™å…¥æ–‡ä»¶ å†™å…¥å•ä¸ªå­—ç¬¦çš„æœ€ç®€å•çš„å‡½æ•°:\n1  int fputc( int c, FILE *fp );   å†™å…¥å¤šä¸ªå­—ç¬¦çš„å‡½æ•°(ä¹Ÿå¯ä»¥å†™å…¥å•ä¸ªå­—ç¬¦):\n1  int fputs( const char *s, FILE *fp );   å‡½æ•° fputc() æŠŠå‚æ•° c çš„å­—ç¬¦å€¼å†™å…¥åˆ° fp æ‰€æŒ‡å‘çš„è¾“å‡ºæµä¸­ã€‚å¦‚æœå†™å…¥æˆåŠŸï¼Œå®ƒä¼šè¿”å›å†™å…¥çš„å­—ç¬¦ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™ä¼šè¿”å› EOFã€‚\nå‡½æ•° fputs() æŠŠå­—ç¬¦ä¸² s å†™å…¥åˆ° fp æ‰€æŒ‡å‘çš„è¾“å‡ºæµä¸­ã€‚å¦‚æœå†™å…¥æˆåŠŸï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªéè´Ÿå€¼ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™ä¼šè¿”å› EOFã€‚\n ä¾‹å­:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  void write_file_demo() { char fname[10] = \u0026#34;test.txt\u0026#34;; FILE *fp = fopen(fname, \u0026#34;w+\u0026#34;); if (fp == NULL) { printf(\u0026#34;file open fail!\\n\u0026#34;); return; } printf(\u0026#34;file %s open sucessful!\\n\u0026#34;, fname); char ch; int n = 5; printf(\u0026#34;\\nusing fputc()......\\n\u0026#34;); while (n--) { ch = (char)(100+n); if((ch = fputc(ch,fp)) != EOF) printf(\u0026#34;char %c write successful!\\n\u0026#34;,ch); } char str[30] = \u0026#34;\\nIt`s a test for write!\u0026#34;; printf(\u0026#34;\\nusing fputs()......\\n\u0026#34;); int r = fputs(str,fp); if(r \u0026gt;= 0) printf(\u0026#34;str[30] = %s write successful!\\n\u0026#34;,str); fclose(fp); printf(\u0026#34;file %s had be closed!\\n\u0026#34;, fname); }   äºŒè¿›åˆ¶è¾“å‡º:\n1  size_t fwrite(void * buffer, size_t size, size_t count, FILE * stream);    bufferä¸ºæ•°æ®æºåœ°å€ï¼Œsizeä¸ºæ¯ä¸ªå•å…ƒçš„å­—èŠ‚æ•°ï¼Œcountä¸ºå•å…ƒä¸ªæ•°ï¼Œstreamä¸ºæ–‡ä»¶æµæŒ‡é’ˆã€‚\nè¿”å›æˆåŠŸå†™å…¥çš„å•å…ƒä¸ªæ•°ã€‚å¦‚æœå°äºcountï¼Œåˆ™è¯´æ˜å‘ç”Ÿäº†é”™è¯¯ï¼Œæ–‡ä»¶æµé”™è¯¯æ ‡å¿—ä½å°†è¢«è®¾ç½®ï¼Œéšåå¯ä»¥é€šè¿‡ferror()å‡½æ•°åˆ¤æ–­ã€‚\n å‚è€ƒ:\n https://www.runoob.com/cprogramming/c-file-io.html ","description":"","id":38,"section":"posts","tags":["C","æ–‡ä»¶è¯»å†™"],"title":"Cæ–‡ä»¶è¯»å†™","uri":"https://hugo.jiahongw.com/zh/posts/c-read-write/"},{"content":"åœ¨markdownæ–‡ä»¶ä¸­åµŒå…¥htmlä»£ç .ğŸ›¶\nä½¿ç”¨è‡ªå®šä¹‰æ–‡å­—æ ·å¼ è¾“å…¥ä»£ç :\n1  \u0026lt;span style=\u0026#34;font-size:2rem; background:yellow;\u0026#34;\u0026gt;**Bigger**\u0026lt;/span\u0026gt;   Bigger\nè®¾ç½®é”®ç›˜æŒ‰é”® è¾“å…¥ä»£ç :\n1  \u0026lt;kbd\u0026gt;Ctrl\u0026lt;/kbd\u0026gt;+\u0026lt;kbd\u0026gt;F9\u0026lt;/kbd\u0026gt;   Ctrl+F9\nå…¶ä»–ç½‘ç«™æ‘˜å½•çš„html 1  \u0026lt;blockquote class=\u0026#34;twitter-tweet\u0026#34;\u0026gt;\u0026lt;p lang=\u0026#34;en\u0026#34; dir=\u0026#34;ltr\u0026#34;\u0026gt;Sunsets don\u0026amp;#39;t get much better than this one over \u0026lt;a href=\u0026#34;https://twitter.com/GrandTetonNPS?ref_src=twsrc%5Etfw\u0026#34;\u0026gt;@GrandTetonNPS\u0026lt;/a\u0026gt;. \u0026lt;a href=\u0026#34;https://twitter.com/hashtag/nature?src=hash\u0026amp;amp;ref_src=twsrc%5Etfw\u0026#34;\u0026gt;#nature\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;https://twitter.com/hashtag/sunset?src=hash\u0026amp;amp;ref_src=twsrc%5Etfw\u0026#34;\u0026gt;#sunset\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;http://t.co/YuKy2rcjyU\u0026#34;\u0026gt;pic.twitter.com/YuKy2rcjyU\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026amp;mdash; US Department of the Interior (@Interior) \u0026lt;a href=\u0026#34;https://twitter.com/Interior/status/463440424141459456?ref_src=twsrc%5Etfw\u0026#34;\u0026gt;May 5, 2014\u0026lt;/a\u0026gt;\u0026lt;/blockquote\u0026gt; \u0026lt;script async src=\u0026#34;https://platform.twitter.com/widgets.js\u0026#34; charset=\u0026#34;utf-8\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;   Sunsets don\u0026#39;t get much better than this one over @GrandTetonNPS. #nature #sunset pic.twitter.com/YuKy2rcjyU\n\u0026mdash; US Department of the Interior (@Interior) May 5, 2014 ","description":"","id":39,"section":"posts","tags":["markdown","html"],"title":"åœ¨markdownä½¿ç”¨html","uri":"https://hugo.jiahongw.com/zh/posts/markdown-html/"},{"content":"TCP/IPç¼–ç¨‹\n  ç›®æ ‡:  èƒ½è¿›è¡Œç½‘ç»œç¼–ç¨‹\n1.å¦‚æœä½ è¯´ä½ ä¼šselect,epoll,iocpæ¨¡å‹,é‚£ä¼šè®©å¯¹æ–¹è§‰å¾—æ›´é è°±\n2.å¦‚æœä½ è¯´å‡ºä½ åšè¿‡im,ä¸‹è½½ä¹‹ç±»é‚£ä¼šè®©å¯¹æ–¹æ¥å…´è¶£.\n3.å¦‚æœä½ è¯´è®¾è®¡äº†é€šè®¯åè®®,ä¼šè®©å¯¹æ–¹è§‰å¾—æ›´è´´åˆ‡\n4.å¦‚æœä½ è¯´åšè¿‡,ç†Ÿæ‚‰, ftp http snmp smtp è¿™äº›ç®€å•çš„è€å¤è‘£åè®®,ä¼šåŠ åˆ†,ä½†ä¸å¤§.\n5.å¦‚æœä½ è¯´ç†Ÿæ‚‰bt,emule,udtç­‰åè®®,é‚£ä¼šå¯¹ä½ å¾ˆæœ‰å¥½æ„Ÿ.\n6.å¦‚æœä½ è¯´ä½ ç ´è§£è¿‡æŸå¤§ç‰Œ qq,360å†…æŸé€šè®¯åè®®,é‚£ä¼šå¯¹ä½ åŠ åˆ†å¾ˆå¤§.\né˜¶æ®µ:\n1)ç†Ÿæ‚‰TCP/IPåè®®æ—çš„åŸºæœ¬åŸç†\nIPåœ°å€çš„åˆ†ç±»ï¼Œå®šä¹‰ï¼Œè·å¾—ï¼Œå¤§æ¦‚çš„ç®¡ç†æ–¹æ³•\nTCPã€UDPç­‰ä¸»è¦åè®®çš„ç‰¹ç‚¹ï¼Œä¸»è¦æ ¼å¼ï¼Œä»¥åŠé‡è¦å­—æ®µåœ¨åè®®äº¤äº’ä¸­èµ·åˆ°çš„ä½œç”¨ã€‚\n2ï¼‰å¯¹äºç®€å•çš„TCP/IPåè®®å¯¼è‡´çš„é—®é¢˜ï¼Œæœ‰åŸºæœ¬çš„åˆ¤æ–­\nç†Ÿæ‚‰ç½‘ç»œé—®é¢˜çš„è§£å†³æ–¹æ³•ï¼Œä¸€ä¸ªé—®é¢˜ï¼Œåº”è¯¥æ˜¯ç”±ä¸Šè€Œä¸‹ï¼ˆtop-buttonï¼‰ï¼Œè¿˜æ˜¯ç”±ä¸‹è€Œä¸Šï¼ˆbutton-topï¼‰æ¥åˆ†æï¼Ÿ\n3ï¼‰åŸºæœ¬çš„ç¼–ç¨‹çŸ¥è¯†ã€‚\nåœ¨ç³»ç»Ÿå†…ï¼Œæ„å»ºç®€å•é€šä¿¡ã€‚\nåœ¨ç³»ç»Ÿé—´ï¼Œæ„å»ºç®€å•çš„é€šä¿¡ã€‚\nç†Ÿæ‚‰ç³»ç»Ÿå†…çš„APIï¼ŒçŸ¥é“åœ¨ä»€ä¹ˆæ—¶å€™ï¼Œæ”¹ä½¿ç”¨å“ªäº›APIåè°ƒå·¥ä½œã€‚\nèƒ½å¤Ÿç†Ÿç»ƒä½¿ç”¨è¿™äº›APIï¼Œåœ¨ç³»ç»Ÿé—´ä¼ é€’ä¿¡æ¯ï¼Œæ–‡ä»¶ã€‚\nèƒ½å¤Ÿç†Ÿç»ƒä½¿ç”¨è¿™äº›APIï¼Œå®ç°è‡ªå·±çš„ç®€å•çš„ç§æœ‰åè®®ã€‚\n4ï¼‰è¿›é˜¶ç¼–ç¨‹çŸ¥è¯†\nçŸ¥é“ä¸€ä¸¤ä¸ªå·²ç»å°è£…å¥½çš„æ¡†æ¶ï¼ˆframworkï¼‰ï¼Œå®ƒä»¬ä¹‹é—´çš„å·®åˆ«ã€‚\nä½¿ç”¨ä¸€ä¸ªæ¡†æ¶ï¼Œå†™è¿‡èƒ½æ­£å¸¸å·¥ä½œçš„ç¨‹åºã€‚\nçŸ¥é“ç½‘ç»œåè®®å¤„ç†ä¹Ÿæ˜¯è¦è®²ç©¶æ€§èƒ½çš„ï¼ŒçŸ¥é“æ€§èƒ½çš„ç“¶é¢ˆä¼šåœ¨ä»€ä¹ˆåœ°æ–¹äº§ç”Ÿã€‚\nèƒ½æœ‰è¾ƒå¥½çš„è®¾è®¡æŠ€å·§ï¼Œå°†ç§æœ‰åè®®è®¾è®¡å¾—æ›´åŠ å…·æœ‰å¼¹æ€§ï¼Œä¼˜é›…ã€‚\nç†Ÿæ‚‰ç³»ç»Ÿé—´åè®®å¤„ç†çš„ç»†å¾®çš„å·®å¼‚ï¼Œä»¥åŠå°†ä¼šå¯¹ä¸šåŠ¡é€ æˆçš„å½±å“ï¼Œæ—¶å»¶ã€çŠ¶æ€ä¸ä¸€è‡´ã€è‡ªå®šä¹‰å­—æ®µã€ã€ã€ã€ã€\n5ï¼‰ç†Ÿç»ƒé˜¶æ®µçš„çŸ¥è¯†\né’ˆå¯¹ä¸šåŠ¡çš„éœ€æ±‚ï¼Œå¿«é€Ÿé€‰å‹ï¼Œå®šæ¡†æ¶ã€‚\nä¸å†è®¤ä¸ºå¤šçº¿ç¨‹æ˜¯ä¸‡èƒ½çš„ã€‚\nçŸ¥é“ç¨³å®šæ€§æ¯”æ€§èƒ½æ›´åŠ é‡è¦ã€‚\næ•°æ®åŒ…å»äº†å“ªå„¿ï¼Œä¸ç”¨çœ‹ä»£ç ï¼Œä¹Ÿèƒ½é¢„ä¼°å‡ºæ¥ã€‚\n6ï¼‰æºä»£ç æ˜¯æœ€å¥½çš„è€å¸ˆï¼Œæ°¸è¿œéƒ½æ˜¯ã€‚\nä»¥ä¸Šï¼Œå·®ä¸å¤šæˆ–è€…å·²ç»è¾¾åˆ°4ï¼‰çš„æ—¶å€™ï¼Œå°±æ˜¯â€œç†Ÿæ‚‰â€äº†ã€‚\n  ç½‘ç»œæ¨¡å‹ OSIæ¨¡å‹ TCP/IPæ¨¡å‹ ç¤ºä¾‹ åè®®å¯¹åº” æ•°æ®å°è£… C++UDP/TCPå®ä¾‹ å¥—æ¥å­— ä¸ºäº†åŒºåˆ†ä¸åŒåº”ç”¨ç¨‹åºè¿›ç¨‹å’Œè¿æ¥ï¼Œè®¸å¤šè®¡ç®—æœºæ“ä½œç³»ç»Ÿä¸ºåº”ç”¨ç¨‹åºä¸TCP/IPäº¤äº’æä¾›äº†ç§°ä¸º**åµŒå¥—å­—(Socket)**çš„æ¥å£ã€‚\nå¸¸ç”¨çš„TCP/IPæœ‰ä»¥ä¸‹ä¸‰ç§ç±»å‹çš„åµŒå¥—å­—ï¼š\n  æµå¼åµŒå¥—å­—ï¼ˆSOCK_STREAMï¼‰\nç”¨äºæä¾›é¢å‘è¿æ¥çš„ã€å¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œå³ä½¿ç”¨TCPè¿›è¡Œä¼ è¾“ã€‚\n  æ•°æ®æŠ¥åµŒå¥—å­—ï¼ˆSOCK_DGRAMï¼‰\nç”¨äºæä¾›æ— è¿æ¥çš„æœåŠ¡ï¼Œå³ä½¿ç”¨UDPè¿›è¡Œä¼ è¾“ã€‚\n  åŸå§‹åµŒå¥—å­—ï¼ˆSOCK_RAW\nå¯ä»¥è¯»å†™å†…æ ¸æ²¡æœ‰å¤„ç†çš„IPæ•°æ®æŠ¥ï¼Œè€Œæµå¼åµŒå¥—å­—åªèƒ½è¯»å–TCPçš„æ•°æ®ï¼Œæ•°æ®æŠ¥åµŒå¥—å­—åªèƒ½è¯»å–UDPçš„æ•°æ®.\n   å¦‚æœè¦è®¿é—®å…¶å®ƒåè®®å‘é€çš„æ•°æ®å¿…é¡»ä½¿ç”¨åŸå§‹åµŒå¥—å­—ï¼Œå®ƒå…è®¸å¯¹åº•å±‚åè®®(å¦‚IPæˆ–ICMP)ç›´æ¥è®¿é—®\n ç«¯å£å¯¹åº”è¿›ç¨‹ å•å•ä¹‹åipåœ°å€è¿˜ä¸è¶³ä»¥è¾¨è¯†é€šä¿¡çš„ä¸¤ä¸ªè¿›ç¨‹,å› ä¸ºæ“ä½œç³»ç»Ÿæ˜¯å¹¶å‘çš„,ä½¿ç”¨ç«¯å£æ¥è¾¨è®¤æŸä¸ªè¿›ç¨‹.æ‰€ä»¥å¥—æ¥å­—å¿…é¡»çš„ä¸¤ä¸ªä¿¡æ¯ä¸º: ipåœ°å€ + ç«¯å£,ä¾‹å¦‚: 192.168.1.4 1500\nå‚è€ƒ:\n https://www.jianshu.com/p/c1015f5ffa74 è¿›ç¨‹é—´é€šä¿¡ https://segmentfault.com/a/1190000003063859 Linux IOæ¨¡å¼åŠ selectã€pollã€epollè¯¦è§£ https://cloud.tencent.com/developer/article/1373483 å„ç§IOå¤ç”¨æ¨¡å¼ä¹‹selectï¼Œpollï¼Œepollï¼Œkqueueï¼Œiocpåˆ†æ ","description":"","id":40,"section":"posts","tags":["tcp","udp","ç½‘ç»œ"],"title":"Udp-Tcpç¼–ç¨‹","uri":"https://hugo.jiahongw.com/zh/posts/udp-tcp/"},{"content":"æ¯æ¬¡pushéƒ½éœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ,å…¶å®å¯ä»¥å…å»è¿™äº›æ“ä½œ.ğŸš›\n1. ä½¿ç”¨.git-credentialsæ–‡ä»¶ åœ¨gité¡¹ç›®ç›®å½•ä¸‹æ–°å»º.git-credentialsè¿™ä¸ªæ–‡ä»¶,ç„¶ååœ¨é‡Œé¢å¡«å†™ä¸‹é¢å†…å®¹(å¤§æ‹¬å·ä¸ç”¨å¡«å†™):\nhttps://{username}:{password}@github.com ç„¶ååœ¨gité¡¹ç›®ç›®å½•æ‰§è¡Œ:\n1  git config --global credential.helper store   æ‰§è¡Œæ­¤å‘½ä»¤åï¼Œç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„.gitconfigæ–‡ä»¶ä¼šå¤šäº†ä¸€é¡¹ï¼š[credential]\nhelper = store  æ³¨æ„: Linuxç”¨æˆ·ä¸»ç›®å½•ä¸€èˆ¬åœ¨~/ä¸‹,è€ŒWindowsä¸‹ä¸€èˆ¬ä¸ºC:\\users\\Administrator\n è¿™æ ·ä»¥åpushå°±ä¸éœ€è¦ç”¨æˆ·åå’Œå¯†ç äº†\n2. ä½¿ç”¨sshåè®® é¦–å…ˆç”Ÿæˆå¯†é’¥å¯¹,æ‰§è¡Œ\n1  ssh-keygen -t rsa -C \u0026#34;youremail\u0026#34;   æ¥ä¸‹æ¥æŒ‰ç…§æç¤ºæ“ä½œï¼Œé»˜è®¤å¯ä»¥ä¸€è·¯å¾€ä¸‹ã€‚\nç„¶åå°†ç”Ÿæˆçš„ä½äº~/.ssh/çš„id_rsa.pubçš„å†…å®¹å¤åˆ¶åˆ°ä½ github settingé‡Œçš„ssh keyä¸­ã€‚\nå¤åˆ¶ä¹‹åï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰å…‹éš†ä½ çš„ä»“åº“ï¼Œé‚£ä½ ç›´æ¥ä½¿ç”¨sshåè®®ç”¨æ³•ï¼šgit@github.com:yourusername/yourrepositorynameå…‹éš†å°±è¡Œäº†ã€‚\nå¦‚æœå·²ç»ä½¿ç”¨httpsåè®®å…‹éš†äº†ï¼Œé‚£ä¹ˆæŒ‰ç…§å¦‚ä¸‹æ–¹æ³•æ›´æ”¹åè®®ï¼š\ngit remote set-url origin git@github.com:yourusername/yourrepositoryname.git\nDone!\n3. ç®¡ç†å¤šgitè´¦å· å‚è€ƒ:\n https://www.jianshu.com/p/f7f4142a1556 ç®€ä¹¦ https://segmentfault.com/a/1190000012432367 https://juejin.im/post/5d6a23d45188252bd90f601a æ˜é‡‘ https://www.cnblogs.com/popfisher/p/5731232.html ","description":"","id":41,"section":"posts","tags":["git","github"],"title":"Gitå…å¯†push","uri":"https://hugo.jiahongw.com/zh/posts/git-push-no-pw/"},{"content":"AESç®—æ³•æ˜¯ç»§DESä¹‹åæ¯”è¾ƒå¿«ä¸”æ¯”è¾ƒç®€å•çš„åŠ å¯†ç®—æ³•.âš–\nå¯¹ç§°åŠ å¯† å¯¹ç§°åŠ å¯†æ¨¡å‹ å¦‚ä¸‹å›¾ï¼Œå‘é€è€…å’Œæ¥æ”¶è€…å…±äº«ä¸€ä¸ªä¸€æ ·çš„å¯†é’¥ï¼Œç›¸å½“äºç°å®ç”Ÿæ´»ä¸­çš„é”ï¼Œ\nå¯¹ç§°åŠ å¯†çš„ä½¿ç”¨è¦æ±‚  ä¸€ä¸ªå¼ºåŠ å¯†ç®—æ³• åªæœ‰å‘é€å‘å’Œæ¥æ”¶æ–¹çŸ¥é“ç§é’¥   åŠ å¯†ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œä¸éœ€ä¿å¯†ï¼›å¹¶ä¸”è§£å¯†ç®—æ³•æœ¬è´¨ä¸Šæ˜¯åŠ å¯†ç®—æ³•çš„åå‘æ‰§è¡Œã€‚\n ä½†æ˜¯ï¼Œå¦‚ä½•å®‰å…¨çš„åˆ†å‘å®‰å…¨å¯†é’¥å‘¢ï¼Ÿâ€”â€”â€”â€”â€”â€”å®‰å…¨åˆ†å‘ä¸å¯èƒ½å•é å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œå¸¸å¸¸ä½¿ç”¨çš„æ˜¯éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚\næ‰€ä»¥ï¼Œå¯¹ç§°åŠ å¯†çš„å®‰å…¨æ€§å–å†³äºå¯†é’¥çš„ä¿å¯†æ€§è€Œéç®—æ³•çš„ä¿å¯†æ€§ï¼Œé€šå¸¸è®¤ä¸ºå·²çŸ¥å¯†æ–‡å’ŒåŠ å¯†/åŠ å¯†ç®—æ³•çš„åŸºç¡€ä¸Šä¸èƒ½å¤Ÿç ´è¯‘ä¿¡æ¯ã€‚\nAESç®—æ³• ç®—æ³•åŸç†ï¼š AESå¯†ç ä¸åˆ†ç»„å¯†ç RijndaelåŸºæœ¬ä¸Šå®Œå…¨ä¸€è‡´ï¼ŒRijndaelåˆ†ç»„å¤§å°å’Œå¯†é’¥å¤§å°éƒ½å¯ä»¥ä¸º128ä½ã€192ä½å’Œ256ä½ã€‚ç„¶è€ŒAESåªè¦æ±‚åˆ†ç»„å¤§å°ä¸º128ä½ï¼Œå› æ­¤åªæœ‰åˆ†ç»„é•¿åº¦ä¸º128Bitçš„Rijndaelæ‰ç§°ä¸ºAESç®—æ³•ã€‚\nä¸‹é¢æ˜¯åˆ†ç»„é•¿åº¦ä¸º128ä½çš„AESç®—æ³•,è€Œkeyä½æ•°å¯ä»¥æ˜¯128/192/256,æœ¬æ¬¡å®éªŒé€‰æ‹©keyçš„å¤§å°ä½128ä½.\nç‰¹ç‚¹  æ˜æ–‡åˆ†ç»„è¢«æè¿°ä¸ºä¸€ä¸ªå­—èŠ‚æ–¹é˜µå¹¶å¤åˆ¶åˆ°çŠ¶æ€æ•°ç»„ï¼Œåœ¨æ¯è½®æ›¿æ¢å’Œç§»ä½æ—¶éƒ½å¹¶è¡Œå¤„ç†æ•´ä¸ªçŠ¶æ€åˆ†ç»„ã€‚ çŸ©é˜µä¸­å­—èŠ‚çš„é¡ºåºæ˜¯æŒ‰åˆ—æ’åºçš„ï¼Œä¾‹å¦‚128æ¯”ç‰¹çš„æ˜æ–‡åˆ†ç»„çš„å‰4ä¸ªå­—èŠ‚å è¾“å…¥çŸ©é˜µçš„ç¬¬ä¸€åˆ—ï¼Œæ¥ä¸‹æ¥çš„4ä¸ªå­—èŠ‚å ç¬¬äºŒåˆ—ï¼Œä¾æ¬¡ç±»æ¨ã€‚æ‰©å±•å­å¯†é’¥æ•°ç»„ä¹Ÿç±»ä¼¼æ“ä½œã€‚ å‡è®¾AESä½¿ç”¨128æ¯”ç‰¹çš„å¯†é’¥ï¼Œå…¶å¯†é’¥è¢«æè¿°ä¸ºä¸€ä¸ªå­—èŠ‚æ–¹é˜µå¹¶å°†æ‰©å±•æˆä¸ºä¸€ä¸ªå­å¯†é’¥æ•°ç»„w[i]ï¼ˆå…·æœ‰44ä¸ª32æ¯”ç‰¹å­—ï¼‰ï¼Œ4ä¸ªä¸åŒçš„å­—ï¼ˆå…±128æ¯”ç‰¹ï¼‰ç”¨ä½œæ¯è½®çš„è½®å¯†é’¥ã€‚ AESåœ¨æ¯è½®è¿ç®—ä¸­å°†è¿›è¡Œ4ä¸ªä¸åŒçš„æ­¥éª¤ï¼Œ1ä¸ªæ˜¯ç§»ä½ï¼Œ3ä¸ªæ˜¯æ›¿æ¢ã€‚  æ•°å­¦çŸ¥è¯† åœ¨AESç®—æ³•ä¸­çš„MixColumnå±‚ä¸­ä¼šç”¨åˆ°ä¼½ç½—ç“¦åŸŸä¸­çš„ä¹˜æ³•è¿ç®—ï¼Œè€Œä¼½ç½—ç“¦åŸŸçš„è¿ç®—æ¶‰åŠä¸€äº›æ•°å­¦çŸ¥è¯†ã€‚\nç´ åŸŸ æœ‰é™åŸŸæœ‰æ—¶ä¹Ÿç§°ä¼½ç½—ç“¦åŸŸï¼Œå®ƒæŒ‡çš„æ˜¯ç”±æœ‰é™ä¸ªå…ƒç´ ç»„æˆçš„é›†åˆï¼Œåœ¨è¿™ä¸ªé›†åˆå†…å¯ä»¥æ‰§è¡ŒåŠ ã€å‡ã€ä¹˜å’Œé€†è¿ç®—ã€‚è€Œåœ¨å¯†ç ç¼–ç å­¦ä¸­ï¼Œæˆ‘ä»¬åªç ”ç©¶æ‹¥æœ‰æœ‰é™ä¸ªå…ƒç´ çš„åŸŸï¼Œä¹Ÿå°±æ˜¯æœ‰é™åŸŸã€‚åŸŸä¸­åŒ…å«å…ƒç´ çš„ä¸ªæ•°ç§°ä¸ºåŸŸçš„é˜¶ã€‚åªæœ‰å½“mæ˜¯ä¸€ä¸ªç´ æ•°å¹‚æ—¶ï¼Œå³$m=p^n$(å…¶ä¸­nä¸ºæ­£æ•´æ•°æ˜¯pçš„æ¬¡æ•°ï¼Œpä¸ºç´ æ•°)ï¼Œé˜¶ä¸ºmçš„åŸŸæ‰å­˜åœ¨ã€‚pç§°ä¸ºè¿™ä¸ªæœ‰é™åŸŸçš„ç‰¹å¾ã€‚\nä¾‹å¦‚ï¼Œæœ‰é™åŸŸä¸­å…ƒç´ çš„ä¸ªæ•°å¯ä»¥æ˜¯11(p=11æ˜¯ä¸€ä¸ªç´ æ•°,n=1)ã€å¯ä»¥æ˜¯81(p=3æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œn=4)ã€ä¹Ÿå¯ä»¥æ˜¯256(p=2æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œn=8)\u0026hellip;..ä½†æœ‰é™åŸŸçš„ä¸­ä¸å¯èƒ½æ‹¥æœ‰12ä¸ªå…ƒç´ ï¼Œå› ä¸º12=2Â·2Â·3ï¼Œå› æ­¤12ä¹Ÿä¸æ˜¯ä¸€ä¸ªç´ æ•°å¹‚ã€‚å› æ­¤æ»¡è¶³pæ˜¯ä¸€ä¸ªç´ æ•°ä¸”æ»¡è¶³$m = p^n$è¿™ä¸ªå…¬å¼ï¼Œmæ‰æ˜¯ä¸€ä¸ªç´ æ•°å¹‚ã€‚\næœ‰é™åŸŸä¸­æœ€ç›´è§‚çš„ä¾‹å­å°±æ˜¯é˜¶ä¸ºç´ æ•°çš„åŸŸï¼Œå³n=1çš„åŸŸã€‚åŸŸGF(p)çš„å…ƒç´ å¯ä»¥ç”¨æ•´æ•°0ã€1ã€\u0026hellip;ã€p-1læ¥è¡¨ç¤ºã€‚åŸŸçš„ä¸¤ç§æ“ä½œå°±æ˜¯æ¨¡æ•´æ•°åŠ æ³•å’Œæ•´æ•°ä¹˜æ³•æ¨¡pã€‚åŠ ä¸Špæ˜¯ä¸€ä¸ªç´ æ•°ï¼Œæ•´æ•°ç¯Zè¡¨ç¤ºä¸ºGF(p)ï¼Œä¹Ÿæˆä¸ºæ‹¥æœ‰ç´ æ•°ä¸ªå…ƒç´ çš„ç´ æ•°åŸŸæˆ–è€…ä¼½ç½—ç“¦åŸŸã€‚GF(p)ä¸­æ‰€æœ‰çš„éé›¶å…ƒç´ éƒ½å­˜åœ¨é€†å…ƒï¼ŒGF(p)å†…æ‰€æœ‰çš„è¿ç®—éƒ½æ˜¯æ¨¡på®ç°çš„ã€‚\nç´ åŸŸå†…çš„ç®—æ•°è¿ç®—è§„åˆ™å¦‚ä¸‹  åŠ æ³•å’Œä¹˜æ³•éƒ½æ˜¯é€šè¿‡æ¨¡på®ç°çš„ï¼› ä»»ä½•ä¸€ä¸ªå…ƒç´ açš„åŠ æ³•é€†å…ƒéƒ½æ˜¯ç”±a+(açš„é€†å…ƒ)=0 mod på¾—åˆ°çš„ï¼› ä»»ä½•ä¸€ä¸ªéé›¶å…ƒç´ açš„ä¹˜æ³•é€†å…ƒå®šä¹‰ä¸ºaÂ·açš„é€†å…ƒ=1ã€‚  ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ç´ åŸŸGF(5)={0ã€1ã€2ã€3ã€4}ä¸­ï¼Œ2çš„åŠ æ³•é€†å…ƒä¸º3ï¼Œè¿™æ˜¯å› ä¸º2+(3)=5ï¼Œ5mod5=0,æ‰€ä»¥2+3=5mod5=0ã€‚2çš„ä¹˜æ³•é€†å…ƒä¸º3ï¼Œè¿™æ˜¯å› ä¸º2Â·3=6ï¼Œ6mod5=1ï¼Œæ‰€ä»¥2Â·3=6mod5=1ã€‚(åœ¨å¾ˆå¤šåœ°æ–¹açš„åŠ æ³•é€†å…ƒ1ç”¨$-a$è¡¨ç¤ºï¼Œaçš„ä¹˜æ³•é€†å…ƒ2ç”¨$1/a$è¡¨ç¤º)\n æ³¨ï¼šGF(2)æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç´ åŸŸï¼Œä¹Ÿæ˜¯å­˜åœ¨çš„æœ€å°çš„æœ‰é™åŸŸï¼Œç”±äºGF(2)çš„åŠ æ³•ï¼Œå³æ¨¡2åŠ æ³•ä¸å¼‚æˆ–(XOR)é—¨ç­‰ä»·ï¼ŒGF(2)çš„ä¹˜æ³•ä¸é€»è¾‘ä¸(AND)é—¨ç­‰ä»·ï¼Œæ‰€ä»¥GF(2)å¯¹AESéå¸¸é‡è¦ã€‚\næ¨¡2åŠ æ³•ä¸å¼‚æˆ–(XOR)é—¨ç­‰ä»·:\n$$\n(1 + 0) \\mod 2 = 1\\\\\n(0 + 1) \\mod 2 = 1\\\\\n(0 + 0) \\mod 2 = 0\\\\\n(1 + 1) \\mod 2 = 0\\\\\n$$\nä¹˜æ³•ä¸é€»è¾‘ä¸(AND)é—¨ç­‰ä»·:\n$$\n(1 \\times 0) \\mod 2 = 0\\\\\n(0 \\times 1) \\mod 2 = 0\\\\\n(0 \\times 0) \\mod 2 = 0\\\\\n(1 \\times 1) \\mod 2 = 1\\\\\n$$\n æ‰©å±•åŸŸ å¦‚æœæœ‰é™åŸŸçš„é˜¶ä¸æ˜¯ç´ æ•°ï¼Œåˆ™è¿™æ ·çš„æœ‰é™åŸŸå†…çš„åŠ æ³•å’Œä¹˜æ³•è¿ç®—å°±ä¸èƒ½ç”¨æ¨¡æ•´æ•°åŠ æ³•å’Œæ•´æ•°ä¹˜æ³•æ¨¡pè¡¨ç¤ºã€‚è€Œä¸”m\u0026gt;1çš„åŸŸè¢«ç§°ä¸ºæ‰©å±•åŸŸï¼Œä¸ºäº†å¤„ç†æ‰©å±•åŸŸï¼Œæˆ‘ä»¬å°±è¦ä½¿ç”¨ä¸åŒçš„ç¬¦å·è¡¨ç¤ºæ‰©å±•åŸŸå†…çš„å…ƒç´ ï¼Œä½¿ç”¨ä¸åŒçš„è§„åˆ™æ‰§è¡Œæ‰©å±•åŸŸå†…å…ƒç´ çš„ç®—æœ¯è¿ç®—ã€‚\nåœ¨æ‰©å±•åŸŸ$GF(2^m)$ä¸­ï¼Œå…ƒç´ å¹¶ä¸æ˜¯ç”¨æ•´æ•°è¡¨ç¤ºçš„ï¼Œè€Œæ˜¯ç”¨ç³»æ•°ä¸ºåŸŸ$GF(2)$ä¸­å…ƒç´ çš„å¤šé¡¹å¼è¡¨ç¤ºã€‚è¿™ä¸ªå¤šé¡¹å¼æœ€å¤§çš„åº¦(å¹‚)ä¸ºm-1â€‹ï¼Œæ‰€ä»¥æ¯ä¸ªå…ƒç´ å…±æœ‰mä¸ªç³»æ•°ï¼Œåœ¨AESç®—æ³•ä½¿ç”¨çš„åŸŸ$GF(2^8)$ä¸­ï¼Œæ¯ä¸ªå…ƒç´ $AâˆˆGF(2^8)$éƒ½å¯ä»¥è¡¨ç¤ºä¸ºï¼š\n$$\nA(x) = a_7x^7 + a_6x^6 + a_5x^5 + a_4x^4 + a_3x^3 + a_2x^2+a_1x + a_0,x_i \\in GF(2) = 0,1\n$$\næ³¨æ„ï¼šåœ¨åŸŸGF(2^8)ä¸­è¿™æ ·çš„å¤šé¡¹å¼å…±æœ‰256ä¸ªï¼Œè¿™256ä¸ªå¤šé¡¹å¼ç»„æˆçš„é›†åˆå°±æ˜¯æ‰©å±•åŸŸGF(2^8)ã€‚æ¯ä¸ªå¤šé¡¹å¼éƒ½å¯ä»¥æŒ‰ä¸€ä¸ª8ä½é¡¹é“¾çš„æ•°å€¼å½¢å¼å­˜å‚¨ï¼š\n$$\nA = (a_7,a_6,a_5,a_4,a_3,a_2,a_1,a_0)\n$$\nåƒ$x^7$ã€$x^6$ç­‰å› å­éƒ½æ— éœ€å­˜å‚¨ï¼Œå› ä¸ºä»ä½çš„ä½ç½®å°±å¯ä»¥æ¸…æ¥šåœ°åˆ¤æ–­å‡ºæ¯ä¸ªç³»æ•°å¯¹åº”çš„å¹‚ã€‚\næ‰©å±•åŸŸ$GF(2^m)$å†…çš„åŠ å‡æ³• åœ¨AESç®—æ³•ä¸­çš„å¯†é’¥åŠ æ³•å±‚ä¸­å°±ä½¿ç”¨äº†è¿™éƒ¨åˆ†çš„çŸ¥è¯†ï¼Œä½†æ˜¯ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œå› ä¸ºæˆ‘ä»¬é€šå¸¸æŠŠæ‰©å±•åŸŸä¸­çš„åŠ æ³•å½“ä½œå¼‚æˆ–è¿ç®—è¿›è¡Œå¤„ç†äº†ï¼Œå› ä¸ºåœ¨æ‰©å±•åŸŸä¸­çš„åŠ å‡æ³•å¤„ç†éƒ½æ˜¯åœ¨åº•å±‚åŸŸGF(2)å†…å®Œæˆçš„ï¼Œä¸æŒ‰ä½å¼‚æˆ–è¿ç®—ç­‰ä»·ã€‚å‡è®¾$A(x)$ã€$B(x)âˆˆGF(2^m)$ï¼Œè®¡ç®—ä¸¤ä¸ªå…ƒç´ ä¹‹å’Œçš„æ–¹æ³•å°±æ˜¯ï¼š\n$$\nC(x) = A(x) + B(x) = \\sum_{i=0}^{m-1}C_ix^i , c_i = (a_i + b_i) \\mod 2\n$$\nè€Œä¸¤ä¸ªå…ƒç´ ä¹‹å·®çš„è®¡ç®—å…¬å¼å°±æ˜¯ï¼š\n$$\nC(x) = A(x) - B(x) = \\sum_{i=0}^{m-1}C_ix^i , c_i = (a_i - b_i) \\mod 2 = (a_i + b_i) \\mod 2\n$$\n æ³¨ï¼šåœ¨å‡æ³•è¿ç®—ä¸­å‡å·ä¹‹æ‰€ä»¥å˜æˆåŠ å·ï¼Œè¿™å°±å’ŒäºŒè¿›åˆ¶å‡æ³•çš„æ€§è´¨æœ‰å…³äº†ï¼Œå¤§å®¶å¯ä»¥è¯•ç€éªŒç®—ä¸‹ã€‚ä»ä¸Šè¿°ä¸¤ä¸ªå…¬å¼ä¸­æˆ‘ä»¬å‘ç°åœ¨æ‰©å±•åŸŸä¸­åŠ æ³•å’Œå‡æ³•ç­‰ä»·ï¼Œå¹¶ä¸”ä¸XORç­‰ä»·(å¼‚æˆ–è¿ç®—ä¹Ÿè¢«ç§°ä½œäºŒè¿›åˆ¶åŠ æ³•)ã€‚\n æ‰©å±•åŸŸGF(2^m)å†…çš„ä¹˜æ³• æ‰©å±•åŸŸçš„ä¹˜æ³•ä¸»è¦è¿ç”¨åœ¨AESç®—æ³•çš„åˆ—æ··æ·†å±‚(Mix Column)ä¸­ï¼Œä¹Ÿæ˜¯åˆ—æ··æ·†å±‚ä¸­æœ€é‡è¦çš„æ“ä½œã€‚æˆ‘ä»¬é¡¹è¦å°†æ‰©å±•åŸŸä¸­çš„ä¸¤ä¸ªå…ƒç´ ç”¨å¤šé¡¹å¼å½¢å¼å±•å¼€ï¼Œç„¶åä½¿ç”¨æ ‡å‡†çš„å¤šé¡¹å¼ä¹˜æ³•è§„åˆ™å°†ä¸¤ä¸ªå¤šé¡¹å¼ç›¸ä¹˜ï¼š\nAESæ­¥éª¤è¯¦è§£ AESç®—æ³•ä¸»è¦æœ‰å››ç§æ“ä½œå¤„ç†ï¼Œåˆ†åˆ«æ˜¯å¯†é’¥åŠ æ³•å±‚(ä¹Ÿå«è½®å¯†é’¥åŠ ï¼Œè‹±æ–‡Add Round Key)ã€å­—èŠ‚ä»£æ¢å±‚(SubByte)ã€è¡Œä½ç§»å±‚(Shift Rows)ã€åˆ—æ··æ·†å±‚(Mix Column)ã€‚è€Œæ˜æ–‡xå’Œå¯†é’¥kéƒ½æ˜¯ç”±16ä¸ªå­—èŠ‚ç»„æˆçš„æ•°æ®(å½“ç„¶å¯†é’¥è¿˜æ”¯æŒ192ä½å’Œ256ä½çš„é•¿åº¦)ï¼Œå®ƒæ˜¯æŒ‰ç…§å­—èŠ‚çš„å…ˆåé¡ºåºä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³è¿›è¡Œæ’åˆ—çš„ã€‚è€ŒåŠ å¯†å‡ºçš„å¯†æ–‡è¯»å–é¡ºåºä¹Ÿæ˜¯æŒ‰ç…§è¿™ä¸ªé¡ºåºè¯»å–çš„ï¼Œç›¸å½“äºå°†æ•°ç»„è¿˜åŸæˆå­—ç¬¦ä¸²çš„æ¨¡æ ·äº†ï¼Œç„¶åå†è§£å¯†çš„æ—¶å€™åˆæ˜¯æŒ‰ç…§4Â·4æ•°ç»„å¤„ç†çš„ã€‚AESç®—æ³•åœ¨å¤„ç†çš„è½®æ•°ä¸Šåªæœ‰æœ€åä¸€è½®æ“ä½œä¸å‰é¢çš„è½®å¤„ç†ä¸Šæœ‰äº›è®¸ä¸åŒ(æœ€åä¸€è½®åªæ˜¯å°‘äº†åˆ—æ··æ·†å¤„ç†)ï¼Œåœ¨è½®å¤„ç†å¼€å§‹å‰è¿˜å•ç‹¬è¿›è¡Œäº†ä¸€æ¬¡è½®å¯†é’¥åŠ çš„å¤„ç†ã€‚åœ¨å¤„ç†è½®æ•°ä¸Šï¼Œåªè€ƒè™‘128ä½å¯†é’¥çš„10è½®å¤„ç†ã€‚\nå…¶ä¸­å­—èŠ‚æ’åˆ—æ–¹å¼éœ€è¦æŒ‰ç…§å¦‚ä¸‹è½¬æ¢:\nAESç®—æ³•æµç¨‹å›¾å¦‚ä¸‹:\nå®ç°æ­¥éª¤åŠä»£ç  æŒ‰ç…§AESæµç¨‹å›¾,å¯¹æ¯ä¸€å±‚çš„ä»£ç è¿›è¡Œå®ç°.\nå¯†é’¥åŠ æ³•å±‚ åœ¨å¯†é’¥åŠ æ³•å±‚ä¸­æœ‰ä¸¤ä¸ªè¾“å…¥çš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯æ˜æ–‡å’Œå­å¯†é’¥k[0]ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªè¾“å…¥éƒ½æ˜¯128ä½çš„ã€‚åœ¨æ‰©å±•åŸŸä¸­åŠ å‡æ³•æ“ä½œå’Œå¼‚æˆ–è¿ç®—ç­‰ä»·ï¼Œæ‰€ä»¥è¿™é‡Œçš„å¤„ç†ä¹Ÿå°±å¼‚å¸¸çš„ç®€å•äº†ï¼Œåªéœ€è¦å°†ä¸¤ä¸ªè¾“å…¥çš„æ•°æ®è¿›è¡ŒæŒ‰å­—èŠ‚å¼‚æˆ–æ“ä½œå°±ä¼šå¾—åˆ°è¿ç®—çš„ç»“æœã€‚\nå¦‚ä¸‹å›¾ï¼š\nä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  //è½®å¯†é’¥åŠ å˜æ¢ - å°†æ¯ä¸€åˆ—ä¸æ‰©å±•å¯†é’¥è¿›è¡Œå¼‚æˆ– void AddRoundKey(byte mtx[4 * 4], word k[4]) { for (int i = 0; i \u0026lt; 4; ++i) { word k1 = k[i] \u0026gt;\u0026gt; 24; word k2 = (k[i] \u0026lt;\u0026lt; 8) \u0026gt;\u0026gt; 24; word k3 = (k[i] \u0026lt;\u0026lt; 16) \u0026gt;\u0026gt; 24; word k4 = (k[i] \u0026lt;\u0026lt; 24) \u0026gt;\u0026gt; 24; mtx[i] = mtx[i] ^ byte(k1.to_ulong()); mtx[i + 4] = mtx[i + 4] ^ byte(k2.to_ulong()); mtx[i + 8] = mtx[i + 8] ^ byte(k3.to_ulong()); mtx[i + 12] = mtx[i + 12] ^ byte(k4.to_ulong()); } }   AESå¯†é’¥ç”Ÿæˆ é¦–å…ˆå®šä¹‰ä½ç½®å˜æ¢å‡½æ•°RotWord(),ä½œç”¨æ˜¯æ¥å—ä¸€ä¸ªå­— $[a0, a1, a2, a3] $ä½œä¸ºè¾“å…¥ï¼Œå¾ªç¯å·¦ç§»ä¸€ä¸ªå­—èŠ‚åè¾“å‡º$ [a1, a2, a3, a0]$,ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6  word RotWord(const word \u0026amp;w) { word result(0x0); result = (w \u0026lt;\u0026lt; 8) | (w \u0026gt;\u0026gt; 24); return result; }   å®šä¹‰Sç›’å˜æ¢å‡½æ•°SubWord()ï¼Œæ¥å—ä¸€ä¸ªå­— $[a0, a1, a2, a3]$ ä½œä¸ºè¾“å…¥ï¼Œç„¶åæ¯ä¸€ä¸ªbyteï¼Œä¾‹å¦‚a0ï¼Œå‰å››ä¸ªå­—èŠ‚ä¸ºè¡Œï¼Œåå››ä¸ªå­—èŠ‚ä¸ºåˆ—ï¼Œä»S_Boxä¸­æŸ¥æ‰¾å¹¶ä¸”è¿”å›å››ä¸ªå…ƒç´ ã€‚ï¼Œä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13  word SubWord(const word\u0026amp; sw) { word temp; for(int i=0; i\u0026lt;32; i+=8) { int row = sw[i+7]*8 + sw[i+6]*4 + sw[i+5]*2 + sw[i+4]; int col = sw[i+3]*8 + sw[i+2]*4 + sw[i+1]*2 + sw[i]; byte val = S_Box[row][col]; for(int j=0; j\u0026lt;8; ++j) temp[i+j] = val[j]; } return temp; }   è½®å¸¸æ•°Rcon[]ä½œä¸ºä¸€ä¸ªå¸¸é‡æ•°ç»„ï¼Œæ¯ä¸€è½®ç”Ÿæˆå¯†é’¥çš„æ—¶å€™éœ€è¦ä½œä¸ºå‚æ•°å¼‚æˆ–\n1 2 3  // è½®å¸¸æ•°ï¼Œå¯†é’¥æ‰©å±•ä¸­ç”¨åˆ°ã€‚ï¼ˆAES-128åªéœ€è¦10è½®ï¼‰ word Rcon[10] = {0x01000000, 0x02000000, 0x04000000, 0x08000000, 0x10000000, 0x20000000, 0x40000000, 0x80000000, 0x1b000000, 0x36000000};   å¯†é’¥æ‹“å±•å‡½æ•°KeyExpansion(),æ¥å—ä¸€ä¸ªå‚æ•°ä¸ºå¤–éƒ¨å¯†é’¥ï¼Œå¦å¤–ä¸€ä¸ªä¸ºéœ€è¦æ‹“å±•çš„è½®å¯†é’¥æ•°ç»„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  //å¯†é’¥æ‰©å±•å‡½æ•° - å¯¹128ä½å¯†é’¥è¿›è¡Œæ‰©å±•å¾—åˆ° w[4*(Nr+1),Nrä¸ºè½®æ•° void KeyExpansion(byte key[4 * N_key], word w[4 * (N_round + 1)]) { word temp; int i = 0; while (i \u0026lt; N_key)\t//å‰å››ä¸ªwordå°±æ˜¯è¾“å…¥çš„key  { w[i] = ToWord(key[4 * i], key[4 * i + 1], key[4 * i + 2], key[4 * i + 3]); ++i; } i = N_key; while (i \u0026lt; 4 * (N_round + 1)) { temp = w[i - 1]; //è®°å½•å‰ä¸€ä¸ªword  if (i % N_key == 0) { //tempå…ˆä½ç½®è¡¨æ¢RotWordï¼Œå†Sç›’å˜æ¢ï¼Œç„¶åä¸è½®å¸¸æ•°å¼‚æˆ–ï¼Œæœ€åw[i-N_key] å¼‚æˆ–  w[i] = w[i - N_key] ^ SubWord(RotWord(temp)) ^ Rcon[i / N_key - 1]; } else { w[i] = w[i - N_key] ^ temp; } i++; } }   å­—èŠ‚æ›¿æ¢å±‚ Sç›’å­—èŠ‚æ›¿æ¢ï¼Œä¸»è¦åŠŸèƒ½å°±æ˜¯è®©è¾“å…¥çš„æ•°æ®é€šè¿‡S_boxè¡¨å®Œæˆä»ä¸€ä¸ªå­—èŠ‚åˆ°å¦ä¸€ä¸ªå­—èŠ‚çš„æ˜ å°„ï¼Œè¯»å–S_boxæ•°æ®çš„æ–¹æ³•å°±æ˜¯è¦å°†è¾“å…¥æ•°æ®çš„æ¯ä¸ªå­—èŠ‚çš„é«˜å››ä½ä½œä¸ºç¬¬ä¸€ä¸ªä¸‹æ ‡ï¼Œç¬¬å››ä½ä½œä¸ºç¬¬äºŒä¸ªä¸‹æ ‡ã€‚ç„¶åè¿”å›æ•°æ®ï¼Œå­—èŠ‚æ›¿æ¢ä¸»è¦æ˜¯ä¸ºäº†æ‰°ä¹±æ•°æ®ã€‚\nSç›’ï¼š\né€†Sç›’ï¼š\nå›¾è§£å¦‚ä¸‹ï¼š\næ­£å‘Sç›’å˜æ¢ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10  //Sç›’å˜æ¢ - å‰4ä½ä¸ºè¡Œå·ï¼Œå4ä½ä¸ºåˆ—å· void SubBytes(byte mtx[4 * 4]) { for (int i = 0; i \u0026lt; 16; ++i) { int row = mtx[i][7] * 8 + mtx[i][6] * 4 + mtx[i][5] * 2 + mtx[i][4]; int col = mtx[i][3] * 8 + mtx[i][2] * 4 + mtx[i][1] * 2 + mtx[i][0]; mtx[i] = S_Box[row][col]; } }   åå‘Sç›’å˜æ¢ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10  // é€†Sç›’å˜æ¢ void InvSubBytes(byte mtx[4*4]) { for(int i=0; i\u0026lt;16; ++i) { int row = mtx[i][7]*8 + mtx[i][6]*4 + mtx[i][5]*2 + mtx[i][4]; int col = mtx[i][3]*8 + mtx[i][2]*4 + mtx[i][1]*2 + mtx[i][0]; mtx[i] = Inv_S_Box[row][col]; } }   è¡Œç§»ä½å±‚ å°†è¾“å…¥æ•°æ®ä½œä¸ºä¸€ä¸ª$4Â·4$çš„å­—èŠ‚çŸ©é˜µè¿›è¡Œå¤„ç†ï¼Œç„¶åå°†è¿™ä¸ªçŸ©é˜µçš„å­—èŠ‚è¿›è¡Œä½ç½®ä¸Šçš„ç½®æ¢ã€‚åœ¨åŠ å¯†æ—¶è¡Œä½ç§»å¤„ç†ä¸è§£å¯†æ—¶çš„å¤„ç†ç›¸åï¼Œæˆ‘ä»¬è¿™é‡Œå°†è§£å¯†æ—¶çš„å¤„ç†ç§°ä½œé€†è¡Œä½ç§»ã€‚å®ƒä¹‹æ‰€ä»¥ç§°ä½œè¡Œä½ç§»ï¼Œæ˜¯å› ä¸ºå®ƒåªåœ¨$4Â·4$çŸ©é˜µçš„è¡Œé—´è¿›è¡Œæ“ä½œï¼Œæ¯è¡Œ4å­—èŠ‚çš„æ•°æ®ã€‚åœ¨åŠ å¯†æ—¶ï¼Œä¿æŒçŸ©é˜µçš„ç¬¬ä¸€è¡Œä¸å˜ï¼Œç¬¬äºŒè¡Œå‘å·¦ç§»åŠ¨8Bit(ä¸€ä¸ªå­—èŠ‚)ã€ç¬¬ä¸‰è¡Œå‘å·¦ç§»åŠ¨2ä¸ªå­—èŠ‚ã€ç¬¬å››è¡Œå‘å·¦ç§»åŠ¨3ä¸ªå­—èŠ‚ã€‚è€Œåœ¨è§£å¯†æ—¶æ°æ°ç›¸åï¼Œä¾ç„¶ä¿æŒç¬¬ä¸€è¡Œä¸å˜ï¼Œå°†ç¬¬äºŒè¡Œå‘å³ç§»åŠ¨ä¸€ä¸ªå­—èŠ‚ã€ç¬¬ä¸‰è¡Œå³ç§»2ä¸ªå­—èŠ‚ã€ç¬¬å››è¡Œå³ç§»3ä¸ªå­—èŠ‚ã€‚æœ€ç»ˆç»“æŸã€‚\næ­£å‘è¡Œç§»ä½å›¾è§£ï¼š\nä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  //æ­£å‘è¡Œå˜æ¢ - æŒ‰å­—èŠ‚å¾ªç¯ç§»ä½ void ShiftRows(byte mtx[4 * 4]) { // ç¬¬äºŒè¡Œå¾ªç¯å·¦ç§»ä¸€ä½  byte temp = mtx[4]; for (int i = 0; i \u0026lt; 3; ++i) mtx[i + 4] = mtx[i + 5]; mtx[7] = temp; // ç¬¬ä¸‰è¡Œå¾ªç¯å·¦ç§»ä¸¤ä½  for (int i = 0; i \u0026lt; 2; ++i) { temp = mtx[i + 8]; mtx[i + 8] = mtx[i + 10]; mtx[i + 10] = temp; } // ç¬¬å››è¡Œå¾ªç¯å·¦ç§»ä¸‰ä½  temp = mtx[15]; for (int i = 3; i \u0026gt; 0; --i) mtx[i + 12] = mtx[i + 11]; mtx[12] = temp; }   åå‘è¡Œç§»ä½å›¾è§£ï¼š\nä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  // é€†è¡Œå˜æ¢ - ä»¥å­—èŠ‚ä¸ºå•ä½å¾ªç¯å³ç§» void InvShiftRows(byte mtx[4*4]) { // ç¬¬äºŒè¡Œå¾ªç¯å³ç§»ä¸€ä½ \tbyte temp = mtx[7]; for(int i=3; i\u0026gt;0; --i) mtx[i+4] = mtx[i+3]; mtx[4] = temp; // ç¬¬ä¸‰è¡Œå¾ªç¯å³ç§»ä¸¤ä½ \tfor(int i=0; i\u0026lt;2; ++i) { temp = mtx[i+8]; mtx[i+8] = mtx[i+10]; mtx[i+10] = temp; } // ç¬¬å››è¡Œå¾ªç¯å³ç§»ä¸‰ä½ \ttemp = mtx[12]; for(int i=0; i\u0026lt;3; ++i) mtx[i+12] = mtx[i+13]; mtx[15] = temp; }   åˆ—æ··æ·†å±‚ åˆ—æ··æ·†å­å±‚æ˜¯AESç®—æ³•ä¸­æœ€ä¸ºå¤æ‚çš„éƒ¨åˆ†ï¼Œå±äºæ‰©æ•£å±‚ï¼Œåˆ—æ··æ·†æ“ä½œæ˜¯AESç®—æ³•ä¸­ä¸»è¦çš„æ‰©æ•£å…ƒç´ ï¼Œå®ƒæ··æ·†äº†è¾“å…¥çŸ©é˜µçš„æ¯ä¸€åˆ—ï¼Œä½¿è¾“å…¥çš„æ¯ä¸ªå­—èŠ‚éƒ½ä¼šå½±å“åˆ°4ä¸ªè¾“å‡ºå­—èŠ‚ã€‚è¡Œä½ç§»å­å±‚å’Œåˆ—æ··æ·†å­å±‚çš„ç»„åˆä½¿å¾—ç»è¿‡ä¸‰è½®å¤„ç†ä»¥åï¼ŒçŸ©é˜µçš„æ¯ä¸ªå­—èŠ‚éƒ½ä¾èµ–äº16ä¸ªæ˜æ–‡å­—èŠ‚æˆå¯èƒ½ã€‚\nåœ¨åŠ å¯†çš„æ­£å‘åˆ—æ··æ·†ä¸­ï¼Œæˆ‘ä»¬è¦å°†è¾“å…¥çš„$4Â·4$çŸ©é˜µå·¦ä¹˜ä¸€ä¸ªç»™å®šçš„$4Â·4$çŸ©é˜µã€‚è€Œå®ƒä»¬ä¹‹é—´çš„åŠ æ³•ã€ä¹˜æ³•éƒ½åœ¨æ‰©å±•åŸŸ$GF(2^8)$ä¸­è¿›è¡Œï¼Œ,åœ¨çŸ©é˜µç›¸ä¹˜è®¡ç®—ä¸­ï¼Œå‡ºç°äº†åŠ æ³•å’Œä¹˜æ³•ï¼Œè€Œå‰é¢æåˆ°äº†åœ¨æ‹“å±•åŸŸä¸­åŠ æ³•ç­‰åŒäºå¼‚æˆ–è¿ç®—ï¼Œè€Œå¯¹äºä¹˜æ³•ï¼Œéœ€è¦ç‰¹æ®Šçš„æ–¹å¼è¿›è¡Œå¤„ç†ï¼Œäºæ˜¯å°†+å·æ¢æˆ^å·ï¼Œç„¶åå°†ä¼½ç½—ç“¦åŸŸçš„ä¹˜æ³•å®šä¹‰æˆä¸€ä¸ªæœ‰ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå¹¶è®©ä»–è¿”å›æœ€åè®¡ç®—ç»“æœï¼Œæœ€ååˆ—æ··æ·†ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  //æ­£å‘åˆ—å˜æ¢ void MixColumns(byte mtx[4*4]) { byte arr[4]; for(int i=0; i\u0026lt;4; ++i) { for(int j=0; j\u0026lt;4; ++j) arr[j] = mtx[i+j*4]; mtx[i] = GFMul(0x02, arr[0]) ^ GFMul(0x03, arr[1]) ^ arr[2] ^ arr[3]; mtx[i+4] = arr[0] ^ GFMul(0x02, arr[1]) ^ GFMul(0x03, arr[2]) ^ arr[3]; mtx[i+8] = arr[0] ^ arr[1] ^ GFMul(0x02, arr[2]) ^ GFMul(0x03, arr[3]); mtx[i+12] = GFMul(0x03, arr[0]) ^ arr[1] ^ arr[2] ^ GFMul(0x02, arr[3]); } }   åœ¨è§£å¯†çš„é€†å‘åˆ—æ··æ·†ä¸­ä¸æ­£å‘åˆ—æ··æ·†çš„ä¸åŒä¹‹å¤„åœ¨äºä½¿ç”¨çš„å·¦ä¹˜çŸ©é˜µä¸åŒï¼Œå®ƒä¸æ­£å‘åˆ—æ··æ·†çš„å·¦ä¹˜çŸ©é˜µäº’ä¸ºé€†çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°æ®çŸ©é˜µåŒæ—¶å·¦ä¹˜è¿™ä¸¤ä¸ªçŸ©é˜µåï¼Œæ•°æ®çŸ©é˜µä¸ä¼šå‘ç”Ÿä»»ä½•å˜åŒ–ã€‚ä¸‹é¢æ˜¯å›¾è§£ï¼š\næ­£å‘æ··æ·†å¤„ç†ï¼š\né€†å‘æ··æ·†å¤„ç†ï¼š\nåå‘åˆ—å˜æ¢ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  //åå‘åˆ—æ··æ·† void InvMixColumns(byte mtx[4*4]) { byte arr[4]; for(int i=0; i\u0026lt;4; ++i) { for(int j=0; j\u0026lt;4; ++j) arr[j] = mtx[i+j*4]; mtx[i] = GFMul(0x0e, arr[0]) ^ GFMul(0x0b, arr[1]) ^ GFMul(0x0d, arr[2]) ^ GFMul(0x09, arr[3]); mtx[i+4] = GFMul(0x09, arr[0]) ^ GFMul(0x0e, arr[1]) ^ GFMul(0x0b, arr[2]) ^ GFMul(0x0d, arr[3]); mtx[i+8] = GFMul(0x0d, arr[0]) ^ GFMul(0x09, arr[1]) ^ GFMul(0x0e, arr[2]) ^ GFMul(0x0b, arr[3]); mtx[i+12] = GFMul(0x0b, arr[0]) ^ GFMul(0x0d, arr[1]) ^ GFMul(0x09, arr[2]) ^ GFMul(0x0e, arr[3]); } }   å¯†é’¥åŠ æ³•å±‚ è¿™ä¸€å±‚ä¸»è¦æ˜¯æ˜æ–‡çŸ©é˜µç›’å­å¯†é’¥çŸ©é˜µè¿›è¡Œå¼‚æˆ–æ“ä½œ,åœ¨å¯†é’¥åŠ æ³•å±‚ä¸­æœ‰ä¸¤ä¸ªè¾“å…¥çš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯æ˜æ–‡å’Œå­å¯†é’¥ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªè¾“å…¥éƒ½æ˜¯128ä½çš„ã€‚åªéœ€è¦å°†ä¸¤ä¸ªè¾“å…¥çš„æ•°æ®è¿›è¡ŒæŒ‰å­—èŠ‚å¼‚æˆ–æ“ä½œå°±ä¼šå¾—åˆ°è¿ç®—çš„ç»“æœã€‚\nå›¾è§£ï¼š\nä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  //è½®å¯†é’¥åŠ å˜æ¢ - å°†æ¯ä¸€åˆ—ä¸æ‰©å±•å¯†é’¥è¿›è¡Œå¼‚æˆ– void AddRoundKey(byte mtx[4*4], word k[4]) { for(int i=0; i\u0026lt;4; ++i) { word k1 = k[i] \u0026gt;\u0026gt; 24; word k2 = (k[i] \u0026lt;\u0026lt; 8) \u0026gt;\u0026gt; 24; word k3 = (k[i] \u0026lt;\u0026lt; 16) \u0026gt;\u0026gt; 24; word k4 = (k[i] \u0026lt;\u0026lt; 24) \u0026gt;\u0026gt; 24; mtx[i] = mtx[i] ^ byte(k1.to_ulong()); mtx[i+4] = mtx[i+4] ^ byte(k2.to_ulong()); mtx[i+8] = mtx[i+8] ^ byte(k3.to_ulong()); mtx[i+12] = mtx[i+12] ^ byte(k4.to_ulong()); } }   å®ç°åŠ å¯†å‡½æ•° åŠ å¯†å‡½æ•°æŒ‰ç…§æµç¨‹å›¾,é¦–å…ˆå¼€å§‹æ˜¯å…ˆè¿›è¡Œä¸€æ¬¡è½®å¯†é’¥åŠ ,ç„¶åå¼€å§‹9è½®çš„å­—èŠ‚æ›¿æ¢+è¡Œç§»ä½+åˆ—æ··æ·†+è½®å¯†é’¥åŠ çš„æ“ä½œ,å¾ªç¯ä¹‹åå†åšä¸€æ¬¡å­—èŠ‚æ›¿æ¢+è¡Œç§»ä½+è½®å¯†é’¥åŠ å°±å®ŒæˆåŠ å¯†æ“ä½œäº†.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  void encrypt(byte in[4*4], word w[4*(N_round+1)]) { word key[4]; for(int i=0; i\u0026lt;4; ++i) key[i] = w[i]; AddRoundKey(in, key); for(int round=1; round\u0026lt;N_round; ++round) { SubBytes(in); ShiftRows(in); MixColumns(in); for(int i=0; i\u0026lt;4; ++i) key[i] = w[4*round+i]; AddRoundKey(in, key); } SubBytes(in); ShiftRows(in); for(int i=0; i\u0026lt;4; ++i) key[i] = w[4*N_round+i]; AddRoundKey(in, key); }   å®ç°è§£å¯†å‡½æ•° è§£å¯†å‡½æ•°ä¸åŠ å¯†å·®ä¸å¤š,åªä¸è¿‡å°†è¡Œç§»ä½å˜æˆåå‘è¡Œç§»ä½,åˆ—æ··æ·†å˜æˆåå‘åˆ—æ··æ·†,å­—èŠ‚æ›¿æ¢å˜æˆé€†å­—èŠ‚æ›¿æ¢å³å¯.\nä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  void decrypt(byte in[4*4], word w[4*(N_round+1)]) { word key[4]; for(int i=0; i\u0026lt;4; ++i) key[i] = w[4*N_round+i]; AddRoundKey(in, key); for(int round=N_round-1; round\u0026gt;0; --round) { InvShiftRows(in); InvSubBytes(in); for(int i=0; i\u0026lt;4; ++i) key[i] = w[4*round+i]; AddRoundKey(in, key); InvMixColumns(in); } InvShiftRows(in); InvSubBytes(in); for(int i=0; i\u0026lt;4; ++i) key[i] = w[i]; AddRoundKey(in, key); }   æµ‹è¯•åŠ å¯†è§£å¯†å‡½æ•° å¯ä»¥å‘ç°ä¸Šé¢é¢çš„æµ‹è¯•ä¸­æ˜æ–‡ä¸è§£å¯†ä¹‹åçš„æ˜æ–‡æ˜¯å®Œå…¨æ­£ç¡®çš„,è¯´æ˜åŠ å¯†å‡½æ•°ä¸è§£å¯†å‡½æ•°æ­£ç¡®!\næµ‹è¯•ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  void Aes_test() { byte key[16] = {0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c}; byte plain[16] = {0x32, 0x88, 0x31, 0xe0, 0x43, 0x5a, 0x31, 0x37, 0xf6, 0x30, 0x98, 0x07, 0xa8, 0x8d, 0xa2, 0x34}; // è¾“å‡ºå¯†é’¥  cout \u0026lt;\u0026lt; \u0026#34;Key is : \u0026#34;; for (int i = 0; i \u0026lt; 16; ++i) cout \u0026lt;\u0026lt; hex \u0026lt;\u0026lt; key[i].to_ulong() \u0026lt;\u0026lt; \u0026#34;\u0026#34;; cout \u0026lt;\u0026lt; endl; word w[4 * (N_round + 1)]; KeyExpansion(key, w); // è¾“å‡ºå¾…åŠ å¯†çš„æ˜æ–‡  cout \u0026lt;\u0026lt; endl \u0026lt;\u0026lt; \u0026#34;the plaintext to encrypy:\u0026#34; \u0026lt;\u0026lt; endl; for (int i = 0; i \u0026lt; 16; ++i) { cout \u0026lt;\u0026lt; hex \u0026lt;\u0026lt; plain[i].to_ulong() \u0026lt;\u0026lt; \u0026#34;\u0026#34;; if ((i + 1) % 4 == 0) cout \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; endl; // åŠ å¯†ï¼Œè¾“å‡ºå¯†æ–‡  encrypt(plain, w); cout \u0026lt;\u0026lt; \u0026#34;cipher : \u0026#34; \u0026lt;\u0026lt; endl; for (int i = 0; i \u0026lt; 16; ++i) { cout \u0026lt;\u0026lt; hex \u0026lt;\u0026lt; plain[i].to_ulong() \u0026lt;\u0026lt; \u0026#34;\u0026#34;; if ((i + 1) % 4 == 0) cout \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; endl; // è§£å¯†ï¼Œè¾“å‡ºæ˜æ–‡  decrypt(plain, w); cout \u0026lt;\u0026lt; \u0026#34;plain arter decrypt:\u0026#34; \u0026lt;\u0026lt; endl; for (int i = 0; i \u0026lt; 16; ++i) { cout \u0026lt;\u0026lt; hex \u0026lt;\u0026lt; plain[i].to_ulong() \u0026lt;\u0026lt; \u0026#34;\u0026#34;; if ((i + 1) % 4 == 0) cout \u0026lt;\u0026lt; endl; } cout \u0026lt;\u0026lt; endl; }   å®ç°åŠ è§£å¯†æ–‡ä»¶ åŠ å¯†æ–‡ä»¶å‡½æ•°,è¿”å›åŠ å¯†åçš„æ–‡ä»¶å:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  string encryptFile(string oname, string suffix, word w[4 * (N_round + 1)]) { string outputfilename = oname + \u0026#34;_cipher.bin\u0026#34;; bitset\u0026lt;128\u0026gt; data; byte plain[16]; cout \u0026lt;\u0026lt; \u0026#34;begining encrypy...........\u0026#34; \u0026lt;\u0026lt; endl; clock_t start = clock(); // å°†æ–‡ä»¶åŠ å¯†åˆ° oname + cipher.bin ä¸­  ifstream in; ofstream out; in.open(oname + suffix, ios::binary); //è¾“å…¥æ–‡ä»¶  out.open(outputfilename, ios::binary); //è¾“å‡ºåŠ å¯†æ–‡ä»¶  while (in.read((char *)\u0026amp;data, sizeof(data))) { divideToByte(plain, data); encrypt(plain, w); data = mergeByte(plain); out.write((char *)\u0026amp;data, sizeof(data)); data.reset(); // ç½®0  } in.close(); out.close(); clock_t end = clock(); cout \u0026lt;\u0026lt; \u0026#34;encrypy finish!\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;encrypy cost time : \u0026#34; \u0026lt;\u0026lt; (end - start) \u0026lt;\u0026lt; \u0026#34;ms\u0026#34; \u0026lt;\u0026lt; endl; return outputfilename; //è¿”å›åŠ å¯†ä¹‹åçš„æ–‡ä»¶ }   è§£å¯†æ–‡ä»¶å‡½æ•°,è¿”å›è§£å¯†åçš„æ–‡ä»¶å:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  string decryptFile(string filename, string oname, string suffix, word w[4 * (N_round + 1)]) { ifstream in; ofstream out; in.open(filename, ios::binary); string outputfilename = oname + \u0026#34;_decrypt\u0026#34; + suffix; out.open(outputfilename, ios::binary); bitset\u0026lt;128\u0026gt; data; byte plain[16]; cout \u0026lt;\u0026lt; \u0026#34;begining decrypt............\u0026#34; \u0026lt;\u0026lt; endl; clock_t start = clock(); while (in.read((char *)\u0026amp;data, sizeof(data))) { divideToByte(plain, data); decrypt(plain, w); data = mergeByte(plain); out.write((char *)\u0026amp;data, sizeof(data)); data.reset(); // ç½®0  } in.close(); out.close(); clock_t end = clock(); cout \u0026lt;\u0026lt; \u0026#34;decrypt finish!\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;decrypt cost time : \u0026#34; \u0026lt;\u0026lt; end - start \u0026lt;\u0026lt; \u0026#34;ms\u0026#34; \u0026lt;\u0026lt; endl; return outputfilename; }   å®ç°æ•ˆæœ:\nåŠ å¯†txtæ–‡ä»¶:\nåŠ å¯†jpgæ–‡ä»¶:\nåŠ å¯†mp3æ–‡ä»¶:\nåŠ å¯†docæ–‡ä»¶:\nAESäº”ç§åŠ å¯†æ¨¡å¼ å®ç°äº”ç§åŠ å¯†æ–¹å¼çš„å¯†é’¥æ˜¯ä¸€ä¸ªç½®æ¢è¡¨unsigned char Table[4] = {0x12, 0xb1, 0x53, 0x28};,åŠ å¯†å‡½æ•°æ˜¯åŸæ–‡ä¸å¯†é’¥çš„å¼‚æˆ–.\nECBæ¨¡å¼(ç”µå­å¯†ç æœ¬æ¨¡å¼) åŠ å¯†å‰æ ¹æ®åŠ å¯†å—å¤§å°ï¼ˆå¦‚AESä¸º128ä½ï¼‰åˆ†æˆè‹¥å¹²å—ï¼Œä¹‹åå°†æ¯å—ä½¿ç”¨ç›¸åŒçš„å¯†é’¥å•ç‹¬åŠ å¯†ï¼Œè§£å¯†åŒç†ã€‚\nECBæ¨¡å¼ç”±äºæ¯å—æ•°æ®çš„åŠ å¯†æ˜¯ç‹¬ç«‹çš„å› æ­¤åŠ å¯†å’Œè§£å¯†éƒ½å¯ä»¥å¹¶è¡Œè®¡ç®—ï¼ŒECBæ¨¡å¼æœ€å¤§çš„ç¼ºç‚¹æ˜¯ç›¸åŒçš„æ˜æ–‡å—ä¼šè¢«åŠ å¯†æˆç›¸åŒçš„å¯†æ–‡å—ï¼Œè¿™ç§æ–¹æ³•åœ¨æŸäº›ç¯å¢ƒä¸‹ä¸èƒ½æä¾›ä¸¥æ ¼çš„æ•°æ®ä¿å¯†æ€§ã€‚\næµç¨‹å›¾å¦‚ä¸‹:\nå®ç°ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  //ç”µå­å¯†ç æœ¬æ¨¡å¼,åˆ†ç»„å¤§å°ä¸º4 unsigned char* ECB(unsigned char *plain, int N) { int gNum = N / groupSize; //åˆ†ç»„æ•°é‡  //å¯†æ–‡  unsigned char *cipher = new unsigned char[N]; int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[groupSize]; for(int j = 0;j \u0026lt; groupSize;++j) temp[j] = plain[count++]; //åŠ å¯†  encrypt(temp,groupSize); for(int j = i*4;j \u0026lt; i*4 + 4;++j) cipher[j] = temp[j - i * 4]; } return cipher;//è¿”å›å¯†æ–‡ }   è§£å¯†æ–¹æ³•ä¹Ÿæ˜¯è®©å¯†æ–‡ä¸å¯†é’¥è¿›è¡Œå¼‚æˆ–å³å¯,å®ç°æ•ˆæœå¦‚ä¸‹:\nCBCæ¨¡å¼(åˆ†ç»„é“¾æ¥æ¨¡å¼) CBCæ¨¡å¼å¯¹äºæ¯ä¸ªå¾…åŠ å¯†çš„å¯†ç å—åœ¨åŠ å¯†å‰ä¼šå…ˆä¸å‰ä¸€ä¸ªå¯†ç å—çš„å¯†æ–‡å¼‚æˆ–ç„¶åå†ç”¨åŠ å¯†å™¨åŠ å¯†ã€‚ç¬¬ä¸€ä¸ªæ˜æ–‡å—ä¸ä¸€ä¸ªå«åˆå§‹åŒ–å‘é‡çš„æ•°æ®å—å¼‚æˆ–ã€‚\nå¯ç”¨å…¬å¼æ€»ç»“ä¸º:\n$$\nC_i = E_K(P_i XOR C_{i-1}) \\\nC_{-1} = IV\n$$\næµç¨‹å›¾å¦‚ä¸‹:\nCBCæ¨¡å¼ç›¸æ¯”ECBæœ‰æ›´é«˜çš„ä¿å¯†æ€§ï¼Œä½†ç”±äºå¯¹æ¯ä¸ªæ•°æ®å—çš„åŠ å¯†ä¾èµ–ä¸å‰ä¸€ä¸ªæ•°æ®å—çš„åŠ å¯†æ‰€ä»¥åŠ å¯†æ— æ³•å¹¶è¡Œã€‚ä¸ECBä¸€æ ·åœ¨åŠ å¯†å‰éœ€è¦å¯¹æ•°æ®è¿›è¡Œå¡«å……ï¼Œä¸æ˜¯å¾ˆé€‚åˆå¯¹æµæ•°æ®è¿›è¡ŒåŠ å¯†ã€‚\nä»£ç å¦‚ä¸‹:\nåŠ å¯†å‡½æ•°:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  //CCBåŠ å¯†å‡½æ•° unsigned char *CCB(unsigned char *plain, int N) { int gNum = N / groupSize; //åˆ†ç»„æ•°é‡  //å¯†æ–‡  unsigned char *cipher = new unsigned char[N]; //è®¾ç½®åˆå§‹å‘é‡  unsigned char C[groupSize] = {0xe4, 0xa9, 0x5d, 0x99}; int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[groupSize]; for (int j = 0; j \u0026lt; groupSize; ++j) temp[j] = plain[count++]; //åŠ å¯†  for (int j = 0; j \u0026lt; groupSize; ++j) //å…ˆä¸åˆå§‹å‘é‡å¼‚æˆ–  temp[i] ^= C[i]; encrypt(temp, groupSize); //åŠ å¯†  for (int j = i * 4; j \u0026lt; i * 4 + 4; ++j) { cipher[j] = temp[j - i * 4]; C[j - i * 4] = temp[j - i * 4];//è®¾ç½®æ–°å‘é‡  } } return cipher; }   è§£å¯†å‡½æ•°:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  //CCBè§£å¯†å‡½æ•° unsigned char *dCCB(unsigned char *cipher, int N) { int gNum = N / groupSize; //åˆ†ç»„æ•°é‡  //æ˜æ–‡  unsigned char *plain = new unsigned char[N]; //è®¾ç½®åˆå§‹å‘é‡  unsigned char C[groupSize] = {0xe4, 0xa9, 0x5d, 0x99}; int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[groupSize]; for (int j = 0; j \u0026lt; groupSize; ++j) temp[j] = cipher[count++]; //è§£å¯†  encrypt(temp, groupSize); //å…ˆè§£å¯†  for (int j = 0; j \u0026lt; groupSize; ++j) //ç„¶åä¸åˆå§‹å‘é‡å¼‚æˆ–  temp[i] ^= C[i]; for (int j = i * 4; j \u0026lt; i * 4 + 4; ++j) { plain[j] = temp[j - i * 4]; C[j - i * 4] = cipher[j];//è®¾ç½®æ–°å‘é‡  } } return plain; }   å®ç°æ•ˆæœ:\nCFBæ¨¡å¼(å¯†æ–‡åé¦ˆæ¨¡å¼) ä¸å‰é¢çš„æ¨¡å¼ä¸åŒ,CFBæ¨¡å¼å¯ä»¥å°†æ¶ˆæ¯è¢«å½“æˆæ˜¯æ¯”ç‰¹æµ.å¯ä»¥æ€»ç»“ä¸ºå¦‚ä¸‹çš„å…¬å¼:\n$$\nC_i = P_i XOR E_K(C_{i-1})\\\nC_{-1} = IV\n$$\næµç¨‹å›¾å¦‚ä¸‹:\nåŠ å¯†ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39  //å¯†æ–‡åé¦ˆæ¨¡å¼,åŠ å¯†å‡½æ•° unsigned char *CFB(unsigned char *plain, int N) { int gsize = 2; int gNum = N / gsize; //åˆ†ç»„æ•°é‡,åˆ†æˆ8ç»„,æ¯ç»„å¤§å°ä¸º2  //å¯†æ–‡  unsigned char *cipher = new unsigned char[N]; //è®¾ç½®åˆå§‹å‘é‡  unsigned char C[4] = {0xe4, 0xa9, 0x5d, 0x99}; unsigned char S[2]; //å‰2ä¸ªå­—èŠ‚  int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[gsize]; //åˆ†ç»„æ˜æ–‡,å¤§å°ä¸º2  for (int j = 0; j \u0026lt; gsize; ++j) temp[j] = plain[count++]; //åŠ å¯†  //å…ˆå¯¹åˆå§‹å‘é‡è¿›è¡ŒåŠ å¯†  encrypt(C,4); //è·å–ç»“æœCçš„å‰ä¸¤ä¸ªbit,ç„¶åå‰2ä¸ªbit Sä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–  for(int j = 0;j \u0026lt; gsize;++j){ temp[j] ^= C[j]; S[j] = temp[j]; //è·å–å¯†æ–‡çš„2bit  } //è®¾ç½®å¯†æ–‡  for (int j = i * gsize; j \u0026lt; i * gsize + gsize; ++j) { cipher[j] = temp[j - i * gsize]; } //è®¾ç½®æ–°å‘é‡,æ–°å‘é‡å·¦ç§»  for(int j = 0;j \u0026lt; gsize;++j) { C[j] = C[j + gsize]; C[j + gsize] = S[j]; } } return cipher; }   è§£å¯†ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  //å¯†æ–‡åé¦ˆè§£å¯† unsigned char *dCFB(unsigned char *cipher, int N) { int gsize = 2; int gNum = N / gsize; //åˆ†ç»„æ•°é‡,åˆ†æˆ8ç»„,æ¯ç»„å¤§å°ä¸º2  //æ˜æ–‡  unsigned char *plain = new unsigned char[N]; //è®¾ç½®åˆå§‹å‘é‡  unsigned char C[4] = {0xe4, 0xa9, 0x5d, 0x99}; unsigned char S[2]; //å‰2ä¸ªå­—èŠ‚  int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[gsize]; //åˆ†ç»„å¯†æ–‡  for (int j = 0; j \u0026lt; gsize; ++j) temp[j] = cipher[count++]; //è§£å¯†  //å…ˆå¯¹åˆå§‹å‘é‡è¿›è¡ŒåŠ å¯†  encrypt(C,4); //è·å–ç»“æœCçš„å‰ä¸¤ä¸ªbit,ç„¶åå‰2ä¸ªbit Sä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–  for(int j = 0;j \u0026lt; 2;++j){ S[j] = temp[j]; temp[j] = C[j] ^ temp[j]; } //è®¾ç½®æ˜æ–‡  for (int j = i * gsize; j \u0026lt; i * gsize + gsize; ++j) { plain[j] = temp[j - i * gsize]; } //è®¾ç½®æ–°å‘é‡,æ–°å‘é‡å·¦ç§»  for(int j = 0;j \u0026lt; gsize;++j) { C[j] = C[j + gsize]; C[j+gsize] = S[j]; } } return plain; }   å®ç°æ•ˆæœ:\nOFBæ¨¡å¼(è¾“å‡ºåé¦ˆæ¨¡å¼) OFBæ˜¯å…ˆç”¨å—åŠ å¯†å™¨ç”Ÿæˆå¯†é’¥æµï¼ˆKeystreamï¼‰ï¼Œç„¶åå†å°†å¯†é’¥æµä¸æ˜æ–‡æµå¼‚æˆ–å¾—åˆ°å¯†æ–‡æµï¼Œè§£å¯†æ˜¯å…ˆç”¨å—åŠ å¯†å™¨ç”Ÿæˆå¯†é’¥æµï¼Œå†å°†å¯†é’¥æµä¸å¯†æ–‡æµå¼‚æˆ–å¾—åˆ°æ˜æ–‡ï¼Œç”±äºå¼‚æˆ–æ“ä½œçš„å¯¹ç§°æ€§æ‰€ä»¥åŠ å¯†å’Œè§£å¯†çš„æµç¨‹æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚\nOFBä¸CFBä¸€æ ·éƒ½éå¸¸é€‚åˆå¯¹æµæ•°æ®çš„åŠ å¯†ï¼ŒOFBç”±äºåŠ å¯†å’Œè§£å¯†éƒ½ä¾èµ–ä¸å‰ä¸€æ®µæ•°æ®ï¼Œæ‰€ä»¥åŠ å¯†å’Œè§£å¯†éƒ½ä¸èƒ½å¹¶è¡Œã€‚\næµç¨‹å›¾å¦‚ä¸‹:\nåŠ å¯†è§£å¯†ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39  //è¾“å‡ºåé¦ˆæ¨¡å¼,åŠ å¯†è§£å¯†å‡½æ•°ç›¸åŒ unsigned char *OFB(unsigned char *plain, int N) { int gsize = 2; int gNum = N / gsize; //åˆ†ç»„æ•°é‡,åˆ†æˆ8ç»„,æ¯ç»„å¤§å°ä¸º2  //å¯†æ–‡  unsigned char *cipher = new unsigned char[N]; //è®¾ç½®åˆå§‹å‘é‡  unsigned char C[4] = {0xee, 0xa9, 0x5d, 0x99}; unsigned char S[2]; //å‰2ä¸ªå­—èŠ‚  int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[gsize]; //åˆ†ç»„æ˜æ–‡  for (int j = 0; j \u0026lt; gsize; ++j) temp[j] = plain[count++]; //åŠ å¯†  //å…ˆå¯¹åˆå§‹å‘é‡è¿›è¡ŒåŠ å¯†  encrypt(C,4); //è·å–ç»“æœCçš„å‰ä¸¤ä¸ªbit,ç„¶åå‰2ä¸ªbit Sä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–  for(int j = 0;j \u0026lt; 2;++j){ S[j] = C[j]; //å–å‘é‡åŠ å¯†åçš„å‰ä¸¤ä½  temp[j] ^= C[j]; } //è®¾ç½®å¯†æ–‡  for (int j = i * gsize; j \u0026lt; i * gsize + gsize; ++j) { cipher[j] = temp[j - i * gsize]; } //è®¾ç½®æ–°å‘é‡,æ–°å‘é‡å·¦ç§»  for(int j = 0;j \u0026lt; gsize;++j) { C[j] = C[j + gsize]; C[j + gsize] = S[j]; } } return cipher; }   å®ç°æ•ˆæœ:\nCTRæ¨¡å¼(è®¡æ•°å™¨æ¨¡å¼) ç±»å‹äºCFBï¼Œä½†æ˜¯åŠ å¯†æ¯ä¸ªè®¡æ•°å€¼ï¼Œè€Œä¸æ˜¯ä»»ä½•åé¦ˆå€¼,å¯¹æ¯ä¸ªæ˜æ–‡åˆ†ç»„ï¼Œå¿…é¡»æœ‰ä¸åŒçš„å¯†é’¥å’Œè®¡æ•°å€¼ (ä»ä¸é‡å¤ä½¿ç”¨),,å¯ä»¥ç”¨å¦‚ä¸‹å…¬å¼è¡¨ç¤º:\n$$\nO_i = E_K(i)\\\nC_i = P_i XOR O_i\n$$\nè®¡æ•°å™¨æ¨¡å¼æµç¨‹å›¾å¦‚ä¸‹:\nè®¡æ•°å™¨æ¨¡å¼åŠ å¯†å‡½æ•°ä¸è§£å¯†å‡½æ•°ä¸€æ ·,ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  //è®¡æ•°å™¨æ¨¡å¼,åŠ å¯†å‡½æ•° unsigned char *CTR(unsigned char *plain, int N) { int gNum = N / groupSize; //åˆ†ç»„æ•°é‡  //å¯†æ–‡  unsigned char *cipher = new unsigned char[N]; //è®¾ç½®éšæœºå€¼  unsigned char Counter[groupSize*groupSize] = {0x44, 0xa9, 0x5d, 0x99, 0xe5, 0xf1, 0x3d, 0x91, 0x16, 0xa6, 0xe1, 0x33, 0x22, 0xdd, 0xab, 0x1f}; int count = 0; for (int i = 0; i \u0026lt; gNum; ++i) { unsigned char temp[groupSize]; //æ˜æ–‡åˆ†ç»„  unsigned char C[groupSize]; //åˆ†ç»„éšæœºå€¼  for (int j = 0; j \u0026lt; groupSize; ++j) { temp[j] = plain[count++]; C[j] = Counter[i*4+j]; } //åŠ è¿·  //é¦–å…ˆåŠ å¯†éšæœºå€¼C  encrypt(C, groupSize); //ç„¶åä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–  for(int j = 0;j \u0026lt; groupSize;++j) temp[j] ^= C[j]; //è®¾ç½®å¯†æ–‡  for(int j = i*groupSize;j \u0026lt; i*groupSize+groupSize;j++) cipher[j] = temp[j-i*groupSize]; } return cipher; }   å®ç°æ•ˆæœå¦‚ä¸‹:\nå‚è€ƒ:\n https://www.cnblogs.com/RabbitHu/p/bitset.html bitsetç”¨æ³• https://blog.csdn.net/liushu1231/article/details/8844631 bitsetçš„ç©ºé—´å¤§å° http://c.biancheng.net/cpp/html/2834.html æ–‡ä»¶å¤„ç† https://bbs.pediy.com/thread-253884.htm AESç®—æ³•å¸¦å›¾è§£ https://blog.csdn.net/lisonglisonglisong/article/details/41909813 AESç®—æ³• CSDN https://blog.csdn.net/sinat_23338865/article/details/72869841 AESäº”ç§åŠ å¯†æ¨¡å¼   è®¾â€œ+â€ä¸ºä¸€ä¸ªäº¤æ¢æ€§çš„äºŒå…ƒè¿ç®—ï¼Œå³å¯¹äºæ‰€æœ‰x,yï¼Œx+y=y+xã€‚è‹¥è¯¥é›†å†…å­˜åœ¨ä¸€ä¸ªå…ƒç´ 0ï¼Œä½¿å¾—å¯¹äºæ‰€æœ‰xï¼Œx+0=0+x=xï¼Œåˆ™æ­¤å…ƒç´ æ˜¯å”¯ä¸€çš„ã€‚å¦‚æœå¯¹äºä¸€ä¸ªç»™å®šçš„xï¼Œå­˜åœ¨ä¸€ä¸ªx'ä½¿å¾—x+x'=x'+x=0ï¼Œåˆ™ç§°x'æ˜¯xçš„åŠ æ³•é€†å…ƒã€‚ \u0026#x21a9;\u0026#xfe0e;\n ä¹˜æ³•é€†å…ƒï¼Œæ˜¯æŒ‡æ•°å­¦é¢†åŸŸç¾¤Gä¸­ä»»æ„ä¸€ä¸ªå…ƒç´ aï¼Œéƒ½åœ¨Gä¸­æœ‰å”¯ä¸€çš„é€†å…ƒaâ€˜ï¼Œå…·æœ‰æ€§è´¨aÃ—a'=a'Ã—a=eï¼Œå…¶ä¸­eä¸ºè¯¥ç¾¤çš„å•ä½å…ƒã€‚ \u0026#x21a9;\u0026#xfe0e;\n  ","description":"","id":42,"section":"posts","tags":["AES","å¯†ç å­¦","åŠ å¯†"],"title":"Aes-é«˜çº§åŠ å¯†æ ‡å‡†","uri":"https://hugo.jiahongw.com/zh/posts/mima/aes/"},{"content":"outer\nç®€å•åœ°è¯´ï¼Œäº‘è®¡ç®—å°±æ˜¯è®¡ç®—æœåŠ¡çš„æä¾›ï¼ˆåŒ…æ‹¬æœåŠ¡å™¨ã€å­˜å‚¨ã€æ•°æ®åº“ã€ç½‘ç»œã€è½¯ä»¶ã€åˆ†æå’Œæ™ºèƒ½ï¼‰- é€šè¿‡ Internetï¼ˆäº‘ï¼‰æä¾›å¿«é€Ÿåˆ›æ–°ã€å¼¹æ€§èµ„æºå’Œè§„æ¨¡ç»æµã€‚å¯¹äºäº‘æœåŠ¡ï¼Œé€šå¸¸ä½ åªéœ€ä½¿ç”¨å¤šå°‘æ”¯ä»˜å¤šå°‘ï¼Œä»è€Œå¸®åŠ©é™ä½è¿è¥æˆæœ¬ï¼Œä½¿åŸºç¡€è®¾æ–½æ›´æœ‰æ•ˆåœ°è¿è¡Œï¼Œå¹¶èƒ½æ ¹æ®ä¸šåŠ¡éœ€æ±‚çš„å˜åŒ–è°ƒæ•´å¯¹æœåŠ¡çš„ä½¿ç”¨ã€‚\nè¡Œäº‘è¶£ç è®°å½• è¡Œäº‘è¶£ç å®˜ç½‘ï¼šhttp://mart.cloudtogo.cn/\nLinuxæœåŠ¡å™¨ ç”Ÿæˆè‡ªå·±çš„æœåŠ¡å™¨ è¿›å…¥åº”ç”¨å•†åº—ï¼Œé€‰æ‹©éœ€è¦çš„LinuxæœåŠ¡å™¨ï¼Œè¿™é‡Œé€‰æ‹©CentOS\nç‚¹å‡»éƒ¨ç½²ï¼Œç­‰å¾…ç”Ÿæˆè‡ªå·±çš„æœåŠ¡å™¨\nå‘å¸ƒæˆåŠŸ\nå‚æ•°è§£é‡Š ç‚¹å‡»è®¿é—®ï¼Œä¼šè·³å‡ºè®¿é—®åœ°å€ï¼Œéƒ¨ç½²åŒºåŸŸä»¥åŠæç¤ºä¿¡æ¯ï¼Œä¸€æ­¥ä¸€æ­¥çœ‹ã€‚\nè®¿é—®åœ°å€\néƒ¨ç½²åŒºåŸŸ\néƒ¨ç½²åŒºåŸŸæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå°±æ˜¯è¿™ä¸ªæœåŠ¡å™¨éƒ¨ç½²çš„åŒºåŸŸã€‚\nè¯¦æƒ…\nä»ä¸Šé¢ç»™çš„ä¿¡æ¯ï¼Œå¯ä»¥å½’ä¸ºå¦‚ä¸‹ï¼š\n  sshè¿œç¨‹è®¿é—®çš„åœ°å€ä¸º2c56369b3c95a919.c.cloudtogo.cnï¼Œç«¯å£ä¸º34920(æ³¨æ„ï¼šç«¯å£ä¸æ˜¯22)ã€‚è¿œç¨‹ç™»é™†çš„ç”¨æˆ·åä¸ºï¼šrootï¼Œå¯†ç ä¸ºï¼š123456.\n  æœ‰äº”ä¸ªæ˜ å°„ç«¯å£ï¼Œä»–ä»¬çš„å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š\n   Linuxå†…éƒ¨ å¤–éƒ¨è®¿é—®     8001 34921(é¢„ç•™aç«¯å£)   8002 34916(é¢„ç•™bç«¯å£)   8003 34917(é¢„ç•™cç«¯å£)   8004 34918(é¢„ç•™dç«¯å£)   8005 34924(é¢„ç•™eç«¯å£)    ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬åœ¨Linuxå†…éƒ¨å¯ç”¨8001-8005è¿™äº”ä¸ªç«¯å£è¿è¡Œç›¸åº”çš„åº”ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®å¯¹åº”çš„å¤–éƒ¨é¢„ç•™ç«¯å£ä»¥åŠå­åŸŸåè¿›è¡Œè®¿é—®æµ‹è¯•ã€‚\nä¾‹å¦‚åœ¨Linuxå†…è¿è¡Œäº†ä¸€ä¸ªwebåº”ç”¨åœ¨8001ç«¯å£ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨è®¿é—®61823a63ab19b300.c.cloudtogo.cn:34921\n  sshè¿œç¨‹è¿æ¥ï¼š\næŸ¥çœ‹é…ç½® æŸ¥çœ‹CPUå‹å·: Intel(R) Xeon(R) CPU E5-2680 v3\n1  cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c   æŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°: 2\n1  cat /proc/cpuinfo | grep \u0026#34;physical id\u0026#34; | sort | uniq|wc -l   æŸ¥çœ‹é€»è¾‘CPUçš„ä¸ªæ•°: 8ä¸ª\n1  cat /proc/cpuinfo | grep \u0026#34;processor\u0026#34; |wc -l   æŸ¥çœ‹CPUæ˜¯å‡ æ ¸: 4æ ¸\n1  cat /proc/cpuinfo | grep \u0026#34;cores\u0026#34;|uniq   è®¾ç½®è¿œç¨‹è®¿é—®jupyter å®‰è£…å®Œjupyterä¹‹åï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼š\n1  jupyter notebook --generate-config   å‚è€ƒï¼š\nhttps://www.jianshu.com/p/960f011f712e\nhttps://zhuanlan.zhihu.com/p/64524822\nç»“æœï¼š\næ·»åŠ è™šæ‹Ÿç¯å¢ƒï¼šhttps://ofooo.github.io/wiki/python/%E5%B7%A5%E5%85%B7/jupyter-notebook/\næ›´æ¢pipæºï¼šhttps://www.linuxidc.com/Linux/2019-04/158178.htm\néƒ¨ç½²nodejsï¼šhttps://blog.csdn.net/xerysherryx/article/details/78920978\nnpmé•œåƒï¼šhttps://www.cnblogs.com/alps/p/12439387.html\nCentOSåŸºæœ¬å‘½ä»¤ æŸ¥çœ‹æœåŠ¡è¿›ç¨‹\n1 2 3  [victor@mylove ~]$ ps -aux|grep mysql victor 23477 0.0 0.0 110656 2688 pts/3 S+ 12:26 0:00 grep --color=auto mysql   æŸ¥çœ‹è¿›ç¨‹ç«¯å£\n1  netstat -anp |grep 1506   æŸ¥çœ‹ç«¯å£è¿›ç¨‹\n1  netstat -lnp|grep 3306   å…³é—­è¿›ç¨‹\n1  kill â€“9 1506   ç”Ÿäº§åº”ç”¨ ä½¿ç”¨dockerç”Ÿäº§è‡ªå·±çš„åº”ç”¨ å¼€å‘ç½‘é¡µApp è¿›å…¥åº”ç”¨å·¥å‚,æ‰“å¼€ä¸€ä¸ªBlankçš„æ¨¡æ¿ç»§ç»­,ç„¶åå†è®¾è®¡é¡µé¢æ‹–å…¥ä¸€ä¸ªä»£ç ç»„ä»¶,å¦‚ä¸‹:\nè¾“å…¥åå­—ä¸ºwebpy,åº”ä¸ºä½¿ç”¨çš„æ˜¯web.pyæ¡†æ¶è¿›è¡Œç¼–å†™,ç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥.\nç„¶åè¾“å…¥å­˜æ”¾ä»£ç çš„åœ°å€,ä»£ç éœ€è¦ç¼–å†™å®Œæˆä¹‹åå­˜åˆ°GitHubä¸Š,ç¨‹åºé»˜è®¤çš„è¿è¡Œå…¥å£æ—¶main.py,åœ¨è¿è¡Œmain.pyä¹‹å‰,è¿˜ä¼šæ‰§è¡Œpip install -r requirements.txtè¿™ä¸ªä»£ç ,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†æ‰€éœ€è¦çš„ä¾èµ–åŒ…éƒ½å†™åœ¨requirements.txtè¿™ä¸ªæ–‡ä»¶ä¸­.\næˆ‘çš„ä»£ç åœ°å€: https://github.com/redisread/webpy.git\nç¼–å†™ç»„ä»¶å‘å¯¼,æœ‰è®¸å¤šå‚æ•°\nå…¶ä»–çš„å‚æ•°ä½œç”¨:\n ç¯å¢ƒå˜é‡: å­˜å‚¨ç³»ç»Ÿçš„ç›¸å…³éœ€è¦è¿è¡Œçš„ç¨‹åºçš„ä½ç½® å¤šå‰¯æœ¬: å¤šå‰¯æœ¬è®¾ç½®æ”¯æŒå¯ä»¥ä½¿ç”¨å¼¹æ€§ä¼¸ç¼©åŠŸèƒ½,å¯å¼€å¯å¯ä¸å¼€å¯ ä¼šè¯ä¿æŒ: ç»´æŒå®¢æˆ·ç«¯ä¸ä¸€å°æœåŠ¡å™¨çš„è¿æ¥,å³å¯¹äºæŸä¸ªå®¢æˆ·ç«¯,,ä¸ä¼šæ›´æ¢ä¸ä»–è¿›è¡Œè¿æ¥çš„æœåŠ¡å™¨ æ‰§è¡Œå‘½ä»¤: å¯ä»¥æ‰§è¡ŒLinuxçš„ç›¸å…³å‘½ä»¤ å­˜å‚¨è·¯å¾„: å¯ä»¥è®¾ç½®å­˜å‚¨åˆ°æ•°æ®å·ä¸­,å¡«å†™çš„Linuxçš„ä½ç½®å°±æ˜¯æ•°æ®å·å­˜æ”¾çš„ä½ç½® rootæƒé™: æ˜¯å¦å¼€å¯rootæƒé™ æœåŠ¡åç§°: å°±æ˜¯æœåŠ¡çš„åç§° è¯»å–æŒ‡å®šæ–‡ä»¶: **0 æ—¥å¿—æ–‡ä»¶: å¡«å†™æ—¥å¿—æ–‡ä»¶å­˜æ”¾çš„çš„åœ°æ–¹ æ˜ å°„é…ç½®æ–‡ä»¶: å¯ä»¥æ˜ å°„(ç›¸å½“äºæ›¿æ¢)é…ç½®æ–‡ä»¶,ä¾‹å¦‚nginxçš„nginx.confæ–‡ä»¶. å¥åº·æ£€æŸ¥: ç‰¹æƒæ¨¡å¼: èµ„æºé™åˆ¶: é™åˆ¶CPUyä»¥åŠå†…å­˜çš„è®¾ç½®  æœ€åç‚¹å‡»å®Œæˆå°±å¯ä»¥å‘å‘å¸ƒåº”ç”¨äº†\nå‘å¸ƒä¸€èˆ¬ä¸éœ€è¦é…ç½®ä»€ä¹ˆ,éœ€è¦çš„è¯å¯ä»¥è‡ªè¡Œè®¾ç½®.\nå‘å¸ƒæˆåŠŸ!\nè®¿é—®è¯¥åœ°å€å°±èƒ½å¤Ÿè®¿é—®æˆ‘ä»¬å†™çš„åº”ç”¨äº†.\nè¿ç»´ç®¡ç† åœ¨å‘å¸ƒé¡µçš„ä¾§è¾¹æ æœ‰ä¸€ä¸ªè¿ç»´æŒ‰é’®,ç‚¹å‡»è¿›å…¥è¿ç»´ç•Œé¢\nå¦‚ä¸‹å°±æ˜¯å¯ä»¥è¿›è¡ŒæŸ¥çœ‹çš„ç›¸å…³ä¿¡æ¯\n","description":"","id":43,"section":"posts","tags":["äº‘è®¡ç®—","è¡Œäº‘è¶£ç "],"title":"è¡Œäº‘å¼€å‘","uri":"https://hugo.jiahongw.com/zh/posts/xingyun-begin/"},{"content":"ã€‚ã€‚é›†ä¸‡æ»´é›¨æ°´ï¼Œæˆä¸€æ¡æ±Ÿæ²³ğŸŒŠğŸŒŠ\nRedis  REmote DIctionary Server(Redis) æ˜¯ä¸€ä¸ªç”±Salvatore Sanfilippoå†™çš„key-valueå­˜å‚¨ç³»ç»Ÿã€‚\nRedisæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€éµå®ˆBSDåè®®1ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚\nå®ƒé€šå¸¸è¢«ç§°ä¸ºæ•°æ®ç»“æ„æœåŠ¡å™¨ï¼Œå› ä¸ºå€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯ å­—ç¬¦ä¸²(String), å“ˆå¸Œ(Hash), åˆ—è¡¨(list), é›†åˆ(sets) å’Œ æœ‰åºé›†åˆ(sorted sets)ç­‰ç±»å‹ã€‚\n  å¼€æºç•Œçš„ 5 å¤§è®¸å¯åè®®ï¼šäº”å¤§å¼€æºè®¸å¯åè®®åˆ†åˆ«æ˜¯GPL,LGPL,BSD,MIT,Apacheã€‚\n å­˜å‚¨ç±»å‹ï¼š\n String: å­—ç¬¦ä¸² Hash: æ•£åˆ— List: åˆ—è¡¨ Set: é›†åˆ Sorted Set: æœ‰åºé›†åˆ  ä¸‰ä¸ªç‰¹ç‚¹ï¼š\n Redisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ã€‚ Redisä¸ä»…ä»…æ”¯æŒç®€å•çš„key-valueç±»å‹çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜æä¾›listï¼Œsetï¼Œzsetï¼Œhashç­‰æ•°æ®ç»“æ„çš„å­˜å‚¨ã€‚ Redisæ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³master-slaveæ¨¡å¼2çš„æ•°æ®å¤‡ä»½ã€‚  Redisä¸å…¶ä»–key-valueå­˜å‚¨æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ\n Redisæœ‰ç€æ›´ä¸ºå¤æ‚çš„æ•°æ®ç»“æ„å¹¶ä¸”æä¾›å¯¹ä»–ä»¬çš„åŸå­æ€§æ“ä½œ3ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸åŒäºå…¶ä»–æ•°æ®åº“çš„è¿›åŒ–è·¯å¾„ã€‚Redisçš„æ•°æ®ç±»å‹éƒ½æ˜¯åŸºäºåŸºæœ¬æ•°æ®ç»“æ„çš„åŒæ—¶å¯¹ç¨‹åºå‘˜é€æ˜ï¼Œæ— éœ€è¿›è¡Œé¢å¤–çš„æŠ½è±¡ã€‚ Redisè¿è¡Œåœ¨å†…å­˜ä¸­ä½†æ˜¯å¯ä»¥æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ‰€ä»¥åœ¨å¯¹ä¸åŒæ•°æ®é›†è¿›è¡Œé«˜é€Ÿè¯»å†™æ—¶éœ€è¦æƒè¡¡å†…å­˜ï¼Œå› ä¸ºæ•°æ®é‡ä¸èƒ½å¤§äºç¡¬ä»¶å†…å­˜ã€‚åœ¨å†…å­˜æ•°æ®åº“æ–¹é¢çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œç›¸æ¯”åœ¨ç£ç›˜ä¸Šç›¸åŒçš„å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œåœ¨å†…å­˜ä¸­æ“ä½œèµ·æ¥éå¸¸ç®€å•ï¼Œè¿™æ ·Rediså¯ä»¥åšå¾ˆå¤šå†…éƒ¨å¤æ‚æ€§å¾ˆå¼ºçš„äº‹æƒ…ã€‚åŒæ—¶ï¼Œåœ¨ç£ç›˜æ ¼å¼æ–¹é¢ä»–ä»¬æ˜¯ç´§å‡‘çš„ä»¥è¿½åŠ çš„æ–¹å¼äº§ç”Ÿçš„ï¼Œå› ä¸ºä»–ä»¬å¹¶ä¸éœ€è¦è¿›è¡Œéšæœºè®¿é—®ã€‚  å®‰è£… githubé“¾æ¥ï¼šhttps://github.com/microsoftarchive/redis/releases\nRedisæ˜¯Cè¯­è¨€å¼€å‘ï¼Œå®‰è£…Rediséœ€è¦å…ˆå°†å®˜ç½‘ä¸‹è½½çš„æºç è¿›è¡Œç¼–è¯‘ï¼Œç¼–è¯‘ä¾èµ–gccç¯å¢ƒï¼Œå¦‚æœæ²¡æœ‰gccç¯å¢ƒï¼Œéœ€è¦å®‰è£…gccã€‚\nå®‰è£…GCC æ­¥éª¤ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  ## å…ˆå®‰è£… gcc ç¼–è¯‘ç¯å¢ƒ,å¦‚æœå·²ç»å®‰è£…, è¯·å¿½ç•¥ yum -y install gcc automake autoconf libtool make ## ä¸‹è½½ redis æºä»£ç  wget http://download.redis.io/releases/redis-4.0.1.tar.gz ## ä¸‹è½½å®Œæˆå,è§£å‹ tar zxvf redis-4.0.1.tar.gz ## è·³è½¬åˆ° redis ç›®å½• cd redis-4.0.1 ## ç¼–è¯‘ make ## å®‰è£…ç¼–è¯‘åçš„è½¯ä»¶åˆ° /usr/local/redis ## PREFIXå¿…é¡»å¤§å†™,è‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºredisç›®å½•ï¼Œå¹¶å°†ç»“æœå®‰è£…æ­¤ç›®å½• make PREFIX=/usr/local/redis install ## æŸ¥çœ‹å®‰è£…çš„ç»“æœ cd /usr/local/redis/bin ls -l -rwxr-xr-x 1 root root 2451864 Mar 12 13:28 redis-benchmark -rwxr-xr-x 1 root root 5741096 Mar 12 13:28 redis-check-aof -rwxr-xr-x 1 root root 5741096 Mar 12 13:28 redis-check-rdb -rwxr-xr-x 1 root root 2606088 Mar 12 13:28 redis-cli lrwxrwxrwx 1 root root 12 Mar 12 13:28 redis-sentinel -\u0026gt; redis-server -rwxr-xr-x 1 root root 5741096 Mar 12 13:28 redis-server   é…ç½®  Redis çš„é…ç½®æ–‡ä»¶ä½äº Redis å®‰è£…ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åä¸º redis.conf(Windows åä¸º redis.windows.conf)ã€‚\n redis.confé…ç½®æ–‡ä»¶è¯¦è§£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116  ## æŒ‡å®šåŒ…å«å…¶å®ƒçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªRediså®ä¾‹ä½¿ç”¨åŒä¸€ä»½é…ç½®æ–‡ä»¶ï¼Œè€Œå„ä¸ªå®ä¾‹åˆæ‹¥æœ‰è‡ªå·±çš„ç‰¹å®šé…ç½®æ–‡ä»¶ include /path/to/local.conf ## ç»‘å®šçš„ä¸»æœºåœ°å€, å¯ä»¥ç›‘å¬ä¸€ä¸ªæˆ–å¤šä¸ª, å¦‚æœä¸º 127.0.0.1 åªèƒ½æœ¬æœºæ‰èƒ½è®¿é—® bind 127.0.0.1 ## Redisé»˜è®¤ä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥é€šè¿‡è¯¥é…ç½®é¡¹ä¿®æ”¹ï¼Œä½¿ç”¨yeså¯ç”¨å®ˆæŠ¤è¿›ç¨‹ daemonize no ## Redisä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œæ—¶,Redisé»˜è®¤ä¼šæŠŠ pid å†™å…¥ /var/run/redis.pid æ–‡ä»¶,å¯ä»¥é€šè¿‡ pidfile æŒ‡å®š pidfile /var/run/redis_6379.pid ## æŒ‡å®šRedisç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º6379 port 6379 ## å½“å®¢æˆ·ç«¯é—²ç½®å¤šé•¿æ—¶é—´åå…³é—­è¿æ¥ï¼Œå¦‚æœæŒ‡å®šä¸º0ï¼Œè¡¨ç¤ºå…³é—­è¯¥åŠŸèƒ½ timeout 0 ## æŒ‡å®šæ—¥å¿—è®°å½•çº§åˆ«ï¼ŒRedisæ€»å…±æ”¯æŒå››ä¸ªçº§åˆ«ï¼šdebugã€verboseã€noticeã€warningï¼Œé»˜è®¤ä¸ºverbose ## debug ä¼šæ‰“å°å‡ºå¾ˆå¤šä¿¡æ¯ï¼Œé€‚ç”¨äºå¼€å‘å’Œæµ‹è¯•é˜¶æ®µ ## verbose åŒ…å«å¾ˆå¤šä¸å¤ªæœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ¯”debugè¦æ¸…çˆ½ä¸€äº› ## notice é€‚ç”¨äºç”Ÿäº§æ¨¡å¼ ## warning è­¦å‘Šä¿¡æ¯ï¼ˆä»…è®°å½•éå¸¸é‡è¦/é‡è¦çš„æ¶ˆæ¯ï¼‰ loglevel verbose ## æ—¥å¿—è®°å½•æ–¹å¼ï¼Œé»˜è®¤ä¸ºæ ‡å‡†è¾“å‡º ## å¦‚æœ Redis ä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œï¼Œè€Œè¿™é‡Œåˆé…ç½®ä¸ºæ—¥å¿—è®°å½•æ–¹å¼ä¸ºæ ‡å‡†è¾“å‡ºï¼Œåˆ™æ—¥å¿—å°†ä¼šå‘é€ç»™/dev/null logfile stdout ## è®¾ç½®æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ•°æ®åº“ä¸º0ï¼Œå¯ä»¥ä½¿ç”¨SELECT \u0026lt;dbid\u0026gt;å‘½ä»¤åœ¨è¿æ¥ä¸ŠæŒ‡å®šæ•°æ®åº“id databases 16 ## æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶(æŒä¹…åŒ–)ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é…åˆ ## save \u0026lt;seconds\u0026gt; \u0026lt;changes\u0026gt; save 900 1 ## 900ç§’å†…æœ‰ä¸€ä¸ªæ›´æ–° save 300 10 ## 300ç§’å†…æœ‰10ä¸ªæ›´æ–° save 60 10000 ## 60ç§’å†…æœ‰10000ä¸ªæ›´æ–° ## æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸ºyes ## Redisé‡‡ç”¨LZFå‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœCPUæ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§ rdbcompression yes ## æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸ºdump.rdb dbfilename dump.rdb ## ä¹Ÿå°±æ˜¯å®‰è£…ç›®å½•ä¸‹æˆ‘ä»¬çœ‹åˆ°çš„é‚£ä¸ªæ–‡ä»¶ ## æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½• dir ./ ## å½“æœ¬æœºä¸ºslavæœåŠ¡æ—¶ï¼Œè®¾ç½®masteræœåŠ¡çš„IPåœ°å€åŠç«¯å£ï¼Œåœ¨Rediså¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ä»masterè¿›è¡Œæ•°æ®åŒæ­¥ slaveof \u0026lt;masterip\u0026gt; \u0026lt;masterport\u0026gt; ## å½“masteræœåŠ¡è®¾ç½®äº†å¯†ç ä¿æŠ¤æ—¶ï¼ŒslavæœåŠ¡è¿æ¥masterçš„å¯†ç  masterauth \u0026lt;master-password\u0026gt; ## è®¾ç½®Redisè¿æ¥å¯†ç  ## å¦‚æœé…ç½®äº†è¿æ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥Redisæ—¶éœ€è¦é€šè¿‡AUTH \u0026lt;password\u0026gt;å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­ requirepass foobared ## è®¾ç½®åŒä¸€æ—¶é—´æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œé»˜è®¤æ— é™åˆ¶ ## Rediså¯ä»¥åŒæ—¶æ‰“å¼€çš„å®¢æˆ·ç«¯è¿æ¥æ•°ä¸ºRedisè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•° ## å¦‚æœè®¾ç½® maxclients 0ï¼Œè¡¨ç¤ºä¸ä½œé™åˆ¶ ## å®¢æˆ·ç«¯è¿æ¥æ•°åˆ°è¾¾é™åˆ¶æ—¶,Redisä¼šå…³é—­æ–°çš„è¿æ¥å¹¶å‘å®¢æˆ·ç«¯è¿”å›max number of clients reachedé”™è¯¯ä¿¡æ¯ maxclients 128 ## Redisæœ€å¤§å†…å­˜é™åˆ¶ ## Redisåœ¨å¯åŠ¨æ—¶ä¼šæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¾¾åˆ°æœ€å¤§å†…å­˜åï¼ŒRedisä¼šå…ˆå°è¯•æ¸…é™¤å·²åˆ°æœŸæˆ–å³å°†åˆ°æœŸçš„Key ## å½“æ­¤æ–¹æ³•å¤„ç†åï¼Œä»ç„¶åˆ°è¾¾æœ€å¤§å†…å­˜è®¾ç½®ï¼Œå°†æ— æ³•å†è¿›è¡Œå†™å…¥æ“ä½œï¼Œä½†ä»ç„¶å¯ä»¥è¿›è¡Œè¯»å–æ“ä½œã€‚ ## Redisæ–°çš„vmæœºåˆ¶ï¼Œä¼šæŠŠKeyå­˜æ”¾å†…å­˜ï¼ŒValueä¼šå­˜æ”¾åœ¨swapåŒº maxmemory \u0026lt;bytes\u0026gt; ## æŒ‡å®šæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåè¿›è¡Œæ—¥å¿—è®°å½•, é»˜è®¤ä¸º no ## Redisåœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œå¦‚æœä¸å¼€å¯ï¼Œå¯èƒ½ä¼šåœ¨æ–­ç”µæ—¶å¯¼è‡´ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®ä¸¢å¤± ## å› ä¸º redisæœ¬èº«åŒæ­¥æ•°æ®æ–‡ä»¶æ˜¯æŒ‰ä¸Šé¢saveæ¡ä»¶æ¥åŒæ­¥çš„ï¼Œæ‰€ä»¥æœ‰çš„æ•°æ®ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…åªå­˜åœ¨äºå†…å­˜ä¸­ appendonly no ## æŒ‡å®šæ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤ä¸º appendonly.aof appendfilename appendonly.aof ## æŒ‡å®šæ›´æ–°æ—¥å¿—æ¡ä»¶ ## no : è¡¨ç¤ºç­‰æ“ä½œç³»ç»Ÿè¿›è¡Œæ•°æ®ç¼“å­˜åŒæ­¥åˆ°ç£ç›˜ï¼ˆå¿«ï¼‰ ## always : è¡¨ç¤ºæ¯æ¬¡æ›´æ–°æ“ä½œåæ‰‹åŠ¨è°ƒç”¨fsync()å°†æ•°æ®å†™åˆ°ç£ç›˜ï¼ˆæ…¢ï¼Œå®‰å…¨ï¼‰ ## everysec : è¡¨ç¤ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼ˆæŠ˜ä¸­ï¼Œé»˜è®¤å€¼ï¼‰ appendfsync everysec ## æŒ‡å®šæ˜¯å¦å¯ç”¨è™šæ‹Ÿå†…å­˜æœºåˆ¶ï¼Œé»˜è®¤å€¼ä¸ºno ## VMæœºåˆ¶å°†æ•°æ®åˆ†é¡µå­˜æ”¾,å°†è®¿é—®é‡è¾ƒå°‘çš„é¡µå³å†·æ•°æ®swapåˆ°ç£ç›˜ä¸Š,è®¿é—®å¤šçš„é¡µé¢ç”±ç£ç›˜è‡ªåŠ¨æ¢å‡ºåˆ°å†…å­˜ä¸­ vm-enabled no ## è™šæ‹Ÿå†…å­˜æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤å€¼ä¸º/tmp/redis.swapï¼Œä¸å¯å¤šä¸ªRediså®ä¾‹å…±äº« vm-swap-file /tmp/redis.swap ## å°†æ‰€æœ‰å¤§äºvm-max-memoryçš„æ•°æ®å­˜å…¥è™šæ‹Ÿå†…å­˜ ## æ— è®ºvm-max-memoryè®¾ç½®å¤šå°,æ‰€æœ‰ç´¢å¼•æ•°æ®éƒ½æ˜¯å†…å­˜å­˜å‚¨çš„(Redisçš„ç´¢å¼•æ•°æ® å°±æ˜¯keys), ## ä¹Ÿå°±æ˜¯è¯´,å½“vm-max-memoryè®¾ç½®ä¸º0çš„æ—¶å€™,å…¶å®æ˜¯æ‰€æœ‰valueéƒ½å­˜åœ¨äºç£ç›˜ã€‚é»˜è®¤å€¼ä¸º0 vm-max-memory 0 ## Redis swapæ–‡ä»¶åˆ†æˆäº†å¾ˆå¤šçš„pageï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥ä¿å­˜åœ¨å¤šä¸ªpageä¸Šé¢ï¼Œä½†ä¸€ä¸ªpageä¸Šä¸èƒ½è¢«å¤šä¸ªå¯¹è±¡å…±äº« vm-page-size 32 ## è®¾ç½®swapæ–‡ä»¶ä¸­çš„pageæ•°é‡ ## ç”±äºé¡µè¡¨ï¼ˆä¸€ç§è¡¨ç¤ºé¡µé¢ç©ºé—²æˆ–ä½¿ç”¨çš„bitmapï¼‰æ˜¯åœ¨æ”¾åœ¨å†…å­˜ä¸­çš„,åœ¨ç£ç›˜ä¸Šæ¯8ä¸ªpageså°†æ¶ˆè€—1byteçš„å†…å­˜ã€‚ vm-pages 134217728 ## è®¾ç½®è®¿é—®swapæ–‡ä»¶çš„çº¿ç¨‹æ•°,æœ€å¥½ä¸è¦è¶…è¿‡æœºå™¨çš„æ ¸æ•°, ## å¦‚æœè®¾ç½®ä¸º0,é‚£ä¹ˆæ‰€æœ‰å¯¹swapæ–‡ä»¶çš„æ“ä½œéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œå¯èƒ½ä¼šé€ æˆæ¯”è¾ƒé•¿æ—¶é—´çš„å»¶è¿Ÿã€‚é»˜è®¤å€¼ä¸º4 vm-max-threads 4 ## è®¾ç½®åœ¨å‘å®¢æˆ·ç«¯åº”ç­”æ—¶ï¼Œæ˜¯å¦æŠŠè¾ƒå°çš„åŒ…åˆå¹¶ä¸ºä¸€ä¸ªåŒ…å‘é€ï¼Œé»˜è®¤ä¸ºå¼€å¯ glueoutputbuf yes ## æŒ‡å®šåœ¨è¶…è¿‡ä¸€å®šçš„æ•°é‡æˆ–è€…æœ€å¤§çš„å…ƒç´ è¶…è¿‡æŸä¸€ä¸´ç•Œå€¼æ—¶ï¼Œé‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„å“ˆå¸Œç®—æ³• hash-max-zipmap-entries 64 hash-max-zipmap-value 512 ## æŒ‡å®šæ˜¯å¦æ¿€æ´»é‡ç½®å“ˆå¸Œï¼Œé»˜è®¤ä¸ºå¼€å¯ï¼ˆåé¢åœ¨ä»‹ç»Redisçš„å“ˆå¸Œç®—æ³•æ—¶å…·ä½“ä»‹ç»ï¼‰ activerehashing yes   æ³¨æ„äº‹é¡¹ æˆ‘ä»¬æŸ¥çœ‹äº†é…ç½®æ–‡ä»¶ä¿¡æ¯, æ€»ç»“å¦‚ä¸‹\n   å¦‚æœä½ æƒ³è¦ä»¥åŠ è½½é…ç½®æ–‡ä»¶çš„æ–¹å¼å¯åŠ¨ Redis, é‚£ä¹ˆä½ éœ€è¦ä½¿ç”¨ ./redis-server /path/to/redis.conf å‘½ä»¤å¯åŠ¨ Redis æœåŠ¡ç«¯.\n  å†…å­˜è®¾ç½®å¤§å°å•ä½\n   1k =\u0026gt; 1000 bytes 1kb =\u0026gt; 1024 bytes 1m =\u0026gt; 1000000 bytes 1mb =\u0026gt; 1024*1024 bytes 1g =\u0026gt; 1000000000 bytes 1gb =\u0026gt; 102410241024 bytes 1GB 1Gb 1gB è¡¨è¾¾ä¸€æ ·çš„æ„æ€, å•ä½ä¸åŒºåˆ†å¤§å°å†™    121321\n   åŸºæœ¬æ“ä½œ è¿æ¥è¿œç¨‹æœåŠ¡å™¨ï¼šredis-cli -h host -p port -a password\nä¾‹å¦‚ï¼š$redis-cli -h 127.0.0.1 -p 6379 -a \u0026quot;mypass\u0026quot;\né”®Key ä¸ Redis é”®ç›¸å…³çš„åŸºæœ¬å‘½ä»¤ï¼š\n   åºå· å‘½ä»¤åŠæè¿°     1 DEL key è¯¥å‘½ä»¤ç”¨äºåœ¨ key å­˜åœ¨æ—¶åˆ é™¤ keyã€‚   2 DUMP key åºåˆ—åŒ–ç»™å®š key ï¼Œå¹¶è¿”å›è¢«åºåˆ—åŒ–çš„å€¼ã€‚   3 EXISTS key æ£€æŸ¥ç»™å®š key æ˜¯å¦å­˜åœ¨ã€‚   4 EXPIRE key seconds ä¸ºç»™å®š key è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä»¥ç§’è®¡ã€‚   5 EXPIREAT key timestamp EXPIREAT çš„ä½œç”¨å’Œ EXPIRE ç±»ä¼¼ï¼Œéƒ½ç”¨äºä¸º key è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚ ä¸åŒåœ¨äº EXPIREAT å‘½ä»¤æ¥å—çš„æ—¶é—´å‚æ•°æ˜¯ UNIX æ—¶é—´æˆ³(unix timestamp)ã€‚   6 PEXPIRE key milliseconds è®¾ç½® key çš„è¿‡æœŸæ—¶é—´ä»¥æ¯«ç§’è®¡ã€‚   7 PEXPIREAT key milliseconds-timestamp è®¾ç½® key è¿‡æœŸæ—¶é—´çš„æ—¶é—´æˆ³(unix timestamp) ä»¥æ¯«ç§’è®¡   8 KEYS pattern æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼( pattern)çš„ key ã€‚   9 MOVE key db å°†å½“å‰æ•°æ®åº“çš„ key ç§»åŠ¨åˆ°ç»™å®šçš„æ•°æ®åº“ db å½“ä¸­ã€‚   10 PERSIST key ç§»é™¤ key çš„è¿‡æœŸæ—¶é—´ï¼Œkey å°†æŒä¹…ä¿æŒã€‚   11 PTTL key ä»¥æ¯«ç§’ä¸ºå•ä½è¿”å› key çš„å‰©ä½™çš„è¿‡æœŸæ—¶é—´ã€‚   12 TTL key ä»¥ç§’ä¸ºå•ä½ï¼Œè¿”å›ç»™å®š key çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´(TTL, time to live)ã€‚   13 RANDOMKEY ä»å½“å‰æ•°æ®åº“ä¸­éšæœºè¿”å›ä¸€ä¸ª key ã€‚   14 RENAME key newkey ä¿®æ”¹ key çš„åç§°   15 RENAMENX key newkey ä»…å½“ newkey ä¸å­˜åœ¨æ—¶ï¼Œå°† key æ”¹åä¸º newkey ã€‚   16 TYPE key è¿”å› key æ‰€å‚¨å­˜çš„å€¼çš„ç±»å‹ã€‚    è®¾ç½®é”®å€¼å¯¹ set key value ä¸å–å‡ºé”®å€¼å¯¹ get key\nåˆ é™¤é”®å€¼ä½¿ç”¨del key\nå­—ç¬¦ä¸²å­˜å‚¨ Hashå­˜å‚¨ ä¹‹å‰å˜é‡æ²¡åˆ é™¤ä¼šæŠ¥é”™\nRedis hash æ˜¯ä¸€ä¸ªé”®å€¼(key=\u0026gt;value)å¯¹é›†åˆã€‚\nRedis hash æ˜¯ä¸€ä¸ª string ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼Œhash ç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚\næ¯ä¸ª hash å¯ä»¥å­˜å‚¨ 232 -1 é”®å€¼å¯¹ï¼ˆ40å¤šäº¿ï¼‰ã€‚\nåˆ—è¡¨å­˜å‚¨ Redis åˆ—è¡¨æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åºã€‚ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°åˆ—è¡¨çš„å¤´éƒ¨ï¼ˆå·¦è¾¹ï¼‰æˆ–è€…å°¾éƒ¨ï¼ˆå³è¾¹ï¼‰\nå±•ç¤ºï¼š\nåˆ—è¡¨æœ€å¤šå¯å­˜å‚¨ 232 - 1 å…ƒç´  (4294967295, æ¯ä¸ªåˆ—è¡¨å¯å­˜å‚¨40å¤šäº¿)ã€‚\né›†åˆå­˜å‚¨ æŒ‡ä»¤ï¼šsadd key member å‘é›†åˆkeyæ·»åŠ å…ƒç´ ã€‚\næŒ‡ä»¤ï¼šsmembers keyï¼Œå±•ç¤ºé›†åˆkeyä¸­çš„å…ƒç´ ï¼š\næœ‰åºé›†åˆ-zset æŒ‡ä»¤ï¼šzadd key score member ï¼Œå‘æœ‰åºé›†åˆæ·»åŠ å…ƒç´ ï¼Œå¹¶ä¸”è®¾ç½®ç›¸åº”çš„scoreã€‚\nä¸Šé¢è®¾ç½®Aä¸”scoreä¸º0ï¼ŒBä¸”scoreä¸º2ï¼ŒCä¸”scoreä¸º1.\næŒ‡ä»¤ï¼šzrangebyscore key l r,å±•ç¤ºæœ‰åºé›†åˆæŒ‰scoreæ’åºä¹‹åä¸”åœ¨èŒƒå›´låˆ°rçš„å…ƒç´ ã€‚\næ˜¾ç„¶å…ƒç´ å·²ç»æŒ‰ç…§scoreçš„é¡ºåºæ’åˆ—ã€‚\n è·Ÿå…¶ä»–æ¡æ¬¾ç›¸æ¯”ï¼Œä»GNUé€šç”¨å…¬å…±è®¸å¯è¯ï¼ˆGPLï¼‰åˆ°é™åˆ¶é‡é‡çš„è‘—ä½œæƒï¼ˆCopyrightï¼‰ï¼ŒBSDè®¸å¯è¯æ¯”è¾ƒå®½æ¾ï¼Œç”šè‡³è·Ÿå…¬æœ‰é¢†åŸŸæ›´ä¸ºæ¥è¿‘ã€‚äº‹å®ä¸Šï¼ŒBSDè®¸å¯è¯è¢«è®¤ä¸ºæ˜¯copycenterï¼ˆä¸­é—´è‘—ä½œæƒï¼‰ï¼Œä»‹ä¹æ ‡å‡†çš„copyrightä¸GPLçš„copyleftä¹‹é—´ã€‚\u0026ldquo;Take it down to the copy center and make as many copies as you want\u0026rdquo;[1]ã€‚å¯ä»¥è¯´ï¼ŒGPLå¼ºè¿«åç»­ç‰ˆæœ¬å¿…é¡»ä¸€æ ·æ˜¯è‡ªç”±è½¯ä»¶ï¼ŒBSDçš„åç»­ç‰ˆæœ¬å¯ä»¥é€‰æ‹©è¦ç»§ç»­æ˜¯BSDæˆ–å…¶ä»–è‡ªç”±è½¯ä»¶æ¡æ¬¾æˆ–å°é—­è½¯ä»¶ç­‰ç­‰ã€‚ \u0026#x21a9;\u0026#xfe0e;\n ä¸»ä»è®¾å¤‡æ¨¡å¼ä¹Ÿå«åšä¸»ä»†æ¨¡å¼è‹±æ–‡ç®€ç§°ä¸ºMaster-Slave,æ ¸å¿ƒæ€æƒ³æ˜¯åŸºäºåˆ†è€Œæ²»ä¹‹çš„æ€æƒ³,å°†ä¸€ä¸ªåŸå§‹ä»»åŠ¡åˆ†è§£ä¸ºè‹¥å¹²ä¸ªè¯­ä¹‰ç­‰åŒçš„å­ä»»åŠ¡,å¹¶ç”±ä¸“é—¨çš„å·¥ä½œè€…çº¿ç¨‹æ¥å¹¶è¡Œæ‰§è¡Œè¿™äº›ä»»åŠ¡,åŸå§‹ä»»åŠ¡çš„ç»“æœæ˜¯é€šè¿‡æ•´åˆå„ä¸ªå­ä»»åŠ¡çš„å¤„ç†ç»“æœå½¢æˆçš„ \u0026#x21a9;\u0026#xfe0e;\n æ„æ€å°±æ˜¯è¦ä¹ˆæˆåŠŸæ‰§è¡Œè¦ä¹ˆå¤±è´¥å®Œå…¨ä¸æ‰§è¡Œã€‚å•ä¸ªæ“ä½œæ˜¯åŸå­æ€§çš„ã€‚å¤šä¸ªæ“ä½œä¹Ÿæ”¯æŒäº‹åŠ¡ï¼Œå³åŸå­æ€§ï¼Œé€šè¿‡MULTIå’ŒEXECæŒ‡ä»¤åŒ…èµ·æ¥ã€‚ \u0026#x21a9;\u0026#xfe0e;\n  ","description":"","id":44,"section":"posts","tags":["redis","åˆ†å¸ƒå¼è®¡ç®—","äº‘è®¡ç®—","æ•°æ®åº“"],"title":"åˆ†å¸ƒå¼-Redis","uri":"https://hugo.jiahongw.com/zh/posts/redis/"},{"content":"èµ°å¾—æ…¢çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆä¸è·‘å‘¢ï¼Ÿ#ï¸âƒ£\nå“ˆå¸Œæ•£åˆ—è¡¨ ä¸¤ä¸ªæ¦‚å¿µï¼š\næ•£åˆ—è¡¨ï¼š\næ•£åˆ—è¡¨ï¼ˆHash tableï¼Œä¹Ÿå«å“ˆå¸Œè¡¨ï¼‰ï¼Œæ˜¯æ ¹æ®é”®ï¼ˆKeyï¼‰è€Œç›´æ¥è®¿é—®åœ¨å†…å­˜å­˜å‚¨ä½ç½®çš„æ•°æ®ç»“æ„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡è®¡ç®—ä¸€ä¸ªå…³äºé”®å€¼çš„å‡½æ•°ï¼Œå°†æ‰€éœ€æŸ¥è¯¢çš„æ•°æ®æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®¿é—®è®°å½•ï¼Œè¿™åŠ å¿«äº†æŸ¥æ‰¾é€Ÿåº¦ã€‚è¿™ä¸ªæ˜ å°„å‡½æ•°ç§°åšæ•£åˆ—å‡½æ•°ï¼Œå­˜æ”¾è®°å½•çš„æ•°ç»„ç§°åšæ•£åˆ—è¡¨ã€‚\næ•£åˆ—å‡½æ•°ï¼š\næ•£åˆ—å‡½æ•°ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å¦‚æœæŠŠå®ƒå®šä¹‰æˆ hash(key) ï¼Œå…¶ä¸­ key è¡¨ç¤ºå…ƒç´ çš„é”®å€¼ï¼Œåˆ™ hash(key) çš„å€¼è¡¨ç¤ºç»è¿‡æ•£åˆ—å‡½æ•°è®¡ç®—å¾—åˆ°çš„æ•£åˆ—å€¼ã€‚\næ•£åˆ—å‡½æ•°ç‰¹ç‚¹ï¼š\n ç¡®å®šæ€§ æ•£åˆ—ç¢°æ’ï¼ˆcollisionï¼‰ ä¸å¯é€†æ€§(ä¸€ä¸ªå“ˆå¸Œå€¼å¯¹åº”æ— æ•°ä¸ªæ˜æ–‡ï¼Œç†è®ºä¸Šä½ å¹¶ä¸çŸ¥é“å“ªä¸ªæ˜¯ã€‚) æ··æ·†ç‰¹æ€§  å¸¸è§çš„æ•£åˆ—å‡½æ•°ï¼š\n MD51 SHA-12  ä¸ºä»€ä¹ˆå“ˆå¸Œç®—æ³•æŸ¥æ‰¾æ•°ç»„å…ƒç´ ä¼šæ›´å¿«ï¼Ÿ\n åŸæ¥ä½¿ç”¨ä¸‹æ ‡è¿›è¡ŒåŒ¹é…çš„ç”»ï¼Œä¼šä¸€ä¸ªä¸€ä¸ªä»ä¸€æ•´ä¸ªæ•°ç»„è¿›è¡Œå…ƒç´ åŒ¹é…ï¼ŒçŸ¥é“æ‰¾åˆ°ç›¸ç­‰çš„å…ƒç´ æ‰å¾—åˆ°æ•°ç»„çš„ä¿¡æ¯ã€‚ä¾‹å¦‚åœ¨Arr[20]æŸ¥æ‰¾å€¼ä¸º12çš„,å°±éœ€è¦ä»ä¸‹æ ‡0åˆ°19è¿›è¡ŒæŸ¥æ‰¾ã€‚\nä½†æ˜¯å“ˆå¸Œæ•£åˆ—è¡¨å°†ä¸€ä¸ªä¸€ä¸ªæŒ‰é¡ºåºçš„æŸ¥æ‰¾è½¬æ¢ä¸ºä½¿ç”¨è®¡ç®—çš„æ–¹å¼è¿›è¡ŒæŸ¥æ‰¾ï¼Œå°†è¿ç®—ç»“æœçš„ä¸‹æ ‡æ˜ å°„æˆä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œå®ç°äº†è·³è·ƒå¼çš„æŸ¥æ‰¾ï¼Œä»è€Œæ•ˆç‡æ›´é«˜ã€‚\n é—®é¢˜:æ•£åˆ—å†²çª\n å¯¹äºæ•£åˆ—è¡¨è€Œè¨€ï¼Œæ— è®ºè®¾ç½®çš„å­˜å‚¨åŒºåŸŸï¼ˆnï¼‰æœ‰å¤šå¤§ï¼Œå½“éœ€è¦å­˜å‚¨çš„æ•°æ®å¤§äº n æ—¶ï¼Œé‚£ä¹ˆå¿…ç„¶ä¼šå­˜åœ¨å“ˆå¸Œå€¼ç›¸åŒçš„æƒ…å†µã€‚è¿™å°±æ˜¯æ‰€è°“çš„æ•£åˆ—å†²çªã€‚\n è§£å†³æ•£åˆ—å‡½æ•°çš„ä¸¤ä¸ªæ–¹æ³•ï¼š\n  é“¾è¡¨æ³•\nå°±æ˜¯ä½¿ç”¨é“¾è¡¨æ¥ä¿å­˜å†²çªä¸‹æ ‡çš„æ•°æ®ï¼Œä¾‹å¦‚$12 % 5 = 2$å’Œ$7 % 5 = 2$,é‚£ä¹ˆåœ¨ä¸‹æ ‡ä¸º2çš„è¡¨ä¸‹ç”¨ä¸€ä¸ªé“¾è¡¨å­˜å‚¨12å’Œ7ã€‚\n  å¼€æ”¾å¯»å€æ³•ã€‚\nå¸¸è§ä¸‰ç§æ–¹æ³•ï¼šçº¿æ€§æ¢æµ‹æ³•ã€äºŒæ¬¡æ¢æµ‹æ³•ã€åŒæ•£åˆ—\nå‡è®¾å“ˆå¸Œå‡½æ•°ä¸ºï¼š\n$$\nH(key) = key \\mod10\n$$\nçº¿æ€§æ¢æµ‹æ³•ï¼š\nè¿˜æ˜¯$12 % 10 = 2 $å’Œ$22 % 10 = 2$è¿™ä¸¤ä¸ªä¾‹å­ï¼Œå½“22è¿™ä¸ªæ•°å­—éœ€è¦å­˜å…¥å“ˆå¸Œè¡¨æ—¶ï¼Œå‘ç°å·²ç»æœ‰12è¿™ä¸ªå…ƒç´ å­˜æ”¾åœ¨ä¸‹æ ‡ä¸º2çš„å“ˆå¸Œè¡¨ä¸Šäº†ï¼Œé‚£ä¹ˆå¯¹Hashåçš„æ•°å­—åŠ ä¸€åœ¨è¿›è¡ŒHashã€‚å³å¯¹7è¿›è¡Œè¿™æ ·çš„æ“ä½œï¼š\n$$\nH((H(key)+1)) = ((22 \\mod 10) + 1) \\mod 10 = (2 + 1) \\mod 10 = 3\n$$\nä½†æ˜¯è¿™ç§æ–¹å¼çš„é—®é¢˜æ˜¯å†²çªè¾ƒå¤šçš„æ—¶å€™ä¼šå‡ºç°æ•°æ®èšé›†åœ¨ä¸€ä¸ªåŒºåŸŸï¼Œè¿™æ ·ä¸åˆ©äºæŸ¥è¯¢æ•°æ®ã€‚\näºŒæ¬¡æ¢æµ‹æ³•ï¼š\näºŒæ¬¡æ¢æµ‹æ³•ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°è§£å†³å†²çªï¼š\n$$\n(H(key) \\pm j^2) \\mod 10,j = 0,1,2\u0026hellip;\n$$\nè¿™ç§æ–¹æ³•è¾ƒä¸ºå¤æ‚ï¼Œè€Œä¸”è™½ç„¶ä¸ä¼šè¿ç»­çš„èšé›†ä¸€ç‰‡ï¼Œä½†æ˜¯ä¼šåœ¨å¤šä¸ªé—´æ–­çš„ä½ç½®èšé›†ã€‚\nåŒæ•£åˆ—ï¼š\nåŒæ•£åˆ—ï¼Œé¡¾åæ€ä¹‰å°±éœ€è¦å¢åŠ ä¸€ä¸ªäºŒçº§æ•£åˆ—å‡½æ•°ï¼Œä¾‹å¦‚$G(key) = q - (key \\mod q) qä¸ºç´ æ•°ä¸”q\u0026lt;N$ï¼Œå‘ç°å†²çªä½¿ç”¨å¦‚ä¸‹æ“ä½œï¼š\n$$\nH(key) + j * G(key),j = 0,1,2\u0026hellip;\u0026hellip;\n$$\nåŒæ•£åˆ—æ–¹æ³•æœ‰å¾ˆå¤šç»„åˆçš„æ–¹æ³•ï¼Œè¿™é‡Œåªæ˜¯å…¶ä¸­çš„ä¸€ç§ï¼Œä¹Ÿæœ‰ä¸€äº›ä¾‹å¦‚:$H(key) + G(key)$,æ²¡æœ‰jè¿™ä¸ªå‚æ•°ã€‚\n  å¯†ç å­¦ä¸­çš„å“ˆå¸Œç®—æ³•  hashï¼ˆæ•£åˆ—ã€æ‚å‡‘ï¼‰å‡½æ•°ï¼Œæ˜¯å°†ä»»æ„é•¿åº¦çš„æ•°æ®æ˜ å°„åˆ°æœ‰é™é•¿åº¦çš„åŸŸä¸Šã€‚ç›´è§‚è§£é‡Šèµ·æ¥ï¼Œå°±æ˜¯å¯¹ä¸€ä¸²æ•°æ®mè¿›è¡Œæ‚ç³…ï¼Œè¾“å‡ºå¦ä¸€æ®µå›ºå®šé•¿åº¦çš„æ•°æ®hï¼Œä½œä¸ºè¿™æ®µæ•°æ®çš„ç‰¹å¾ï¼ˆæŒ‡çº¹ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ— è®ºæ•°æ®å—mæœ‰å¤šå¤§ï¼Œå…¶è¾“å‡ºå€¼hä¸ºå›ºå®šé•¿åº¦ã€‚åˆ°åº•æ˜¯ä»€ä¹ˆåŸç†ï¼Ÿå°†måˆ†æˆå›ºå®šé•¿åº¦ï¼ˆå¦‚128ä½ï¼‰ï¼Œä¾æ¬¡è¿›è¡Œhashè¿ç®—ï¼Œç„¶åç”¨ä¸åŒçš„æ–¹æ³•è¿­ä»£å³å¯ï¼ˆå¦‚å‰ä¸€å—çš„hashå€¼ä¸åä¸€å—çš„hashå€¼è¿›è¡Œå¼‚æˆ–ï¼‰ã€‚å¦‚æœä¸å¤Ÿ128ä½æ€ä¹ˆåŠï¼Ÿç”¨0è¡¥å…¨æˆ–è€…ç”¨1è¡¥å…¨éšæ„ï¼Œç®—æ³•ä¸­çº¦å®šå¥½å°±å¯ä»¥äº†ã€‚\n ä¸€èˆ¬æ¥è¯´ï¼Œå…¬å¸ä¸ä¼šç›´æ¥å°†ç”¨æˆ·çš„å¯†ç ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œè€Œæ˜¯ä¿å­˜ç»è¿‡å“ˆå¸Œæ“ä½œçš„å¯†ç å¾—åˆ°çš„å“ˆå¸Œå€¼ã€‚è¿™æ ·ï¼Œå½“å“ˆå¸Œå€¼è¢«ä¸æ³•åˆ†å­çªƒå–ï¼Œä¹Ÿä¸èƒ½è¿˜åŸå‡ºç”¨æˆ·çš„å¯†ç ï¼›å¹¶ä¸”ï¼Œå…¬å¸åªéœ€è¦å°†ç”¨æˆ·è¾“å…¥çš„å¯†ç è¿›è¡Œå“ˆå¸Œæ“ä½œï¼Œå°†å“ˆå¸Œå€¼ä¸å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å“ˆå¸Œå€¼è¿›è¡Œå¯¹æ¯”å°±èƒ½å¤ŸéªŒè¯ç”¨æˆ·äº†ã€‚\nå“ˆå¸Œçš„å…¶ä»–ç”¨æ³• æ•°æ®æ ¡éªŒï¼š\n  Gitçš„- git commit id\næ¯æ¬¡gitæäº¤åéƒ½æœ‰ä¸€ä¸ªcommit idï¼Œæ¯”å¦‚:\n19d02d2cc358e59b3d04f82677dbf3808ae4fc40\n  ç‰ˆæƒæ ¡éªŒ\nåˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯ä¸æ˜¯ä¸€æ ·çš„ï¼Œå¯¹ä¸¤ä¸ªæ–‡ä»¶éƒ½è¿›è¡Œå“ˆå¸Œæ“ä½œï¼Œå¾—åˆ°å“ˆå¸Œå€¼ï¼Œè‹¥å“ˆå¸Œå€¼ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªæ–‡ä»¶ä¸ºåŒä¸€ä¸ªæ–‡ä»¶ã€‚\n  å¤§æ–‡ä»¶åˆ†å—æ ¡éªŒ\nä¾‹å¦‚ä½¿ç”¨btä¸‹è½½ï¼Œåœ¨p2pç½‘ç»œä¸­ä¼šæŠŠä¸€ä¸ªå¤§æ–‡ä»¶æ‹†åˆ†æˆå¾ˆå¤šå°çš„æ•°æ®å„è‡ªä¼ è¾“ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯å¦‚æœæŸä¸ªå°çš„æ•°æ®å—åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æŸåäº†ï¼Œåªè¦é‡æ–°ä¸‹è½½è¿™ä¸ªå—å°±å¥½ã€‚ä¸ºäº†ç¡®ä¿æ¯ä¸€ä¸ªå°çš„æ•°æ®å—éƒ½æ˜¯å‘å¸ƒè€…è‡ªå·±ä¼ è¾“çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯ä¸€ä¸ªå°çš„æ•°æ®å—éƒ½è¿›è¡Œä¸€ä¸ªhashçš„è®¡ç®—ï¼Œç»´æŠ¤ä¸€ä¸ªhash Listï¼Œåœ¨æ”¶åˆ°æ‰€æœ‰æ•°æ®ä»¥åï¼Œæˆ‘ä»¬å¯¹äºè¿™ä¸ªhash Listé‡Œçš„æ¯ä¸€å—è¿›è¡Œéå†æ¯”å¯¹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¼˜åŒ–ç‚¹æ˜¯å¦‚æœæ–‡ä»¶åˆ†å—ç‰¹åˆ«å¤šçš„æ—¶å€™ï¼Œå¦‚æœéå†å¯¹æ¯”å°±ä¼šæ•ˆç‡æ¯”è¾ƒä½ã€‚å¯ä»¥æŠŠæ‰€æœ‰åˆ†å—çš„hashå€¼ç»„åˆæˆä¸€ä¸ªå¤§çš„å­—ç¬¦ä¸²ï¼Œå¯¹äºè¿™ä¸ªå­—ç¬¦ä¸²å†åšä¸€æ¬¡Hashè¿ç®—ï¼Œå¾—åˆ°æœ€ç»ˆçš„hashï¼ˆRoot hashï¼‰ã€‚åœ¨å®é™…çš„æ ¡éªŒä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æ‹¿åˆ°äº†æ­£ç¡®çš„Root hashï¼Œå³å¯æ ¡éªŒHash Listï¼Œä¹Ÿå°±å¯ä»¥æ ¡éªŒæ¯ä¸€ä¸ªæ•°æ®å—äº†ã€‚\n  è´Ÿè½½å‡è¡¡ï¼š\nä¸€è‡´æ€§hashçš„åŸºæœ¬åŸç†æ˜¯å°†è¾“å…¥çš„å€¼hashåï¼Œå¯¹ç»“æœçš„hashå€¼è¿›è¡Œ2^32å–æ¨¡ï¼Œè¿™é‡Œå’Œæ™®é€šçš„hashå–æ¨¡ç®—æ³•ä¸ä¸€æ ·çš„ç‚¹æ˜¯åœ¨ä¸€è‡´æ€§hashç®—æ³•é‡Œå°†å–æ¨¡çš„ç»“æœæ˜ å°„åˆ°ä¸€ä¸ªç¯ä¸Šã€‚å°†ç¼“å­˜æœåŠ¡å™¨ä¸è¢«ç¼“å­˜å¯¹è±¡éƒ½æ˜ å°„åˆ°hashç¯ä¸Šä»¥åï¼Œä»è¢«ç¼“å­˜å¯¹è±¡çš„ä½ç½®å‡ºå‘ï¼Œæ²¿é¡ºæ—¶é’ˆæ–¹å‘é‡åˆ°çš„ç¬¬ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå°±æ˜¯å½“å‰å¯¹è±¡å°†è¦ç¼“å­˜äºçš„æœåŠ¡å™¨ï¼Œç”±äºè¢«ç¼“å­˜å¯¹è±¡ä¸æœåŠ¡å™¨hashåçš„å€¼æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ï¼Œåœ¨æœåŠ¡å™¨ä¸å˜çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªopenidå¿…å®šä¼šè¢«ç¼“å­˜åˆ°å›ºå®šçš„æœåŠ¡å™¨ä¸Šï¼Œé‚£ä¹ˆï¼Œå½“ä¸‹æ¬¡æƒ³è¦è®¿é—®è¿™ä¸ªç”¨æˆ·çš„æ•°æ®æ—¶ï¼Œåªè¦å†æ¬¡ä½¿ç”¨ç›¸åŒçš„ç®—æ³•è¿›è¡Œè®¡ç®—ï¼Œå³å¯ç®—å‡ºè¿™ä¸ªç”¨æˆ·çš„æ•°æ®è¢«ç¼“å­˜åœ¨å“ªä¸ªæœåŠ¡å™¨ä¸Šï¼Œç›´æ¥å»å¯¹åº”çš„æœåŠ¡å™¨æŸ¥æ‰¾å¯¹åº”çš„æ•°æ®å³å¯ã€‚è¿™é‡Œçš„é€»è¾‘å…¶å®å’Œç›´æ¥å–æ¨¡çš„æ˜¯ä¸€æ ·çš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nè¿™éƒ¨åˆ†ä¸æ˜¯å¾ˆæ·±å…¥ï¼Œä¹‹åå†è¡¥å……\u0026hellip;\u0026hellip;ğŸš´\nå‚è€ƒé“¾æ¥ï¼š\n https://www.zhihu.com/question/26762707?sort=created-çŸ¥ä¹ åŠ¨ç”»ï¼šä»€ä¹ˆæ˜¯æ•£åˆ—è¡¨ï¼Ÿ-äº”åˆ†é’Ÿç®—æ³• ä»€ä¹ˆæ˜¯ hashï¼Ÿ-çŸ¥ä¹   MD5 å³ Message-Digest Algorithm 5ï¼ˆä¿¡æ¯-æ‘˜è¦ç®—æ³•5ï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚æ˜¯è®¡ç®—æœºå¹¿æ³›ä½¿ç”¨çš„æ‚å‡‘ç®—æ³•ä¹‹ä¸€ï¼Œä¸»æµç¼–ç¨‹è¯­è¨€æ™®éå·²æœ‰ MD5 å®ç°ã€‚ \u0026#x21a9;\u0026#xfe0e;\n SHA-1ï¼ˆè‹±è¯­ï¼šSecure Hash Algorithm 1ï¼Œä¸­æ–‡åï¼šå®‰å…¨æ•£åˆ—ç®—æ³•1ï¼‰æ˜¯ä¸€ç§å¯†ç æ•£åˆ—å‡½æ•°ï¼ŒSHA-1å¯ä»¥ç”Ÿæˆä¸€ä¸ªè¢«ç§°ä¸ºæ¶ˆæ¯æ‘˜è¦çš„160ä½ï¼ˆ20å­—èŠ‚ï¼‰æ•£åˆ—å€¼ï¼Œæ•£åˆ—å€¼é€šå¸¸çš„å‘ˆç°å½¢å¼ä¸º40ä¸ªåå…­è¿›åˆ¶æ•°ã€‚ \u0026#x21a9;\u0026#xfe0e;\n  ","description":"","id":45,"section":"posts","tags":["Hash","Algorithm","md5","sha"],"title":"ä»€ä¹ˆæ˜¯Hashï¼Ÿ","uri":"https://hugo.jiahongw.com/zh/posts/hash/"},{"content":"æ’åºæ˜¯æœ€åŸºæœ¬çš„ç®—æ³•ï¼Œé‡Œé¢åŒ…å«äº†æœ€åŸºç¡€çš„æ€æƒ³ã€‚ä¸€ä¸ªç®€å•çš„ä¼˜åŒ–å¯ä»¥è®©æ’åºå¿«å¾ˆå¤šã€‚\n$O(n^2)$çš„æ’åºç®—æ³• å†’æ³¡æ’åº 1 2 3 4 5 6 7 8 9 10 11 12 13  //å†’æ³¡æ’åº template \u0026lt;typename T\u0026gt; void bubbleSort(T *arr, int size) { for (int i = 0; i \u0026lt; size; ++i) { for (int j = 0; j \u0026lt; size - i - 1; ++j) { if (arr[j] \u0026gt; arr[j + 1]) swap(arr[j], arr[j + 1]); } } }   æ’å…¥æ’åº â€‹\n1 2 3 4 5 6 7 8 9  template\u0026lt;typename T\u0026gt; void insertSort(T *arr,int size) { for(int i = 0;i \u0026lt; size;++i) { int j; for(j = i;j \u0026gt; 0 \u0026amp;\u0026amp; arr[j] \u0026lt; arr[j-1];--j){swap(arr[j],arr[j-1]);} } }   é€‰æ‹©æ’åº 1 2 3 4 5 6 7 8 9 10 11 12 13 14  //é€‰æ‹©æ’åº å¤æ‚åº¦O(n^2) template\u0026lt;typename T\u0026gt; void selectionSort(T *arr,int size) { int k; for(int i = 0;i \u0026lt; size-1; ++i) { k = i; for(int j = i+1;j \u0026lt; size;++j) if(arr[j] \u0026lt; arr[k]) k = j; if(k != i) mySwap(arr[k],arr[i]); } }   æµ‹è¯•æ’åºä½¿ç”¨æ—¶é—´çš„æ—¶å€™ï¼Œæ€»æ˜¯é€‰æ‹©æ’åºå¿«äºæ’å…¥æ’åºï¼ŒæŒ‰ç†è¯´ï¼Œæ’å…¥æ’åºåº”è¯¥æ¯”é€‰æ‹©æ’åºè¦å¿«å•Šï¼Œå› ä¸ºæ’å…¥æ’åºå¯ä»¥æå‰ç»ˆæ­¢å¾ªç¯ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\n åŸå› æ˜¯é€‰æ‹©æ’åºæ¯”è¾ƒçš„æ˜¯ä¸‹æ ‡ï¼Œè€Œæ’å…¥æ’åºæ¯ä¸€æ¬¡æ¯”è¾ƒéƒ½è¦äº¤æ¢ï¼Œè€Œäº¤æ¢æ‰€è€—è´¹çš„æ—¶é—´æ˜¯é«˜äºç®€å•çš„æ¯”è¾ƒçš„ã€‚\n æ’å…¥æ’åºä¼˜åŒ–-å°†äº¤æ¢å˜æˆèµ‹å€¼\n1 2 3 4 5 6 7 8 9 10 11  template\u0026lt;typename T\u0026gt; void insertSort(T *arr,int size) { for(int i = 0;i \u0026lt; size;++i) { T e = arr[i]; int j; for(j = i;j \u0026gt; 0 \u0026amp;\u0026amp; arr[j-1] \u0026gt; e;--j){arr[j] = arr[j-1];} arr[j] = e; } }   è¿è¡Œæ—¶é—´æ˜æ˜¾å˜å¿«äº†\n å¯¹äºè¿‘ä¹æœ‰åºçš„æ•°æ®æ¥è¯´ï¼Œæ’å…¥æ’åºçš„é€Ÿåº¦è¦å¿«å¾ˆå¤šï¼Œè¿‘ä¹$O (n)$ã€‚è€Œæ’å…¥æ’åºçš„å®é™…åº”ç”¨æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚æ—¥å¿—ï¼Œæ—¥å¿—çš„æ—¶é—´æ˜¯è¿‘ä¹æœ‰åºçš„ï¼Œä½†æ˜¯ç”Ÿæˆæ—¥å¿—å¯èƒ½ä¼šå‡ºé”™ï¼Œéœ€è¦è¿›è¡Œæ—¶é—´æ’åºå¤„ç†ï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨æ’å…¥æ’åºä¼šæ›´å¥½ï¼›è¿˜æœ‰é“¶è¡Œçš„ä¸€äº›æµæ°´å•ç­‰ç­‰\n æ‹“å±•ï¼š C++è¿ç®—ç¬¦é‡è½½\n ä¸€èˆ¬åœ¨ç±»ä¸­å®ç°ï¼Œæœ‰ä¸¤ç§å¯ä»¥å®ç°çš„æ–¹æ³•\n  è¿ç®—ç¬¦é‡è½½ä¾‹å­ï¼Œä½¿ç”¨åœ¨ä¸€ä¸ªç±»ä¸­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  class Student { public: string name; int score; bool operator\u0026lt;(const Student \u0026amp;otherStudent) { return this-\u0026gt;score \u0026lt; otherStudent.score; } friend ostream \u0026amp;operator\u0026lt;\u0026lt;(ostream \u0026amp;os, const Student \u0026amp;student) { os \u0026lt;\u0026lt; \u0026#34;Student:\u0026#34; \u0026lt;\u0026lt; student.name \u0026lt;\u0026lt; \u0026#34;\u0026#34;\u0026lt;\u0026lt;student.score\u0026lt;\u0026lt;endl; return os; } };      ä½¿ç”¨å‹å…ƒå‡½æ•°\n1 2 3 4 5 6 7 8  è¿”å›å€¼ç±»å‹ operator è¿ç®—ç¬¦(å½¢å‚è¡¨) { ... } //ä¾‹Complexæ˜¯ä¸€ä¸ªå¤æ•°ç±» friend Complex operator+(const Complex \u0026amp;c1,const Complex \u0026amp;c2){ return Complex(c1.i + c2.i,c1.j + c2.j); }     ä½¿ç”¨ç±»é‡Œé¢çš„å‡½æ•°\n1 2 3 4 5 6 7 8  è¿”å›å€¼ç±»å‹ operator è¿ç®—ç¬¦(å½¢å‚è¡¨) { ... } //ä¾‹Complexæ˜¯ä¸€ä¸ªå¤æ•°ç±» Complex operator+(const Complex \u0026amp;complex){ return Complex(this-\u0026gt;i + complex.i,this-\u0026gt;j + complex.j); }     å®ƒä»¬çš„åŒºåˆ«å°±æ˜¯å‚æ•°çš„ä¸ªæ•°ä¸åŒä»¥åŠéœ€ä¸éœ€è¦åŠ ä¸Šfridendè¿™ä¸ªå…³é”®å­—\n$O(n\\log (n))$çš„æ’åºç®—æ³• å½’å¹¶æ’åº ä»£ç å®ç°\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  template \u0026lt;typename T\u0026gt; void __merge(T *arr, int l, int middle, int r) { T aux[r - l + 1]; for (int i = l; i \u0026lt;= r; ++i) aux[i - l] = arr[i]; int i = l, j = middle + 1; for (int k = l; k \u0026lt;= r; ++k) { if (i \u0026gt; middle) { arr[k] = aux[j - l]; j++; } else if (j \u0026gt; r) { arr[k] = aux[i - l]; i++; } else if (aux[i - l] \u0026lt; aux[j - l]) { arr[k] = aux[i - l]; i++; } else { arr[k] = aux[j - l]; j++; } } } template \u0026lt;typename T\u0026gt; void __mergeSort(T *arr, int l, int r) { if (l \u0026gt;= r) return; int middle = (l + r) / 2; __mergeSort(arr, l, middle); __mergeSort(arr, middle+1, r); if(arr[middle] \u0026gt; arr[middle+1]) __merge(arr, l, middle, r); } //å½’å¹¶æ’åº template \u0026lt;typename T\u0026gt; void mergeSort(T *arr, int size) { __mergeSort(arr, 0, size - 1); }   ä¸‹é¢è¿™æ®µä»£ç çš„æ ‡è®°éƒ¨åˆ†éœ€è¦è€ƒè™‘æº¢å‡ºçš„é—®é¢˜\n å½’å¹¶æ’åºå¿«æ˜¯å¿«ï¼Œä½†æ˜¯è¦è€—è´¹å¤šä¸€å€$O(n)$çš„å­˜å‚¨ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ç©ºé—´æ¢æ—¶é—´ã€‚\n å¸Œå°”æ’åº åŠ¨ç”»æ¼”ç¤º(æ¥è‡ª@äº”åˆ†é’Ÿç®—æ³•)ï¼š\nä»£ç å®ç°:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  //å¸Œå°”æ’åº template \u0026lt;typename T\u0026gt; void shellSort(T *arr, int size) { int dk[] = {5, 3, 1}; for (int index = 0; index \u0026lt; 3; ++index) { for (int i = 0; i \u0026lt; size / dk[index]; ++i) { int j; int e = arr[i]; for (j = i + dk[index]; j \u0026gt; dk[index] \u0026amp;\u0026amp; arr[j] \u0026gt; e; j -= dk[index]) { arr[j] = arr[j - dk[index]]; } arr[j] = e; } } }    å¸Œå°”æ’åºç›¸å½“äºæ˜¯æ’å…¥æ’åºçš„å‡çº§ç‰ˆï¼Œå¢åŠ äº†ä¸€ä¸ªæ­¥é•¿å‚æ•°ï¼Œä½¿ç”¨å¸Œå°”æ’åºå¯ä»¥è®©é›¶æ•£çš„æ•°æ®å®ç°è·³è·ƒè¡Œçš„äº¤æ¢ï¼Œæœ€åé€æ¸å°†æ•°ç»„è½¬åŒ–ä¸ºæœ‰åºï¼Œè¿™æ ·æœ€åä½¿ç”¨æ­¥é•¿ä¸º1çš„æ’å…¥æ’åºå°±éå¸¸å¿«äº†ã€‚\n å¿«é€Ÿæ’åº è¢«ç§°ä¸ºäºŒåä¸–çºªå½±å“æœ€å¤§çš„ç®—æ³•ä¹‹ä¸€ï¼\nåŠ¨ç”»æ¼”ç¤º(æ¥è‡ª@äº”åˆ†é’Ÿç®—æ³•)ï¼š\nä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  template\u0026lt;typename T\u0026gt; int __partition(T *arr,int l,int r){ T v = arr[l]; int j = l; for(int i = l+1;i \u0026lt;= r;++i){ if(arr[i] \u0026lt; v){ swap(arr[i],arr[++j]); } } swap(arr[l],arr[j]); return j; } template\u0026lt;typename T\u0026gt; void __quickSort(T *arr,int l,int r) { if(l \u0026gt;= r) return; int p = __partition(arr,l,r); __quickSort(arr,l,p-1); __quickSort(arr,p+1,r); } //å¿«é€Ÿæ’åº template\u0026lt;typename T\u0026gt; void quickSort(T *arr,int size) { __quickSort(arr,0,size-1); }   ä¼˜åŒ–ä¸€ï¼š\nåœ¨æ•°ç»„çš„å…ƒç´ ä¸ªæ•°å°äº15ä¸ªçš„æ—¶å€™ä½¿ç”¨æ’å…¥æ’åºè¿›è¡Œä¼˜åŒ–:\n1 2 3 4 5 6 7 8  template\u0026lt;typename T\u0026gt; void __quickSort(T *arr,int l,int r) { + if(r - l \u0026lt;= 15) insertionSort(arr,l,r);  int p = __partition(arr,l,r); __quickSort(arr,l,p-1); __quickSort(arr,p+1,r); }   ä¼˜åŒ–äºŒï¼š\nä½¿ç”¨éšæœºå€¼ä½œä¸ºåˆ’åˆ†æ ‡å‡†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  template\u0026lt;typename T\u0026gt; int __partition(T *arr,int l,int r){ + swap(arr[l],arr[rand() % (r-l+1) + l]);  T v = arr[l]; int j = l; for(int i = l+1;i \u0026lt;= r;++i){ if(arr[i] \u0026lt; v){ swap(arr[i],arr[++j]); } } swap(arr[l],arr[j]); return j; } template\u0026lt;typename T\u0026gt; void quickSort(T *arr,int size) { + srand(time(NULL));  __quickSort(arr,0,size-1); }   ç¼ºç‚¹:\n åœ¨è¿‘ä¹æœ‰åºçš„æ•°ç»„æ’åºä¸­ï¼Œå¿«é€Ÿæ’åºçš„æ€§èƒ½å¾ˆå·®ã€‚æ—¶é—´å¤æ‚åº¦ä¹Ÿè¿‘ä¹$O(n^2 )$ å¯¹äºæœ‰å¾ˆå¤šé‡å¤å…ƒç´ çš„æ•°ç»„ï¼Œå¿«é€Ÿæ’åºçš„æ€§èƒ½ä¹Ÿå¾ˆå·®  å¿«é€Ÿæ’åºç‰ˆæœ¬äºŒï¼šä¸¤è·¯å¿«æ’ ä½¿ç”¨ä¸¤ä¸ªä¸‹æ ‡åˆ†åˆ«å¤„ç†å¤§äºvä¸å°äºvçš„éƒ¨åˆ†ã€‚(vä¸ºåŸºå‡†å…ƒç´ )\nä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  template\u0026lt;typename T\u0026gt; int __partition2(T *arr,int l,int r){ swap(arr[l],arr[rand() % (r-l+1) + l]); T v = arr[l]; int i = l + 1,j = r; while(true) { while(arr[i] \u0026lt; v \u0026amp;\u0026amp; i \u0026lt;= r) ++i; while(arr[j] \u0026gt; v \u0026amp;\u0026amp; j \u0026gt;= l+1) --j; if(i \u0026gt; j) break; swap(arr[i++],arr[j--]); } swap(arr[l],arr[j]); return j; } template\u0026lt;typename T\u0026gt; void __quickSort2(T *arr,int l,int r) { if(r - l\u0026lt;= 15){ insertSort(arr,l,r); return; } int p = __partition2(arr,l,r); __quickSort2(arr,l,p-1); __quickSort2(arr,p+1,r); } //å¿«é€Ÿæ’åºç‰ˆæœ¬äºŒï¼ŒåŒè·¯å¿«æ’ template\u0026lt;typename T\u0026gt; void quickSort2(T *arr,int size) { srand(time(NULL)); __quickSort2(arr,0,size-1); }   å¿«é€Ÿæ’åºç‰ˆæœ¬ä¸‰ï¼šä¸‰è·¯å¿«æ’ ä½¿ç”¨ä¸‰ä¸ªä¸‹æ ‡åˆ†åˆ«å¤„ç†å¤§äºvã€ç­‰äºvä¸å°äºvçš„éƒ¨åˆ†ã€‚(vä¸ºåŸºå‡†å…ƒç´ )\nä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  template\u0026lt;typename T\u0026gt; void __quickSort3(T *arr,int l,int r) { if(r - l\u0026lt;= 15){ insertSort(arr,l,r); return; } swap(arr[l],arr[rand() % (r-l+1) + l]); T v = arr[l]; int lt = l; //arr[l+1...lt] \u0026lt; v  int gt = r + 1; //arr[gt...r] \u0026gt; v  int i = l+1; //arr[lt+1...i] == v  while(i \u0026lt; gt){ if(arr[i] \u0026lt; v){ swap(arr[i++],arr[++lt]); }else if(arr[i] \u0026gt; v){ swap(arr[i],arr[--gt]); }else{ i++; } } swap(arr[l],arr[lt]); __quickSort3(arr,l,lt-1); __quickSort3(arr,gt,r); } //å¿«é€Ÿæ’åºç‰ˆæœ¬ä¸‰ï¼Œä¸‰è·¯å¿«æ’ template\u0026lt;typename T\u0026gt; void quickSort3(T *arr,int size) { srand(time(NULL)); __quickSort3(arr,0,size-1); }   å †æ’åº åŸºæ•°æ’åº æ¡¶æ’åº æ’åºç®—æ³•æ€»ç»“ å›¾ç‰‡ï¼š\næœªå®Œå¾…ç»­\u0026hellip;\u0026hellip;ğŸ›´\nå‚è€ƒï¼š\n https://www.cnblogs.com/onepixel/p/7674659.html https://github.com/MisterBooo/Article ","description":"","id":46,"section":"posts","tags":["ç®—æ³•","æ’åº","C++"],"title":"æ’åºç®—æ³•æ€»ç»“","uri":"https://hugo.jiahongw.com/zh/posts/algorithmstructure/sort/"},{"content":"æœºå™¨å­¦ä¹ æœ‰è¿™äº›åŸºæœ¬çš„ç®—æ³•ç»„æˆï¼Œè¦é—¨æœºå™¨å­¦ä¹ ï¼Œå°±éœ€è¦æ‰“ä¸ªåœ°åŸºâœ’\nKè¿‘é‚»ç®—æ³•-KNN-(k-Nearest-Neighbors) å¯ä»¥è§£å†³çš„é—®é¢˜:\n åˆ†ç±»é—®é¢˜ å›å½’é—®é¢˜  é¢„æµ‹ä¸€ä¸ªäººæ˜¯å¤©æ‰è¿˜æ˜¯ç™½ç—´ é¦–å…ˆå…ˆç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®ï¼Œ,x1å’Œx2åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªç‰¹å¾\nIQå€¼ä½çš„æ•°æ®\n1 2 3  x1_low = np.random.random(10) + 3 x2_low = np.random.random(10) + 6 x1_low,y2_low   (array([3.72183336, 3.16146551, 3.88914234, 3.85673496, 3.1573191 , 3.4293751 , 3.96033808, 3.78793864, 3.94939642, 3.57378294]), array([6.47227974, 6.49537929, 6.98666118, 6.79440424, 6.99201224, 6.73386195, 6.63275792, 6.65411763, 6.42891099, 6.49695701])) IQå€¼é«˜çš„æ•°æ®\n1 2 3  x1_high = 4 + np.random.random(8) x2_high = 7 + np.random.random(8) x1_high,x2_high   (array([4.39543051, 4.73302502, 4.02667743, 4.46232039, 4.68128181, 4.92115752, 4.45267816, 4.84647668]), array([7.40538131, 7.3356809 , 7.90412483, 7.45237382, 7.15550294, 7.3764611 , 7.52492352, 7.67692014])) æ€»çš„æ•°æ®å’Œæ ‡ç­¾\n1 2 3 4 5 6  x1 = np.append(x1_low,x1_high) x2 = np.append(x2_low,x2_high) x_train = np.c_[x1.T,x2.T] print(x_train) y_train = np.append(np.zeros_like(x_low),np.ones_like(x_high)) print(y_train)   [[3.72183336 6.47227974] [3.16146551 6.49537929] [3.88914234 6.98666118] [3.85673496 6.79440424] [3.1573191 6.99201224] [3.4293751 6.73386195] [3.96033808 6.63275792] [3.78793864 6.65411763] [3.94939642 6.42891099] [3.57378294 6.49695701] [4.28739637 7.71057536] [4.31513454 7.70173516] [4.10934692 7.38111019] [4.35094666 7.33731866] [4.01739934 7.41472044] [4.98558165 7.72054925] [4.80075428 7.12604512] [4.48912715 7.08753069]] [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1.] ç»˜åˆ¶æ•£ç‚¹å›¾\n1 2 3 4 5  plt.scatter(x_train[y_train==0,0],x_train[y_train==0,1]) plt.scatter(x_train[y_train==1,0],x_train[y_train==1,1]) plt.xlabel(\u0026#39;t\u0026#39;) plt.ylabel(\u0026#39;IQ\u0026#39;) plt.show()    ä¸Šå›¾çº¢è‰²è¡¨ç¤ºå¤©æ‰ï¼Œè“è‰²è¡¨ç¤ºç™½ç—´\n å‡è®¾è¾“å…¥ä¸€ä¸ªæ ·æœ¬çš„æ•°æ®ä¸º (4.36,7.465)ï¼Œåˆ¤æ–­å®ƒå¤©æ‰è¿˜æ˜¯ç™½ç—´\n1 2 3 4 5 6 7 8  example = np.array([4.36,7.456]) # é¦–å…ˆå†å›¾ä¸Šç”»å‡ºæ¥è§‚å¯Ÿ plt.scatter(x_train[y_train==0,0],x_train[y_train==0,1]) plt.scatter(x_train[y_train==1,0],x_train[y_train==1,1]) plt.scatter(example[0],example[1],color=\u0026#39;black\u0026#39;) plt.xlabel(\u0026#39;t\u0026#39;) plt.ylabel(\u0026#39;IQ\u0026#39;) plt.show()    é»‘ç‚¹è¡¨ç¤ºè¾“å…¥çš„æ ·æœ¬\n è·å–è·ç¦»åˆ—è¡¨\n1 2  distance = [sqrt(sum(((x-example)**2))) for x in x_train] distance   [1.172587826601725, 1.5359938425092403, 0.6648201732802982, 0.8312548678718089, 1.2890795094301544, 1.177941448784469, 0.9151268590623418, 0.9850226059672444, 1.1061225623709607, 1.2401212526176475, 0.2647260841097585, 0.24979727210937175, 0.26160170347749107, 0.1190261413334191, 0.3450785650776031, 0.6792191910080055, 0.5505765678982287, 0.39044007348145965] å¯¹äºKNNï¼Œå‡è®¾k=3ï¼Œå°±æ˜¯æ±‚å‡ºä¸æ ·æœ¬æœ€è¿‘çš„ä¸‰ä¸ªç‚¹çš„æ•°æ®\n1 2  result = np.argsort(distance) result[:k]   array([13, 11, 12], dtype=int64)  å¯ä»¥å¾—çŸ¥ï¼Œå‰ä¸‰ä¸ªçš„è®­ç»ƒæ ·æœ¬çš„ç‚¹çš„ä¸‹æ ‡åˆ†åˆ«å›´æ®´13ï¼Œ11ï¼Œ12\n æ¥ä¸‹æ¥æ ¹æ®è¿™ä¸‰ä¸ªè®­ç»ƒæ ·æœ¬çš„ç±»åˆ«æ¥é¢„æµ‹è¾“å…¥çš„æ ·æœ¬æ˜¯å¤©æ‰è¿˜æ˜¯ç™½ç—´ï¼Œå‡å¦‚è¿™ä¸‰ä¸ªè®­ç»ƒæ ·æœ¬æ˜¯å¤©æ‰çš„æ•°é‡å¤šäºç™½ç—´ï¼Œå°±è®¤ä¸ºå®ƒæ˜¯å¤©æ‰ï¼›ä¸ç„¶ï¼Œå°±è®¤ä¸ºå®ƒæ˜¯ç™½ç—´\n1 2 3 4 5 6 7  from collections import Counter votes = Counter(r) y_hat = votes.most_common(1)[0][0] if y_hat == 1: print(\u0026#34;é¢„æµ‹å®ƒä¸ºå¤©æ‰\u0026#34;) else: print(\u0026#34;é¢„æµ‹å®ƒä¸ºç™½ç—´\u0026#34;)   é¢„æµ‹å®ƒä¸ºå¤©æ‰ ä¸»æˆåˆ†åˆ†ææ³•-PCA-(Principal Component Analysis)  PACä¸»è¦ç”¨äºæ•°æ®çš„é™ç»´\n äºŒç»´é™åˆ°ä¸€ç»´\n ç”±ä¸Šé¢ä¸¤ä¸ªé™ç»´çš„å›¾æ¥çœ‹ï¼Œç¬¬äºŒå¼ å›¾ç‰‡æ˜¯ä¸€ä¸ªæ›´å¥½çš„å›¾ï¼Œå› ä¸ºå›¾äºŒç‚¹å’Œç‚¹çš„è·ç¦»ç›¸å¯¹æ¯”è¾ƒå¤§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç‚¹ä¹‹é—´çš„åŒºåˆ†åº¦æ¯”è¾ƒé«˜\n æ›´å¥½çš„é™ç»´æ–¹æ¡ˆ\n æ­¤æ—¶ç‚¹å’Œç‚¹ä¹‹é—´çš„è·ç¦»æœ€å¤§ï¼ŒåŒºåˆ†åº¦æ›´å¤§\n é‚£ä¹ˆå¦‚ä½•å®šä¹‰æ ·æœ¬ä¹‹é—´çš„é—´è·å‘¢ï¼Ÿ\nå¯ä»¥ä½¿ç”¨æ–¹å·®(Variance),æ–¹å·®å¯ä»¥è¡¨ç¤ºæ ·æœ¬æ•´ä½“åˆ†å¸ƒçš„ç–å¯†ç¨‹åº¦\n$$\nVar(x) = \\frac{1}{m}\\sum_{i = 1}^{m}(x_{i} - \\bar x)^2\n$$\nå¯ä»¥è½¬åŒ–æˆï¼š\nâ€‹\tå¸Œæœ›æ‰¾åˆ°ä¸€æ¡è½´ï¼Œä½¿å¾—æ ·æœ¬æŠ•å½±åˆ°è¯¥è½´ä¸Šçš„å„ç‚¹ä¹‹é—´çš„æ–¹å·®æœ€å¤§\nPCAæ“ä½œæ­¥éª¤ï¼š\n  å°†æ ·ä¾‹çš„å‡å€¼å½’ä¸º0(demean)\nè¿™æ ·ï¼Œå°±ç›¸å½“äºåæ ‡è½´å˜æˆå¦‚ä¸‹çš„å›¾ï¼š\n  å½“å‡å€¼$\\bar x = 0$æ—¶ï¼ŒåŸæ¥çš„æ–¹å·®å…¬å¼å˜ä¸º\n$$\nVar(x) = \\frac{1}{m}\\sum_{i = 1}^{m}(x_{i} - \\bar x)^2 \\Rightarrow Var(x) = \\frac{1}{m}\\sum_{i = 1}^{m}x_{i}^2\n$$\nå‡è®¾ä¸¤ä¸ªç»´åº¦çš„ç‰¹å¾ä¸º$w1$,$w2$,é‚£ä¹ˆéœ€è¦æ±‚å¾—çš„ç›´çº¿çš„æ–¹å‘ä¸º$w =ï¼ˆw_{1},w_{2}ï¼‰$,æ˜ å°„åˆ°$w$åï¼Œæœ‰:\n$$\nVar(X_{project}) = \\frac{1}{m} \\sum_{1}^{m} (X_{project}^{(i)} - \\bar X{project})^2\n$$\nä½¿å¾—ä¸Šé¢çš„å…¬å¼æœ€å¤§\nå…¶å®æœ€åçš„ç»“æœè¿˜æ˜¯å‘é‡ï¼Œå› ä¸º$X$æ¯ä¸€ä¸ªç‚¹éƒ½åŒ…å«ä¸¤ä¸ªå…ƒç´ ï¼Œå³åº”è¯¥æ˜¯\nç”±å‡å€¼ä¸º0ï¼Œå¾—åˆ°\n  è®¡ç®—è¿‡ç¨‹\nç›®æ ‡å³ï¼š\nä¸çº¿æ€§å›å½’çš„ä¸åŒï¼š\n PCAçš„ä¸¤ä¸ªåæ ‡è½´è¡¨ç¤ºçš„æ˜¯ä¸¤ä¸ªç‰¹å¾ï¼Œè€Œçº¿æ€§å›å½’çš„æ¨ªè½´æ˜¯ç‰¹å¾ï¼Œçºµè½´æ˜¯è¾“å‡ºæ ‡è®° PCAä½¿å¾—ç‚¹ä¹‹é—´çš„æ–¹å·®æœ€å¤§ï¼Œè€Œçº¿æ€§å›å½’åˆ™æ˜¯éœ€è¦ä½¿å¾—è¾“å‡ºæ ‡è®°å°½é‡æ‹Ÿåˆä¸€æ¡ç›´çº¿ï¼Œæ˜¯åœ¨çºµè½´ä¸Šçš„  å†³ç­–æ ‘ ä¾‹å­ï¼š\næ•°å€¼ç‰¹å¾ä¾‹å­ï¼š\nç‰¹ç‚¹ï¼š\n éå‚æ•°å­¦ä¹ ç®—æ³• å¯ä»¥è§£å†³åˆ†ç±»é—®é¢˜ å¤©ç„¶çš„è§£å†³å¤šåˆ†ç±»é—®é¢˜ ä¹Ÿå¯ä»¥è§£å†³å›å½’é—®é¢˜ éå¸¸å¥½çš„å¯è§£é‡Šæ€§  é—®é¢˜ï¼š\n æ¯ä¸ªèŠ‚ç‚¹åœ¨å“ªä¸ªç»´åº¦ä½œåˆ’åˆ† æŸä¸ªç»´åº¦çš„å“ªä¸ªå€¼ä½œåˆ’åˆ†    æ”¯æŒå‘é‡æœº-SVM-(Support Vector Machine) ä¸»è¦æ€æƒ³ï¼š\nSVMåˆ†ç±»:\n  Hard Margin SVM\tè§£å†³çš„æ˜¯çº¿æ€§å¯åˆ†é—®é¢˜\n  Soft Margin SVM å¯è§£å†³çº¿æ€§ä¸å¯åˆ†é—®é¢˜\n  ğŸ¤ æœªå®Œå¾…ç»­\u0026hellip;\u0026hellip;\n","description":"æœºå™¨å­¦ä¹ å¿…é¡»æŒæ¡çš„åŸºç¡€ç®—æ³•ï¼Œå­¦ä¼šè¿™äº›åŸºç¡€ï¼Œå¯¹åé¢çš„ç†è§£æ‰ä¼šé€å½»","id":47,"section":"posts","tags":["æœºå™¨å­¦ä¹ ","SVM","å†³ç­–æ ‘","kNN","PCA"],"title":"æœºå™¨å­¦ä¹ åŸºæœ¬ç®—æ³•","uri":"https://hugo.jiahongw.com/zh/posts/machine-learning-base/"},{"content":"ä¸€äº›è‹±é›„çš„å›¾æ¡ˆğŸŒ¿\n","description":"","id":48,"section":"gallery","tags":[""],"title":"Hero","uri":"https://hugo.jiahongw.com/zh/gallery/hero/"},{"content":"ä½¿ç”¨Scrapyçˆ¬å–æ–‡ç« çš„ä¸€ä¸ªå°é¡¹ç›®..\nScrapy æ¡†æ¶å›¾ï¼š\næŠ“å–å°ç¨‹åºç¤¾åŒºæ–‡ç«  åˆ›å»ºçˆ¬è™«é¡¹ç›® åˆ›å»ºé¡¹ç›®ï¼ˆé¡¹ç›®åä¸ºMyTestï¼‰\n1  scrapy startproject MyTest   åˆ›å»ºçˆ¬è™«ğŸ(å…ˆè¿›å…¥åˆ°MyTestç›®å½•)\n1  scrapy genspider -t crawl wx wxapp-union.com    wxä¸ºçˆ¬è™«çš„åå­—ï¼Œwxapp-union.comä¸ºçˆ¬å–çš„åŸŸåï¼Œä½¿ç”¨äº†æ¨¡æ¿crawl\n å®šä¹‰çˆ¬å–çš„æ•°æ®ç»“æ„ çˆ¬å–çš„æ•°æ®ç»“æ„ç±»ç»§æ‰¿Itemç±»ï¼Œåœ¨items.pyæ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹æ˜¯è®¾ç½®éœ€è¦çˆ¬å–çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­åŒ…æ‹¬:æ ‡é¢˜ã€ä½œè€…ã€æ—¶é—´ã€è®¿é—®è€…ã€å‰è¨€ã€æ­£æ–‡ã€‚\n1 2 3 4 5 6 7 8 9 10  from scrapy import Item,Field # å®šä¹‰æ–‡ç« æ•°æ®ç»“æ„ class ArticleItem(Item): title = Field() author = Field() _time = Field() visitors = Field() pre_talk = Field() article_content = Field()   ç¼–å†™çˆ¬è™«è§„åˆ™ä¸è§£æè§„åˆ™  çˆ¬è™«çš„çˆ¬å–ç½‘é¡µçš„é“¾æ¥çš„è§„åˆ™å’Œè§£æé¡µé¢çš„è§„åˆ™éƒ½æ˜¯åœ¨æ–°å»ºçš„spideræ–‡ä»¶ä¸­çš„ç±»ä¸­ï¼Œä¹Ÿå³åœ¨wx.pyä¸­\n ç¼–å†™çš„spiderç±»å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  import scrapy from scrapy.linkextractors import LinkExtractor from scrapy.spiders import CrawlSpider, Rule from MyTest.items import ArticleItem class WxSpider(CrawlSpider): name = \u0026#39;wx\u0026#39; allowed_domains = [\u0026#39;wxapp-union.com\u0026#39;] start_urls = [\u0026#39;http://www.wxapp-union.com/portal.php?mod=list\u0026amp;catid=2\u0026amp;page=255\u0026#39;] rules = ( Rule(LinkExtractor(allow=r\u0026#39;.+mod=list\u0026amp;catid=2\u0026amp;page=\\d\u0026#39;), follow=True), Rule(LinkExtractor(allow=r\u0026#39;.+article-.+\\.html\u0026#39;),callback=\u0026#34;parse_item\u0026#34;,follow=False) ) def parse_item(self, response): title = response.xpath(\u0026#39;//h1[@class=\u0026#34;ph\u0026#34;]/text()\u0026#39;).get() author = response.xpath(\u0026#39;//p[@class=\u0026#34;authors\u0026#34;]//a\u0026#39;).get() _time = response.xpath(\u0026#39;//span[@class=\u0026#34;time\u0026#34;]/text()\u0026#39;).get() visitors = response.xpath(\u0026#39;//div[contains(@class,\u0026#34;focus_num\u0026#34;)]//a/text()\u0026#39;).get() pre_talk = response.xpath(\u0026#39;//div[@class=\u0026#34;blockquote\u0026#34;]//p/text()\u0026#39;).get() article_content = response.xpath(\u0026#39;//td[@id=\u0026#34;article_content\u0026#34;]\u0026#39;).get() item = ArticleItem(title=title,author=author,_time=_time,visitors=visitors,pre_talk=pre_talk,article_content=article_content) print(\u0026#39;*\u0026#39;*40) print(title) print(\u0026#39;*\u0026#39;*40) return item    é¦–å…ˆruleså®šä¹‰äº†çˆ¬å–é“¾æ¥è§„åˆ™ï¼Œæœ‰ä¸¤ä¸ªè§„åˆ™ï¼Œç¬¬ä¸€ä¸ªè§„åˆ™æ˜¯çˆ¬å–é¡µé¢çš„é“¾æ¥ï¼Œæ¯ä¸€é¡µæœ‰å¤šä¸ªæ–‡ç« çš„é“¾æ¥ï¼Œè€Œç¬¬äºŒä¸ªè§„åˆ™åˆ™æ˜¯å®šä¹‰çˆ¬å–çš„å…·ä½“æ–‡ç« å†…å®¹çš„é“¾æ¥ã€‚ ç¬¬ä¸€ä¸ªè§„åˆ™éœ€è¦Followï¼Œå› ä¸ºéœ€è¦æ ¹æ®æ¯ä¸€é¡µçš„å†…å®¹æŸ¥æ‰¾æ–‡ç« çš„é“¾æ¥ï¼›è€Œç¬¬äºŒä¸ªè§„åˆ™æ˜¯æ–‡ç« é“¾æ¥ï¼Œæ•…ä¸éœ€è¦ç»§ç»­Follow ç¬¬ä¸€ä¸ªé¡µé¢é“¾æ¥è§„åˆ™ä¸éœ€è¦å›è°ƒå‡½æ•°ï¼Œå› ä¸ºä¸éœ€è¦è§£æï¼Œåªéœ€è¦è·å–æ–‡ç« é“¾æ¥ï¼›ç¬¬äºŒä¸ªæ–‡ç« é“¾æ¥è§„åˆ™åˆ™éœ€è¦è®¾ç½®å›è°ƒå‡½æ•°æ¥å¯¹è¿”å›çš„æ–‡ç« ç½‘é¡µå†…å®¹è¿›è¡Œè§£æã€‚  parse_itemè¯´æ˜ï¼š\n parse_itemæ˜¯è§£æé¡µé¢è¿”å›å†…å®¹çš„å‡½æ•°ï¼Œå…¶è¿”å›Itemæ•°æ®ç»“æ„ï¼Œä½¿ç”¨Xpathåˆ†åˆ«è·å–æ•°æ®ç»“æ„å„ä¸ªå…ƒç´ çš„å†…å®¹å¹¶ä¸”è¿”å›Item\n ä¿å­˜æ•°æ®  pipelinesæ˜¯ä¸€ä¸ªæœ€åå¤„ç†Itemçš„ç®¡é“\n åœ¨pipelines.pyæ–‡ä»¶ä¸­æ–°å»ºpiplelineå¯¹è¿”å›çš„Itemè¿›è¡Œå¤„ç†ï¼Œå¯ä»¥ä¿å­˜ä¸ºæ–‡ä»¶ï¼Œæˆ–è€…å­˜å‚¨åˆ°æ•°æ®åº“ã€‚\né¦–å…ˆæ–‡ä»¶ä¸­éœ€è¦å¯¼å…¥å¿…è¦çš„åº“â€˜\n1 2 3 4 5  import re\t# æ­£åˆ™å¤„ç† from html2text import HTML2Text\t# å°†ç½‘é¡µè½¬åŒ–ä¸ºMarkdownæ ¼å¼ from scrapy.exporters import JsonLinesItemExporter\t# è¾“å‡ºJsonæ–‡ä»¶è¾“å‡ºå™¨ from urllib.parse import urljoin\t# è¡¥å…¨URLï¼Œå› ä¸ºæœ‰äº›URLåªæ˜¾ç¤ºç›¸å¯¹ä½ç½® import pymongo\t# MongoDBæ“ä½œåº“   ç¬¬ä¸€ä¸ªPipelineï¼šä¿å­˜åˆ°Jsonæ–‡ä»¶ ç¨‹åºçš„æ„é€ å‡½æ•°æ–°å»ºä¸€ä¸ªJsonæ–‡ä»¶è¾“å‡ºå™¨ï¼Œprocess_itemè¿›è¡Œæ•°æ®çš„å­˜å‚¨ï¼Œå…³é—­çš„æ—¶å€™close_spiderä¼šè°ƒç”¨å…³é—­æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  # å­˜å‚¨åˆ°Jsonæ–‡ä»¶ä¸­ class JsonPipeline(object): def __init__(self): self.f = open(\u0026#39;wxjc.json\u0026#39;,\u0026#39;wb\u0026#39;) self.exporter = JsonLinesItemExporter(self.f, ensure_ascii=False,encoding=\u0026#34;utf-8\u0026#34;) def process_item(self, item, spider): # å°†å†…å®¹è½¬åŒ–ä¸ºMarkDownæ ¼å¼ item[\u0026#39;article_content\u0026#39;] = convert_md(item[\u0026#39;article_content\u0026#39;]) self.exporter.export_item(item) return item def close_spider(self,spider): self.f.close()   ç¬¬äºŒä¸ªPipelineï¼šä¿å­˜åˆ°Markdownæ–‡ä»¶ æ–¹æ³•ä¸ç¬¬ä¸€å‘Pipelineç±»ä¼¼ï¼Œåªæ˜¯å†™æ–‡ä»¶ä½¿ç”¨æœ€ç®€å•çš„è¿½åŠ æ–¹å¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  # å†™å…¥Markdown class MDPipeline(object): def __init__(self): self.f = open(\u0026#39;wx_teaches.md\u0026#39;,\u0026#39;a\u0026#39;,encoding=\u0026#39;utf-8\u0026#39;) def process_item(self,item,spider): if self.f: self.f.write(\u0026#39;\\n\u0026#39;) self.f.write(\u0026#34;# \u0026#34; + item[\u0026#39;title\u0026#39;] + \u0026#39;\\n\u0026#39;) header_info = \u0026#34;ä½œè€…:{} å‘å¸ƒæ—¶é—´:{} Visitors:{}\\n\u0026#34;.format(item[\u0026#39;author\u0026#39;],item[\u0026#39;_time\u0026#39;],item[\u0026#39;visitors\u0026#39;]) self.f.write(header_info) self.f.write(\u0026#39;\u0026gt; \u0026#39; + item[\u0026#39;pre_talk\u0026#39;] + \u0026#39;\\n\u0026#39;) self.f.write(item[\u0026#39;article_content\u0026#39;]) return item def close_spider(self,spider): self.f.close()   ç¬¬ä¸‰ä¸ªPilelineï¼šä¿å­˜åˆ°MongoDB å…¶ä¸­ä½¿ç”¨äº†ç±»æ–¹æ³•è£…é¥°å™¨@classmethod,æ„æ€å°±æ˜¯ç›´æ¥ç”¨ç±»åè°ƒç”¨è¯¥å‡½æ•°ï¼Œå°±èƒ½å¤Ÿç›´æ¥è¿”å›ä¸€ä¸ªMongoPipelineç±»äº†ï¼Œè¿˜å®šä¹‰äº†æ‰“å¼€spiderä¸å…³é—­spiderçš„æ“ä½œï¼Œå°±æ˜¯è¿æ¥æ•°æ®åº“ä¸å…³é—­æ•°æ®åº“\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  # å­˜å‚¨åˆ°MongoDBæ•°æ®åº“ class MongoPipeline(object): def __init__(self,mongo_uri,mongo_db): self.mongo_uri = mongo_uri self.mongo_db = mongo_db @classmethod def from_crawler(cls,crawler): return cls(mongo_uri = crawler.settings.get(\u0026#39;MONGO_URI\u0026#39;), mongo_db = crawler.settings.get(\u0026#39;MONGO_DB\u0026#39;)) def open_spider(self,spider): self.client = pymongo.MongoClient(self.mongo_uri) self.db =self.client[self.mongo_db] def process_item(self,item,spider): name = item.__class__.__name__ # \u0026lt;a href=\\\u0026#34;space-uid-17761.html\\\u0026#34;\u0026gt;Rolan\u0026lt;/a\u0026gt;  item[\u0026#39;author\u0026#39;] = re.search(\u0026#39;\u0026lt;a.*?\u0026gt;(.*?)\u0026lt;/a\u0026gt;\u0026#39;,item[\u0026#39;author\u0026#39;]).group(1) self.db[name].insert(dict(item)) return item def close_spider(self,spider): self.client.close()    æœ€åéœ€è¦åœ¨settings.pyä¸­æ·»åŠ å¦‚ä¸‹å­—æ®µ:\n1 2  MONGO_URI = \u0026#39;localhost\u0026#39; MONGO_DB = \u0026#39;WX\u0026#39;    æœ€åéœ€è¦åœ¨settings.pyä¸­æ·»åŠ å¦‚ä¸‹å­—æ®µ 1 2 3 4 5 6 7 8 9  ITEM_PIPELINES = { \u0026#39;MyTest.pipelines.JsonPipeline\u0026#39;: 300, \u0026#39;MyTest.pipelines.MDPipeline\u0026#39;: 301, \u0026#39;MyTest.pipelines.MongoPipeline\u0026#39;: 400, } # ä¿®æ”¹ä¸ºFalse ROBOTSTXT_OBEY = False # è®¾ç½®å»¶è¿Ÿ1s DOWNLOAD_DELAY = 1   å¼€å§‹çˆ¬å– å¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸­æ–°å»ºä¸€ä¸ªè„šæœ¬start.pyï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œè‡ªåŠ¨è¿è¡Œè„šæœ¬\n1 2  from scrapy import cmdline cmdline.execute(\u0026#39;scrapy crawl test\u0026#39;.split(\u0026#39;\u0026#39;))   çˆ¬å–ç»“æœ Jsonç»“æœ Markdownç»“æœ Markdownæ–‡ä»¶ç”±äºå¤ªå¤§äº†ä½¿ç”¨Markdownæ–‡ä»¶æ‰“ä¸å¼€ï¼Œåªå¥½ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€\nMongoDBç»“æœ ","description":"","id":49,"section":"posts","tags":["çˆ¬è™«","Scrapy"],"title":"Scrapyæ¡†æ¶","uri":"https://hugo.jiahongw.com/zh/posts/spider/scrapy-1/"},{"content":"å¥½çš„å·¥å…·ğŸ— å°±æˆåŠŸäº†ä¸€åŠã€‚\nå·¥å…·ğŸš¡ åˆ›é€ ä¸è®°å½• GitBook ä½¿ç”¨å‰æï¼š  å®‰è£…NodeJS ä½¿ç”¨npmå®‰è£…ï¼šnpm install gitbook-cli -g(è¿™æ˜¯å‘½ä»¤è¡Œå·¥å…·)  GitNote GitMind GitMind æ˜¯ä¸€æ¬¾å…¨æ–°çš„äº‘ç«¯æ™ºèƒ½æ€ç»´å¯¼å›¾ã€æµç¨‹å›¾åˆ¶ä½œè½¯ä»¶ï¼ŒåŒæ—¶æ”¯æŒåœ¨ç”µè„‘ã€æ‰‹æœºæµè§ˆå™¨ä¸Šä½¿ç”¨ã€‚\nå®˜ç½‘ï¼šhttps://gitmind.cn/\nå¾®ä¿¡ç‰ˆæœ¬ï¼š\nNotion Typora caliibre ä¿¡æ¯èšåˆ irreaderğŸ”– ä¸‹è½½åœ°å€:http://irreader.fatecore.com/\nç¾½é›€-äº‘ç«¯çŸ¥è¯†åº“â˜ å¦‚æœè‹±è¯­ä¸å¥½ï¼Œæˆ–è€…çœ‹ç€è‹±æ–‡çš„æ–‡æ¡£å¾ˆçƒ¦æ¼ï¼Œå¯ä»¥è¯•è¯•è¿™ä¸ªã€‚ğŸƒ\nåœ°å€:https://www.yuque.com/\nå›¾ç‰‡   https://xinquji.com/r/d232a93deb8766\n  https://burst.shopify.com/\n ","description":"å®ç”¨çš„å·¥å…·é›†åˆ","id":50,"section":"talks","tags":[""],"title":"Tools","uri":"https://hugo.jiahongw.com/zh/talks/tools/"},{"content":"All about Intresting in Github.\nPythonå¥½ç©çš„åº“ html2text  å°†ç½‘é¡µè½¬åŒ–ä¸ºMarkdownæ–‡ä»¶æ ¼å¼\n ä½¿ç”¨å‰æï¼š 1  pip install htmltotext   ä½¿ç”¨æ–¹æ³•ï¼š 1 2 3  ## è½¬åŒ–ä¸ºTEXT h = HTML2Text() text = h.handle(parse_html) # textä¸ºmarkdownæ–‡ä»¶   pypandoc  å¯¹æ–‡ä»¶è¿›è¡Œä»»æ„çš„è½¬æ¢\n ä½¿ç”¨å‰æï¼š å®‰è£…pypandocåº“ï¼špip install pypandoc.\nä½¿ç”¨æ–¹æ³• å¯¼å…¥åº“:import pypandoc\nMarkdown \u0026mdash;\u0026ndash;\u0026gt; docx 1  output = pypandoc.convert_file(\u0026#39;somefile.md\u0026#39;, \u0026#39;docx\u0026#39;, outputfile=\u0026#34;somefile.docx\u0026#34;)   Markdown \u0026mdash;\u0026ndash;\u0026gt; Rst 1 2 3  output = pypandoc.convert_file(\u0026#39;somefile.md\u0026#39;, \u0026#39;rst\u0026#39;)\t# way1 output = pypandoc.convert_file(\u0026#39;somefile.txt\u0026#39;, \u0026#39;rst\u0026#39;, format=\u0026#39;md\u0026#39;)\t# way 2 output = pypandoc.convert_text(\u0026#39;#some title\u0026#39;, \u0026#39;rst\u0026#39;, format=\u0026#39;md\u0026#39;)\t# ç›´æ¥è½¬åŒ–æ–‡æœ¬    å…¶ä¸­æœ‰å¯¹åº”çš„å·¥å…·Pandoc\n å¦‚ä½•æŠŠ Markdown æ–‡ä»¶æ‰¹é‡è½¬æ¢ä¸º PDF mdoutè½¬æ¢è„šæœ¬ é¡¹ç›®åœ°å€:https://github.com/JabinGP/mdout\nä½¿ç”¨æ–¹æ³•ï¼š  æ‰“å¼€é¡¹ç›®åœ°å€æŸ¥çœ‹ï¼Œå…¶ä¸­ä¸»è¦å‘½ä»¤ä¸º:mdout filename -t pdf\n","description":"Githubä¸Šå¥½ç©çš„é‚£äº›åº“~","id":51,"section":"talks","tags":[""],"title":"Goodåº“","uri":"https://hugo.jiahongw.com/zh/talks/github-lib/"},{"content":"ğŸš´ä¸€äº›æ”¶é›†è§†é¢‘çš„æ–¹æ³•âš’\nè§†é¢‘å½’æ€»æ–¹æ³• BiliBliè§†é¢‘åµŒå…¥ä»£ç  ä½¿ç”¨æ–¹æ³• é¦–å…ˆæ‰¾åˆ°åµŒå…¥ä»£ç \nç„¶åå¤åˆ¶ä»£ç åˆ°Markdownæ–‡ä»¶å°±å¯ä»¥å¾—åˆ°å¦‚ä¸‹æ˜¾ç¤ºæ•ˆæœï¼š\n ä»£ç å¦‚ä¸‹: 1  \u0026lt;iframe src=\u0026#34;//player.bilibili.com/player.html?aid=6731067\u0026amp;cid=10959711\u0026amp;page=1\u0026#34; scrolling=\u0026#34;no\u0026#34; border=\u0026#34;0\u0026#34; frameborder=\u0026#34;no\u0026#34; framespacing=\u0026#34;0\u0026#34; allowfullscreen=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;/iframe\u0026gt;    å…¶ä¸­å¯ä»¥åœ¨iframä¸­æ·»åŠ ç›¸å…³å±æ€§\n weiboä¸Šä¼ çš„è§†é¢‘ ä½¿ç”¨æ–¹æ³• åœ¨å¾®åšä¸­ä¸Šä¼ è§†é¢‘åï¼Œæ‰“å¼€è§†é¢‘çš„é¡µé¢ï¼ŒæŒ‰F12æ‰“å¼€å·¥å…·,é¼ æ ‡ç‚¹å‡»è§†é¢‘æ‰¾åˆ°é“¾æ¥\næ¥ä¸‹æ¥ç›´æ¥åœ¨Markdownä¸­æ·»åŠ ä»£ç \nYour browser does not support the video tag.\nä»£ç å¦‚ä¸‹:\n1  \u0026lt;video poster=\u0026#34;https://i.loli.net/2020/03/02/GabXC4JmfN6H2hE.png\u0026#34; src=\u0026#34;https://f.video.weibocdn.com/00393mgEgx07BmNCEF4j01041200eeW00E010.mp4?label=mp4_720p\u0026amp;template=1280x720.25.0\u0026amp;trans_finger=721584770189073627c6ee9d880087b3\u0026amp;Expires=1583079687\u0026amp;ssig=%2BAmJANwAPn\u0026amp;KID=unistore,video\u0026#34; style=\u0026#34;max-height :100%; max-width: 100%; display: block; margin-left: auto; margin-right: auto;\u0026#34; controls=\u0026#34;controls\u0026#34; preload=\u0026#34;meta\u0026#34;\u0026gt;Your browser does not support the video tag.\u0026lt;/video\u0026gt;   QQç©ºé—´å‘å¸ƒçš„è§†é¢‘ ä½¿ç”¨æ–¹æ³• ä¸å¾®åšçš„æ“ä½œç±»ä¼¼ï¼Œæ‰“å¼€è§†é¢‘é¡µé¢ï¼Œå…ˆç‚¹å‡»ä¸‹è½½æŒ‰é’®\nç„¶åä¼šè‡ªåŠ¨è·³è½¬ï¼Œæœç´¢æ ä¸Šçš„åœ°å€å°±æ˜¯è§†é¢‘çš„åœ°å€\næ¥ä¸‹æ¥ç›´æ¥åœ¨Markdownä¸­æ·»åŠ ä»£ç \nYour browser does not support the video tag.\nä»£ç å¦‚ä¸‹:\n1  \u0026lt;video poster=\u0026#34;https://i.loli.net/2020/03/02/GabXC4JmfN6H2hE.png\u0026#34; src=\u0026#34;http://photovideo.photo.qq.com/1075_0b53zeiu6vidieapa3kya5pdbsiej6zqhfsa.f20.mp4?dis_k=97f710c26b204f7f2312614fbcf8f897\u0026amp;dis_t=1583082992\u0026amp;vuin=1427298682\u0026amp;save=1\u0026amp;d=1\u0026#34; style=\u0026#34;max-height :100%; max-width: 100%; display: block; margin-left: auto; margin-right: auto;\u0026#34; controls=\u0026#34;controls\u0026#34; preload=\u0026#34;meta\u0026#34;\u0026gt;Your browser does not support the video tag.\u0026lt;/video\u0026gt;   ","description":"","id":52,"section":"posts","tags":["blog","è§†é¢‘","BliBli","weibo"],"title":"è§†é¢‘çš„æ”¶é›†","uri":"https://hugo.jiahongw.com/zh/posts/settings/collect-videos/"},{"content":"åœ¨Pté¡µé¢å¢åŠ äº†ä¸€äº›ç”¨JSå®ç°çš„PPTï¼Œä¸»è¦å±•ç¤ºä¸€äº›æ•ˆæœã€‚ğŸ”Œ\nç½‘é¡µPPT ä¸»é¢˜ beige black blood monokai league moon night serif simple solarized sky white ä½¿ç”¨æ–¹æ³•ğŸŒŒ åœ¨markdownæ–‡ä»¶çš„ymalå¤´éƒ¨æ·»åŠ :revealTheme: serif\nåœ¨çº¿åˆ¶ä½œPPT Slides https://slides.com/\n","description":"","id":53,"section":"posts","tags":["ppt","blog"],"title":"Slideså’Œç½‘é¡µPPT","uri":"https://hugo.jiahongw.com/zh/posts/settings/ppt-use/"},{"content":"æ•°æ®åˆ†æï¼Œbeginï¼ğŸ“…\n Latexå…¬å¼å‚è€ƒï¼š\nhttps://www.cnblogs.com/1024th/p/11623258.html\n æ¦‚ç‡åˆ†æ\nä¸­ä½æ•°\n$$\n\\frac{df(x)}{dx}\\mid_{x_{mode}=0}\n$$\nâ€‹\n","description":"","id":56,"section":"posts","tags":["æ¦‚ç‡","Latex"],"title":"Data Analysis Begin","uri":"https://hugo.jiahongw.com/zh/posts/bigdata/data-analysis-begin/"},{"content":"ä½¿ç”¨MXNetçš„å¥½å¤„ä½ æ°¸è¿œæƒ³è±¡ä¸åˆ°ã€‚ğŸ‰‘\næœ¬åœ°ç¯å¢ƒæ­å»ºæ•™ç¨‹  å‚è€ƒ:\nhttps://discuss.gluon.ai/t/topic/13576?u=bigbigwolf-ai\n èŒƒæ•° L0èŒƒæ•°ï¼šæŒ‡å‘é‡ä¸­é0å…ƒç´ çš„ä¸ªæ•°ã€‚ï¼ˆéš¾ä¼˜åŒ–æ±‚è§£ï¼‰\nL1èŒƒæ•°ï¼šæŒ‡å‘é‡ä¸­å„ä¸ªå…ƒç´ çš„ç»å¯¹å€¼ä¹‹å’Œ\nL2èŒƒæ•°ï¼šæŒ‡å‘é‡å„å…ƒç´ çš„å¹³æ–¹å’Œç„¶åæ±‚å¹³æ–¹æ ¹\nè®¾$n$ç»´å‘é‡$x$ä¸­çš„å…ƒç´ ä¸º$x_1, \\ldots, x_n$ã€‚å‘é‡$x$çš„$L_{p}$èŒƒæ•°ä¸º:\n$$\n|\\boldsymbol{x}|_p = \\left(\\sum_{i=1}^n \\left|x_i \\right|^p \\right)^{1/p}.\n$$\n$L_{1}$èŒƒæ•°ï¼š\n$$\n|\\boldsymbol{x}|_1 = \\sum_{i=1}^n \\left|x_i \\right|.\n$$\n$L_{2}$èŒƒæ•°ï¼š\n$$\n|\\boldsymbol{x}|_2 = \\sqrt{\\sum_{i=1}^n x_i^2}.\n$$\nè®¾$X$æ˜¯ä¸€ä¸ª$m$è¡Œ$n$åˆ—çŸ©é˜µã€‚çŸ©é˜µ$X$çš„FrobeniusèŒƒæ•°ä¸ºè¯¥çŸ©é˜µå…ƒç´ å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ï¼š\n$$\n|\\boldsymbol{X}|_F = \\sqrt{\\sum_{i=1}^m \\sum_{j=1}^n x_{ij}^2},\n$$\næŸ¥é˜…æ–‡æ¡£ 1 2  from mxnet import nd print(dir(nd.random))   ['NDArray', '_Null', '__all__', '__builtins__', '__cached__', '__doc__', '__file__', '__loader__', '__name__', '__package__', '__spec__', '_internal', '_random_helper', 'current_context', 'exponential', 'exponential_like', 'gamma', 'gamma_like', 'generalized_negative_binomial', 'generalized_negative_binomial_like', 'multinomial', 'negative_binomial', 'negative_binomial_like', 'normal', 'normal_like', 'numeric_types', 'poisson', 'poisson_like', 'randint', 'randn', 'shuffle', 'uniform', 'uniform_like']  helpå‡½æ•°å¯ä»¥æŸ¥è¯¢å…·ä½“çš„å‡½æ•°ä½œç”¨åŠç”¨æ³•\n1  help(nd.ones_like)   Help on function ones_like: ones_like(data=None, out=None, name=None, **kwargs) Return an array of ones with the same shape and type as the input array. Examples:: x = [[ 0., 0., 0.], [ 0., 0., 0.]] ones_like(x) = [[ 1., 1., 1.], [ 1, 1., 1.]] Parameters ---------- data : NDArray The input out : NDArray, optional The output NDArray to hold the result. Returns ------- out : NDArray or list of NDArrays The output of this function.  çº¿æ€§å›å½’ å¯¼å…¥å¿…è¦çš„åº“\n1 2 3 4 5  %matplotlib inline from IPython import display from matplotlib import pyplot as plt from mxnet import autograd, nd import random   ç”Ÿæˆæ•°æ®é›†ï¼Œå…¶ä¸­æ¯ä¸ªä¾‹å­è¾“å…¥æ•°æ®ä¸ªæ•°ä¸º2ï¼Œæœ‰1000ä¸ªæ•°æ®\n1 2 3 4 5 6 7  num_inputs = 2 num_examples = 1000 true_w = nd.array([2, -3.4]) true_b = nd.array([4.2]) features = nd.random.normal(scale=1, shape=(num_examples, num_inputs)) labels = nd.dot(true_w,features.T) + true_b labels += nd.random.normal(scale=0.01, shape=labels.shape)   æŸ¥çœ‹æ•°æ®\n1  features[0], labels[0]   ( [ 0.28752208 -0.04466231] \u0026lt;NDArray 2 @cpu(0)\u0026gt;, [4.927063] \u0026lt;NDArray 1 @cpu(0)\u0026gt;)  å®šä¹‰ç›¸å…³å‡½æ•°\n1 2 3 4 5 6 7 8 9 10 11  def use_svg_display(): # ç”¨çŸ¢é‡å›¾æ˜¾ç¤º display.set_matplotlib_formats(\u0026#39;svg\u0026#39;) def set_figsize(figsize=(3.5, 2.5)): use_svg_display() # è®¾ç½®å›¾çš„å°ºå¯¸ plt.rcParams[\u0026#39;figure.figsize\u0026#39;] = figsize set_figsize() plt.scatter(features[:, 1].asnumpy(), labels.asnumpy(), 1); # åŠ åˆ†å·åªæ˜¾ç¤ºå›¾   data_iterå‡½æ•°ä½œç”¨:\n æ‰°ä¹±è¯»å–é¡ºåºï¼Œä½¿å¾—è¯»å–éšæœº æŒ‰Batch_sizeåˆ†æ®µå–æ•°æ®ï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦åˆ°ç»“å°¾ï¼Œä½¿ç”¨yieldæ„å»ºç”Ÿæˆå™¨èŠ‚çœå†…å­˜  1 2 3 4 5 6 7 8  # æœ¬å‡½æ•°å·²ä¿å­˜åœ¨d2lzhåŒ…ä¸­æ–¹ä¾¿ä»¥åä½¿ç”¨ def data_iter(batch_size, features, labels): num_examples = len(features) indices = list(range(num_examples)) random.shuffle(indices) # æ ·æœ¬çš„è¯»å–é¡ºåºæ˜¯éšæœºçš„ for i in range(0, num_examples, batch_size): j = nd.array(indices[i: min(i + batch_size, num_examples)]) yield features.take(j), labels.take(j) # takeå‡½æ•°æ ¹æ®ç´¢å¼•è¿”å›å¯¹åº”å…ƒç´    1 2 3 4 5  batch_size = 10 for X, y in data_iter(batch_size, features, labels): print(X, y) break   [[-0.65439206 0.74410725] [ 0.69013244 -0.6483847 ] [-0.59409887 0.3589477 ] [-0.47491348 0.6438462 ] [ 0.5074032 0.42834154] [-0.18589513 -0.21707669] [ 0.70281196 -1.3320632 ] [ 1.2072632 1.6909351 ] [-0.17264698 -1.5742793 ] [-1.6516455 -0.29966688]] \u0026lt;NDArray 10x2 @cpu(0)\u0026gt; [ 0.37379816 7.7938933 1.7758217 1.0414512 3.743439 4.5605783 10.148926 0.84148276 9.19984 1.9295483 ] \u0026lt;NDArray 10 @cpu(0)\u0026gt;  åˆå§‹åŒ–\n1 2  w = nd.random.normal(scale=0.01, shape=(num_inputs, 1)) b = nd.zeros(shape=(1,))   æ·»åŠ ä¿å­˜æ¢¯åº¦çš„ç©ºé—´\n1 2  w.attach_grad() b.attach_grad()   1 2  def linreg(X, w, b): # æœ¬å‡½æ•°å·²ä¿å­˜åœ¨d2lzhåŒ…ä¸­æ–¹ä¾¿ä»¥åä½¿ç”¨ return nd.dot(X, w) + b   1 2  def squared_loss(y_hat, y): # æœ¬å‡½æ•°å·²ä¿å­˜åœ¨d2lzhåŒ…ä¸­æ–¹ä¾¿ä»¥åä½¿ç”¨ return (y_hat - y.reshape(y_hat.shape)) ** 2 / 2   1 2 3  def sgd(params, lr, batch_size): # æœ¬å‡½æ•°å·²ä¿å­˜åœ¨d2lzhåŒ…ä¸­æ–¹ä¾¿ä»¥åä½¿ç”¨ for param in params: param[:] = param - lr * param.grad / batch_size   å¼€å§‹è®­ç»ƒ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  lr = 0.03 num_epochs = 3 net = linreg loss = squared_loss for epoch in range(num_epochs): # è®­ç»ƒæ¨¡å‹ä¸€å…±éœ€è¦num_epochsä¸ªè¿­ä»£å‘¨æœŸ # åœ¨æ¯ä¸€ä¸ªè¿­ä»£å‘¨æœŸä¸­ï¼Œä¼šä½¿ç”¨è®­ç»ƒæ•°æ®é›†ä¸­æ‰€æœ‰æ ·æœ¬ä¸€æ¬¡ï¼ˆå‡è®¾æ ·æœ¬æ•°èƒ½å¤Ÿè¢«æ‰¹é‡å¤§å°æ•´é™¤ï¼‰ã€‚X # å’Œyåˆ†åˆ«æ˜¯å°æ‰¹é‡æ ·æœ¬çš„ç‰¹å¾å’Œæ ‡ç­¾ for X, y in data_iter(batch_size, features, labels): with autograd.record(): l = loss(net(X, w, b), y) # læ˜¯æœ‰å…³å°æ‰¹é‡Xå’Œyçš„æŸå¤± l.backward() # å°æ‰¹é‡çš„æŸå¤±å¯¹æ¨¡å‹å‚æ•°æ±‚æ¢¯åº¦ sgd([w, b], lr, batch_size) # ä½¿ç”¨å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™è¿­ä»£æ¨¡å‹å‚æ•° train_l = loss(net(features, w, b), labels) print(\u0026#39;epoch %d, loss %f\u0026#39; % (epoch + 1, train_l.mean().asnumpy()))   epoch 1, loss 0.040809 epoch 2, loss 0.000157 epoch 3, loss 0.000051  å¯¹æ¯”\n1  true_w, w   ( [ 2. -3.4] \u0026lt;NDArray 2 @cpu(0)\u0026gt;, [[ 1.9991481] [-3.3992586]] \u0026lt;NDArray 2x1 @cpu(0)\u0026gt;)  1  true_b, b   ( [4.2] \u0026lt;NDArray 1 @cpu(0)\u0026gt;, [4.19921] \u0026lt;NDArray 1 @cpu(0)\u0026gt;) ","description":"","id":57,"section":"posts","tags":["python","MXNet","æ·±åº¦å­¦ä¹ ","liner"],"title":"MXNetå›é¡¾","uri":"https://hugo.jiahongw.com/zh/posts/dl/mxnet-begin/"},{"content":"é‡æ–°å­¦ä¹ ä¸€ä¸‹DLï¼Œè¿™æ¬¡ä½¿ç”¨PyTorchæ¡†æ¶ğŸ”¦\n å‚è€ƒèµ„æ–™ï¼š\nhttps://github.com/dsgiitr/d2l-pytorch\n å¯¼å…¥PyTorchåº“ 1 2  import torch import numpy as np   åˆ›å»ºTensor 5x3çš„æœªåˆå§‹åŒ–çš„å¼ é‡\n1 2  x = torch.empty(5,3) x   tensor([[1.0286e-38, 9.0919e-39, 8.9082e-39], [9.2755e-39, 8.4490e-39, 1.0194e-38], [9.0919e-39, 8.4490e-39, 8.7245e-39], [1.0102e-38, 1.0653e-38, 8.7245e-39], [1.0286e-38, 9.6429e-39, 4.2244e-39]])  5x3éšæœºåˆå§‹åŒ–çš„å¼ é‡\n1 2  x = torch.rand(5,3) x   tensor([[0.2518, 0.0419, 0.3233], [0.1493, 0.1408, 0.8559], [0.5145, 0.4648, 0.4605], [0.2555, 0.2502, 0.4506], [0.9798, 0.5056, 0.2726]])  5x3å…¨0çš„å¼ é‡\n1 2  x = torch.zeros(5,3) # å¯ä»¥æŒ‡å®šç±»å‹ x = torch.zeros(5,3,dtype=torch.long) x   tensor([[0., 0., 0.], [0., 0., 0.], [0., 0., 0.], [0., 0., 0.], [0., 0., 0.]])  æ•°æ®å¼ é‡\n1 2  x = torch.tensor([5.5,3]) x   tensor([5.5000, 3.0000])  é»˜è®¤åˆ›å»ºå’ŒåŸæ¥çš„å¼ é‡ä¸€æ ·çš„dtypeå’Œdeviceçš„å¼ é‡ï¼Œä¹Ÿå¯ä»¥å¦å¤–è®¾ç½®\n1 2 3 4  x = x.new_ones(5,3,dtype=torch.double) print(x) x = torch.randn_like(x,dtype=torch.float) print(x)   tensor([[1., 1., 1.], [1., 1., 1.], [1., 1., 1.], [1., 1., 1.], [1., 1., 1.]], dtype=torch.float64) tensor([[-0.7829, -0.4010, 0.3230], [ 0.2660, 0.4766, 0.3186], [ 0.6096, 1.1226, -1.7942], [ 1.3255, 0.1835, -0.9078], [ 1.7743, -0.0944, -0.1704]])  è·å–Tensorçš„å½¢çŠ¶\n1  x.shape,x.size()   (torch.Size([5, 3]), torch.Size([5, 3]))  å…¶ä»–åˆ›å»ºTensorçš„å‡½æ•°:\n   å‡½æ•° åŠŸèƒ½     Tensor(*sizes) åŸºç¡€æ„é€ å‡½æ•°   tensor(data,) ç±»ä¼¼np.arrayçš„æ„é€ å‡½æ•°   ones(*sizes) å…¨1Tensor   zeros(*sizes) å…¨0Tensor   eye(*sizes) å¯¹è§’çº¿ä¸º1ï¼Œå…¶ä»–ä¸º0   arange(s,e,step) ä»såˆ°eï¼Œæ­¥é•¿ä¸ºstep   linspace(s,e,steps) ä»såˆ°eï¼Œå‡åŒ€åˆ‡åˆ†æˆstepsä»½   rand/randn(*sizes) å‡åŒ€/æ ‡å‡†åˆ†å¸ƒ   normal(mean,std)/uniform(from,to) æ­£æ€åˆ†å¸ƒ/å‡åŒ€åˆ†å¸ƒ   randperm(m) éšæœºæ’åˆ—     è¿™äº›åˆ›å»ºæ–¹æ³•éƒ½å¯ä»¥åœ¨åˆ›å»ºçš„æ—¶å€™æŒ‡å®šæ•°æ®ç±»å‹dtypeå’Œå­˜æ”¾device(cpu/gpu)\n æ“ä½œ 1 2 3  x = torch.rand(5,3) y = torch.rand(5,3) x,y   (tensor([[0.7706, 0.7674, 0.0476], [0.3675, 0.3652, 0.1215], [0.2842, 0.4927, 0.0903], [0.1202, 0.7635, 0.1862], [0.1391, 0.5023, 0.0580]]), tensor([[0.2149, 0.4744, 0.6664], [0.5948, 0.3451, 0.6485], [0.2303, 0.6660, 0.3796], [0.7194, 0.3815, 0.7536], [0.7886, 0.0630, 0.2459]]))  åŠ æ³•ï¼Œä¸‰ç§æ–¹æ³•\n1 2 3 4  z1 = torch.add(x,y) z2 = x.add_(y) # xä¼šæ”¹å˜ z3 = x + y z1,z2,z3   (tensor([[0.9855, 1.2418, 0.7140], [0.9623, 0.7103, 0.7700], [0.5145, 1.1588, 0.4699], [0.8396, 1.1450, 0.9397], [0.9276, 0.5653, 0.3040]]), tensor([[0.9855, 1.2418, 0.7140], [0.9623, 0.7103, 0.7700], [0.5145, 1.1588, 0.4699], [0.8396, 1.1450, 0.9397], [0.9276, 0.5653, 0.3040]]), tensor([[1.2004, 1.7163, 1.3804], [1.5571, 1.0554, 1.4185], [0.7448, 1.8248, 0.8495], [1.5590, 1.5265, 1.6933], [1.7162, 0.6283, 0.5499]]))  ç´¢å¼•\n1 2  y = x[0, :] y   tensor([0.9855, 1.2418, 0.7140])  ä¿®æ”¹yä¼šä¿®æ”¹åŸæ¥çš„æ•°æ®ï¼Œå› ä¸ºå…±äº«å†…å­˜\n1 2 3  y+=1 print(y) print(x[0,:])   tensor([1.9855, 2.2418, 1.7140]) tensor([1.9855, 2.2418, 1.7140])  PyTorchè¿˜æä¾›äº†ä¸€äº›é«˜çº§çš„é€‰æ‹©å‡½æ•°:\n   å‡½æ•° åŠŸèƒ½     index_select(input, dim, index) åœ¨æŒ‡å®šç»´åº¦dimä¸Šé€‰å–ï¼Œæ¯”å¦‚é€‰å–æŸäº›è¡Œã€æŸäº›åˆ—   masked_select(input, mask) ä¾‹å­å¦‚ä¸Šï¼Œa[a\u0026gt;0]ï¼Œä½¿ç”¨ByteTensorè¿›è¡Œé€‰å–   nonzero(input) é0å…ƒç´ çš„ä¸‹æ ‡   gather(input, dim, index) æ ¹æ®indexï¼Œåœ¨dimç»´åº¦ä¸Šé€‰å–æ•°æ®ï¼Œè¾“å‡ºçš„sizeä¸indexä¸€æ ·    æ”¹å˜å½¢çŠ¶ ç”¨view()æ¥æ”¹å˜Tensorçš„å½¢çŠ¶ï¼š\n1 2 3  y = x.view(15) z = x.view(-1,5) # -1ä¸ºè‡ªåŠ¨è®¡ç®—ç»´åº¦ print(x.size(),y.size(),z.size())   torch.Size([5, 3]) torch.Size([15]) torch.Size([3, 5])   æ³¨æ„view()è¿”å›çš„æ–°Tensorä¸æºTensorè™½ç„¶å¯èƒ½æœ‰ä¸åŒçš„sizeï¼Œä½†æ˜¯æ˜¯å…±äº«dataçš„ï¼Œä¹Ÿå³æ›´æ”¹å…¶ä¸­çš„ä¸€ä¸ªï¼Œå¦å¤–ä¸€ä¸ªä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚(é¡¾åæ€ä¹‰ï¼Œviewä»…ä»…æ˜¯æ”¹å˜äº†å¯¹è¿™ä¸ªå¼ é‡çš„è§‚å¯Ÿè§’åº¦ï¼Œå†…éƒ¨æ•°æ®å¹¶æœªæ”¹å˜)\n 1 2  x += 1 x,y   (tensor([[4.9855, 5.2418, 4.7140], [3.9623, 3.7103, 3.7700], [3.5145, 4.1588, 3.4699], [3.8396, 4.1450, 3.9397], [3.9276, 3.5653, 3.3040]]), tensor([4.9855, 5.2418, 4.7140, 3.9623, 3.7103, 3.7700, 3.5145, 4.1588, 3.4699, 3.8396, 4.1450, 3.9397, 3.9276, 3.5653, 3.3040]))  ä½¿ç”¨reshape()å‡½æ•°ä¼šæ‹·è´ä¸€ä»½\n1 2  y = x.reshape(15) y   tensor([4.9855, 5.2418, 4.7140, 3.9623, 3.7103, 3.7700, 3.5145, 4.1588, 3.4699, 3.8396, 4.1450, 3.9397, 3.9276, 3.5653, 3.3040])  ä¹Ÿå¯ä»¥ä½¿ç”¨å…‹éš†åview\n ä½¿ç”¨cloneè¿˜æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯ä¼šè¢«è®°å½•åœ¨è®¡ç®—å›¾ä¸­ï¼Œå³æ¢¯åº¦å›ä¼ åˆ°å‰¯æœ¬æ—¶ä¹Ÿä¼šä¼ åˆ°æºTensorã€‚\n 1 2  y = x.clone().view(15) y   tensor([4.9855, 5.2418, 4.7140, 3.9623, 3.7103, 3.7700, 3.5145, 4.1588, 3.4699, 3.8396, 4.1450, 3.9397, 3.9276, 3.5653, 3.3040])  item(), å®ƒå¯ä»¥å°†ä¸€ä¸ªæ ‡é‡Tensorè½¬æ¢æˆä¸€ä¸ªPython numberï¼š\n1 2 3  x = torch.randn(1) print(x) print(x.item())   tensor([0.3816]) 0.3816383183002472  çº¿æ€§ä»£æ•°API    å‡½æ•° åŠŸèƒ½     trace å¯¹è§’çº¿å…ƒç´ ä¹‹å’Œ(çŸ©é˜µçš„è¿¹)   diag å¯¹è§’çº¿å…ƒç´    triu/tril çŸ©é˜µçš„ä¸Šä¸‰è§’/ä¸‹ä¸‰è§’ï¼Œå¯æŒ‡å®šåç§»é‡   mm/bmm çŸ©é˜µä¹˜æ³•ï¼Œbatchçš„çŸ©é˜µä¹˜æ³•   addmm/addbmm/addmv/addr/baddbmm.. çŸ©é˜µè¿ç®—   t è½¬ç½®   dot/cross å†…ç§¯/å¤–ç§¯   inverse æ±‚é€†çŸ©é˜µ   svd å¥‡å¼‚å€¼åˆ†è§£    å¹¿æ’­æœºåˆ¶ ä»€ä¹ˆæ˜¯å¹¿æ’­æœºåˆ¶ï¼Ÿç®€å•çš„è¯´å°±æ˜¯å½¢çŠ¶ä¸åŒçš„è¿ç®—ä¼šè‡ªåŠ¨å˜æ¢ä¸ºé€‚åˆçš„è¿ç®—\n1 2 3 4 5  x = torch.arange(3).view(1,3) print(x) y = torch.arange(2).view(2,1) print(y) print(x + y)   tensor([[0, 1, 2]]) tensor([[0], [1]]) tensor([[0, 1, 2], [1, 2, 3]]) ","description":"","id":58,"section":"posts","tags":["PyTorch","python","Tensor"],"title":"Pytorch Begin","uri":"https://hugo.jiahongw.com/zh/posts/dl/pytorch-begin/"},{"content":"ä¸€ä»½è¿˜ç®—å¯ä»¥çš„ç¿»å¢™æ¸…å•ğŸ“‡\næœ¬æ–‡ä»‹ç»çš„æ–¹æ³•å½’æ€»: PCç«¯ Mobileç«¯   è°·æ­Œè®¿é—®åŠ©æ‰‹ æ’ä»¶(å¯ä»¥ç°åœ¨æç®€æ’ä»¶ä¸­ä¸‹è½½ï¼‰ Astar VPN æ’ä»¶ SSR    äº‘å¸†VPN è€ç‹VPN     'use strict'; var containerId = JSON.parse(\"\\\"635a6660b3cf14fc\\\"\"); var containerElem = document.getElementById(containerId); var tabLinks = null; var tabContents = null; var ids = []; if (containerElem) { tabLinks = containerElem.querySelectorAll('.tab__link'); tabContents = containerElem.querySelectorAll('.tab__content'); } for (var i = 0; i 0) { tabContents[0].style.display = 'block'; }  PCç«¯ è°·æ­Œè®¿é—®åŠ©æ‰‹ é¦–å…ˆæ˜¯ä¸èƒ½é€šè¿‡è°·æ­Œçš„åº”ç”¨å•†åº—ä¸‹è½½çš„ï¼Œå¯ä»¥åœ¨å›½å†…çš„ä¸€äº›æ’ä»¶ç½‘ç«™ä¸‹è½½ï¼Œè¿™äº›æ¨èæç®€æ’ä»¶ï¼Œæ‰¾åˆ°è°·æ­Œè®¿é—®åŠ©æ‰‹è¿›è¡Œä¸‹è½½ã€‚\nå°†CRTæ–‡ä»¶æ‹–å…¥è°·æ­Œæµè§ˆå™¨çš„æ‹“å±•ç¨‹åºç•Œé¢ä¸­(è¿™é‡Œç”¨çš„åŠ©æ‰‹æ˜¯å¦ä¸€ä¸ªç‰ˆæœ¬)\nä¹‹åå°±å¯ä»¥è®¿é—®è°·æ­Œçš„ä¸€éƒ¨åˆ†æœåŠ¡äº†ï¼Œä¾‹å¦‚è°·æ­Œæœç´¢ï¼ŒGmailï¼Œè°·æ­Œåº”ç”¨å•†åº—.\nå®‰è£…è¿‡ç¨‹å¯èƒ½ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ:å®‰è£…æŒ‡å¼•    å…¶ä»–ç±»ä¼¼çš„æ’ä»¶   PPè°·æ­Œè®¿é—®åŠ©æ‰‹:https://chrome.zzzmh.cn/info?token=kahndhhhcnignmbbpiobmdlgjhgfkfil é›†è£…ç®±:https://chrome.zzzmh.cn/info?token=kbgigmcnifmaklccibmlepmahpfdhjch è°·æ­Œè®¿é—®åŠ©æ‰‹:https://chrome.zzzmh.cn/info?token=gocklaboggjfkolaknpbhddbaopcepfp è°·æ­Œå­¦æœ¯åŠ©æ‰‹:https://chrome.zzzmh.cn/info?token=jkicnibdkfemnfhojeajbldjgdddpajk è°·æ­ŒæœåŠ¡åŠ©æ‰‹:https://chrome.zzzmh.cn/info?token=cgncbhnhlkbdieckbbmeppcefokppagh è°·æ­Œä¸Šç½‘åŠ©æ‰‹:https://chrome.zzzmh.cn/info?token=nonmafimegllfoonjgplbabhmgfanaka    Astar VPN Astar VPNä¹Ÿæ˜¯ä¸€ä¸ªChromeæ’ä»¶ï¼Œåœ¨è°·æ­Œåº”ç”¨å•†åº—å¯ä»¥ä¸‹è½½ã€‚ç»è¿‡ç¬¬ä¸€æ­¥ä¹‹åï¼Œwe\u0026rsquo;re good to go!ğŸ˜\nåº”ç”¨å•†åº—æœç´¢Astar VPNè¿›è¡Œä¸‹è½½ï¼Œç›´æ¥å°±å¯ä»¥åœ¨Chromeä¸­è¿›è¡Œè‡ªåŠ¨å®‰è£…ã€‚\nä¹‹åå†æ’ä»¶é€‰é¡¹ä¸­å¼€å¯è¯¥æ’ä»¶ï¼Œå…¶ä¸­å¯ä»¥é€‰æ‹©ä¸åŒçš„æœåŠ¡å™¨è¿›è¡Œè¿æ¥ï¼Œé€Ÿåº¦è¿˜ä¸é”™ã€‚\nä½¿ç”¨è¯¥æ’ä»¶è¿›è¡Œç§‘å­¦ä¸Šç½‘æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ï¼Œå®ƒå¯ä»¥è®¿é—®å›½å¤–ä»»ä½•ç½‘ç«™!  ShadowsSocks ShadowsSocksæ˜¯ä¸€æ¬¾åœ¨githubä¸Šçš„å¼€æºè½¯ä»¶ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œè¿æ¥èŠ‚ç‚¹æœåŠ¡å™¨ï¼Œä½†æ˜¯èŠ‚ç‚¹éœ€è¦è‡ªå·±å»æ‰¾ï¼Œä¸‹é¢ä¼šä»‹ç»èŠ‚ç‚¹çš„é€‰æ‹©ã€‚\né¦–å…ˆå»githubä¸‹è½½è¿™ä¸ªè½¯ä»¶ï¼Œé“¾æ¥ä¸ºï¼šhttps://github.com/shadowsocks/shadowsocks-windows/releases/tag/4.1.9.2\nå°†ä¸¤ä¸ªæ–‡ä»¶è§£å‹ä¹‹åï¼Œå°†ç¬¬ä¸€ä¸ªæ–‡ä»¶å¤¹å†…çš„exeæ–‡ä»¶ç§»åŠ¨åˆ°ç¬¬äºŒä¸ªæ–‡ä»¶å¤¹çš„æ ¹ç›®å½•å¹¶ä¸”æ‰“å¼€å³å¯\nå…³äºå…è´¹èŠ‚ç‚¹ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç½‘å€ï¼šhttps://free-ss.site/(éœ€è¦ç§‘å­¦ä¸Šç½‘)\nå³é”®ShadowSocksçš„å›¾æ ‡ï¼Œé€‰æ‹©æœåŠ¡å™¨ï¼Œåœ¨é€‰æ‹©æ‰«æå±å¹•äºŒç»´ç ï¼Œå³å¯æ·»åŠ èŠ‚ç‚¹ï¼Œä¹‹åç‚¹å‡»ç³»ç»Ÿä»£ç†å¹¶å¼€å¯ç³»ç»Ÿä»£ç†ä¸ºå…¨å±€æ¨¡å¼ã€‚\nä¹‹åå°±å¯ä»¥ğŸ¤™ğŸ¤™ğŸ¤™!\nMobileç«¯ ä¸‹é¢ä¸¤ä¸ªè½¯ä»¶éƒ½æ˜¯éœ€è¦ç§‘å­¦ä¸Šç½‘çš„ï¼Œå»ºè®®å…ˆåœ¨PCç«¯ä¸‹è½½å†ä¼ åˆ°æ‰‹æœºå®‰è£…ã€‚  äº‘å¸†VPN ä¸‹è½½åœ°å€ï¼šhttps://apkpure.com/store/apps/details?id=cc.dingnet.yunfangp\nè™½ç„¶æ¯å¤©åªèƒ½ä½¿ç”¨1å°æ—¶ï¼Œä½†æ˜¯åŸºæœ¬å¤Ÿäº†ã€‚\nè€ç‹VPN ä¸‹è½½åœ°å€ï¼šhttps://apkpure.com/wang-vpn-%E2%9D%A4%EF%B8%8F-free-fast-stable-best-vpn-just-try-it/com.findtheway\nè€ç‹çš„ä¸œè¥¿æ°¸è¿œå…è´¹ï¼\nå‚è€ƒé“¾æ¥\n 2020å¹´Androidé«˜é€Ÿç¨³å®šç¿»å¢™æ–¹æ³• Windowsä¸Šé•¿æœŸæœ‰æ•ˆçš„å…è´¹ä¸”é«˜é€Ÿç¨³å®šç¿»å¢™æ³•ï¼ ","description":"","id":59,"section":"posts","tags":["ç§‘å­¦ä¸Šç½‘","ShadowShocks"],"title":"2020ç¿»å¢™æŒ‡å—ğŸ‘ˆ","uri":"https://hugo.jiahongw.com/zh/posts/settings/2020-fanqiang/"},{"content":"ğŸ‘±â€â™€ä»‹ç»ä¸€äº›markdownä¸­æ¯”è¾ƒå®ç”¨çš„ä¸€äº›å†™ä½œæ–¹æ³•ã€‚\nä»»åŠ¡åˆ—è¡¨âœ  a task list item list syntax required normal formatting, @mentions, #1234 refs incomplete completed  ä¸Šé¢çš„ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5  - [ ] a task list item - [ ] list syntax required - [ ] normal **formatting**, @mentions, #1234 refs - [ ] incomplete - [x] completed   æ•°å­¦å…¬å¼ğŸ“ ä½¿ç”¨MathJaxæ¸²æŸ“LaTeXæ•°å­¦è¡¨è¾¾å¼ã€‚ğŸ’¡\n$$\n\\mathbf{V}_1 \\times \\mathbf{V}_2 = \\begin{vmatrix}\n\\mathbf{i} \u0026amp; \\mathbf{j} \u0026amp; \\mathbf{k} \\\\\n\\frac{\\partial X}{\\partial u} \u0026amp; \\frac{\\partial Y}{\\partial u} \u0026amp; 0 \\\\\n\\frac{\\partial X}{\\partial v} \u0026amp; \\frac{\\partial Y}{\\partial v} \u0026amp; 0 \\\\\n\\end{vmatrix}\n$$\nä¸Šé¢çš„ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7  $$ \\mathbf{V}_1 \\times \\mathbf{V}_2 = \\begin{vmatrix} \\mathbf{i} \u0026amp; \\mathbf{j} \u0026amp; \\mathbf{k} \\\\\\\\ \\frac{\\partial X}{\\partial u} \u0026amp; \\frac{\\partial Y}{\\partial u} \u0026amp; 0 \\\\\\\\ \\frac{\\partial X}{\\partial v} \u0026amp; \\frac{\\partial Y}{\\partial v} \u0026amp; 0 \\\\\\\\ \\end{vmatrix} $$   $$\n\\begin{align*}\ny = y(x,t) \u0026amp;= A e^{i\\theta} \\\\\n\u0026amp;= A (\\cos \\theta + i \\sin \\theta) \\\\\n\u0026amp;= A (\\cos(kx - \\omega t) + i \\sin(kx - \\omega t)) \\\\\n\u0026amp;= A\\cos(kx - \\omega t) + i A\\sin(kx - \\omega t) \\\\\n\u0026amp;= A\\cos \\Big(\\frac{2\\pi}{\\lambda}x - \\frac{2\\pi v}{\\lambda} t \\Big) + i A\\sin \\Big(\\frac{2\\pi}{\\lambda}x - \\frac{2\\pi v}{\\lambda} t \\Big) \\\\\n\u0026amp;= A\\cos \\frac{2\\pi}{\\lambda} (x - v t) + i A\\sin \\frac{2\\pi}{\\lambda} (x - v t)\n\\end{align*}\n$$\nä¸Šé¢ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10  $$ \\begin{align*} y = y(x,t) \u0026amp;= A e^{i\\theta} \\\\\\\\ \u0026amp;= A (\\cos \\theta + i \\sin \\theta) \\\\\\\\ \u0026amp;= A (\\cos(kx - \\omega t) + i \\sin(kx - \\omega t)) \\\\\\\\ \u0026amp;= A\\cos(kx - \\omega t) + i A\\sin(kx - \\omega t) \\\\\\\\ \u0026amp;= A\\cos \\Big(\\frac{2\\pi}{\\lambda}x - \\frac{2\\pi v}{\\lambda} t \\Big) + i A\\sin \\Big(\\frac{2\\pi}{\\lambda}x - \\frac{2\\pi v}{\\lambda} t \\Big) \\\\\\\\ \u0026amp;= A\\cos \\frac{2\\pi}{\\lambda} (x - v t) + i A\\sin \\frac{2\\pi}{\\lambda} (x - v t) \\end{align*} $$   è„šæ³¨ğŸ‘£ å¦‚ä¸‹æ˜¯ä½¿ç”¨çš„ä»£ç ï¼Œå°†é¼ æ ‡æ‚¬åœåœ¨â€œ fn1â€æˆ–â€œ fn2â€ä¸Šæ ‡ä¸Šå¯ä»¥æŸ¥çœ‹è„šæ³¨çš„å†…å®¹ã€‚æ‚¨å¯ä»¥å°†ä»»ä½•å–œæ¬¢çš„å”¯ä¸€æ ‡è¯†ç”¨ä½œè„šæ³¨æ ‡è®°ï¼ˆä¾‹å¦‚â€œ fn1â€ï¼‰ã€‚\n1 2  [^fn1]: Here is the *text* of the first **footnote**. [^fn2]: Here is the *text* of the second **footnote**   ä½ ä¹Ÿå¯ä»¥å†…åµŒè„šæ³¨ï¼Œå°±åƒ^[Here is the text of the first footnote.]\næ°´å¹³çº¿ã€° ğŸŒŸåœ¨ç©ºè¡Œè¾“å…¥***æˆ–---ï¼Œå¦‚ä¸‹ï¼š\nYMALé¦–è¦äº‹é¡¹ğŸ¤” åŒ…å«YAMLå‰äº‹å—çš„æ–‡ä»¶å°†ä½œä¸ºç‰¹æ®Šæ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­\n1 2 3 4  ---layout:posttitle:BloggingLikeaHacker---  ç›®å½•ğŸ“‘ è¾“å…¥[toc]å¹¶å›è½¦å³å¯ã€‚\nå†…éƒ¨é“¾æ¥ğŸ”— è¿™æ˜¯ä¸€ä¸ªè·³è½¬åˆ°ä»»åŠ¡åˆ—è¡¨çš„é“¾æ¥,this link ï¼\nä»£ç å¦‚ä¸‹ï¼š\n1  [this link](#ä»»åŠ¡åˆ—è¡¨âœ)   å‚è€ƒé“¾æ¥ğŸ“– å‚è€ƒé“¾æ¥ä½¿ç”¨ä¸¤ç»„æ–¹æ‹¬å·çš„æ ¼å¼ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ˜¾ç¤ºçš„æ–‡å­—ï¼Œç¬¬äºŒä¸ªæ‹¬å·å†…æ˜¯æŸ¥æ‰¾çš„idï¼Œä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5  This is [an example][id] reference-style link. Then, anywhere in the document, you define your link label on a line by itself like this: [id]: http://example.com/ \u0026#34;Optional Title Here\u0026#34;   éšå¼é“¾æ¥ï¼Œç›´æ¥ä½¿ç”¨GoogleæŸ¥é˜…ï¼š\n[Google][] And then define the link: [Google]: http://google.com/ åˆ é™¤çº¿âŒ åˆ é™¤Mistaken text.ï¼Œä»£ç ä¸º~~Mistaken text.~~\né«˜äº®ğŸ”† ==highlight==ï¼Œä½¿ç”¨ä¸¤ä¸ªç­‰å·åœ¨ä¸¤è¾¹è¿›è¡ŒåŒ…å›´ï¼Œä»£ç å¦‚ä¸‹ï¼š\n1  ==highlight==   æ’å…¥è§†é¢‘ğŸ“¹ Your browser does not support the video tag.\nä¸Šé¢çš„ä»£ç å³ï¼š\n1  \u0026lt;video poster=\u0026#34;https://i.loli.net/2020/02/29/S4oN2djFDZYiqAx.png\u0026#34; src=\u0026#34;https://files.catbox.moe/bqrntc.flv\u0026#34; style=\u0026#34;max-height :100%; max-width: 100%; display: block; margin-left: auto; margin-right: auto;\u0026#34; controls=\u0026#34;controls\u0026#34; loop=\u0026#34;loop\u0026#34; preload=\u0026#34;meta\u0026#34;\u0026gt;Your browser does not support the video tag.\u0026lt;/video\u0026gt;   æ’å…¥éŸ³ä¹ğŸ¼ Your browser does not support the audio tag.\nä¸Šé¢çš„ä»£ç å³ï¼š\n1  \u0026lt;audio src=\u0026#34;https://files.catbox.moe/wjiywu.mp3\u0026#34; style=\u0026#34;max-height :100%; max-width: 100%; display: block; margin-left: auto; margin-right: auto;\u0026#34; controls=\u0026#34;controls\u0026#34; loop=\u0026#34;loop\u0026#34; preload=\u0026#34;meta\u0026#34;\u0026gt;Your browser does not support the audio tag.\u0026lt;/audio\u0026gt;   æ›´å¤šï¼š\néšæœºå›¾ç‰‡ğŸŒ³ ç½‘å€:https://picsum.photos/1920/1080\n","description":"","id":60,"section":"posts","tags":["markdown","Typora"],"title":"Markdownæ·±å…¥ä½¿ç”¨","uri":"https://hugo.jiahongw.com/zh/posts/settings/markdown-deep/"},{"content":"SM.MS sm.ms æ”¯æŒçš„å›¾ç‰‡æ ¼å¼åŒ…æ‹¬ JPGã€JPEGã€GIFã€PNG åŠ BMPï¼Œå•æ¡£ä¸è¶…è¿‡ 5 MBï¼Œå•æ¬¡å¯ä¸Šä¼ å›¾ç‰‡æœ€å¤§ 10 å¼ ã€‚å›¾ç‰‡æ°¸ä¹…ä¿å­˜ï¼Œè¯·å‹¿ä¸Šä¼ æ”¿æ²»ç›¸å…³å›¾ç‰‡\né€Ÿåº¦ï¼šé«˜é€ŸæœåŠ¡å™¨ â¤ â¤ â¤ â¤ â¤(15 å¹´æˆç«‹)\nå¦‚ä¼˜å›¾åºŠ æ”¯æŒå¤§é‡å…è´¹å›¾åºŠåˆ†å‘ï¼Œç½‘ç«™ç¨³å®šæ€§æœªçŸ¥\né€Ÿåº¦ï¼šåŠ¨æ€ â¤ â¤ â¤ â¤ â¤\nç‰›å›¾ç½‘ é€Ÿåº¦ï¼šæ—¥æœ¬æœåŠ¡å™¨ â¤ â¤ â¤ â¤(2010 å¹´)\nniupic.com ç¨³å®šæ€§ä¸é”™ï¼Œä¸è¦ä¸Šä¼ è¿æ³•å›¾ç‰‡\nvim-cn ä¸Šä¼ ç•Œé¢ååˆ†ç®€å•ï¼Œä½†ååˆ†ç¨³å®šã€‚\né€Ÿåº¦ï¼š â¤ â¤ â¤(12å¹´åˆ°ç°åœ¨)\nimgbb æ— éœ€æ³¨å†Œï¼Œæ”¯æŒæœ€å¤§ 16M å›¾ç‰‡ä¸Šä¼ ï¼Œæ”¯æŒ httpsï¼Œé€Ÿåº¦ä¸é”™\né€Ÿåº¦ï¼šäºšå¤ªæœåŠ¡å™¨ â¤ â¤ â¤ â¤\nmeotu 16 å¹´æˆç«‹çš„å…è´¹å›¾ç‰‡å¤–é“¾ç½‘ç«™ã€‚ä¸Šä¼ ä¸‹è½½é€Ÿåº¦å¿«ã€‚\néœ€è¦æ³¨å†Œï¼Œé»˜è®¤åŸå›¾ä¸Šä¼ ï¼Œæ”¯æŒ https\né€Ÿåº¦ï¼šé«˜é€ŸæœåŠ¡å™¨ â¤ â¤ â¤ â¤ â¤\né‡è§å›¾åºŠ 18 å¹´æˆç«‹çš„å…è´¹å›¾ç‰‡å¤–é“¾ç½‘ç«™ã€‚ä¸Šä¼ ä¸‹è½½é€Ÿåº¦å¿«ã€‚\néœ€è¦æ³¨å†Œï¼Œé»˜è®¤åŸå›¾ä¸Šä¼ ï¼Œæ”¯æŒæœ€å¤§ 10Mï¼Œæ”¯æŒ https\né€Ÿåº¦ï¼šé«˜é€ŸæœåŠ¡å™¨ â¤ â¤ â¤ â¤ â¤\nz4a å›¾åºŠ éœ€è¦æ³¨å†Œï¼Œæ”¯æŒ HTTPS é€Ÿåº¦å—\né€Ÿåº¦ï¼šé«˜é€ŸæœåŠ¡å™¨ â¤ â¤ â¤ â¤ â¤\nz4a.net ç”±äºæˆç«‹æ—¶é—´è¾ƒçŸ­ï¼Œç¨³å®šæ€§æœªçŸ¥ã€‚\nupload 2012 å¹´æˆç«‹çš„å…è´¹å›¾ç‰‡ä¸Šä¼ å¤–é“¾ç½‘ç«™ï¼Œè‡³ä»Šä¾ç„¶ç¨³å®š\næ— éœ€æ³¨å†Œï¼Œé»˜è®¤åŸå›¾ä¸Šä¼ ï¼Œæ”¯æŒ https\né€Ÿåº¦ï¼šäºšå¤ªæœåŠ¡å™¨ â¤ â¤ â¤\ncatbox æ— éœ€æ³¨å†Œï¼Œæ”¯æŒ https\né€Ÿåº¦ï¼šæµ·å¤–æœåŠ¡å™¨ â¤ â¤ â¤\ncatbox.moe æ”¯æŒ 200m ä¸»æµæ ¼å¼æ–‡ä»¶å¤–é“¾ç½‘ç«™\n","description":"","id":61,"section":"posts","tags":["photo","å›¾åºŠ"],"title":"å‡ æ¬¾å¥½ç”¨çš„å›¾åºŠ","uri":"https://hugo.jiahongw.com/zh/posts/settings/free-image-bed/"},{"content":"Freenom æ˜¯ç›®å‰ä¸ºæ•°ä¸å¤šçš„å…è´¹åŸŸåæä¾›å•†ï¼Œæä¾› .ga, .ml, .gq, .tk, .cf äº”ä¸ªå…è´¹é¡¶çº§åŸŸã€‚å½“ç„¶ä¹Ÿæœ‰ä¸€äº›ä»˜è´¹çš„åŸŸåï¼Œå¯¹äºæ™®é€šäººæ¥è¯´ï¼Œå…è´¹åŸŸåå°±å¤Ÿäº†ã€‚ğŸ˜\nç¬¬ä¸€æ­¥ï¼Œæ‰¾åŸŸå æ‰“å¼€Freenomï¼Œç™»é™†åç›´æ¥åœ¨æœç´¢æ æœç´¢è‡ªå·±æƒ³è¦çš„åŸŸååå­—ï¼Œç„¶åç³»ç»Ÿä¼šè¿”å›å¯ä»¥ä½¿ç”¨çš„å…è´¹åŸŸåï¼Œé€‰æ‹©ä¸€ä¸ªç»“ç®—å³å¯\nç¬¬äºŒæ­¥ï¼Œé…ç½®è§£ææœåŠ¡ ä½¿ç”¨cloudflareè§£ææœåŠ¡ æ‰“å¼€cloudflareï¼Œé¦–å…ˆéœ€è¦æ³¨å†Œä¸€ä¸ªè´¦å·ã€‚ç„¶åä»–ä¼šè¦æ±‚è¾“å…¥éœ€è¦è§£æçš„åŸŸå\nå¡«å†™ç›¸åº”çš„DNSä¿¡æ¯ï¼Œå¹¶ä¸”å°†ä¸‹é¢çš„NSä¿¡æ¯å¡«å†™åˆ°freenomçš„custom nameservers\nç­‰å¾…ä¸ªå‡ åˆ†é’Ÿå°±å¥½äº†ã€‚Over ğŸ¤\n","description":"","id":62,"section":"posts","tags":["åŸŸå","freenom"],"title":"Freenom å…è´¹åŸŸåç”³è¯·","uri":"https://hugo.jiahongw.com/zh/posts/settings/freenom-domain/"},{"content":"å®‰è£…MinGWä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é‚£å®ƒæ¥ä½œä¸ºCæˆ–C++çš„ç¼–è¯‘å™¨.ğŸ•¸\nCMDç¼–è¯‘ç¨‹åº  ç¼–è¯‘è¿‡ç¨‹åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼šé¢„å¤„ç†ã€ç¼–è¯‘ã€æ±‡ç¼–ã€é“¾æ¥ã€‚\n ä½¿ç”¨g++å¯ä»¥åœ¨å‘½ä»¤è¡Œåˆ†åˆ«å®ç°ä¸Šé¢å››ä¸ªæ­¥éª¤ã€‚ä½¿ç”¨ä¸‹é¢çš„ç¨‹åºä½œä¸ºä¾‹å­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  #include \u0026lt;iostream\u0026gt;#include \u0026lt;cmath\u0026gt;using namespace std; // this is my test program  #ifndef myNum#define myNum 666 #endifint main() { cout \u0026lt;\u0026lt; \u0026#34;Hello!\u0026#34; \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#34;myNum = \u0026#34; \u0026lt;\u0026lt; myNum \u0026lt;\u0026lt;endl; return 0; }   é¢„å¤„ç† é¢„å¤„ç†ä¸»è¦å®Œæˆçš„å·¥ä½œæœ‰ï¼š\nï¼ˆ1ï¼‰åˆ é™¤#defineï¼Œå±•å¼€å®ï¼›\nï¼ˆ2ï¼‰å¤„ç†æ¡ä»¶ç¼–è¯‘æŒ‡ä»¤ï¼Œé¢„å¤„ç†ç¨‹åºå…ˆåˆ¤æ–­æ¡ä»¶ï¼Œåœ¨æ ¹æ®æ¡ä»¶ä¿®æ”¹æºä»£ç ï¼›\nï¼ˆ3ï¼‰åˆ é™¤æ³¨é‡Šï¼›\nï¼ˆ4ï¼‰æ·»åŠ è¡Œå·ï¼Œä»¥åŠæ–‡ä»¶åæ ‡è¯†ï¼Œä¾¿äºè°ƒè¯•\nï¼ˆ5ï¼‰åˆ é™¤â€œ#includeâ€ï¼Œæ’å…¥ç›¸åº”çš„å¤´æ–‡ä»¶ï¼›\n ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼Œå¾—åˆ°é¢„å¤„ç†åçš„æ–‡ä»¶test.i\n1  g++ -E test.cpp -o test.i   æŸ¥çœ‹test.iæ–‡ä»¶\nç¼–è¯‘ ä½¿ç”¨ä¸‹é¢çš„ä»£ç ç”Ÿæˆæ±‡ç¼–æ–‡ä»¶test.s\n1  g++ -S test.i -o test.s   æ³¨æ„ï¼šç›´æ¥ä»test.cppæ–‡ä»¶å¾—åˆ°æ±‡ç¼–æ–‡ä»¶ä¹Ÿå¯ä»¥ã€‚ç›´æ¥ä½¿ç”¨å‘½ä»¤ g++ -S test.cpp -o test.s  æŸ¥çœ‹test.sæ–‡ä»¶\næ±‡ç¼– ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å°†æ±‡ç¼–æŒ‡ä»¤è½¬åŒ–ä¸ºæœºå™¨æŒ‡ä»¤ï¼Œç”Ÿæˆæ–‡ä»¶test.o\n1  g++ -c test.s -o test.o   æŸ¥çœ‹æ–‡ä»¶test.o\né“¾æ¥ é€šè¿‡é“¾æ¥åº“æ–‡ä»¶ï¼Œå¯ä»¥å°†ç›®æ ‡æ–‡ä»¶test.oè½¬åŒ–ä¸ºå¯æ‰§è¡Œæ–‡ä»¶test.exe\næ³¨æ„:Windowsä¸‹å¯æ‰§è¡Œæ–‡ä»¶çš„åç¼€ä¸ºexeï¼Œè€ŒLinuxä¸‹ä¸éœ€è¦åç¼€ã€‚  CMDè¾“å…¥ä»¥ä¸‹ä»£ç \n1  g++ test.o -o test.exe   æ³¨æ„:Windowsä¸‹.oæ–‡ä»¶å·²ç»å¯ä»¥æ‰§è¡Œï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥test.oå°±å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„æ•ˆæœï¼š\n å¦å¤–ä¸€ä¸ªå‘½ä»¤æ˜¯\n1  g++ test.o -o test.exe -L æ‰€éœ€åº“æ–‡ä»¶è·¯å¾„   å…¶ä¸­Lä¸ºlinkçš„ç¼©å†™ã€‚ å¿«é€Ÿç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨g++ test.cpp -o test å°±å¯ä»¥ç”Ÿæˆå¯æ‰§è¡Œç¨‹åºäº†ã€‚\nè¿è¡Œç¨‹åº å¦‚ä¸‹ï¼š\nMinGW + SublimeTexté…ç½®C++ç¯å¢ƒ ä¸‹è½½MinGWå’ŒSublimeText SublimeTextä¸‹è½½\nMinGWä¸‹è½½åŠç›¸å…³é…ç½®\nä½¿ç”¨SublimeText å› ä¸ºå‰é¢é…ç½®å¥½ç¯å¢ƒå˜é‡äº†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åœ¨SublimeTextä¸‹ç¼–è¯‘è¿è¡Œç¨‹åº\nTools-\u0026gt;build(æˆ–è€…æŒ‰å¿«æ·é”®Ctrl+B æˆ– Ctrl + Shift + B)\nå¯ä»¥åœ¨æœ€ä¸‹é¢ä¸€æ çœ‹åˆ°è¾“å‡ºç»“æœ\nenjoy it!\nè§£å†³SublimeTextä¸‹ä¸èƒ½ä½¿ç”¨è¾“å…¥çš„é—®é¢˜ SublimeTextæ˜¯æŠŠshellæ‰§è¡Œçš„ç»“æœè¯»å›æ¥æ˜¾ç¤ºåœ¨ç»ˆç«¯ï¼Œè¿™æ„å‘³æ— æ³•ä½¿ç”¨è¾“å…¥è¯­å¥ï¼Œæ— æ³•ä½¿ç”¨è°ƒè¯•åŠŸèƒ½ã€‚  è§£å†³æ–¹æ³•:è®©ç¨‹åºç›´æ¥è¿è¡Œåœ¨CMD\nåœ¨sublime-\u0026gt;Tools\u0026gt;Build Systemé‡Œæ–°å»ºç¼–è¯‘ç³»ç»Ÿï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹æ„å»ºC++ç¼–è¯‘ç¯å¢ƒ,ä¿å­˜åå­—ä¸ºC++Buider\n1 2 3 4 5 6 7 8 9 10 11 12  {\u0026#34;cmd\u0026#34;: [\u0026#34;g++\u0026#34;,\u0026#34;$file_name\u0026#34;,\u0026#34;-o\u0026#34;,\u0026#34;${file_base_name}\u0026#34;,\u0026#34;-lm\u0026#34;,\u0026#34;-Wall\u0026#34;],\u0026#34;file_regex\u0026#34;: \u0026#34;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$\u0026#34;,\u0026#34;selector\u0026#34;: \u0026#34;source.c, source.c++\u0026#34;,\u0026#34;shell\u0026#34;: false,\u0026#34;working_dir\u0026#34;: \u0026#34;$file_path\u0026#34;,\u0026#34;variants\u0026#34;: [{\u0026#34;name\u0026#34;: \u0026#34;RunInCommand\u0026#34;,\u0026#34;cmd\u0026#34;: [\u0026#34;cmd\u0026#34;,\u0026#34;/c\u0026#34;,\u0026#34;g++\u0026#34;,\u0026#34;-g\u0026#34;,\u0026#34;${file}\u0026#34;,\u0026#34;-o\u0026#34;,\u0026#34;${file_path}/${file_base_name}\u0026#34;,\u0026#34;\u0026amp;\u0026amp;\u0026#34;,\u0026#34;start\u0026#34;,\u0026#34;cmd\u0026#34;,\u0026#34;/k\u0026#34;,\u0026#34;${file_path}/${file_base_name}\u0026#34;]}]}  ç„¶åå¯ä»¥ä½¿ç”¨å¿«æ·é”®Ctrl + Shift + Bï¼Œä¼šæ˜¾ç¤ºå¦‚ä¸‹ï¼Œä½¿ç”¨å‘½ä»¤è¡Œæ‰“å¼€æ¨¡å¼é€‰é¡¹å³å¯\nç»“æœå¦‚ä¸‹ï¼š\nå…¶ä»–ç¼–è¯‘ç¯å¢ƒçš„é…ç½®ä¹Ÿç±»ä¼¼ï¼š\nCç¼–è¯‘é…ç½®æ–‡ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12  {\u0026#34;cmd\u0026#34;: [\u0026#34;gcc\u0026#34;,\u0026#34;$file_name\u0026#34;,\u0026#34;-o\u0026#34;,\u0026#34;${file_base_name}\u0026#34;,\u0026#34;-lm\u0026#34;,\u0026#34;-Wall\u0026#34;],\u0026#34;file_regex\u0026#34;: \u0026#34;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$\u0026#34;,\u0026#34;selector\u0026#34;: \u0026#34;source.c, source.c++\u0026#34;,\u0026#34;shell\u0026#34;: false,\u0026#34;working_dir\u0026#34;: \u0026#34;$file_path\u0026#34;,\u0026#34;variants\u0026#34;: [{\u0026#34;name\u0026#34;: \u0026#34;RunInCommand\u0026#34;,\u0026#34;cmd\u0026#34;: [\u0026#34;cmd\u0026#34;,\u0026#34;/c\u0026#34;,\u0026#34;gcc\u0026#34;,\u0026#34;-g\u0026#34;,\u0026#34;${file}\u0026#34;,\u0026#34;-o\u0026#34;,\u0026#34;${file_path}/${file_base_name}\u0026#34;,\u0026#34;\u0026amp;\u0026amp;\u0026#34;,\u0026#34;start\u0026#34;,\u0026#34;cmd\u0026#34;,\u0026#34;/k\u0026#34;,\u0026#34;${file_path}/${file_base_name}\u0026#34;]}]}  Javaç¼–è¯‘é…ç½®æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  { \u0026#34;cmd\u0026#34;: [\u0026#34;javac\u0026#34;, \u0026#34;$file_name\u0026#34;], \u0026#34;file_regex\u0026#34;: \u0026#34;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$\u0026#34;, \u0026#34;selector\u0026#34;: \u0026#34;source.java\u0026#34;, \u0026#34;shell\u0026#34;: false, \u0026#34;working_dir\u0026#34;: \u0026#34;$file_path\u0026#34;, \u0026#34;variants\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;RunInCommand\u0026#34;, \u0026#34;cmd\u0026#34;: [\u0026#34;cmd\u0026#34;, \u0026#34;/c\u0026#34;, \u0026#34;javac\u0026#34;, \u0026#34;${file}\u0026#34;, \u0026#34;\u0026amp;\u0026amp;\u0026#34;, \u0026#34;start\u0026#34;, \u0026#34;cmd\u0026#34;, \u0026#34;/k\u0026#34;, \u0026#34;java $file_name\u0026#34;] }, { \u0026#34;name\u0026#34;: \u0026#34;Debug\u0026#34;, \u0026#34;cmd\u0026#34;: [\u0026#34;cmd\u0026#34;, \u0026#34;/c\u0026#34;, \u0026#34;javac\u0026#34;, \u0026#34;${file}\u0026#34;, \u0026#34;\u0026amp;\u0026amp;\u0026#34;, \u0026#34;start\u0026#34;, \u0026#34;cmd\u0026#34;, \u0026#34;/k\u0026#34;, \u0026#34;gdb ${file_path}/${file_base_name}\u0026#34;] }] }   è§£å†³ä¸èƒ½è¾“å…¥ä¸­æ–‡çš„é—®é¢˜ ä½¿ç”¨ä¸‹é¢çš„ç¼–è¯‘é…ç½®æ–‡ä»¶å³å¯ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  {\u0026#34;encoding\u0026#34;: \u0026#34;GBK\u0026#34;,\u0026#34;working_dir\u0026#34;: \u0026#34;$file_path\u0026#34;,\u0026#34;shell_cmd\u0026#34;: \u0026#34;g++ -fexec-charset=GBK -Wall -std=c++11 \\\u0026#34;$file_name\\\u0026#34; -o \\\u0026#34;$file_base_name\\\u0026#34;\u0026#34;,\u0026#34;file_regex\u0026#34;: \u0026#34;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$\u0026#34;,\u0026#34;selector\u0026#34;: \u0026#34;source.c++\u0026#34;,\u0026#34;variants\u0026#34;: [{\u0026#34;name\u0026#34;: \u0026#34;Run in sublime\u0026#34;,\u0026#34;shell_cmd\u0026#34;: \u0026#34;g++ -fexec-charset=GBK -Wall -std=c++11 \\\u0026#34;$file_name\\\u0026#34; -o \\\u0026#34;$file_base_name\\\u0026#34; \u0026amp;\u0026amp; cmd /c \\\u0026#34;${file_path}/${file_base_name}\\\u0026#34;\u0026#34;},{\u0026#34;name\u0026#34;: \u0026#34;CMD Run\u0026#34;,\u0026#34;shell_cmd\u0026#34;: \u0026#34;g++ -fexec-charset=GBK -Wall -std=c++11 \\\u0026#34;$file\\\u0026#34; -o \\\u0026#34;$file_base_name\\\u0026#34; \u0026amp;\u0026amp; start cmd /c \\\u0026#34;\\\u0026#34;${file_path}/${file_base_name}\\\u0026#34; \u0026amp; pause\\\u0026#34;\u0026#34;},{\u0026#34;name\u0026#34;: \u0026#34;gdb Debug\u0026#34;,\u0026#34;shell_cmd\u0026#34;: \u0026#34;g++ -fexec-charset=GBK -g -std=c++11 \\\u0026#34;$file\\\u0026#34; -o \\\u0026#34;$file_base_name\\\u0026#34; \u0026amp;\u0026amp; start cmd /c gdb ${file_path}/${file_base_name} \u0026amp; pause\u0026#34;}]}  é…ç½®ä»£ç æ ¼å¼åŒ– ä»èœå•é‡Œé€‰View-\u0026gt;Show Consoleï¼Œè·³å‡ºConsoleï¼Œä¸‹é¢æœ‰ä¸€è¡Œè¾“å…¥çš„ï¼ˆå…‰æ ‡ä½ç½®ï¼‰ï¼ŒæŠŠä¸‹é¢è¿™æ®µä»£ç è¾“å…¥è¿›å»å›è½¦(åªé€‚ç”¨sublime Text 3)\n1  import urllib.request,os; pf = \u0026#39;Package Control.sublime-package\u0026#39;; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); open(os.path.join(ipp, pf), \u0026#39;wb\u0026#39;).write(urllib.request.urlopen( \u0026#39;http://sublime.wbond.net/\u0026#39; + pf.replace(\u0026#39;\u0026#39;,\u0026#39;%20\u0026#39;)).read())   å®‰è£…CoolFormatï¼ŒæŒ‰Ctrl+Shift+Pï¼Œç„¶åè¾“å…¥install,å°±ä¼šå‡ºç°â€œPackage Control: Install Packageâ€ï¼Œè¾“å…¥CoolFormatè¿›è¡Œä¸‹è½½ï¼Œä¸‹è½½å®Œæˆä¹‹åè¾“å…¥Ctrl+Shift+Pï¼Œç„¶åè¾“å…¥CoolFormatï¼Œé€‰ä¸‹Formatter Settingsï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹é…ç½®:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  ;Pleasevisithttp://akof1314.github.io/CoolFormat/doc/index.htmlformoreinformation[SynTidy]C++=\u0026#34;\u0026#34;-A1-p-N-Y-k3\u0026#34;\u0026#34;Java=\u0026#34;\u0026#34;-A1-p-N-Y-k3\u0026#34;\u0026#34;C#=\u0026#34;\u0026#34;-A1-p-N-Y-k3\u0026#34;\u0026#34;Objective-C=\u0026#34;\u0026#34;-A1-p-N-Y-k3\u0026#34;\u0026#34;HTML=\u0026#34;\u0026#34;-aan-dep-fb-fbc-fu-js-ll-n-ox-pe-qa-qn-m-wa-wj-wp-ws-sw-fo-i0-d1-ce0-ie0-oe0-w0-sbo0\u0026#34;\u0026#34;XML=\u0026#34;\u0026#34;-aan-dep-fb-fbc-js-ll-n-ix-qa-qn-m-wa-wj-wp-ws-sw-fo-i1-ce0-ie0-oe0-w0\u0026#34;\u0026#34;PHP=\u0026#34;\u0026#34;-sas-icd-samt-salo-saeo-saro-sabo-saao-samp-aas-rsl-iel-rpc-rst-st\u0026#34;\u0026#34;JavaScript=\u0026#34;\u0026#34;-nb-cn4\u0026#34;\u0026#34;CSS=\u0026#34;\u0026#34;-c2-rub-cl0-os1-cc-cf-cfp0-rs2\u0026#34;\u0026#34;JSON=\u0026#34;\u0026#34;-cn3\u0026#34;\u0026#34;SQL=\u0026#34;\u0026#34;-cn2-el-ml0\u0026#34;\u0026#34;Verilog=\u0026#34;\u0026#34;-A1\u0026#34;\u0026#34;  å»ºç«‹å¿«æ·é”®\nè¿›å…¥èœå•é€‰Preferences-\u0026gt;Browse Packagesï¼Œç„¶åè¿›CoolFormatï¼Œé‡Œé¢æœ‰ä¸ªDefault.sublime-keymap\næ‰“å¼€åï¼Œé‡Œé¢æœ‰å¿«æ·æ–¹å¼çš„æŒ‰é”®,æ›´æ”¹å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9  [{\u0026#34;keys\u0026#34;: [\u0026#34;ctrl+q\u0026#34;], \u0026#34;command\u0026#34;: \u0026#34;coolformat\u0026#34;, \u0026#34;args\u0026#34;: {\u0026#34;action\u0026#34;: \u0026#34;quickFormat\u0026#34;}},{\u0026#34;keys\u0026#34;: [\u0026#34;ctrl+alt+shift+s\u0026#34;], \u0026#34;command\u0026#34;: \u0026#34;coolformat\u0026#34;, \u0026#34;args\u0026#34;: {\u0026#34;action\u0026#34;: \u0026#34;selectedFormat\u0026#34;}}]   è¿™æ ·ä»¥åå†™å®Œçš„ä»£ç ç›´æ¥æŒ‰ â€œCtrl+Qâ€ ä¾¿å¯ä»¥æ ¼å¼åŒ–ä»£ç \n å¦ä¸€ç§æ ¼å¼åŒ–ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13  ;Pleasevisithttp://akof1314.github.io/CoolFormat/doc/index.htmlformoreinformation[SynTidy]C++=\u0026#34;\u0026#34;-A2-p-N-Y-o-T-N-k3\u0026#34;\u0026#34;Java=\u0026#34;\u0026#34;-A1-p-N-T-Y-k3\u0026#34;\u0026#34;C#=\u0026#34;\u0026#34;-A1-p-N-Y-T-k3\u0026#34;\u0026#34;Objective-C=\u0026#34;\u0026#34;-A1-p-N-Y-k3\u0026#34;\u0026#34;HTML=\u0026#34;\u0026#34;-aan-dep-fb-fbc-fu-js-ll-n-ox-pe-qa-qn-m-wa-wj-wp-ws-sw-fo-i0-d1-ce0-ie0-oe0-w0-sbo0\u0026#34;\u0026#34;XML=\u0026#34;\u0026#34;-aan-dep-fb-fbc-js-ll-n-ix-qa-qn-m-wa-wj-wp-ws-sw-fo-i1-ce0-ie0-oe0-w0\u0026#34;\u0026#34;PHP=\u0026#34;\u0026#34;-sas-icd-samt-salo-saeo-saro-sabo-saao-samp-aas-rsl-iel-rpc-rst-st\u0026#34;\u0026#34;JavaScript=\u0026#34;\u0026#34;-nb-cn4\u0026#34;\u0026#34;CSS=\u0026#34;\u0026#34;-c2-rub-cl0-os1-cc-cf-cfp0-rs2\u0026#34;\u0026#34;JSON=\u0026#34;\u0026#34;-cn3\u0026#34;\u0026#34;SQL=\u0026#34;\u0026#34;-cn2-el-ml0\u0026#34;\u0026#34;  ","description":"","id":63,"section":"posts","tags":[""],"title":"MinGWåœ¨Windowsçš„ä½¿ç”¨","uri":"https://hugo.jiahongw.com/zh/posts/settings/mingw-use/"},{"content":"HUGO + Github + Github ActionæŒç»­é›†æˆéƒ¨ç½²ä¸ªäººåšå®¢\nHUGOæœ¬åœ°ç¯å¢ƒ é¦–å…ˆåœ¨HUGOçš„å®˜ç½‘ä¸‹è½½Hugoçš„Windowså®‰è£…åŒ…ï¼Œç„¶åå°†è·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡å³å¯ã€‚\nstep1:ä¸‹è½½hugo\nstep2:é…ç½®ç¯å¢ƒå˜é‡\nHUGOç«™ç‚¹é…ç½®åŠä¸»é¢˜é…ç½® åˆ›å»ºç«™ç‚¹ åœ¨ç›®å½•ä¸‹ç›´æ¥è¾“å…¥ä¸‹é¢çš„ä»£ç å³å¯åˆ›å»ºä¸€ä¸ªåä¸ºblogçš„hugoç«™ç‚¹(æ³¨æ„ï¼šæ–°å»ºçš„ç«™ç‚¹æ˜¯æ²¡æœ‰è‡ªå¸¦ä¸»é¢˜çš„)\n1  hugo new site blog   æˆ–è€…è¿›å…¥blogæ–‡ä»¶å¤¹å†…ç›´æ¥è¾“å…¥ä»¥ä¸‹è¯­å¥ï¼š\n1  hugo new site .   ä¸‹è½½ä¸»é¢˜ å¯ä»¥åœ¨hugo themeä¸‹è½½ä¸»é¢˜ï¼Œç„¶åæ ¹æ®ä¸»é¢˜çš„æ–‡æ¡£è¿›è¡Œé…ç½®\næ”¾åˆ°ç«™ç‚¹æ–‡ä»¶å¤¹themeså†…ï¼Œé…ç½®config.toml\næœ¬åœ°æµ‹è¯•è¿è¡Œ è¾“å…¥hugo serveræµ‹è¯•\nGithubé…ç½® åˆ›å»ºç«™ç‚¹ä»“åº“å¹¶ä¸”è®¾ç½®GithubPage å¯ä»¥åœ¨Settingä¸­çœ‹è§å¦‚ä¸‹ï¼š\nåˆ›å»ºä¸€ä¸ªå­˜å‚¨é¡¹ç›®çš„ä»“åº“ é…ç½®Github Action é¦–å…ˆåœ¨é¡¹ç›®ä»“åº“ç‚¹å‡»actionï¼Œé€‰æ‹©Simple workflowï¼Œè¾“å…¥ä¸€ä¸‹çš„é…ç½®ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  name:CI#è‡ªåŠ¨åŒ–çš„åç§°on:push:# pushçš„æ—¶å€™è§¦å‘branches:# é‚£äº›åˆ†æ”¯éœ€è¦è§¦å‘- masterjobs:build:runs-on:ubuntu-latest# é•œåƒå¸‚åœºsteps:- name:checkout# æ­¥éª¤çš„åç§°uses:actions/checkout@v1#è½¯ä»¶å¸‚åœºçš„åç§°with:# å‚æ•°submodules:true- name:SetupHugouses:peaceiris/actions-hugo@v2.2.2with:hugo-version:\u0026#39;0.64.1\u0026#39;extended:true- name:Buildrun:hugo-D- name:Deployuses:peaceiris/actions-gh-pages@v2.5.1env:ACTIONS_DEPLOY_KEY:${{secrets.ACTIONS_DEPLOY_KEY}}EXTERNAL_REPOSITORY:redisread/redisread.github.ioPUBLISH_BRANCH:masterPUBLISH_DIR:./public  å‡†å¤‡éƒ¨ç½²ï¼Œæˆ‘ä»¬å¼€å‘çš„é¡¹ç›®åŠgithub pageså®é™…æ˜¯åˆ†å¼€çš„ï¼Œä¸€ä¸ªç”¨äºä¿å­˜é¡¹ç›®ï¼Œç›¸å½“äºæºä»£ç ï¼Œå¦å¤–ä¸€ä¸ªç”¨äºä¿å­˜æœ€ç»ˆçš„ç½‘é¡µæ–‡ä»¶ã€‚\n  ä½¿ç”¨gitç”Ÿæˆssh key(ç›¸å½“äºç”Ÿæˆå¯¹å¯†é’¥)\n1 2 3 4  ssh-keygen -t rsa -b 4096 -C \u0026#34;$(git config user.email)\u0026#34; -f gh-pages -N \u0026#34;\u0026#34; # You will get 2 files: # gh-pages.pub (public key) # gh-pages (private key)    å‡è®¾ å¼€å‘é¡¹ç›®ä¸º HUGO_blog éƒ¨ç½²çš„é¡¹ç›®ä¸º redisread.github.io\n   æ‰“å¼€HUGO_blogä»“åº“çš„settingsï¼Œå†ç‚¹å‡»Secretsï¼Œç„¶åæ·»åŠ åˆšåˆšç”Ÿæˆçš„ç§é’¥ï¼Œnameä¸ºACTIONS_DEPLOY_KEY\n  åŒç†ï¼Œæ‰“å¼€redisread.github.ioï¼Œç‚¹å‡»Deploy keysï¼Œæ·»åŠ å…¬é’¥ï¼ŒAllow write accessä¸€å®šè¦å‹¾ä¸Šï¼Œå¦åˆ™ä¼šæ— æ³•æäº¤\n  ç„¶åï¼Œä½ å°±å¯ä»¥æäº¤ä»£ç äº†ï¼ŒpushæˆåŠŸåï¼Œæ‰“å¼€ä»“åº“actionsï¼Œè‡³æ­¤éƒ¨ç½²æˆåŠŸï¼Œå¤§åŠŸå‘Šæˆï¼\n","description":"Guide to set Hugo site.","id":64,"section":"posts","tags":["Hugo","Github"],"title":"Hugoé…ç½®","uri":"https://hugo.jiahongw.com/zh/posts/hugo/first/"},{"content":"ä½¿ç”¨Github+PicGoå»ºç«‹ä¸€ä¸ªå…è´¹çš„ä¸ªäººå›¾åºŠã€‚\nPicGoä»‹ç» PicGoæ˜¯ä¸€æ¬¾å›¾ç‰‡ä¸Šä¼ çš„å·¥å…·ï¼Œç›®å‰æ”¯æŒå¾®åšå›¾åºŠï¼Œä¸ƒç‰›å›¾åºŠï¼Œè…¾è®¯äº‘ï¼Œåˆæ‹äº‘ï¼ŒGitHubç­‰å›¾åºŠ\nåœ¨Githubåˆ›å»ºå›¾åºŠ åˆ›å»ºRepository ç”Ÿæˆä¸€ä¸ªTokenç”¨äºæ“ä½œGitHub repository æ­¥éª¤å¦‚ä¸‹:\n{% note warning %}\næ³¨ï¼šåˆ›å»ºæˆåŠŸåï¼Œä¼šç”Ÿæˆä¸€ä¸²tokenï¼Œè¿™ä¸²tokenä¹‹åä¸ä¼šå†æ˜¾ç¤ºï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡çœ‹åˆ°çš„æ—¶å€™ï¼Œå°±è¦å¥½å¥½ä¿å­˜\n{% endnote %}\né…ç½®PicGo ä¸‹è½½PicGo Windowsç”¨æˆ·ä¸‹è½½exeæ–‡ä»¶\né…ç½®å›¾åºŠ    è®¾å®šä»“åº“åçš„æ—¶å€™ï¼Œæ˜¯æŒ‰ç…§â€œè´¦æˆ·å/ä»“åº“åçš„æ ¼å¼å¡«å†™â€\n  åˆ†æ”¯åç»Ÿä¸€å¡«å†™â€œmasterâ€\n  å°†ä¹‹å‰çš„Tokené»è´´åœ¨è¿™é‡Œ\n  å­˜å‚¨çš„è·¯å¾„å¯ä»¥æŒ‰ç…§æˆ‘è¿™æ ·å­å†™ï¼Œå°±ä¼šåœ¨repositoryä¸‹åˆ›å»ºä¸€ä¸ªâ€œimgâ€æ–‡ä»¶å¤¹\n  è‡ªå®šä¹‰åŸŸåçš„ä½œç”¨æ˜¯ï¼Œåœ¨ä¸Šä¼ å›¾ç‰‡åæˆåŠŸåï¼ŒPicGoä¼šå°†â€œè‡ªå®šä¹‰åŸŸå+ä¸Šä¼ çš„å›¾ç‰‡åâ€ç”Ÿæˆçš„è®¿é—®é“¾æ¥ï¼Œæ”¾åˆ°å‰ªåˆ‡æ¿ä¸Šhttps://raw.githubusercontent.com/ç”¨æˆ·å/RepositoryName/åˆ†æ”¯åï¼Œï¼Œè‡ªå®šä¹‰åŸŸåéœ€è¦æŒ‰ç…§è¿™æ ·å»å¡«å†™\n   å¿«æ·é”®åŠç›¸å…³é…ç½®  è¿™é‡Œé…ç½®ä¸Šä¼ å¿«æ·é”®ä¸ºctrl+shift+c\n ä½¿ç”¨ ç»è¿‡ä¸Šé¢çš„é…ç½®å°±å¤§åŠŸå‘Šæˆäº†ï¼Œæ¯æ¬¡æˆªå›¾ä¹‹åï¼Œåªéœ€è¦ctrl+shift+cä¸€ä¸‹å°±å¯ä»¥æŠŠå‰ªåˆ‡æ¿ä¸Šé¢çš„æˆªå›¾è½¬åŒ–ä¸ºåœ¨çº¿ç½‘ç»œå›¾ç‰‡é“¾æ¥ã€‚\n","description":"","id":65,"section":"posts","tags":["PicGo","Github","å›¾åºŠ"],"title":"é…ç½®åŸºäºGithubçš„PicGoå›¾åºŠ","uri":"https://hugo.jiahongw.com/zh/posts/settings/image-bed/"},{"content":"å†™åœ¨æºæ–‡ä»¶ä¸­çš„æºä»£ç æ˜¯äººç±»å¯è¯»çš„æºã€‚å®ƒéœ€è¦\u0026quot;ç¼–è¯‘\u0026rdquo;ï¼Œè½¬ä¸ºæœºå™¨è¯­è¨€ï¼Œè¿™æ · CPU å¯ä»¥æŒ‰ç»™å®šæŒ‡ä»¤æ‰§è¡Œç¨‹åºã€‚C è¯­è¨€ç¼–è¯‘å™¨ç”¨äºæŠŠæºä»£ç ç¼–è¯‘æˆæœ€ç»ˆçš„å¯æ‰§è¡Œç¨‹åºã€‚ğŸ¤\nå®‰è£… é¦–å…ˆ,åˆ°ï¼šhttps://sourceforge.net/projects/mingw-w64/files/latest/downloadï¼Œä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ MinGW å®‰è£…ç¨‹\nç„¶åï¼Œè¿è¡Œ Download mingw-get-setup.exe ,ç‚¹å‡»\u0026quot;è¿è¡Œ\u0026rdquo;ï¼Œcontinueç­‰ï¼Œæ³¨æ„è®°ä½å®‰è£…çš„ç›®å½•ï¼Œä¹‹åéœ€è¦é…ç½®ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚D:\\MinGW\\bin\nå‡å¦‚ç½‘é€Ÿä¸å¥½ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„é“¾æ¥è¿›è¡Œç¦»çº¿ä¸‹è½½ï¼Œä¸‹è½½å®Œæˆä¹‹åä½¿ç”¨7Zipè§£å‹ï¼Œç„¶åæŠŠè§£å‹çš„æ–‡ä»¶ç§»åŠ¨åˆ°å®‰è£…è·¯å¾„å³å¯ã€‚\nhttps://pan.baidu.com/s/1W4fHsUeaw1C9vp1lvRygbw\næ³¨ï¼šä½¿ç”¨è¿™ç§æ–¹å¼ä¸‹é¢çš„æ­¥éª¤ä¸éœ€è¦æ‰§è¡Œäº†ï¼Œå·²ç»åœ¨ç¦»çº¿åŒ…ä¸­é›†æˆäº†ã€‚å¯ç›´æ¥è¾“å…¥gcc -væŸ¥çœ‹gccç‰ˆæœ¬ã€‚\n éªŒè¯å®‰è£…ï¼š\nåœ¨å¼€å§‹èœå•ä¸­ï¼Œç‚¹å‡»\u0026quot;è¿è¡Œ\u0026rdquo;ï¼Œè¾“å…¥ cmd,æ‰“å¼€å‘½ä»¤è¡Œ:è¾“å…¥ mingw-get,å¦‚æœå¼¹å‡º MinGw installation manager çª—å£ï¼Œè¯´æ˜å®‰è£…æ­£å¸¸ï¼Œç„¶åå…³é—­çª—å£ã€‚\nå®‰è£…GCCç­‰ç¼–è¯‘å™¨ åœ¨cmdä¸­è¾“å…¥å¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š\nå®‰è£…gcc\n1  mingw-get install gcc   å®‰è£…g++\n1  mingw-get install g++   å®‰è£…gdb\n1  mingw-get install gdb   ä½¿ç”¨ åœ¨æ¡Œé¢åˆ›å»ºä¸€ä¸ªhello.cçš„ç¨‹åº\n1 2 3 4 5 6 7 8 9  #include \u0026lt;iostream\u0026gt;using namespace std; int main() { cout \u0026lt;\u0026lt; \u0026#34;Hello!\u0026#34; \u0026lt;\u0026lt; endl; return 0; }   åœ¨ cmd ä¸­è¾“å…¥å‘½ä»¤\n1  gcc hello.c   åœ¨å½“å‰ç›®å½•ä¸‹(è®°ä½æ˜¯å‘½ä»¤çš„å½“å‰ç›®å½•)ä¼šç”Ÿæˆ a.exe çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåœ¨ cmd ä¸­è¾“å…¥ a.exe å°±å¯ä»¥æ‰§è¡Œç¨‹åºäº†ã€‚\n","description":"","id":66,"section":"posts","tags":["gcc","MinGW"],"title":"windowsä¸‹gccçš„å®‰è£…å’Œä½¿ç”¨","uri":"https://hugo.jiahongw.com/zh/posts/settings/gcc-windows/"},{"content":"æˆ‘æ˜¯ä¸€ä¸ªä¸å¤Ÿä¸¥è°¨çš„ç¨‹åºå‘˜ğŸ™‰.\næˆ‘å–œæ¬¢ğŸ“–,è¿˜æœ‰ğŸ“.\næˆ–è®¸æœ‰æ—¶å€™æˆ‘æƒ³çš„ä¸å¤Ÿè¿œï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘æƒ³çš„å¾ˆæ·±å…¥ã€‚\næˆ‘æœ€å–œæ¬¢çš„ Aaron Swartz è¯­å½•:\n åœ¨é•¿å¤§çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ‰æ…¢æ…¢å‘ç°ï¼Œæˆ‘èº«è¾¹çš„æ‰€æœ‰äº‹ï¼Œåˆ«äººè·Ÿæˆ‘è¯´çš„æ‰€æœ‰äº‹ï¼Œé‚£äº›æ‰€è°“æœ¬æ¥å¦‚æ­¤ï¼Œæ³¨å®šå¦‚æ­¤çš„äº‹ï¼Œå®ƒä»¬å…¶å®æ²¡æœ‰éå¾—å¦‚æ­¤ï¼Œäº‹æƒ…æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæœ‰äº›äº‹æ—¢ç„¶é”™äº†ï¼Œé‚£å°±è¯¥åšå‡ºæ”¹å˜ã€‚\næˆ‘å¯¹å­¦æ ¡ååˆ†å¤±æœ›ï¼Œæˆ‘è§‰å¾—è€å¸ˆä»¬æ ¹æœ¬ä¸æ‡‚è‡ªå·±æ‰€è®²çš„æ˜¯ä»€ä¹ˆï¼Œä»–ä»¬å±…é«˜ä¸´ä¸‹ï¼Œç®¡è¿™ç®¡é‚£ï¼›ä½œä¸šå°±åƒæ˜¯ç§æŠŠæˆï¼Œå°±å¥½åƒçŸ¥è¯†ä¸€ç§å¼ºåˆ¶æ‰€æœ‰å­¦ç”Ÿä¸€èµ·åº¸åº¸ç¢Œç¢Œçš„æ‰‹æ®µã€‚äºæ˜¯æˆ‘å°±å¼€å§‹å»é˜…è¯»é‚£äº›å…³äºæ•™è‚²å²å’Œè¿™å¥—æ•™è‚²ä½“ç³»æ¼”å˜çš„ä¹¦ç±ã€‚ç„¶åä½ å°±èƒ½å‘ç°ï¼Œå¦‚æœè¦çœŸæ­£å­¦åˆ°ä¸œè¥¿ï¼Œé‚£å°±ä¸èƒ½æœºæ¢°é‡å¤è€å¸ˆæ‰€æ•™çš„ï¼Œè¿™æœ‰ç‚¹å„¿ä½¿å¾—æˆ‘æ¸æ¸å­¦ä¼šäº†è´¨ç–‘ã€‚æˆ‘è´¨ç–‘æˆ‘æ‰€ä¸Šçš„å­¦æ ¡ï¼Œæˆ‘è´¨ç–‘ç®€å†è¿™æ‰€å­¦æ ¡çš„è¿™ä¸ªç¤¾ä¼šï¼Œæˆ‘è´¨ç–‘å­¦æ ¡æ•™äººä»¬è¿½æ±‚çš„é‚£å¥—äº‹ç†ï¼Œæˆ‘è´¨ç–‘å»ºç«‹èµ·è¿™æ•´ä¸ªä½“ç³»çš„æ”¿åºœã€‚\næˆ‘æ€»æ˜¯æ·±å…¥æ€è€ƒï¼Œæˆ‘å¸Œæœ›åˆ«äººä¹Ÿèƒ½æƒ³è¿œä¸€ç‚¹ã€‚æˆ‘ä¸ºç†æƒ³è€Œå·¥ä½œï¼Œå¹¶ä»åˆ«äººèº«ä¸Šå­¦ä¹ ï¼Œæˆ‘ä¸å–œæ¬¢æ‹’äººäºå¤–ã€‚æˆ‘æ˜¯ä¸ªå®Œç¾ä¸»ä¹‰è€…ï¼Œä½†æˆ‘ä¸ä¼šè¦æ±‚å‡ºç‰ˆç•Œä¹Ÿç²¾ç›Šæ±‚ç²¾ã€‚é™¤äº†æ•™è‚²å’Œå¨±ä¹ä»¥å¤–ï¼Œæˆ‘ä¸ä¼šæµªè´¹æ—¶é—´åœ¨é‚£äº›ä¸ä¼šæœ‰å½±å“çš„äº‹æƒ…ä¸Šã€‚æˆ‘è¯•ç€å’Œæ¯ä¸ªäººéƒ½å‹å¥½ç›¸å¤„ï¼Œä½†æˆ‘è®¨åŒäººä»¬ä¸è®¤çœŸå¯¹å¾…æˆ‘ã€‚æˆ‘ä¸è®°æ¨ä»–äººï¼Œå› ä¸ºè¿™äºåˆ›é€ æ— ç›Šã€‚ä½†æˆ‘ä»è‡ªèº«ç»å†ä¸­å­¦ä¹ ï¼Œæˆ‘æƒ³è®©ä¸–ç•Œå˜å¾—æ›´ç¾å¥½ã€‚\næˆ‘æ·±æ·±åœ°è§‰å¾—ï¼Œå…‰å®‰ç”Ÿä¸å½“ä¸‹è¿™ä¸–ç•Œæ˜¯ä¸å¤Ÿçš„ï¼Œé‚£æ ·å­çŸ¥è¯†åˆ«äººç»™ä»€ä¹ˆä½ å°±ç…§æ”¶ï¼Œå¤§äººä»¬è¯´ä»€ä¹ˆä½ å°±ç…§åšï¼Œä½ ç…§ç€çˆ¶æ¯è¯´çš„å»åšï¼Œç…§ç€ç¤¾ä¼šè¯´çš„å»åšã€‚æˆ‘è§‰å¾—ä½ åº”è¯¥æ€»æŒæœ‰è´¨ç–‘ï¼Œæˆ‘è§‰å¾—ä»ç§‘å­¦çš„è§’åº¦çœ‹ï¼Œä½ æ‰€å­¦çš„ä¸€åˆ‡éƒ½çŸ¥è¯†æš‚æ—¶æ€§çš„ï¼Œä»»ä½•æ‰€å­¦éƒ½æœ‰æ”¹å£ã€é©³æ–¥ã€è´¨ç–‘çš„ä½™åœ°ã€‚æˆ‘è§‰å¾—è¿™æƒ…å†µå¯¹ç¤¾ä¼šä¹Ÿé€‚ç”¨ã€‚å½“æˆ‘æ„è¯†åˆ°ç¤¾ä¼šä¸Šæœ‰ç€æˆ‘èƒ½å°½ä»½åŠ›å»è§£å†³çš„çœŸæ­£ä¸¥é‡çš„ã€åŸºç¡€æ€§çš„é—®é¢˜æ—¶ï¼Œæˆ‘æ²¡æ³•å»é—å¿˜å®ƒã€å›é¿å®ƒã€‚\n ","description":"Zzo about page","id":67,"section":"","tags":null,"title":"About","uri":"https://hugo.jiahongw.com/zh/about/"},{"content":"Markdownify box This is boxmd shortcode Simple box This is **box** shortcode  Code tabs Make it easy to switch between different code\njava javascript  1  System.out.println(\u0026#39;Hello World!\u0026#39;);     1  console.log(\u0026#39;Hello World!\u0026#39;);       'use strict'; var containerId = JSON.parse(\"\\\"642b4352e05d9e04\\\"\"); var containerElem = document.getElementById(containerId); var codetabLinks = null; var codetabContents = null; var ids = []; if (containerElem) { codetabLinks = containerElem.querySelectorAll('.codetab__link'); codetabContents = containerElem.querySelectorAll('.codetab__content'); } for (var i = 0; i 0) { codetabContents[0].style.display = 'block'; }  Tabs for general purpose Windows MacOS Ubuntu  Windows section 1  console.log(\u0026#39;Hello World!\u0026#39;);   âš ï¸Becareful that the content in the tab should be different from each other. The tab makes unique id hashes depending on the tab contents. So, If you just copy-paste the tabs with multiple times, since it has the same contents, the tab will not work.\n MacOS section Hello world!  Ubuntu section Great!    'use strict'; var containerId = JSON.parse(\"\\\"f09fb25fccaa3686\\\"\"); var containerElem = document.getElementById(containerId); var tabLinks = null; var tabContents = null; var ids = []; if (containerElem) { tabLinks = containerElem.querySelectorAll('.tab__link'); tabContents = containerElem.querySelectorAll('.tab__content'); } for (var i = 0; i 0) { tabContents[0].style.display = 'block'; }  Expand   Expand me  Title contents     Expand me2  Title2 contents2   Alert Colored box\nthis is a text this is a text this is a text this is a text Notice success text  info text  warning text  error text  ","description":"tabs, code-tabs, expand, alert, warning, notice, img, box","id":68,"section":"posts","tags":["shortcode"],"title":"Shortcodes","uri":"https://hugo.jiahongw.com/zh/posts/hugo/shortcodes/"},{"content":"A Short Videoï¼š  â€”â€”ä»¥ä¸‹ Aaron Swartzçš„å®£è¨€ï¼Œæˆ‘æƒ³è¿™æ‰æ˜¯ä¿¡æ¯é©å‘½çš„çœŸè°›â€”â€”\nä¿¡æ¯å°±æ˜¯åŠ›é‡ã€‚ä½†å°±åƒæ‰€æœ‰åŠ›é‡ä¸€æ ·ï¼Œæœ‰äº›äººåªæƒ³å ä¸ºå·±æœ‰ã€‚ä¸–ç•Œä¸Šæ‰€æœ‰çš„ç§‘å­¦å’Œæ–‡åŒ–é—äº§ï¼Œå·²åœ¨ä¹¦ç±å’ŒæœŸåˆŠä¸Šå‘å¸ƒäº†æ•°ä¸ªä¸–çºªï¼Œæ­£æ¸æ¸åœ°è¢«å°‘æ•°ç§æœ‰çš„å…¬å¸æ•°å­—åŒ–å¹¶ä¸Šé”ã€‚æƒ³è¦é˜…è¯»é‚£äº›æœ‰ç€æœ€è‘—åç ”ç©¶æˆæœçš„è®ºæ–‡ï¼Ÿä½ å¿…é¡»æ”¯ä»˜ç»™å¦‚ Reed Elsevier è¿™æ ·çš„å‡ºç‰ˆå•†å¤§æŠŠé’±ã€‚\næœ‰äººåŠªåŠ›å»æ”¹å˜è¿™ç§çŠ¶å†µã€‚å¼€æ”¾è®¿é—®è¿åŠ¨ (Open Access Movement) å¥‹å‹‡æ–—äº‰ï¼Œç¡®ä¿ç§‘å­¦å®¶ä»¬æ²¡æœ‰å°†ä»–ä»¬çš„ç‰ˆæƒç­¾ç½²ç»™åˆ«äººï¼Œè€Œæ˜¯å°†ä»–ä»¬çš„æˆæœå‘å¸ƒåˆ°ç½‘ç»œä¸Šï¼Œå…è®¸ä»»ä½•äººè®¿é—®å®ƒä»¬ã€‚ä½†å³ä¾¿æ˜¯æœ€å¥½çš„æƒ…å†µï¼Œä»–ä»¬çš„è¡Œä¸ºä¹Ÿåªä½œç”¨äºæœªæ¥å‘å¸ƒçš„ä¸œè¥¿ã€‚ä¹‹å‰çš„éƒ½å°†å¤±å»ã€‚\nè¿™æ ·çš„ä»£ä»·å®åœ¨å¤ªé«˜ã€‚å¼ºåˆ¶å­¦è€…ä»˜é’±ä»¥é˜…è¯»ä»–ä»¬åŒè¡Œçš„æˆæœï¼Ÿæ‰«ææ•´ä¸ªå›¾ä¹¦é¦†å´åªå…è®¸ Google çš„äººé˜…è¯»å®ƒä»¬ï¼Ÿæä¾›ç§‘å­¦æ–‡ç« ç»™é‚£äº›ç¬¬ä¸€ä¸–ç•Œçš„ç²¾è‹±å¤§å­¦ï¼Œå´ä¸ç»™èº«åœ¨å—åŠçƒçš„å„¿ç«¥ï¼Ÿè¿™å®åœ¨è›®æ¨ªä¸”æ— æ³•æ¥å—ã€‚\nâ€œæˆ‘åŒæ„ï¼Œâ€æœ‰äº›äººå°±è¯´äº†ï¼Œâ€œä½†æ˜¯æˆ‘ä»¬èƒ½åšä»€ä¹ˆå‘¢ï¼Ÿé‚£äº›å…¬å¸æ¡æœ‰ç‰ˆæƒï¼Œä»–ä»¬é é™åˆ¶è®¿é—®èµšå–å¤§æŠŠçš„é’±ï¼Œè€Œä¸”è¿™æ˜¯å®Œå…¨åˆæ³•çš„ - æˆ‘ä»¬æ²¡æœ‰åŠæ³•é˜»æ­¢ä»–ä»¬ã€‚â€ä½†æœ‰äº›äº‹æˆ‘ä»¬èƒ½åšï¼Œè¿™äº›äº‹æˆ‘ä»¬å·²ç»åœ¨åšï¼šæˆ‘ä»¬å¯ä»¥åå‡»ã€‚\né‚£äº›èƒ½å¤Ÿè®¿é—®è¿™äº›èµ„æºçš„äºº - å­¦ç”Ÿï¼Œå›¾ä¹¦ç®¡ç†å‘˜ï¼Œç§‘å­¦å®¶ - ä½ ä»¬è¢«èµ‹äºˆäº†ç‰¹æƒã€‚ä½ ä»¬èƒ½äº«å—åˆ°è¿™çŸ¥è¯†çš„ç››å®´ï¼Œè€Œå…¶ä»–äººå´è¢«æ’é™¤åœ¨å¤–ã€‚ä½†æ˜¯ä½ ä»¬ä¸å¿… - äº‹å®ä¸Šï¼Œä»é“ä¹‰å±‚é¢æ¥è¯´ï¼Œä½ ä»¬ä¸èƒ½ - ä¸ºä¿ç•™è‡ªå·±ä¿ç•™è¿™ä»½ç‰¹æƒã€‚ä½ ä»¬æœ‰ä¹‰åŠ¡å’Œå…¨ä¸–ç•Œåˆ†äº«å®ƒã€‚è€Œä¸”ä½ ä»¬å·²ç»åœ¨åšäº†ï¼šå’ŒåŒè¡Œä»¬äº¤æ¢å¯†ç ï¼Œå›åº”æœ‹å‹ä»¬çš„ä¸‹è½½è¯·æ±‚ã€‚\nåŒæ—¶ï¼Œé‚£äº›è¢«æ‹’ä¹‹é—¨å¤–çš„äººä»¬å¹¶æ²¡æœ‰è¢–æ‰‹æ—è§‚ã€‚ä½ ä»¬æºœè¿‡æ´ç©´ï¼Œç¿»è¶Šå›´å¢™ï¼Œè§£æ”¾é‚£äº›è¢«å‡ºç‰ˆå•†å°é”çš„ä¿¡æ¯å¹¶åˆ†äº«ç»™ä½ çš„æœ‹å‹ä»¬ã€‚\nä½†æ‰€æœ‰è¿™äº›è¡ŒåŠ¨éƒ½æ˜¯åœ¨é»‘æš—ä¸­è¿›è¡Œï¼Œéšè—äºåœ°åº•ã€‚å®ƒä»¬è¢«ç§°ä½œå·çªƒæˆ–ç›—ç‰ˆï¼Œä»¿ä½›åˆ†äº«å¤§é‡çš„çŸ¥è¯†ç²¾ç¥ä¸Šç­‰åŒäºæŠ¢åŠ«ä¸€è‰˜èˆ¹åªå¹¶è°‹æ€å…¶èˆ¹å‘˜ã€‚ä½†æ˜¯åˆ†äº«ç»éä¸é“å¾·çš„ï¼Œå®ƒæ˜¯ä¸€ç§é“å¾·ä½¿å‘½ã€‚åªæœ‰é‚£äº›åˆ©æ¬²ç†å¿ƒçš„äººæ‰ä¼šæ‹’ç»è®©æœ‹å‹å¤åˆ¶ä¸€ä»½ã€‚\nå¤§å…¬å¸ï¼Œå½“ç„¶ï¼Œå°±æ˜¯åˆ©æ¬²ç†å¿ƒã€‚ä½¿å®ƒä»¬è¿è½¬çš„æ³•å¾‹è¦æ±‚ä½¿ç„¶ - ç¨å¾®å‡ºç‚¹äº‹æŠ•èµ„äººå°±å¾—å›ä¹±ã€‚å®ƒä»¬æ”¶ä¹°çš„æ”¿æ²»å®¶ä»¬æ”¯æŒå®ƒä»¬ï¼Œé€šè¿‡æ³•æ¡ˆè®©å®ƒä»¬æ‹¥æœ‰ä¸“å±çš„æƒåŠ›å†³å®šè°å¯ä»¥å¤åˆ¶ã€‚\néµä»ä¸å…¬æ­£çš„æ³•å¾‹ä¸ä¼šå¸¦æ¥å…¬æ­£ã€‚æ­¥å…¥å…‰æ˜çš„æ—¶å€™åˆ°äº†ï¼Œåœ¨å…¬æ°‘ä¸æœä»çš„ä¼Ÿå¤§ä¼ ç»Ÿä¸‹ï¼Œå®£å‘Šæˆ‘ä»¬å¯¹è¿™ç§ç§äººç›—çªƒå…¬å…±æ–‡åŒ–çš„åæŠ—ã€‚\næˆ‘ä»¬è¦å¤ºå›ä¿¡æ¯ï¼Œæ— è®ºå®ƒä»¬è¢«å­˜åœ¨ä½•å¤„ï¼Œåˆ¶ä½œæˆ‘ä»¬çš„å‰¯æœ¬å¹¶å’Œå…¨ä¸–ç•Œåˆ†äº«ã€‚æˆ‘ä»¬è¦å–åˆ°ç‰ˆæƒåˆ°æœŸçš„ä¸œè¥¿å¹¶å°†å®ƒä»¬å½’æ¡£ï¼Œæˆ‘ä»¬è¦ä¹°ä¸‹ç§˜å¯†çš„èµ„æ–™åº“å¹¶å°†å®ƒä»¬æ”¾åˆ°ç½‘ä¸Šã€‚æˆ‘ä»¬è¦ä¸‹è½½ç§‘å­¦æœŸåˆŠå¹¶å°†å®ƒä»¬ä¸Šä¼ åˆ°æ–‡ä»¶åˆ†äº«ç½‘ç»œã€‚æˆ‘ä»¬è¦ä¸ºæ¸¸å‡»é˜Ÿå¼€æ”¾è®¿é—®è€Œæˆ˜ã€‚\nåªè¦å…¨ä¸–ç•Œæœ‰è¶³å¤Ÿå¤šçš„æˆ‘ä»¬ï¼Œé‚£å°±ä¸ä»…æ˜¯ä¼ è¾¾äº†ä¸€ä¸ªåå¯¹çŸ¥è¯†ç§æœ‰åŒ–çš„å¼ºæœ‰åŠ›ä¿¡å·ï¼Œæˆ‘ä»¬è¿˜å°†è®©å®ƒæˆä¸ºè¿‡å»ã€‚ä½ æ„¿æ„å’Œæˆ‘ä»¬ä¸€èµ·å—ï¼Ÿ\näºšä¼¦Â·æ–¯æ²ƒèŒ¨ (Aaron Swartz)\n2008 å¹´ 7 æœˆï¼Œæ„å¤§åˆ© Eremo\nInformation is power. But like all power, there are those who want to keep it for themselves. The world\u0026rsquo;s entire scientific and cultural heritage, published over centuries in books and journals, is increasingly being digitized and locked up by a handful of private corporations. Want to read the papers featuring the most famous results of the sciences? You\u0026rsquo;ll need to send enormous amounts to\npublishers like Reed Elsevier.\nThere are those struggling to change this. The Open Access Movement has fought valiantly to ensure that scientists do not sign their copyrights away but instead ensure their work is published on the Internet, under terms that allow anyone to access it. But even under the best scenarios, their work will only apply to things published in the future. Everything up until now will have been lost.\nThat is too high a price to pay. Forcing academics to pay money to read the work of their colleagues? Scanning entire libraries but only allowing the folks at Google to read them? Providing scientific articles to those at elite universities in the First World, but not to children in the Global South? It\u0026rsquo;s outrageous and unacceptable.\n\u0026ldquo;I agree,\u0026rdquo; many say, \u0026ldquo;but what can we do? The companies hold the copyrights, they make enormous amounts of money by charging for access, and it\u0026rsquo;s perfectly legal - there\u0026rsquo;s nothing we can do to stop them.\u0026rdquo; But there is something we can, something that\u0026rsquo;s already being done: we can fight back.\nThose with access to these resources - students, librarians, scientists - you have been given a privilege. You get to feed at this banquet of knowledge while the rest of the world is locked out. But you need not - indeed, morally, you cannot - keep this privilege for yourselves. You have a duty to share it with the world. And you have: trading passwords with colleagues, filling download requests for friends.\nMeanwhile, those who have been locked out are not standing idly by. You have been sneaking through holes and climbing over fences, liberating the information locked up by the publishers and sharing them with your friends.\nBut all of this action goes on in the dark, hidden underground. It\u0026rsquo;s called stealing or piracy, as if sharing a wealth of knowledge were the moral equivalent of plundering a ship and murdering its crew. But sharing isn\u0026rsquo;t immoral - it\u0026rsquo;s a moral imperative. Only those blinded by greed would refuse to let a friend make a copy.\nLarge corporations, of course, are blinded by greed. The laws under which they operate require it - their shareholders would revolt at anything less. And the politicians they have bought off back them, passing laws giving them the exclusive power to decide who can make copies.\nThere is no justice in following unjust laws. It\u0026rsquo;s time to come into the light and, in the grand tradition of civil disobedience, declare our opposition to this private theft of public culture.\nWe need to take information, wherever it is stored, make our copies and share them with the world. We need to take stuff that\u0026rsquo;s out of copyright and add it to the archive. We need to buy secret databases and put them on the Web. We need to download scientific journals and upload them to file sharing networks. We need\nto fight for Guerilla Open Access.\nWith enough of us, around the world, we\u0026rsquo;ll not just send a strong message opposing the privatization of knowledge - we\u0026rsquo;ll make it a thing of the past.\nWill you join us?\nAaron Swartz\nJuly 2008, Eremo, Italy\n","description":"","id":69,"section":"talks","tags":[""],"title":"My Awesome links","uri":"https://hugo.jiahongw.com/zh/talks/mylinks/"},{"content":"Sample images about life.\n","description":"my gallery","id":71,"section":"gallery","tags":[""],"title":"life","uri":"https://hugo.jiahongw.com/zh/gallery/life/"},{"content":"between 70 and 240 in movies\ngood moviesï¼ğŸ¥\n","description":"my gallery","id":72,"section":"gallery","tags":[""],"title":"movie","uri":"https://hugo.jiahongw.com/zh/gallery/movie/"},{"content":"ä¸€ä¸ªæµ‹è¯•è§†é¢‘:  ","description":"","id":76,"section":"talks","tags":[""],"title":"Bç«™è§†é¢‘","uri":"https://hugo.jiahongw.com/zh/talks/blibli/"},{"content":"UEç¼–è¾‘å™¨ä¸‹æ¨¡æ‹Ÿä½¿ç”¨HitProxy éœ€è¦ä» UGameViewportClient ç±»ç»§æ‰¿ ä¿®æ”¹è¿”å›å€¼ä¸ºtrue,è·¯å¾„ï¼š\\Source\\Runtime\\Engine\\Private\\GameViewportClient.h\n1  virtual bool RequiresHitProxyStorage() override { return true; }   åœ¨FViewportClientç±»ä¸­æ–°å»ºDrawHitProxyå‡½æ•° æ–‡ä»¶UnrealClient.h\nåœ¨GameViewportClientç±»ä¸­å£°æ˜å¹¶ä¸”å®ç° å£°æ˜ï¼š\\Source\\Runtime\\Engine\\Private\\GameViewportClient.h\nå°†GameViewportClientç±»ä¸­çš„å‡½æ•°Draw()å†…å®¹å¤åˆ¶åˆ°è¯¥å‡½æ•°DrawHitProxyï¼Œä¿®æ”¹ä¸‹é¢çš„çš„åœ°æ–¹ï¼š\nä¿®æ”¹FViewportç±»ä¸­çš„GetRawHitProxyDataå‡½æ•° åœ¨GetRawHitProxyDataå‡½æ•°ä¸­è¿›è¡Œä»¥ä¸‹çš„ä¿®æ”¹ï¼šEngine\\Source\\Runtime\\Engine\\Private\\UnrealClient.cpp\nè°ƒç”¨\u0026ndash;è·å–å±å¹•åæ ‡Hitproxy ç›¸å…³ç±»å‹ HHitProxyï¼šç”¨äºæ£€æµ‹ç”¨æˆ·ç•Œé¢å‘½ä¸­çš„åŸºç±»\nFHitProxyMapï¼šä»2Dåæ ‡åˆ°ç¼“å­˜å‘½ä¸­ä»£ç†çš„åœ°å›¾ã€‚\nå‚è€ƒï¼š\n How to select an actor in-game using GetHitProxy? UE4 ç¼–è¾‘å™¨çš„å…‰æ ‡æ‹¾å– ç¼–è¾‘å™¨Viewportçª—å£ä¸­çš„é¼ æ ‡æ‹¾å–åŸç† åœºæ™¯åŸºæœ¬å¯¹è±¡ æ¸²æŸ“æ€»æµç¨‹ https://docs.unrealengine.com/zh-CN/Programming/Rendering/MeshDrawingPipeline/index.html Unreal Mesh Drawingæºç åˆ†æ ç™½è¢ç¬‘é“  ","description":"","id":80,"section":"posts","tags":null,"title":"","uri":"https://hugo.jiahongw.com/zh/posts/ue/ue-hitproxy/"}]